// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/main":function(){define(["./kernel","dojo/i18n!./nls/jsapi","./config","./sniff"],function(b,h){b.bundle=h;return b})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(b,h,k){b=function(){return this}();var a=b.location,c=a.pathname;k=a.protocol;a={version:"3.26",_appBaseUrl:k+"//"+a.host+c.substring(0,c.lastIndexOf(c.split("/")[c.split("/").length-1]))};h.noGlobals||(b.esri=a);(a.dijit=a.dijit||{})._arcgisUrl=("http:"===k||"https:"===
k?k:"http:")+"//www.arcgis.com/sharing/rest";return a})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(b,h,k,a){k=function(){return this}();var c={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,
zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,zoomAnimationThrottled:!1,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:k.Worker&&!1,io:{errorHandler:function(a,b){h.publish("esri.Error",[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:[/^https?:\/\/.+\.arcgis\.com(\/|$)/i,"server.arcgisonline.com","services.arcgisonline.com","www.arcgis.com",
"js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","tiles.arcgis.com","tiles1.arcgis.com","tiles2.arcgis.com","tiles3.arcgis.com","tiles4.arcgis.com","basemaps.arcgis.com","basemapsbeta.arcgis.com","elevation3d.arcgis.com","services.arcgis.com","services1.arcgis.com","services2.arcgis.com","services3.arcgis.com","services4.arcgis.com","services5.arcgis.com","services6.arcgis.com","services7.arcgis.com","services8.arcgis.com","services9.arcgis.com","cdn.arcgis.com","cdn-a.arcgis.com","cdn-b.arcgis.com",
"static.arcgis.com","utility.arcgis.com","utility.arcgisonline.com","geocode.arcgis.com","geoenrich.arcgis.com","qaext.arcgis.com","staticqa.arcgis.com","tilesqa.arcgis.com","servicesqa.arcgis.com","servicesqa1.arcgis.com","servicesqa2.arcgis.com","servicesqa3.arcgis.com","geocodeqa.arcgis.com","geoenrichqa.arcgis.com","dev.arcgis.com","devext.arcgis.com","localvtiles.arcgis.com","staticdev.arcgis.com","tilesdevext.arcgis.com","elevation3ddev.arcgis.com","servicesdev.arcgis.com","servicesdev1.arcgis.com",
"servicesdev2.arcgis.com","servicesdev3.arcgis.com","geocodedev.arcgis.com","geoenrichdev.arcgis.com","basemapsdev.arcgis.com","basemapsbetadev.arcgis.com"],corsDetection:k.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},
workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};a.config=c;b.noGlobals||(k.esriConfig=c);return c})},"esri/sniff":function(){define(["dojo/_base/sniff","dojo/global","./kernel"],function(b,h,k){var a=b("ff"),c=b("ie"),d=void 0===c&&7<=b("trident"),e=b("edge"),f=b("webkit"),g=b("opera"),l=b("chrome"),m=b("safari"),n=navigator.userAgent,q;(q=n.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&b.add("esri-iphone",parseFloat(q[2].replace("_",".")));(q=n.match(/Android\s+(\d+(\.\d+)*)/i))&&
b.add("esri-android",parseFloat(q[1]));(q=n.match(/Fennec\/(\d+\.\d+)/i))&&b.add("esri-fennec",parseFloat(q[1]));0<=n.indexOf("BlackBerry")&&0<=n.indexOf("WebKit")&&b.add("esri-blackberry",1);b.add("esri-touch",b("esri-iphone")||b("esri-android")||b("esri-blackberry")||6<=b("esri-fennec")||(a||f)&&(document.createTouch||"ontouchstart"in h)?!0:!1);(q=n.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&b.add("esri-mobile",!!q);b.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled||
!(!e||!h.PointerEvent));k._getDOMAccessor=function(b){var d="";a?d="Moz":f?d="Webkit":c?d="ms":g&&(d="O");return d+b.charAt(0).toUpperCase()+b.substr(1)};b.add("esri-phonegap",!!h.cordova);b.add("esri-cors",b("esri-phonegap")||h.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);b.add("esri-file-upload",h.FormData&&h.FileList?!0:!1);b.add("esri-script-sandbox",function(){return"MessageChannel"in h&&"HTMLIFrameElement"in h&&"sandbox"in HTMLIFrameElement.prototype});b.add("esri-secure-context",
function(){if("isSecureContext"in h)return h.isSecureContext;if(h.location&&h.location.origin)return 0===h.location.origin.indexOf("https:")});b.add("esri-wasm","WebAssembly"in h);b.add("esri-workers",h.Worker?!0:!1);b.add("esri-featurelayer-webgl",!1);if(n=b("esri-featurelayer-webgl")){var t=b("esri-mobile");q=t?1:2;t=t?1:3;"object"===typeof n?(n.maxDrillLevel=null==n.maxDrillLevel?q:n.maxDrillLevel,n.maxRecordCountFactor=null==n.maxRecordCountFactor?t:n.maxRecordCountFactor,n.enablePBFQuery=null==
n.enablePBFQuery?!0:n.enablePBFQuery):b.add("esri-featurelayer-webgl",{maxDrillLevel:q,maxRecordCountFactor:t,enablePBFQuery:!0},null,!0)}b.add("esri-featurelayer-webgl-labeling",!1);b.add("esri-pbf",!c||10<=c);b.add("esri-featurelayer-pbf",!0);b.add("esri-transforms",d||e||9<=c||3.5<=a||4<=l||3.1<=m||10.5<=g||3.2<=b("esri-iphone")||2.1<=b("esri-android"));b.add("esri-transitions",d||e||10<=c||4<=a||4<=l||3.1<=m||10.5<=g||3.2<=b("esri-iphone")||2.1<=b("esri-android"));b.add("esri-transforms3d",d||
e||10<=a||12<=l||4<=m||3.2<=b("esri-iphone")||3<=b("esri-android"));b.add("esri-url-encodes-apostrophe",function(){if(!h.document)return!1;var a=h.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>b("esri-android")&&(b.add("esri-transforms",!1,!1,!0),b.add("esri-transitions",!1,!1,!0),b.add("esri-transforms3d",!1,!1,!0));b.add("esri-will-change",b("esri-transforms")&&(52<=l||11.1<=m));k._css=function(d){var e=b("esri-transforms3d");void 0!==d&&null!==d?e=d:e&&(l||m&&!b("esri-iphone"))&&
(e=!1);var w=e?"translate3d(":"translate(",v=e?l?",-1px)":",0px)":")",p=e?"scale3d(":"scale(",t=e?",1)":")",n=e?"rotate3d(0,0,1,":"rotate(",k=e?"matrix3d(":"matrix(",h=e?",0,0,":",",D=e?",0,0,0,0,1,0,":",",q=e?",0,1)":")";return{names:{transition:f&&"-webkit-transition"||a&&"MozTransition"||g&&"OTransition"||c&&"msTransition"||"transition",transform:f&&"-webkit-transform"||a&&"MozTransform"||g&&"OTransform"||c&&"msTransform"||"transform",transformName:f&&"-webkit-transform"||a&&"-moz-transform"||
g&&"-o-transform"||c&&"-ms-transform"||"transform",origin:f&&"-webkit-transform-origin"||a&&"MozTransformOrigin"||g&&"OTransformOrigin"||c&&"msTransformOrigin"||"transformOrigin",endEvent:f&&"webkitTransitionEnd"||a&&"transitionend"||g&&"oTransitionEnd"||c&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return w+a+"px,"+b+"px"+v},scale:function(a){return p+a+","+a+t},rotate:function(a){return n+a+"deg)"},matrix:function(b){return k+b.xx+","+b.xy+h+b.yx+","+b.yy+D+b.dx.toFixed(10)+(a&&
59>=a?"px,":",")+b.dy.toFixed(10)+(a&&59>=a?"px":"")+q},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,a.indexOf(",")))}}};k.isiPhone=b("esri-iphone");k.isAndroid=b("esri-android");k.isFennec=b("esri-fennec");k.isBlackBerry=b("esri-blackberry");k.isTouchEnabled=b("esri-touch");k.isPointerEnabled=b("esri-pointer");k._hasCors=b("esri-cors");k._hasFileUpload=b("esri-file-upload");k._hasTransforms=
b("esri-transforms");k._hasTransitions=b("esri-transitions");k._has3DTransforms=b("esri-transforms3d");return b})},"esri/utils":function(){define("./domUtils ./lang ./urlUtils ./request ./tileUtils ./graphicsUtils ./deferredUtils ./layerUtils ./geometry/normalizeUtils".split(" "),function(){return{}})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(b,h,k,a,c){var d={show:function(a){if(a=d.getNode(a))a.style.display="block"},
getNode:function(a){return a&&a.domNode||a},hide:function(a){if(a=d.getNode(a))a.style.display="none"},toggle:function(a){if(a=d.getNode(a))a.style.display="none"===a.style.display?"block":"none"},documentBox:8>=c("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(b){if(b=this.getNode(b)){var c=0,d=0,e=0,m=0,n=0,k=0;return[h.connect(b,"ontouchstart",function(a){c=a.touches[0].screenX;d=a.touches[0].screenY;
e=b.scrollWidth;m=b.scrollHeight;n=b.clientWidth;k=b.clientHeight}),h.connect(b,"ontouchmove",function(f){f.preventDefault();var g=b.firstChild;g instanceof Text&&(g=b.childNodes[1]);var l=g._currentX||0,w=g._currentY||0,l=l+(f.touches[0].screenX-c);0<l?l=0:0>l&&Math.abs(l)+n>e&&(l=-1*(e-n));g._currentX=l;w+=f.touches[0].screenY-d;0<w?w=0:0>w&&Math.abs(w)+k>m&&(w=-1*(m-k));g._currentY=w;a.set(g,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+l+"px, "+w+"px)"});
c=f.touches[0].screenX;d=f.touches[0].screenY})]}}};k.mixin(b,d);return d})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(b,h,k,a,c,d,e,f,g){function l(b,c,d){return[a.isString(b)?b.split(""):b,c||k.global,a.isString(d)?new Function("item","index","array",d):d]}function m(a){return void 0!==a&&null!==a}function n(a){return m(a)?a:""}function q(d,g,l){var v=l.match(/([^\(]+)(\([^\)]+\))?/i),
w=a.trim(v[1]);l=g[d];var v=h.fromJson((v[2]?a.trim(v[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),u=v.utcOffset;if(-1===b.indexOf(p,w))w=a.getObject(w),a.isFunction(w)&&(l=w(l,d,g,v));else if("number"===typeof l||"string"===typeof l&&l&&!isNaN(Number(l)))switch(l=Number(l),w){case "NumberFormat":return e.format(l,v);case "DateString":d=new Date(l);if(v.local||v.systemLocale)return v.systemLocale?d.toLocaleDateString()+(v.hideTime?"":" "+d.toLocaleTimeString()):d.toDateString()+(v.hideTime?
"":" "+d.toTimeString());d=d.toUTCString();v.hideTime&&(d=d.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return d;case "DateFormat":return d=new Date(l),m(u)&&(d=c.add(d,"minute",d.getTimezoneOffset()-u)),f.format(d,v)}return n(l)}function t(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof Object&&t(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var p=["NumberFormat","DateString","DateFormat"],u=/<\/?[^>]+>/g;d={valueOf:function(a,
b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=typeof a;if("string"===b)a=a.replace(u,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(u,"")),a[c]=b}return a},substitute:function(c,d,e){var f,g,l;m(e)&&(a.isObject(e)?(f=e.first,g=e.dateFormat,l=e.numberFormat):f=e);if(d&&"${*}"!==d)return a.replace(d,a.hitch({obj:c},function(a,c){a=c.split(":");return 1<a.length?(c=a[0],a.shift(),q(c,this.obj,a.join(":"))):g&&-1!==b.indexOf(g.properties||
"",c)?q(c,this.obj,g.formatter||"DateString"):l&&-1!==b.indexOf(l.properties||"",c)?q(c,this.obj,l.formatter||"NumberFormat"):n(this.obj[c])}),/\$\{([^\}]+)\}/g);d=[];for(var v in c)if(e=c[v],g&&-1!==b.indexOf(g.properties||"",v)?e=q(v,c,g.formatter||"DateString"):l&&-1!==b.indexOf(l.properties||"",v)&&(e=q(v,c,l.formatter||"NumberFormat")),d.push(v+" \x3d "+n(e)+"\x3cbr/\x3e"),f)break;return d.join("")},filter:function(a,b,c){b=l(a,c,b);c={};var d;a=b[0];for(d in a)b[2].call(b[d],a[d],d,a)&&(c[d]=
a[d]);return c},startsWith:function(a,b,c){c=c||0;return a.indexOf(b,c)===c},endsWith:function(a,b,c){if("number"!==typeof c||!isFinite(c)||Math.floor(c)!==c||c>a.length)c=a.length;c-=b.length;a=a.indexOf(b,c);return-1!==a&&a===c},isDefined:m,fixJson:t,isObject:function(a){return a&&"object"===typeof a},isString:function(a){return"string"===typeof a},mixin:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},clone2DArray:function(a){if(a=a?a.slice(0):null){var b,c=a.length;for(b=
0;b<c;b++)a[b]=a[b]?a[b].slice(0):null}return a},clone3DArray:function(a){if(a=a?a.slice(0):null){var b,c=a.length;for(b=0;b<c;b++){a[b]=a[b]?a[b].slice(0):null;var d=a[b];if(d){var e,f=d.length;for(e=0;e<f;e++)d[e]=d[e]?d[e].slice(0):null}}}return a}};a.mixin(g,d);g._isDefined=m;g._getParts=l;g._sanitize=t;return d})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/global dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(b,
h,k,a,c,d,e,f,g,l){var m={},n=f.defaults.io,q=/^[a-z][a-z0-9\+\-\.]*:/i,t=/^\s*http:/i,p=/^\s*https:/i,u=/:\d+$/,w=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;m.isHTTP=function(b){var c=a.location.protocol;return null==b?"http:"===c||"https:"===c:b?"https:"===c:"http:"===c};m.getProtocolForWebResource=function(b){return m.isHTTP()?a.location.protocol:b?"https:":"http:"};m.urlToObject=function(a){var b={},d=new k(a),e=a.indexOf("?");null===d.query?b={path:a,query:null}:(b.path=a.substring(0,e),
b.query=c.queryToObject(d.query));d.fragment&&(b.hash=d.fragment,null===d.query&&(b.path=b.path.substring(0,b.path.length-(d.fragment.length+1))));return b};m.getProxyUrl=function(c,d){var e=b.isString(c)?0===b.trim(c).toLowerCase().indexOf("https:"):c,f=n.proxyUrl,g,p=l.io.proxyNotSet;b.isString(c)&&(c=m.getProxyRule(c))&&(f=c.proxyUrl);if(!f)throw Error(p);e&&!1!==d&&0!==a.location.href.toLowerCase().indexOf("https:")&&(d=f,0!==d.toLowerCase().indexOf("http")&&(d=m.getAbsoluteUrl(d)),d=d.replace(/^http:/i,
"https:"),m.canUseXhr(d)&&(f=d,g=1));f=m.urlToObject(f);f._xo=g;return f};m.addProxy=function(a){var d=m.getProxyRule(a),e;d?e=m.urlToObject(d.proxyUrl):n.alwaysUseProxy&&(e=m.getProxyUrl());e&&(d=m.urlToObject(a),a=e.path+"?"+d.path,(e=c.objectToQuery(b.mixin(e.query||{},d.query)))&&(a+="?"+e));return a};m.addProxyRule=function(a){var b=a.urlPrefix=m.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),c=n.proxyRules,d,e=c.length,f,g=e;for(d=0;d<e;d++)if(f=
c[d].urlPrefix,0===b.indexOf(f)){if(b.length===f)return-1;g=d;break}else 0===f.indexOf(b)&&(g=d+1);c.splice(g,0,a);return g};m.getProxyRule=function(a){var b=n.proxyRules,c=b.length,d=m.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),e;for(a=0;a<c;a++)if(0===d.indexOf(b[a].urlPrefix)){e=b[a];break}return e};m.hasSameOrigin=function(c,d,e){c=c.toLowerCase();d=d.toLowerCase();var f=a.location.href.toLowerCase();c=0===c.indexOf("http")?new k(c):f=new k(f);d=0===
d.indexOf("http")?new k(d):b.isString(f)?new k(f):f;return(e||c.scheme===d.scheme)&&c.host===d.host&&c.port===d.port};m.canUseXhr=function(a,b){var c=g("esri-phonegap")?!0:!1,d=m.hasSameOrigin,e=n.corsEnabledServers,f,l=-1;!c&&g("esri-cors")&&e&&e.length&&(c=h.some(e,function(b,c){b=!b||"object"!==typeof b||b instanceof RegExp?b:b.host;if(b instanceof RegExp){if(b.test(a))return l=c,!0}else if(b&&(f=0!==b.trim().toLowerCase().indexOf("http"),d(a,f?"http://"+b:b)||f&&d(a,"https://"+b)))return l=c,
!0;return!1}));return b?l:c};m.getAbsoluteUrl=function(c){var e=m.getProtocolForWebResource();return b.isString(c)&&!q.test(c)?0===c.indexOf("//")?e+c:0===c.indexOf("/")?e+"//"+a.location.host+c:d._appBaseUrl+c:c};m.fixUrl=function(a){a=b.trim(a);a=m.getAbsoluteUrl(a);a=m.normalizeSlashes(a);a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2");a=m.downgradeToHTTP(a);return a=m.upgradeToHTTPS(a)};m.normalize=function(a){return m.fixUrl(a)};m.normalizeSlashes=function(a){if(/^https?:\/\//i.test(a)){var b,
c,d=a.indexOf("?");-1<d?(b=a.slice(0,d),c=a.slice(d+1)):b=a;a=b.replace(/\/{2,}/g,"/");a=a.replace("/","//");c&&(a+="?"+c)}return a};m.downgradeToHTTP=function(b){return m.isHTTP(!1)&&p.test(b)&&m.hasSameOrigin(a.location.href,b,!0)&&!m.canUseXhr(b)?b.replace(p,"http:"):b};m.upgradeToHTTPS=function(c){var d=n.httpsDomains,f=m.isHTTP(!1),g=m.isHTTP(!0);if(!t.test(c))return c;c=b.trim(c);var l=c.indexOf("/",7),l=-1===l?c:c.slice(0,l),l=l.toLowerCase().slice(7);if(u.test(l))if(e.endsWith(l,":80"))l=
l.slice(0,-3),c=c.replace(":80","");else return c;if(f&&l===a.location.host&&(!w.test(c)||!m.canUseXhr(c)))return c;f=!1;if(g&&l===a.location.host)f=!0;else if(d)for(var p=0;p<d.length;p++){var D=d[p];if(l===D||e.endsWith(l,"."+D)){f=!0;break}}f||!g||n.alwaysUseProxy||m.getProxyRule(c)||(f=!0);f&&(c=c.replace(t,"https:"));return c};b.mixin(d,m);d._getProxyUrl=m.getProxyUrl;d._getProxiedUrl=m.addProxy;d._hasSameOrigin=m.hasSameOrigin;d._canDoXOXHR=m.canUseXhr;d._getAbsoluteUrl=m.getAbsoluteUrl;d.fixUrl=
m.fixUrl;return m})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr ./core/request/script dojo/request/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w){function v(a){a=new d(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}function B(a){return this._xhr?this._xhr.getResponseHeader(a):null}function A(b,
d){var e=m.objectToQuery(b.content);e&&(b.url+=(-1===b.url.indexOf("?")?"?":"\x26")+e);if(2E3<b.url.length){if("data:"!==b.url.toLowerCase().slice(0,5))return b=new a,b.reject(c.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."})),b;if(3E6<b.url.length)return b=new a,b.reject(c.mixin(Error(),{message:"When using responseType 'image', data URL length cannot exceed 3000000 characters."})),b}var f=new Image;d.allowImageDataAccess&&(f.crossOrigin=b.withCredentials?
"use-credentials":"anonymous");var g=!1,l=new a(function(a){g=!0;f.onload=f.onerror=f.onabort=null;f.src=""});d=function(a){f.onload=f.onerror=f.onabort=null;g||l.reject(Error("Unable to load the resource"))};f.onload=function(){f.onload=f.onerror=f.onabort=null;g||l.resolve(this)};f.onerror=d;f.onabort=d;f.alt="";f.src=b.url;return l}function z(b,d,w,D){var F=!1,v=!1,B,q;p.isDefined(d)&&(c.isObject(d)?(F=!!d.useProxy,v=!!d.usePost,B=d.crossOrigin):F=!!d);b=c.mixin({},b);b._ssl&&(b.url=b.url.replace(/^http:/i,
"https:"));10>t("ie")&&!P.test(b.url)&&(b.url=encodeURI(b.url));var z=b.content,x=b.url,y=w&&b.form,E=Q;B=p.isDefined(B)?B:E.useCors;b.load=function(a){var d;a&&(a.error?(d=c.mixin(Error(),a.error),d.log=!!k.isDebug):"error"===a.status&&(d=c.mixin(Error(),a),d.log=!!k.isDebug),d&&(b.failOk=!d.log,p.isDefined(d.httpCode)||(d.httpCode=d.code)));return d||a};b.error=function(a,d){d&&d.xhr&&d.xhr.abort();a instanceof Error||(a=c.mixin(Error(),a));a.log=!!k.isDebug;b.failOk=!a.log;E.errorHandler(a,d);
return a};b._token&&(b.content=b.content||{},b.content.token=b._token);var I=0,K;z&&x&&(K=m.objectToQuery(z),I=K.length+x.length+1,t("esri-url-encodes-apostrophe")&&(I=K.replace(/'/g,"%27").length+x.length+1));b.timeout=p.isDefined(b.timeout)?b.timeout:E.timeout;b.handleAs=b.handleAs||"json";try{var R,M,N=B&&u.canUseXhr(b.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(b.url),J=u.hasSameOrigin(b.url,window.location.href)||N,L=v||w||I>E.postLength?!0:!1,ia=J||-1===b.handleAs.indexOf("json")||
!b.callbackParamName||w?!1:!0,U=u.getProxyRule(b.url)||E.alwaysUseProxy||F||!("image"===b.handleAs&&!d.allowImageDataAccess||ia&&!L||J)?!0:!1;w&&!t("esri-file-upload")&&!U&&N&&(U=!0);if(U)if(R=u.getProxyUrl(x,B),M=R.path,R._xo&&(N=!0),!L&&M.length+1+I>E.postLength&&(L=!0),b.url=M+"?"+x,L)b.content=c.mixin(R.query||{},z);else{var oa=m.objectToQuery(c.mixin(R.query||{},z));oa&&(b.url+="?"+oa);b.content=null}if(!ia||L||U){var da=b.headers;!N||da&&da.hasOwnProperty("X-Requested-With")||(da=b.headers=
da||{},da["X-Requested-With"]=null);if(w){var ba=b.callbackParamName||"callback.html",pa=b.callbackElementName||"textarea",fa,ka,la,ma,za=y.elements?y.elements.length:0,ra;if(z=b.content)for(fa in z.token&&-1<x.toLowerCase().indexOf("/sharing/servers/")&&(x+=(-1===x.indexOf("?")?"?":"\x26")+"token\x3d"+z.token,b.url=U?M+"?"+x:x,delete z.token),z)if(la=z[fa],p.isDefined(la)){ka=null;for(ma=0;ma<za;ma++)if(ra=y.elements[ma],ra.name===fa){ka=ra;break}ka?ka.value=la:D?y.append(fa,la):y.appendChild(l.create("input",
{type:"hidden",name:fa,value:la}))}if(t("esri-file-upload")){h.forEach(y.elements,function(a){a.name===ba&&y.removeChild(a)});var na=D?y:new FormData(y);if(11<=t("safari")&&"entries"in na&&"delete"in na){D=[];for(var va=na.entries(),sa=va.next();!sa.done;){var ta=sa.value;ta[1]instanceof File&&""===ta[1].name&&D.push(ta[0]);sa=va.next()}D.forEach(function(a){na.delete(a)})}b.contentType=!1;b.postData=na;delete b.form}else{y.enctype="multipart/form-data";9>t("ie")&&(y.encoding="multipart/form-data");
y.method="post";h.some(y.elements,function(a){return a.name===ba})||y.appendChild(l.create("input",{type:"hidden",name:ba,value:pa}));if(-1!==x.toLowerCase().indexOf("addattachment")||-1!==x.toLowerCase().indexOf("updateattachment"))x+=(-1===x.indexOf("?")?"?":"\x26")+ba+"\x3d"+pa,b.url=U?M+"?"+x:x;delete b.content}}if(N&&!b.hasOwnProperty("withCredentials")&&"with-credentials"===Q.useCors){var x=U?M:x,wa=u.canUseXhr(x,!0),ua=-1<wa?Q.corsEnabledServers[wa]:null;if(ua&&ua.hasOwnProperty("withCredentials"))ua.withCredentials&&
(b.withCredentials=!0);else if(n.id){var xa=n.id.findServerInfo(x);xa&&xa.webTierAuth&&(b.withCredentials=!0)}}b=H?H(b):b;if("image"===b.handleAs)return A(b,d);if(L){if(w&&!t("esri-file-upload")){q=new a(function(){Aa.cancel()});var Aa=g.post(b.url,b).then(function(a){q.resolve(a)}).otherwise(function(a){q.reject(a)});q.addCallback(function(a){return b.load(a)});q.addErrback(function(a){return b.error(a)});return q}!U&&t("safari")&&(b.url+=(-1===b.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+
V++);return e.post(b)}return e.get(b)}b=H?H(b):b;b.jsonp=b.callbackParamName;b.query=b.content;q=new a(function(){Ba.cancel()});var Ba=f.get(b.url,b).then(function(a){q.resolve(a)}).otherwise(function(a){q.reject(a)});q.addCallback(function(a){return b.load(a)});q.addErrback(function(a){return b.error(a)});return q}catch(ya){return q=new a,q.errback(b.error(ya)),q}}function y(b){var c=Q.corsStatus,d=u.canUseXhr(b,!0);-1<d&&Q.corsEnabledServers.splice(d,1);var e=new a;e.reject({log:!!k.isDebug});c[v(b)]=
e.promise;return d}function E(b){var c=Q.corsStatus;try{var d=v(b);if(Q.corsDetection&&Q.useCors&&t("esri-cors")&&b&&-1!==b.toLowerCase().indexOf("/rest/services")&&!u.hasSameOrigin(b,window.location.href)&&!u.canUseXhr(b)){if(c[d]&&!c[d].isCanceled())return c[d];var f=new a(w._dfdCanceller);c[d]=f.promise;var g=e.get({url:b.substring(0,b.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*Q.corsDetectionTimeout});f._pendingDfd=
g;g.then(function(a){a?(u.canUseXhr(b)||Q.corsEnabledServers.push(d),f.resolve()):f.reject()},function(a){f.reject(a)});return f.promise}}catch(O){}return L}function D(a){H=a}function x(d,f,g,l){function m(b){b._pendingDfd=z(g,l,E,A);if(!b._pendingDfd){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;var d=Error("Deferred object is missing");d.log=!!k.isDebug;b.errback(d);b._pendingDfd=null;return b}b._pendingDfd.addCallback(function(d){if(!d)return d;var e=b._pendingDfd&&b._pendingDfd.ioArgs&&b._pendingDfd.ioArgs.xhr;
if(!e)return d;if(e=e.getResponseHeader("Content-Type"))if(e=e.toLowerCase(),-1===e.indexOf("text/plain")&&-1===e.indexOf("application/json"))return d;if(d instanceof ArrayBuffer&&750>=d.byteLength)e=new Blob([d]);else if(d instanceof Blob&&750>=d.size)e=d;else return d;var f=new a,g=new FileReader;g.readAsText(e);g.onloadend=function(){var a;if(!g.error)try{var b=JSON.parse(g.result);b.error&&(a=b.error)}catch(ba){}a?(a=c.mixin(Error(),a),a.log=!!k.isDebug,null==a.httpCode&&(a.httpCode=a.code),f.reject(a)):
f.resolve(d)};return f.promise}).addCallback(function(a){b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;l.returnFullResponse&&(a={data:a,_xhr:b.ioArgs&&b.ioArgs.xhr,getHeader:B});b.callback(a);b._pendingDfd=null}).addErrback(function(a){var c,d,e;a&&(c=a.code,d=a.subcode,e=(e=a.messageCode)&&e.toUpperCase());if(a&&403==c&&(4==d||a.message&&-1<a.message.toLowerCase().indexOf("ssl")&&-1===a.message.toLowerCase().indexOf("permission"))){if(!g._ssl){g._ssl=g._sslFromServer=!0;x(b,!0,g,l);return}}else if(a&&
415==a.status){if(y(g.url),!g._err415){g._err415=1;x(b,!0,g,l);return}}else if(n.id&&-1!==h.indexOf(n.id._errorCodes,c)&&!n.id._isPublic(g.url)&&!D&&(403!=c||-1===h.indexOf(N,e)&&(!p.isDefined(d)||2==d&&g._token))){b._pendingDfd=n.id.getCredential(g.url,{token:g._token,error:a});b._pendingDfd.addCallback(function(a){g._token=a.token;g._credential=a;g._ssl=g._sslFromServer||a.ssl;x(b,!0,g,l)}).addErrback(function(a){b.errback(a);b._pendingDfd=null});return}b.ioArgs=b._pendingDfd&&b._pendingDfd.ioArgs;
b.isFulfilled()||b.errback(a);b._pendingDfd=null})}var w=g.form,D=l.disableIdentityLookup,F=l._preLookup,H=!1;if(t("esri-workers")&&!1!==Q.useWorkers)if(!0===l.useWorkers||!0===Q.useWorkers)H=!0;else if(l.workerOptions){var q=l.workerOptions;if(q.callback||q.worker&&q.worker.worker instanceof Worker)H=!0}var A=w&&t("esri-file-upload")&&w instanceof FormData,E=w&&(w.elements?h.some(w.elements,function(a){return"file"===a.type}):A),I=-1!==g.url.toLowerCase().indexOf("token\x3d")||g.content&&g.content.token||
E&&h.some(w.elements,function(a){return"token"===a.name})?1:0;if(!f){d.addCallback(function(a){if((/\/sharing\/rest\/accounts\/self/i.test(g.url)||/\/sharing\/rest\/portals\/self/i.test(g.url))&&!I&&!g._token&&a.user&&a.user.username){Q.webTierAuthServers.push(v(g.url));a=Q.corsEnabledServers;var b=u.canUseXhr(g.url,!0),c={host:v(g.url),withCredentials:!0};if(-1===b)a.push(c);else{var d=a[b];d instanceof RegExp?(c.host=d,a.splice(b,1,c)):"object"===typeof d?d.withCredentials=!0:a.splice(b,1,c)}}if(a=
g._credential)if(b=(b=n.id.findServerInfo(a.server))&&b.owningSystemUrl)b=b.replace(/\/?$/,"/sharing"),(a=n.id.findCredential(b,a.userId))&&-1===n.id._getIdenticalSvcIdx(b,a)&&a.resources.splice(0,0,b)});d.addBoth(function(a){delete g._credential;!a||t("ie")&&a.nodeType||(a._ssl=g._ssl)});var K=g.load,R=g.error;K&&d.addCallback(function(a){var b=d._pendingDfd,b=b&&b.ioArgs;return K.call(b&&b.args,a,b)});R&&d.addErrback(function(a){var b=d._pendingDfd,b=b&&b.ioArgs;return R.call(b&&b.args,a,b)})}!n.id||
I||g._token||n.id._isPublic(g.url)||D&&!F||!(f=n.id.findCredential(g.url))||(g._token=f.token,g._ssl=f.ssl);H?l.workerOptions&&l.workerOptions.worker?(J||(J=e),e=l.workerOptions.worker,m(d)):b(["./workers/RequestClient"],function(a){J||(J=e);if(l.workerOptions){var b=l.workerOptions;e=a.getClient(b.callback,b.cbFunction)}else e=a.getClient();m(d)}):(J&&(e=J,J=null),m(d));return d}function K(b,c){b.url=u.fixUrl(b.url);c=c||{};var d=new a(w._dfdCanceller),e=E(b.url);d._pendingDfd=e;e.always(function(a){a&&
"cancel"===a.dojoType?d.reject(a):x(d,!1,b,c)});return d}var J=null,H,Q=q.defaults.io,N=["COM_0056","COM_0057"],V=0,P=/%[0-9A-F]{2}/i,L=function(){var b=new a;b.resolve();return b.promise}();K._makeRequest=z;K._processRequest=x;K._disableCors=y;K._detectCors=E;K.setRequestPreCallback=D;n.request=K;n._makeRequest=z;n._processRequest=x;n._disableCors=y;n._detectCors=E;n.setRequestPreCallback=D;return K})},"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),
function(b,h,k,a,c,d){function e(){var a=document.createElement("iframe");a.name="esri_core_jsonp_iframe";a.style.display="none";a.setAttribute("sandbox","allow-scripts");if(!d("ff")&&"srcdoc"in a){var e=b.toUrl("dojo/dojo.js"),f=c.replace("../../../dojo/dojo.js",e),e=e.slice(0,-7),f=f.replace("../../../dojo/",e);a.srcdoc=f}else f=b.toUrl("./iframe.html"),"http:"===window.location.protocol&&0===f.indexOf("https:")&&(f=f.replace("https:","http:")),a.src=f;document.body.appendChild(a);return a}function f(){var a=
new MessageChannel;a.port1.addEventListener("message",g);a.port1.start();return a}function g(a){var b=a.data;if("ready"===b){for(var b=0,c=p;b<c.length;b++)a=c[b],m(a,q);p=null}else if(a=u[b.id])delete u[b.id],b.isError?a.dfd.reject(Error(b.message)):a.dfd.resolve(b.response)}function l(a,b){a.addEventListener("load",function(){a.contentWindow.postMessage("init","*",[b.port2])})}function m(a,b){u[a.message.id]=a;b.port1.postMessage(a.message)}Object.defineProperty(h,"__esModule",{value:!0});var n,
q,t=0,p=[],u={};h.get=function(b,c){if(!d("esri-script-sandbox"))return a.get(b,c);var g=null;c&&(g={jsonp:c.jsonp,preventCache:c.preventCache,query:c.query,timeout:c.timeout});c=new k(function(){if(p){var a=p.indexOf(w);-1<a&&p.splice(a,1)}else w.message.id in u&&delete u[w.message.id]});var w={dfd:c,message:{id:"id"+(++t+Math.random()),url:b,options:g}};n||(n=e(),q=f(),l(n,q));p?p.push(w):m(w,q);return c.promise}})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m){function n(a,b){a.canDelete&&w._remove(a.id,b.options.frameDoc,!0)}function q(a){E&&E.length&&(c.forEach(E,function(a){w._remove(a.id,a.frameDoc);a.frameDoc=null}),E=[]);return a.options.jsonp?!a.data:!0}function t(a){return!!this.scriptLoaded}function p(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function u(a,b){if(this.canDelete){var c=this.response.options;E.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&
(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function w(a,b,c){var f=k.parseArgs(a,k.deepCopy({},b));a=f.url;b=f.options;var g=k.deferred(f,n,q,b.jsonp?null:b.checkString?p:t,u);d.mixin(g,{id:v+B++,canDelete:!1});b.jsonp&&((new RegExp("[?\x26]"+b.jsonp+"\x3d")).test(a)||(a+=(~a.indexOf("?")?"\x26":"?")+b.jsonp+"\x3d"+(b.frameDoc?"parent.":"")+v+"_callbacks."+g.id),g.canDelete=!0,y[g.id]=function(a){f.data=a;g.handleResponse(f)});k.notify&&k.notify.emit("send",f,g.promise.cancel);
if(!b.canAttach||b.canAttach(g)){var l=w._attach(g.id,a,b.frameDoc,function(a){if(!(a instanceof Error)){var c=Error("Error loading "+(a.target?a.target.src:"script"));c.source=a;a=c}g.reject(a);w._remove(g.id,b.frameDoc,!0)});if(!b.jsonp&&!b.checkString)var m=e(l,A,function(a){if("load"===a.type||z.test(l.readyState))m.remove(),g.scriptLoaded=a})}h(g);return c?g:g.promise}l.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===
typeof a.opera||"[object Opera]"!==a.opera.toString())});var v=b.id.replace(/[\/\.\-]/g,"_"),B=0,A=l("script-readystatechange")?"readystatechange":"load",z=/complete|loaded/,y=a.global[v+"_callbacks"]={},E=[];w.get=w;w._attach=function(a,b,c,d){c=c||m.doc;var f=c.createElement("script");if(d)e.once(f,"error",d);f.type="text/javascript";try{f.src=b}catch(Q){d&&d(f)}f.id=a;f.async=!0;f.charset="utf-8";return c.getElementsByTagName("head")[0].appendChild(f)};w._remove=function(a,b,c){g.destroy(f.byId(a,
b));y[a]&&(c?y[a]=function(){delete y[a]}:delete y[a])};w._callbacksProperty=v+"_callbacks";return w})},"esri/core/sniff":function(){define(["../sniff"],function(b){return b})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom ../NodeList-manipulate".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n){function q(a){return!this.isFulfilled()}function t(a){return!!this._finished}
function p(a,b){if(!b)try{var e=a.options,g=w.doc(w._frame),l=e.handleAs;if("html"!==l){if("xml"===l)if("html"===g.documentElement.tagName.toLowerCase()){f("a",g.documentElement).orphan();var m=g.documentElement.innerText||g.documentElement.textContent,m=m.replace(/>\s+</g,"\x3e\x3c");a.text=d.trim(m)}else a.data=g;else a.text=g.getElementsByTagName("textarea")[0].value;c(a)}else a.data=g}catch(J){b=J}b?this.reject(b):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}
function u(a){this._callNext()}function w(b,c,d){var e=a.parseArgs(b,a.deepCreate(A,c),!0);b=e.url;c=e.options;if("GET"!==c.method&&"POST"!==c.method)throw Error(c.method+" not supported by dojo/request/iframe");w._frame||(w._frame=w.create(w._iframeName,B+"();"));b=a.deferred(e,null,q,t,p,u);b._callNext=function(){this._calledNext||(this._calledNext=!0,w._currentDfd=null,w._fireNextRequest())};b._legacy=d;w._dfdQueue.push(b);w._fireNextRequest();k(b);return d?b:b.promise}var v=b.id.replace(/[\/\.\-]/g,
"_"),B=v+"_onload";n.global[B]||(n.global[B]=function(){var a=w._currentDfd;if(a){var b=l.byId(a.response.options.form)||a._tmpForm;if(b){for(var c=a._contentToClean,d=0;d<c.length;d++)for(var e=c[d],f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];if(g.name===e){m.destroy(g);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),
b.target=a._originalTarget)}a._tmpForm&&(m.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else w._fireNextRequest()});var A={method:"POST"};w.create=function(a,b,c){if(n.global[a])return n.global[a];if(n.global.frames[a])return n.global.frames[a];c||(g("config-useXDomain")&&g("config-dojoBlankHtmlUrl"),c=g("config-dojoBlankHtmlUrl")||h.toUrl("dojo/resources/blank.html"));b=m.place('\x3ciframe id\x3d"'+a+'" name\x3d"'+a+'" src\x3d"'+c+'" onload\x3d"'+b+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',
n.body());return n.global[a]=b};w.doc=function(a){if(a.contentDocument)return a.contentDocument;var b=a.name;if(b){var c=n.doc.getElementsByTagName("iframe");if(a.document&&c[b].contentWindow&&c[b].contentWindow.document)return c[b].contentWindow.document;if(n.doc.frames[b]&&n.doc.frames[b].document)return n.doc.frames[b].document}return null};w.setSrc=function(a,b,c){a=n.global.frames[a.name];a.contentWindow&&(a=a.contentWindow);try{c?a.location.replace(b):a.location=b}catch(D){}};w._iframeName=
v+"_IoIframe";w._notifyStart=function(){};w._dfdQueue=[];w._currentDfd=null;w._fireNextRequest=function(){var b;try{if(!w._currentDfd&&w._dfdQueue.length){do b=w._currentDfd=w._dfdQueue.shift();while(b&&(b.canceled||b.isCanceled&&b.isCanceled())&&w._dfdQueue.length);if(!b||b.canceled||b.isCanceled&&b.isCanceled())w._currentDfd=null;else{var c=b.response,g=c.options,p=b._contentToClean=[],u=l.byId(g.form),t=a.notify,k=g.data||null,h;b._legacy||"POST"!==g.method||u?"GET"===g.method&&u&&-1<c.url.indexOf("?")&&
(h=c.url.slice(c.url.indexOf("?")+1),k=d.mixin(e.queryToObject(h),k)):u=b._tmpForm=m.create("form",{name:v+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},n.body());if(u){if(!b._legacy){var q=u;do q=q.parentNode;while(q&&q!==n.doc.documentElement);q||(u.style.position="absolute",u.style.left="-1000px",u.style.top="-1000px",n.body().appendChild(u));u.name||(u.name=v+"_form")}if(k){var q=function(a,b){m.create("input",{type:"hidden",name:a,value:b},u);p.push(a)},B;for(B in k){var A=
k[B];if(d.isArray(A)&&1<A.length)for(h=0;h<A.length;h++)q(B,A[h]);else{var P=f("input[name\x3d'"+B+"']",u);-1==P.indexOf()?q(B,A):P.val(A)}}}var L=u.getAttributeNode("action"),F=u.getAttributeNode("method"),I=u.getAttributeNode("target");c.url&&(b._originalAction=L?L.value:null,L?L.value=c.url:u.setAttribute("action",c.url));b._legacy?F&&F.value||(F?F.value=g.method:u.setAttribute("method",g.method)):(b._originalMethod=F?F.value:null,F?F.value=g.method:u.setAttribute("method",g.method));b._originalTarget=
I?I.value:null;I?I.value=w._iframeName:u.setAttribute("target",w._iframeName);u.target=w._iframeName;t&&t.emit("send",c,b.promise.cancel);w._notifyStart(c);u.submit()}else g="",c.options.data&&(g=c.options.data,"string"!==typeof g&&(g=e.objectToQuery(g))),q=c.url+(-1<c.url.indexOf("?")?"\x26":"?")+g,t&&t.emit("send",c,b.promise.cancel),w._notifyStart(c),w.setSrc(w._frame,q,!0)}}}catch(M){b.reject(M)}};a.addCommonMethods(w,["GET","POST"]);return w})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),
function(b,h,k,a,c){function d(a){for(;a.childNodes[0]&&1==a.childNodes[0].nodeType;)a=a.childNodes[0];return a}function e(b,c){"string"==typeof b?(b=a.toDom(b,c&&c.ownerDocument),11==b.nodeType&&(b=b.childNodes[0])):1==b.nodeType&&b.parentNode&&(b=b.cloneNode(!1));return b}var f=b.NodeList;h.extend(f,{_placeMultiple:function(c,d){c="string"==typeof c||c.nodeType?b(c):c;for(var e=[],f=0;f<c.length;f++)for(var g=c[f],l=this.length,p=l-1,u;u=this[p];p--)0<f&&(u=this._cloneNode(u),e.unshift(u)),p==l-
1?a.place(u,g,d):g.parentNode.insertBefore(u,g),g=u;e.length&&(e.unshift(0),e.unshift(this.length-1),Array.prototype.splice.apply(this,e));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(a){if(arguments.length){for(var b=0,d;d=this[b];b++)1==d.nodeType&&c.set(d,"textContent",a);return this}for(var e="",b=0;d=this[b];b++)e+=c.get(d,"textContent");return e},val:function(a){if(arguments.length){for(var b=h.isArray(a),c=0,d;d=this[c];c++){var e=
d.nodeName.toUpperCase(),f=d.type,g=b?a[c]:a;if("SELECT"==e)for(e=d.options,f=0;f<e.length;f++){var u=e[f];u.selected=d.multiple?-1!=k.indexOf(a,u.value):u.value==g}else"checkbox"==f||"radio"==f?d.checked=d.value==g:d.value=g}return this}if((d=this[0])&&1==d.nodeType){a=d.value||"";if("SELECT"==d.nodeName.toUpperCase()&&d.multiple){a=[];e=d.options;for(f=0;f<e.length;f++)u=e[f],u.selected&&a.push(u.value);a.length||(a=null)}return a}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,
"last")},prepend:function(a){return this.addContent(a,"first")},prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:f.prototype.orphan,wrap:function(a){if(this[0]){a=e(a,this[0]);for(var b=0,c;c=this[b];b++){var f=this._cloneNode(a);c.parentNode&&c.parentNode.replaceChild(f,
c);d(f).appendChild(c)}}return this},wrapAll:function(a){if(this[0]){a=e(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);a=d(a);for(var b=0,c;c=this[b];b++)a.appendChild(c)}return this},wrapInner:function(a){if(this[0]){a=e(a,this[0]);for(var b=0;b<this.length;b++){var c=this._cloneNode(a);this._wrap(h._toArray(this[b].childNodes),null,this._NodeListCtor).wrapAll(c)}}return this},replaceWith:function(a){a=this._normalize(a,this[0]);for(var b=0,c;c=this[b];b++)this._place(a,c,"before",0<b),c.parentNode.removeChild(c);
return this},replaceAll:function(a){a=b(a);for(var c=this._normalize(this,this[0]),d=0,e;e=a[d];d++)this._place(c,e,"before",0<d),e.parentNode.removeChild(e);return this},clone:function(){for(var a=[],b=0;b<this.length;b++)a.push(this._cloneNode(this[b]));return this._wrap(a,this,this._NodeListCtor)}});f.prototype.html||(f.prototype.html=f.prototype.innerHTML);return f})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(b,h,k){h={_dfdCanceller:function(a){a.canceled=
!0;var b=a._pendingDfd,d;a.isFulfilled()||!b||b.isFulfilled()||(b.cancel(),d=b.results&&b.results[1]);a._pendingDfd=null;return d},_fixDfd:function(a){var b=a.then;a.then=function(a,c,f){if(a){var d=a;a=function(a){return a&&a._argsArray?d.apply(null,a):d(a)}}return b.call(this,a,c,f)};return a},_resDfd:function(a,b,d){var c=b.length;1===c?d?a.errback(b[0]):a.callback(b[0]):1<c?(b._argsArray=!0,a.callback(b)):a.callback()}};b.mixin(k,h);return h})},"esri/tileUtils":function(){define(["dojo/_base/array",
"dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(b,h,k,a,c){h={_addFrameInfo:function(a,c){var d,e,l=2*c.origin[1],m=c.origin[0],n=a.origin.x,k=a.width,t;b.forEach(a.lods,function(a){d=Math.round(l/a.resolution);e=Math.ceil(d/k);t=Math.floor((m-n)/(k*a.resolution));a._frameInfo||(a._frameInfo=[e,t,t+e-1,d])})},getContainingTileCoords:function(a,b,c){var d=a.origin;c=c.resolution;return{row:Math.floor((d.y-b.y)/(a.height*c)),col:Math.floor((b.x-d.x)/(a.width*c))}},getCandidateTileInfo:function(b,
e,f){var d;d=b.width;for(var l=b.height,m=f.xmax-f.xmin,n=f.ymax-f.ymin,k=b.__tileInfo===e,t=k?b.getMinZoom():-1,k=k?b.getMaxZoom():-1,p=-1,u=e.lods,w=Math.abs,v,h,A,k=-1<k?k:u.length-1,t=-1<t?t:0;t<=k;t++)if(h=u[t])if(A=m>n?w(n-l*h.resolution):w(m-d*h.resolution),0>p||A<=p)v=h,p=A;else break;d=v;v=d.resolution;l=(f.xmin+f.xmax)/2;m=(f.ymin+f.ymax)/2;n=b.width/2*v;v*=b.height/2;l=new c(l-n,m-v,l+n,m+v,f.spatialReference);f=new a(l.xmin,l.ymax,f.spatialReference);k=d.resolution;n=e.width;m=e.height;
e=e.origin;b=b.__visibleDelta;v=Math.floor;u=n*k;w=m*k;k=v((e.y-f.y)/w);p=v((f.x-e.x)/u);t=e.y-k*w;e=v(Math.abs((f.x-(e.x+p*u))*n/u))+b.x;b=v(Math.abs((f.y-t)*m/w))+b.y;return{tile:{point:f,coords:{row:k,col:p},offsets:{x:e,y:b}},lod:d,extent:l}},getTileExtent:function(a,b,f,g){var d=a.origin;b=a.lods[b].resolution;var e=a.width,n=a.height;return new c(g*b*e+d.x,d.y-(f+1)*b*n,(g+1)*b*e+d.x,d.y-f*b*n,a.spatialReference)}};return k.TileUtils=h})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),
function(b,h,k,a,c,d,e,f){function g(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function l(a,b,c){a=a/6378137*57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function m(){}function n(){}function q(a){var b=a._json;a._unquantizeFn?
(b=a._unquantizeFn({x:b.x,y:b.y}),a._xVal=b.x,a._yVal=b.y,a._unquantizeFn=null):(a._xVal=b.x,a._yVal=b.y);a._json=null}k={type:"point",x:0,y:0};b=b(e,{declaredClass:"esri.geometry.Point",type:"point",x:0,y:0,constructor:function(a,b,d){h.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=b):c.isObject(a)?(c.mixin(this,a),null!=this.latitude&&(this.y=this.latitude),null!=this.longitude&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=f.createSpatialReference(this.spatialReference))):
(this.x=a,this.y=b,this.spatialReference=d);this.verifySR()},offset:function(a,b){return new this.constructor(this.x+a,this.y+b,this.spatialReference)},setX:function(a){this.x=a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(g(a,this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(g(this.x,
a)[1]):4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=l(this.x,this.y)[0]:4326===a.wkid&&(b=this.x));return b},getLatitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=l(this.x,this.y)[1]:4326===a.wkid&&(b=this.y));return b},update:function(a,b){this.x=a;this.y=b;this.clearCache();return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var c=b._getInfo();c&&(a=this._normalizeX(a,c))}return new this.constructor(a,
this.y,b)},_normalizeX:function(a,b){var c=b.valid[0],d=b.valid[1];b=2*d;a>d?(c=Math.ceil(Math.abs(a-d)/b),a-=c*b):a<c&&(c=Math.ceil(Math.abs(a-c)/b),a+=c*b);return a},toJson:function(){var a={x:this.x,y:this.y},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});m.prototype=b.prototype;n.prototype=new m;Object.defineProperty(n.prototype,"x",{get:function(){this._json&&q(this);return this._xVal},set:function(a){this._xVal=a}});Object.defineProperty(n.prototype,"y",{get:function(){this._json&&
q(this);return this._yVal},set:function(a){this._yVal=a}});n.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._json=b};b.simpleConstructor=m;b.accessorConstructor=n;b.lngLatToXY=g;b.xyToLngLat=l;b.defaultProps=k;b.metersPerDegree=6378137*Math.PI/180;h.setObject("geometry.Point",b,a);a.geometry.defaultPoint=k;return b})},"esri/SpatialReference":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/has","./kernel","./lang"],function(b,h,k,a,c){function d(){}k=[-2.0037508342788905E7,
2.0037508342788905E7];var e=[-2.0037508342787E7,2.0037508342787E7];b=b(null,{declaredClass:"esri.SpatialReference",constructor:function(a){a&&(c.isObject(a)?c.mixin(this,a):c.isString(a)?this.wkt=a:this.wkid=a)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:k,origin:e,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:k,origin:e,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:k,origin:e,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:k,origin:e,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==h.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==h.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var b=!1;a&&(b=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid);return b},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var b=!1;a&&(this===a&&
(b=!0),this.wkid||a.wkid?b=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(b=this.wkt.toUpperCase()===a.wkt.toUpperCase()));return b},toJson:function(){var a=null;null!=this.wkid?a={wkid:this.wkid}:null!=this.wkt&&(a={wkt:this.wkt});a&&null!=this.latestWkid&&(a.latestWkid=this.latestWkid);return a}});d.prototype=b.prototype;b.simpleConstructor=d;return a.SpatialReference=b})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(b,h,k,a,c){b=b(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){this.spatialReference=a;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new c(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,b){this.cache||
(this.cache={});this.cache[a]=b}});h.setObject("geometry.Geometry",b,a);return b})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(b,h,k,a,c){function d(a){var b=!1;a&&(a.ics||a.icsid)&&(b=!0);return b}a={isICS:d,createSpatialReference:function(a){var c=null;a&&(c=d(a)?new h(a):new b(a));return c}};c.mixin(k,a);return a})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),
function(b,h,k,a,c,d){b=b(d,{declaredClass:"esri.ImageSpatialReference",constructor:function(a){a&&h.isObject(a)&&h.mixin(this,a)},icsid:null,icsns:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(a){var b=!1;if(a)if(this.icsid&&a.icsid){if(b=this.icsid===a.icsid,this.icsns||a.icsns)b=b&&this.icsns===a.icsns}else this.ics&&a.ics&&(b=this.ics===a.ics);return b},toJson:function(a){var b=null,d=c.isDefined;a=d(a)?a:!0;d(this.icsid)?(b={icsid:this.icsid},
d(this.icsns)&&(b.icsns=this.icsns)):d(this.ics)&&(b={ics:this.ics});d(this.url)&&d(b)&&a&&(b.url=this.url);return b}});return a.ImageSpatialReference=b})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n){function q(){}a={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0};var t=b(f,{declaredClass:"esri.geometry.Extent",
type:"extent",xmin:0,ymin:0,xmax:0,ymax:0,constructor:function(a,b,c,e,f){d.isObject(a)?(d.mixin(this,a),this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference))):this.update(a,b,c,e,f);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),
c=a.x-b.x;a=a.y-b.y;return new t(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},update:function(a,b,c,d,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=d;this.spatialReference=e;this.clearCache();return this},offset:function(a,b){return new t(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=this.getHeight();return new t(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;
var b=a.type,c=this.spatialReference,d=a.spatialReference;c&&d&&!c.equals(d)&&c._canProject(d)&&(a=c.isWebMercator()?l.geographicToWebMercator(a):l.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);k.isArray(a)||(a=[a]);
return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,b=a&&a._getInfo(),c=[],d=0;if(b&&this._isOutOfBounds(b)){var f=this,d=f.xmin,g=f.ymin,l=f.ymax,m=b.valid[0],n=b.valid[1];f.getWidth()>2*n&&(f=f.getCenter(),f=new t(f.x-n,g,f.x+n,l,new e(a.toJson())));var d=f.xmin-d,D=this._normalizeX(f.xmin,b),b=this._normalizeX(f.xmax,b);D.frameId===b.frameId?c.push(new t(D.x,g,b.x,l,new e(a.toJson()))):c.push(new t(D.x,g,n,l,new e(a.toJson())),new t(m,
g,b.x,l,new e(a.toJson())))}else c.push(this.getExtent());return{extents:c,marginLeft:d}},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c,d,e,f=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?f=!0:d=Math.min(this.xmax,a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?f=!0:e=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?f=!0:
e=Math.min(this.ymax,a.ymax)-c);return f?null:new t(b,c,b+d,c+e,this.spatialReference)},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],d=[this.xmin,this.ymin],e=[this.xmax,this.ymin],f=[b,c,d,e],b=[[d,b],[b,c],[c,e],[e,d]],d=a.rings,e=d.length,l,m=new g(0,0,this.spatialReference);l=f.length;for(c=0;c<l;c++)if(m.update(f[c][0],f[c][1]),a.contains(m))return!0;m.setSpatialReference(a.spatialReference);for(var n,p,c=0;c<e;c++)if(f=d[c],l=f.length){n=f[0];m.update(n[0],
n[1]);if(this.contains(m))return!0;for(a=1;a<l;a++){p=f[a];m.update(p[0],p[1]);if(this.contains(m)||this._intersectsLine([n,p],b))return!0;n=p}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,d=a.paths,e=d.length,f,l,m,n,p=new g(0,0,a.spatialReference);for(a=0;a<e;a++)if(f=d[a],l=f.length){m=f[0];p.update(m[0],m[1]);
if(this.contains(p))return!0;for(c=1;c<l;c++){n=f[c];p.update(n[0],n[1]);if(this.contains(p)||this._intersectsLine([m,n],b))return!0;m=n}}return!1},_intersectsLine:function(a,b){var c=m._getLineIntersection2,d,e=b.length;for(d=0;d<e;d++)if(c(a,b[d]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,d=a.spatialReference,b=a.x;a=a.y;c&&d&&!c.equals(d)&&c._canProject(d)&&(a=c.isWebMercator()?g.lngLatToXY(b,a):g.xyToLngLat(b,a,!0),b=a[0],a=
a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=a.xmin,c=a.ymin,d=a.xmax,e=a.ymax,f=a.spatialReference;a=new g(b,c,f);b=new g(b,e,f);e=new g(d,e,f);c=new g(d,c,f);return this.contains(a)&&this.contains(b)&&this.contains(e)&&this.contains(c)?!0:!1},union:function(a){return new t(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},
getExtent:function(){var a=this.spatialReference;return new t(this.xmin,this.ymin,this.xmax,this.ymax,a&&new e(a.toJson()))},_shiftCM:function(a){var b=this.getCacheValue("_shifted");if(!b){var b=new t(this.toJson()),c=b.spatialReference;if(a=a||c._getInfo()){var f=this._getCM(a);if(f){var g=c._isWebMercator()?l.webMercatorToGeographic(f):f;b.xmin-=f.x;b.xmax-=f.x;c._isWebMercator()||(g.x=this._normalizeX(g.x,a).x);b.setSpatialReference(new e(d.substitute({Central_Meridian:g.x},4326===c.wkid?a.altTemplate:
a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b;this._isOutOfBounds(a)&&(b=this.getCenter());return b},_isOutOfBounds:function(a){var b=a.valid[0];a=a.valid[1];var c=this.xmin,d=this.xmax;return!(c>=b&&c<=a&&d>=b&&d<=a)},_normalize:function(a,b,c){var d=new t(this.toJson()),e=d.spatialReference;if(e&&(c=c||e._getInfo())){var f=h.map(this._getParts(c),function(a){return a.extent});return 2<f.length?a?this._shiftCM(c):d.update(c.valid[0],d.ymin,c.valid[1],d.ymax,
e):2===f.length?a?this._shiftCM(c):b?f:{rings:h.map(f,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:e}:f[0]||d}return d},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,d=this.xmax,e=this.ymin,f=this.ymax,g=this.spatialReference,l=this.getWidth(),m=c,n=d,k=0,h=0,p,H;a=a||g._getInfo();p=a.valid[0];H=a.valid[1];h=this._normalizeX(c,a);c=h.x;k=h.frameId;h=this._normalizeX(d,a);d=h.x;h=h.frameId;
a=c===d&&0<l;if(l>2*H){l=new t(m<n?c:d,e,H,f,g);c=new t(p,e,m<n?d:c,f,g);H=new t(0,e,H,f,g);e=new t(p,e,0,f,g);g=[];p=[];l.contains(H)&&g.push(k);l.contains(e)&&p.push(k);c.contains(H)&&g.push(h);c.contains(e)&&p.push(h);for(f=k+1;f<h;f++)g.push(f),p.push(f);b.push({extent:l,frameIds:[k]},{extent:c,frameIds:[h]},{extent:H,frameIds:g},{extent:e,frameIds:p})}else c>d||a?b.push({extent:new t(c,e,H,f,g),frameIds:[k]},{extent:new t(p,e,d,f,g),frameIds:[h]}):b.push({extent:new t(c,e,d,f,g),frameIds:[k]});
this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,d=b.valid[0],e=b.valid[1];b=2*e;a>e?(c=Math.ceil(Math.abs(a-e)/b),a-=c*b):a<d&&(c=Math.ceil(Math.abs(a-d)/b),a+=c*b,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});q.prototype=t.prototype;t.simpleConstructor=q;t.defaultProps=a;k.setObject("geometry.Extent",t,c);c.geometry.defaultExtent=a;
return t})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(b,h,k,a,c,d){function e(a,d,e,f){if("point"===a.type){var g=d(a.x,a.y,f);return new a.constructor(g[0],g[1],new c(e))}if("extent"===a.type){var g=d(a.xmin,a.ymin,f),l=d(a.xmax,a.ymax,f);return new a.constructor(g[0],g[1],l[0],l[1],new c(e))}if("polyline"===a.type||"polygon"===a.type){var g="polyline"===a.type,m=[],n;b.forEach(g?a.paths:
a.rings,function(a){m.push(n=[]);b.forEach(a,function(a){n.push(d(a[0],a[1],f))})});return g?new a.constructor({paths:m,spatialReference:new c(e)}):new a.constructor({rings:m,spatialReference:new c(e)})}if("multipoint"===a.type){var k=[];b.forEach(a.points,function(a){k.push(d(a[0],a[1],f))});return new a.constructor({points:k,spatialReference:new c(e)})}}function f(a,b){a=a&&(null!=a.wkid?a:a.spatialReference);b=b&&(null!=b.wkid?b:b.spatialReference);return a&&b?b.equals(a)?!0:b._canProject(a):!1}
k={canProject:f,project:function(a,b){var c=a&&a.spatialReference;b=b&&(null!=b.wkid?b:b.spatialReference);c&&b?c.equals(b)?a=new a.constructor(a.toJson()):f(c,b)?b.isWebMercator()?a=e(a,d.lngLatToXY,{wkid:102100}):4326===b.wkid&&(a=e(a,d.xyToLngLat,{wkid:4326})):a=null:a=null;return a},lngLatToXY:d.lngLatToXY,xyToLngLat:d.xyToLngLat,metersPerDegree:d.metersPerDegree,geographicToWebMercator:function(a){return e(a,d.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(a,b){return e(a,d.xyToLngLat,
{wkid:4326},b)}};h.mixin(h.getObject("geometry",!0,a),k);return k})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(b,h,k,a){function c(b,c,d){return b instanceof a?new a(b.x+d*(c.x-b.x),b.y+d*(c.y-b.y)):[b[0]+d*(c[0]-b[0]),b[1]+d*(c[1]-b[1])]}function d(a,b){return 1E-8>Math.abs(a-b)}function e(a,b,c,e){var f,g=d(a[0],b[0])?1E10:(a[1]-b[1])/(a[0]-b[0]),l=d(c[0],e[0])?1E10:(c[1]-e[1])/(c[0]-e[0]),m=a[1]-g*a[0],k=c[1]-l*c[0];if(d(g,l)){if(d(m,
k)){if(d(a[0],b[0]))if(Math.min(a[1],b[1])<Math.max(c[1],e[1])||Math.max(a[1],b[1])>Math.min(c[1],e[1]))a=(a[1]+b[1]+c[1]+e[1]-Math.min(a[1],b[1],c[1],e[1])-Math.max(a[1],b[1],c[1],e[1]))/2,f=(a-m)/g;else return null;else if(Math.min(a[0],b[0])<Math.max(c[0],e[0])||Math.max(a[0],b[0])>Math.min(c[0],e[0]))f=(a[0]+b[0]+c[0]+e[0]-Math.min(a[0],b[0],c[0],e[0])-Math.max(a[0],b[0],c[0],e[0]))/2,a=g*f+m;else return null;return[f,a]}return null}d(g,1E10)?(f=a[0],a=l*f+k):d(l,1E10)?(f=c[0],a=g*f+m):(f=-(m-
k)/(g-l),a=a[1]===b[1]?a[1]:c[1]===e[1]?c[1]:g*f+m);return[f,a]}h={getLength:function(a,b){var c=b.x-a.x;a=b.y-a.y;return Math.sqrt(c*c+a*a)},_getLength:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)},getPointOnLine:c,getMidpoint:function(a,b){return c(a,b,.5)},_equals:d,_getLineIntersection:e,getLineIntersection:function(b,c,d,m,k){(b=e([b.x,b.y],[c.x,c.y],[d.x,d.y],[m.x,m.y]))&&(b=new a(b[0],b[1],k));return b},_getLineIntersection2:function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1];
b=c[0];c=c[1];a=d[0];var d=d[1],g=e[0],k=e[1],e=f[0]-g,g=b-g,u=a-b,f=f[1]-k,k=c-k,h=d-c,v=f*u-e*h;if(0===v)return!1;e=(e*k-f*g)/v;g=(u*k-h*g)/v;return 0<=e&&1>=e&&0<=g&&1>=g?[b+e*(a-b),c+e*(d-c)]:!1},_pointLineDistance:function(a,b){var c=b[0],d=b[1];b=c[0];var e=c[1],c=a[0];a=a[1];var f=d[0]-b,g=d[1]-e,k=c-b,u=a-e,d=Math.sqrt,h=Math.pow,v=d(h(f,2)+h(g,2)),k=(k*f+u*g)/(v*v),e=e+k*g;return d(h(c-(b+k*f),2)+h(a-e,2))}};b.mixin(b.getObject("geometry",!0,k),h);return h})},"esri/graphicsUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(b,h,k,a,c){k={graphicsExtent:function(a){if(!a||!a.length)return null;var b=a[0].geometry,d=b.getExtent(),g,l,m=a.length;null===d&&(d=new c(b.x,b.y,b.x,b.y,b.spatialReference));for(l=1;l<m;l++)g=(b=a[l].geometry).getExtent(),null===g&&(g=new c(b.x,b.y,b.x,b.y,b.spatialReference)),d=d.union(g);return 0>d.getWidth()&&0>d.getHeight()?null:d},getGeometries:function(a){return h.map(a,function(a){return a.geometry})},_encodeGraphics:function(a,
b){var c=[],d,e,m;h.forEach(a,function(a,f){d=a.toJson();e={};d.geometry&&(m=b&&b[f],e.geometry=m&&m.toJson()||d.geometry);d.attributes&&(e.attributes=d.attributes);c[f]=e});return c}};b.mixin(a,k);return k})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(b,h,k,a,c){a={_serializeLayerDefinitions:function(a,b){var c=[],d=/[:;]/;if(a&&(h.forEach(a,function(a,e){a&&(c.push([e,a]),!b&&d.test(a)&&(b=!0))}),0<c.length)){var e;
b?(e={},h.forEach(c,function(a){e[a[0]]=a[1]}),e=k.toJson(e)):(e=[],h.forEach(c,function(a){e.push(a[0]+":"+a[1])}),e=e.join(";"));return e}return null},_serializeTimeOptions:function(a,b){if(a){var c=[];h.forEach(a,function(a,d){a&&(a=a.toJson(),b&&-1!==h.indexOf(b,d)&&(a.useTime=!1),c.push('"'+d+'":'+k.toJson(a)))});if(c.length)return"{"+c.join(",")+"}"}},_getVisibleLayers:function(a,b){var c=[],d,e;if(!a)return c;if(b)for(c=b.concat(),e=0;e<a.length;e++)b=a[e],d=h.indexOf(a,b.id),b.subLayerIds&&
-1<d&&(c.splice(d,1),c=c.concat(b.subLayerIds));else c=this._getDefaultVisibleLayers(a);return c},_getDefaultVisibleLayers:function(a){var b=[],c;if(!a)return b;for(c=0;c<a.length;c++)0<=a[c].parentLayerId&&-1===h.indexOf(b,a[c].parentLayerId)&&h.some(a,function(b){return b.id===a[c].parentLayerId})||a[c].defaultVisibility&&b.push(a[c].id);return b},_getLayersForScale:function(a,b){var c=[];if(0<a&&b){var d;for(d=0;d<b.length;d++)if(!(0<=b[d].parentLayerId&&-1===h.indexOf(c,b[d].parentLayerId)&&h.some(b,
function(a){return a.id===b[d].parentLayerId}))&&0<=b[d].id){var e=!0,m=b[d].maxScale,k=b[d].minScale;if(0<m||0<k)0<m&&0<k?e=m<=a&&a<=k:0<m?e=m<=a:0<k&&(e=a<=k);e&&c.push(b[d].id)}}return c}};b.mixin(c,a);return a})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n){function q(a,b){return Math.ceil((a-
b)/(2*b))}function t(a,b){var c=a.paths||a.rings,d,e,f=c.length,g;for(d=0;d<f;d++)for(g=c[d].length,e=0;e<g;e++){var m=a.getPoint(d,e);a.setPoint(d,e,m.offset(b,0))}return a}function p(a,c){if(!(a instanceof g||a instanceof l))throw Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var d=a instanceof g,e=[],f;b.forEach(d?a.paths:a.rings,function(a){e.push(f=[]);f.push([a[0][0],a[0][1]]);var b,d,g,m,l,k,u,h,n,D,t,w;for(l=0;l<a.length-1;l++){b=a[l][0];d=a[l][1];g=a[l+
1][0];m=a[l+1][1];u=Math.sqrt((g-b)*(g-b)+(m-d)*(m-d));h=(m-d)/u;n=(g-b)/u;D=u/c;if(1<D){for(k=1;k<=D-1;k++)w=k*c,t=n*w+b,w=h*w+d,f.push([t,w]);k=(u+Math.floor(D-1)*c)/2;t=n*k+b;w=h*k+d;f.push([t,w])}f.push([g,m])}});return d?new g({paths:e,spatialReference:a.spatialReference}):new l({rings:e,spatialReference:a.spatialReference})}function u(a,b,c){b&&(a=p(a,1E6),a=m.webMercatorToGeographic(a,!0));c&&(a=t(a,c));return a}function w(a,b,c){var d=a.x||a[0],e;d>b?(e=q(d,b),a.x?a=a.offset(-2*e*b,0):a[0]=
d+-2*e*b):d<c&&(e=q(d,c),a.x?a=a.offset(-2*e*c,0):a[0]=d+-2*e*c);return a}function v(a,c){var d=-1;b.forEach(c.cutIndexes,function(e,f){var g=c.geometries[f];b.forEach(g.rings||g.paths,function(a,c){b.some(a,function(b){if(!(180>b[0])){b=0;var d,e=a.length,f;for(d=0;d<e;d++)f=a[d][0],b=f>b?f:b;b=Number(b.toFixed(9));b=-360*q(b,180);e=a.length;for(d=0;d<e;d++)f=g.getPoint(c,d),g.setPoint(c,d,f.offset(b,0))}return!0})});e===d?g.rings?b.forEach(g.rings,function(b){a[e]=a[e].addRing(b)}):b.forEach(g.paths,
function(b){a[e]=a[e].addPath(b)}):(d=e,a[e]=g)});return a}function B(a,c,e,f){var h=new k;h.addCallbacks(e,f);c=c||d.defaults.geometryService;var D=[],p=[],B,A,y,F,x,E,z,K,O=0;b.forEach(a,function(a){if(a)if(B||(B=a.spatialReference,A=B._getInfo(),F=(y=B._isWebMercator())?2.0037508342788905E7:180,x=y?-2.0037508342788905E7:-180,E=y?102100:4326,z=new g({paths:[[[F,x],[F,F]]],spatialReference:{wkid:E}}),K=new g({paths:[[[x,x],[x,F]]],spatialReference:{wkid:E}})),A){var c=n.fromJson(a.toJson()),d=a.getExtent();
"point"===a.type?D.push(w(c,F,x)):"multipoint"===a.type?(c.points=b.map(c.points,function(a){return w(a,F,x)}),D.push(c)):"extent"===a.type?(c=d._normalize(null,null,A),D.push(c.rings?new l(c):c)):d?(a=2*q(d.xmin,x)*F,c=0===a?c:t(c,a),d=d.offset(a,0),d.intersects(z)&&d.xmax!==F?(O=d.xmax>O?d.xmax:O,c=u(c,y),p.push(c),D.push("cut")):d.intersects(K)&&d.xmin!==x?(O=2*d.xmax*F>O?2*d.xmax*F:O,c=u(c,y,360),p.push(c),D.push("cut")):D.push(c)):D.push(c)}else D.push(a);else D.push(a)});e=new g;f=q(O,F);for(var W=
-90,Y=f;0<f;){var J=-180+360*f;e.addPath([[J,W],[J,-1*W]]);W*=-1;f--}0<p.length&&0<Y?c?c.cut(p,e,function(d){p=v(p,d);var e=[];b.forEach(D,function(b,c){"cut"===b&&(b=p.shift(),a[c].rings&&1<a[c].rings.length&&b.rings.length>=a[c].rings.length?(D[c]="simplify",e.push(b)):D[c]=!0===y?m.geographicToWebMercator(b):b)});0<e.length?c.simplify(e,function(a){b.forEach(D,function(b,c){"simplify"===b&&(D[c]=!0===y?m.geographicToWebMercator(a.shift()):a.shift())});h.callback(D)},function(a){h.errback(a)}):
h.callback(D)},function(a){h.errback(a)}):h.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(b.forEach(D,function(a,b){"cut"===a&&(a=p.shift(),D[b]=!0===y?m.geographicToWebMercator(a):a)}),h.callback(D));return h}function A(a,c,d,e){var f=!1,g;h.isObject(a)&&a&&(h.isArray(a)?a.length&&((g=a[0]&&a[0].declaredClass)&&-1!==g.indexOf("Graphic")?(a=b.map(a,function(a){return a.geometry}),f=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(f=!0)):(g=
a.declaredClass)&&-1!==g.indexOf("FeatureSet")?(a=b.map(a.features||[],function(a){return a.geometry}),f=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(f=!0));f&&c.push({index:d,property:e,value:a})}function z(a,c){var d=[];b.forEach(c,function(c){var e=c.i,f=a[e];c=c.p;var g;if(h.isObject(f)&&f)if(c)if("*"===c[0])for(g in f)f.hasOwnProperty(g)&&A(f[g],d,e,g);else b.forEach(c,function(a){A(h.getObject(a,!1,f),d,e,a)});else A(f,d,e)});return d}function y(a,c){var d=0,e={};b.forEach(c,function(b){var c=
b.index,f=b.property,g=b.value,m=g.length||1,l=a.slice(d,d+m);h.isArray(g)||(l=l[0]);d+=m;delete b.value;f?(e[c]=e[c]||{},e[c][f]=l):e[c]=l});return e}function E(a){for(var b=[],c=0,d=0,e=Math.min,f=Math.max,g=0;g<a.length;g++){for(var m=a[g],l=null,k=0;k<m.length;k++)l=m[k],b.push(l),0===k?d=c=l[0]:(c=e(c,l[0]),d=f(d,l[0]));l&&b.push([(c+d)/2,0])}return b}a={normalizeCentralMeridian:B,_foldCutResults:v,_prepareGeometryForCut:u,_offsetMagnitude:q,_pointNormalization:w,_updatePolyGeometry:t,_straightLineDensify:p,
_createWrappers:function(a){var c=h.isObject(a)?a.prototype:h.getObject(a+".prototype");b.forEach(c.__msigns,function(a){var d=c[a.n];c[a.n]=function(){var c=this,f=[],g,m=new k(e._dfdCanceller);a.f&&e._fixDfd(m);for(g=0;g<a.c;g++)f[g]=arguments[g];var l={dfd:m};f.push(l);var u,h=[],n;c.normalization&&!c._isTable&&(u=z(f,a.a),b.forEach(u,function(a){h=h.concat(a.value)}),h.length&&(n=B(h)));n?(m._pendingDfd=n,n.addCallbacks(function(a){m.canceled||(l.assembly=y(a,u),m._pendingDfd=d.apply(c,f))},function(b){var d=
c.declaredClass;d&&-1!==d.indexOf("FeatureLayer")?c._resolve([b],null,f[a.e],m,!0):c._errorHandler(b,f[a.e],m)})):m._pendingDfd=d.apply(c,f);return m}})},_disassemble:z,_addToBucket:A,_reassemble:y,getDenormalizedExtent:function(a){if(!a)return null;var b=a.getExtent();if(!b)return null;var c=a.spatialReference&&a.spatialReference._getInfo();if(!c)return b;var d=c.valid[0],c=c.valid[1],e=2*c,g=b.getWidth(),m=b.xmax,l=b.xmin;if("extent"===a.type||0===g||g<=c||g>e||m<d||l>c)return b;var k;switch(a.type){case "polygon":if(1<
a.rings.length)k=E(a.rings);else return b;break;case "polyline":if(1<a.paths.length)k=E(a.paths);else return b;break;case "multipoint":k=a.points}a=Math.min;for(var d=Math.max,e=new f(b.toJson()),u=0;u<k.length;u++){var h=k[u][0];0>h?(h+=c,l=d(h,l)):(h-=c,m=a(h,m))}e.xmin=m;e.xmax=l;return e.getWidth()<g?(e.xmin-=c,e.xmax-=c,e):b}};h.mixin(h.getObject("geometry",!0,c),a);return a})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m){function n(){}function q(){}a={type:"polyline",paths:null};b=b(f,{declaredClass:"esri.geometry.Polyline",type:"polyline",paths:null,constructor:function(a){this.paths=[];this._path=0;a&&(k.isArray(a)?this.paths=k.isArray(a[0][0])?a:[a]:a.paths?d.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=m.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=
[];k.isArray(a[0])?h.forEach(a,this._addPointArr,this):h.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._path=b;this.paths[this._path]||(this.paths[this._path]=[]);h.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?
!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new g(this.paths[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&null!=b&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[c.x,c.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,
d=this.spatialReference;for(b=0;b<c;b++)a[b]=new g(a[b],d);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new g(this.paths[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new l(a),a._partwise=b,a;a=this.paths;var c=a.length;if(c&&a[0].length){var d,e,f,g,m,k,h,n,q=g=a[0][0][0],K=m=a[0][0][1],J=Math.min,H=Math.max,Q=this.spatialReference,b=[],N,V,P,L;
for(k=0;k<c;k++){d=a[k];N=V=d[0]&&d[0][0];P=L=d[0]&&d[0][1];n=d.length;for(h=0;h<n;h++)e=d[h],f=e[0],e=e[1],q=J(q,f),K=J(K,e),g=H(g,f),m=H(m,e),N=J(N,f),P=J(P,e),V=H(V,f),L=H(L,e);b.push(new l({xmin:N,ymin:P,xmax:V,ymax:L,spatialReference:Q?Q.toJson():null}))}a={xmin:q,ymin:K,xmax:g,ymax:m,spatialReference:Q?Q.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new l(a);a._partwise=b;return a}},toJson:function(){var a={paths:d.clone3DArray(this.paths)},
b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});n.prototype=b.prototype;q.prototype=new n;Object.defineProperty(q.prototype,"paths",{get:function(){this._unquantizeFn&&(this._pathsVal=this._unquantizeFn({paths:d.clone3DArray(this._pathsVal)}).paths,this._unquantizeFn=null);return this._pathsVal},set:function(a){this._pathsVal=a}});q.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._pathsVal=b.paths};b.simpleConstructor=n;b.accessorConstructor=q;b.defaultProps=
a;k.setObject("geometry.Polyline",b,c);c.geometry.defaultPolyline=a;return b})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n){function q(){}function t(){}a={type:"polygon",rings:null};var p=b(f,{declaredClass:"esri.geometry.Polygon",type:"polygon",rings:null,constructor:function(a){this.rings=[];this._ring=
0;a&&(k.isArray(a)?this.rings=k.isArray(a[0][0])?a:[a]:a.rings?d.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];k.isArray(a[0])?h.forEach(a,this._addPointArr,this):h.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,
a.y])},_insertPoints:function(a,b){this.clearCache();this._ring=b;this.rings[this._ring]||(this.rings[this._ring]=[]);h.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new g(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=
[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&null!=b&&0<=b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,d=this.spatialReference;for(b=0;b<c;b++)a[b]=new g(a[b],d);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new g(this.rings[a].splice(b,1)[0],this.spatialReference)},
getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new l(a),a._partwise=b,a;a=this.rings;var c=a.length;if(c&&a[0].length){var d,e,f,g,m,k,h,n,p=g=a[0][0][0],t=m=a[0][0][1],q=Math.min,N=Math.max,V=this.spatialReference,b=[],P,L,F,I;for(k=0;k<c;k++){d=a[k];P=L=d[0]&&d[0][0];F=I=d[0]&&d[0][1];n=d.length;for(h=0;h<n;h++)e=d[h],f=e[0],e=e[1],p=q(p,f),t=q(t,e),g=N(g,f),m=N(m,e),P=q(P,f),F=q(F,e),L=N(L,f),I=N(I,e);b.push(new l({xmin:P,ymin:F,xmax:L,
ymax:I,spatialReference:V?V.toJson():null}))}a={xmin:p,ymin:t,xmax:g,ymax:m,spatialReference:V?V.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new l(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c,d=!1,e,f,m,l,k,h,n=b.length;c=this.spatialReference;e=a.spatialReference;var u=a.x;a=a.y;c&&e&&!c.equals(e)&&c._canProject(e)&&(a=c.isWebMercator()?g.lngLatToXY(u,a):g.xyToLngLat(u,a,!0),u=a[0],a=a[1]);for(h=0;h<n;h++)for(c=b[h],
m=c.length,k=l=0;k<m;k++)l++,l===m&&(l=0),e=c[k],f=c[l],(e[1]<a&&f[1]>=a||f[1]<a&&e[1]>=a)&&e[0]+(a-e[1])/(f[1]-e[1])*(f[0]-e[0])<u&&(d=!d);return d},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,b,c,d,e,f=[],m,l,k=Infinity,n=-Infinity,p=Infinity,t=-Infinity;h.forEach(a,function(a){b=c=d=0;h.forEach(a,function(e,f){f<a.length-1&&(m=a[f+1],l=e[0]*m[1]-m[0]*e[1],b+=(e[0]+m[0])*l,c+=(e[1]+m[1])*l,d+=l,e[0]<k&&(k=e[0]),e[0]>n&&(n=e[0]),e[1]<p&&(p=
e[1]),e[1]>t&&(t=e[1]))});0<d&&(d*=-1);d&&f.push([b,c,d/2])});f.sort(function(a,b){return a[2]-b[2]});b=c=void 0;f[0]&&(e=6*f[0][2],b=f[0][0]/e,c=f[0][1]/e,b<k||b>n||c<p||c>t)&&(b=c=void 0);if(void 0===b||void 0===c)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)b=a.x,c=a.y;a=isNaN(b)||isNaN(c)?null:new g(b,c,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var b,c=0,d=0,e=0,f,g,l={x:0,y:0},k={x:0,y:0},h,n=a.length,p;for(h=0;h<n-1;h++)f=a[h],
g=a[h+1],f&&g&&(l.x=f[0],l.y=f[1],k.x=g[0],k.y=g[1],b=m.getLength(l,k),0<b&&(c+=b,f=m.getMidpoint(f,g),d+=b*f[0],e+=b*f[1]));0<c?p={x:d/c,y:e/c}:a[0]&&(p={x:a[0][0],y:a[0][1]});return p},isClockwise:function(a){var b=0,c,d=a.length,e=k.isArray(a[0])?function(a,b){return a[0]*b[1]-b[0]*a[1]}:function(a,b){return a.x*b.y-b.x*a.y};for(c=0;c<d;c++)b+=e(a[c],a[(c+1)%d]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var b,c,d,e,f,g,l,k=a.rings.length,h;for(d=0;d<k;d++){for(b=0;b<a.rings[d].length-
1;b++)for(f=[[a.rings[d][b][0],a.rings[d][b][1]],[a.rings[d][b+1][0],a.rings[d][b+1][1]]],c=d+1;c<k;c++)for(e=0;e<a.rings[c].length-1;e++)if(g=[[a.rings[c][e][0],a.rings[c][e][1]],[a.rings[c][e+1][0],a.rings[c][e+1][1]]],(l=m._getLineIntersection2(f,g))&&!(l[0]===f[0][0]&&l[1]===f[0][1]||l[0]===g[0][0]&&l[1]===g[0][1]||l[0]===f[1][0]&&l[1]===f[1][1]||l[0]===g[1][0]&&l[1]===g[1][1]))return!0;e=a.rings[d].length;if(!(4>=e))for(b=0;b<e-3;b++)for(h=e-1,0===b&&(h=e-2),f=[[a.rings[d][b][0],a.rings[d][b][1]],
[a.rings[d][b+1][0],a.rings[d][b+1][1]]],c=b+2;c<h;c++)if(g=[[a.rings[d][c][0],a.rings[d][c][1]],[a.rings[d][c+1][0],a.rings[d][c+1][1]]],(l=m._getLineIntersection2(f,g))&&!(l[0]===f[0][0]&&l[1]===f[0][1]||l[0]===g[0][0]&&l[1]===g[0][1]||l[0]===f[1][0]&&l[1]===f[1][1]||l[0]===g[1][0]&&l[1]===g[1][1]))return!0}return!1},toJson:function(){var a={rings:d.clone3DArray(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});q.prototype=p.prototype;t.prototype=new q;Object.defineProperty(t.prototype,
"rings",{get:function(){this._unquantizeFn&&(this._ringsVal=this._unquantizeFn({rings:d.clone3DArray(this._ringsVal)}).rings,this._unquantizeFn=null);return this._ringsVal},set:function(a){this._ringsVal=a}});t.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._ringsVal=b.rings};p.simpleConstructor=q;p.accessorConstructor=t;p.defaultProps=a;p.createEllipse=function(a){var b=a.center.x,c=a.center.y,d=a.longAxis,e=a.shortAxis,f=a.numberOfPoints,g=a.map,m,l,k;a=[];var h=2*Math.PI/
f;for(l=0;l<f;l++)m=Math.cos(l*h),k=Math.sin(l*h),m=g.toMap({x:d*m+b,y:e*k+c}),a.push(m);a.push(a[0]);b=new p(g.spatialReference);b.addRing(a);return b};p.createCircle=function(a){return p.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};p.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new p({rings:h.map(b,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?
a.toJson():null})};k.setObject("geometry.Polygon",p,c);c.geometry.defaultPolygon=a;c.geometry.createEllipse=p.createEllipse;c.geometry.createCircle=p.createCircle;c.geometry.isClockwise=p.prototype.isClockwise;c.geometry.polygonSelfIntersecting=p.prototype.isSelfIntersecting;return p})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../lang ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(b,h,k,a,c,d,e,f,g){function l(a,b,c){var d=a.rings||a.paths,
e,f,g,m,l,k,h,n;e=0;for(f=d.length;e<f;e++)for(l=d[e],g=0,m=l.length;g<m;g++)k=l[g],0<g?(h+=k[0],n+=k[1]):(h=k[0],n=k[1]),k[0]=b(h),k[1]=c(n);return a}var m={esriGeometryPoint:function(a,b,c){a.x=b(a.x);a.y=c(a.y);return a},esriGeometryPolyline:l,esriGeometryPolygon:l,esriGeometryEnvelope:function(a,b,c){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax);return a},esriGeometryMultipoint:function(a,b,c){var d=a.points,e,f,g,m,l;e=0;for(f=d.length;e<f;e++)g=d[e],0<e?(m+=g[0],l+=g[1]):
(m=g[0],l=g[1]),g[0]=b(m),g[1]=c(l);return a}},n={esriGeometryPoint:function(a,b,c){a.x=b(a.x);a.y=c(a.y);return a}},q={createInstance:function(b,c){b=new b;c&&a.mixin(b,c);return b},fromJson:function(a){if(void 0!==a.x&&void 0!==a.y)return new c(a);if(void 0!==a.paths)return new d(a);if(void 0!==a.rings)return new e(a);if(void 0!==a.points)return new f(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new g(a)},getJsonType:function(a){return a instanceof c?"esriGeometryPoint":
a instanceof d?"esriGeometryPolyline":a instanceof e?"esriGeometryPolygon":a instanceof g?"esriGeometryEnvelope":a instanceof f?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===a?c:"esriGeometryPolyline"===a?d:"esriGeometryPolygon"===a?e:"esriGeometryEnvelope"===a?g:"esriGeometryMultipoint"===a?f:null},supportsLazyUnquantization:function(a){return"esriGeometryPoint"===a||"esriGeometryPolyline"===a||"esriGeometryPolygon"===a||"esriGeometryMultipoint"===a},unquantizeFunction:function(a,
b){if(a&&b){var c=b.translate[0],d=b.translate[1],e=b.scale[0],f=b.scale[1],g=function(a){return a*e+c},l=function(a){return d-a*f},k=m[a];return function(a){return a?k(a,g,l):null}}},unquantize:function(a,b,c){if(b=q.unquantizeFunction(b,c)){var d=a.length;for(c=0;c<d;c++)b(a[c].geometry)}},quantizeFunction:function(a,b){if(a&&"esriGeometryPoint"===a&&b){var c=b.translate[0],d=b.translate[1],e=b.scale[0],f=b.scale[1],g=function(a){return Math.round((a-c)/e)},m=function(a){return Math.round((d-a)/
f)},l=n[a];return function(a){return a?l(a,g,m):null}}},quantize:function(a,b,c){if(b=q.quantizeFunction(b,c)){var d=a.length;for(c=0;c<d;c++)b(a[c].geometry)}}};b.mixin(b.getObject("geometry",!0,k),q);return q})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(b,h,k,a,c,d,e,f,g,l){function m(){}function n(){}k={type:"multipoint",points:null};b=b(e,{declaredClass:"esri.geometry.Multipoint",
type:"multipoint",points:null,constructor:function(a){this.points=[];a&&(a.points?c.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=l.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(a){this.clearCache();h.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]);return this},removePoint:function(a){if(this._validateInputs(a))return this.clearCache(),new f(this.points.splice(a,1)[0],this.spatialReference)},getExtent:function(){var a=
this.getCacheValue("_extent");if(a)return new g(a);var a=this.points,b=a.length;if(b){var c=a[0],d,e,f=d=c[0],m=e=c[1],l=Math.min,k=Math.max,h=this.spatialReference,n,D;for(D=0;D<b;D++)c=a[D],n=c[0],c=c[1],f=l(f,n),m=l(m,c),d=k(d,n),e=k(e,c);a={xmin:f,ymin:m,xmax:d,ymax:e,spatialReference:h?h.toJson():null};this.setCacheValue("_extent",a);return new g(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=this.points[a],
new f(a[0],a[1],this.spatialReference)},setPoint:function(a,b){if(this._validateInputs(a))return this.clearCache(),this.points[a]=[b.x,b.y],this},toJson:function(){var a={points:c.clone2DArray(this.points)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});m.prototype=b.prototype;n.prototype=new m;Object.defineProperty(n.prototype,"points",{get:function(){this._unquantizeFn&&(this._pointsVal=this._unquantizeFn({points:c.clone2DArray(this._pointsVal)}).points,this._unquantizeFn=
null);return this._pointsVal},set:function(a){this._pointsVal=a}});n.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._pointsVal=b.points};b.simpleConstructor=m;b.accessorConstructor=n;b.defaultProps=k;h.setObject("geometry.Multipoint",b,a);a.geometry.defaultMultipoint=k;return b})},"arcgisonline/init":function(){define(["dojo","dijit","dojox","dojo/require!dojo/DeferredList,arcgisonline/sharing/dijit/_Empty"],function(b,h,k){b.provide("arcgisonline.init");b.require("dojo.DeferredList");
b.require("arcgisonline.sharing.dijit._Empty");b.mixin(arcgisonline.init,{labels:null,feeds:[],currentFeed:null,allSSL:!1,isOrg:!1,isSingleTenant:!1,settings:null,galleryNodeMap:{},loadLabels:function(){var a=arcgisonline.init;a.labels=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(a.labels,b.i18n.getLocalization("arcgisonline","arcgisonline").homePage);b.mixin(a.labels,b.i18n.getLocalization("arcgisonline","arcgisonline").emptyStates);b.attr("viewerLink","innerHTML",a.labels.viewerLink);
b.attr("viewerDescription","innerHTML",a.labels.viewerDescription);b.attr("signUpLink","innerHTML",a.labels.signUpLink);b.attr("signUpDescription","innerHTML",a.labels.signUpDescription);b.attr("featuredVideosLink","innerHTML",a.labels.featuredVideosLink);b.attr("featuredVideosDescription","innerHTML",a.labels.featuredVideosDescription);b.attr("lnkExplore","innerHTML",a.labels.explorerLink);b.attr("pExplore","innerHTML",a.labels.explorerDescription);b.attr("signUpImg","alt",a.labels.signUpLink);b.attr("signUpImg",
"title",a.labels.signUpLink);b.attr("mapImg","alt",a.labels.viewerLink);b.attr("mapImg","title",a.labels.viewerLink);b.attr("developersImg","alt",a.labels.explorerLink);b.attr("developersImg","title",a.labels.explorerLink);b.attr("videosImg","alt",a.labels.featuredVideosLink);b.attr("videosImg","title",a.labels.featuredVideosLink)},initialize:function(){var a=arcgisonline.init;esri.i18nBundle=b.i18n.getLocalization("arcgisonline","arcgisonline");a.loadLabels();b.byId("logoImg")&&b.attr("logoImg",
"src",arcgisonline.sharing.util.relativeToExplicitUrl("images/logo-pod.jpg"));b.byId("featuredVideosLink").href=esriGeowConfig.learnArcGIS;a.isSingleTenant=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;var c=arcgisonline.sharing.util.getUser();if(a.isSingleTenant||c&&c.accountId)a.isOrg=!0,(c=b.byId("headerTitle"))&&c.parentNode.removeChild(c);arcgisonline.sharing.geow.Account.getSelf(b.hitch(a,arcgisonline.init.initPage),b.hitch(arcgisonline.init,
arcgisonline.init.initPage))},overrideSettings:function(a){var c=arcgisonline.init;c.settings=a;c.isPortal=arcgisonline.sharing.util.isPortal();if(c.settings.id&&0<c.settings.id.length){c.isOrg=!0;var d=b.byId("headerTitle");d&&d.parentNode.removeChild(d)}c.isPortal&&c.getFederatedServers();a.allSSL&&(c.allSSL=a.allSSL);a.portalName&&(esriGeowConfig.portalName=a.portalName);a.portalHostname&&(esriGeowConfig.portalHostname=a.portalHostname);a.portalHeaderImage&&(esriGeowConfig.portalHeaderImage=a.portalHeaderImage);
a.homePageFeaturedContent?esriGeowConfig.homePageFeaturedContent=a.homePageFeaturedContent:c.isOrg&&(esriGeowConfig.homePageFeaturedContent=null);esri.isDefined(a.homePageFeaturedContentCount)&&(esriGeowConfig.homePageFeaturedContentCount=a.homePageFeaturedContentCount);if(a.rotatorPanels)if(c.isOrg){esriGeowConfig.rotatorPanels=a.rotatorPanels;for(var d=esriGeowConfig.rotatorPanels,e,f,g,l=0;l<d.length;l++)e=d[l],c.isPortal&&"7443"===location.port&&-1===esriGeowConfig.self.portalHostname.indexOf(":7443")&&
(f=new RegExp(esriGeowConfig.self.portalHostname,"gi"),f.test(e.innerHTML)&&(g=esriGeowConfig.self.portalHostname.split("/"),g[0]+=":7443",g[1]="arcgis",e.innerHTML=e.innerHTML.replace(f,g.join("/")))),d[l].innerHTML=e.innerHTML.replace(/CDN_SERVER/gi,esriGeowConfig.cdnServerUrl)}else b.create("div",{id:"homeCalciteBanner"},b.byId("matrixLayout")),b.addClass(b.byId("details"),"calcite_home calcite_home_details"),b.addClass(b.byId("matrixLayout"),"calcite_home calcite_home_matrixLayout"),b.addClass(b.byId("homeCalciteBanner"),
"calcite_home calcite_home_banner"),b.addClass(b.byId("featuredMaps"),"calcite_home calcite_home_featuredMaps"),b.addClass(b.byId("bottomContent"),"calcite_home calcite_home_bottomContent");else c.isOrg&&(esriGeowConfig.rotatorPanels=null);c=a.showHomePageDescription;esriGeowConfig.showHomePageDescription=void 0!==c&&null!==c?a.showHomePageDescription:!1},getFederatedServers:function(){var a=arcgisonline.sharing.util.getUser();!esriGeowConfig.federatedServers&&a&&arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"portals/"+esriGeowConfig.self.id+"/servers"}).then(b.hitch(this,function(a){esriGeowConfig.federatedServers=a.servers}))},initOrganization:function(){var a=arcgisonline.init;esri.hide(b.byId("bottomSection"));if(esriGeowConfig.explorerOnline){var c="http://developers.arcgis.com",d=a.labels.explorerLink,e=a.labels.explorerDescription;a.isSingleTenant&&(c=esriGeowConfig.explorerOnline,d=a.labels.explorerLinkPortal,e=a.labels.explorerDescriptionPortal);b.create("div",{id:"appOrgDiv",innerHTML:'\x3ch2 id\x3d"h2Explore"\x3e\x3ca id\x3d"lnkExplore" class\x3d"explorerLink" href\x3d"'+
c+'" target\x3d"_blank" \x3e'+d+'\x3c/a\x3e\x3c/h2\x3e\x3cp id\x3d"pExplore"\x3e'+e+"\x3c/p\x3e"},b.byId("topRow2"))}var c=a.settings.name,d=a.settings.description,e=esriGeowConfig.showHomePageDescription,e=void 0!==e&&null!==e&&!1===e?!1:!0,f=esri.isDefined(d)&&"\x3cbr\x3e"!==d&&"\x3cbr/\x3e"!==d&&"\x3cbr /\x3e"!==d&&""!==d;if(f&&e)b.attr(b.byId("orgDetails"),"innerHTML",d),esri.show(b.byId("organizationSection"));else if(arcgisonline.sharing.util.isPortal()&&!f&&!e){var g=esriGeowConfig.self.helpBase.replace("/website/",
"/admin/"),g=a.settings.allSSL?arcgisonline.sharing.util.getSecureUrl(g):arcgisonline.sharing.util.getHttpUrl(g);arcgisonline.sharing.util.retrievePortalAdminGuideHelpMap().then(b.hitch(this,function(c){c='\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"'+(g+c.m["120000837"])+'" target\x3d"_blank"\x3e';b.attr(b.byId("orgDetails"),"innerHTML",esri.substitute({linkStart:c,linkEnd:"\x3c/a\x3e\x3c/span\x3e"},a.labels.portalDefaultDesc));esri.show(b.byId("organizationSection"))}))}d=(d=arcgisonline.sharing.util.getToken())?
"?token\x3d"+d:"";e=a.settings.backgroundImage;esri.isDefined(e)?"none"!==e?0===e.indexOf("images/")?b.query("body").addClass("defaultBackground"):(e=esriGeowConfig.restBaseUrl+"portals/self/resources/"+e+d,f=b.query("body.esri")[0],b.style(f,"backgroundImage","url('"+e+"')"),b.style(f,"backgroundPosition","top center"),b.style(f,"backgroundRepeat","repeat-x")):b.query("body").addClass("calciteBackground"):b.query("body").addClass("calciteBackground");if(esriGeowConfig.rotatorPanels){b.addClass(b.byId("matrixLayout"),
"matrixLayoutShort");b.addClass(b.byId("details"),"detailsShort");c=arcgisonline.sharing.util.getToken();e=esriGeowConfig.rotatorPanels;for(f=0;f<e.length;f++)d=e[f],d.id&&(d.innerHTML=a.allSSL||a.isPortal&&"https:"===location.protocol?d.innerHTML.replace("http:","https:"):d.innerHTML.replace("https:","http:")),e[f].innerHTML=d.innerHTML.replace(/CDN_SERVER/gi,esriGeowConfig.cdnServerUrl),e[f].innerHTML=d.innerHTML.replace("SECURITY_TOKEN",c?c:"");a.createRotator(e)}else e=esriGeowConfig.portalHeaderImage?
esriGeowConfig.portalHeaderImage:arcgisonline.sharing.util.relativeToExplicitUrl("images/organizationSplash.jpg"),b.create("img",{id:"headerImage",src:e},b.byId("matrixLayout")),b.addClass(b.byId("headerImage"),"portalImage"),e=b.create("div",{id:"logoDisplay"},b.byId("matrixLayout")),f="",a.settings&&a.settings.thumbnail&&(f=esriGeowConfig.restBaseUrl+"portals/self/resources/"+a.settings.thumbnail+d,b.create("img",{src:f,alt:c},e)),b.create("span",{innerHTML:c},e),b.addClass(b.byId("matrixLayout"),
"matrixLayoutShort"),b.addClass(b.byId("details"),"detailsShort")},initPage:function(a,c){c=arcgisonline.init;!a||a.code||a.message||c.overrideSettings(a);c.isOrg?document.title=c.settings.name:(document.title=esriGeowConfig.portalName||c.labels.arcgis,b.query("body").addClass("defaultBackground"),esriGeowConfig.portalHeaderImage?((a=b.byId("headerTitle"))&&a.parentNode.removeChild(a),b.create("img",{id:"headerImage",src:esriGeowConfig.portalHeaderImage},b.byId("matrixLayout")),b.addClass(b.byId("headerImage"),
"portalImage")):c.createRotator(esriGeowConfig.rotatorPanels));a="";(a=arcgisonline.sharing.util.getUser())&&!a.accountId?(b.attr("signUpLink","innerHTML",c.labels.readyToUse),b.attr("signUpDescription","innerHTML",c.labels.readyToUseDescription),b.query("#signUpLink").attr("href",location.protocol+"//www.esri.com/software/apps")):(-1===esriGeowConfig.signin.indexOf("http")?(a=esriGeowConfig.baseUrl+esriGeowConfig.signin,!1!==esriGeowConfig.useSSL&&(a=a.replace("http:","https:"))):a=esriGeowConfig.signin,
b.query("#signUpLink").attr("href",a));esriGeowConfig.explorerOnline?b.query(".explorerLink").attr("href","http://developers.arcgis.com"):(b.style(b.byId("bottom3Grid"),"display","none"),b.removeClass(b.byId("bottomRow2"),"middle"),b.addClass(b.byId("bottomRow2"),"last"),b.addClass(b.byId("bottom2Grid"),"grid_6"),b.addClass(b.byId("bottom1Grid"),"grid_6"));b.style("page-border","visibility","visible");esriGeowConfig.homePageFeaturedContent?c.getGroup(esriGeowConfig.homePageFeaturedContent):esri.hide(b.byId("featuredMaps"));
c.isOrg&&c.initOrganization()},createRotator:function(a){var c=new k.widget.AutoRotator({transition:"dojox.widget.rotator.crossFade",duration:1E4,panes:a,autoStart:!0,pauseOnManualChange:!0,cycles:12,suspendOnHover:!0},b.byId("imgRotator"));new k.widget.rotator.Controller({rotator:c,commands:"#"},b.byId("categories"));a&&1===a.length&&b.style("categories","display","none")},getNextElementSibling:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(;a.nextSibling;){if(1===a.nextSibling.nodeType)return a.nextSibling;
a=a.nextSibling}},getGroup:function(a){a={q:a,f:"json",ts:(new Date).getTime()};arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"community/groups",content:a}).then(b.hitch(arcgisonline.init,arcgisonline.init.getGroupContent),b.hitch(arcgisonline.init,arcgisonline.init.getGroupContent))},getGroupContent:function(a){if(a&&a.results&&a.results[0]){for(var c=0,d=a.results[c];a.results.length>c+1&&!(-1<a.query.indexOf('"'+d.title+'"'));)c++,d=a.results[c];b.byId("galleryTitle").innerHTML=
d.title;0===esriGeowConfig.homePageFeaturedContentCount?this.showAllGroupItems(d):(a={q:"group:"+d.id+' -(type:"Code Attachment" OR type:"Windows Viewer Add In" OR type:"Windows Viewer Configuration")',f:"json",num:esriGeowConfig.homePageFeaturedContentCount,sortField:d.sortField?d.sortField:"modified",sortOrder:d.sortOrder?d.sortOrder:"desc",ts:(new Date).getTime()},arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:a}).then(b.hitch(arcgisonline.init,arcgisonline.init.createGallery),
function(a){}))}else esri.hide(b.byId("featuredMaps"))},showAllGroupItems:function(a){var c={q:"group:"+a.id+' -(type:"Code Attachment" OR type:"Windows Viewer Add In" OR type:"Windows Viewer Configuration")',f:"json",num:100,sortField:a.sortField?a.sortField:"modified",sortOrder:a.sortOrder?a.sortOrder:"desc",ts:(new Date).getTime()};arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:c}).then(b.hitch(this,function(a){var d={results:a.results},f=0,f=0;if(0<a.nextStart){var f=
a.total-a.results.length,f=Math.ceil(f/100),g=[];a=a.nextStart;for(var l=0;l<f;l++)c.start=a+100*l,g.push(arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"search",content:c}));(new b.DeferredList(g)).then(b.hitch(this,function(a){b.forEach(a,b.hitch(this,function(a){a[1]&&a[1].results&&(d.results=d.results.concat(a[1].results))}));this.createGallery(d)}),b.hitch(this,function(a){this.createGallery(d)}))}else this.createGallery(d)}),function(a){})},createGallery:function(a,c){var d=
a.results,e=new arcgisonline.sharing.dijit.Gallery({nodesPerPage:4,showThumbnailInDetails:!1,showToolTip:!1,showPageControls:!1,fadeOutOtherNodes:!0,noResultsMessage:b.string.substitute(arcgisonline.sharing.dijit._Empty,{message:arcgisonline.init.labels.noContentAvailable,width:96})},"gallery");b.connect(e,"onContentChange",function(){d.length<=e.nodesPerPage&&(esriGeowConfig.isRightToLeft?(b.removeClass("next","prevButtonEnabled"),b.addClass("next","prevButtonDisabled")):(b.removeClass("next","nextButtonEnabled"),
b.addClass("next","nextButtonDisabled")))});e.set("items",d);esriGeowConfig.isRightToLeft?(b.connect(b.byId("prev"),"onclick",e,e.nextPage),b.connect(b.byId("next"),"onclick",e,e.prevPage),b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):(b.connect(b.byId("prev"),"onclick",e,e.prevPage),b.connect(b.byId("next"),"onclick",e,e.nextPage),b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevButtonDisabled"));b.connect(e,"onPageChange",function(a){arcgisonline.init.galleryNodeMap=
{};esriGeowConfig.isRightToLeft?(1===a?(b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):(b.removeClass("next","nextButtonDisabled"),b.addClass("next","nextButtonEnabled")),a===e.pageCount?(b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevuttonDisabled")):(b.removeClass("prev","prevButtonDisabled"),b.addClass("prev","prevButtonEnabled"))):(1===a?(b.removeClass("prev","prevButtonEnabled"),b.addClass("prev","prevButtonDisabled")):(b.removeClass("prev",
"prevButtonDisabled"),b.addClass("prev","prevButtonEnabled")),a===e.pageCount?(b.removeClass("next","nextButtonEnabled"),b.addClass("next","nextButtonDisabled")):(b.removeClass("next","nextButtonDisabled"),b.addClass("next","nextButtonEnabled")))});b.connect(e,"onNodeMouseEnter",function(a,c){var d=arcgisonline.init;b.query("a",a.currentTarget).forEach(function(a){if(!d.galleryNodeMap[c.id]){var e=arcgisonline.sharing.util.getHomePageGalleryLinkInfo(c),f=!1;e.href&&-1<e.href.toLowerCase().indexOf("javascript")&&
c.url&&("Web Mapping Application"===c.type||"Mobile Application"===c.type||"Document Link"===c.type)&&(e.href=c.url,f=!0);"CityEngine Web Scene"===c.type&&(f=!0);e&&e.href&&"JavaScript:void(0)"===e.href&&e.onclick?b.connect(a,"onclick",e.onclick):b.attr(a,"href",e.href);b.attr(a,"target",f?"_blank":"");d.galleryNodeMap[c.id]=!0}})})}})})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(b,h,k){b.DeferredList=function(a,b,d,e,f){var c=[];h.call(this);
var l=this;0!==a.length||b||this.resolve([0,[]]);var m=0;k.forEach(a,function(f,g){function k(b,d){c[g]=[b,d];m++;m===a.length&&l.resolve(c)}f.then(function(a){b?l.resolve([g,a]):k(!0,a)},function(a){d?l.reject(a):k(!1,a);if(e)return null;throw a;})})};b.DeferredList.prototype=new h;b.DeferredList.prototype.gatherResults=function(a){a=new b.DeferredList(a,!1,!0,!1);a.addCallback(function(a){var b=[];k.forEach(a,function(a){b.push(a[1])});return b});return a};return b.DeferredList})},"arcgisonline/sharing/dijit/_Empty":function(){define(["dojo/text!./templates/_Empty.html"],
function(b){return b})},"arcgisonline/persist":function(){define(["dojo","dijit","dojox"],function(b,h,k){b.provide("arcgisonline.persist");arcgisonline.persist=function(){var a,b,d,e,f,g;g=function(){var a=["expires","path","domain"],b=escape,c=unescape,d=document,e,f=function(c,d){var e,f,g,m=[],l=2<arguments.length?arguments[2]:{};m.push(b(c)+"\x3d"+b(d));for(e=0;e<a.length;e++)f=a[e],(g=l[f])&&m.push(f+"\x3d"+g);l.secure&&m.push("secure");return m.join("; ")};e={set:function(a,b){var c=2<arguments.length?
arguments[2]:{},e=new Date;e.setTime(e.getTime());var g={};c.expires&&(c.expires*=864E5,g.expires=new Date(e.getTime()+c.expires),g.expires=g.expires.toGMTString());e=["path","domain","secure"];for(i=0;i<e.length;i++)c[e[i]]&&(g[e[i]]=c[e[i]]);c=f(a,b,g);d.cookie=c;return b},has:function(a){a=b(a);var c=d.cookie,e=c.indexOf(a+"\x3d"),c=c.substring(0,a.length);return!e&&a!=c||0>e?!1:!0},get:function(a){a=b(a);var e=d.cookie,f=e.indexOf(a+"\x3d"),g=f+a.length+1,m=e.substring(0,a.length);if(!f&&a!=m||
0>f)return null;a=e.indexOf(";",g);0>a&&(a=e.length);return c(e.substring(g,a))},remove:function(a){var b=e.get(a);d.cookie=f(a,"",{expires:"Thu, 01-Jan-1970 00:00:01 GMT"});return b},keys:function(){var a=d.cookie.split("; "),b,e,f=[];for(b=0;b<a.length;b++)e=a[b].split("\x3d"),f.push(c(e[0]));return f},all:function(){var a=d.cookie.split("; "),b,e,f=[];for(b=0;b<a.length;b++)e=a[b].split("\x3d"),f.push([c(e[0]),c(e[1])]);return f},version:"0.2.1",enabled:!1};e.enabled=function(){var a=new Date,
a=a.toGMTString();this.set("__EC_TEST__",a);return this.enabled=this.remove("__EC_TEST__")==a}.call(e);return e}();f=function(){};d=function(a){return"PS"+a.replace(/_/g,"__").replace(/ /g,"_s")};C={search_order:"localstorage whatwg_db globalstorage flash ie cookie".split(" "),name_re:/^[a-z][a-z0-9_ -]+$/i,methods:"init get set remove load save".split(" "),sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k \x3d ?",
set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k \x3d ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:!0}}};b={gears:{size:-1,test:function(){return window.google&&window.google.gears?!0:!1},methods:{transaction:function(a){var b=this.db;b.execute("BEGIN").close();a.call(this,b);b.execute("COMMIT").close()},init:function(){var a;a=this.db=google.gears.factory.create("beta.database");a.open(d(this.name));
a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;b&&this.transaction(function(f){d=f.execute(e,[a]);d.isValidRow()?b.call(c||this,!0,d.field(0)):b.call(c||this,!1,null);d.close()})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.execute(e,[a]).close();g.execute(f,[a,b]).close();c&&c.call(d||this,!0,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove;r;val;this.transaction(function(e){b?(r=e.execute(d,[a]),r.isValidRow()?(val=r.field(0),
e.execute(sql,[a]).close(),b.call(c||this,!0,val)):b.call(c||this,!1,null),r.close()):e.execute(sql,[a]).close()})}}},whatwg_db:{size:204800,test:function(){return window.openDatabase&&window.openDatabase("PersistJS Test",C.sql.version,"Persistent database test.",b.whatwg_db.size)?!0:!1},methods:{transaction:function(a){if(!this.db_created){var b=C.sql.create;this.db.transaction(function(a){a.executeSql(b,[],function(){this.db_created=!0})},f)}this.db.transaction(a)},init:function(){this.db=openDatabase(this.name,
C.sql.version,this.o.about||"Persistent storage for "+this.name,this.o.size||b.whatwg_db.size)},get:function(a,b,c){var d=C.sql.get;b&&(c=c||this,this.transaction(function(e){e.executeSql(d,[a],function(a,d){0<d.rows.length?b.call(c,!0,d.rows.item(0).v):b.call(c,!1,null)})}))},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(a,e){c&&c.call(d||this,!0,b)})})});return b},remove:function(a,b,c){var d=C.sql.get;
sql=C.sql.remove;this.transaction(function(e){b?e.executeSql(d,[a],function(d,e){if(0<e.rows.length){var f=e.rows.item(0).v;d.executeSql(sql,[a],function(a,d){b.call(c||this,!0,f)})}else b.call(c||this,!1,null)}):e.executeSql(sql,[a])})}}},globalstorage:{size:5242880,test:function(){return window.globalStorage?!0:!1},methods:{key:function(a){return d(this.name)+d(a)},init:function(){this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a);b&&b.call(c||this,!0,this.store.getItem(a))},
set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store[a];this.store.removeItem(a);b&&b.call(c||this,null!==d,d)}}},localstorage:{size:-1,test:function(){return window.localStorage?!0:!1},methods:{key:function(a){return d(this.name)+d(a)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a);b&&b.call(c||this,!0,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,
b);c&&c.call(d||this,!0,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.getItem(a);this.store.removeItem(a);b&&b.call(c||this,null!==d,d)}}},ie:{prefix:"_persist_data-",size:65536,test:function(){return window.ActiveXObject?!0:!1},make_userdata:function(a){var b=document.createElement("div");b.id=a;b.style.display="none";b.addBehavior("#default#userData");document.body.appendChild(b);return b},methods:{init:function(){var a=b.ie.prefix+d(this.name);this.el=b.ie.make_userdata(a);this.o.defer&&
this.load()},get:function(a,b,c){a=d(a);this.o.defer||this.load();a=this.el.getAttribute(a);b&&b.call(c||this,a?!0:!1,a)},set:function(a,b,c,e){a=d(a);this.el.setAttribute(a,b);this.o.defer||this.save();c&&c.call(e||this,!0,b)},load:function(){this.el.load(d(this.name))},save:function(){this.el.save(d(this.name))}}},cookie:{delim:":",size:4E3,test:function(){return a.Cookie.enabled?!0:!1},methods:{key:function(a){return this.name+b.cookie.delim+a},get:function(a,b,c,d){a=this.key(a);b=g.get(a);c&&
c.call(d||this,null!=b,b)},set:function(a,b,c,d){a=this.key(a);g.set(a,b,this.o);c&&c.call(d||this,!0,b)},remove:function(a,b,c,d){a=this.key(a);b=g.remove(a);c&&c.call(d||this,null!=b,b)}}},flash:{test:function(){return window.SWFObject&&deconcept&&deconcept.SWFObjectUtil?8<=deconcept.SWFObjectUtil.getPlayerVersion().major?!0:!1:!1},methods:{init:function(){if(!b.flash.el){var a,c,d,e=C.flash;d=document.createElement("div");d.id=e.div_id;document.body.appendChild(d);a=new SWFObject(this.o.swf_path||
e.path,e.id,e.size.w,e.size.h,"8");for(c in e.args)a.addVariable(c,e.args[c]);a.write(d);b.flash.el=document.getElementById(e.id)}this.el=b.flash.el},get:function(a,b,c){a=d(a);a=this.el.get(this.name,a);b&&b.call(c||this,null!==a,a)},set:function(a,b,c,e){a=d(a);this.el.set(this.name,a,b);c&&c.call(e||this,!0,b)},remove:function(a,b,c){a=d(a);a=this.el.remove(this.name,a);b&&b.call(c||this,!0,a)}}}};e=function(){var c,d,e,g;e=C.methods;var k=C.search_order;c=0;for(d=e.length;c<d;c++)a.Store.prototype[e[c]]=
f;a.type=null;a.size=-1;c=0;for(d=k.length;!a.type&&c<d;c++)if(e=b[k[c]],e.test())for(g in a.type=k[c],a.size=e.size,e.methods)a.Store.prototype[g]=e.methods[g];a._init=!0};a={VERSION:"0.1.0",type:null,size:0,add:function(a){b[a.id]=a;C.search_order=[a.id].concat(C.search_order);e()},remove:function(a){Array.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1});var c=C.search_order.indexOf(a);0>c||(C.search_order.splice(c,1),delete b[a],e())},
Cookie:g,Store:function(b,c){if(!C.name_re.exec(b))throw Error("Invalid name");if(!a.type)throw Error("No suitable storage found");c=c||{};this.name=b;c.domain=c.domain||location.hostname||"localhost.localdomain";this.o=c;c.expires=c.expires||730;c.path=c.path||"/";this.init()}};e();return a}()})},"arcgisonline/sharing/dijit/ClassificationBanner":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.ClassificationBanner");
b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.ClassificationBanner",[h._Widget],{widgetsInTemplate:!1,postCreate:function(){if(esriGeowConfig.classificationBanner){var a=b.create("div",{id:this.id+"_0",style:"width:100%"});esriGeowConfig.classificationBanner.color&&b.style(a,"color",b.colorFromArray(esriGeowConfig.classificationBanner.color).toHex());esriGeowConfig.classificationBanner.font&&(esriGeowConfig.classificationBanner.font.decoration&&b.style(a,
"textDecoration",esriGeowConfig.classificationBanner.font.decoration),esriGeowConfig.classificationBanner.font.family&&b.style(a,"fontFamily",esriGeowConfig.classificationBanner.font.family),esriGeowConfig.classificationBanner.font.size&&b.style(a,"fontSize",esriGeowConfig.classificationBanner.font.size+"px"),esriGeowConfig.classificationBanner.font.style&&b.style(a,"fontStyle",esriGeowConfig.classificationBanner.font.style),esriGeowConfig.classificationBanner.font.weight&&b.style(a,"fontWeight",
esriGeowConfig.classificationBanner.font.weight));if(esriGeowConfig.classificationBanner.height){var c=esriGeowConfig.classificationBanner.height;esriGeowConfig.classificationBanner.font.size&&(c=Math.max(esriGeowConfig.classificationBanner.height,esriGeowConfig.classificationBanner.font.size+2));b.style(a,"height",c+"px")}esriGeowConfig.classificationBanner.backgroundColor&&b.style(a,"background",b.colorFromArray(esriGeowConfig.classificationBanner.backgroundColor).toHex());b.create("span",{innerHTML:esriGeowConfig.classificationBanner.text},
b.create("center",{},a));b.place(a,this.domNode,"only")}else b.style(this.domNode,"height","0")}})})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(b,h,k,a,c,d,e){d.extend(b,{waiRole:"",waiState:""});return c("dijit._Templated",[h,k],{constructor:function(){e.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(b,c){var d=this.inherited(arguments),e=c(b,"waiRole");e&&b.setAttribute("role",e);(e=c(b,"waiState"))&&a.forEach(e.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),b.setAttribute("aria-"+a[0],a[1]))});return d}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(b,h,k,a,c){return k("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,
_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var b=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);c.parse(b,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(a.hitch(this,function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],function(a,b){return a[b]},
function(a,b,c){return b in a?a.connect(a,b,c):a.on(b,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,b,c){return b(a,"dojoType")||b(a,"data-dojo-type")?!0:this.inherited(arguments)},
startup:function(){b.forEach(this._startupWidgets,function(a){a&&!a._started&&a.startup&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){function w(a){return eval("("+a+")")}function v(a){var b=a._nameCaseMap,c=a.prototype;
if(!b||b._extendCnt<A){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=A}return b}function B(a,c){c||(c=b);var d=c._dojoParserCtorMap||(c._dojoParserCtorMap={}),e=a.join();if(!d[e]){for(var f=[],g=0,m=a.length;g<m;g++){var l=a[g];f[f.length]=d[l]=d[l]||k.getObject(l)||~l.indexOf("/")&&c(l)}a=f.shift();d[e]=f.length?a.createSubclass?a.createSubclass(f):a.extend.apply(a,f):a}return d[e]}new Date("X");var A=0;g.after(k,"extend",function(){A++},!0);var z={_clearCache:function(){A++;
_ctorMap={}},_functionFromScript:function(b,c){var d="",e="",f=b.getAttribute(c+"args")||b.getAttribute("args");c=b.getAttribute("with");f=(f||"").split(/\s*,\s*/);c&&c.length&&a.forEach(c.split(/\s*,\s*/),function(a){d+="with("+a+"){";e+="}"});return new Function(f,d+b.innerHTML+e)},instantiate:function(b,c,d){c=c||{};d=d||{};var e=(d.scope||h._scopeName)+"Type",f="data-"+(d.scope||h._scopeName)+"-",g=f+"type",m=f+"mixins",l=[];a.forEach(b,function(a){var b=e in c?c[e]:a.getAttribute(g)||a.getAttribute(e);
if(b){var d=a.getAttribute(m),b=d?[b].concat(d.split(/\s*,\s*/)):[b];l.push({node:a,types:b})}});return this._instantiate(l,c,d)},_instantiate:function(b,c,d,e){function f(b){c._started||d.noStart||a.forEach(b,function(a){"function"!==typeof a.startup||a._started||a.startup()});return b}b=a.map(b,function(a){var b=a.ctor||B(a.types,d.contextRequire);if(!b)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(b,a.node,c,d,a.scripts,a.inherited)},this);return e?
l(b).then(f):f(b)},construct:function(b,c,d,e,l,n){function D(a){z&&k.setObject(z,a);for(F=0;F<W.length;F++)g[W[F].advice||"after"](a,W[F].method,k.hitch(a,W[F].func),!0);for(F=0;F<K.length;F++)K[F].call(a);for(F=0;F<ca.length;F++)a.watch(ca[F].prop,ca[F].func);for(F=0;F<J.length;F++)p(a,J[F].event,J[F].func);return a}var u=b&&b.prototype;e=e||{};var B={};e.defaults&&k.mixin(B,e.defaults);n&&k.mixin(B,n);var A;q("dom-attributes-explicit")?A=c.attributes:q("dom-attributes-specified-flag")?A=a.filter(c.attributes,
function(a){return a.specified}):(n=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),A=a.map(n.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==c.nodeName&&"value"==a||"enctype"==b?c.getAttribute(b):c.getAttributeNode(b).value}}));var x=e.scope||h._scopeName;n="data-"+x+"-";var y={};"dojo"!==x&&(y[n+"props"]="data-dojo-props",y[n+"type"]="data-dojo-type",y[n+"mixins"]=
"data-dojo-mixins",y[x+"type"]="dojotype",y[n+"id"]="data-dojo-id");for(var F=0,I,x=[],z,R;I=A[F++];){var E=I.name,O=E.toLowerCase();I=I.value;switch(y[O]||O){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":R=I;break;case "data-dojo-id":case "jsid":z=I;break;case "data-dojo-attach-point":case "dojoattachpoint":B.dojoAttachPoint=I;break;case "data-dojo-attach-event":case "dojoattachevent":B.dojoAttachEvent=I;break;case "class":B["class"]=c.className;break;
case "style":B.style=c.style&&c.style.cssText;break;default:if(E in u||(E=v(b)[O]||E),E in u)switch(typeof u[E]){case "string":B[E]=I;break;case "number":B[E]=I.length?Number(I):NaN;break;case "boolean":B[E]="false"!=I.toLowerCase();break;case "function":""===I||-1!=I.search(/[^\w\.]+/i)?B[E]=new Function(I):B[E]=k.getObject(I,!1)||new Function(I);x.push(E);break;default:O=u[E],B[E]=O&&"length"in O?I?I.split(/\s*,\s*/):[]:O instanceof Date?""==I?new Date(""):"now"==I?new Date:m.fromISOString(I):O instanceof
f?h.baseUrl+I:w(I)}else B[E]=I}}for(A=0;A<x.length;A++)y=x[A].toLowerCase(),c.removeAttribute(y),c[y]=null;if(R)try{R=w.call(e.propsThis,"{"+R+"}"),k.mixin(B,R)}catch(T){throw Error(T.toString()+" in data-dojo-props\x3d'"+R+"'");}k.mixin(B,d);l||(l=b&&(b._noScript||u._noScript)?[]:t("\x3e script[type^\x3d'dojo/']",c));var W=[],K=[],ca=[],J=[];if(l)for(F=0;F<l.length;F++)y=l[F],c.removeChild(y),d=y.getAttribute(n+"event")||y.getAttribute("event"),e=y.getAttribute(n+"prop"),R=y.getAttribute(n+"method"),
x=y.getAttribute(n+"advice"),A=y.getAttribute("type"),y=this._functionFromScript(y,n),d?"dojo/connect"==A?W.push({method:d,func:y}):"dojo/on"==A?J.push({event:d,func:y}):B[d]=y:"dojo/aspect"==A?W.push({method:R,advice:x,func:y}):"dojo/watch"==A?ca.push({prop:e,func:y}):K.push(y);b=(l=b.markupFactory||u.markupFactory)?l(B,c,b):new b(B,c);return b.then?b.then(D):D(b)},scan:function(c,d){function e(a){if(!a.inherited){a.inherited={};var b=a.node,c=e(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||
c.lang,textDir:b.getAttribute(w)||c.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var f=[],g=[],m={},l=(d.scope||h._scopeName)+"Type",k="data-"+(d.scope||h._scopeName)+"-",p=k+"type",w=k+"textdir",k=k+"mixins",v=c.firstChild,t=d.inherited;if(!t){var F=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&F(a.parentNode,b)},t={dir:F(c,"dir"),lang:F(c,"lang"),textDir:F(c,w)},u;for(u in t)t[u]||delete t[u]}u={inherited:t};for(var q,A;;)if(v)if(1!=v.nodeType)v=v.nextSibling;
else if(q&&"script"==v.nodeName.toLowerCase())(t=v.getAttribute("type"))&&/^dojo\/\w/i.test(t)&&q.push(v),v=v.nextSibling;else if(A)v=v.nextSibling;else if(t=v.getAttribute(p)||v.getAttribute(l),c=v.firstChild,t||c&&(3!=c.nodeType||c.nextSibling)){A=null;if(t){var y=v.getAttribute(k);q=y?[t].concat(y.split(/\s*,\s*/)):[t];try{A=B(q,d.contextRequire)}catch(W){}A||a.forEach(q,function(a){~a.indexOf("/")&&!m[a]&&(m[a]=!0,g[g.length]=a)});y=A&&!A.prototype._noScript?[]:null;u={types:q,ctor:A,parent:u,
node:v,scripts:y};u.inherited=e(u);f.push(u)}else u={node:v,scripts:q,parent:u};q=y;A=v.stopParser||A&&A.prototype.stopParser&&!d.template;v=c}else v=v.nextSibling;else{if(!u||!u.node)break;v=u.node.nextSibling;A=!1;u=u.parent;q=u.scripts}var O=new n;g.length?(d.contextRequire||b)(g,function(){O.resolve(a.filter(f,function(a){if(!a.ctor)try{a.ctor=B(a.types,d.contextRequire)}catch(Z){}for(var b=a.parent;b&&!b.types;)b=b.parent;var c=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(c&&c.stopParser&&
!d.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))}):O.resolve(f);return O.promise},_require:function(a,c){a=w("{"+a.innerHTML+"}");var d=[],e=[],f=new n;c=c&&c.contextRequire||b;for(var g in a)d.push(g),e.push(a[g]);c(e,function(){for(var a=0;a<d.length;a++)k.setObject(d[a],arguments[a]);f.resolve(arguments)});return f.promise},_scanAmd:function(a,b){var c=new n,d=c.promise;c.resolve(!0);var e=this;t("script[type\x3d'dojo/require']",a).forEach(function(a){d=
d.then(function(){return e._require(a,b)});a.parentNode.removeChild(a)});return d},parse:function(a,b){!a||"string"==typeof a||"nodeType"in a||(b=a,a=b.rootNode);var c=a?d.byId(a):e.body();b=b||{};var f=b.template?{template:!0}:{},g=[],m=this;a=this._scanAmd(c,b).then(function(){return m.scan(c,b)}).then(function(a){return m._instantiate(a,f,b,!0)}).then(function(a){return g=g.concat(a)}).otherwise(function(a){throw a;});k.mixin(g,a);return g}};h.parser=z;c.parseOnLoad&&u(100,z,"parse");return z})},
"dojo/promise/all":function(){define(["../_base/array","../_base/lang","../Deferred","../when"],function(b,h,k,a){var c=b.some;return function(b){var d,f;h.isArray(b)?f=b:b&&"object"===typeof b&&(d=b);var g,l=[];if(d){f=[];for(var m in d)Object.hasOwnProperty.call(d,m)&&(l.push(m),f.push(d[m]));g={}}else f&&(g=[]);if(!f||!f.length)return(new k).resolve(g);var n=new k;n.promise.always(function(){g=l=null});var q=f.length;c(f,function(b,c){d||l.push(c);a(b,function(a){n.isFulfilled()||(g[l[c]]=a,0===
--q&&n.resolve(g))},n.reject);return n.isFulfilled()});return n.promise}})},"arcgisonline/sharing/dijit/SiteHeader":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/BorderContainer,arcgisonline/pages/utils/culture,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/Search,arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/dijit/dialog/SimpleDlg,dojo/topic,dojo/has,arcgisonline/sharing/dijit/AppSwitcher"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.SiteHeader");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.layout.BorderContainer");b.require("arcgisonline.pages.utils.culture");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.geow.Community");b.require("arcgisonline.sharing.dijit.Search");b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.dijit.dialog.SimpleDlg");
b.require("dojo.topic");b.require("dojo.has");b.require("arcgisonline.sharing.dijit.AppSwitcher");var a=function(c){var d=b.query(".js-logged-in-navigation"),e=b.query(".js-logged-in-navigation .dropdown-menu")[0];a:{for(var f=(c.target||c.srcElement).parentNode;null!=f;){if(f==e){e=!0;break a}f=f.parentNode}e=!1}e||(c.preventDefault(),d.removeClass("is-active"),c=document.body,d=a,c.removeEventListener?c.removeEventListener("click",d,!1):c.detachEvent&&c.detachEvent("onclick",d));b.query(".js-dropdown").removeClass("is-active")};
b.declare("arcgisonline.sharing.dijit.SiteHeader",[h._Widget,h._Templated],{util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,acct:arcgisonline.sharing.geow.Account,allSSL:!1,isPrivateOrg:!1,isPublicOrg:!1,isLoggedIn:!1,isIndexPage:!1,isSignInPage:!1,isSignUpPage:!1,isJoinPage:!1,isSetupPage:!1,isIEPage:!1,isItemDetailsPage:!1,isNewUserPage:!1,isTroubleshootPage:!1,isGalleryPage:!1,isGroupsPage:!1,isContentPage:!1,isOrgPage:!1,contentMode:null,modeLabelNode:null,webLabel:"",webDescription:"",
desktopLabel:"",desktopDescription:"",modeQueryParam:null,prefsName:esriGeowConfig.contentModeCookieName,displayedPortalNonSSLNotice:!1,_tabs:null,_searchWidgetNode:null,_searchWidget:null,_accountControlsNode:null,_navNode:null,_signInOutLink:null,_organizationLink:null,_profileLink:null,_notificationsLink:null,_myAccountLink:null,_resourceCenterLink:null,_helpMenuNode:null,_modeFilterNode:null,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent siteHeader top-nav" id\x3d"header" dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"grid-container container clearfix"\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"tablet-hide"\x3e\r\n      \x3c!-- Logo --\x3e\r\n      \x3ca id\x3d"site-logo" class\x3d"js-top-nav-link top-nav-title anon pubUser site_logo" href\x3d"../features/features.html"\x3e${!i18n.arcGIS}\x3c/a\x3e\r\n\r\n      \x3c!-- Top Navigation --\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_tabs" class\x3d"top-nav-list" role\x3d"navigation"\x3e\r\n        \x3ca id\x3d"siteHeader-home" class\x3d"js-top-nav-link top-nav-link organization first" href\x3d"./index.html"\x3e${i18n.home_link}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-features" class\x3d"js-top-nav-link top-nav-link anon pubUser" href\x3d"../features/features.html"\x3e${i18n.overview}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-plans" class\x3d"js-top-nav-link top-nav-link anon pubUser" href\x3d"../features/plans/pricing.html"\x3e${i18n.pricing}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-gallery" class\x3d"js-top-nav-link top-nav-link anon organization orgUser js-gallery" href\x3d"./gallery.html"\x3e${i18n.gallery}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-map" class\x3d"js-top-nav-link top-nav-link anon pubUser organization orgUser" href\x3d"./webmap/viewer.html?useExisting\x3d1"\x3e${i18n.map}\x3c/a\x3e\r\n        \x3ca id\x3d"sceneViewer" class\x3d"js-top-nav-link top-nav-link" href\x3d"webscene/viewer.html"\x3e${i18n.scene}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-groups" class\x3d"js-top-nav-link top-nav-link pubUser organization orgUser" href\x3d"./groups.html"\x3e${i18n.groups}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-help" class\x3d"js-top-nav-link top-nav-link help anon" href\x3d"./support.html"\x3e${i18n.help}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-myContent" class\x3d"js-top-nav-link top-nav-link pubUser orgUser" href\x3d"./content.html"\x3e${i18n.myContent}\x3c/a\x3e\r\n        \x3ca id\x3d"siteHeader-myOrganization" class\x3d"js-top-nav-link top-nav-link orgUser" href\x3d"./organization.html"\x3e${i18n.myAccount}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"tablet-show padding-left-half"\x3e\r\n      \x3ca href\x3d"#" class\x3d"icon-ui-menu top-nav-title js-top-nav-drawer-open"\x3e${!i18n.arcGIS}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- Search --\x3e\r\n    \x3cdiv id\x3d"header-search" dojoAttachPoint\x3d"_searchWidgetNode" class\x3d"right column-4 padding-left-1 padding-right-0 inline-block top-nav-search tablet-hide"\x3e\x3c/div\x3e\r\n\r\n    \x3c!-- Sign In --\x3e\r\n    \x3cdiv id\x3d"logged-out-navigation" class\x3d"inline-block right padding-right-2 padding-left-0 hide"\x3e\r\n      \x3ca id\x3d"login-link" class\x3d"top-nav-link icon-ui-user link-gray" href\x3d"signin.html"\x3e${i18n.signIn}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- User Menu --\x3e\r\n    \x3cdiv class\x3d"dropdown js-logged-in-navigation logged-in-navigation js-dropdown right" id\x3d"logged-in-navigation"\x3e\r\n      \x3ca href\x3d"#" class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" tabindex\x3d"0" dojoAttachEvent\x3d"onclick:_handleUserDropdown"\x3e\r\n        \x3cimg id\x3d"profileImgSmall" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n        \x3cspan id\x3d"username"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3cdiv class\x3d"dropdown-menu dropdown-right dropdown-menu-tight"\x3e\r\n        \x3ca id\x3d"profileLink" class\x3d"dropdown-link dropdown-link-profile" dojoAttachEvent\x3d"onclick:_handleLinkClick" href\x3d"./user.html"\x3e\r\n          \x3cimg id\x3d"dropdown-image" width\x3d"32" height\x3d"32" class\x3d"padding-right-half padding-left-0 left"\x3e\r\n          ${i18n.myProfile}\x3cbr/\x3e\r\n          \x3cspan dojoAttachPoint\x3d"_userProfileLink" class\x3d"text-ellipsis dropdown-username"\x3e\x3c/span\x3e\r\n        \x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link dropdown-link-external hide" id\x3d"esri-community" dojoAttachEvent\x3d"onclick:goEsriCommunity" href\x3d"#"\x3e\r\n          \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${i18n.esriCommunity}\r\n        \x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link dropdown-link-external hide" id\x3d"my-esri" dojoAttachEvent\x3d"onclick:goMyEsri" href\x3d"#"\x3e\r\n          \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${i18n.myEsri}\r\n        \x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link hide dropdown-link-external hide" id\x3d"training" dojoAttachEvent\x3d"onclick:goTraining" href\x3d"#"\x3e\r\n          \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${i18n.training}\r\n        \x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link hide" target\x3d"_blank" aria-label\x3d"${i18n.switchAccountsOpenInTab}" data-dojo-attach-point\x3d"switchAccountsLink" href\x3d"#"\x3e\r\n          ${i18n.switchAccounts}\r\n        \x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link hide" id\x3d"trial-download" dojoAttachEvent\x3d"onclick:goTrialDownload" href\x3d"#"\x3e${i18n.trialDownload}\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link" target\x3d"_blank" id\x3d"help-link" href\x3d"./support.html"\x3e${i18n.support}\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link hide" id\x3d"admin-guide" dojoAttachEvent\x3d"onclick:_handleLinkClick" href\x3d"./adminguide.html"\x3e${i18n.adminGuide}\x3c/a\x3e\r\n        \x3ca class\x3d"dropdown-link" id\x3d"logout-link" dojoAttachEvent\x3d"onclick:selectLogOut" href\x3d"#"\x3e${i18n.signOut}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- Notifications --\x3e\r\n    \x3cdiv id\x3d"header_notifications" class\x3d"header-notifications pubUser organization right padding-right-1 padding-left-0 hide"\x3e\r\n      \x3cdiv id\x3d"notifications_box" class\x3d"hide"\x3e\r\n        \x3cspan id\x3d"notifications" class\x3d"label label-red link-white"\x3e0\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- App Switcher --\x3e\r\n    \x3cdiv class\x3d"pubUser organization right padding-right-half padding-left-0 hide"\x3e\r\n      \x3c!-- AppSwitcher Dijit --\x3e\r\n      \x3cdiv data-dojo-type\x3d"arcgisonline.sharing.dijit.AppSwitcher"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
postMixInProperties:function(){this.inherited(arguments);this.geow.checkSharedCookie();this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").siteHeader);this.webLabel=this.i18n.webOnly;this.webDescription=this.i18n.webDesc;this.desktopLabel=this.i18n.allContent;this.desktopDescription=this.i18n.allDesc},postCreate:function(){var a=window.location.pathname.toLowerCase();this.isIndexPage=-1!==a.indexOf("index.html")||
-1===a.indexOf(".html");this.isSignInPage=-1!==a.indexOf(esriGeowConfig.signin);this.isSignUpPage=-1!==a.indexOf(esriGeowConfig.signup);this.isJoinPage=-1!==a.indexOf(esriGeowConfig.join);this.isSetupPage=-1!==a.indexOf(esriGeowConfig.setup);this.isIEPage=-1!==a.indexOf("ie6.html");this.isItemDetailsPage=-1!==a.indexOf("item.html");this.isNewUserPage=-1!==a.indexOf("newuser.html");this.isTroubleshootPage=-1!==a.indexOf("troubleshoot.html");this.isGalleryPage=-1!==a.indexOf("gallery.html");this.isGroupsPage=
-1!==a.indexOf("groups.html");this.isContentPage=-1!==a.indexOf("content.html");this.isOrgPage=-1!==a.indexOf("organization.html");this._account=arcgisonline.sharing.geow.Account;7>b.isIE&&!this.isIEPage&&(window.location="ie6.html");7<=b.has("trident")&&b.addClass(document.body,"ie11_edge");null===this._searchWidgetNode||this.isIEPage||(this._searchWidget=(new arcgisonline.sharing.dijit.Search({page:this.page})).placeAt(this._searchWidgetNode));b.subscribe("onSignOut",b.hitch(this,function(){arcgisonline.sharing.util&&
arcgisonline.sharing.util._cookies&&arcgisonline.sharing.util._cookies.esri_auth&&delete arcgisonline.sharing.util._cookies.esri_auth}));this.updateLinks();document.getElementById("page-border")&&b.attr("page-border","onClick","")},_loadFilterMode:function(){var a=b.queryToObject(window.location.search.slice(1)),d=this.util.userPreferences(null,this.prefsName),e="Web";a.content&&"all"===a.content.toLowerCase()?(e="GIS",this.util.userPreferences({contentMode:e},this.prefsName,!0)):a.content&&"web"===
a.content.toLowerCase()?this.util.userPreferences({contentMode:e},this.prefsName,!0):d&&d.contentMode&&(e=d.contentMode);this.contentMode=e},_setActivePage:function(){this.isIndexPage?b.addClass("siteHeader-home","is-active"):this.isGalleryPage?b.addClass("siteHeader-gallery","is-active"):this.isGroupsPage?b.addClass("siteHeader-groups","is-active"):this.isContentPage?b.addClass("siteHeader-myContent","is-active"):this.isOrgPage&&b.addClass("siteHeader-myOrganization","is-active")},_handleModeMenuClick:function(a){b.subscribe("esri/userPreferences"+
this.prefsName,b.hitch(this,function(){var a=window.location.search&&b.queryToObject(window.location.search.slice(1));a&&a.start&&(a.start=null);var c=window.location.href.substring(0,window.location.href.indexOf(window.location.search));window.location.href=c+(a?"?"+b.objectToQuery(a):"")}));"Web"===a?(this.contentMode="Web",this.util.userPreferences({contentMode:this.contentMode},this.prefsName,!0),b.attr(this.modeLabelNode,{innerHTML:this.i18n.show+": "+this.webLabel,alt:this.webDescription,title:this.webDescription})):
(this.contentMode="GIS",this.util.userPreferences({contentMode:this.contentMode},this.prefsName,!0),b.attr(this.modeLabelNode,{innerHTML:this.i18n.show+": "+this.desktopLabel,alt:this.desktopDescription,title:this.desktopDescription}))},startup:function(){this.inherited(arguments);esri.config.defaults.io.corsEnabledServers.push("http://"+location.host);esri.config.defaults.io.corsEnabledServers.push("https://"+location.host);esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;b.query(".js-top-nav-link",
this.domNode).addClass("hide");this._setActivePage();return this._fetchSelf()},_fetchSelf:function(){var a=new b.Deferred;this._account.getSelf(b.hitch(this,function(c){this._finishStartup(c);a.resolve(c);b.topic.publish("OnFetchSelf",c)}),b.hitch(this,function(a){this._finishStartup();throw a;}));return a},_finishStartup:function(a){this.geow.setCookies(a||{});if(a&&!a.code&&!a.message){var c,e;a.httpsPort&&(esriGeowConfig.httpsPort=a.httpsPort,e=esri.config.defaults.io.corsEnabledServers.pop());
a.httpPort&&(esriGeowConfig.httpPort=a.httpPort,c=esri.config.defaults.io.corsEnabledServers.pop());c&&esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl("http://"+location.host).replace(/:80$/,""));e&&esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl("http://"+location.host).replace(/:443$/,""));if(a.authorizedCrossOriginDomains&&0<a.authorizedCrossOriginDomains.length)for(var f=0;f<a.authorizedCrossOriginDomains.length;f++)c=
a.authorizedCrossOriginDomains[f],esri.isDefined(c)&&0<c.length&&esri.config.defaults.io.corsEnabledServers.push({host:c,withCredentials:!0});(this.isLoggedIn=this.util.isLoggedIn())?this.loggedIn():this.loggedOut();this._loadFilterMode();a.isPortal&&arcgisonline.sharing.util._cookies&&-1===arcgisonline.sharing.util._cookies.esri_auth&&delete arcgisonline.sharing.util._cookies.esri_auth;f=b.locale;a.user&&a.user.culture?f=a.user.culture:a.culture&&(f=a.culture);c=arcgisonline.sharing.util.getUser();
e=b.queryToObject(window.location.search.substring(1));if(a.culture&&!c)a.culture=a.culture.toLowerCase(),b.cookie("arcgisLocale",a.culture),-1!==a.culture.indexOf("ar")?esriGeowConfig.isRightToLeft=!0:esriGeowConfig.isRightToLeft=!1,b.locale.toLowerCase()!==a.culture.toLowerCase()&&window.location.reload();else if(!a.culture&&!c)b.cookie("arcgisLocale")&&(b.cookie("arcgisLocale",null,{expires:-1}),window.location.reload());else if(c&&f&&b.locale!==f.toLowerCase()&&!e.locale){var g=arcgisonline.sharing.util.getCookie("esri_auth");
if(g&&(g.username=g.username||g.email,g&&g.username===a.user.username)){9>b.isIE&&g.auth_tier&&"web"===g.auth_tier&&(e=new Date,g.expires=new Date(e.setSeconds(e.getSeconds()+Number(7200))));if(!g.culture||g.culture&&g.culture!==f.toLowerCase())g.culture=f.toLowerCase(),arcgisonline.sharing.geow.Geow.setAuthCookie(g),b.cookie("arcgisLocale",g.culture.toLowerCase());window.location.reload()}}if(c&&esri.isDefined(c.auth_tier)&&"web"===c.auth_tier)if(b.style(b.byId("logout-link"),"display","none"),c.username=
c.username||c.email,c&&c.culture.toLowerCase()!==f.toLowerCase()){g=arcgisonline.sharing.util.getCookie("esri_auth")||{};9>b.isIE&&(e=new Date,g.expires=new Date(e.setSeconds(e.getSeconds()+Number(7200))));if(!c.culture||c.culture&&c.culture.toLowerCase()!==f.toLowerCase())c.culture=f.toLowerCase(),g.culture=c.culture,a.allSSL&&(g.allSSL=!0,g.secure=!0),arcgisonline.sharing.geow.Geow.setAuthCookie(g),c=b.mixin(c,g);window.location.reload()}else c&&c.culture.toLowerCase()===f.toLowerCase()&&b.locale.toLowerCase()!==
f.toLowerCase()&&window.location.reload();a.allSSL&&(this.allSSL=esriGeowConfig.allSSL=a.allSSL);esri.isDefined(esriGeowConfig.allSSL)&&esriGeowConfig.allSSL&&"http:"===location.protocol&&(window.location=arcgisonline.sharing.util.getSecureUrl(location.href));a.helpBase&&(esriGeowConfig.help=a.helpBase,esriGeowConfig.helpBase=a.helpBase,f=esriGeowConfig.self&&esriGeowConfig.self.helpBase||"support.html",this.util.isPortal()&&(f=location.protocol+"//"+location.host+a.helpBase,f=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?
arcgisonline.sharing.util.getSecureUrl(f):arcgisonline.sharing.util.getHttpUrl(f)),b.attr(b.byId("siteHeader-help"),"href",f),b.attr(b.byId("help-link"),"href",f),b.attr(b.byId("admin-guide"),"href",f.replace("/website/","/admin/")));a.helpMap&&a.helpMap.m&&(esriGeowConfig.helpMap=a.helpMap.m);a.portalHostname&&(esriGeowConfig.portalHostname=a.portalHostname);a.urlKey&&(esriGeowConfig.urlKey=a.urlKey);a.staticImagesUrl&&(esriGeowConfig.staticImagesUrl=a.staticImagesUrl);a.id&&a.access&&(f=esriGeowConfig.baseUrl,
e=esriGeowConfig.self.isPortal?this.logOut:this.agolLogOut,"private"===a.access?(this.isPrivateOrg=!0,f=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin,b.create("a",{innerHTML:this.i18n.signOut,href:f,onclick:b.hitch(this,this.logOutMethod)},this._signInOutLink,"only")):"public"===a.access&&this.isLoggedIn&&(this.isPublicOrg=!0,f+="index.html",f=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(f):arcgisonline.sharing.util.getHttpUrl(f),b.create("a",
{innerHTML:this.i18n.signOut,href:f,onclick:b.hitch(this,e)},this._signInOutLink,"only")));f=!1===esriGeowConfig.isMultiTenant;f||(e=window.location.host,e===a.portalHostname||-1===e.indexOf(a.customBaseUrl)||a.access||a.name||(window.location=window.location.href.replace(e,a.portalHostname)),!c||"account_admin"!==c.role&&"org_admin"!==c.role||!a.id||a.urlKey||this.isSetupPage||(window.location=esriGeowConfig.baseUrl+"setup.html"));f?(!a.access||"private"!==a.access||this.isLoggedIn||this.isSignInPage||
this.isTroubleshootPage||this.isJoinPage||this.isSignUpPage||(window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location)),this.switchHeaderGraphic(),a.isPortal&&"singletenant"===a.portalMode&&(arcgisonline.sharing.util.getUser()||b.cookie("esri_auth_guest")&&"7443"!==location.port&&b.addClass(b.byId("logged-out-navigation"),"hide"),"7080"!==location.port&&"7443"!==location.port||arcgisonline.sharing.util.checkForIAA().then(b.hitch(this,
function(c){if(c&&c.hasIAA&&(a.portalHostname.match(/:7080\//)&&"http:"===location.protocol&&-1===location.href.indexOf("error.html")&&(window.location=arcgisonline.sharing.util.getHttpUrl(esriGeowConfig.baseUrl)+"error.html?c\x3dWebAdaptorRequired"),!a.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.httpPort&&443!==esriGeowConfig.httpsPort&&"http:"===location.protocol&&-1===location.href.indexOf("error.html"))){c=new b._Url(location.href);var d=c.path.indexOf("/home/"),d=c.path.substring(d+
6);c=esri.isDefined(c.query)?"?"+c.query:"";window.location=arcgisonline.sharing.util.getHttpUrl("http://"+a.portalHostname)+"/home/"+d+c}})))):a.id||!a.urlKey||this.isLoggedIn?a.id&&a.urlKey&&!this.isLoggedIn&&this.switchHeaderGraphic():this.isSignInPage||this.isTroubleshootPage||this.isJoinPage?this.switchHeaderGraphic():window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location)}c=esriGeowConfig.baseUrl;this.isSignInPage&&
(esriGeowConfig.urlKey&&window.location.hostname!==esriGeowConfig.portalHostname?(b.query("#signInForm #left").style("display","none"),b.query("#signInForm #leftAgo").style("display","none"),b.query("#signInForm #rightAgo").addClass("rightAgoSolo"),(f=b.query("#signInForm #right"))&&0<f.length&&(f=f[0],b.removeClass(f,"esriFloatTrailing"),b.addClass(f,"esriFloatLeading"),esriGeowConfig.isRightToLeft?b.style(f,"paddingRight","30%"):b.style(f,"paddingLeft","30%"))):f||(f=b.create("a",{href:b.attr("site-logo",
"href")}),b.attr("site-logo","href",f.href.replace("https:","http:"))),document.referrer&&-1<document.referrer.indexOf("http://")&&(c=c.replace("https:","http:")));!this.util.isPortal()&&this.isSetupPage&&(b.query("a[page\x3d'user.html']").forEach(b.hitch(this,function(a){b.addClass(a,"disabled")})),b.addClass(b.byId("header"),"setupWorkflow"));!this.util.isPortal()&&this.isSignInPage&&b.addClass(b.byId("header"),"hideSignInButton");!this.util.isPortal()&&this.isLoggedIn&&b.attr(b.byId("site-logo"),
"href","index.html");(this.util.isPortal()||!arcgisonline.sharing.util.getUser())&&b.byId("siteHeader-features")&&b.style(b.byId("siteHeader-features"),"display","none");this.util.isPortal()&&(b.byId("siteHeader-plan")&&b.style(b.byId("siteHeader-plan"),"display","none"),b.attr(b.byId("site-logo"),"innerHTML",this.i18n.home_link),b.attr(b.byId("site-logo"),"href","index.html"));c=this.util.getUser();esriGeowConfig.restrictOrganizationPageToAdmin&&c&&c.accountId&&c.role&&"account_admin"!==c.role&&
b.style(b.byId("siteHeader-myOrganization"),"display","none");esriGeowConfig.showAccountSwitcher&&(this.switchAccountsLink.href=esriGeowConfig.baseUrl+"pages/Account/manage_accounts.html#client_id\x3darcgisonline",b.removeClass(this.switchAccountsLink,"hide"));b.byId("esri-community-img-icon")||b.create("img",{id:"esri-community-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},b.byId("esri-community-img"));b.byId("my-esri-img-icon")||b.create("img",
{id:"my-esri-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},b.byId("my-esri-img"));!this.util.isPortal()&&c&&"both"===c.userType&&(b.removeClass(b.byId("esri-community"),"hide"),b.removeClass(b.byId("my-esri"),"hide"),b.removeClass(b.byId("training"),"hide"));this.util.isPortal()||(b.removeClass(b.byId("training"),"hide"),b.byId("training-img-icon")||b.create("img",{id:"training-img-icon",src:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/LinkToOtherApp16.png")},
b.byId("training-img")));this.util.isPortal()||!esriGeowConfig.self||!esriGeowConfig.self.subscriptionInfo||"Trial"!==esriGeowConfig.self.subscriptionInfo.type&&"Trial Press"!==esriGeowConfig.self.subscriptionInfo.type||b.removeClass(b.byId("trial-download"),"hide")},updateEsriAccessLinks:function(a){!this.util.isPortal()&&a&&"both"===a?(b.removeClass(b.byId("esri-community"),"hide"),b.removeClass(b.byId("my-esri"),"hide"),b.removeClass(b.byId("training"),"hide")):(b.addClass(b.byId("esri-community"),
"hide"),b.addClass(b.byId("my-esri"),"hide"),b.addClass(b.byId("training"),"hide"))},handleItemEnter:function(a){b.hasClass(a.currentTarget.id,"selected")||b.addClass(a.currentTarget.id,"hover")},handleItemLeave:function(a){b.hasClass(a.currentTarget.id,"selected")||b.removeClass(a.currentTarget.id,"hover")},openPage:function(a){document.location=a},openPageNewWindow:function(a){window.open(a,"_blank")},updateLinks:function(){},adjustNavBar:function(){var a=this.util.getUser();b.query(".js-top-nav-link",
this.domNode).addClass("hide").on("click",b.hitch(this,"_handleLinkClick"));esriGeowConfig.sceneViewerEnabled&&b.query("#sceneViewer",this.domNode).removeClass("hide");esriGeowConfig.self&&esriGeowConfig.self.urlKey||this.util.isPortal()?(b.query(".organization",this.domNode).removeClass("hide"),a&&(b.query(".orgUser",this.domNode).removeClass("hide"),b.query(".help",this.domNode).addClass("hide"),b.attr(b.byId("site-logo"),"href","index.html"))):(b.query(".anon",this.domNode).removeClass("hide"),
b.query(".js-gallery",this.domNode).addClass("hide"),a?(b.query(".pubUser",this.domNode).removeClass("hide"),b.query(".help",this.domNode).addClass("hide")):esriGeowConfig.self&&(esriGeowConfig.self.id||esriGeowConfig.self.urlKey)&&b.query(".js-gallery",this.domNode).removeClass("hide"));9>b.has("ie")&&b.query(".helpNav",this.domNode).style({display:"none"})},loggedOut:function(){var a="";b.removeClass(b.byId("logged-out-navigation"),"hide");b.addClass(b.byId("logged-in-navigation"),"hide");this.adjustNavBar();
-1===esriGeowConfig.signin.indexOf("http")&&(a=esriGeowConfig.baseUrl,this.allSSL||!1!==esriGeowConfig.useSSL)&&(a=a.replace("http:","https:"),!1===esriGeowConfig.isMultiTenant||esriGeowConfig.self&&esriGeowConfig.self.portalMode&&"singletenant"===esriGeowConfig.self.portalMode)&&(a=arcgisonline.sharing.util.getSecureUrl());if(this.isNewUserPage)b.create("span",{style:{color:"#BBBBBB",marginLeft:"18px"},innerHTML:this.i18n.signIn},this._signInOutLink,"only");else{var d=b.create("a",{href:"#",innerHTML:this.i18n.signIn},
this._signInOutLink,"only");this.isItemDetailsPage?b.attr(d,"href",a+esriGeowConfig.signin+"?returnUrl\x3d"+document.location.href):b.attr(d,"href",a+esriGeowConfig.signin+"?")}b.query(".menu-logged-in",this.domNode).addClass("hide");arcgisonline.sharing.util.isPortal()||b.attr(b.byId("login-link"),"href",esriGeowConfig.baseUrl+esriGeowConfig.signin)},loggedIn:function(){var a=this.util.getUser();if(null===a)this.loggedOut();else{var d=this.util.getUserDisplayName(a);b.attr(b.byId("username"),"innerHTML",
d);b.attr(b.byId("username"),"title",a.fullName);b.attr(this._userProfileLink,"innerHTML",a.username);b.attr("profileLink","title",a.fullName);b.addClass(b.byId("logged-out-navigation"),"hide");b.removeClass(b.byId("logged-in-navigation"),"hide");this.util.isPortal()&&"account_admin"===a.role?b.removeClass(b.byId("admin-guide"),"hide"):b.addClass(b.byId("admin-guide"),"hide");d=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl):
esriGeowConfig.restBaseUrl;d=esriGeowConfig.userInfo.thumbnail?d+"community/users/"+esriGeowConfig.userInfo.username+"/info/"+esriGeowConfig.userInfo.thumbnail+"?token\x3d"+esriGeowConfig.userInfo.token:this.util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");b.attr("dropdown-image","src",d);b.attr("profileImgSmall","src",d);a.accountId&&null!==a.accountId&&(void 0!==esriGeowConfig.isMultiTenant&&!0!==esriGeowConfig.isMultiTenant||esriGeowConfig.portalName||this.switchHeaderGraphic());
this.adjustNavBar();b.subscribe("onNotificationCount",this,"notificationCountHandler");arcgisonline.sharing.geow.Community.getNotificationsCount()}},selectLogOut:function(a){a.preventDefault();esriGeowConfig.self.isPortal?this.logOut():this.agolLogOut()},logOut:function(){b.cookie("esri_webmap","",{expires:-1,path:"/"});var a=arcgisonline.sharing.util.getHttpUrl()+"index.html";this.isPrivateOrg&&(a=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin);this.isPublicOrg&&(a=(this.allSSL||
arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl())+"index.html");this.geow.signout(a)},agolLogOut:function(){b.cookie("esri_webmap","",{expires:-1,path:"/"});var a;a=(esriGeowConfig.isDebug?esriGeowConfig.baseUrl:esriGeowConfig.baseUrl.replace("http://","https://"))+"pages/Account/manage_accounts.html#client_id\x3darcgisonline\x26signout\x3dtrue";window.location.href=a},notificationCountHandler:function(a){var c=0;0<a&&(c=a);b.create("a",
{title:this.i18n.notifications,"class":"link-white",innerHTML:c,href:"#",onclick:b.hitch(this,function(a){a&&a.preventDefault&&a.preventDefault();arcgisonline.sharing.geow.Community.getNotifications()})},b.byId("notifications"),"only");0===a?b.addClass(b.byId("notifications_box"),"hide"):1<=a&&b.removeClass(b.byId("notifications_box"),"hide")},switchHeaderGraphic:function(){var a=b.query(".siteHeader div.mainSearch"),d=b.query(".siteHeader ul.mainTabs li a"),e,f=b.baseUrl.substring(0,b.baseUrl.indexOf("/js"));
for(e=0;e<a.length;e++)b.style(a[e],{background:esriGeowConfig.isRightToLeft?"url('"+f+"/js/arcgisojs/arcgisonlineanization-global-nav-rtl-"+(-1!==b.locale.indexOf("-")?b.locale.split("-")[0]:b.locale)+".png') no-repeat scroll 0 0 transparent":"url('"+f+"/js/arcgisonlinejs/arcgisonlinetion-global-nav"+("en"!==b.locale.split("-")[0]?"-"+b.locale:"")+".png') no-repeat 100% 0"}),b.addClass(a[e],"esriOrg");for(e=0;e<d.length;e++)b.style(d[e],{backgroundImage:esriGeowConfig.isRightToLeft?"url('"+f+"/js/arcgisonline/css/js/arcgisonlineglobal-nav-rtl-"+
(-1!==b.locale.indexOf("-")?b.locale.split("-")[0]:b.locale)+".png')":"url('"+f+"/js/arcgisonline/css/images/organization-global-nav"+("en"!==b.locale.split("-")[0]?"-"+b.locale:"")+".png')"}),b.addClass(d[e],"esriOrg")},goEsriCommunity:function(a){a.preventDefault();this.openPageNewWindow(this.generateEsriLoginHandlerUrl(esriGeowConfig.esriCommunityLink))},goMyEsri:function(a){a.preventDefault();this.openPageNewWindow(this.generateEsriLoginHandlerUrl(esriGeowConfig.myEsriLink))},goTraining:function(a){a.preventDefault();
a={administrator:"//www.esri.com/training/main/arcgis-online-administrators",publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"};var b=esriGeowConfig.userRole,c;b?b.isAdmin()||b.isBasedOnAdmin()?c=a.administrator:b.isPublisher()||b.isBasedOnPublisher()?c=a.publisher:b.isUser()||b.isBasedOnUser()?c=a.user:
b.isCustom()&&(c=a.custom):c=a["public"];this.openPageNewWindow(this.generateEsriLoginHandlerUrl(window.location.protocol+c))},generateEsriLoginHandlerUrl:function(a){var b=this.getDevEnviroment(),b="https://accounts"+(b?"dev"===b?"-dev":"-stg":"")+".esri.com/",c="\x26authBaseUrl\x3d"+esriGeowConfig.restBaseUrl.replace("/sharing/rest/","");return b+"LoginHandler/switchuser?"+("username\x3d"+esriGeowConfig.userInfo.username+"\x26redirect_uri\x3d"+a+c)},getDevEnviroment:function(){var a=esriGeowConfig.portalHostname;
return-1!==a.indexOf("dev")?"dev":-1!==a.indexOf("qa")?"qa":null},goTrialDownload:function(a){a.preventDefault();a=(esriGeowConfig.self&&esriGeowConfig.self.user&&esriGeowConfig.self.user.culture||esriGeowConfig.self&&esriGeowConfig.self.culture||dojoConfig.locale||"en").toLowerCase();a=esriGeowConfig.learnArcGIS+"/"+arcgisonline.pages.utils.culture.getTrialLocale(a)+"/trial";this.openPageNewWindow(a)},_handleLinkClick:function(a){if(a.currentTarget&&b.attr(a.currentTarget,"href")){a.preventDefault();
var c=b.attr(a.currentTarget,"href"),e=arcgisonline.sharing.util.usePortalSSL(),f=!arcgisonline.sharing.util.isPortal()&&"https:"===window.location.protocol,e=this.allSSL||e||f?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl(),f=esriGeowConfig.self&&esriGeowConfig.self.helpBase||"support.html",g=a&&a.target&&a.target.id;arcgisonline.sharing.util.isPortal()?-1<c.indexOf("/support.html")?(a.preventDefault(),this.openPageNewWindow(f)):"admin-guide"===g?(a.preventDefault(),
arcgisonline.sharing.util.openPage(f.replace("/website/","/admin/"))):("7443"===location.port&&(e=arcgisonline.sharing.util.getSecureUrl()),arcgisonline.sharing.util.openPage(e+c,!0)):(a="support.html"===c?f:c&&-1===c.indexOf("http")?e+c:c,arcgisonline.sharing.util.openPage(a,!0))}return!1},_handleUserDropdown:function(c){var d=b.query(".js-logged-in-navigation",this.domNode);b.hasClass(d[0],"is-active")||(b.query(".js-dropdown").removeClass("is-active"),d.addClass("is-active"),b.stopEvent(c),c=document.body,
d=a,c.addEventListener?c.addEventListener("click",d,!1):c.attachEvent&&c.attachEvent("onclick",d))}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){var w=k("dijit.layout._Splitter",[q,t],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);a.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var b=h(this._cookieName);b&&(this.child.domNode.style[this.horizontal?"height":"width"]=b)}},_computeMaxSize:function(){var a=
this.horizontal?"h":"w",c=d.getMarginBox(this.child.domNode)[a],e=b.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=d.getContentBox(e.domNode)[a]-10;return Math.min(this.child.maxSize,c+a)},_startDrag:function(b){this.cover||(this.cover=c.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));a.add(this.cover,"dijitSplitterCoverActive");this.fake&&c.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),
a.add(this.domNode,"dijitSplitterShadow"),c.place(this.fake,this.domNode,"after"));a.add(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active");this.fake&&a.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var f=this._factor,k=this.horizontal,h=k?"pageY":"pageX",n=b[h],D=this.domNode.style,k=k?"h":"w",p=e.getComputedStyle(this.child.domNode),w=d.getMarginBox(this.child.domNode,p)[k],v=this._computeMaxSize(),H=Math.max(this.child.minSize,
d.getPadBorderExtents(this.child.domNode,p)[k]+10),k=this.region,t="top"==k||"bottom"==k?"top":"left",u=parseInt(D[t],10),q=this._resize,B=g.hitch(this.container,"_layoutChildren",this.child.id),k=this.ownerDocument;this._handlers=this._handlers.concat([l(k,m.move,this._drag=function(a,b){a=a[h]-n;var c=f*a+w,d=Math.max(Math.min(c,v),H);(q||b)&&B(d);D[t]=a+u+f*(d-c)+"px"}),l(k,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),l(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();
a.preventDefault()}),l(k,m.release,g.hitch(this,"_stopDrag"))]);b.stopPropagation();b.preventDefault()},_onMouse:function(b){b="mouseover"==b.type||"mouseenter"==b.type;a.toggle(this.domNode,"dijitSplitterHover",b);a.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",b)},_stopDrag:function(b){try{this.cover&&a.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&c.destroy(this.fake),a.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),
this._drag(b),this._drag(b,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&h(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?f.UP_ARROW:f.LEFT_ARROW:c*=-1;case b?f.DOWN_ARROW:f.RIGHT_ARROW:break;default:return}b=d.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*
c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),v=k("dijit.layout._Gutter",[q,t],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},
buildRendering:function(){this.inherited(arguments);a.add(this.domNode,"dijitGutter"+(this.horizontal?"H":"V"))}});k=k("dijit.layout.BorderContainer",p,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:w,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,d=a.isLeftToRight();"leading"==b&&(b=d?"left":"right");"trailing"==b&&(b=d?"right":"left");b&&
"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget&&(d=a.splitter?this._splitterClass:v,g.isString(d)&&(d=g.getObject(d)),d=new d({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),d.isSplitter=!0,a._splitterWidget=d,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),c.place(d.domNode,a.domNode,b?"before":"after"),d.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);
this.inherited(arguments)},getChildren:function(){return b.filter(this.inherited(arguments),function(a){return!a.isSplitter})},getSplitter:function(a){return b.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=e.getComputedStyle(c);this.pe=d.getPadExtents(c,this.cs);this.pe.r=e.toPixelValue(c,this.cs.paddingRight);this.pe.b=e.toPixelValue(c,this.cs.paddingBottom);e.set(c,"padding","0px")}this.inherited(arguments)},
_layoutChildren:function(a,c){if(this._borderBox&&this._borderBox.h){var d=[];b.forEach(this._getOrderedChildren(),function(a){d.push(a);a._splitterWidget&&d.push(a._splitterWidget)});u.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},d,a,c)}},destroyRecursive:function(){b.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});k.ChildWidgetProperties={splitter:!1,
minSize:0,maxSize:Infinity};g.mixin(k.ChildWidgetProperties,p.ChildWidgetProperties);g.extend(n,k.ChildWidgetProperties);k._Splitter=w;k._Gutter=v;return k})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(b,h){b.cookie=function(b,a,c){var d=document.cookie,e;if(1==arguments.length)e=(e=d.match(new RegExp("(?:^|; )"+h.escapeString(b)+"\x3d([^;]*)")))?decodeURIComponent(e[1]):void 0;else{c=c||{};d=c.expires;if("number"==typeof d){var f=new Date;f.setTime(f.getTime()+864E5*d);
d=c.expires=f}d&&d.toUTCString&&(c.expires=d.toUTCString());a=encodeURIComponent(a);var d=b+"\x3d"+a,g;for(g in c)d+="; "+g,f=c[g],!0!==f&&(d+="\x3d"+f);document.cookie=d}return e};b.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return b.cookie})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),
function(b,h,k,a,c,d,e,f){h=h("dijit.layout.LayoutContainer",e,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(b.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(a){this.inherited(arguments);a.region&&k.add(a.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var a=b.map(this.getChildren(),function(a,b){return{pane:a,weight:["center"==a.region?Infinity:0,a.layoutPriority,("sidebar"==this.design?1:
-1)*(/top|bottom/.test(a.region)?1:-1),b]}},this);a.sort(function(a,b){a=a.weight;b=b.weight;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return a[c]-b[c];return 0});return b.map(a,function(a){return a.pane})},layout:function(){f.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(a,b){this.inherited(arguments);this._started&&this.layout()},removeChild:function(b){this.inherited(arguments);this._started&&this.layout();k.remove(b.domNode,this.baseClass+"Pane");a.set(b.domNode,
{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});a.set(b.domNode,/top|bottom/.test(b.region)?"width":"height","auto")}});h.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};c.extend(d,h.ChildWidgetProperties);return h})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(b,h,k,a,c){function d(a){return a.substring(0,1).toUpperCase()+a.substring(1)}function e(a,b){var d=a.resize?
a.resize(b):k.setMarginBox(a.domNode,b);d?c.mixin(a,d):(c.mixin(a,k.getMarginBox(a.domNode)),c.mixin(a,b))}var f={marginBox2contentBox:function(b,c){var d=a.getComputedStyle(b),e=k.getMarginExtents(b,d),f=k.getPadBorderExtents(b,d);return{l:a.toPixelValue(b,d.paddingLeft),t:a.toPixelValue(b,d.paddingTop),w:c.w-(e.w+f.w),h:c.h-(e.h+f.h)}},layoutChildren:function(a,f,m,k,q){f=c.mixin({},f);h.add(a,"dijitLayoutContainer");m=b.filter(m,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(b.filter(m,
function(a){return"center"==a.region||"client"==a.layoutAlign}));b.forEach(m,function(a){var b=a.domNode,c=a.region||a.layoutAlign;if(!c)throw Error("No region setting for "+a.id);var g=b.style;g.left=f.l+"px";g.top=f.t+"px";g.position="absolute";h.add(b,"dijitAlign"+d(c));b={};k&&k==a.id&&(b["top"==a.region||"bottom"==a.region?"h":"w"]=q);"leading"==c&&(c=a.isLeftToRight()?"left":"right");"trailing"==c&&(c=a.isLeftToRight()?"right":"left");"top"==c||"bottom"==c?(b.w=f.w,e(a,b),f.h-=a.h,"top"==c?
f.t+=a.h:g.top=f.t+f.h+"px"):"left"==c||"right"==c?(b.h=f.h,e(a,b),f.w-=a.w,"left"==c?f.l+=a.w:g.left=f.l+f.w+"px"):"client"!=c&&"center"!=c||e(a,f)})}};c.setObject("dijit.layout.utils",f);return f})},"arcgisonline/pages/utils/culture":function(){define(["require","exports","tslib","../pageUtil"],function(b,h,k,a){a=k.__importDefault(a);return function(){function b(){}b.stripCultureFormat=function(a,b){return a&&b&&a.length&&b.length&&(b=a.indexOf("-"+b),-1<b)?a.substring(0,b):a};b.getRootLocale=
function(a){a&&a.length&&(a=a.split("-")[0])&&a.length&&(a=a.toLowerCase());return a};b.getTrialLocale=function(a){var b=["pt-br","pt-pt","zh-cn","zh-hk","zh-tw"];return a&&-1<a.indexOf("-")&&-1===b.indexOf(a)?this.getRootLocale(a):a};b.getActualCulture=function(b,c){var d=b?b.toLowerCase():"",e=d.split("-");if(1<e.length){var l=a.default.find(c,function(a){return a.culture===d}.bind(this));if(l)return d;if((l=a.default.find(c,function(a){return a.culture===e[0]}))&&l.cultureFormats){if(c=a.default.find(l.cultureFormats,
function(a){return a.format===e[1]}.bind(this)))return l.culture}else if(l)return l.culture}return b};b.getSelectedFormat=function(b,c){return a.default.find(c,function(a){return a.format===b}.bind(this))};return b}()})},"tslib/tslib":function(){var b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v,B;(function(a){function b(a,b){a!==c&&("function"===typeof Object.create?Object.defineProperty(a,"__esModule",{value:!0}):a.__esModule=!0);return function(c,d){return a[c]=b?b(c,d):d}}var c="object"===typeof global?
global:"object"===typeof self?self:"object"===typeof this?this:{};"function"===typeof define&&define.amd?define("tslib",["exports"],function(d){a(b(c,b(d)))}):"object"===typeof module&&"object"===typeof module.exports?a(b(c,b(module.exports))):a(b(c))})(function(A){var z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};b=function(a,b){function c(){this.constructor=a}z(a,b);a.prototype=null===b?Object.create(b):
(c.prototype=b.prototype,new c)};h=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};k=function(a,b){var c={},d;for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"===typeof Object.getOwnPropertySymbols){var e=0;for(d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&(c[d[e]]=a[d[e]])}return c};a=function(a,b,c,d){var e=
arguments.length,f=3>e?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(a,b,c,d);else for(var m=a.length-1;0<=m;m--)if(g=a[m])f=(3>e?g(f):3<e?g(b,c,f):g(b,c))||f;return 3<e&&f&&Object.defineProperty(b,c,f),f};c=function(a,b){return function(c,d){b(c,d,a)}};d=function(a,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(a,b)};e=function(a,b,c,d){return new (c||(c=Promise))(function(e,
f){function g(a){try{l(d.next(a))}catch(P){f(P)}}function m(a){try{l(d["throw"](a))}catch(P){f(P)}}function l(a){a.done?e(a.value):(new c(function(b){b(a.value)})).then(g,m)}l((d=d.apply(a,b||[])).next())})};f=function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,g&&(m=c[0]&2?g["return"]:c[0]?g["throw"]||((m=g["return"])&&m.call(g),0):g.next)&&!(m=m.call(g,c[1])).done)return m;if(g=0,m)c=[c[0]&2,
m.value];switch(c[0]){case 0:case 1:m=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;g=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(m=e.trys,m=0<m.length&&m[m.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!m||c[1]>m[0]&&c[1]<m[3]))e.label=c[1];else if(6===c[0]&&e.label<m[1])e.label=m[1],m=c;else if(m&&e.label<m[2])e.label=m[2],e.ops.push(c);else{m[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(P){c=[6,P],g=0}finally{f=
m=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},f,g,m,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};g=function(a,b){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])};l=function(a){var b="function"===typeof Symbol&&a[Symbol.iterator],c=0;return b?b.call(a):{next:function(){a&&c>=a.length&&(a=void 0);return{value:a&&a[c++],done:!a}}}};
m=function(a,b){var c="function"===typeof Symbol&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[],f;try{for(;(void 0===b||0<b--)&&!(d=a.next()).done;)e.push(d.value)}catch(H){f={error:H}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error;}}return e};n=function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(m(arguments[b]));return a};q=function(a){return this instanceof q?(this.v=a,this):new q(a)};t=function(a,b,c){function d(a){l[a]&&(k[a]=function(b){return new Promise(function(c,
d){1<h.push([a,b,c,d])||e(a,b)})})}function e(a,b){try{var c=l[a](b);c.value instanceof q?Promise.resolve(c.value.v).then(f,g):m(h[0][2],c)}catch(M){m(h[0][3],M)}}function f(a){e("next",a)}function g(a){e("throw",a)}function m(a,b){(a(b),h.shift(),h.length)&&e(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=c.apply(a,b||[]),k,h=[];return k={},d("next"),d("throw"),d("return"),k[Symbol.asyncIterator]=function(){return this},k};p=function(a){function b(b,
e){c[b]=a[b]?function(c){return(d=!d)?{value:q(a[b](c)),done:"return"===b}:e?e(c):c}:e}var c,d;return c={},b("next"),b("throw",function(a){throw a;}),b("return"),c[Symbol.iterator]=function(){return this},c};u=function(a){function b(b){e[b]=a[b]&&function(d){return new Promise(function(e,f){d=a[b](d);c(e,f,d.done,d.value)})}}function c(a,b,c,d){Promise.resolve(d).then(function(b){a({value:b,done:c})},b)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d=a[Symbol.asyncIterator],
e;return d?d.call(a):(a="function"===typeof l?l(a):a[Symbol.iterator](),e={},b("next"),b("throw"),b("return"),e[Symbol.asyncIterator]=function(){return this},e)};w=function(a,b){Object.defineProperty?Object.defineProperty(a,"raw",{value:b}):a.raw=b;return a};v=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b};B=function(a){return a&&a.__esModule?a:{"default":a}};A("__extends",b);A("__assign",h);A("__rest",
k);A("__decorate",a);A("__param",c);A("__metadata",d);A("__awaiter",e);A("__generator",f);A("__exportStar",g);A("__values",l);A("__read",m);A("__spread",n);A("__await",q);A("__asyncGenerator",t);A("__asyncDelegator",p);A("__asyncValues",u);A("__makeTemplateObject",w);A("__importStar",v);A("__importDefault",B)})},"arcgisonline/pages/pageUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/Deferred dojo/json dojo/on dojo/when dojo/hash dojo/string dojo/number dojo/query dojo/sniff dojo/keys dojo/promise/all dojo/io-query dijit/Dialog dijit/_editor/plugins/FontChoice esri/lang esri/arcgis/Portal esri/geometry/Point esri/tileUtils esri/urlUtils ../sharing/util ../esriGeowConfig ../sharing/geow/Folder ../sharing/dijit/dialog/_CreateItemUtilMixin ../map/core/canUseForPublish ./dijit/Alert dojo/i18n!../nls/arcgisonline".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v,B,A,z,y,E,D,x,K,J,H,Q,N,V,P,L){return{editorDefaults:function(a){return{id:a,"aria-label":a,plugins:["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createEsriLink","unlink","insertImage","removeFormat","|","undo","redo","|","viewsource","|",{name:"dijit._editor.plugins.FontChoice",command:"fontSize","class":"dijitFontSizeWrap",
custom:["2","3","4","5","6"]}],style:"font-family: 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;font-size: 15px;",height:"140px"}},tagDefaults:function(a){return{id:a,minWidth:"100%",maxWidth:"100%",required:!0}},getQueryParams:function(){return B.queryToObject(window.location.search.slice(1))},setQueryParams:function(a){this.replaceCurrentLocation(window.location.pathname+"?"+B.objectToQuery(a)+window.location.hash)},updateQueryParams:function(a){this.setQueryParams(h.mixin(this.getQueryParams(),
a))},removeQueryParams:function(a){var b=this.getQueryParams();a.forEach(function(a){delete b[a]},this);this.setQueryParams(b)},replaceCurrentLocation:function(a){history&&history.replaceState&&history.replaceState({},document.title,a)},isHidden:function(a){var b=["none","none !important","none!important"],c=["hidden","hidden !important","hidden!important"];return a&&(-1<k.indexOf(b,e.get(a,"display"))||-1<k.indexOf(c,e.get(a,"visibility")))},hideNode:function(a){a&&c.add(a,"hide")},hideNodes:function(a){a&&
a instanceof Array&&a.forEach(this.hideNode)},showNode:function(a){a&&c.remove(a,"hide")},showNodes:function(a){a&&a instanceof Array&&a.forEach(this.showNode)},toggleNode:function(a){a&&c.toggle(a,"hide")},toggleNodes:function(a){a&&a instanceof Array&&a.forEach(this.toggleNode)},activateNode:function(a){a&&c.add(a,"is-active")},deactivateNode:function(a){a&&c.remove(a,"is-active")},isDisabled:function(b){return b?a.get(b,"disabled"):!1},disableNode:function(b,c){b&&a.set(b,"disabled",c)},disableNodes:function(a,
b){a&&a instanceof Array&&a.forEach(h.hitch(this,function(a){this.disableNode(a,b)}))},isNodeVisible:function(a){return a&&0!==a.offsetHeight},isChecked:function(b){return b?a.get(b,"checked"):!1},checkNode:function(b,c){b&&a.set(b,"checked",c)},selectOption:function(b,c){if(b)for(var d=0;d<b.length;d++)if(this.areEqual(a.get(b[d],"value"),c)){a.set(b[d],"selected",!0);break}},getSelectedOption:function(b){var c=null;if(b)for(var d=0;d<b.length;d++)if(a.get(b[d],"selected")){c=b[d];break}return c},
isString:function(a){return a&&a.constructor===String},startsWith:function(a,b){return y.isDefined(a)&&y.isDefined(b)&&this.isString(a)&&this.isString(b)?0===a.indexOf(b):!1},replaceAll:function(a,b,c){return a.replace(new RegExp(this.escapeRegExp(b),"g"),c)},escapeRegExp:function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$\x26")},applyCSSClassToStringMatch:function(a,b,c){c='\x3cspan class\x3d"'+c+'"\x3e';var d=b.indexOf(a);return-1<d?0===d?c+b.slice(0,a.length)+"\x3c/span\x3e"+b.slice(d+a.length):
b.slice(0,d)+c+b.slice(d,d+a.length)+"\x3c/span\x3e"+b.slice(d+a.length):b},includes:function(a,b){return-1<k.indexOf(a,b)},find:function(a,b){if(y.isDefined(a))for(var c,d=0;d<a.length;d++)if(c=a[d],b(c))return c},findIndex:function(a,b){for(var c=0;c<a.length;c++)if(value=a[c],b(value))return c;return-1},toArray:function(a){return Object.keys(a).map(function(b){return a[b]})},includesSome:function(a,b){return k.some(b,function(b){return-1<a.indexOf(b)})},includesAll:function(a,b){return k.every(b,
function(b){return-1<a.indexOf(b)})},filterOut:function(a,b){return k.filter(a,function(a){return-1===b.indexOf(a)})},concatUnique:function(a,b){var c=[].concat(a||[]);k.forEach(b,function(a){a&&-1===k.indexOf(c,a)&&c.push(a)});return c},isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isSet:function(a){return!!(a&&0<a.length)},areEqual:function(a,b){var c=this.isSet(a),d=this.isSet(b);return!c&&!d||c&&d&&q.trim(a)===q.trim(b)},isJson:function(a){try{g.parse(a)}catch(I){return!1}return!0},
extentToString:function(a){return a=a instanceof Array&&2===a.length&&2===a[0].length&&2===a[1].length?[a[0].join(","),a[1].join(",")].join():a||""},getClosestValue:function(a,b,c){return c-a>=b-c?b:a},findClosestValue:function(a,b){if(b<=a[0])return a[0];if(b>=a[a.length-1])return a[a.length-1];for(var c=0,d=a.length,e=0;c<d;){e=Math.floor((c+d)/2);if(a[e]===b)break;if(b<a[e]){if(0<e&&b>a[e-1])return this.getClosestValue(a[e-1],a[e],b);d=e}else{if(e<a.length-1&&b<a[e+1])return this.getClosestValue(a[e],
a[e+1],b);c=e+1}}return a[e]},isFavorite:function(a){var b=a.portal,c=b.getPortalUser(),c=c&&c.favGroupId,d=new f;y.isDefined(a.isFavorite)?d.resolve(a.isFavorite):c?(a.isFavorite=!1,b.queryItems('(group:"'+c+'" AND id:"'+a.id+'")',!0).then(h.hitch(this,function(b){a.isFavorite=b&&0<b.total;d.resolve(a.isFavorite)}),h.hitch(this,function(){d.resolve(!1)}))):(a.isFavorite=!1,d.resolve(!1));return d},isConfigurableApplication:function(a){var b=new f,c=a.owner,d=a.itemData||{},e=a.itemControl&&-1<a.itemControl.indexOf("admin"),
g=a.typeKeywords||[],m=g.some(function(a){return a.match(/(sourceId#).*/ig)});y.isDefined(a.isConfigurableApp)?b.resolve(a.isConfigurableApp):a.portal.isPortal&&!a.isOwner&&e&&-1<c.indexOf("esri_")?(a.isConfigurableApp=!1,b.resolve(!1)):a.type&&0===a.type.indexOf("Hub")?(a.isConfigurableApp=a.canUpdate,b.resolve(a.isConfigurableApp)):a.canUpdate&&"Web Mapping Application"===a.type?(a.isConfigurableApp=!1,this.includes(g,"WABTemplate")?(a.isConfigurableApp=!1,b.resolve(!1)):this.includes(g,"selfConfigured")?
(a.isConfigurableApp=d&&(d.source||J.isHostedTemplateItem(a.url)||!m),b.resolve(a.isConfigurableApp)):d&&d.source?J.request({url:a.portal.url+"content/items/"+d.source+"/data"}).then(h.hitch(this,function(c){a.isConfigurableApp=c&&c.configurationSettings?!0:!1;b.resolve(a.isConfigurableApp)}),h.hitch(this,function(){a.isConfigurableApp=!1;b.resolve(a.isConfigurableApp)})):b.resolve(!1)):(a.isConfigurableApp=!1,b.resolve(!1));return b},isFilePublishableByUser:function(a){var b=new f,c=a.portal,d=c.getPortalUser(),
d=d&&d.userRole,e=c.supportsHostedServices,g=c.helperServices&&c.helperServices.rasterAnalytics&&y.isDefined(c.helperServices.rasterAnalytics.url),l=d&&d.canCreateItem(),k=e&&l&&a.isAdmin,n=k&&d.canPublishTiles(),p=k&&d.canPublishFeatures(),w=k&&d.canPublishScenes(),v=a.resultData&&a.resultData.length||null,D=k&&g,H=!1;m(c.isBackedBySDS||N.hasCreateLayer(c),h.hitch(this,function(d){c.isBackedBySDS=d;H=y.isDefined(a.canPublishFile)?a.canPublishFile:p&&(this.includes(a.types,"is-feature")||this.includes(a.types,
"is-featureCollection")&&!v&&!a.isMarkup)||n&&this.includes(a.types,"is-tile")||w&&c.isBackedBySDS&&this.includes(a.types,"is-scene-package")||n&&this.includes(a.types,"is-vector-tile")||D&&this.includes(a.types,"is-image-collection")||k&&this.includes(a.types,"is-notebook")?!0:!1;a.canPublishFile=H;b.resolve(H)}));return b},isServicePublishableByUser:function(a,b){var c=new f,d=a.portal.getPortalUser(),d=(d=d&&d.userRole)&&d.canCreateItem(),e=a.serviceInfo||{},g=a.isSDS;b=a.isTable&&!b;b=!a.isMultiServicesView&&
!e.isMultiServicesView&&a.isHostedService&&"Feature Service"===a.type&&d&&g&&!b?!0:!1;a.canPublish=b;c.resolve(b);return c},canPublishTileServiceFromFeatureService:function(a){var b=new f,c=H&&H.publishTilesFromFeaturesEnabled,d=a.portal.getPortalUser(),d=d&&d.userRole,e=this.isServicePublishableByUser(a)&&a.isAdmin&&d.canPublishTiles(),g=this.includes(a.typeKeywords,"Spatiotemporal"),m=k.filter(a.resultData||[],function(a){return"Map Service"===a.type}),d=a.featureLayers,l=a.isHostedService&&k.every(d||
[],h.hitch(this,function(b){return this._canUseForPublish(a,b,!0)})),n=this.isServicePublishableByUser(a).then(h.hitch(this,function(d){n=!(c&&d&&e&&l)||g||m&&m.length?!1:!0;a.canPublishTiles=n;b.resolve(n)}));return b},canPublishVectorTileServiceFromFeatureService:function(a){var b=new f,c=H&&H.publishVectorTilesFromFeaturesEnabled;a.portal.getPortalUser();var d=this.isServicePublishableByUser(a).then(h.hitch(this,function(e){d=c&&e?!0:!1;a.canPublishVectorTiles=d;b.resolve(d)}));return b},canPublishWFSServiceFromFeatureService:function(a){var b=
new f,c=a.portal.getPortalUser(),c=c&&c.userRole,d=this.isServicePublishableByUser(a)&&a.isAdmin&&c.canPublishFeatures(),e=k.filter(a.resultData||[],function(a){return"WFS"===a.type}),g=this.includes(a.typeKeywords,"View Service"),m=this.includes(a.typeKeywords,"Spatiotemporal"),l=this.isServicePublishableByUser(a).then(h.hitch(this,function(c){l=!H.publishWFSFromFeaturesEnabled||!c||!d||g||m||e&&e.length?!1:!0;a.canPublishWFS=l;b.resolve(l)}));return b},canPublishSceneServiceFromFeatureService:function(a){var b=
new f,c=a.portal,d=c.getPortalUser(),d=d&&d.userRole,e=this.isServicePublishableByUser(a),g=c&&!c.isPortal&&e&&a.isAdmin&&d.canPublishScenes(),c=a.featureLayers,m=a.isHostedService&&k.every(c||[],h.hitch(this,function(b){return this._canUseForPublish(a,b,!0,"scene")})),l=a.tables||[],n=k.every(c||[],function(a){return a&&"esriGeometryPoint"===a.geometryType}),p=k.every(c||[],function(a){return a&&"esriGeometryMultiPatch"===a.geometryType}),w=k.filter(a.resultData||[],function(a){return"Scene Service"===
a.type}),v=this.isServicePublishableByUser(a).then(h.hitch(this,function(c){v=!(c&&g&&m&&(n||p))||w&&w.length||l.length||a.hasGeocodeReviewTable?!1:!0;a.canPublishScenes=v;b.resolve(v)}));return b},canPublishViewServiceFromFeatureService:function(a){var b=new f,c=(a.portal||{}).getPortalUser(),c=c&&c.userRole,d=a.isAdmin&&c.canPublishFeatures(),e=this.includes(a.typeKeywords,"View Service"),g=this.isServicePublishableByUser(a,!0).then(h.hitch(this,function(c){g=c&&d&&!e?!0:!1;a.canPublishView=g;b.resolve(g)}));
return b},canEnableAttachments:function(a){var b=new f,c=a.isDataView,c=y.isDefined(a.canEnableAttachments)?a.canEnableAttachments:a.isHostedService&&!c&&a.canUpdate?!0:!1;a.canEnableAttachments=c;b.resolve(c);return b},canAppendData:function(a){var b=new f,c=a.layers||[],d=this.includes(a.typeKeywords,"View Service"),c=!this.includes(a.typeKeywords,"Cloud Drive")&&!d&&a.isAdmin&&a.isHostedService&&c.some(function(a){return a.supportsAppend})?!0:!1;a.canAppendData=c;b.resolve(c);return b},_canUseForPublish:function(a,
b,c,d){a=this.find(a.itemData&&a.itemData.layers||[],function(a){return a.id===b.id});var e=h.clone(b);return V(h.mixin({},e,a&&a.layerDefinition||{}),c,d)},isServiceEditableByUser:function(a){var b=new f,c=a.portal.getPortalUser(),d=a.url||"",e=a.isHostedService,g=a.serviceInfo,m=g&&g.capabilities||"",l=c&&c.userRole,c=c&&-1<d.indexOf(c.orgId),m=-1<m.indexOf("Editing"),g=g&&g.isMultiServicesView,e=y.isDefined(a.canEditService)?a.canEditService:e&&!g&&(a.canUpdate||m&&l&&l.canEditFeaturesFullControl()&&
c)?!0:!1;a.canEditService=e;b.resolve(e);return b},isExportableByUser:function(a){var b=new f,c=a.portal.getPortalUser(),d=c&&c.userRole,c=y.isDefined(a.canExport)?a.canExport:a.isHostedService&&c&&("Feature Service"===a.type&&a.isAdmin||a.serviceInfo&&a.serviceInfo.capabilities&&-1<a.serviceInfo.capabilities.indexOf("Extract")&&(!c.isOrgUser||d&&d.canCreateItem()))?!0:!1;a.canExport=c;b.resolve(c);return b},isOverwriteableService:function(a,b){var c=new f,d={shapefile:1,"file geodatabase":1,geojson:1},
e=a.type,g=a.serviceInfo||{},m=a.adminServiceInfo||{},m=a.isPortal&&!a.isSDS?this.stringToArray(g.capabilities,",",!0):this.stringToArray(m.capabilities||"",",",!0),m=this.includes(m,"ChangeTracking"),l=a.sourceData;!b&&this.includes(a.typeKeywords,"Cloud Drive")&&c.resolve(!1);!a.isAdmin||!a.isHostedService||"Feature Service"!==e||g.syncEnabled||a.isDataView||m?c.resolve(!1):l&&l.owner===a.owner&&(l.type&&l.type.toLowerCase())in d?c.resolve(!0):!l||"CSV"!==l.type&&"Microsoft Excel"!==l.type?c.resolve(!1):
this.fetchPublishParameters(a).then(h.hitch(this,function(b){a.publishParameters=b;c.resolve(b?!0:!1)}));return c},isOverwriteableCloudService:function(a){var b=new f;if(this.includes(a.typeKeywords,"Cloud Drive")){cloudProviderInfo=a.cloudProviderInfo;var c=!1;cloudProviderInfo&&cloudProviderInfo.mimeType?(a.sourceData||(c=!0,a.sourceData={type:-1!==cloudProviderInfo.mimeType.indexOf("csv")?"CSV":"Microsoft Excel"}),this.isOverwriteableService(a,!0).then(h.hitch(this,function(d){c&&(a.sourceData=
null);b.resolve(d?!0:!1)}))):b.resolve(!1)}else b.resolve(!1);return b},isApplicationCreateableFromItem:function(a){var b=new f,c=a.portal.getPortalUser(),d=c&&c.userRole,d=d&&d.canCreateItem()||c&&!c.isOrgUser,e=!1;if(y.isDefined(a.isApplicationCreateableFromItem))b.resolve(a.isApplicationCreateableFromItem);else{a.isApplicationCreateableFromItem=e;if(d)if(this.includes(a.types,"is-map")||this.includes(a.types,"is-scene"))a.isApplicationCreateableFromItem=!0,a.privileges.push("can-create-app"),this.includes(a.types,
"is-map")&&H.showCreateDashboard&&c&&c.isOrgUser&&a.privileges.push("can-create-dashboard-item"),e=!0;else if(this.includes(a.typeKeywords,"Configurable")&&this.includes(a.typeKeywords,"createAppWithoutMap")&&!this.includes(a.typeKeywords,"Web AppBuilder for ArcGIS")||this.includes(a.typeKeywords,"Web AppBuilder for ArcGIS")&&c.isOrgUser)a.isApplicationCreateableFromItem=!0,a.types.push("is-hostedTemplate"),e=!0;b.resolve(e)}return b},isMultipatchFeatureService:function(a){var b="Feature Service"===
a.type&&(a.isHostedService||this.includes(a.typeKeywords,"Hosted"));a=(a.serviceInfo&&a.serviceInfo.layers||[]).some(function(a){return a&&a.geometryType&&"esriGeometryMultiPatch"===a.geometryType},this);return b&&a},stringToArray:function(a,b,c){a=a instanceof Array?a:a.split(b);return c?k.map(a,q.trim):a},registerItemActions:function(b,c,d,e){p("[class*\x3djs-action-]",c).forEach(function(c){var f=a.get(c,"data-action");d[f]&&b.own(l(c,"click",h.hitch(b,function(a){a.preventDefault();d[f](h.mixin({},
{evt:a,item:b.item,user:b.portalUser,page:e,scope:b}))})))},b)},calculateExpectedTiles:function(a,b,c){var d=new D(b.xmax,b.ymin,b.spatialReference);b=new D(b.xmin,b.ymax,b.spatialReference);b=x.getContainingTileCoords(a,b,c);a=x.getContainingTileCoords(a,d,c);a=(a.row+1-b.row)*(a.col+1-b.col);0>=a&&(a=1);return a},sizeInMB:function(a){var b=a||0;0<a&&(b=a/1048567);b=Math.round(100*b)/100;return t.format(b)},getHashParts:function(){return n().split("/")},splitHashParts:function(a){return a?a.split("/"):
[""]},removeUrlQueryParameter:function(a,b){if(a){var c=K.urlToObject(a),d=c.path,e=n()?"#"+n():"";if(!(b&&c.query&&c.query[b]))return a;delete c.query[b];a=0;for(var f in c.query)c.query.hasOwnProperty(f)&&f!==b&&(d=0===a?d+("?"+f+"\x3d"+encodeURIComponent(c.query[f])):d+("\x26"+f+"\x3d"+encodeURIComponent(c.query[f])),a++);return d+e}return a},needsToken:function(a,b){var c=a.portal&&a.portal.getPortalUser(),d=a.serverToken||c&&c.token;return a&&"WFS"!==a.type&&c&&((a.isServiceProxy||a.hasKMLItemData)&&
"public"!==a.access||a.isHostedService&&(a.isAdmin||"public"!==a.access)||a.isFeatureCollection&&"public"!==a.access)?b+(d?"?token\x3d"+d:""):b},addToken:function(a){return(a=this.needsToken(a,a.url))&&-1<a.indexOf("?token\x3d")},needsSSL:function(a,b){return a.portal.allSSL||-1<window.location.protocol.indexOf("https:")?J.getSecureUrl(a.url):b},registerKeystrokeHandler:function(a,b){return l(a,10>=u("ie")||7>u("trident")?"keydown":"keyup",b)},registerEnterSpaceKeystrokeHandler:function(a,b){return l(a,
"keyup",function(a){a.keyCode!==w.ENTER&&a.keyCode!==w.SPACE||b(a)})},sendAllResources:function(a,b,c,d,e){var g=new f;c=h.clone(c);for(var m=[],l=c.splice(0,b);l&&0<l.length;)m.push(J.request({url:a,content:d(l)},h.mixin({usePost:!0},e||{}))),l=c.splice(0,b);v(m).then(function(a){g.resolve(a)},function(a){g.reject(a)});return g},fetchAllResources:function(a,b,c){var d=new f,e=1,g=[],m,l,h,n;b=b||{};c=c||"results";b.start=e;b.num=100;J.request({url:a,content:b}).then(function(f){if(f&&f[c]){g=g.concat(f[c]);
e=f.nextStart;m=f.total-g.length;l=Math.ceil(m/100);h=[];for(n=0;n<l;n++)b.start=e+100*n,h.push(J.request({url:a,content:b}));v(h).then(function(a){k.forEach(a,function(a){g=g.concat(a[c])});d.resolve(g)},function(a){d.reject(a)})}else d.resolve(g)},function(a){d.reject(a)});return d},deleteItem:function(a){return J.request({url:a.userItemUrl+"/delete"},{usePost:!0})},getUserProfile:function(a){a="string"===typeof a?{username:a}:a;var b=H.restBaseUrl+"community/users/"+a.username,c=J.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");
return J.request({url:b}).then(function(d){return h.mixin(d,{thumbnailUrl:d.thumbnail?E.PortalUtil.formatUrl(b+"/info/"+d.thumbnail):c},a)})},getItemSharing:function(a){var b=new f,c=a.portal,d=c.getPortalUser(),e=a.itemOwner,g={access:a.access},m,l,n,p;a.canUpdate&&(a.isOwner||d&&d.canViewOthersOrgItems)?J.request({url:a.userItemUrl}).then(h.hitch(this,function(f){if(m=(g=f.sharing)&&g.groups)p={userGroups:d.getGroups(),ownerGroups:a.isOwner?null:e.getGroups()},v(p).then(h.hitch(this,function(d){l=
(d.userGroups||[]).concat(d.ownerGroups||[]);(n=l.filter(h.hitch(this,function(a){return this.find(m,function(b){return a.id===b})})).map(function(a){return'id: "'+a.id+'"'}))&&n.length?c.queryGroups({q:n.join(" OR "),num:100},!0).then(h.hitch(function(c){g=h.mixin(g,{groups:k.filter(c.results||[],"return item.title;")});g.groups=g.groups.sort(function(a,b){return b.title.localeCompare(a.title)});a=h.mixin(a,{sharing:g});b.resolve(g)})):(delete g.groups,a=h.mixin(a,{sharing:g}),b.resolve(g))}))})):
(a=h.mixin(a,{sharing:g}),b.resolve(g));return b},protectItem:function(a){return J.request({url:a.userItemUrl+"/protect"},{usePost:!0})},unprotectItem:function(a){return J.request({url:a.userItemUrl+"/unprotect"},{usePost:!0})},protectGroup:function(a){return J.request({url:H.restBaseUrl+"community/groups/"+a.id+"/protect"},{usePost:!0})},unprotectGroup:function(a){return J.request({url:H.restBaseUrl+"community/groups/"+a.id+"/unprotect"},{usePost:!0})},fetchPublishParameters:function(a){var b=new f,
c=a.itemUrl+"/info/publishParameters.json";a=a.sourceData;!a||"CSV"!==a.type&&"Microsoft Excel"!==a.type?b.resolve(!1):J.request({url:c}).then(function(a){b.resolve(a)},function(){b.resolve(!1)});return b},fetchRegisteredAppInfo:function(a){a=J.getSecureUrl(a.userItemUrl+"/registeredAppInfo");return J.request({url:a})},refreshAppSecret:function(a){a=J.getSecureUrl(H.restBaseUrl)+"oauth2/apps/"+a+"/resetSecret";return J.request({url:a},{usePost:!0})},registerApp:function(a,b){b=J.getSecureUrl(H.restBaseUrl)+
"oauth2/"+(b?"apps/"+a.client_id+"/update":"registerApp");return J.request({url:b,content:a},{usePost:!0})},unregisterApp:function(a){a=J.getSecureUrl(H.restBaseUrl)+"oauth2/apps/"+a+"/unregister";return J.request({url:a},{usePost:!0})},enableAttachments:function(a,b,c){return J.request({url:a.adminUrl+"/"+b.id+"/updateDefinition",content:{updateDefinition:g.stringify({hasAttachments:c?!0:!1})}},{usePost:!0}).then(function(){b.hasAttachments=c})},isItemListable:function(a){var b=a.portal.getPortalUser().userRole,
c=b&&b.isCustom()&&b.canManageMarketplace(),b=b&&b.isAdmin()||c,c=this.includes(a.typeKeywords,"Service Proxy")&&a.sourceUrl&&(-1<a.sourceUrl.indexOf(".arcgis.com")||-1<a.sourceUrl.indexOf(".esri.com")),d=H.self.canListApps,e=H.self.canListData;a.listed||!H.self||!b||e&&c?(a=new f,a.resolve(!1)):d&&(this.includes(a.typeKeywords,"Registered App")||this.includes(["ArcGIS Pro Add In","AppBuilder Widget Package"],a.type))?(a=new f,a.resolve(!0)):e&&this.includes(["Rule Package"],a.type)?(a=new f,a.resolve(!0)):
e?a=this.isServiceListable(a):(a=new f,a.resolve(!1));return a},isServiceListable:function(a){var b=H.restBaseUrl+"portals/isServerRegistered",c=a.type?a.type.toLowerCase():"",d=a.url&&J.parseUrl(a.url);"web map"===c?(a=new f,a.resolve(!0)):J.isHostedServiceItem(a)?(a=new f,a.resolve(!0)):d&&y.isDefined(d.protocol)&&y.isDefined(d.host)?a=J.request({url:b,content:{serverUrl:d.protocol+"://"+d.host}}).then(h.hitch(this,function(a){return a.registered})):(a=new f,a.resolve(!1));return a},findLayer:function(a,
b){var c;a=parseInt(a,10);y.isDefined(a)&&(c=k.filter(b||[],function(b){return b.id===a}).shift());return c},getServiceNameFromUrl:function(a){var b=a.url||"",c=/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|VectorTileServer|StreamServer)).*/ig,d=b.replace(c,"").replace(/^.*\//,"").replace(/\?.*$/,""),b=b.replace(/http.+\/(arcgis\/rest\/services|\/.*\/rest\/services|arcgis\/services)\/?/ig,"").match(c);
try{return b?decodeURI(d):a.title}catch(X){return d}},getAppPurpose:function(a){a=a.typeKeywords;var b;this.includes(a,"Ready To Use")||this.includes(a,"Ready to Use")?b=L.itemProperties.readyToUse:this.includes(a,"selfConfigured")?b=L.itemProperties.selfConfigurable:this.includes(a,"Configurable")?b=L.itemProperties.configurable:this.includes(a,"Code Sample")&&(b=L.itemProperties.codeSample);return b},getAppApi:function(a){a=a.typeKeywords;var b;this.includes(a,"Windows Mobile")?b=L.common.mobile:
this.includes(a,"ArcGIS for iPhone")?b=L.common.ios:this.includes(a,"ArcGIS for Windows Phone")?b=L.common.windowsPhone:this.includes(a,"ArcGIS for Windows Store")?b=L.common.windowsStore:this.includes(a,"ArcGIS for Windows Universal")?b=L.common.windowsUniversal:this.includes(a,"ArcGIS for Android")?b=L.common.Android:this.includes(a,"Flex")?b=L.common.Flex:this.includes(a,"JavaScript")?b=L.common.JavaScript:this.includes(a,"Silverlight")?b=L.common.Silverlight:this.includes(a,"Web ADF")?b=L.common.WebADF:
this.includes(a,"Other")?b=L.common.other:this.includes(a,"Java")?b="Java":this.includes(a,"Qt")?b="Qt":this.includes(a,".NET-Windows Desktop")?b=".NET\u2013Windows Desktop":this.includes(a,"WPF")?b="WPF":this.includes(a,"OS X")&&(b="OS X");return b},linkify:function(a){a=J.htmlEncode(a);for(var b=a.indexOf("http"),c,d,e;-1<b;)c=a.substring(b,b+8),-1<c.indexOf("http://")||-1<c.indexOf("https://")?(c=!0,6<b&&(d=a.substring(b-6,b-1),"href\x3d"==d.toLowerCase()&&(c=!1,b=b+a.toLowerCase().substring("/a",
b).length+1)),c&&(c=a.indexOf(" ",b),-1==c&&(c=a.length),d=a.substring(b,c),e='\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"'+d+'" target\x3d"_blank"\x3e'+d+"\x3c/a\x3e\x3c/span\x3e",a=a.substring(0,b)+e+a.substring(c,a.length),b=b+e.length-d.length+5)):b+=1,b=a.indexOf("http",b);return a},includeTimestampInRequest:function(a){if(10>=u("ie")||7>u("trident"))a.ts=(new Date).getTime();return a},fetchIDPConfig:function(){return J.request({url:J.getSecureUrl(H.restBaseUrl)+"portals/self/idp"})},
checkEnterpriseGroupStore:function(){var a=new f;J.request({url:J.getPortalAdminBaseUrl()+"/security/config"}).then(function(b){var c=!1,d;b&&b.groupStoreConfig&&b.groupStoreConfig.type&&(d=b.groupStoreConfig.type.toLowerCase(),"builtin"!==d&&"saml"!==d&&(c=!0));a.resolve({storeType:d,supportsEnterpriseGroups:c})},function(){a.resolve({supportsEnterpriseGroups:!1})});return a},enterpriseGroupMatches:function(a,b){return!(!y.isDefined(a)||!y.isDefined(b)||a.toLowerCase()!==b.toLowerCase())},isAmazonBasedTileService:function(a){return!J.isPortal()&&
/tiles[\s\S]*.arcgis.com\//ig.test(a)},createDialogWrapper:function(a,b){var c=(new A(a)).placeAt(document.body);c.setContent(b);l.once(c,"hide",function(){c.destroyRecursive()});return c},createSpecifiedDialog:function(a,b){var c=b?new a(b):new a,d=c._dialog||c.dialog;if(d)l.once(d,"hide",function(){d.destroyRecursive();c.destroyRecursive()});return c},hexToRgb:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},showAlert:function(a,b){new P({type:a,text:b},d.create("div",null,document.body))},showAlertList:function(a,b){b="\x3cul\x3e"+b.reduce(function(a,b){return a+="\x3cli\x3e"+b+"\x3c/li\x3e"},"")+"\x3c/ul\x3e";new P({type:a,text:"",listHTML:b},d.create("div",null,document.body))}}})},"dojo/hash":function(){define("./_base/kernel require ./_base/config ./aspect ./_base/lang ./topic ./domReady ./sniff".split(" "),function(b,h,k,a,c,d,
e,f){function g(a,b){b=a.indexOf(b);return 0<=b?a.substring(b+1):""}function l(){return g(location.href,"#")}function m(){d.publish("/dojo/hashchange",l())}function n(){l()!==p&&(p=l(),m())}function q(a){if(u)if(u.isTransitioning())setTimeout(c.hitch(null,q,a),v);else{var b=u.iframe.location.href,d=b.indexOf("?");u.iframe.location.replace(b.substring(0,d)+"?"+a)}else b=location.href.replace(/#.*/,""),location.replace(b+"#"+a),!w&&n()}function t(){function a(){p=l();f=u?p:g(q.href,"?");n=!1;w=null}
var d=document.createElement("iframe"),e=k.dojoBlankHtmlUrl||h.toUrl("./resources/blank.html");d.id="dojo-hash-iframe";d.src=e+"?"+l();d.style.display="none";document.body.appendChild(d);this.iframe=b.global["dojo-hash-iframe"];var f,n,w,t,u,q=this.iframe.location;this.isTransitioning=function(){return n};this.pollLocation=function(){if(!u)try{var b=g(q.href,"?");document.title!=t&&(t=this.iframe.document.title=document.title)}catch(N){u=!0}var k=l();if(n&&p===k)if(u||b===w)a(),m();else{setTimeout(c.hitch(this,
this.pollLocation),0);return}else if(p!==k||!u&&f!==b){if(p!==k){p=k;n=!0;w=k;d.src=e+"?"+w;u=!1;setTimeout(c.hitch(this,this.pollLocation),0);return}u||(location.href="#"+q.search.substring(1),a(),m())}setTimeout(c.hitch(this,this.pollLocation),v)};a();setTimeout(c.hitch(this,this.pollLocation),v)}b.hash=function(a,b){if(!arguments.length)return l();"#"==a.charAt(0)&&(a=a.substring(1));b?q(a):location.hash="#"+a;return a};var p,u,w,v=k.hashPollFrequency||100;e(function(){"onhashchange"in b.global&&
(!f("ie")||8<=f("ie")&&"BackCompat"!=document.compatMode)?w=a.after(b.global,"onhashchange",m,!0):document.addEventListener?(p=l(),setInterval(n,v)):document.attachEvent&&(u=new t)});return b.hash})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v,B,A,z,y,E,D,x,K,J,H,Q,N,V){function P(){}var L=new c;L.resolve(!0);y=a("dijit._DialogBase"+(u("dojo-bidi")?"_NoBidi":""),[D,K,J,x],{templateString:V,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:y.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=m.getLocalization("dijit","common");q.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);k.after(this,"onExecute",q.hitch(this,"hide"),!0);k.after(this,"onCancel",q.hitch(this,"hide"),!0);t(this.closeButtonNode,
w.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&I.isTop(this)&&(this._getFocusItems(),z.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();z.focus(this._firstFocusItem)},_endDrag:function(){var a=f.position(this.domNode),b=v.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==u("ie")?A:B)(a,{handle:this.titleBar}),k.after(this._moveable,"onMoveStop",q.hitch(this,"_endDrag"),!0)):e.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":h.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:q.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!e.contains(this.ownerDocumentBody,"dojoMove")){var a=
this.domNode,b=v.getBox(this.ownerDocument),c=this._relativePosition,d=f.position(a);g.set(a,{left:Math.floor(b.l+(c?Math.min(c.x,b.w-d.w):(b.w-d.w)/2))+"px",top:Math.floor(b.t+(c?Math.min(c.y,b.h-d.h):(b.h-d.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==n.TAB){this._getFocusItems();var b=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(z.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||
a.shiftKey||(z.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==n.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return L.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),I.hide(this));var a=v.get(this.ownerDocument);this._modalconnects.push(t(a,"scroll",q.hitch(this,"resize",null)));this._modalconnects.push(t(this.domNode,
"keydown",q.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new c(q.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,P);a=this._fadeInDeferred.promise;b=l.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:q.hitch(this,function(){I.show(this,this.underlayAttrs)}),onEnd:q.hitch(this,function(){this.autofocus&&I.isTop(this)&&(this._getFocusItems(),
z.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return L.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new c(q.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,P);this._fadeOutDeferred.then(q.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=l.fadeOut({node:this.domNode,duration:this.duration,
onEnd:q.hitch(this,function(){this.domNode.style.display="none";I.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),h.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=v.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=f.position(this.domNode);c.w>=b.w||c.h>=b.h?(a={w:Math.min(c.w,b.w),h:Math.min(c.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(a){f.setMarginBox(this.domNode,
a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var d=N.marginBox2contentBox(this.domNode,a);N.layoutChildren(this.domNode,d,b);this._singleChild?(b=N.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();u("touch")||a||this._position()}},
_layoutChildren:function(){h.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();I.hide(this);this.inherited(arguments)}});u("dojo-bidi")&&(y=a("dijit._DialogBase",y,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var F=a("dijit.Dialog",[Q,y],{});F._DialogBase=y;var I=F._DialogLevelManager={_beginZIndex:950,show:function(a,b){M[M.length-1].focus=z.curNode;var c=M[M.length-1].dialog?M[M.length-1].zIndex+2:F._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",c);H.show(b,c-1);M.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(M[M.length-1].dialog==a){M.pop();var b=M[M.length-
1];1==M.length?H.hide():H.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&d.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(O){}}else b=h.indexOf(h.map(M,function(a){return a.dialog}),a),-1!=b&&M.splice(b,1)},isTop:function(a){return M[M.length-1].dialog==a}},M=F._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];z.watch("curNode",function(a,b,c){a=M[M.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==
a.ownerDocument){do if(c==a.domNode||e.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});u("dijit-legacy-requires")&&p(0,function(){b(["dijit/TooltipDialog"])});return F})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(b,h){var k=h.prototype.onMove;return b("dojo.dnd.TimedMoveable",h,{timeout:40,constructor:function(a,b){b||(b={});b.timeout&&"number"==typeof b.timeout&&0<=b.timeout&&(this.timeout=b.timeout)},onMoveStop:function(a){a._timer&&
(clearTimeout(a._timer),k.call(this,a,a._leftTop));h.prototype.onMoveStop.apply(this,arguments)},onMove:function(a,b){a._leftTop=b;if(!a._timer){var c=this;a._timer=setTimeout(function(){a._timer=null;k.call(c,a,a._leftTop)},this.timeout)}}})})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),function(b,h,k,a,c,d){return h("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var c=
[];b.forEach(a||this.getChildren(),function(a){"value"in a?c.push(a):c=c.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return c},reset:function(){b.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return b.every(b.map(this._getDescendantFormWidgets(),function(b){b._hasBeenBlurred=!0;var c=b.disabled||!b.validate||b.validate();c||a||(d.scrollIntoView(b.containerNode||b.domNode),b.focus(),a=!0);return c}),function(a){return a})},
setValues:function(a){k.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",a)},_setValueAttr:function(c){var d={};b.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(d[a.name]||(d[a.name]=[])).push(a)});for(var e in d)if(d.hasOwnProperty(e)){var l=d[e],m=a.getObject(e,!1,c);void 0!==m&&(m=[].concat(m),"boolean"==typeof l[0].checked?b.forEach(l,function(a){a.set("value",-1!=b.indexOf(m,a._get("value")))}):l[0].multiple?
l[0].set("value",m):b.forEach(l,function(a,b){a.set("value",m[b])}))}},getValues:function(){k.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var c={};b.forEach(this._getDescendantFormWidgets(),function(b){var d=b.name;if(d&&!b.disabled){var e=b.get("value");"boolean"==typeof b.checked?/Radio/.test(b.declaredClass)?!1!==e?a.setObject(d,e,c):(e=a.getObject(d,!1,c),void 0===e&&a.setObject(d,null,c)):
(b=a.getObject(d,!1,c),b||(b=[],a.setObject(d,b,c)),!1!==e&&b.push(e)):(b=a.getObject(d,!1,c),"undefined"!=typeof b?a.isArray(b)?b.push(e):a.setObject(d,[b,e],c):a.setObject(d,e,c))}});return c},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=b.map(this._descendants,function(a){return a.get("state")||""});return 0<=b.indexOf(a,"Error")?"Error":0<=b.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=
this._getDescendantFormWidgets();b.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){a&&"state"!=a&&"disabled"!=a||this._set("state",this._getState());a&&"value"!=a&&"disabled"!=a&&"checked"!=a||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=
this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(c(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(b){b.target!=a.domNode&&a._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,c){this.onValidStateChange(""==c)})},destroy:function(){this.inherited(arguments)}})})},"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(b,
h){return b("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var b=h._getTabNavigable(this.domNode);this._firstFocusItem=b.lowest||b.first||this.closeButtonNode||this.domNode;this._lastFocusItem=b.last||b.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n){var q=b("dijit.DialogUnderlay",[f,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(b){a.set(this.node,"id",b+"_underlay");this._set("dialogId",b)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(d(this.domNode,"keydown",h.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=e.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new l(this.domNode);var a=e.get(this.ownerDocument);this._modalConnects=[m.on("resize",h.hitch(this,"layout")),d(a,"scroll",
h.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});q.show=function(a,b){var d=q._singleton;!d||d._destroyed?d=n._underlay=q._singleton=new q(a):a&&d.set(a);c.set(d.domNode,"zIndex",b);d.open||d.show()};q.hide=function(){var a=
q._singleton;a&&!a._destroyed&&a.hide()};return q})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){return g("dijit.layout.ContentPane",[k,a,c],{href:"",content:"",extractContent:!1,parseOnLoad:!0,
parserScope:b._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,
b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(a,b){if(!(a&&a.template||!b||"href"in a||"content"in a)){b=m.byId(b);for(var c=b.ownerDocument.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);a=h.delegate(a,{content:c})}this.inherited(arguments,[a,b])},postMixInProperties:function(){this.inherited(arguments);var a=p.getLocalization("dijit",
"loading",this.lang);this.loadingMessage=d.substitute(this.loadingMessage,a);this.errorMessage=d.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&f.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!h.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){f.forEach(this.getChildren(),
function(a){a._started||a._destroyed||!h.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&f.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!h.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){b.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new l(h.hitch(this,"cancel"));this.onLoadDeferred.then(h.hitch(this,
"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){b.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href","");this.cancel();this.onLoadDeferred=new l(h.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(h.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=
!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},
refresh:function(){this.cancel();this.onLoadDeferred=new l(h.hitch(this,"cancel"));this.onLoadDeferred.then(h.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};h.isObject(this.ioArgs)&&h.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||t.get)(b),d;c.then(function(b){d=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(y){a._onError("Content",
y)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return d});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(v){}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(w){}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;f.forEach(this.getChildren(),function(b){b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(f.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||q.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof e._ContentSetter||(c=this._contentSetter=new e._ContentSetter({node:this.containerNode,_onError:h.hitch(this,
this._onError),onContentError:h.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(E){}})}));var d=h.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),d=c.set(h.isObject(a)&&a.domNode?a.domNode:a,d),f=this;return u(d&&d.then?d:c.parseDeferred,function(){delete f._contentSetterParams;
b||(f._started&&(f._startChildren(),f._scheduleLayout()),f._onLoadHandler(a))})},preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c||a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(b,h,k,a,c,d,e,f,g,l){return h("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",d.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var a=[],b=!1;e("\x3e *",this.containerNode).some(function(c){var d=
f.byNode(c);d&&d.resize?a.push(d):!/script|link|style/i.test(c.nodeName)&&c.offsetHeight&&(b=!0)});this._singleChild=1!=a.length||b?null:a[0];k.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,b){this._resizeCalled=!0;this._scheduleLayout(a,b)},_scheduleLayout:function(a,b){this._isShown()?this._layout(a,b):(this._needLayout=!0,this._changeSize=a,this._resultSize=b)},_layout:function(b,c){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();
b&&a.setMarginBox(this.domNode,b);var e=this.containerNode;e===this.domNode?(c=c||{},d.mixin(c,b||{}),"h"in c&&"w"in c||(c=d.mixin(a.getMarginBox(e),c)),this._contentBox=l.marginBox2contentBox(e,c)):this._contentBox=a.getContentBox(e);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var b=this._contentBox||a.getContentBox(this.containerNode);this._singleChild.resize({w:b.w,h:b.h})}else for(var b=this.getChildren(),c,d=0;c=
b[d++];)c.resize&&c.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var a=this.domNode,b=this.domNode.parentNode;return"none"!=a.style.display&&"hidden"!=a.style.visibility&&!k.contains(a,"dijitHidden")&&b&&b.style&&"none"!=b.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(b,h,k,a,c,d,e){var f=0,g={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:d.empty,_setNodeContent:function(a,b){d.empty(a);if(b)if("number"==typeof b&&(b=b.toString()),"string"==typeof b&&(b=d.toDom(b,a.ownerDocument)),!b.nodeType&&h.isArrayLike(b))for(var c=b.length,e=0;e<b.length;e=c==b.length?e+1:0)d.place(b[e],a,"last");else d.place(b,a,"last");return a},_ContentSetter:a("dojo.html._ContentSetter",null,{node:"",
content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:b._scopeName,startup:!0,constructor:function(a,b){h.mixin(this,a||{});b=this.node=c.byId(this.node||b);this.id||(this.id=["Setter",b?b.id||b.tagName:"",f++].join("_"))},set:function(a,b){void 0!==a&&(this.content=a);"number"==typeof a&&(a=a.toString());b&&this._mixin(b);this.onBegin();this.setContent();return(a=this.onEnd())&&a.then?a:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+
": setContent given no node");try{a=g._setNodeContent(a,this.content)}catch(n){var b=this.onContentError(n);try{a.innerHTML=b}catch(q){}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(k.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);d.empty(this.node)},onBegin:function(){var a=this.content;if(h.isString(a)&&(this.cleanContent&&
(a=g._secureForInnerHtml(a)),this.extractContent)){var b=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(a=b[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+a},_mixin:function(a){var b=
{},c;for(c in a)c in b||(this[c]=a[c])},_parse:function(){var a=this.node;try{var b={};k.forEach(["dir","lang","textDir"],function(a){this[a]&&(b[a]=this[a])},this);var c=this;this.parseDeferred=e.parse({rootNode:a,noStart:!this.startup,inherited:b,scope:this.parserScope}).then(function(a){return c.parseResults=a},function(a){c._onError("Content",a,"Error parsing in _ContentSetter#"+c.id)})}catch(q){this._onError("Content",q,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(a,b,c){a=
this["on"+a+"Error"].call(this,b);c||a&&g._setNodeContent(this.node,a,!0)}}),set:function(a,b,c){void 0==b&&(b="");"number"==typeof b&&(b=b.toString());return c?(new g._ContentSetter(h.mixin(c,{content:b,node:a}))).set():g._setNodeContent(a,b,!0)}};h.setObject("dojo.html",g);return g})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p){b=k("dijit._editor.plugins._FontDropDown",[l,m,n],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:b,postMixInProperties:function(){this.inherited(arguments);this.strings=c.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=g.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new f({idProperty:"value",data:h.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>h.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var u=k("dijit._editor.plugins._FontNameDropDown",b,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_normalizeFontName:function(a){var b=this.values;if(!a||!b)return a;var c=a.split(",");if(1<c.length)for(var d=0,f=c.length;d<f;d++){var g=e.trim(c[d]);if(-1<h.indexOf(b,g))return g}return a},_setValueAttr:function(a,b){b=!1!==
b;a=this._normalizeFontName(a);this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,b])}}),w=k("dijit._editor.plugins._FontSizeDropDown",b,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,
b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),v=k("dijit._editor.plugins._FormatBlockDropDown",b,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||
"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var e;if((b=p.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var f;if(c){b=c.startContainer;for(e=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=b.parentNode;for(;e&&e!==a.editNode&&e!==a.document.body&&1!==e.nodeType;)e=e.parentNode;var g=d.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var d;for(d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];
if(1==e.nodeType&&a.selection.inSelection(e)){var f=e.tagName?e.tagName.toLowerCase():"";-1!==h.indexOf(this.values,f)&&c.push(e);g(e,c)}}}});c=d.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var m=[];if(b==e){var l;for(e=b;e&&e!==a.editNode&&e!==a.document.body;){if(1==e.nodeType&&(f=e.tagName?e.tagName.toLowerCase():"",-1!==h.indexOf(this.values,f))){l=e;break}e=e.parentNode}g(b,m);l&&(m=[l].concat(m))}else for(e=b;a.selection.inSelection(e);)1==
e.nodeType&&(f=e.tagName?e.tagName.toLowerCase():"",-1!==h.indexOf(this.values,f)&&m.push(e),g(e,m)),e=e.nextSibling;c(m);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(b,c){if(b.customUndo){for(;c.firstChild;)a.place(c.firstChild,c,"before");c.parentNode.removeChild(c)}else{b.selection.selectElementChildren(c);var d=b.selection.getSelectedHtml();b.selection.selectElement(c);b.execCommand("inserthtml",d||"")}}}),B=k("dijit._editor.plugins.FontChoice",t,{useDefaultCommand:!1,
_initButton:function(){var a={fontName:u,fontSize:w,formatBlock:v}[this.command],b=this.params;this.params.custom&&(b.values=this.params.custom);var c=this.editor;this.button=new a(d.delegate({dir:c.dir,lang:c.lang},b));this.own(this.button.select.on("change",d.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,
a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var e;try{e=a.queryCommandValue(b)||""}catch(x){e=""}(c=d.isString(e)&&(e.match(/'([^']*)'/)||e.match(/"([^"]*)"/)))&&(e=c[1]);"fontSize"!==b||e||(e=3);if("formatBlock"===b)if(e&&"p"!=e)0>h.indexOf(this.button.values,e)&&(e="noFormat");else{e=null;var f;(b=p.getSelection(this.editor.window))&&0<b.rangeCount&&(b=b.getRangeAt(0))&&(f=
b.endContainer);for(;f&&f!==a.editNode&&f!==a.document;){if((b=f.tagName?f.tagName.toLowerCase():"")&&-1<h.indexOf(this.button.values,b)){e=b;break}f=f.parentNode}e||(e="noFormat")}e!==this.button.get("value")&&this.button.set("value",e,!1)}}}});h.forEach(["fontName","fontSize","formatBlock"],function(a){t.registry[a]=function(b){return new B({command:a,plainText:b.plainText})}});B._FontDropDown=b;B._FontNameDropDown=u;B._FontSizeDropDown=w;B._FormatBlockDropDown=v;return B})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(b,h,k,a,c){return b("dijit.form.FilteringSelect",[a,c],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(a,b,c,g){b&&b[this.searchAttr]!==this._lastQuery||!b&&a.length&&this.store.getIdentity(a[0])!=this._lastQuery||
(a.length?this.set("item",a[0],g):this.set("value","",g||void 0===g&&!this.focused,this.textbox.value,null))},_openResultList:function(a,b,c){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(a,b,c,g){this._onChangeActive||(b=null);if(void 0===g){if(null===a||""===a)if(a="",!h.isString(c)){this._setDisplayedValueAttr(c||"",b);
return}var d=this;this._lastQuery=a;k(this.store.get(a),function(a){d._callbackSetLabel(a?[a]:[],void 0,void 0,b)})}else this.valueNode.value=a,this.inherited(arguments,[a,b,c,g])},_setItemAttr:function(a,b,c){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(a){return a.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(a,b){null==a&&(a="");if(!this._created){if(!("displayedValue"in this.params))return;b=!1}if(this.store){this.closeDropDown();
var c=h.clone(this.query),d=this._getDisplayQueryString(a),e;this.store._oldAPI?e=d:(e=this._patternToRegExp(d),e.toString=function(){return d});this._lastQuery=c[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=a;this._set("displayedValue",a);var m=this,n={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};h.mixin(n,this.fetchProperties);this._fetchHandle=this.store.query(c,n);k(this._fetchHandle,function(a){m._fetchHandle=null;m._callbackSetLabel(a||[],c,n,b)},function(a){m._fetchHandle=
null})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"esri/arcgis/Portal":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../kernel ../lang ../request ../urlUtils ../Evented ../IdentityManager".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n){var q={options:{disableIdentityLookup:!0},requestParams:{f:"json"}},t=function(b){function d(d){b[d]||(b[d]=function(){var e=arguments;return a.when(b,
function(a){Array.prototype.unshift.call(e,a.results||a);return t(c[d].apply(c,e))})})}if(!b)return b;b.then&&(b=h.delegate(b));b.total||(b.total=a.when(b,function(a){return g.isDefined(a.total)?a.total:a.length||0}));d("forEach");d("filter");d("map");d("some");d("every");return b},p={useSSL:function(a,b){var c=q&&q.self||{};if(c&&!c.isPortal)return-1!==a.indexOf("https:")||c.allSSL?b.replace("http:","https:"):b;var d=p.getLocation(b);return-1<c.portalHostname.toLowerCase().indexOf(d.hostname.toLowerCase())&&
d.port&&"80"!==d.port&&"443"!==d.port?(b=d.pathname,b=0===b.indexOf("/")?b:"/"+b,c.allSSL||-1<a.indexOf("https:")?"https://"+d.hostname+(c.httpsPort&&"443"!==c.httpsPort?":"+c.httpsPort:"")+b+d.search:"http://"+d.hostname+(c.httpPort&&"80"!==c.httpPort?":"+c.httpPort:"")+b+d.search):-1!==a.indexOf("https:")||c.allSSL?b.replace("http:","https:"):b},formatUrl:function(a){var b=q.currentToken;return-1!==a.indexOf("null")?null:p.useSSL(window.location.protocol,b?a+(-1!==a.indexOf("?")?"\x26":"?")+("token\x3d"+
b):a)},getLocation:function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,hash:b.hash,host:b.host}},resultsToTypedArray:function(a,b,d){d=d?d.listings||d.notifications||d.userInvitations||d.tags||d.items||d.groups||d.comments||d.provisions||d.results||d:[];return c.map(d,function(c){c=h.mixin(c,b||{});return a?new a(c):c})},clearFieldsFromObject:function(a,b){var c,d=a.length;if(h.isArray(a))for(c=0;c<d;c++)delete b[a[c]];
else for(c in a)delete b[c];return b},requestToTypedArray:function(a,b,c,d,e){return t(p.request(a,b,c).then(h.partial(p.resultsToTypedArray,d,e)))},request:function(a,b,c){var d;b&&b.portal&&delete b.portal;b&&b.form&&(d=b.form,delete b.form);b=h.mixin(h.mixin({},b||{}),q.requestParams);c=h.mixin(c||{},q.options);return l({url:p.useSSL(window.location.protocol,a.url||a),content:b,callbackParamName:"callback",timeout:c&&c.timeout||0,form:d},c)},formatQueryParams:function(a,b,c){a=h.mixin(h.mixin({},
a),h.isString(b)?{q:b}:b||{});a.q=!c&&q.extraQuery?"("+a.q+")"+q.extraQuery:a.q;return a}},u=b([],{declaredClass:"esri.arcgis.PortalComment",constructor:function(a){h.mixin(this,a);this.url=this.item.itemUrl+"/comments/"+this.id;this.created=this.created?new Date(this.created):null}}),w=b([],{declaredClass:"esri.arcgis.PortalRating",constructor:function(a){h.mixin(this,a);this.url=this.item.itemUrl+"/rating";this.created=this.created?new Date(this.created):null}}),v=b([],{declaredClass:"esri.arcgis.PortalItem",
constructor:function(a){h.mixin(this,a);this.folderId=this.ownerFolder||this.folderId;this.itemUrl=(this.portal&&this.portal.portalUrl)+"content/items/"+this.id;this.userItemUrl=this.hasOwnProperty("ownerFolder")?this.itemUrl.replace("/content/","/content/users/"+this.owner+(this.folderId?"/"+this.folderId:"")+"/"):null;this.itemDataUrl=p.formatUrl(this.itemUrl+"/data");this.thumbnailUrl=p.formatUrl(this.itemUrl+"/info/"+this.thumbnail);this.displayName=this._getDisplayName();this.iconUrl=this._getIconUrl();
this.isPremiumContent=this._getIsPremiumContent();this.created=this.created?new Date(this.created):null;this.uploaded=this.uploaded?new Date(this.uploaded):null;this.modified=this.modified?new Date(this.modified):null},getTypeInfo:function(){var a=this.type;return{source:-1<c.indexOf(this.typeKeywords||[],"ArcGIS Server")||"Feature Collection"===a?a:null,displayName:this.displayName,iconUrl:this.iconUrl,isPremiumContent:this.isPremiumContent,premiumIconUrl:this._getPremiumIconUrl()}},addComment:function(a){var b=
h.isString(a)?{comment:a}:a;return p.request(this.itemUrl+"/addComment",b,{usePost:!0}).then(h.hitch(this,function(a){return new u(h.mixin(b,{id:a.commentId,item:this}))}))},updateComment:function(a){if(a&&a.url&&a.comment)return p.request(a.url+"/update",{comment:a.comment},{usePost:!0}).then(function(b){a.id=b.commentId;return a});throw Error();},getComments:function(){return p.requestToTypedArray(this.itemUrl+"/comments",null,null,u,{item:this})},deleteComment:function(a){if(a&&a.url)return p.request(a.url+
"/delete",null,{usePost:!0});throw Error();},addRating:function(a){var b=h.isObject(a)?a:{rating:parseFloat(a)};return p.request(this.itemUrl+"/addRating",b,{usePost:!0}).then(h.hitch(this,function(a){return new w(h.mixin(b,{id:a.ratingId,item:this}))}))},getRating:function(){return p.request(this.itemUrl+"/rating").then(h.hitch(this,function(a){return new w(h.mixin(a,{item:this}))}))},deleteRating:function(){return p.request(this.itemUrl+"/deleteRating",null,{usePost:!0})},_getDisplayName:function(){var a=
this.type,b=this.typeKeywords||[],d=a;"Feature Service"===a||"Feature Collection"===a?d=-1<c.indexOf(b,"Table")?"Table":-1<c.indexOf(b,"Route Layer")?"Route Layer":-1<c.indexOf(b,"Markup")?"Markup":"Feature Layer":"Image Service"===a?d=-1<c.indexOf(b,"Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===a?d="Scene Layer":"Scene Package"===a?d="Scene Layer Package":"Stream Service"===a?d="Feature Layer":"Geoprocessing Service"===a&&this.portal&&this.portal.isPortal?d=-1<c.indexOf(b,
"Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===a?d="Locator":"Microsoft Powerpoint"===a?d="Microsoft PowerPoint":"GeoJson"===a?this.type=d="GeoJSON":"Globe Service"===a?d="Globe Layer":"Vector Tile Service"===a?d="Tile Layer":"netCDF"===a?d="NetCDF":"Map Service"===a?d=-1===c.indexOf(b,"Spatiotemporal")&&(-1<c.indexOf(b,"Hosted Service")||-1<c.indexOf(b,"Tiled"))?"Tile Layer":"Map Image Layer":a&&-1<a.toLowerCase().indexOf("add in")?d=a.replace(/(add in)/ig,"Add-In"):"datastore catalog service"===
a&&(d="Big Data File Share");return d},_getIconUrl:function(){var a=this.type&&this.type.toLowerCase()||"",b=this.typeKeywords||[],d=!1,f=!1,g=!1,m=!1,l=!1;0<a.indexOf("service")||"feature collection"===a||"kml"===a||"wms"===a||"wmts"===a||"wfs"===a?(d=-1<c.indexOf(b,"Hosted Service"),"feature service"===a||"feature collection"===a||"kml"===a||"wfs"===a?(m=-1<c.indexOf(b,"Table"),f=-1<c.indexOf(b,"Route Layer"),g=-1<c.indexOf(b,"Markup"),a=(l=-1!==c.indexOf(b,"Spatiotemporal"))&&m?"spatiotemporaltable":
m?"table":f?"routelayer":g?"markup":l?"spatiotemporal":d?"featureshosted":"features"):a="map service"===a||"wms"===a||"wmts"===a?d||-1<c.indexOf(b,"Tiled")||"wmts"===a?"maptiles":"mapimages":"scene service"===a?-1<c.indexOf(b,"Line")?"sceneweblayerline":-1<c.indexOf(b,"3DObject")?"sceneweblayermultipatch":-1<c.indexOf(b,"Point")?"sceneweblayerpoint":-1<c.indexOf(b,"IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf(b,"PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf(b,"Polygon")?"sceneweblayerpolygon":
"sceneweblayer":"image service"===a?-1<c.indexOf(b,"Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===a?"streamlayer":"vector tile service"===a?"vectortile":"datastore catalog service"===a?"datastorecollection":"geocoding service"===a?"geocodeservice":"geoprocessing service"===a?-1<c.indexOf(b,"Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers":"layers"):a="web map"===a||"cityengine web scene"===a?"maps":"web scene"===a?-1<c.indexOf(b,"ViewingMode-Local")?"webscenelocal":
"websceneglobal":"web mapping application"===a||"mobile application"===a||"application"===a||"operation view"===a||"desktop application"===a?"apps":"map document"===a||"map package"===a||"published map"===a||"scene document"===a||"globe document"===a||"basemap package"===a||"mobile basemap package"===a||"mobile map package"===a||"project package"===a||"project template"===a||"pro map"===a||"layout"===a||"layer"===a&&-1<c.indexOf(b,"ArcGIS Pro")||"explorer map"===a&&c.indexOf(b,"Explorer Document")?
"mapsgray":"service definition"===a||"csv"===a||"shapefile"===a||"cad drawing"===a||"geojson"===a||"360 vr experience"===a||"netcdf"===a?"datafiles":"explorer add in"===a||"desktop add in"===a||"windows viewer add in"===a||"windows viewer configuration"===a?"appsgray":"arcgis pro add in"===a||"arcgis pro configuration"===a?"addindesktop":"rule package"===a||"file geodatabase"===a||"sqlite geodatabase"===a||"csv collection"===a||"kml collection"===a||"windows mobile package"===a||"map template"===
a||"desktop application template"===a||"arcpad package"===a||"code sample"===a||"form"===a||"document link"===a||"operations dashboard add in"===a||"rules package"===a||"image"===a||"workflow manager package"===a||"explorer map"===a&&-1<c.indexOf(b,"Explorer Mapping Application")||-1<c.indexOf(b,"Document")?"datafilesgray":"network analysis service"===a||"geoprocessing service"===a||"geodata service"===a||"geometry service"===a||"geoprocessing package"===a||"locator package"===a||"geoprocessing sample"===
a||"workflow manager service"===a?"toolsgray":"layer"===a||"layer package"===a||"explorer layer"===a?"layersgray":"scene package"===a?"scenepackage":"mobile scene package"===a?"mobilescenepackage":"tile package"===a?"tilepackage":"task file"===a?"taskfile":"report template"===a?"report-template":"statistical data collection"===a?"statisticaldatacollection":"insights workbook"===a?"workbook":"insights model"===a?"insightsmodel":"insights page"===a?"insightspage":"insights theme"===a?"insightstheme":
"hub initiative"===a?"hubinitiative":"hub page"===a?"hubpage":"hub site application"===a?"hubsite":"relational database connection"===a?"relationaldatabaseconnection":"big data file share"===a?"datastorecollection":"image collection"===a?"imagecollection":"desktop style"===a?"desktopstyle":"style"===a?"style":"dashboard"===a?"dashboard":"raster function template"===a?"rasterprocessingtemplate":"vector tile package"===a?"vectortilepackage":"ortho mapping project"===a?"orthomappingproject":"ortho mapping template"===
a?"orthomappingtemplate":"solution"===a?"solutions":"maps";return a?e.toUrl("../css/images/item_type_icons/"+a+"16.png"):null},_getIsPremiumContent:function(){var a=this.typeKeywords,b=!1;if(-1<c.indexOf(a,"Requires Subscription")||-1<c.indexOf(a,"Requires Credits"))b=!0;return b},_getPremiumIconUrl:function(){var a=this.typeKeywords,b;this.isPremiumContent&&(b=-1<c.indexOf(a,"Requires Credits")?"premiumcredits":"premiumitem");return b?e.toUrl("../css/images/item_type_icons/"+b+"16.png"):null},getThumbnailUrl:function(a){var b=
this.thumbnailUrl;b&&a&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+a);return b}}),B=b([],{declaredClass:"esri.arcgis.PortalListing",constructor:function(a){h.mixin(this,a);this.id=this.itemId;this.url=(this.portal&&this.portal.portalUrl)+"content/"+(this.userItemUrl?"items/":"listings/")+this.itemId;this.commentsUrl=this.url+"/comments";this.created=this.created?new Date(this.created):null;this.banner=this.banner?p.formatUrl(this.url+"/info/"+this.banner):"";this.thumbnail=this.thumbnail?p.formatUrl(this.url+
"/info/"+this.thumbnail):"";this.largeThumbnail=this.largeThumbnail?p.formatUrl(this.url+"/info/"+this.largeThumbnail):"";this.avgRating=this.avgRating||0;this.numRatings=this.numRatings||0;this.numComments=this.numComments||0;this.listingProperties=this.listingProperties||{priceDesc:"",creditsPerTransaction:0,licenseType:"free",trialSupported:!1,trialDuration:0,listingAccess:"private"};for(var b in this.listingProperties)this[b]&&(this.listingProperties[b]=this[b]);this.properties=this.properties||
{systemRequirements:"",termsAndConditions:"",version:"1.0"};this.screenshots=c.map(this.screenshots,h.hitch(this,function(a){return p.formatUrl(this.url+"/info/"+a)}));this.vendorName=this.vendor.name;this.vendor.thumbnail=this.vendor.thumbnail?this.userItemUrl?p.formatUrl(this.portal.portalUrl+"/portals/self/resources/"+this.vendor.thumbnail):p.formatUrl(this.url+"/vendorinfo/"+this.vendor.thumbnail):""},getComments:function(){return p.requestToTypedArray(this.commentsUrl,null,null,u,{item:this})},
getVendor:function(){return this.vendor}}),A=b([],{declaredClass:"esri.arcgis.PortalProvision",constructor:function(a){h.mixin(this,a);this.created=this.created?new Date(this.created):null;this.startDate=this.startDate?new Date(this.startDate):null;this.endDate=this.endDate&&-1!==this.endDate?new Date(this.endDate):null;this.listing=a.listing?new B(h.mixin(a.listing,{portal:this.portal})):null}}),z=b([],{declaredClass:"esri.arcgis.PortalGroup",constructor:function(a){h.mixin(this,a);this.url=(this.portal&&
this.portal.portalUrl)+"community/groups/"+this.id;this.thumbnailUrl=p.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getMembers:function(){return p.request(this.url+"/users")},queryItems:function(a,b){a=p.formatQueryParams({},a,b);a.q="group:"+this.id+(a.q?" "+a.q:"");return this.portal.queryItems(a)},getThumbnailUrl:function(a){var b=this.thumbnailUrl;b&&a&&(b+=(-1===b.indexOf("?")?"?":"\x26")+
"w\x3d"+a);return b}}),y=b([],{declaredClass:"esri.arcgis.PortalFolder",constructor:function(a){h.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username+"/"+this.id;this.created=this.created?new Date(this.created):null},getItems:function(){return p.requestToTypedArray(this.url,null,null,v,{portal:this.portal,folderId:this.id})}}),E=b([],{declaredClass:"esri.arcgis.PortalUser",constructor:function(a){h.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+
"community/users/"+this.username;this.userContentUrl=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username;this.thumbnailUrl=this.thumbnail?p.formatUrl(this.url+"/info/"+this.thumbnail):null;this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getGroups:function(){return t(p.request(this.url).then(h.hitch(this,function(a){return p.resultsToTypedArray(z,{portal:this.portal},a.groups)})))},getNotifications:function(){return p.requestToTypedArray(this.url+
"/notifications",null,null,null,{portal:this.portal})},getGroupInvitations:function(){return p.requestToTypedArray(this.url+"/invitations",null,null,null,{portal:this.portal})},getTags:function(){return p.requestToTypedArray(this.url+"/tags",null,null,null,{portal:this.portal})},getFolders:function(){return t(this.getContent(null,{num:1}).then(function(a){return a.folders}))},getItems:function(a){return t(this.getContent(a).then(function(a){return a.items}))},getItem:function(a){return p.request(this.portal.portalUrl+
"content/items/"+a).then(h.hitch(this,function(a){return new v(h.mixin(a,{portal:this.portal}))}))},getContent:function(a,b){var c=this.url.replace("community","content")+(a?"/"+a:"");return p.request(c,b).then(h.hitch(this,function(b){b.folders=p.resultsToTypedArray(y,{portal:this.portal},b.folders);b.items=p.resultsToTypedArray(v,{portal:this.portal,folderId:a},b.items);return b}))},getThumbnailUrl:function(a){var b=this.thumbnailUrl;b&&a&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+a);return b}});
b={Portal:b([n],{declaredClass:"esri.arcgis.Portal",onLoad:function(){},onError:function(){},constructor:function(a){a=h.isObject(a)?a:{url:a};this.registerConnectEvents();q={options:{disableIdentityLookup:!0},requestParams:{f:"json"}};a.self?(q.self=a.self,h.mixin(this,{url:a.url||m.getProtocolForWebResource()+"//"+(a.self.urlKey?a.self.urlKey+"."+a.self.customBaseUrl:a.self.portalHostname)}),this.portalUrl=-1!==this.url.indexOf("/sharing")?this.url+"/":this.url+"/sharing/rest/",a=a.self.user?this.signIn():
this.init(this.url)):(a.url&&h.mixin(this,{url:a.url}),a=this.init(this.url));a.then(h.hitch(this,function(){this.emit("ready",this);this.onLoad(this)}))},init:function(a,b){a=(a||this.portalUrl).replace(/\/+$/,"");this.portalUrl=-1!==a.indexOf("/sharing")?a+"/":a+"/sharing/rest/";return this._getSelf(this.portalUrl).then(h.hitch(this,function(a){q.self=h.mixin({},a);(a=a.user)&&b&&(q.currentToken=b&&b.token,q.loggedInUser=new E(h.mixin(a,{portal:this,credential:b})));q.self.id&&!1===q.self.canSearchPublic&&
(q.extraQuery=" AND orgid:"+q.self.id);h.mixin(this,q.self);this.thumbnailUrl=p.formatUrl(this.portalUrl+"portals/self/resources/"+this.thumbnail);this.isOrganization=this.access&&this.access.length?!0:!1;this.created=this.created?new Date(this.created):null;this.modified=this.modified?new Date(this.modified):null;return this}),h.hitch(this,function(a){this.onError(a);throw a;}))},signIn:function(){var b=new a,c=h.hitch(this,function(){this._onSignIn().then(h.hitch(this,function(){b.resolve(q.loggedInUser)}),
h.hitch(this,function(a){b.reject(a)}))});if(q&&q.self)q&&q.loggedInUser?setTimeout(function(){b.resolve(q.loggedInUser)},0):c();else this.on("load",h.hitch(this,function(){c()}));return b},signOut:function(){q.loggedInUser.credential&&q.loggedInUser.credential.destroy();q.loggedInUser=null;q.options.disableIdentityLookup=!0;p.clearFieldsFromObject(q.self,this);q.self=null;return this.init(this.url)},getPortalUser:function(){return q.loggedInUser},addResource:function(a,b){return p.request(this.portalUrl+
"portals/self/addResource",{key:a,text:b},{usePost:!0})},update:function(a){return p.request(this.portalUrl+"portals/self/update",a,{usePost:!0})},queryGroups:function(a,b){return this._queryPortal(this.portalUrl+"community/groups",p.formatQueryParams({},a,b),z)},queryItems:function(a,b){return this._queryPortal(this.portalUrl+"search",p.formatQueryParams({},a,b),v)},queryListings:function(a){a=p.formatQueryParams({},a,!0);var b="";a.q&&-1<a.q.toLowerCase().indexOf("mylistings:true")?(a.q=a.q.toLowerCase().replace("mylistings:true",
""),b="?mylistings\x3dtrue"):a.q||(a.q='""');return this._queryPortal(this.portalUrl+"content/listings"+b,a,B)},queryCustomerList:function(a,b){a=p.formatQueryParams({},a,!0);return this._queryPortal(this.portalUrl+"portals/self/customersList",a)},getProvisions:function(){return this.getCustomers().then(h.hitch(this,function(a){return a.purchases}))},getInterests:function(){return this.getCustomers().then(h.hitch(this,function(a){return a.interests}))},getTrials:function(){return this.getCustomers().then(h.hitch(this,
function(a){return a.trials}))},getCustomers:function(a){return p.request(this.portalUrl+"portals/self/customers",{status:a||"all"})},getMyPurchases:function(){return this.getPurchases().then(function(a){return a.purchases})},getMyInterests:function(){return this.getPurchases().then(function(a){return a.interests})},getPurchases:function(){return p.request(this.portalUrl+"portals/self/purchases").then(h.hitch(this,function(a){a.interests=c.map(a.interests,function(a){return h.mixin(a.provision,{listing:a.listing})});
a.purchases=c.map(a.purchases,function(a){return h.mixin(a.provision,{listing:a.listing})});a.trials=c.map(a.trials,function(a){return h.mixin(a.provision,{listing:a.listing})});a.interests=p.resultsToTypedArray(A,{portal:this},a.interests);a.trials=p.resultsToTypedArray(A,{portal:this},a.trials);a.purchases=p.resultsToTypedArray(A,{portal:this},a.purchases);return a}))},queryUsers:function(a,b){return this._queryPortal(this.portalUrl+"community/users",p.formatQueryParams({sortField:"username"},a,
b),E)},_onSignIn:function(){q.options.disableIdentityLookup=!1;q.self=null;return f.id.getCredential(this.portalUrl).then(h.hitch(this,"init",this.url)).then(function(){return q.loggedInUser},h.hitch(this,function(a){q.options.disableIdentityLookup=!0;this.onError(a);throw a;}))},_getSelf:function(b){var c;b+="portals/self";q.self?(c=new a,setTimeout(function(){c.resolve(q.self)},0)):c=p.request(b,{culture:k.locale});return c},_queryPortal:function(b,c,d){var e=h.mixin({num:10,start:0,sortField:"title",
sortOrder:"asc"},c),f=["start","query","num","nextStart"];b=p.request(b,e).then(h.hitch(this,function(a){a.results=p.resultsToTypedArray(d,{portal:this},a);a.queryParams=h.mixin({},e);a.nextQueryParams=h.mixin(e,{start:a.nextStart});return p.clearFieldsFromObject(f,a)}));b=h.delegate(b);b.queryParams=h.mixin({},e);b.nextQueryParams=a.when(b,function(a){return a.nextQueryParams});return t(b)}}),PortalFolder:y,PortalGroup:z,PortalItem:v,PortalUser:E,PortalComment:u,PortalRating:w,PortalUtil:p,PortalResult:t,
PortalListing:B};h.mixin(h.getObject("arcgis",!0,f),b);return b})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(b,h,k,a,c,d){b=b([a],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a=this.constructor,b=this.constructor._meta.parents,c=[{}],d={},m,k,q=function(a,b){h.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=a[c];d._meta&&d._meta.parents&&q(d._meta.parents,b);d.prototype._eventMap&&
b.push(h.mixin({},d.prototype._eventMap))}return b};if(!a._onMap){q(b,c);c.push(this._eventMap);b=h.mixin.apply(this,c);for(m in this)/^on\w/.test(m)&&h.isFunction(this[m])&&(c=this._hyphenLower(m).toLowerCase(),b[c]||(d[c]={method:m}));for(k in b)m=this._onCamelCase(k),d[k]={method:m,argKeys:b[k]};a._onMap=d;return a._onMap}},on:function(a,b){if(-1<a.indexOf(",")){for(var c=a.split(/\s*,\s*/),d=c.length,e=[];d--;)e.push(this.on(c[d],b));e.remove=function(){for(var a=0;a<e.length;a++)e[a].remove()};
return e}var c=this.constructor._onMap||this.registerConnectEvents(),d="string"==typeof a&&a.toLowerCase(),f=this._onCamelCase(d),q=c&&c[d];return(f=q&&q.method||this[f]&&h.isFunction(this[f])&&f)?q&&h.isArray(q.argKeys)?(c=this._onArr2Obj(b,c[d].argKeys),k.after(this,f,c,!0)):k.after(this,f,function(a){a=a||{};a.target||(a.target=this);b.call(this,a)},!0):this.inherited(arguments)},emit:function(a,b){var c,d,e,f,k=a.toLowerCase();f=this._onCamelCase(a);var t=this.constructor._onMap||this.registerConnectEvents();
f=(e=t&&t[k]&&t[k].method||h.isFunction(this[f])&&f)&&this[e];e&&t&&t[k]&&this._onObj2Arr(function(){d=Array.prototype.slice.call(arguments)},t[k].argKeys)(b);b=b||{};b.target||(b.target=this);f&&(c=d&&d.length?d:[b],c=f.apply(this,c));this.inherited(arguments,[a,b]);return c},_onObj2Arr:function(a,b){if(b){var c=this;return function(d){var e,f=[],g=b.length;for(e=0;e<g;e++)f[e]=d[b[e]];a.apply(c,f)}}return a},_onArr2Obj:function(a,b){if(b){var c=this;return function(){var d,e={},f=arguments.length;
for(d=0;d<f;d++)e[b[d]]=arguments[d];e.target||(e.target=c);a.call(c,e)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})},_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+a.substr(1).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}});return d.Evented=b})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(b,
h,k,a){b=new b;h.id=a.safeMixin(b,k);return h.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){h=h([p],{declaredClass:"esri.IdentityManager",
_eventMap:{"dialog-cancel":["info"]},constructor:function(a){c.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(b,c,d){this._nls||(this._nls=u.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var f=this._loginDialog,g=d&&d.error,m=d&&d.token,l=new a(function(){f.onCancel()});if(f.open)return b=Error("BUSY"),b.code="IdentityManager.1",b.log=!!k.isDebug,l.errback(b),l;q.hide(f.errMsg_);g&&403==g.code&&m&&(e.set(f.errMsg_,"innerHTML",this._nls.forbidden),q.show(f.errMsg_));f.dfd_=
l;f.serverInfo_=c;f.resUrl_=b;f.admin_=d&&d.isAdmin;e.set(f.resLink_,{title:b,innerHTML:"("+(this.getResourceName(b)||this._nls.lblItem)+")"});e.set(f.serverLink_,{title:c.server,innerHTML:(-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server)+" "});f.txtPwd_.set("value","");f.show();return l},_createLoginDialog:function(){var a=this._nls,c=n.substitute(a,this._dialogContent),c=n.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},c),d=new l({title:a.title,content:c,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===f.ENTER&&this.execute_()},execute_:function(){var b=this.txtUser_.get("value"),c=this.txtPwd_.get("value"),d=this.dfd_,f=this;if(this.form_.validate()&&b&&c){this.btnSubmit_.set("label",a.lblSigning);var g=m.id.findCredential(f.resUrl_,b),k=function(c){f.btnSubmit_.set("label",
a.lblOk);f.btnSubmit_.set("disabled",!1);q.hide(f.errMsg_);f.hide();l._DialogLevelManager.hide(f);var e=f.serverInfo_;f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;var m,k,h=g,p;c&&(m=c.token,k=n.isDefined(c.expires)?Number(c.expires):null,p=!!c.ssl,h?(h.userId=b,h.token=m,h.expires=k,h.validity=c.validity,h.ssl=p,h.creationTime=(new Date).getTime()):h=new t({userId:b,server:e.server,token:m,expires:k,ssl:p,isAdmin:f.admin_,validity:c.validity}));d.callback(h)};g&&!g._enqueued?k():(f.btnSubmit_.set("disabled",
!0),f.generateDfd_=m.id.generateToken(this.serverInfo_,{username:b,password:c},{isAdmin:this.admin_}).addCallback(k).addErrback(function(b){f.btnSubmit_.set("disabled",!1);f.generateDfd_=null;f.btnSubmit_.set("label",a.lblOk);e.set(f.errMsg_,"innerHTML",b&&b.code?a.invalidUser:a.noAuthService);q.show(f.errMsg_)}))}},cancel_:function(){d.generateDfd_&&d.generateDfd_.cancel();var a=d.dfd_,b=d.resUrl_,c=d.serverInfo_;d.btnSubmit_.set("disabled",!1);d.dfd_=d.serverInfo_=d.generateDfd_=d.resUrl_=null;
q.hide(d.errMsg_);l._DialogLevelManager.hide(d);d.esriIdMgr_.onDialogCancel({resourceUrl:b,serverInfo:c});b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!k.isDebug;a.errback(b)}}),c=d.domNode;d.form_=g.byNode(b.query(".esriIdForm",c)[0]);d.txtUser_=g.byNode(b.query(".esriIdUser",c)[0]);d.txtPwd_=g.byNode(b.query(".esriIdPwd",c)[0]);d.btnSubmit_=g.byNode(b.query(".esriIdSubmit",c)[0]);d.btnCancel_=g.byNode(b.query(".esriIdCancel",c)[0]);d.resLink_=b.query(".resLink",c)[0];d.serverLink_=b.query(".serverLink",
c)[0];d.errMsg_=b.query(".esriErrorMsg",c)[0];d.connect(d.txtUser_,"onKeyPress",d.keypressed_);d.connect(d.txtPwd_,"onKeyPress",d.keypressed_);d.connect(d.btnSubmit_,"onClick",d.execute_);d.connect(d.btnCancel_,"onClick",d.onCancel);d.connect(d,"onCancel",d.cancel_);return d}});return m.IdentityManagerDialog=m.IdentityManager=h})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(b,h,k,a){b=b(a.Credential,{});return k.Credential=b})},
"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/on dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v,B,A,z,y){var E={},D=function(a){var b=(new e(a.owningSystemUrl)).host;a=(new e(a.server)).host;var c=
/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},x=function(b,c){return!!(D(b)&&c&&a.some(c,function(a){return a.test(b.server)}))},K,J=b(A,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=k.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthHash();m(window,"pageshow",k.hitch(this,this._pageShowHandler))},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,
signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_rejectOnPersistedPageShow:!1,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(b){var c=this.serverInfos;c?(b=a.filter(b,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=c.concat(b)):
this.serverInfos=b;a.forEach(b,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=t.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);w.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));w.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(b){var c=this.oAuthInfos;c?(b=a.filter(b,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=c.concat(b)):
this.oAuthInfos=b},registerToken:function(a){var b=this._sanitizeUrl(a.server),c=this.findServerInfo(b),d=!0,e;c||(c=new u,c.server=this._getServerInstanceRoot(b),c.tokenServiceUrl=this._getTokenSvcUrl(b),c.hasPortal=!0,this.registerServers([c]));(e=this.findCredential(b,a.userId))?(k.mixin(e,a),d=!1):(e=new K({userId:a.userId,server:c.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),e.resources=[b],this.credentials.push(e));e.onTokenChange(!1);d||e.refreshServerTokens()},
toJson:function(){return p.fixJson({serverInfos:a.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:a.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:a.map(this.credentials,function(a){return a.toJson()})})},initialize:function(b){if(b){k.isString(b)&&(b=d.fromJson(b));var c=b.serverInfos,e=b.oAuthInfos;b=b.credentials;if(c){var f=[];a.forEach(c,function(a){a.server&&a.tokenServiceUrl&&f.push(a.declaredClass?a:new u(a))});f.length&&this.registerServers(f)}if(e){var g=
[];a.forEach(e,function(a){a.appId&&g.push(a.declaredClass?a:new y(a))});g.length&&this.registerOAuthInfos(g)}b&&a.forEach(b,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new K(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(b){var c;b=this._sanitizeUrl(b);a.some(this.serverInfos,function(a){this._hasSameServerInstance(a.server,b)&&(c=a);return!!c},this);return c},findOAuthInfo:function(b){var c;b=this._sanitizeUrl(b);
a.some(this.oAuthInfos,function(a){this._hasSameServerInstance(a.portalUrl,b)&&(c=a);return!!c},this);return c},findCredential:function(b,c){var d,e;b=this._sanitizeUrl(b);e=this._isServerRsrc(b)?"server":"portal";c?a.some(this.credentials,function(a){this._hasSameServerInstance(a.server,b)&&c===a.userId&&a.scope===e&&(d=a);return!!d},this):a.some(this.credentials,function(a){this._hasSameServerInstance(a.server,b)&&-1!==this._getIdenticalSvcIdx(b,a)&&a.scope===e&&(d=a);return!!d},this);return d},
getCredential:function(a,b){var d,e,f=!0;p.isDefined(b)&&(k.isObject(b)?(d=!!b.token,e=b.error,f=!1!==b.prompt):d=b);a=this._sanitizeUrl(a);var m=new c(v._dfdCanceller),l=this._isAdminResource(a),n=d&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;if((d=d?this.findCredential(a):null)&&e&&498===e.code)d.destroy(),n&&n.token===b.token&&g("esri_auth",null,{expires:-1,path:"/",domain:document.domain});else if(n||d)return a=Error("You are currently signed in as: '"+(n&&n.email||d&&d.userId)+"'. You do not have access to this resource: "+
a),a.code="IdentityManagerBase.1",a.httpCode=e&&e.httpCode,a.messageCode=e?e.messageCode:null,a.subcode=e?e.subcode:null,a.details=e?e.details:null,a.log=!!h.isDebug,m.errback(a),m;if(e=this._findCredential(a,b))return m.callback(e),m;e=this.findServerInfo(a);if(e)!e.hasServer&&this._isServerRsrc(a)&&(e._restInfoDfd=this._getTokenSvcUrl(a,!0),e.hasServer=!0);else{n=this._getTokenSvcUrl(a);if(!n)return a=Error("Unknown resource - could not find token service endpoint."),a.code="IdentityManagerBase.2",
a.log=!!h.isDebug,m.errback(a),m;e=new u;e.server=this._getServerInstanceRoot(a);k.isString(n)?(e.tokenServiceUrl=n,e.hasPortal=!0):(e._restInfoDfd=n,e.hasServer=!0);this.registerServers([e])}f&&e.hasPortal&&void 0===e._selfReq&&!this._findOAuthInfo(a)&&(e._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(e.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,e,b,m,l)},getResourceName:function(a){return this._isRESTService(a)?
a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(a,b,c){var d,f,g,m,l,n,p=this._rePortalTokenSvc.test(a.tokenServiceUrl),v=new e(window.location.href.toLowerCase()),u=this._getEsriAuthCookie(),t,H=!b;m=a.shortLivedTokenValidity;var A;b&&(A=q.id.tokenValidity||m||q.id.defaultTokenValidity,A>m&&
(A=m));c&&(d=c.isAdmin,f=c.serverUrl,g=c.token,n=c.ssl,a.customParameters=c.customParameters);d?m=a.adminTokenServiceUrl:(m=a.tokenServiceUrl,l=new e(m.toLowerCase()),u&&(t=(t=u.auth_tier)&&t.toLowerCase()),("web"===t||a.webTierAuth)&&c&&c.serverUrl&&!n&&"http"===v.scheme&&(w.hasSameOrigin(v.uri,m,!0)||"https"===l.scheme&&v.host===l.host&&"7080"===v.port&&"7443"===l.port)&&(m=m.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),H&&p&&(m=m.replace(/\/rest/i,"")));d=k.mixin({url:m,content:k.mixin({request:"getToken",
username:b&&b.username,password:b&&b.password,serverUrl:f,token:g,expiration:A,referer:d||p?window.location.host:null,client:d?"referer":null,f:"json"},a.customParameters),handleAs:"json",callbackParamName:H?"callback":void 0},c&&c.ioArgs);c={usePost:!H,disableIdentityLookup:!0,useProxy:this._useProxy(a,c)};p||(d.withCredentials=!1);p=B(d,c);p.addCallback(function(c){if(!c||!c.token)return c=Error("Unable to generate token"),c.code="IdentityManagerBase.3",c.log=!!h.isDebug,c;var d=a.server;E[d]||
(E[d]={});b&&(E[d][b.username]=b.password);c.validity=A;return c});p.addErrback(function(a){});return p},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){var b=new c;this.getCredential(a,{prompt:!1}).then(function(a){return a.token?B({url:a.server+("portal"===a.scope?"/sharing/rest":"/rest/services"),content:{f:"json",token:a.token},callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(){return a}).otherwise(function(b){if(498===b.code)throw a.destroy(),b=Error("User is not signed in."),
b.code="IdentityManagerBase.6",b.log=!!h.isDebug,b;return a}):a}).then(function(a){b.resolve(a)}).otherwise(function(a){b.reject(a)});return b},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var b=this.credentials.slice();a.forEach(b,function(a){a.destroy()})}this.onCredentialsDestroy()},
_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=l.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=d.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&"access_denied"===a.error&&(b=!0);b&&(!f("ie")||8<f("ie"))&&(window.location.hash="")}},_pageShowHandler:function(a){a.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow&&(a=Error("ABORTED"),a.code="IdentityManager.2",
a.log=!!h.isDebug,this._errbackFunc(a))},_findCredential:function(b,c){var d=-1,e,f,g,m=c&&c.token;c=c&&c.resource;var l=this._isServerRsrc(b)?"server":"portal",k=a.filter(this.credentials,function(a){return this._hasSameServerInstance(a.server,b)&&a.scope===l},this);b=c||b;if(k.length)if(1===k.length)if(c=k[0],f=(e=(g=this.findServerInfo(c.server))&&g.owningSystemUrl)&&this.findCredential(e,c.userId),d=this._getIdenticalSvcIdx(b,c),m)-1!==d&&(c.resources.splice(d,1),this._removeResource(b,f));else return-1===
d&&c.resources.push(b),this._addResource(b,f),c;else{var h,n;a.some(k,function(a){n=this._getIdenticalSvcIdx(b,a);return-1!==n?(h=a,f=(e=(g=this.findServerInfo(h.server))&&g.owningSystemUrl)&&this.findCredential(e,h.userId),d=n,!0):!1},this);if(m)h&&(h.resources.splice(d,1),this._removeResource(b,f));else if(h)return this._addResource(b,f),h}},_findOAuthInfo:function(b){var c=this.findOAuthInfo(b);c||a.some(this.oAuthInfos,function(a){this._isIdProvider(a.portalUrl,b)&&(c=a);return!!c},this);return c},
_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!w.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!w.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new e(a);return a.scheme+"://"+a.host+(p.isDefined(a.port)?
":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=this._normalizeAGOLorgDomain(a);b=this._normalizeAGOLorgDomain(b);a=a.substr(a.indexOf(":"));
b=b.substr(b.indexOf(":"));return a===b},_normalizeAGOLorgDomain:function(a){var b=/^https?:\/\/.+\.maps\.arcgis\.com/i,c=/^https?:\/\/.+\.mapsdevext\.arcgis\.com/i,d=/^https?:\/\/.+\.mapsqa\.arcgis\.com/i;b.test(a)?a=a.replace(b,"https://www.arcgis.com"):c.test(a)?a=a.replace(c,"https://devext.arcgis.com"):d.test(a)&&(a=a.replace(d,"https://qaext.arcgis.com"));return a},_sanitizeUrl:function(a){var b=(t.defaults.io.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+
b.length+1));a=w.normalize(a);return w.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),c=a===b,c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=
a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},_isPortalDomain:function(b){b=b.toLowerCase();var c=(new e(b)).authority,d=this._portalConfig,f=-1!==c.indexOf(this._agolSuffix);!f&&d&&(f=this._hasSameServerInstance(this._getServerInstanceRoot(d.restBaseUrl),b));f||(!this._arcgisUrl&&(d=k.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new e(d)).authority),
this._arcgisUrl&&(f=this._arcgisUrl.toLowerCase()===c));f||(f=a.some(this._portals,function(a){return this._hasSameServerInstance(a,b)},this));return f=f||this._agsPortal.test(b)},_isIdProvider:function(b,c){var d=-1,e=-1;a.forEach(this._gwDomains,function(a,f){-1===d&&a.regex.test(b)&&(d=f);-1===e&&a.regex.test(c)&&(e=f)});var f=!1;if(-1<d&&-1<e)if(0===d||4===d){if(0===e||4===e)f=!0}else if(1===d){if(1===e||2===e)f=!0}else 2===d?2===e&&(f=!0):3===d&&3===e&&(f=!0);if(!f){var g=this.findServerInfo(c),
m=g&&g.owningSystemUrl;m&&D(g)&&this._isPortalDomain(m)&&this._isIdProvider(b,m)&&(f=!0)}return f},_isPublic:function(b){b=this._sanitizeUrl(b);return a.some(this._publicUrls,function(a){return a.test(b)})},_getIdenticalSvcIdx:function(b,c){var d=-1;a.some(c.resources,function(a,c){return this._isIdenticalService(b,a)?(d=c,!0):!1},this);return d},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(b){var c,d;if((c=this._isRESTService(b))||
this._isAdminResource(b))return d=b.toLowerCase().indexOf(c?this._agsRest:"/admin/"),c=b.substring(0,d)+"/admin/generateToken",b=b.substring(0,d)+"/rest/info",d=B({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),d.adminUrl_=c,d;if(this._isPortalDomain(b)){var f="";a.some(this._gwDomains,function(a){a.regex.test(b)&&(f=a.tokenServiceUrl);return!!f});f||a.some(this._portals,function(a){this._hasSameServerInstance(a,b)&&(f=a+this._gwTokenUrl);return!!f},this);f||(d=b.toLowerCase().indexOf("/sharing"),
-1!==d&&(f=b.substring(0,d)+this._gwTokenUrl));f||(f=this._getOrigin(b)+this._gwTokenUrl);f&&(c=(new e(b)).port,/^http:\/\//i.test(b)&&"7080"===c&&(f=f.replace(/:7080/i,":7443")),f=f.replace(/http:/i,"https:"));return f}if(-1!==b.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,
"http:").replace(/:7443/i,":7080"));return B({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a=null;if(g.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var e=d.fromJson(b[c]);if(e.portalApp){a=e;break}}}a&&(b=null,a.expires&&("number"===typeof a.expires?b=a.expires:"string"===typeof a.expires&&(b=Date.parse(a.expires)),
isNaN(b)&&(b=null),a.expires=b),b&&b<(new Date).getTime()&&(a=null));return a},_getAllCookies:function(a){var b=[],c=document.cookie.match(new RegExp("(?:^|; )"+n.escapeString(a)+"\x3d([^;]*)","g"));if(c)for(a=0;a<c.length;a++){var d=c[a],e=d.indexOf("\x3d");-1<e&&(d=d.substring(e+1),b.push(decodeURIComponent(d)))}return b},_doPortalSignIn:function(a){if(g.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,d=window.location.href,e=this.findServerInfo(a);if(this.useSignInPage&&(c||
this._isPortalDomain(d)||b)&&(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||this._isIdProvider(c.restBaseUrl,a))||w.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(a,b,c,d){var e=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==k.trim(d).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||
t.defaults.io.useCors&&(w.canUseXhr(d)||w.canUseXhr(w.getProxyUrl(!0).path))||(e=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,e||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),a.code="IdentityManagerBase.4",a.log=!!h.isDebug,c(a)));return e},_enqueue:function(a,b,d,e,f,g){e||(e=new c(v._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=d;e.admin_=f;e.refresh_=g;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),
this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(b){this._busy=b;this._rejectOnPersistedPageShow=!1;var c=this,d=function(d){var e=b.options_&&b.options_.resource,f=b.resUrl_,g=b.refresh_,m=!1;-1===a.indexOf(c.credentials,d)&&(g&&-1!==a.indexOf(c.credentials,g)?(g.userId=d.userId,g.token=d.token,g.expires=d.expires,g.validity=d.validity,g.ssl=d.ssl,g.creationTime=
d.creationTime,m=!0,d=g):c.credentials.push(d));d.resources||(d.resources=[]);d.resources.push(e||f);d.scope=c._isServerRsrc(f)?"server":"portal";d.onTokenChange();var e=c._soReqs,l={};c._soReqs=[];a.forEach(e,function(a){if(!this._isIdenticalService(f,a.resUrl_)){var b=this._getSuffix(a.resUrl_);l[b]||(l[b]=!0,d.resources.push(a.resUrl_))}},c);b.callback(d);a.forEach(e,function(a){this._hasSameServerInstance(this._getServerInstanceRoot(f),a.resUrl_)?a.callback(d):this._soReqs.push(a)},c);c._busy=
b.resUrl_=b.sinfo_=b.refresh_=null;if(!m)c.onCredentialCreate({credential:d});c._soReqs.length?c._doSignIn(c._soReqs.shift()):c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},e=function(a){b.errback(a);c._busy=b.resUrl_=b.sinfo_=b.refresh_=null;c._soReqs.length?c._doSignIn(c._soReqs.shift()):c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},f=function(a,f,g,m){var l=b.sinfo_,k=!b.options_||!1!==b.options_.prompt,n=l.hasPortal&&c._findOAuthInfo(b.resUrl_);c._doPortalSignIn(b.resUrl_)?(a=c._getEsriAuthCookie(),
n=c._portalConfig,a?d(new K({userId:a.email,server:l.server,token:a.token,expires:a.expires})):k?(k="",a=window.location.href,k=c.signInPage?c.signInPage:n?n.baseUrl+n.signin:c._isIdProvider(a,b.resUrl_)?c._getOrigin(a)+"/home/signin.html":l.tokenServiceUrl.replace(c._rePortalTokenSvc,"")+"/home/signin.html",k=k.replace(/http:/i,"https:"),n&&!1===n.useSSL&&(k=k.replace(/https:/i,"http:")),0===a.toLowerCase().replace("https","http").indexOf(k.toLowerCase().replace("https","http"))?(l=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+
b.resUrl_),l.code="IdentityManagerBase.5",l.log=!!h.isDebug,e(l)):(c._rejectOnPersistedPageShow=!0,c._redirectFunc?c._redirectFunc({signInPage:k,returnUrlParamName:"returnUrl",returnUrl:a,resourceUrl:b.resUrl_,serverInfo:l}):window.location=k+"?returnUrl\x3d"+window.escape(a))):(l=Error("User is not signed in."),l.code="IdentityManagerBase.6",l.log=!!h.isDebug,e(l))):a?d(new K({userId:a,server:l.server,token:g,expires:p.isDefined(m)?Number(m):null,ssl:!!f})):n?(a=n._oAuthCred,a||(f=new z(n,window.localStorage),
g=new z(n,window.sessionStorage),f.isValid()&&g.isValid()?f.expires>g.expires?(a=f,g.destroy()):(a=g,f.destroy()):a=f.isValid()?f:g,n._oAuthCred=a),a.isValid()?d(new K({userId:a.userId,server:l.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):c._oAuthHash&&c._oAuthHash.state.portalUrl===n.portalUrl?(k=c._oAuthHash,l=new K({userId:k.username,server:l.server,token:k.access_token,expires:(new Date).getTime()+1E3*Number(k.expires_in),ssl:"true"===k.ssl,oAuthState:k.state,_oAuthCred:a}),
a.storage=k.persist?window.localStorage:window.sessionStorage,a.token=l.token,a.expires=l.expires,a.userId=l.userId,a.ssl=l.ssl,a.save(),c._oAuthHash=null,d(l)):k?b._pendingDfd=c.oAuthSignIn(b.resUrl_,l,n,b.options_).addCallbacks(d,e):(l=Error("User is not signed in."),l.code="IdentityManagerBase.6",l.log=!!h.isDebug,e(l))):k?c._checkProtocol(b.resUrl_,l,e,b.admin_)&&(k=b.options_,b.admin_&&(k=k||{},k.isAdmin=!0),b._pendingDfd=c.signIn(b.resUrl_,l,k).addCallbacks(d,e)):(l=Error("User is not signed in."),
l.code="IdentityManagerBase.6",l.log=!!h.isDebug,e(l))},g=function(){var f=b.sinfo_,g=f.owningSystemUrl,m=b.options_,l,k,h,n;m&&(l=m.token,k=m.error,h=m.prompt);(n=c._findCredential(g,{token:l,resource:b.resUrl_}))||a.some(c.credentials,function(a){this._isIdProvider(g,a.server)&&(n=a);return!!n},c);n?(m=c.findCredential(b.resUrl_,n.userId))?d(m):x(f,c._legacyFed)?(m=n.toJson(),m.server=f.server,m.resources=null,d(new K(m))):(b._pendingDfd=c.generateToken(c.findServerInfo(n.server),null,{serverUrl:b.resUrl_,
token:n.token,ssl:n.ssl})).addCallbacks(function(a){d(new K({userId:n.userId,server:f.server,token:a.token,expires:p.isDefined(a.expires)?Number(a.expires):null,ssl:!!a.ssl,isAdmin:b.admin_,validity:a.validity}))},e):(c._busy=null,l&&(b.options_.token=null),(b._pendingDfd=c.getCredential(g.replace(/\/?$/,"/sharing"),{resource:b.resUrl_,owningTenant:f.owningTenant,token:l,error:k,prompt:h})).addCallbacks(function(a){c._enqueue(b.resUrl_,b.sinfo_,b.options_,b,b.admin_)},function(a){e(a)}))};this._errbackFunc=
e;var m=b.sinfo_.owningSystemUrl,l=this._isServerRsrc(b.resUrl_),n=b.sinfo_._restInfoDfd;n?n.addCallbacks(function(a){var d=b.sinfo_;d.adminTokenServiceUrl=d._restInfoDfd.adminUrl_;d._restInfoDfd=null;d.tokenServiceUrl=k.getObject("authInfo.tokenServicesUrl",!1,a)||k.getObject("authInfo.tokenServiceUrl",!1,a)||k.getObject("tokenServiceUrl",!1,a);d.shortLivedTokenValidity=k.getObject("authInfo.shortLivedTokenValidity",!1,a);d.currentVersion=a.currentVersion;d.owningTenant=a.owningTenant;(a=d.owningSystemUrl=
a.owningSystemUrl)&&c._portals.push(a);l&&a?g():f()},function(){b.sinfo_._restInfoDfd=null;var a=Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=!!h.isDebug;e(a)}):l&&m?g():b.sinfo_._selfReq?b.sinfo_._selfReq.selfDfd.then(function(a){var d={},e,f,g,m;a&&(e=a.user&&a.user.username,d.username=e,d.allSSL=a.allSSL,f=a.supportsOAuth,g=a.currentVersion,"multitenant"===a.portalMode&&(m=a.customBaseUrl));b.sinfo_.webTierAuth=!!e;return e&&c.normalizeWebTierAuth?
c.generateToken(b.sinfo_,null,{ssl:d.allSSL}).addBoth(function(a){d.portalToken=a&&a.token;d.tokenExpiration=a&&a.expires;return d}):!e&&f&&4.4<=parseFloat(g)&&!c._doPortalSignIn(b.resUrl_)?c._generateOAuthInfo({portalUrl:b.sinfo_.server,customBaseUrl:m,owningTenant:b.sinfo_._selfReq.owningTenant}).always(function(){return d}):d}).always(function(a){b.sinfo_._selfReq=null;a?f(a.username,a.allSSL,a.portalToken,a.tokenExpiration):f()}):f()},_generateOAuthInfo:function(a){var b=this,d,e=a.portalUrl,
f=a.customBaseUrl,g=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){d=window.location.href;var m=d.indexOf("?");-1<m&&(d=d.slice(0,m));m=d.search(/\/(apps|home)\//);d=-1<m?d.slice(0,m):null}a&&d?(this._hasTestedIfAppIsOnPortal=!0,a=B({url:d+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){b.defaultOAuthInfo=new y({appId:"arcgisonline",popup:!0,popupCallbackUrl:d+"/home/oauth-callback.html"})})):(a=new c,a.resolve(),a=a.promise);
return a.then(function(){if(b.defaultOAuthInfo)return e=e.replace(/^http:/i,"https:"),B({url:e+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:g,client_id:b.defaultOAuthInfo.appId,redirect_uri:w.getAbsoluteUrl(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=b.defaultOAuthInfo.clone();c.portalUrl=a.urlKey&&f?"https://"+a.urlKey+"."+f:e;b.oAuthInfos.push(c)}})})}});K=b(A,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,
constructor:function(a){k.mixin(this,a);this.resources=this.resources||[];p.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var b=this,c=this.resources&&this.resources[0],d=q.id.findServerInfo(this.server),e=d&&d.owningSystemUrl,f=!!e&&"server"===this.scope,g=f&&x(d,q.id._legacyFed),m=f&&q.id.findServerInfo(e),l,k=(l=d.webTierAuth)&&q.id.normalizeWebTierAuth,h=E[this.server],h=h&&h[this.userId],n={username:this.userId,password:h},v;if(!l||
k)if(f&&!m&&a.some(q.id.serverInfos,function(a){q.id._isIdProvider(e,a.server)&&(m=a);return!!m}),l=m&&q.id.findCredential(m.server,this.userId),!f||l)if(g)l.refreshToken();else{if(f)v={serverUrl:c,token:l&&l.token,ssl:l&&l.ssl};else if(k)n=null,v={ssl:this.ssl};else if(h)this.isAdmin&&(v={isAdmin:!0});else{var u;c&&(c=q.id._sanitizeUrl(c),this._enqueued=1,u=q.id._enqueue(c,d,null,null,this.isAdmin,this),u.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=
0}));return u}return q.id.generateToken(f?m:d,f?null:n,v).addCallback(function(a){b.token=a.token;b.expires=p.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&a.forEach(q.id.credentials,function(a){var b=q.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(q.id._hasSameServerInstance(this.server,
c)||q.id._isIdProvider(c,this.server))&&(x(b,q.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken())},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&q.id.findServerInfo(this.server),c=(b=b&&b.owningSystemUrl)&&q.id.findServerInfo(b);!1!==a&&(!b||"portal"===this.scope||c&&c.webTierAuth&&!q.id.normalizeWebTierAuth)&&(p.isDefined(this.expires)||p.isDefined(this.validity))&&
this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var b=a.indexOf(q.id.credentials,this);-1<b&&q.id.credentials.splice(b,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=p.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,
validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(k.hitch(this,this.refreshToken),b>a?b-a:b)}});J.Credential=K;return q.IdentityManagerBase=J})},"esri/ServerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel","./lang"],function(b,h,k,a,c){b=b(null,{declaredClass:"esri.ServerInfo",constructor:function(a){h.mixin(this,a)},toJson:function(){return c.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});
return a.ServerInfo=b})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(b,h,k,a){h=h(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,b){this.oAuthInfo=a;this.storage=b;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var b=(new Date).getTime();this.expires>b&&(this.expires-b)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&
(a=!0)}return a},save:function(){if(this.storage){var b=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl){var e=b[d.authNamespace];e||(e=b[d.authNamespace]={});e[d.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",a.stringify(b))}catch(f){}}}},destroy:function(){var b=this._load(),d=this.oAuthInfo;if(d&&d.authNamespace&&d.portalUrl&&this.storage){var e=b[d.authNamespace];if(e){delete e[d.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",
a.stringify(b))}catch(f){}}}d&&(this.oAuthInfo=d._oAuthCred=null)},_init:function(){var a=this._load(),b=this.oAuthInfo;b&&b.authNamespace&&b.portalUrl&&(a=a[b.authNamespace])&&(a=a[b.portalUrl])&&(this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId)},_load:function(){var b={};if(this.storage){var d=this.storage.getItem("esriJSAPIOAuth");if(d)try{b=a.parse(d)}catch(e){}}return b}});return b.OAuthCredential=h})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang",
"dojo/_base/declare","dojo/_base/lang","dojo/has"],function(b,h,k,a,c){var d=k(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(b){a.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d490,width\x3d800,resizable,scrollbars,status"},b)},_oAuthCred:null,toJson:function(){return h.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,
minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new d(this.toJson())}});a.setObject("arcgis.OAuthInfo",d,b);return d})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(b,h,k,a,c,d,e,f){return b("dijit.form.Form",[c,d,e,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(b){h.set(this.domNode,
"encType",b);a("ie")&&(this.domNode.encoding=b);this._set("encType",b)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var b=this.constructor.prototype;if(this.execute!=
b.execute||this.onExecute!=b.onExecute)k.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,c,d){var e=this._oAuthDfd=new f;e.resUrl_=a;e.sinfo_=b;e.oinfo_=c;var g=!d||!1!==d.oAuthPopupConfirmation;if(!c.popup||!g)return this._doOAuthSignIn(a,b,c),e;this._nls||(this._nls=m.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=d&&d.error;d=d&&d.token;h.hide(a.errMsg_);b&&403==b.code&&d&&(l.set(a.errMsg_,"innerHTML",this._nls.forbidden),h.show(a.errMsg_));a.show();
return e},setOAuthResponseHash:function(a){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=n.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=!!e.isDebug,c.errback(a);else{var d=c.oinfo_._oAuthCred,f=new b({userId:a.username,server:c.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:d});d.storage=a.persist?window.localStorage:window.sessionStorage;d.token=f.token;d.expires=f.expires;d.userId=f.userId;d.ssl=f.ssl;d.save();c.callback(f)}},_createOAuthDialog:function(){var a=this._nls,b=k.substitute(a,this._oAuthDialogContent),f=new c({title:a.title,content:b,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=f.esriIdMgr_._oAuthDfd;f.hide_();f.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
f.esriIdMgr_._oAuthDfd;f.esriIdMgr_._oAuthDfd=null;f.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!e.isDebug;a.errback(b)},hide_:function(){h.hide(f.errMsg_);f.hide();c._DialogLevelManager.hide(f)}}),a=f.domNode;f.btnSubmit_=d.byNode(g.query(".esriIdSubmit",a)[0]);f.btnCancel_=d.byNode(g.query(".esriIdCancel",a)[0]);f.errMsg_=g.query(".esriErrorMsg",a)[0];f.connect(f.btnSubmit_,"onClick",f.execute_);f.connect(f.btnCancel_,"onClick",f.onCancel);f.connect(f,"onCancel",f.cancel_);
return f},_doOAuthSignIn:function(b,c,d){var f=this,g={client_id:d.appId,response_type:"token",state:t.stringify({portalUrl:d.portalUrl}),expiration:d.expiration,locale:d.locale,redirect_uri:d.popup?a.getAbsoluteUrl(d.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};d.forceLogin&&(g.force_login=!0);var m=d.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=m+"?"+n.objectToQuery(g);if(d.popup){var k;7===q("ie")?(k=window.open(d.popupCallbackUrl,"esriJSAPIOAuth",d.popupWindowFeatures),
k.location=l):k=window.open(l,"esriJSAPIOAuth",d.popupWindowFeatures);k?(k.focus(),this._oAuthDfd.oAuthWin_=k,this._oAuthIntervalId=setInterval(function(){if(k.closed){clearInterval(f._oAuthIntervalId);var a=f._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!e.isDebug;a.errback(b)}}},500)):(b=Error("ABORTED"),b.code="IdentityManager.2",b.log=!!e.isDebug,this._oAuthDfd.errback(b))}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:g,
authorizeUrl:m,resourceUrl:b,serverInfo:c,oAuthInfo:d}):window.location=l}}})},"arcgisonline/sharing/util":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg,dojo/request/xhr,arcgisonline/sharing/dijit/dialog/ConfirmDialog,esri/IdentityManager,dojo/sniff,dojo/json,dojo/cookie"],function(b,h,k){b.provide("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");
b.require("dojo.request.xhr");b.require("arcgisonline.sharing.dijit.dialog.ConfirmDialog");b.require("esri.IdentityManager");b.require("dojo.sniff");b.require("dojo.json");b.require("dojo.cookie");arcgisonline.sharing.util={i18n:b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline")),getSocialNetworkBadges:function(a,c){var d={},e=b.create,f=arcgisonline.sharing.util.socialNetworkTitle(a.title),g=unescape(window.location.href);if(!1===a.isOrganization||!0===a.isOrganization)g=arcgisonline.sharing.util.urlToObject(window.location.href).path+
"?id\x3d"+a.id;esriGeowConfig.self&&esriGeowConfig.self.customBaseUrl&&!arcgisonline.sharing.util.isPortal()&&-1<g.indexOf(esriGeowConfig.self.customBaseUrl)&&(g=g.replace(location.host,esriGeowConfig.self.portalHostname));var l=e("span",{"class":"esriItemLinks"}),m=encodeURI("socialnetwork.html?t\x3d"+f+"\x26n\x3dfb\x26u\x3d"+g),k=esri.i18nBundle.itemLinks.shareFacebook,h=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Facebook"),href:m,alt:k,title:k},l);e("span",{"class":"facebookBadge dijitInline"},
h);m=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Facebook"),href:m,alt:k,title:k},l);e("span",{innerHTML:esri.i18nBundle.itemLinks.facebook},m);d.facebook=l;l=e("span",{"class":"esriItemLinks"});m=encodeURI("socialnetwork.html?t\x3d"+f+"\x26n\x3dtw\x26u\x3d"+g);k=esri.i18nBundle.itemLinks.shareTwitter;h=e("a",{target:"_blank",onclick:b.partial(this._checkShare,a,"Twitter"),href:m,alt:k,title:k},l);e("span",{"class":"twitterBadge dijitInline"},h);m=e("a",{target:"_blank",onclick:b.partial(this._checkShare,
a,"Twitter"),href:m,alt:k,title:k},l);e("span",{innerHTML:esri.i18nBundle.itemLinks.twitter},m);d.twitter=l;c(d)},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return encodeURIComponent(a.replace(/ /g,"+"))},shortenUrl:function(a,c,d){var e=esriGeowConfig.bitlyUrl,f,g=new b.Deferred;this.request({url:e,content:{longUrl:a,format:"json"}}).then(function(a){(f=a&&a.data&&a.data.url||null)?c?c(f):g.resolve(f):d?d(a,args):g.reject(a,args)},function(a){d?d({},{}):g.reject(a)});
return g},_checkShare:function(a,b,d){b=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d=a&&esri.isDefined(a.isInvitationOnly);a.access&&"public"!==a.access&&b.show({title:esri.i18nBundle.itemLinks[d?"shareGroup":"shareItem"],message:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks[d?"shareGroupMsg":"shareItemMsg"])})},checkSession:function(){var a=this.getCookie("esri_auth"),c=null;a&&(c=a);!c||c.error&&""!=c.error||(esriGeowConfig.userInfo=
b.mixin(esriGeowConfig.userInfo||{},c))},isLoggedIn:function(){return null==this.getUser()?!1:!0},isSilverlightInstalled:function(){if(esriGeowConfig.isSilverlightInstalled)return esriGeowConfig.isSilverlightInstalled;esriGeowConfig.isSilverlightInstalled=!1;if(b.isIE)try{new ActiveXObject("AgControl.AgControl"),esriGeowConfig.isSilverlightInstalled=!0}catch(a){}else navigator.plugins["Silverlight Plug-In"]&&(esriGeowConfig.isSilverlightInstalled=!0);return esriGeowConfig.isSilverlightInstalled},
couldHaveArcGISDesktop:function(){return-1!=navigator.userAgent.indexOf("Windows")&&-1==navigator.userAgent.indexOf("Windows Phone")?!0:!1},requireAuthentication:function(){if(!0===this.isLoggedIn())return!0;var a="";-1==esriGeowConfig.signin.indexOf("http")&&(a=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(a=arcgisonline.sharing.util.getSecureUrl(a)));a+=esriGeowConfig.signin;window.location!==a&&(a+="?returnUrl\x3d"+escape(window.location));window.location=a+"\x26error\x3d403";return!1},htmlHasText:function(a){if(a&&
0<a.length){a=b.trim(a);for(var c=!1,d=0;d<a.length;d++){var e=a.charAt(d);if("\x3c"==e)c=!0;else if("\x3e"==e)c=!1;else if(!c&&""!==e)return!0}}return!1},endsWith:function(a,b){return null==a||null==b?!1:a.toLowerCase().lastIndexOf(b.toLowerCase())==a.length-b.length},toFullDateString:function(a){a=new Date(parseFloat(a));return b.date.locale.format(a,{selector:"date",formatLength:"long"})},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},getItemDetailsLinkInfo:function(a){var b=
null,d=null,e=null;esri.isDefined(a.isInvitationOnly)?(b=esriGeowConfig.baseUrl+"group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title),d=esri.i18nBundle.itemLinks.details,e=esri.i18nBundle.itemLinks.viewGroupDetails):(b=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,e=esri.i18nBundle.itemLinks.viewDetails);return null!==b&&null!==d?{link:b,label:d,tip:e}:null},_isOperationsViewSupportedBrowser:function(a){var c=navigator.userAgent.toLowerCase(),
d=/Chrome\/[.0-9]* (?!Mobile)/i,e=/Chrome\/[.0-9]* Mobile/i,e=b.has("iphone")||b.has("ipod")||b.has("android")&&e.test(c)||-1<c.indexOf("android")&&-1<c.indexOf("mobile")||-1<c.indexOf("windows phone")||b.has("bb");a&&(e=e||c.match(/ipad/i)||b.has("android")&&d.test(c));return e?!1:void 0!==b.has("chrome")?(a=b.has("chrome"),!isNaN(a)&&19<=a):void 0!==b.has("ff")?4<=b.has("ff"):c.match(/fxios/i)?(a=parseFloat(c.split("fxios/")[1]),!isNaN(a)&&1<=a):void 0!==b.has("ie")?9<=b.has("ie"):void 0!==b.has("edge")?
1<=b.has("edge"):void 0!==b.has("trident")?5<=b.has("trident"):void 0!==b.has("safari")?(a=parseFloat(c.split("version/")[1]),c=parseFloat(c.split("crios/")[1]),isNaN(a)&&isNaN(c)||!isNaN(a)&&5.1>a||!isNaN(c)&&31>c?!1:!0):!1},_isPremiumService:function(a){return a.owner&&-1<a.owner.toLowerCase().indexOf("esri")&&(-1<b.indexOf(a.typeKeywords,"Requires Subscription")||-1<b.indexOf(a.typeKeywords,"Requires Credits"))},getGalleryMainLinkInfo:function(a){var c=a.type?a.type:"",d="",e="",f="",g=null,e=
this.getUser(),d=!1,d=null;esriGeowConfig.portalHostname&&(d=esriGeowConfig.portalHostname);d&&(f=d.split("."),1<f.length&&(d=f[f.length-2]+"."+f[f.length-1]));if("Web Map"==c)d=!e&&this._isPremiumService(a),e='JavaScript:arcgisonline.map.mapUtil.openMap("'+a.id+'",'+d+")",f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),d=esri.i18nBundle.itemLinks.open;else if("CityEngine Web Scene"===c)d=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+
"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPage",d),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open;else if("Web Scene"===c&&esriGeowConfig.sceneViewerEnabled)d=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPage",d,!0),f=esri.i18nBundle.itemLinks.openSceneViewer,
d=esri.i18nBundle.itemLinks.open;else if("Scene Service"===c&&esriGeowConfig.sceneViewerEnabled)d=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,d,!0),f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open;else if("Operation View"===c){d=window.location;c=arcgisonline.sharing.util.isPortal();e=d.protocol+
"//"+(c?esriGeowConfig.self.portalHostname:d.host);d=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;f=-1<b.indexOf(a.typeKeywords,"TabletLayout");b.indexOf(a.typeKeywords,"DesktopLayout");var l=-1<b.indexOf(a.typeKeywords,"V2");this.couldHaveArcGISDesktop()&&!l?g=b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,e+(c?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id):
!l&&f&&this._isOperationsViewSupportedBrowser()&&(g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,d,!1));e="JavaScript:void(0)";f=esri.i18nBundle.itemLinks.openOperationViewDesktop;d=esri.i18nBundle.itemLinks.open}else"Map Service"==c||"Feature Service"==c||"Image Service"==c||"KML"==c||"Feature Collection"==c||"Stream Service"==c||"Vector Tile Service"===c?(f=a&&a.extraUrlParams?!0:!1,d=!e&&this._isPremiumService(a),e='JavaScript:arcgisonline.map.mapUtil.addToMap("'+a.id+'",'+d+","+f+
")",d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),esriGeowConfig.sceneViewerEnabled&&"Image Service"===c&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer")&&(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open)):"WMS"==c||"WFS"===c||"WMTS"===
c?(e=a.noWebMercator?'JavaScript:arcgisonline.map.mapUtil.openOnGCSMap("'+a.id+'")':'JavaScript:arcgisonline.map.mapUtil.addToMap("'+a.id+'")',d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer)):this.couldHaveArcGISDesktop()&&"Globe Service"==c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url+"?f\x3dlyr\x26v\x3d9.3"),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):
this.couldHaveArcGISDesktop()&&("Map Package"==c||"Basemap Package"===c||"Mobile Map Package"==c||"Mobile Basemap Package"===c||"Layer Package"==c||"Pro Map"==c||"Layout"==c||-1<b.indexOf(a.typeKeywords,"lyrx"))?a&&a.name.indexOf(".mmpk")&&a.name.indexOf(".bpk")&&-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&-1===a.name.indexOf(".lyrx")&&-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx")?(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,
this.getItemPkgPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):!this.couldHaveArcGISDesktop()||"Geoprocessing Package"!=c&&"Geoprocessing Service"!=c&&"Locator Package"!=c&&"Tile Package"!=c&&"Vector Tile Package"!=c&&"Scene Package"!==c?!this.couldHaveArcGISDesktop()||"Map Document"!=c&&"Published Map"!=
c&&"Globe Document"!=c&&"Scene Document"!=c&&"Layer"!=c?!this.couldHaveArcGISDesktop()||"Desktop Add In"!=c&&"ArcGIS Pro Add In"!==c?!this.isSilverlightInstalled()||"Explorer Map"!=c&&"Explorer Layer"!=c&&"Explorer Add In"!=c?"File Geodatabase"===c||"CSV Collection"===c||"KML Collection"===c||"Rule Package"===c||"GeoJson"===c||"Shapefile"===c||"CSV"===c||"Map Template"===c||"Code Sample"===c||"Geoprocessing Sample"===c||"Service Definition"===c||"Workflow Manager Package"===c||"Windows Viewer Add-in"===
c||"ArcPad Package"===c||"Operations Dashboard Addin"===c||"CAD Drawing"===c||"Microsoft Word"===c||"Raster function template"===c||"Microsoft PowerPoint"===c||"Microsoft Powerpoint"===c||"Microsoft Excel"===c||"iWork Pages"===c||"iWork Keynote"===c||"iWork Numbers"===c||"Image"===c||"Visio Document"===c||"PDF"===c||"Desktop Application"===c||"Task File"===c||"Project Package"===c||"ArcGIS Pro Configuration"===c||"Project Template"===c||"Desktop Style"===c||"Native Application Installer"===c||"360 VR Experience"==
c?(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):"Web Mapping Application"!=c&&"Application"!=c&&"Native Application"!==c&&"Native Application Template"!==c&&"Hub Initiative"!==c&&"Hub Page"!==c&&"Hub Site Application"!==c||-1!==b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS")?"Desktop Application Template"==c?-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl")&&a.url&&0<
a.url.length?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):"Mobile Application"==c?a.url&&0<a.url.length?(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||d&&-1<a.url.indexOf(d))&&(a.originalUrl=a.originalUrl||
b.clone(a.url),a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url),e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.getApp):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails):"Windows Mobile Package"==c?(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,
f=esri.i18nBundle.itemLinks.download):"Document Link"===c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):"Form"===c&&e&&e.accountId?(e="arcgis-survey123://?itemId\x3d"+a.id+"\x26username\x3d"+e.username,f=esri.i18nBundle.itemLinks.openInSurvey123,d=esri.i18nBundle.itemLinks.open):"Workforce Project"===c?(e=(c=arcgisonline.sharing.util.isPortal())?window.location.host+arcgisonline.sharing.util.getHomeAppContext():"workforce.arcgis.com",
e=window.location.protocol+"//"+e+((c?"/apps/workforce/#":"")+("/projects/"+a.id+"/dispatch/assignments")),f=esri.i18nBundle.itemLinks.openWorkforce,d=esri.i18nBundle.itemLinks.open):"Insights Workbook"===c||"Insights Page"===c||"Insights Model"===c?(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/insights/#/",e="Insights Model"===c?e+("?model\x3d"+a.id):"Insights Page"===c?e+("view/"+a.id):e+a.id,f=esri.i18nBundle.itemLinks.openInsights,d=
esri.i18nBundle.itemLinks.open):"Dashboard"===c?(g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/opsdashboard/index.html#/"+a.id,e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,g),f=esri.i18nBundle.itemLinks.dashboardView,d=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails):(c=arcgisonline.sharing.util.isHostedTemplateItem(a.url),
a.url&&0<a.url.length?(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||d&&-1<a.url.indexOf(d))&&-1===a.url.indexOf(".opendata")&&(a.originalUrl=a.originalUrl||b.clone(a.url),a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url),a.access&&"public"!==a.access&&c&&!arcgisonline.sharing.util.isPortal()&&(g=arcgisonline.sharing.util.parseUrl(a.url),a.url=a.url.replace(g.host,window.location.hostname)),arcgisonline.sharing.util.isPortal()&&a.url&&0===a.url.indexOf("/")&&(g=
esriGeowConfig.self.portalHostname.substring(esriGeowConfig.self.portalHostname.indexOf("/")),-1===a.url.indexOf(g)&&(a.url=g+a.url)),e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails)):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),
d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openExplorer):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a)),d=esri.i18nBundle.itemLinks.open,
f="Task File"!==c?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional);return{label:d,href:e,target:"",tip:f,onclick:g}},getHomePageGalleryLinkInfo:function(a){var c=a.type?a.type:"",d="",e="",f="",g=null,d=this.getUser(),e=!1,e=null;esriGeowConfig.portalHostname&&(e=esriGeowConfig.portalHostname);e&&(f=e.split("."),1<f.length&&(e=f[f.length-2]+"."+f[f.length-1]));if("Web Map"==c)var f=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+a.id,l=esriGeowConfig.baseUrl+
"signin.html?returnUrl\x3d"+encodeURIComponent(f),e=(e=!d&&this._isPremiumService(a))?l:f,f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),d=esri.i18nBundle.itemLinks.open;else if("CityEngine Web Scene"===c)e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open;else if("Web Scene"===c&&esriGeowConfig.sceneViewerEnabled)e=
window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+a.id,f=esri.i18nBundle.itemLinks.openSceneViewer,d=esri.i18nBundle.itemLinks.open;else if("Scene Service"===c&&esriGeowConfig.sceneViewerEnabled)e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open;
else if("Operation View"===c){e=window.location;c=arcgisonline.sharing.util.isPortal();d=-1<b.indexOf(a.typeKeywords,"V2");e=e.protocol+"//"+(c?esriGeowConfig.self.portalHostname:e.host);f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;l=this.couldHaveArcGISDesktop();if(d)return null;if(l)e=e+(c?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id;else if(this._isOperationsViewSupportedBrowser())e=
f;else return null;f=esri.i18nBundle.itemLinks.openOperationViewDesktop;d=esri.i18nBundle.itemLinks.open}else"Map Service"==c||"Feature Service"==c||"Image Service"==c||"KML"==c||"Stream Service"==c||"Vector Tile Service"===c?(f=esriGeowConfig.baseUrl+"webmap/viewer.html?layers\x3d"+a.id,l=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(f),e=(e=!d&&this._isPremiumService(a))?l:f,d=esri.i18nBundle.itemLinks.open,f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},
esri.i18nBundle.itemLinks.addToNewViewer),esriGeowConfig.sceneViewerEnabled&&"Image Service"===c&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer")&&(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,f=esri.i18nBundle.itemLinks.addToSceneViewer,d=esri.i18nBundle.itemLinks.open)):"WMS"==c||"WFS"===c||"WMTS"===c?(e=esriGeowConfig.baseUrl+"webmap/viewer.html?layers\x3d"+a.id,d=esri.i18nBundle.itemLinks.open,
f=esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer)):this.couldHaveArcGISDesktop()&&"Globe Service"==c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url+"?f\x3dlyr\x26v\x3d9.3"),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):this.couldHaveArcGISDesktop()&&("Map Package"==c||"Mobile Map Package"==c||"Basemap Package"===c||"Mobile Basemap Package"===c||"Layer Package"==c||"Pro Map"==
c||"Layout"==c||-1<b.indexOf(a.typeKeywords,"lyrx"))?a&&-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".mmpk")&&-1===a.name.indexOf(".bpk")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&-1===a.name.indexOf(".lyrx")&&-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx")?(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",
a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):!this.couldHaveArcGISDesktop()||"Geoprocessing Package"!=c&&"Locator Package"!=c&&"Tile Package"!=c&&"Vector Tile Package"!=c?!this.couldHaveArcGISDesktop()||"Map Document"!=c&&"Published Map"!=c&&"Globe Document"!=c&&"Scene Document"!=c&&"Layer"!=c?!this.couldHaveArcGISDesktop()||"Desktop Add In"!=c&&"ArcGIS Pro Add In"!==c?!this.isSilverlightInstalled()||"Explorer Map"!=c&&"Explorer Layer"!=
c&&"Explorer Add In"!=c?"File Geodatabase"===c||"CSV Collection"===c||"KML Collection"===c||"Rule Package"===c||"GeoJson"===c||"Shapefile"===c||"CSV"===c||"Map Template"===c||"Code Sample"===c||"Geoprocessing Sample"===c||"Service Definition"===c||"Workflow Manager Package"===c||"Windows Viewer Add-in"===c||"ArcPad Package"===c||"Operations Dashboard Addin"===c||"Microsoft Word"===c||"CAD Drawing"===c||"Raster function template"===c||"Microsoft PowerPoint"===c||"Microsoft Powerpoint"===c||"Microsoft Excel"===
c||"iWork Pages"===c||"iWork Keynote"===c||"iWork Numbers"===c||"Image"===c||"Visio Document"===c||"PDF"===c||"Desktop Application"===c||"Task File"===c||"Project Package"===c||"ArcGIS Pro Configuration"===c||"Project Template"===c||"Desktop Style"===c||"Native Application Installer"===c||"360 VR Experience"==c?(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):"Desktop Application Template"==
c?-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl")&&a.url&&0<a.url.length?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.downloadArchive):"Web Mapping Application"==c&&-1===b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS")||"Hub Initiative"===c||"Hub Page"===c||
"Hub Site Application"===c?(c=arcgisonline.sharing.util.isHostedTemplateItem(a.url),a.url&&0<a.url.length?(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||e&&-1<a.url.indexOf(e))&&-1===a.url.indexOf(".opendata")&&(a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url),a.access&&"public"!==a.access&&c&&!arcgisonline.sharing.util.isPortal()&&(g=arcgisonline.sharing.util.parseUrl(a.url),a.url=a.url.replace(g.host,window.location.hostname)),arcgisonline.sharing.util.isPortal()&&
a.url&&0===a.url.indexOf("/")&&(g=esriGeowConfig.self.portalHostname.substring(esriGeowConfig.self.portalHostname.indexOf("/")),-1===a.url.indexOf(g)&&(a.url=g+a.url)),e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),f=esri.i18nBundle.itemLinks.viewApp,d=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails)):"Mobile Application"==c?a.url&&0<a.url.length?
(esriGeowConfig.urlKey&&(-1<a.url.indexOf(esriGeowConfig.urlKey)||e&&-1<a.url.indexOf(e))&&(a.url=esriGeowConfig.allSSL?a.url.replace("http:","https:"):a.url),e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.getApp):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails):"Windows Mobile Package"==c?(e="JavaScript:void(0)",g=b.hitch(this,
"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.download):"Document Link"===c?(e="JavaScript:void(0)",g=b.hitch(arcgisonline.sharing.util,"openPageAndCount",a.id,a.url),d=f=esri.i18nBundle.itemLinks.open):"Form"===c&&d&&d.accountId?(e="arcgis-survey123://?itemId\x3d"+a.id+"\x26username\x3d"+d.username,f=esri.i18nBundle.itemLinks.openSurvey123,d=esri.i18nBundle.itemLinks.open):"Workforce Project"===c?(d=(c=arcgisonline.sharing.util.isPortal())?
window.location.host+arcgisonline.sharing.util.getHomeAppContext():"workforce.arcgis.com",e=window.location.protocol+"//"+d+((c?"/apps/workforce/#":"")+("/projects/"+a.id+"/dispatch/assignments")),f=esri.i18nBundle.itemLinks.openWorkforce,d=esri.i18nBundle.itemLinks.open):"Insights Workbook"===c||"Insights Page"===c||"Insights Model"===c?(d=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/insights/#/",e=d="Insights Model"===c?d+("?model\x3d"+
a.id):"Insights Page"===c?d+("view/"+a.id):d+a.id,f=esri.i18nBundle.itemLinks.openInsights,d=esri.i18nBundle.itemLinks.open):"Dashboard"===c?(e=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/opsdashboard/index.html#/"+a.id,f=esri.i18nBundle.itemLinks.dashboardView,d=esri.i18nBundle.itemLinks.open):(e=esriGeowConfig.baseUrl+"item.html?id\x3d"+a.id,d=esri.i18nBundle.itemLinks.details,f=esri.i18nBundle.itemLinks.viewDetails):(e="JavaScript:void(0)",
g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openExplorer,f=esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer)):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a)),d=esri.i18nBundle.itemLinks.open,f=esri.i18nBundle.itemLinks.openDesktop):
(e="JavaScript:void(0)",g=b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a)),d=esri.i18nBundle.itemLinks.open,f="Task File"!==c?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional);return{label:d,href:e,target:"",tip:f,onclick:g}},getItemOpenLinkObjects:function(a,c){var d=this.isSilverlightInstalled(),e=[],f=a.type?a.type:"",g=this.getUser(),l=!1;if("Web Map"==f&&-1==b.indexOf(a.typeKeywords,"ArcGIS Online")&&d&&esriGeowConfig.explorerOnline)e.push({label:esri.substitute({appTitle:""},
esri.i18nBundle.itemLinks.openViewer),onClick:b.partial(arcgisonline.map.mapUtil.openMap,a.id,l)}),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a))});else if("Web Map"==f)l=!g&&this._isPremiumService(a),e.push({label:esri.substitute({appTitle:""},esri.i18nBundle.itemLinks.openViewer),onClick:b.partial(arcgisonline.map.mapUtil.openMap,a.id,l)}),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a))}),f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+a.id,-1<b.indexOf(a.typeKeywords,"Presentation Map")?(e.push({label:esri.i18nBundle.aboutPanel.viewPresentation,onClick:b.partial(arcgisonline.sharing.util.openPage,f)}),c&&e.push({label:esri.i18nBundle.aboutPanel.editPresentation,onClick:b.partial(arcgisonline.sharing.util.openPage,f+"\x26builder",
!0)})):c&&e.push({label:esri.i18nBundle.aboutPanel.createPresentation,onClick:b.partial(arcgisonline.sharing.util.openPage,f+"\x26builder",!0)});else if("Map Service"==f||"Vector Tile Service"===f)l=!g&&this._isPremiumService(a),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id,l)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),
onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id,l)}),esriGeowConfig.sceneViewerEnabled&&e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,!0)}),"Vector Tile Service"!==f?(this.couldHaveArcGISDesktop()&&!arcgisonline.sharing.util.isHostedServiceItem(a)&&(-1<b.indexOf(a.typeKeywords,
"Hosted Service")&&arcgisonline.sharing.util.portalSupportsHostedServices()?e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))}):!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onAGOLFederatedServer(a.url)||arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onFederatedServer(a.url)?e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))}):a.url&&-1!==
a.url.indexOf(".arcgis.com/")&&-1!==a.url.indexOf("//landscape")?e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))}):e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")})),this.couldHaveArcGISDesktop()&&arcgisonline.sharing.util.isHostedServiceItem(a)&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",
a,this.getPItemPath(a))})):(f=a.access&&"public"!==a.access&&g&&g.token?"\x26token\x3d"+g.token:"",g=(a&&a.hasResources?esriGeowConfig.restBaseUrl+"content/items/"+a.id:a.url)+"/resources/styles/root.json?f\x3dpjson",esri.isDefined(a.hasResources)&&(c&&a&&a.hasResources&&e.push({label:esri.i18nBundle.itemLinks.downloadStyle,onClick:b.partial(arcgisonline.sharing.util.openPage,g+"\x26download\x3dtrue"+f,!0)}),(c&&a&&a.hasResources||a.url&&-1<a.url.indexOf("/VectorTileServer"))&&e.push({label:esri.i18nBundle.itemLinks.viewStyle,
onClick:b.partial(arcgisonline.sharing.util.openPage,g+f,!1)})));else if(this.couldHaveArcGISDesktop()&&"Globe Service"==f)e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")});else if("Image Service"==f||"Feature Service"==f||"KML"==f||"Feature Collection"==f||"Stream Service"==f){c=a&&a.extraUrlParams?!0:!1;l=!g&&this._isPremiumService(a);if("Image Service"!==f||"Image Service"===f&&-1===b.indexOf(a.typeKeywords,
"Elevation 3D Layer"))e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id,l,c)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id,l,c)});if("KML"==f)this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,
"_fetchItemData",a,this.getPItemPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Image Service"===f||"Feature Service"===f)esriGeowConfig.sceneViewerEnabled&&-1===b.indexOf(a.typeKeywords,"Table")&&("Feature Service"===f&&-1===b.indexOf(a.typeKeywords,"HasOnlyMultipatchGeometries")||"Image Service"===f&&-1<b.indexOf(a.typeKeywords,"Elevation 3D Layer"))&&e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,
onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,!0)}),this.couldHaveArcGISDesktop()&&"Image Service"===f&&(a.url&&-1!==a.url.indexOf(".arcgis.com/")||!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onAGOLFederatedServer(a.url)||arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.onFederatedServer(a.url)?e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))}):e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url+"?f\x3dlyr\x26v\x3d9.3")})),this.couldHaveArcGISDesktop()&&"Feature Service"===f&&this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))})}else if("Geoprocessing Service"===f&&this.couldHaveArcGISDesktop())e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))});else if("WMS"==f||"WFS"===f||"WMTS"===f)a.noWebMercator?e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnGCSMap,a.id)}):(e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||"ArcGIS.com"},esri.i18nBundle.itemLinks.addToViewer),onClick:b.partial(arcgisonline.map.mapUtil.addToMap,a.id)}),e.push({label:esri.substitute({appTitle:esriGeowConfig.portalName||
"ArcGIS.com"},esri.i18nBundle.itemLinks.addToNewViewer),onClick:b.partial(arcgisonline.map.mapUtil.openOnMap,a.id)})),esriGeowConfig.sceneViewerEnabled&&e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,!0)}),this.couldHaveArcGISDesktop()&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.hitch(this,"_fetchItemData",a,this.getPItemPath(a))});else if("File Geodatabase"===f||"CSV Collection"===f||"KML Collection"===f||"Rule Package"==f||"CSV"==f||"GeoJson"===f||"Shapefile"==f||"Service Definition"==f||"ArcPad Package"===f||"Operations Dashboard Addin"===f)e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Map Package"==f||"Mobile Map Package"===f||"Basemap Package"===f||"Mobile Basemap Package"===f||
"Layer Package"==f||"Pro Map"==f||"Layout"==f||-1<b.indexOf(a.typeKeywords,"lyrx"))this.couldHaveArcGISDesktop()&&a&&-1===a.name.indexOf(".bpkx")&&-1===a.name.indexOf(".mmpk")&&-1===a.name.indexOf(".bpk")&&-1===a.name.indexOf(".lpkx")&&-1===a.name.indexOf(".mpkx")&&-1===a.name.indexOf(".lyrx")&&-1===a.name.indexOf(".mapx")&&-1===a.name.indexOf(".pagx")&&e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,
onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Geoprocessing Package"==f||"Locator Package"==f||"Tile Package"==f||"Vector Tile Package"==f||"Project Package"===f||"Project Template"===f)this.couldHaveArcGISDesktop()&&"Task File"!==f&&"Project Package"!==f&&"Project Template"!==f&&e.push({label:"Task File"!==f?esri.i18nBundle.itemLinks.openDesktop:esri.i18nBundle.itemLinks.openProfessional,onClick:b.hitch(this,"_fetchItemData",a,this.getItemPkgPath(a))}),e.push({label:esri.i18nBundle.itemLinks.download,
onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Scene Package"==f)e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if(!this.couldHaveArcGISDesktop()||"Map Document"!=f&&"Published Map"!=f&&"Globe Document"!=f&&"Scene Document"!=f&&"Layer"!=f)if(!this.couldHaveArcGISDesktop()||"Desktop Add In"!=f&&"ArcGIS Pro Add In"!==f)if("Explorer Layer"==f||"Explorer Add In"==f||"Explorer Map"==f)e.push({label:esri.i18nBundle.itemLinks.openExplorer,
onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Map Template"===f||"Code Sample"===f||"Geoprocessing Sample"===f||"Workflow Manager Package"===f||"Windows Viewer Add In"===f||"Microsoft Word"===f||"CAD Drawing"===f||"Raster function template"===f||"Microsoft PowerPoint"===f||"Microsoft Powerpoint"===f||"Microsoft Excel"===f||"iWork Pages"===f||"iWork Keynote"===f||"iWork Numbers"===f||"Image"===f||"Visio Document"===f||"PDF"===f||"Desktop Application"===f||"Task File"===
f||"Desktop Style"===f||"Native Application Installer"===f||"360 VR Experience"==f||"ArcGIS Pro Configuration"===f)e.push({label:"PDF"!==f?esri.i18nBundle.itemLinks.download:esri.i18nBundle.itemLinks.open,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Desktop Application Template"===f)(c=-1<b.indexOf(a.typeKeywords,"desktopApplicationTemplateUrl"))&&a.url&&a.url.length&&(c=!0,e.push({label:esri.i18nBundle.itemLinks.open,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,
a.id,a.url)})),c||e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Web Mapping Application"==f&&-1===b.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS")||"Mobile Application"==f||"Application"==f||"Native Application"===f||"Native Application Template"===f||"Hub Initiative"===f||"Hub Page"===f||"Hub Site Application"===f)arcgisonline.sharing.util.isHostedTemplateItem(a.url),g=esri.i18nBundle.itemLinks.viewApp,"Mobile Application"==
f&&(g=esri.i18nBundle.itemLinks.getApp),arcgisonline.sharing.util.isPortal()&&a.url&&0===a.url.indexOf("/")&&(f=esriGeowConfig.self.portalHostname.substring(esriGeowConfig.self.portalHostname.indexOf("/")),-1===a.url.indexOf(f)&&(a.url=f+a.url)),a.url&&0<a.url.length&&e.push({label:g,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url)}),-1<b.indexOf(a.typeKeywords,"Web AppBuilder")&&c&&(a=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+
"/apps/webappbuilder/index.html?id\x3d"+a.id,a="https:"===window.location.protocol?arcgisonline.sharing.util.getSecureUrl(a):arcgisonline.sharing.util.getHttpUrl(a),e.push({label:esri.i18nBundle.itemLinks.editApp,onClick:b.partial(arcgisonline.sharing.util.openPage,a,!0)}));else if("Windows Mobile Package"==f)e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("CityEngine Web Scene"==f)f=window.location.protocol+"//"+window.location.host+
arcgisonline.sharing.util.getHomeAppContext()+"/apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id,e.push({label:esri.i18nBundle.itemLinks.viewApp,onClick:b.partial(arcgisonline.sharing.util.openPage,f)}),e.push({label:esri.i18nBundle.itemLinks.download,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else if("Web Scene"===f&&esriGeowConfig.sceneViewerEnabled)f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?webscene\x3d"+
a.id,e.push({label:esri.i18nBundle.itemLinks.openSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPage,f,!0)});else if("Scene Service"===f&&esriGeowConfig.sceneViewerEnabled)f=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/home/webscene/viewer.html?layers\x3d"+a.id,e.push({label:esri.i18nBundle.itemLinks.addToSceneViewer,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,f,!0)});else if("Operation View"===f){f=window.location;
c=arcgisonline.sharing.util.isPortal();g=f.protocol+"//"+(c?esriGeowConfig.self.portalHostname:f.host);l=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;d=-1<b.indexOf(a.typeKeywords,"TabletLayout");b.indexOf(a.typeKeywords,"DesktopLayout");var m=-1<b.indexOf(a.typeKeywords,"V2"),k=this.couldHaveArcGISDesktop(),f=this._isOperationsViewSupportedBrowser();k&&!m&&e.push({label:esri.i18nBundle.itemLinks.openOperationViewDesktop,
onClick:b.partial(arcgisonline.sharing.util.openPage,g+(c?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id)});!m&&d&&f&&e.push({label:esri.i18nBundle.itemLinks.openOperationViewUrl,onClick:b.partial(arcgisonline.sharing.util.openPage,l,!1)})}else"Document Link"===f?e.push({label:esri.i18nBundle.itemLinks.open,onClick:b.partial(arcgisonline.sharing.util.openPageAndCount,a.id,a.url)}):"Form"===f&&g&&g.accountId?e.push({label:esri.i18nBundle.itemLinks.openSurvey123,
onClick:b.partial(arcgisonline.sharing.util.openPage,"arcgis-survey123://?itemId\x3d"+a.id+"\x26username\x3d"+g.username,!0)}):"Workforce Project"===f?(f=(c=arcgisonline.sharing.util.isPortal())?window.location.host+arcgisonline.sharing.util.getHomeAppContext():"workforce.arcgis.com",e.push({label:esri.i18nBundle.itemLinks.openWorkforce,onClick:b.partial(arcgisonline.sharing.util.openPage,window.location.protocol+"//"+f+((c?"/apps/workforce/#":"")+("/projects/"+a.id+"/dispatch/assignments")),!0)})):
"Insights Workbook"===f||"Insights Page"===f||"Insights Model"===f?(c=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/insights/#/",c="Insights Model"===f?c+("?model\x3d"+a.id):"Insights Page"===f?c+("view/"+a.id):c+a.id,e.push({label:esri.i18nBundle.itemLinks.openInsights,onClick:b.partial(arcgisonline.sharing.util.openPage,c,!0)})):"Dashboard"===f&&(g=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+
"/apps/opsdashboard/index.html#/",f=this._isOperationsViewSupportedBrowser(!0),a=g+a.id,g=a+"?edit\x3dtrue",e.push({label:esri.i18nBundle.itemLinks.dashboardView,onClick:b.partial(arcgisonline.sharing.util.openPage,a,!1)}),c&&f&&e.push({label:esri.i18nBundle.itemLinks.dashboardEdit,onClick:b.partial(arcgisonline.sharing.util.openPage,g,!1)}));else e.push({label:esri.i18nBundle.itemLinks.openDesktop,onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});else e.push({label:esri.i18nBundle.itemLinks.openDesktop,
onClick:b.hitch(this,"_fetchItemData",a,this.getItemDataPath(a))});return e},getGroupLinks:function(a){var c=b.create,d=c("span",{"class":"esriItemLinks",style:"white-space: nowrap"});c("a",{href:esriGeowConfig.baseUrl+"group.html?id\x3d"+a.id,innerHTML:esri.i18nBundle.itemLinks.details,title:esri.i18nBundle.itemLinks.viewGroupDetails,alt:esri.i18nBundle.itemLinks.viewGroupDetails},d);return d},getItemDataPath:function(a){var b=arcgisonline.sharing.util.getToken(),d=b?"?token\x3d"+b:"",e=esriGeowConfig.restBaseUrl+
"content/items/"+a.id+"/data";return"KML"==a.type&&(d="public"!==a.access&&b?"?token\x3d"+b:"",a.url&&-1===a.url.indexOf(e))?a.url+d:e+d},getItemPkgPath:function(a){var b=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/item.pkinfo"+(b?"?token\x3d"+b:"")},getPItemPath:function(a){var b=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/item.pitem"+(b?"?token\x3d"+b:"")},getItemZipPath:function(a){var b=arcgisonline.sharing.util.getToken();
return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/data?f\x3dzip"+(b?"\x26token\x3d"+b:"")},getUser:function(){this.checkSession();return""===esriGeowConfig.userInfo?null:esriGeowConfig.userInfo},meetsPasswordStrength:function(a){return 8<=a.length&&a.match("^.*(?\x3d.*\\d)(?\x3d.*[a-zA-Z]).*$")},meetsPasswordPolicyStrength:function(a,b){var c={meetsRequirements:function(){return this.minLength&&this.minLetter&&this.minUpper&&this.minLower&&this.minDigit&&this.minOther},minLength:!0,minLetter:!0,
minUpper:!0,minLower:!0,minDigit:!0,minOther:!0};if(b&&0<b.length){a.minLength&&(c.minLength=b.length>=a.minLength);if(a.minLetter){var e=b.match(/[A-Za-z]/g);c.minLetter=!!(e&&e.length>=a.minLetter)}a.minUpper&&(e=b.match(/[A-Z]/g),c.minUpper=!!(e&&e.length>=a.minUpper));a.minLower&&(e=b.match(/[a-z]/g),c.minLower=!!(e&&e.length>=a.minLower));a.minDigit&&(e=b.match(/[0-9]/g),c.minDigit=!!(e&&e.length>=a.minDigit));a.minOther&&(b=b.match(/[\\!"#\$%&'\(\)\*\+,-\./:;<=>\?@\[\]\^_`\{\|}~]/g),c.minOther=
!!(b&&b.length>=a.minOther))}else a.minLength&&(c.minLength=!1),a.minLetter&&(c.minLetter=!1),a.minUpper&&(c.minUpper=!1),a.minLower&&(c.minLower=!1),a.minDigit&&(c.minDigit=!1),a.minOther&&(c.minOther=!1);return c},userPreferences:function(a,c,d){var e=b.cookie(c||"esri_prefs");if(a)e&&(a=b.mixin(b.json.parse(e),a)),b.cookie(c||"esri_prefs",b.json.stringify(a),{path:"/",expires:1E4}),a.contentMode&&d&&this.getUser()?(e=b.create,d=e("form",{method:"POST"},b.body()),e("input",{type:"hidden",name:"preferredView",
value:a.contentMode},d),e("input",{type:"hidden",name:"clearEmptyFields",value:"false"},d),arcgisonline.sharing.geow.Community.updateProfile(d,function(d){b.publish("esri/userPreferences"+(c||"user_prefs"),[a])})):b.publish("esri/userPreferences"+(c||"user_prefs"),[a]);else return d="contentModePrefs"===c?esriGeowConfig.userInfo&&esriGeowConfig.userInfo.preferredView:null,null!=e?b.json.parse(e):d?{contentMode:d}:{}},getToken:function(){return!1===this.isLoggedIn()?"":esriGeowConfig.userInfo.token},
callPage:function(a){window.location=arcgisonline.sharing.util.replaceSSL(esriGeowConfig.baseUrl+a)},openPageAndCount:function(a,b,d){a=esriGeowConfig.restBaseUrl+"content/items/"+a+"/data";var c=arcgisonline.sharing.util.getToken(),f={f:"json"};null!=c&&""!==c&&(f.token=c);esri.request({url:a,content:f,callbackParamName:"callback"});arcgisonline.sharing.util.openPage(b,"boolean"===typeof d?d:!1)},openPage:function(a,b){b?window.location=a:window.open(a)},fix:function(a){null!=a&&1==a.length&&null!=
a[0]&&0<a[0].length&&(a=a[0]);return a.replace(/&lt;/g,"\x3c")},stripHTML:function(a){return a?-1<a.indexOf("\x3c")&&-1<a.indexOf("\x3e")?a.replace(/\<[^\>]+\>/g,""):a:a},urlToObject:function(a){a=esri.urlToObject(a);a.query=a.query||{};for(var b in a.query)a.query.hasOwnProperty(b)&&(Array.isArray(a.query[b])||(a.query[b]=a.query[b].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,"")));return a},linkifyText:function(a){a=a.split(" ");for(var b=0;b<a.length;b++)if(0===a[b].indexOf("http://")||0===a[b].indexOf("https://"))a[b]=
"\x3ca href\x3d'"+a[b]+"' target\x3d'_blank'\x3e"+a[b]+"\x3c/a\x3e";return a.join(" ")},removeHTMLTags:function(a){if(null==a)return"";a=a.replace(/&(lt|gt);/g,function(a,b){return"lt"==b?"\x3c":"\x3e"});return a.replace(/<\/?[^>]+(>|$)/g,"")},escapeHTML:function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;","/":"\x26#x2F;"};return String(a).replace(/[&<>"'\/]/g,function(a){return b[a]})},unescapeHTML:function(a){return String(a).replace("\x26lt;","\x3c").replace("\x26gt;",
"\x3e").replace("\x26quot;",'"').replace("\x26#39;","'").replace("\x26#x2F;","/").replace("\x26amp;","\x26")},getSnippet:function(a,b){if(null==a||0===a.length)b=arcgisonline.sharing.util.removeHTMLTags(b),a=180<b.length?b.substring(0,180)+" ...":b;return a},trimTags:function(a){for(;-1<a.indexOf("  ");)a=a.replace(/  /g," ");for(;-1<a.indexOf(",,");)a=a.replace(/,,/g,",");return a=b.trim(a.replace(/, ,/,",").replace(/^,/,"").replace(/,$/,""))},postProcessUri:function(a){a=0<=a.indexOf("?")?a+"\x26f\x3djson":
a+"?f\x3djson";var b=this.getToken();null!=b&&""!==b&&(a=a+"\x26token\x3d"+b);return this.useSSL(a)},replaceSSL:function(a){return!1===esriGeowConfig.useSSL?a:a.replace("http://","https://")},useSSL:function(a){return"https:"===window.location.protocol||esriGeowConfig.self&&!0===esriGeowConfig.self.allSSL?a.replace("http:","https:"):a},errorHandler:function(a,c,d,e){a&&a.code&&"IdentityManagerBase.5"===a.code&&(a.code=498);if(-1<d.indexOf(esriGeowConfig.restBaseUrl)&&a.code&&498==a.code||403==a.code||
400==a.code&&"Invalid account"==a.message)if(403==a.code&&!0===this.isLoggedIn())d&&-1<d.indexOf("/invitations/")&&e?e(a,c):0>window.location.href.indexOf(esriGeowConfig.baseUrl+"error.html")&&("Request not made over ssl"==a.message?window.location=esriGeowConfig.baseUrl+"error.html?c\x3dSSLRequired":arcgisonline.sharing.util.checkSubscriptionStatus(a)&&(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dAccessDeniedResource"));else{if(!(403===a.code&&!arcgisonline.sharing.util.checkSubscriptionStatus(a)||
403===a.code&&!1===esriGeowConfig.isMultiTenant&&-1<b.indexOf(["COM_0056","COM_0057"],a.messageCode))){esriGeowConfig.userInfo=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});b.cookie("esri_auth",null,{expires:-1,path:"/",domain:".arcgis.com"});b.cookie("esri_auth",null,{expires:-1,path:"/",domain:".esri.com"});arcgisonline.sharing.util&&arcgisonline.sharing.util._cookies&&arcgisonline.sharing.util._cookies.esri_auth&&delete arcgisonline.sharing.util._cookies.esri_auth;
c="";-1==esriGeowConfig.signin.indexOf("http")&&(c=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(c=c.replace("http:","https:")));c+=esriGeowConfig.signin;d="";e=c+("?error\x3d"+a.code);var f=b.queryToObject(window.location.search.slice(1)).returnUrl;0>window.location.href.indexOf(e)?-1<window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&arcgisonline.map&&arcgisonline.map.main&&arcgisonline.map.main.map&&arcgisonline.map.main.mapInitialized?(arcgisonline.map.storage.saveMapInCookie(null,
!1),d="\x26returnUrl\x3d"+encodeURIComponent(esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?useExisting\x3d1")):d="\x26returnUrl\x3d"+encodeURIComponent(f?f:window.location):f&&(d="\x26returnUrl\x3d"+encodeURIComponent(f));e+=d;0>window.location.href.indexOf(e)?window.location=e:"User not part of this account"===a.message&&(window.location=c+"?error\x3d400"+d)}}else e&&e(a,c)},checkSubscriptionStatus:function(a){return-1!==b.indexOf(["SB_0001","SB_0002","SB_0003","SB_0004"],a.messageCode)?
(arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().show(esriGeowConfig.self.subscriptionInfo),!1):-1!==b.indexOf(["SB_0005","SB_0006","SB_0007"],a.messageCode)?(arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance().showOther(a.messageCode),!1):!0},isValidSubscriptionState:function(){var a=esriGeowConfig.self.subscriptionInfo,b=["cancelled","expired","suspended","restricted"];return!a||-1===b.indexOf(a.state)},checkError:function(a){var c;
return-1!==b.indexOf("COM_0044 COM_0047 CONT_0046 CONT_0047 COM_1043 COM_1044 COM_1045 COM_1046".split(" "),a.messageCode)?(a=(c=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common))&&c.errors&&c.errors[a.messageCode]?{message:c.errors[a.messageCode]}:a,a=b.mixin(b.mixin({},c.errors.genericError),a),esriGeowConfig.hideDefaultCheckErrorMessage||(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.show(a)),!1):!0},handler:function(a,b,d,e,f){a.error&&
""!==a.error?arcgisonline.sharing.util.errorHandler(a.error,b,d,f):e&&e(a,b)},getJson:function(a,b,d){return arcgisonline.sharing.util._requestWithAppHandlers({url:a},{},b,d)},getJsonWithContent:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:a,content:b},{},d,e)},postJson:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:b,content:a},{usePost:!0},d,e)},postJsonCheckProxy:function(a,b,d,e){return"http:"===window.location.protocol&&-1<b.indexOf("https://")?
arcgisonline.sharing.util._requestWithAppHandlers({url:b,content:a},{usePost:!0,useProxy:!0},d,e):arcgisonline.sharing.util._requestWithAppHandlers({url:b,content:a},{usePost:!0},d,e)},postForm:function(a,b,d,e){return arcgisonline.sharing.util._requestWithAppHandlers({url:b,form:a},{usePost:!0},d,e)},_requestWithAppHandlers:function(a,b,d,e){var c=arcgisonline.sharing.util.request(a,b);c.then(function(b,f){arcgisonline.sharing.util.handler(b||{},c.ioArgs,a.url,d,e);return b},function(b,d){arcgisonline.sharing.util.errorHandler(b||
{},c.ioArgs,a.url,e);throw b;});return c},request:function(a,c){var d=a.url,e=a.content||{},f=arcgisonline.sharing.util.getToken(),g;c=c||{};var l=arcgisonline.sharing.util.urlToObject(d).query||{};e.f||l.f||(e=b.mixin(e,{f:"json"}));f&&!e.token&&!1!==c.addToken?esri.isDefined(esriGeowConfig.isMultiTenant)&&!1===esriGeowConfig.isMultiTenant&&esriGeowConfig.searchArcGISOnlineEnabled&&"www.arcgis.com"===arcgisonline.sharing.util.getFullDomain(a.url)||(e.token=f):!1===c.addToken&&delete e.token;a=b.mixin({},
{url:!1===c.addSSL?d:arcgisonline.sharing.util.useSSL(d),content:e,form:a.form,callbackParamName:a.form?a.callbackParamName||null:a.callbackParamName||"callback",timeout:c&&c.timeout||0});g=esri.request(a,c);g.addErrback(function(a){"IdentityManagerBase.1"===a.code&&(a.code=a.httpCode);arcgisonline.sharing.util.checkSoftwareAuthError(a,g);arcgisonline.sharing.util.checkSubscriptionStatus(a)||(g.canceled=!0);arcgisonline.sharing.util.isUnlicensed(a)&&(g.canceled=!0,-1===window.location.href.indexOf("unlicensed.html")&&
(window.location=esriGeowConfig.baseUrl+"unlicensed.html"));arcgisonline.sharing.util.isInsufficientLevel(a)&&(g.canceled=!0,-1===window.location.href.indexOf("unlicensed.html")&&(window.location=esriGeowConfig.baseUrl+"unlicensed.html#insufficient_level"));arcgisonline.sharing.util.isExpiredLicense(a)&&(g.canceled=!0,-1===window.location.href.indexOf("unlicensed.html")&&(window.location=esriGeowConfig.baseUrl+"unlicensed.html#expired_license"));arcgisonline.sharing.util.isOldLicense(a)&&(g.canceled=
!0,-1===window.location.href.indexOf("unlicensed.html")&&(window.location=esriGeowConfig.baseUrl+"unlicensed.html#old_license"));arcgisonline.sharing.util.isInvalidUser(a)&&(g.canceled=!0,arcgisonline.sharing.geow.Geow.signout(esriGeowConfig.baseUrl+"index.html"));arcgisonline.sharing.util.checkError(a)||(g.canceled=!0);throw a;});return g},_fetchItemData:function(a,c){var d=this.getUser(),e=this.getItemDataPath(a);"admin"===a.itemControl||d&&d.email===a.owner?this.openPage(c,!0):this._canAccessUrl(e).then(b.hitch(this,
function(){this.openPage(c,!0)}),b.hitch(this,function(a){a&&403===a.status?this._showError({title:this.i18n.viewer.error.noPermissionTitle,message:this.i18n.errorWidget.accessDeniedResource}):this.openPage(c,!0)}))},_canAccessUrl:function(a){var c=new b.Deferred;b.xhr("HEAD",{url:a,handleAs:"text",headers:{"X-Requested-With":null},withCredentials:this.isPortal()?!0:!1}).then(function(a){c.resolve(!0)},function(a){c.reject(a)});return c},_showError:function(a){var c=new arcgisonline.sharing.dijit.dialog.ConfirmDialog({showCancel:!1,
style:{width:"375px",height:"auto"}}),d=a||{};d.code=a.code||0;d=b.mixin({},this.i18n.common.errors.genericError,this.i18n.common.errors[a.code]||a);c.show(d).then(b.hitch(this,function(){c.hide()}))},checkSoftwareAuthError:function(a,c){var d=["COM_0056","COM_0057"];!1===esriGeowConfig.isMultiTenant&&a.code&&403===a.code&&a.messageCode&&-1!==b.indexOf(d,a.messageCode)&&-1===window.location.href.indexOf("error.html")&&(c.canceled=!0,"COM_0056"===a.messageCode?window.location=esriGeowConfig.baseUrl+
"error.html?c\x3dPortalCreateAccount":"COM_0057"===a.messageCode&&(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dPortalSignIn"))},isExpiredLicense:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&503===a.code&&a.messageCode&&"GWM_0006"===a.messageCode},isInsufficientLevel:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&503===a.code&&a.messageCode&&"GWM_0012"===a.messageCode},isUnlicensed:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&503===a.code&&
a.messageCode&&"GWM_0013"===a.messageCode},isOldLicense:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&503===a.code&&a.messageCode&&"GWM_0014"===a.messageCode},isInvalidUser:function(a){return!1===esriGeowConfig.isMultiTenant&&a.code&&404===a.code&&a.messageCode&&"POR_205244"===a.messageCode},isNode:function(a){return"object"===typeof Node?a instanceof Node:a&&"object"===typeof a&&"number"===typeof a.nodeType&&"string"===typeof a.nodeName},isElement:function(a){return"object"===typeof HTMLElement?
a instanceof HTMLElement:a&&"object"===typeof a&&1===a.nodeType&&"string"===typeof a.nodeName},isHostedService:function(a){if(!a)return!1;var c=(new b._Url(esriGeowConfig.restBaseUrl)).authority,d=!1===esriGeowConfig.isMultiTenant,e=-1!==a.indexOf(".arcgis.com/"),f=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");a=esri.isDefined(esriGeowConfig.self)&&esriGeowConfig.self.supportsHostedServices&&-1!==a.indexOf(c)&&!d;return e&&f||!e&&a},isHostedServiceItem:function(a){return arcgisonline.sharing.util.isHostedService(a.item)||
arcgisonline.sharing.util.isHostedService(a.url)},isHostedTemplateItem:function(a){var b;a=a?a.split("?")[0]:"";b=a.match(/http.+(arcgis.com\/apps)\/?/ig);a=a.match(/http.+(opendata)\/?/ig);return b&&b.length&&!a?!0:!1},isAgolService:function(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1},supportsHttps:function(a){if(!a)return!1;var c=!1;b.forEach(esriGeowConfig.httpsDomains,function(b){if(-1<a.indexOf("."+b+"/")||-1<a.indexOf("/"+b+"/"))c=
!0});if(!c){var d=esriGeowConfig.self.portalHostname;-1<d.indexOf("/")&&(d=d.substring(0,d.indexOf("/")));-1<a.indexOf(d)&&(c=!0)}return c},isArcGISServer:function(a){var b=/http.+\/(arcgis\/rest\/services|arcgis\/services)\/?/ig,d=/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer)).*/ig;return(a=(a=a&&a.split("?")[0])&&a.replace(b,"").match(d))&&a.length?a[0].split("/")[1]:null},getStaticImagesUrl:function(){var a=esriGeowConfig.staticImagesUrl||
esriGeowConfig.self&&esriGeowConfig.self.staticImagesUrl;return(esriGeowConfig.allSSL||"https:"===location.protocol)&&a?a.replace("http:","https:"):a},getRedSphereUrl:function(){return arcgisonline.sharing.util.getStaticImagesUrl()+"/Symbols/Basic/RedSphere.png"},doNothing:function(){},parseUrl:function(a){var b=document.createElement("a");b.href=a;for(var d=b.protocol.replace(":",""),e=b.hostname||window.location.host,f=b.port,g=b.search,l={},m=b.search.replace(/^\?/,"").split("\x26"),k=m.length,
h=0,t;h<k;h++)m[h]&&(t=m[h].split("\x3d"),l[t[0]]=t[1]);return{source:a,protocol:d,host:e,port:f,query:g,params:l,file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}},getAbsoluteUrl:function(a){var b;return a?(b||(b=document.createElement("a")),b.href=a,b.href):a},ellipse:function(a,b){a&&a.length>b&&0<b-4&&(a=a.substring(0,
b-4)+"...");return a},appendTags:function(a,c){var d=a.get("value");c=d?c.split(",").concat(d.split(",")):c.split(",");a.set("value",arcgisonline.sharing.util.getUniqueArray(c).join(","));b.style(a.domNode,"color","#000000")},getUniqueArray:function(a){var c={};return b.filter(a,function(a){return c[a]?!1:c[a]=!0})},relativeToExplicitUrl:function(a){esriGeowConfig.cdnServerUrl=b.baseUrl.substring(0,b.baseUrl.indexOf("/js/"));return esriGeowConfig.cdnServerUrl.lastIndexOf("/")===esriGeowConfig.cdnServerUrl.length-
1?esriGeowConfig.cdnServerUrl+a:esriGeowConfig.cdnServerUrl+"/"+a},getCookie:function(a){var c=this._cookies&&this._cookies[a]||null;c||((c=(c=b.cookie(a))?b.json.parse(c):-1)&&c.role&&(c.role=c.role?c.role.replace("org_","account_"):c.role),c&&(this._cookies||(this._cookies={}),this._cookies[a]=c));return-1===c||esriGeowConfig.ignoreCookie?null:c},canSharePublic:function(){return!esriGeowConfig.self||!0!==esriGeowConfig.self.canSharePublic&&!1!==esriGeowConfig.self.canSharePublic?!0:esriGeowConfig.self.canSharePublic},
getSecureUrl:function(a){a||(a=esriGeowConfig.baseUrl);return esriGeowConfig.self&&esriGeowConfig.self.portalMode&&"singletenant"===esriGeowConfig.self.portalMode&&esriGeowConfig.self.httpsPort?(location.port?(a=a.replace(location.port,esriGeowConfig.self.httpsPort),arcgisonline.sharing.util.isPortal()&&(a=a.replace(esriGeowConfig.self.httpPort,esriGeowConfig.self.httpsPort))):a=a.replace(location.hostname,location.hostname+":"+esriGeowConfig.self.httpsPort),a=a.replace("http:","https:"),arcgisonline.sharing.util.cleanPorts(a)):
a.replace("http:","https:")},htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a},htmlDecode:function(a){return a?a.replace(/&amp;/g,"\x26").replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&quot;/g,'"'):a},getHttpUrl:function(a){a||(a=esriGeowConfig.baseUrl);return esriGeowConfig.self&&esriGeowConfig.self.portalMode&&"singletenant"===esriGeowConfig.self.portalMode&&esriGeowConfig.self.httpPort?(location.port?
(a=a.replace(location.port,esriGeowConfig.self.httpPort),arcgisonline.sharing.util.isPortal()&&(a=a.replace(esriGeowConfig.self.httpsPort,esriGeowConfig.self.httpPort))):a=a.replace(location.hostname,location.hostname+":"+esriGeowConfig.self.httpPort),a=a.replace("https:","http:"),arcgisonline.sharing.util.cleanPorts(a)):a.replace("https:","http:")},cleanPorts:function(a){return a.replace(/\:80\//,"/").replace(/\:443\//,"/")},usePortalSSL:function(){return(!1===esriGeowConfig.isMultiTenant||arcgisonline.sharing.util.isPortal())&&
esriGeowConfig.self&&esriGeowConfig.self.portalHostname&&!esriGeowConfig.self.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.self.httpPort&&443!==esriGeowConfig.self.httpsPort&&"https:"===location.protocol},onAGOLFederatedServer:function(a){for(var b=!1,d=0;d<esriGeowConfig.httpsDomains.length;d++)if(a&&-1<a.indexOf(esriGeowConfig.httpsDomains[d])){b=!0;break}return b},onFederatedServer:function(a){var c=!1,d=!1;a&&0<a.length&&esriGeowConfig.federatedServers&&0<esriGeowConfig.federatedServers.length&&
(c=b.some(esriGeowConfig.federatedServers,b.hitch(this,function(b){var c=-1<a.indexOf(":6080")?a.replace("http:","https:").replace(":6080",":6443"):a,e=b.url?arcgisonline.sharing.util.getUrlWithoutScheme(b.url):b.url,l=b.adminUrl?arcgisonline.sharing.util.getUrlWithoutScheme(b.adminUrl):b.adminUrl,e=-1<e.indexOf(":")?b.url:e,l=-1<l.indexOf(":")?b.adminUrl:l;d=c!==a;return-1<a.indexOf(e)||-1<a.indexOf(l)||d&&(-1<c.indexOf(e)||-1<c.indexOf(l))})));return c},getUrlWithoutScheme:function(a){if(esri.isDefined(a)){if(0===
a.indexOf("http://"))return a.substring(7);if(0===a.indexOf("https://"))return a.substring(8)}return a},isPortal:function(){return esri.isDefined(esriGeowConfig.self)&&esriGeowConfig.self.isPortal},portalSupportsHostedServices:function(){return arcgisonline.sharing.util.isPortal()&&esriGeowConfig.self.supportsHostedServices},getHomeAppContext:function(){if(arcgisonline.sharing.util.isPortal()){var a=window.location.pathname,b=a.indexOf("/home");if(0<b)return a.substring(0,b)}return""},normalizeOrgRole:function(a){return a?
a.replace("org_","account_"):a},checkForIAA:function(){var a=new b.Deferred,c=!!esriGeowConfig.isDebug,d=arcgisonline.sharing.util.getPortalAdminBaseUrl(),e=arcgisonline.sharing.util.getUser();b.xhrGet({url:d,handleAs:"json",content:{f:"json",ts:(new Date).getTime()}}).then(b.hitch(this,function(b){b&&b.status&&"error"===b.status&&b.code&&503===b.code?a.resolve({hasIAA:!0,error:b}):b&&(!b.error&&!e||b.error&&b.error.code&&(!e&&499!==b.error.code&&498!==b.error.code||e&&498!==b.error.code))?-1===window.location.href.indexOf("createadmin.html")?
window.location=arcgisonline.sharing.util.getSecureUrl("https://"+esriGeowConfig.self.portalHostname+"/home/createadmin.html"):a.resolve({hasIAA:!1}):a.resolve({hasIAA:!0})}),b.hitch(this,function(b){!c&&(b.status&&499!==b.status||b&&(!b.error&&!e||b.error&&b.error.code&&(!e&&499!==b.error.code&&498!==b.error.code||e&&498!==b.error.code)))?-1===window.location.href.indexOf("createadmin.html")?window.location=arcgisonline.sharing.util.getSecureUrl("https://"+esriGeowConfig.self.portalHostname+"/home/createadmin.html"):
a.resolve({hasIAA:!1}):a.resolve({hasIAA:!0,error:b})}));return a},getBridgeUrl:function(a,b){a=esriGeowConfig.bridgeUrl+"?url\x3d"+encodeURIComponent(a);return b.expires?a+"\x26exp\x3d"+Math.ceil((new Date(b.expires)-new Date)/1E3):a},getUserDisplayName:function(a){var b=a&&a.fullName||"";a=a.firstName||b;-1<b.indexOf("_")?a=b.split("_")[0]:-1<b.indexOf(",")?a=b.split(",").slice(1).join(" "):-1<b.indexOf(" ")&&(a=b.split(" ")[0]);return a.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g,
" ")},isProApp:function(a){return a&&"ArcGIS Pro"===a.title&&"esri_apps"===a.owner&&a.tags&&-1<b.indexOf(a.tags,"pro")},findProListing:function(){var a=new b.Deferred,c=!1,d=!1,e;arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"portals/self/purchases"}).then(b.hitch(this,function(f){f.purchases?(b.forEach(f.purchases,b.hitch(this,function(a){!d&&a.listing&&"ArcGIS Pro"===a.listing.title&&"esri_apps"===a.listing.owner&&"licenseByUser"===a.listing.licenseBy&&(c=b.some(a.listing.tags,
b.hitch(this,function(a){return a&&"pro"===a.toLowerCase()})))&&(e=a,d=!0)})),a.resolve(d?e:null)):a.resolve(null)}),b.hitch(this,function(b){a.reject(b)}));return a},findLicenseByUserProducts:function(){var a=new b.Deferred,c=esriGeowConfig.restBaseUrl+"portals/self/purchases",d=!1,e=!1,f={pro:null,products:null};this.isPortal();var g=b.hitch(this,function(a){if(a.listing&&"licenseByUser"===a.listing.licenseBy)if(d=!0,"ArcGIS Pro"===a.listing.title&&"esri_apps"===a.listing.owner){if(e=b.some(a.listing.tags,
b.hitch(this,function(a){return a&&"pro"===a.toLowerCase()})))f.pro=a}else a&&a.provision&&(f.products?f.products.push(a):f.products=[a])});arcgisonline.sharing.util.request({url:c}).then(b.hitch(this,function(c){c.purchases||c.trials?(c.purchases&&b.forEach(c.purchases,g),c.trials&&b.forEach(c.trials,g),a.resolve(d?f:null)):a.resolve(null)}),b.hitch(this,function(b){a.reject(b)}));return a},isEsriWorldGeocoder:function(a){var b=arcgisonline.sharing.util.isEsriWorldGeocoderNoProxy(a);a=arcgisonline.sharing.util.isEsriWorldGeocoderThroughProxy(a);
return b||a},isEsriWorldGeocoderNoProxy:function(a){return(a=a.url||"")&&!!a.match(/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig)},isEsriWorldGeocoderThroughProxy:function(a){var b=a.url||"";return a.isAGOWorldLocator||b&&!!b.match(/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig)},filterBatchGeocoders:function(a,c){return b.filter(a,b.hitch(this,function(a){var b=arcgisonline.sharing.util.isEsriWorldGeocoderNoProxy(a),d=arcgisonline.sharing.util.isEsriWorldGeocoderThroughProxy(a);
if(b||d)esri.isDefined(a.name)?"Esri World Geocoder"===a.name&&(a.name=esri.i18nBundle.common.esriWorldGeocoder):a.name=esri.i18nBundle.common.esriWorldGeocoder;return b&&(arcgisonline.sharing.util.isPortal()||c)?!1:esri.isDefined(a.batch)?!!a.batch:b||d}))},filterNonWorldGeocoders:function(a){return b.filter(a,b.hitch(this,function(a){var b=arcgisonline.sharing.util.isEsriWorldGeocoderNoProxy(a),c=arcgisonline.sharing.util.isEsriWorldGeocoderThroughProxy(a);return!b&&!c&&a.url}))},downloadWebMappingApp:function(a){var c=
"Mobile Application"!==a.type?"WMA2Code":"MobileApp2Code",d=esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/relatedItems",c=a.relatedItems||arcgisonline.sharing.util.request({url:d,content:{relationshipType:c}}).then(b.hitch(this,function(b){a.relatedItems=b&&b.relatedItems||[];return a.relatedItems}));return b.when(c,b.hitch(this,function(a){var c=a||[],d,e=b.filter(c,function(a){return a&&null!==a.url});a=e&&e.length?e[0]:c&&0<c.length?c[0]:a;a.id&&(d=a.url||arcgisonline.sharing.util.getItemDataPath(a));
a.url?window.open(d):window.location=d;h.byId("share-map-stack")&&h.byId("share-map-stack").selectChild(h.byId("share-map-application-help"))}),b.hitch(this,function(a){}))},loadUserTags:function(a){var c=new b.Deferred;a?arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"community/users/"+a+"/tags",content:{ts:(new Date).getTime()}}).then(b.hitch(this,function(a){var b=[];a&&a.tags&&(b=a.tags);c.resolve(b)}),b.hitch(this,function(a){c.resolve([])})):c.resolve([]);return c},loadUserProperties:function(a){return arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"community/users/"+a+"/properties"})},isValidEmailAddress:function(a){var b=/(?:[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9](?:[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9-]*[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9])?\.)+[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9](?:[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9-]*[\u00A0-\uD7FF\uE000-\uFFFF-a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/ig;
return!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(a)&&b.test(a)?!0:!1},groupUsedInOrgSettings:function(a){return(a=a?"id:"+a:null)&&esriGeowConfig.self&&(esriGeowConfig.self.basemapGalleryGroupQuery&&-1<esriGeowConfig.self.basemapGalleryGroupQuery.indexOf(a)||esriGeowConfig.self.colorSetsGroupQuery&&-1<esriGeowConfig.self.colorSetsGroupQuery.indexOf(a)||esriGeowConfig.self.featuredGroupsId&&-1<esriGeowConfig.self.featuredGroupsId.indexOf(a)||esriGeowConfig.self.featuredItemsGroupQuery&&-1<esriGeowConfig.self.featuredItemsGroupQuery.indexOf(a)||
esriGeowConfig.self.galleryTemplatesGroupQuery&&-1<esriGeowConfig.self.galleryTemplatesGroupQuery.indexOf(a)||esriGeowConfig.self.homePageFeaturedContent&&-1<esriGeowConfig.self.homePageFeaturedContent.indexOf(a)||esriGeowConfig.self.layerTemplatesGroupQuery&&-1<esriGeowConfig.self.layerTemplatesGroupQuery.indexOf(a)||esriGeowConfig.self.livingAtlasGroupQuery&&-1<esriGeowConfig.self.livingAtlasGroupQuery.indexOf(a)||esriGeowConfig.self.stylesGroupQuery&&-1<esriGeowConfig.self.stylesGroupQuery.indexOf(a)||
esriGeowConfig.self.symbolSetsGroupQuery&&-1<esriGeowConfig.self.symbolSetsGroupQuery.indexOf(a)||esriGeowConfig.self.templatesGroupQuery&&-1<esriGeowConfig.self.templatesGroupQuery.indexOf(a)||esriGeowConfig.self.analysisLayersGroupQuery&&-1<esriGeowConfig.self.analysisLayersGroupQuery.indexOf(a))},canShowSocialMediaLinks:function(){return esriGeowConfig.showSocialMediaLinks&&arcgisonline.sharing.util.canSharePublic()&&(!esriGeowConfig.userRole||!esriGeowConfig.self||esriGeowConfig.userRole&&esriGeowConfig.self&&
(!esriGeowConfig.self.portalProperties||esriGeowConfig.self.portalProperties&&(!esri.isDefined(esriGeowConfig.self.portalProperties.showSocialMediaLinks)||!0===esriGeowConfig.self.portalProperties.showSocialMediaLinks)))},getPortalAdminBaseUrl:function(){return arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.portalAdminBaseUrl)},getLevelSpan:function(a,b){return'\x3cspan class\x3d"license-level-badge" aria-label\x3d"'+a+" "+b+'"\x3e'+b+"\x3c/span\x3e"},getLevelSpanProperties:function(a,b){return{"class":"license-level-badge",
innerHTML:b,"aria-label":a+" "+b}},createLevelSpan:function(a,c,d,e){return b.create("span",b.mixin(arcgisonline.sharing.util.getLevelSpanProperties(a,c),e||{}),d)},createLevelSpanAndPlace:function(a,c,d,e,f){return b.create("span",b.mixin(arcgisonline.sharing.util.getLevelSpanProperties(a,c),e||{}),d,f)},retrievePortalAdminGuideHelpMap:function(){var a=window.dojoConfig.locale||"en",a="en-us"===a?"en":a,a=esriGeowConfig.self?esriGeowConfig.self.helpBase.replace("/website/","/admin/"):esriGeowConfig.baseUrl.replace("/home",
"/portalhelp")+a+"/admin/help/";return esri.request({url:a+"cxhelp.js"})},getFullDomain:function(a){a=a.match(/:\/\/([0-9]?\.)?(.[^/:]+)/i);return null!=a&&2<a.length&&"string"===typeof a[2]&&0<a[2].length?a[2]:null},isValidOnlineReturnUrl:function(a){var b=decodeURI(a),d=arcgisonline.sharing.util.parseUrl(window.location.href);a=arcgisonline.sharing.util.parseUrl(b);var e=(b=0===b.indexOf("http://")||0===b.indexOf("https://"))&&a.host?a.host.lastIndexOf(".arcgis.com"):-1,f=b&&a.host?a.host.lastIndexOf(".esri.com"):
-1,g=b&&a.host?a.host.lastIndexOf(d.host):-1,e=-1<e&&e+11-1===a.host.length-1,f=-1<f&&f+9-1===a.host.length-1,d=-1<g&&g+d.host.length-1===a.host.length-1;return b&&a.host&&(e||f||d)?!0:!1},isValidPortalReturnUrl:function(a){a=decodeURI(a);var b=arcgisonline.sharing.util.parseUrl(window.location.href),d=arcgisonline.sharing.util.parseUrl(a);return 0===a.indexOf("http://")&&0===a.indexOf("https://")||!d.host||-1!==d.host.indexOf(b.host)?!0:!1},isSameUrl:function(a,b,d){var c=a,f=b;d&&a&&b&&(c=a.substring(a.indexOf("://")+
3),f=b.substring(b.indexOf("://")+3));return c===f},overrideDojoAriaLabel:function(a,c){a&&(b.attr(a,"aria-label",c),a.removeAttribute("aria-labelledby"))},getStepProgressIndicatorProperties:function(a,b){return{"class":"stepProgressBar stepProgressBar--"+b+"-steps",innerHTML:'\x3cdiv class\x3d"stepProgressBar__value" style\x3d"width: '+Math.floor(a/b*100)+'%;"\x3e\x3c/div\x3e',"aria-hidden":"true"}},createStepProgressIndicatorAndPlace:function(a,c,d,e){d=b.create("div",{"class":"progressBarContainer"},
d,e);b.create("div",b.mixin(arcgisonline.sharing.util.getStepProgressIndicatorProperties(a,c)),d,"first");b.place('\x3cspan class\x3d"stepLabel"\x3e'+esri.i18nBundle.common.steppedProgress.step+"  "+a+"  "+esri.i18nBundle.common.steppedProgress.of+" "+c+"\x3c/span\x3e",d,"last");return d},clearProgressBars:function(){b.query(".progressBarContainer").forEach(function(a){b.destroy(a)})},isServiceProxyGeocoder:function(a){var b=(a||"").toLowerCase();a=-1<b.indexOf("/geocodeserver")&&-1<b.indexOf("/servers/")&&
-1<b.indexOf("/rest/services/");var d=arcgisonline.sharing.util.isPortal()&&-1<b.indexOf(esriGeowConfig.self.portalHostname),b=!arcgisonline.sharing.util.isPortal()&&b.indexOf("utility")&&-1<b.indexOf(".arcgis.com");return a&&(d||b)},applyChrome62ButtonRepaintFix:function(a){61<b.has("chrome")&&a&&(b.style(a,"display","none"),setTimeout(function(){b.style(a,"display","")},1))}}})},"arcgisonline/sharing/dijit/dialog/GeneralDlg":function(){define("require esri/declare esri/Evented dojo/_base/lang dijit/Dialog dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/query dojo/dom-style dojo/dom-attr dojo/on dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/GeneralDlg.html".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t){var p=h("arcgisonline.sharing.dijit.dialog.GeneralDlg",[d,e,f,k],{baseClass:"esriThumbnailDlg",templateString:t,widgetsInTemplate:!0,onCancel:function(){},onHide:function(){},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.mixin({},q.common,q.generalDlg)},postCreate:function(){this.loadConnections()},show:function(a){this.clear();this.setTitle(a.title);this.setMessage(a.message);this.setContent(a.content);this.key=a.key;a.hideTitleBar&&l.set(g(".dijitDialogTitleBar")[0],
"display","none");a.error&&g("#general-dialog-content").addClass("error");this._dialog.show()},showWide:function(a){l.set(this._dialog,"width","700px");this.show(a)},destroy:function(){this.inherited(arguments);p.prototype.statics._instance&&(p.prototype.statics._instance=null)},clear:function(){this.setTitle("");g("#general-dialog-content").attr("innerHTML","");g("#general-dialog-content").removeClass("error")},loadConnections:function(){g(".jevent").on("click",function(a){a.preventDefault()});g("#general-dialog .dijitDialogTitleBar .dijitDialogCloseIcon").forEach(a.hitch(this,
function(a){m.set(a,"title",this.i18n.close)}));var b=this._dialog;this.own(n(b,"cancel",a.hitch(this,function(a){a&&a instanceof Event&&a.preventDefault();this.onCancel()})),n(b,"hide",a.hitch(this,function(a){a&&a instanceof Event&&a.preventDefault();this.onHide()})))},setTitle:function(a){a&&this._dialog.set("title",a)},setMessage:function(a){a&&g("#general-dialog-content").attr("innerHTML","\x3cp style\x3d'word-wrap:break-word;'\x3e"+a+"\x3c/p\x3e")},setContent:function(a){a&&g("#general-dialog-content").attr("innerHTML",
a)},hide:function(){this._dialog.hide()},onOkClick:function(a){this._dialog.hide()}});p.prototype.statics={getInstance:function(){this._instance||(this._instance=new p);return this._instance}};return p})},"esri/declare":function(){define(["dojo/_base/declare","dojo/_base/lang","./extend"],function(b,h,k){return function(a,c,d){var e=h.isString(a);e?d.declaredClass=a:(d=c,c=a);c=b(c,d);e&&k(a,c);return c}})},"esri/extend":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(b,h,k){return function(a,
c){a=a.substring(a.indexOf(".")+1);b.setObject(a,c,k)}})},"arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/Button,arcgisonline/sharing/util"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg",
[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"subscription-status-dialog" dojoAttachPoint\x3d"subscriptionStatusDlg" title\x3d"" execute\x3d""\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"subscriptionStateDiv"\x3e\x3c/div\x3e\r\n    \x3cbr/\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"actionNeededDiv"\x3e\x3c/div\x3e\r\n    \x3cbr/\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cbutton dojoAttachPoint\x3d"closeButton" dojoAttachEvent\x3d"onClick:onOkClick" class\x3d"jevent primary" dojoType\x3d"dijit.form.Button"\x3e${i18n.ok}\x3c/button\x3e\x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
util:arcgisonline.sharing.util,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg);return this._instance}},subscriptionStatusDlg:null,subscriptionStateDiv:null,actionNeededDiv:null,closeButton:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").subscriptionStatusDlg)},
postCreate:function(){this.loadConnections()},show:function(a){this.clear();this.setSubscriptionState(a);"restricted"!==a.state.toLowerCase()&&this.setActionMessage(a);this.subscriptionStatusDlg.show()},showOther:function(a){this.clear();this.setOtherSubscriptionStatus(a);b.style(this.actionNeededDiv,"display","none");this.subscriptionStatusDlg.show()},setSubscriptionState:function(a){if(a&&a.state){var c=this.i18n.subscriptionStatusExpiredMsg;a=a.state.toLowerCase();"expired"===a?c=this.i18n.subscriptionStatusExpiredMsg:
"cancelled"===a?c=this.i18n.subscriptionStatusCancelledMsg:"suspended"===a?c=this.i18n.subscriptionStatusSuspendedMsg:"restricted"===a&&(esriGeowConfig.helpBase&&esriGeowConfig.helpMap?(c=esriGeowConfig.helpBase,c+=esriGeowConfig.helpMap["120001308"]?esriGeowConfig.helpMap["120001308"]:"",c=esri.substitute({linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+c+"' target\x3d'_blank'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.subscriptionStatusRestrictedMsg)):c=this.i18n.subscriptionStatusRestrictedMsgNoLink);
b.attr(this.subscriptionStateDiv,"innerHTML",c)}},setOtherSubscriptionStatus:function(a){this.subscriptionStatusDlg.set("title",this.i18n.errorTitle);var c=this.i18n.expiredStatus;a&&("SB_0005"===a?c=this.i18n.suspendedStatus:"SB_0006"===a?c=this.i18n.cancelledStatus:"SB_0007"===a&&(c=this.i18n.expiredStatus));a=esri.substitute({subscriptionState:c},this.i18n.otherSubscriptionStatusMsg);b.attr(this.subscriptionStateDiv,"innerHTML",a)},setActionMessage:function(a){var c=arcgisonline.sharing.util.getUser();
c&&c.role&&"account_admin"===c.role?(c=(a.type||"").toLowerCase(),a=a.state.toLowerCase(),c=esri.substitute({buttonLabel:"trial"===c||"trial press"===c||"evaluation"===c?this.i18n.manageSubscriptionLabel:this.i18n.upgradeSubscriptionLabel},this.i18n.adminActionMsg),"suspended"===a&&(c=this.i18n.pleaseContactCS),b.attr(this.actionNeededDiv,"innerHTML",c)):b.attr(this.actionNeededDiv,"innerHTML",this.i18n.nonAdminActionMsg)},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});
b.connect(this.subscriptionStatusDlg,"onCancel",b.hitch(this,function(a){this.onCancel(a)}));b.connect(this.subscriptionStatusDlg,"hide",b.hitch(this,function(a){this.onHide(a)}))},clear:function(){this.subscriptionStatusDlg.set("title",this.i18n.subscriptionStatusTitle);b.attr(this.subscriptionStateDiv,"innerHTML","");b.attr(this.actionNeededDiv,"innerHTML","");b.style(this.actionNeededDiv,"display","")},hide:function(){this.subscriptionStatusDlg.hide()},onOkClick:function(a){h.byId("subscription-status-dialog").hide()},
onCancel:function(){},onHide:function(){}})})},"arcgisonline/sharing/dijit/dialog/ConfirmDialog":function(){define(["dojo/_base/declare","dijit/Dialog","./_ConfirmDialogMixin"],function(b,h,k){return b("arcgisonline/sharing/dijit/dialog/ConfirmDialog",[h,k],{})})},"arcgisonline/sharing/dijit/dialog/_ConfirmDialogMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/query dojo/topic dojo/keys dijit/_WidgetsInTemplateMixin dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!./templates/actionBar.html dijit/form/Button".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t){return b("arcgisonline/sharing/dijit/dialog/_ConfirmDialogMixin",n,{actionBarTemplate:t,buttonOkLabel:q.common.ok,_setButtonOkLabelAttr:function(a){this.okButton.set("label",a)},buttonCancelLabel:q.common.cancel,_setButtonCancelLabelAttr:function(a){this.cancelButton.set("label",a)},busyMessage:q.common.pleaseWait,_setBusyMessageAttr:{node:"busyMessageSpan",attribute:"innerHTML"},_setShowCancelAttr:function(a){e.set(this.cancelButton.domNode,"display",a?"":"none")},
_setHelpLinkInfoAttr:function(a){var b=g(".dijitDialogTitle",this.domNode).shift();d.create("a",{className:"icon-ui-question margin-left-half font-size--1",title:a.title,href:a.url||"#",target:"_blank"},b)},onOk:function(){},onCancel:function(){},onHide:function(){},show:function(b){var e=new k;b&&b.message&&(this._messageNode||(this._messageNode=d.create("p",{innerHTML:b,"class":"esriMessageNode trailer-0"},g(".dijitDialogPaneContent",this.domNode)[0],"first")),this.set("title",b.title||""),c.set(this._messageNode,
"innerHTML",b.message||""));this.own(a(this,"hide",h.hitch(this,function(a){e.isResolved()||e.resolve("onCancel");this.destroyRecursive()})),a(this.okButton,"click",h.hitch(this,function(a){a.preventDefault();l.publish("/dlg/onOk");e.isResolved()||e.resolve("onOk");this.onOk()})),a(this.cancelButton,"click",h.hitch(this,function(a){a.preventDefault();l.publish("/dlg/onCancel");e.isResolved()||e.resolve("onCancel");this.onCancel();this.hide()})),a(this.domNode,"keypress",h.hitch(this,function(a){if(a&&
a.keyCode===m.ENTER)this.okButton.onClick(a)})),l.subscribe("/dlg/busyMessage",h.hitch(this,function(a){this.set("busyMessage",a)})),l.subscribe("/esri/disable",h.hitch(this,function(a,b){this.set("busyMessage",b||this.busyMessage||q.common.pleaseWait);this.set("disabled",a)})));this.inherited(arguments);return e},_setDisabledAttr:function(a){g(".dijitButton",this.actionBarNode).map(dijit.byNode).forEach(function(b){b.set("disabled",a)});dojo[a?"removeClass":"addClass"](this.busyMessageSpan,"hide")}})})},
"arcgisonline/esriGeowConfig":function(){define([],function(){return window.esriGeowConfig||{}})},"arcgisonline/sharing/geow/Folder":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util"],function(b,h,k){b.provide("arcgisonline.sharing.geow.Folder");b.require("arcgisonline.sharing.util");arcgisonline.sharing.geow.Folder={util:arcgisonline.sharing.util,createFolder:function(a,b,d){var c=this.util.getUser();return(c=c&&(c.username||c.email))?this.createFolderByUser(c,a,
b,d):null},createFolderByUser:function(a,c,d,e){this.util.getUser()&&this.util.request({url:esriGeowConfig.restBaseUrl+"content/users/"+a+"/createFolder",content:c},{usePost:!0}).then(b.hitch(this,function(b){this._userFolders&&this._userFolders[a]&&(this._userFolders[a]=null);d(b)}),b.hitch(this,function(a){e(a)}))},deleteFolder:function(a,b,d){var c=this.util.getUser();return(c=c&&(c.username||c.email))?this.deleteFolderByUser(c,a,b,d):null},deleteFolderByUser:function(a,c,d,e){c=esriGeowConfig.restBaseUrl+
"content/users/"+a+"/"+c+"/delete";this.util.getUser()&&this.util.request({url:c},{usePost:!0}).then(b.hitch(this,function(b){this._userFolders&&this._userFolders[a]&&(this._userFolders[a]=null);d(b)}),b.hitch(this,function(a){e(a)}))},getFolders:function(a,b,d){var c=this.util.getUser();return(c=c&&(c.username||c.email))?this.getFoldersByUser(c,a,b,d):null},getFoldersByUser:function(a,c,d,e){if(this.util.getUser())if(this._isRequestingFolders)setTimeout(b.hitch(this,"getFoldersByUser",a,c,d,e),75);
else{"function"!==typeof d&&(e=d,d=null);this._userFolders||(this._userFolders={});var f=esriGeowConfig.restBaseUrl+"content/users/"+a;e={num:e?100:1};f=this._userFolders[a]&&this._userFolders[a].folders&&b.clone(this._userFolders[a].folders)||this._fetchAllItems(f,e).then(b.hitch(this,function(c){this._userFolders[a]={folders:c};this._isRequestingFolders=!1;return b.clone(c)}),b.hitch(this,function(a){throw a;}));this._isRequestingFolders=!this._userFolders[a]||!this._userFolders[a].folders;b.when(f,
c,d)}},_fetchAllItems:function(a,c){var d={};return this._fetchItems(a,c,d).then(b.hitch(this,function(e){if(1<c.num&&e.total>c.num){var f=Math.ceil(e.total/c.num),g=e.nextStart,l=[];e&&1===e.start?d=e:d.items=d.items.concat(e.items);for(var m=0;m<f-1;m++)l.push(this._fetchItems(a,b.mixin(c,{start:g}),d)),g+=e.num;return b.promise.all(l).then(b.hitch(this,function(a){b.forEach(a,function(a){d.items=d.items.concat(a.items)});return d}))}return e}),b.hitch(this,function(a){throw a;}))},_fetchItems:function(a,
c){return this.util.request({url:a,content:c}).then(b.hitch(this,function(a){return a}),b.hitch(this,function(a){throw a;}))},foldersToStore:function(a){return new b.data.ItemFileReadStore({data:{label:"title",items:[{name:"Anonymous User",children:a}]}})},updateMoveToMenu:function(a,c,d,e,f){b.publish("updateItemToolbar",[{folders:a,folderId:c,folderName:d,onClickHandler:e,customMenuItem:f}])},updateMoveToMenuByUser:function(a,c,d,e,f){b.publish("updateItemToolbar",[{username:a,folders:c,folderId:d,
folderName:e,onClickHandler:f}])}}})},"arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/dom-form dojo/io-query dojo/json dojo/Deferred dojo/promise/all esri/lang arcgisonline/esriGeowConfig arcgisonline/pages/utils/categories arcgisonline/sharing/util esri/geometry/webMercatorUtils esri/geometry/Extent arcgisonline/sharing/dijit/Role dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(b,h,
k,a,c,d,e,f,g,l,m,n,q,t,p,u,w){return{addItem:function(a,b,d,g){var l=d&&d.getPortalUser(),k=b&&"/"!==b?b:"",n=a instanceof FormData,p={url:(d&&d.portalUrl)+"content/users/"+(g||l.username)+(k?"/"+k:"")+"/addItem"};b=a&&("FORM"===a.tagName||"FORM"===a.nodeName||n)?"form":"content";var v,t,u,w=new f;p[b]=a;m.self.hasCategorySchema&&p[b].categories&&(n?p[b].categories.value=e.stringify(p[b].categories):p[b].categories=e.stringify(p[b].categories));q.request(p,{usePost:!0}).then(h.hitch(this,function(b){if(n)if(a.keys)for(u=
a.keys(),v={};!(t=u.next()).done;)"file"!==t.value&&(v[t.value]=a.get(t.value));else v=b;else v=p.form?c.toObject(a):a;v.title=h.isArray(v.title)?v.title[0]:v.title;v=h.mixin(b,v,{folderId:k});w.resolve(v)}),function(a){w.reject(a)});return w},updateItem:function(a,b){var c=b&&b.getPortalUser();b=(b&&b.portalUrl)+"content/users/"+(a.owner||c.username)+(a.folderId&&"/"!==a.folderId?"/"+a.folderId:"")+"/items/"+a.id+"/update";var c=h.mixin({},a),d=new f;delete c.owner;m.self.hasCategorySchema&&c.categories&&
(c.categories=e.stringify(c.categories));q.request({url:b,content:c},{usePost:!0}).then(h.hitch(this,function(b){d.resolve(a)}),function(a){d.reject(a)});return d},setCategories:function(a,b){!a.categories||b&&0!==b.length||(b=a.categories);return n.setItemCategories([a.id],b)},addItemResource:function(a,b,c){var d=b&&b.getPortalUser();return q.request({url:(b&&b.portalUrl)+"content/users/"+(a.owner||d.username)+(a.folderId&&"/"!==a.folderId?"/"+a.folderId:"")+"/items/"+a.id+"/addResources",content:c},
{usePost:!0}).then(h.hitch(this,function(a){return a}))},getCloudProviderItemResource:function(a){return q.request({url:m.restBaseUrl+"content/items/"+a.id+"/resources/cloudProvider.json"}).then(h.hitch(this,function(a){return a}))},getPublishParametersForOverwrite:function(a,b){var c=new f;this._fetchPublishParameters(a,b).then(h.hitch(this,function(d){this._fetchServiceInfo(a).then(h.hitch(this,function(e){var f="";"CSV"==b?(f=h.mixin(h.mixin({},e.layers&&e.layers[0]),{fields:d.layerInfo.fields}),
f=h.mixin(d,{layerInfo:f,name:d.name||a.title.replace(/ /g,"_")})):f="Microsoft Excel"==b?this._generateExcelOverwritePublishParameters(d,e):{name:a.title?a.title.replace(/ /g,"_"):this.item.title.replace(/ /g,"_")};f=e?h.mixin(f,e):f;c.resolve(f)}),h.hitch(this,function(a){c.reject(a)}))}),h.hitch(this,function(a){c.reject(a)}));return c},_fetchPublishParameters:function(a,b){a=m.restBaseUrl+"content/items/"+a.id+"/info/publishParameters.json";!b||"CSV"!==b&&"Microsoft Excel"!==b?(b=new f,b.resolve(!1)):
b=q.request({url:a}).then(h.hitch(this,function(a){return a}));return b},_fetchServiceInfo:function(b){b=b.url;var c={addToken:(q.isHostedService(b)||q.isAgolService(b))&&!1!==m.isMultiTenant},d=new f,e;g([q.request({url:b},c),q.request({url:b+"/layers"},c)]).then(h.hitch(this,function(b){var c={},f=b&&1<b.length&&b[1],g=f&&f.layers,f=f&&f.tables;g&&g.length&&(a.forEach(g,function(a){delete a.fields}),c.layers=g);f&&f.length&&(c.tables=f);e=h.mixin(b[0],c);d.resolve(e)}));return d},_generateExcelOverwritePublishParameters:function(a,
b){b.name=a.name;b.sourceSR=a.sourceSR;b.targetSR=a.targetSR;for(var c=0;c<b.tables.length;c++)"Review"!=b.tables[c].name&&(b.layers[b.layers.length]=b.tables[c]);for(c=0;c<b.layers.length;c++)b.layers[c].excelSheetId=a.layers[c].excelSheetId,b.layers[c].locationType=a.layers[c].locationType,b.layers[c].latitudeFieldName=a.layers[c].latitudeFieldName,b.layers[c].longitudeFieldName=a.layers[c].longitudeFieldName,b.layers[c].geocodeServiceUrl=a.layers[c].geocodeServiceUrl,b.layers[c].sourceLocale=a.layers[c].sourceLocale,
b.layers[c].sourceCountry=a.layers[c].sourceCountry,b.layers[c].standardizedFieldNames=a.layers[c].standardizedFieldNames,b.layers[c].addressFields=a.layers[c].addressFields;return b},deleteItem:function(a,b){a=(b&&b.getPortalUser()).userContentUrl+(a.folderId&&"/"!==a.folderId?"/"+a.folderId:"")+"/items/"+a.id+"/delete";return q.request({url:a},{usePost:!0})},publishItem:function(a,b,c){var d=(c&&c.getPortalUser()).username;c=(c&&c.portalUrl)+"content/users/"+d+(a.folderId&&"/"!==a.folderId?"/"+
a.folderId:"")+"/publish";var l=new f;b.publishParameters=e.stringify(b.publishParameters);q.request({url:c,content:b},{usePost:!0}).then(h.hitch(this,function(b){if(m.self.hasCategorySchema&&a.categories){var c=[];(b.services||[]).forEach(function(b){c.push(this.setCategories({id:b.id,categories:a.categories}))},this);g(c).then(h.hitch(this,function(){l.resolve(h.mixin(a,{publishResult:b.services||[]}))}))}else l.resolve(h.mixin(a,{publishResult:b.services||[]}))}),function(a){l.reject(a)});return l},
createService:function(a,b,c,d){var e=new f,g,m=d&&d.getPortalUser();q.request({url:(d&&d.portalUrl)+"content/users/"+(a.owner||m.username)+"/createService",content:b},{usePost:!0}).then(function(a){return g=a}).then(h.hitch(this,this.addToDefinition,c)).then(h.hitch(this,function(b){e.resolve(h.mixin(a,{createResult:b||[]}))}),h.hitch(this,function(a){this.deleteItem(h.mixin(g,{id:g.itemId}),d).then(function(){e.reject(a)})}));return e},addToDefinition:function(a,b){var c=new f;if(a){var d=b.encodedServiceURL.replace("rest/services",
"rest/admin/services");q.request({url:d+"/addToDefinition",content:{addToDefinition:a}},{usePost:!0}).then(h.hitch(this,function(a){c.resolve(h.mixin(b,{addToDefinitionResult:a}))}),function(a){c.reject(a)})}else c.resolve(b);return c},moveItem:function(a,b,c){var d=new f,e=c&&c.getPortalUser(),e=a.owner||e.username;c=(c&&c.portalUrl)+"content/users/"+e+(a.folderId&&"/"!==a.folderId?"/"+a.folderId:"")+"/items/"+a.id+"/move";e={folder:b&&b!==e?b:"/"};(a.folderId||"/")!==e.folder?q.request({url:c,content:e},
{usePost:!0}).then(h.hitch(this,function(c){d.resolve(h.mixin(a,{folderId:b}))})):d.resolve(a);return d},serviceNameAvailable:function(a,b){var c=b&&b.getPortalUser();a={name:a.title.replace(/ /g,"_"),type:a.type||"Feature Service"};return q.request({url:b.url+"portals/"+c.orgId+"/isServiceNameAvailable",content:a})},analyzeItem:function(a,b,c){b=h.mixin({enableGlobalGeocoding:!0,sourceLocale:k.locale.split("-")[0]},b||{});a=h.mixin({},{analyzeParameters:b,filetype:a.fileType||a.type&&a.type.toLowerCase()||
"",itemid:a.id});c=c.url+"/content/features/analyze";a.analyzeParameters=e.stringify(a.analyzeParameters);return q.request({url:c,content:a},{usePost:!0})},createTemplatedApplication:function(b,c,g,k){var n=b,p=k&&k.sharing?k.sharing:{},t=k&&k.isEveryoneChecked?k:null,u=h.isArray(c.typeKeywords)?-1<a.indexOf(c.typeKeywords,"selfConfigured"):-1<c.typeKeywords.indexOf("selfConfigured");k=h.isArray(c.typeKeywords)?-1<a.indexOf(c.typeKeywords,"Web AppBuilder for ArcGIS"):-1<c.typeKeywords.indexOf("Web AppBuilder for ArcGIS");
var v,A,B=h.hitch(this,function(b){var c=new f;if(b.shareWithWebMap){var d=m.restBaseUrl+"content/items/"+b.id+"/share",g="public"===p.access||t&&t.isEveryoneChecked()||!1,l="org"===p.access||t&&t.isAccountChecked()||!1,k=p.groups||t&&t.getSharedGroups()||[],k=a.map(k,"return item.id;"),g={f:"json",everyone:g,org:l,groups:k.join(","),items:[b.id]};m.self.hasCategorySchema&&g.categories&&(g.categories=e.stringify(g.categories));q.request({url:d,content:g},{usePost:!0}).then(h.hitch(this,function(){c.resolve(b)}))}else c.resolve(b);
return c});if(n&&k)return b=new f,n.folderId&&"/"!==n.folderId&&(n.folder=n.folderId),k=window.location.protocol+"//"+window.location.host+q.getHomeAppContext()+"/apps/webappbuilder/index.html?",k+=d.objectToQuery({title:n.title,tags:n.tags,summary:n.description,folder:n.folder,categories:n.categories&&n.categories.length?e.stringify(n.categories):void 0}),b.resolve(h.mixin(n,{configureUrl:k})),b;if(n)return k=q.parseUrl(c.url),delete b.typeKeywords,v=window.location.protocol+"//"+k.host+(k.port&&
"443"!==k.port&&"80"!==k.port?":"+k.port:"")+k.path,v="https:"===window.location.protocol?q.getSecureUrl(v):q.getHttpUrl(v),n=h.mixin({type:"Web Mapping Application",typeKeywords:"Web Map, Map, Online Map, Mapping Site, JavaScript, Ready To Use"+(u?" ,selfConfigured":""),thumbnailURL:q.getStaticImagesUrl()+"/webapp.png",url:v},n),n.text=e.stringify(h.mixin({},{source:c.id,folderId:n.folderId,values:b.webSceneId?{webscene:b.webSceneId}:b.webMapId?{webmap:b.webMapId}:b.groupId?{group:b.groupId}:{}})),
this.addItem(n,n.folderId,g).then(h.hitch(this,function(a){return B(h.mixin(n,{id:a.id})).then(h.hitch(this,function(b){var d=b.url.indexOf("?"),e=-1!==d?b.url.substr(d,b.url.length):"",e=e+(e&&e.length?"\x26":"?"),e=e+("appid\x3d"+a.id);v=b.url.substr(0,-1!==d?d:b.url.length)+e;return this.updateItem({id:a.id,url:v,folderId:b.folderId},g).then(h.hitch(this,function(){return u?(A=u?v+"\x26edit\x3dtrue":m.baseUrl+("webmap/configureApp.html?appid\x3d"+a.id),A+=a.folderId&&"/"!==a.folderId?"\x26folderid\x3d"+
a.folderId:"",h.mixin(b,a,{configureUrl:A,url:v})):q.request({url:m.restBaseUrl+"content/items/"+c.id+"/data"}).then(h.hitch(this,function(c){A=c&&c.configurationSettings?m.baseUrl+"webmap/configureApp.html?appid\x3d"+a.id+(a.folderId&&"/"!==a.folderId?"\x26folderid\x3d"+a.folderId:""):m.baseUrl+"item.html?id\x3d"+a.id;return h.mixin(b,a,{configureUrl:A,url:v})}))}))}))}),h.hitch(this,function(a){a&&409===a.code&&(a=n,a={title:w.addItemFrm.errors.error.title,message:l.substitute({type:a.type,title:a.title},
w.addItemFrm.errors.itemExists.message)});throw a;}))},checkStatus:function(a,b,c,d){var e=(d&&d.getPortalUser()).userContentUrl;a?q.request({url:e+"/items/"+a.id+"/status",content:{jobId:a.jobId}}).then(h.hitch(this,function(e){e=e||{status:"failed"};if("completed"===e.status)return b.resolve(a);if("failed"===e.status||""===e.status)return b.reject({message:e.statusMessage});c=(c||500)+250;setTimeout(h.hitch(this,function(){this.checkStatus(a,b,c,d)}),c)}),h.hitch(this,function(a){b.reject(a)})):
b.reject()},_getBatchGeocodeServers:function(b){if(!this._batchGeocoderServers){var c=b.getPortalUser(),d=-1<a.indexOf(c.privileges,"portal:user:createItem")&&-1<a.indexOf(c.privileges,"premium:user:geocode"),e=/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig,f=/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig,g,m,l=[];a.forEach(b.helperServices&&b.helperServices.geocode||[],function(a){g=!!a.url.match(e);m=!!a.url.match(f);(g&&!b.isPortal&&d||m||a.batch)&&l.push({isWorldGeocodeServer:g||
m,isWorldGeocodeServerProxy:m,label:a.name,value:a.url,url:a.url,name:a.name})});this._batchGeocoderServers=l}return this._batchGeocoderServers},getPortalDefaultExtentAsGCS:function(a){if(a=a.defaultExtent||null){a=t.webMercatorToGeographic(new p(a));var b=a.spatialReference._getInfo();if(b){if(a.xmin>a.xmax){var c=b.valid[1]-a.xmin,d=a.xmax-b.valid[0];c>d?a.xmax=b.valid[1]+d:a.xmin=b.valid[0]-c}return Math.round(1E4*a.xmin)/1E4+","+Math.round(1E4*a.ymin)/1E4+","+Math.round(1E4*a.xmax)/1E4+","+Math.round(1E4*
a.ymax)/1E4}}return null},_getFederatedServers:function(a){return q.request({url:a.url+"portals/self/servers/"})},_getHostedFederatedServers:function(b){var c=new f,d;this._getFederatedServers(b).then(h.hitch(this,function(b){m.federatedServers=b.servers;d=a.filter(b.servers||[],h.hitch(this,function(a){return a.isHosted}));c.resolve(d&&d.length&&d[0]||null)}));return c},hasCreateLayer:function(b){var c={managed:!0},d=b&&(b.user||b.getPortalUser&&b.getPortalUser()),e=new u({portalUser:d}),g,m,l,k,
n;if(b.isPortal&&d&&(e.isBasedOnAdmin()||e.isBasedOnPublisher()))return this._getFederatedServers(b).then(h.hitch(this,function(b){(m=(g=a.filter(b.servers||[],h.hitch(this,function(a){return a.isHosted})))&&g.length?g[0]:null)?(l=m.adminUrl+"/admin/data/findItems",n=q.request({url:l,content:c},{useProxy:!0}).then(h.hitch(this,function(b){return(k=a.filter(b.items||b||[],h.hitch(this,function(a){return a&&a.provider&&"arcgis data store"===a.provider.toLowerCase()})))&&k.length?!0:!1}),h.hitch(this,
function(a){return!1}))):(n=new f,n.resolve(!1));return n}));b=new f;b.resolve(!0);return b}}})},"arcgisonline/pages/utils/categories":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/json ../../sharing/util ../../esriGeowConfig".split(" "),function(b,h,k,a,c,d,e){return{setItemCategories:function(b,g){var f=new a,m=[];e.self.hasCategorySchema&&g.length?(b=this.concatUniqueIds([],b),b.forEach(function(a){var b={};b[a]={categories:g};m.push(b)}),d.request({url:e.restBaseUrl+
"content/updateItems",content:{items:c.stringify(m)}},{usePost:!0}).then(function(){f.resolve()}.bind(this),function(){f.resolve()}.bind(this))):f.resolve();return f},concatUniqueIds:function(a,b){var c=[].concat(a||[]);(b||[]).forEach(function(a){a&&-1===c.indexOf(a)&&c.push(a)});return c},cleanSchema:function g(a){delete a.isOpen;delete a.depth;delete a.order;a.categories&&(a.categories=a.categories.map(g));return a},getSchemaOrder:function(a,b,c){c=c||{};c.__total=c.__total?c.__total:0;a.forEach(function(a){var d=
b?b+"/"+a.title:"/"+a.title,d=d.trim();c.__total+=1;c[d]=c.__total;a.categories&&this.getSchemaOrder(a.categories,d,c)}.bind(this));return c},getRootNode:function(a){(a=a&&a[0]&&a[0].title)&&"/"!==a.charAt(0)&&(a="/"+a);return a||"/Categories"},simplifyItemObject:function(a,b){return{id:a.id,categories:b?a.groupCategories:a.categories}},getCounts:function(a){a=a||{};return d.request({url:e.restBaseUrl+(a.group?"content/groups/"+a.group.id+"/search":"search"),content:{num:0,q:a.group?"":"orgid:"+a.portal.id,
countFields:a.group?"groupCategories":"categories",countSize:200}}).then(function(a){return a.aggregations.counts[0].fieldValues})}}})},"arcgisonline/sharing/dijit/Role":function(){define("require exports tslib ../../esriGeowConfig ./_LevelAwareMixin ../../tsutils/declareDecorator dojo/i18n!../../nls/arcgisonline dojo/json esri/lang".split(" "),function(b,h,k,a,c,d,e,f,g){a=k.__importDefault(a);c=k.__importDefault(c);d=k.__importDefault(d);e=k.__importDefault(e);f=k.__importDefault(f);g=k.__importDefault(g);
return function(){function b(a){this.declaredClass="arcgisonline.sharing.dijit.Role";this.description=this.name=this.baseRole=this.id=null;this.privileges=[];this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1,shareToGroup:!1,shareToOrg:!1,
shareToPublic:!1,createUpdateCapableGroup:!1,updateItemCategorySchema:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1,publishServerServices:!1,publishServerGPServices:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1,viewOrgUsers:!1,viewOrgItems:!1,viewOrgGroups:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,
networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1},publisher:{geoanalytics:!1,rasteranalysis:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}},notebooks:{publisher:{createNotebooks:!1,scheduleNotebooks:!1,publishNotebooks:!1,allowArcpyNotebooks:!1}}};a=a||{};var b=a.portalUser;b?(this.id=b.roleId?b.roleId:b.role,this.baseRole=b.role,this.setPrivileges(b.privileges)):(this.id=a.id,this.baseRole=a.role,this.name=a.name,this.description=a.description,a.privileges&&
this.setPrivileges(a.privileges))}b.prototype.isViewer=function(){return g.default.isDefined(this.id)&&this.id===this.SYSTEM_ROLES.VIEWER};b.prototype.isUser=function(){return g.default.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)};b.prototype.isPublisher=function(){return g.default.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)};b.prototype.isAdmin=function(){return g.default.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)};
b.prototype.isBasedOnUser=function(){return this.isUser()||g.default.isDefined(this.baseRole)&&("org_user"===this.baseRole||"account_user"===this.baseRole)};b.prototype.isBasedOnPublisher=function(){return this.isPublisher()||g.default.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)};b.prototype.isBasedOnAdmin=function(){return this.isAdmin()||g.default.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)};b.prototype.isCustom=
function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&g.default.isDefined(this.id)&&0<this.id.length};b.prototype.canInviteUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.inviteUsers};b.prototype.canDisableUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers};b.prototype.canViewUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers};b.prototype.canUpdateUsers=function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateUsers};b.prototype.canDeleteUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers};b.prototype.canChangeUserRoles=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles};b.prototype.canViewOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups};b.prototype.canUpdateOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups};b.prototype.canDeleteOrgGroups=
function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups};b.prototype.canReassignOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups};b.prototype.canAssignUsersToOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups};b.prototype.canManageEnterpriseGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups};b.prototype.canViewOrgItems=function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.viewItems};b.prototype.canUpdateOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems};b.prototype.canDeleteOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems};b.prototype.canReassignOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems};b.prototype.canManageLicenses=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses};b.prototype.canShareOthersItemsToGroup=
function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToGroup};b.prototype.canShareOthersItemsToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToOrg};b.prototype.canShareOthersItemsToPublic=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToPublic};b.prototype.canCreateUpdateCapableGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.createUpdateCapableGroup};b.prototype.canUpdateItemCategories=function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateItemCategorySchema};b.prototype.canCreateGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup};b.prototype.canJoinOrgGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup};b.prototype.canJoinNonOrgGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup};b.prototype.canPublishFeatures=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures};
b.prototype.canPublishTiles=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles};b.prototype.canPublishScenes=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes};b.prototype.canPublishServerServices=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishServerServices};b.prototype.canPublishServerGPServices=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishServerGPServices};b.prototype.canPublishVectorTiles=
function(){return!0};b.prototype.canPublishImageCollection=function(){return!0};b.prototype.canCreateItem=function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem};b.prototype.canShareItemToGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup};b.prototype.canShareItemToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg};b.prototype.canShareItemToPublic=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToPublic};
b.prototype.canShareGroupToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg};b.prototype.canShareGroupToPublic=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic};b.prototype.canViewOrgUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewOrgUsers};b.prototype.canViewOrgUserContent=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewOrgItems};b.prototype.canViewOrgUserGroups=function(){return this.privilegeObj&&
this.privilegeObj.portal.user.viewOrgGroups};b.prototype.canEditFeatures=function(){return this.privilegeObj&&this.privilegeObj.features.user.edit};b.prototype.canEditFeaturesFullControl=function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit};b.prototype.canManageOpenData=function(){return this.privilegeObj&&this.privilegeObj.opendata.user.openDataAdmin};b.prototype.canDesignateOpenDataGroups=function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup};
b.prototype.canUseGeocode=function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode};b.prototype.canUseNetworkAnalysis=function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis};b.prototype.canUseSpatialAnalysis=function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis};b.prototype.canUseGeoenrichment=function(){return this.privilegeObj&&this.privilegeObj.premium.user.geoenrichment};b.prototype.canUseDemographics=function(){return this.privilegeObj&&
this.privilegeObj.premium.user.demographics};b.prototype.canUseElevation=function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation};b.prototype.canUseGeoanalytics=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.geoanalytics};b.prototype.canUseRasterAnalysis=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.rasteranalysis};b.prototype.canPurchaseMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase};
b.prototype.canManageMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage};b.prototype.canTrialMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.startTrial};b.prototype.canCreateNotebooks=function(){return this.privilegeObj&&this.privilegeObj.notebooks.publisher.createNotebooks};b.prototype.canScheduleNotebooks=function(){return this.privilegeObj&&this.privilegeObj.notebooks.publisher.scheduleNotebooks};b.prototype.canPublishNotebooks=
function(){return this.privilegeObj&&this.privilegeObj.notebooks.publisher.publishNotebooks};b.prototype.canUseArcpyNotebooks=function(){return this.privilegeObj&&this.privilegeObj.notebooks.publisher.allowArcpyNotebooks};b.prototype.setPrivileges=function(a){this.privileges=a;this._initPrivilegesObject();g.default.isDefined(a)&&this._readPrivileges(a)};b.prototype.stringify=function(){return f.default.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})};
b.prototype.stringifyRole=function(){return f.default.stringify({id:this.id,name:this.name,description:this.description})};b.prototype.stringifyPrivileges=function(){return f.default.stringify({privileges:this._buildPrivilegesArray()})};b.prototype.stringifyPretty=function(){return f.default.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")};b.prototype.summarize=function(){var b=[],c=a.default.self&&a.default.self.isPortal,d=a.default.self&&
a.default.self.portalProperties&&a.default.self.portalProperties.openData&&!0===a.default.self.portalProperties.openData.enabled,f=this.privilegeObj;f.portal.user.viewOrgUsers&&b.push(c?e.default.customRoles.users.canViewOrgUsersSumPortal:e.default.customRoles.users.canViewOrgUsersSum);f.portal.user.createGroup&&b.push(e.default.customRoles.groups.canCreateSum);f.portal.user.joinGroup&&b.push(c?e.default.customRoles.groups.canJoinIntSumPortal:e.default.customRoles.groups.canJoinIntSum);f.portal.user.joinNonOrgGroup&&
b.push(e.default.customRoles.groups.canJoinExt);f.portal.user.viewOrgGroups&&b.push(c?e.default.customRoles.groups.canViewOrgGroupsPortal:e.default.customRoles.groups.canViewOrgGroups);f.portal.user.createItem&&b.push(e.default.customRoles.items.canCreateSum);f.portal.publisher.publishFeatures&&b.push(e.default.customRoles.items.canPublishFeatures);f.portal.publisher.publishTiles&&b.push(e.default.customRoles.items.canPublishTiles);f.portal.publisher.publishScenes&&b.push(e.default.customRoles.items.canPublishScenes);
c&&f.portal.publisher.publishServerServices&&b.push(e.default.customRoles.items.canPublishServerServices);f.portal.user.viewOrgItems&&b.push(c?e.default.customRoles.items.canViewOrgItemsPortal:e.default.customRoles.items.canViewOrgItems);f.portal.user.shareToGroup&&b.push(e.default.customRoles.itemSharing.canShareGroupsSum);f.portal.user.shareToOrg&&b.push(c?e.default.customRoles.itemSharing.canShareOrgSumPortal:e.default.customRoles.itemSharing.canShareOrgSum);f.portal.user.shareToPublic&&b.push(e.default.customRoles.itemSharing.canSharePublicSum);
f.portal.user.shareGroupToOrg&&b.push(c?e.default.customRoles.groupSharing.canShareOrgPortal:e.default.customRoles.groupSharing.canShareOrg);f.portal.user.shareGroupToPublic&&b.push(e.default.customRoles.groupSharing.canSharePublic);d&&f.opendata.user.openDataAdmin&&b.push(e.default.customRoles.openData.canAdmin);f.premium.user.geocode&&b.push(e.default.customRoles.geoservices.canUseGeocoding);f.premium.user.networkanalysis&&b.push(e.default.customRoles.geoservices.canUseNA);f.premium.user.spatialanalysis&&
b.push(e.default.customRoles.geoservices.canUseSA);f.premium.user.geoenrichment&&b.push(e.default.customRoles.geoservices.canUseGeoenrichment);f.premium.user.demographics&&b.push(e.default.customRoles.geoservices.canUseDemographics);f.premium.user.elevation&&b.push(e.default.customRoles.geoservices.canUseElevation);c&&(f.premium.publisher.geoanalytics&&b.push(e.default.customRoles.geoservices.canUseGeoanalytics),f.premium.publisher.rasteranalysis&&b.push(e.default.customRoles.geoservices.canUseRasterAnalysis));
c||(f.features.user.edit&&b.push(e.default.customRoles.features.canEditSum),f.features.user.fullEdit&&b.push(e.default.customRoles.features.canManageSum));d&&f.opendata.user.designateGroup&&b.push(e.default.customRoles.openData.canDesignate);f.portal.admin.viewUsers&&b.push(c?e.default.customRoles.userAdmin.canViewSumPortal:e.default.customRoles.userAdmin.canViewSum);f.portal.admin.updateUsers&&b.push(c?e.default.customRoles.userAdmin.canUpdateSumPortal:e.default.customRoles.userAdmin.canUpdateSum);
f.portal.admin.deleteUsers&&b.push(c?e.default.customRoles.userAdmin.canDeleteSumPortal:e.default.customRoles.userAdmin.canDeleteSum);f.portal.admin.inviteUsers&&b.push(c?e.default.customRoles.userAdmin.canAddSum:e.default.customRoles.userAdmin.canInviteSum);f.portal.admin.disableUsers&&b.push(c?e.default.customRoles.userAdmin.canDisableSumPortal:e.default.customRoles.userAdmin.canDisableSum);f.portal.admin.changeUserRoles&&b.push(c?e.default.customRoles.userAdmin.canChangeRolesSumPortal:e.default.customRoles.userAdmin.canChangeRolesSum);
f.portal.admin.manageLicenses&&b.push(c?e.default.customRoles.userAdmin.canManageLicensesSumPortal:e.default.customRoles.userAdmin.canManageLicensesSum);f.portal.admin.viewGroups&&b.push(c?e.default.customRoles.groupAdmin.canViewSumPortal:e.default.customRoles.groupAdmin.canViewSum);f.portal.admin.updateGroups&&b.push(c?e.default.customRoles.groupAdmin.canUpdateSumPortal:e.default.customRoles.groupAdmin.canUpdateSum);f.portal.admin.deleteGroups&&b.push(c?e.default.customRoles.groupAdmin.canDeleteSumPortal:
e.default.customRoles.groupAdmin.canDeleteSum);f.portal.admin.reassignGroups&&b.push(c?e.default.customRoles.groupAdmin.canReassignSumPortal:e.default.customRoles.groupAdmin.canReassignSum);f.portal.admin.assignToGroups&&b.push(c?e.default.customRoles.groupAdmin.canAssignSumPortal:e.default.customRoles.groupAdmin.canAssignSum);f.portal.admin.manageEnterpriseGroups&&b.push(e.default.customRoles.groupAdmin.canLink);f.portal.admin.createUpdateCapableGroup&&b.push(e.default.customRoles.groupAdmin.canCreateUpdateCapable);
f.portal.admin.viewItems&&b.push(c?e.default.customRoles.itemAdmin.canViewSumPortal:e.default.customRoles.itemAdmin.canViewSum);f.portal.admin.updateItems&&b.push(c?e.default.customRoles.itemAdmin.canUpdateSumPortal:e.default.customRoles.itemAdmin.canUpdateSum);f.portal.admin.deleteItems&&b.push(c?e.default.customRoles.itemAdmin.canDeleteSumPortal:e.default.customRoles.itemAdmin.canDeleteSum);f.portal.admin.reassignItems&&b.push(c?e.default.customRoles.itemAdmin.canReassignSumPortal:e.default.customRoles.itemAdmin.canReassignSum);
f.portal.admin.updateItemCategorySchema&&b.push(e.default.customRoles.itemAdmin.canManageItemCategories);c&&f.portal.publisher.publishServerGPServices&&b.push(e.default.customRoles.items.canPublishServerGPServices);f.portal.admin.shareToGroup&&b.push(c?e.default.customRoles.itemAdmin.canShareToGroupSumPortal:e.default.customRoles.itemAdmin.canShareToGroupSum);f.portal.admin.shareToOrg&&b.push(c?e.default.customRoles.itemAdmin.canShareToOrgSumPortal:e.default.customRoles.itemAdmin.canShareToOrgSum);
f.portal.admin.shareToPublic&&b.push(c?e.default.customRoles.itemAdmin.canShareToPublicSumPortal:e.default.customRoles.itemAdmin.canShareToPublicSum);c||(f.marketplace.admin.manage&&b.push(e.default.customRoles.marketplace.canAdminSum),f.marketplace.admin.purchase&&b.push(e.default.customRoles.marketplace.canPurchaseSum),f.marketplace.admin.startTrial&&b.push(e.default.customRoles.marketplace.canTrialSum));f.notebooks.publisher.allowArcpyNotebooks&&b.push(e.default.customRoles.geoservices.canUseArcpyNotebooks);
f.notebooks.publisher.createNotebooks&&b.push(e.default.customRoles.items.canCreateNotebooks);f.notebooks.publisher.publishNotebooks&&b.push(e.default.customRoles.items.canPublishNotebooks);f.notebooks.publisher.scheduleNotebooks&&b.push(e.default.customRoles.itemAdmin.canScheduleNotebooks);return b};b.prototype._initPrivilegesObject=function(){this._applyToAll(!1)};b.prototype._readPrivileges=function(a){var b=this;g.default.isDefined(a)&&a instanceof Array&&a.forEach(function(a){b._readPrivilege(a)})};
b.prototype._readPrivilege=function(a){this._applyEffectToAction(!0,a)};b.prototype._applyEffectToAction=function(a,b){switch(b){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=a;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=a;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=a;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=a;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=
a;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=a;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=a;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=a;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=a;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=a;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=
a;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=a;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=a;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=a;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=a;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=a;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=
a;break;case "portal:admin:shareToGroup":this.privilegeObj.portal.admin.shareToGroup=a;break;case "portal:admin:shareToOrg":this.privilegeObj.portal.admin.shareToOrg=a;break;case "portal:admin:shareToPublic":this.privilegeObj.portal.admin.shareToPublic=a;break;case "portal:admin:createUpdateCapableGroup":this.privilegeObj.portal.admin.createUpdateCapableGroup=a;break;case "portal:admin:updateItemCategorySchema":this.privilegeObj.portal.admin.updateItemCategorySchema=a;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=
a;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=a;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=a;break;case "portal:publisher:publishServerServices":this.privilegeObj.portal.publisher.publishServerServices=a;break;case "portal:publisher:publishServerGPServices":this.privilegeObj.portal.publisher.publishServerGPServices=a;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=a;break;
case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=a;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=a;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=a;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=a;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=a;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=a;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
a;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=a;break;case "portal:user:viewOrgUsers":this.privilegeObj.portal.user.viewOrgUsers=a;break;case "portal:user:viewOrgItems":this.privilegeObj.portal.user.viewOrgItems=a;break;case "portal:user:viewOrgGroups":this.privilegeObj.portal.user.viewOrgGroups=a;break;case "features:user:edit":this.privilegeObj.features.user.edit=a;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=a;break;
case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=a;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=a;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=a;break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=a;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=a;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=
a;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=a;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=a;break;case "premium:publisher:geoanalytics":this.privilegeObj.premium.publisher.geoanalytics=a;break;case "premium:publisher:rasteranalysis":this.privilegeObj.premium.publisher.rasteranalysis=a;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=a;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=
a;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=a;break;case "notebooks:publisher:createNotebooks":this.privilegeObj.notebooks.publisher.createNotebooks=a;break;case "notebooks:publisher:scheduleNotebooks":this.privilegeObj.notebooks.publisher.scheduleNotebooks=a;break;case "notebooks:publisher:publishNotebooks":this.privilegeObj.notebooks.publisher.publishNotebooks=a;break;case "notebooks:publisher:allowArcpyNotebooks":this.privilegeObj.notebooks.publisher.allowArcpyNotebooks=
a}};b.prototype._applyToAll=function(a){this.privilegeObj.portal.admin.inviteUsers=a;this.privilegeObj.portal.admin.disableUsers=a;this.privilegeObj.portal.admin.viewUsers=a;this.privilegeObj.portal.admin.updateUsers=a;this.privilegeObj.portal.admin.deleteUsers=a;this.privilegeObj.portal.admin.changeUserRoles=a;this.privilegeObj.portal.admin.viewGroups=a;this.privilegeObj.portal.admin.updateGroups=a;this.privilegeObj.portal.admin.deleteGroups=a;this.privilegeObj.portal.admin.reassignGroups=a;this.privilegeObj.portal.admin.assignToGroups=
a;this.privilegeObj.portal.admin.manageEnterpriseGroups=a;this.privilegeObj.portal.admin.viewItems=a;this.privilegeObj.portal.admin.updateItems=a;this.privilegeObj.portal.admin.deleteItems=a;this.privilegeObj.portal.admin.reassignItems=a;this.privilegeObj.portal.admin.manageLicenses=a;this.privilegeObj.portal.admin.shareToGroup=a;this.privilegeObj.portal.admin.shareToOrg=a;this.privilegeObj.portal.admin.shareToPublic=a;this.privilegeObj.portal.admin.createUpdateCapableGroup=a;this.privilegeObj.portal.admin.updateItemCategorySchema=
a;this.privilegeObj.portal.publisher.publishFeatures=a;this.privilegeObj.portal.publisher.publishTiles=a;this.privilegeObj.portal.publisher.publishScenes=a;this.privilegeObj.portal.publisher.publishServerServices=a;this.privilegeObj.portal.publisher.publishServerGPServices=a;this.privilegeObj.portal.user.createGroup=a;this.privilegeObj.portal.user.joinGroup=a;this.privilegeObj.portal.user.joinNonOrgGroup=a;this.privilegeObj.portal.user.createItem=a;this.privilegeObj.portal.user.shareToGroup=a;this.privilegeObj.portal.user.shareToOrg=
a;this.privilegeObj.portal.user.shareToPublic=a;this.privilegeObj.portal.user.shareGroupToOrg=a;this.privilegeObj.portal.user.shareGroupToPublic=a;this.privilegeObj.portal.user.viewOrgUsers=a;this.privilegeObj.portal.user.viewOrgItems=a;this.privilegeObj.portal.user.viewOrgGroups=a;this.privilegeObj.features.user.edit=a;this.privilegeObj.opendata.user.openDataAdmin=a;this.privilegeObj.opendata.user.designateGroup=a;this.privilegeObj.premium.user.geocode=a;this.privilegeObj.premium.user.networkanalysis=
a;this.privilegeObj.premium.user.spatialanalysis=a;this.privilegeObj.premium.user.geoenrichment=a;this.privilegeObj.premium.user.demographics=a;this.privilegeObj.premium.user.elevation=a;this.privilegeObj.premium.publisher.geoanalytics=a;this.privilegeObj.premium.publisher.rasteranalysis=a;this.privilegeObj.marketplace.admin.purchase=a;this.privilegeObj.marketplace.admin.manage=a;this.privilegeObj.marketplace.admin.startTrial=a;this.privilegeObj.notebooks.publisher.createNotebooks=a;this.privilegeObj.notebooks.publisher.scheduleNotebooks=
a;this.privilegeObj.notebooks.publisher.publishNotebooks=a;this.privilegeObj.notebooks.publisher.allowArcpyNotebooks=a};b.prototype._buildPrivilegesArray=function(){var a=[];!0===this.privilegeObj.portal.admin.inviteUsers&&a.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&a.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&a.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&a.push("portal:admin:updateUsers");
!0===this.privilegeObj.portal.admin.deleteUsers&&a.push("portal:admin:deleteUsers");!0===this.privilegeObj.portal.admin.changeUserRoles&&a.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&a.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&a.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&a.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&a.push("portal:admin:reassignGroups");
!0===this.privilegeObj.portal.admin.assignToGroups&&a.push("portal:admin:assignToGroups");!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&a.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&a.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&a.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&a.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&a.push("portal:admin:reassignItems");
!0===this.privilegeObj.portal.admin.manageLicenses&&a.push("portal:admin:manageLicenses");!0===this.privilegeObj.portal.admin.shareToGroup&&a.push("portal:admin:shareToGroup");!0===this.privilegeObj.portal.admin.shareToOrg&&a.push("portal:admin:shareToOrg");!0===this.privilegeObj.portal.admin.shareToPublic&&a.push("portal:admin:shareToPublic");!0===this.privilegeObj.portal.admin.createUpdateCapableGroup&&a.push("portal:admin:createUpdateCapableGroup");!0===this.privilegeObj.portal.admin.updateItemCategorySchema&&
a.push("portal:admin:updateItemCategorySchema");!0===this.privilegeObj.portal.publisher.publishFeatures&&a.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&a.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&a.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.publisher.publishServerServices&&a.push("portal:publisher:publishServerServices");!0===this.privilegeObj.portal.publisher.publishServerGPServices&&
a.push("portal:publisher:publishServerGPServices");!0===this.privilegeObj.portal.user.createGroup&&a.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&a.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&a.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&a.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&a.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&
a.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&a.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&a.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&a.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.portal.user.viewOrgUsers&&a.push("portal:user:viewOrgUsers");!0===this.privilegeObj.portal.user.viewOrgItems&&a.push("portal:user:viewOrgItems");!0===this.privilegeObj.portal.user.viewOrgGroups&&
a.push("portal:user:viewOrgGroups");!0===this.privilegeObj.features.user.edit&&a.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&a.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&a.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&a.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&a.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&a.push("premium:user:networkanalysis");
!0===this.privilegeObj.premium.user.spatialanalysis&&a.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&a.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&a.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&a.push("premium:user:elevation");!0===this.privilegeObj.premium.publisher.geoanalytics&&a.push("premium:publisher:geoanalytics");!0===this.privilegeObj.premium.publisher.rasteranalysis&&a.push("premium:publisher:rasteranalysis");
!0===this.privilegeObj.marketplace.admin.purchase&&a.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&a.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&a.push("marketplace:admin:startTrial");!0===this.privilegeObj.notebooks.publisher.createNotebooks&&a.push("notebooks:publisher:createNotebooks");!0===this.privilegeObj.notebooks.publisher.scheduleNotebooks&&a.push("notebooks:publisher:scheduleNotebooks");!0===this.privilegeObj.notebooks.publisher.publishNotebooks&&
a.push("notebooks:publisher:publishNotebooks");!0===this.privilegeObj.notebooks.publisher.allowArcpyNotebooks&&a.push("notebooks:publisher:allowArcpyNotebooks");return a};return b=k.__decorate([d.default(c.default)],b)}()})},"arcgisonline/sharing/dijit/_LevelAwareMixin":function(){define(["require","exports"],function(b,h){return function(){return function(){this.SYSTEM_ROLES={VIEWER:"iAAAAAAAAAAAAAAA"};this.LICENSE_LEVELS={ONE:"1",TWO:"2"}}}()})},"arcgisonline/tsutils/declareDecorator":function(){define(["require",
"exports","tslib","dojo/_base/declare"],function(b,h,k,a){Object.defineProperty(h,"__esModule",{value:!0});a=k.__importDefault(a);h.default=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];return function(c){return a.default(b,c.prototype)}}})},"arcgisonline/map/core/canUseForPublish":function(){define(["dojo/_base/array"],function(b){function h(a,c){if("esriGeometryMultiPatch"===a.geometryType)return!1;var d=a.drawingInfo.renderer,e=a.drawingInfo.labelingInfo,f=a.featureReduction,
g=a.fields,k;if("heatmap"===d.type||"esriGeometryPolygon"===a.geometryType&&d.uniqueValueInfos&&d.visualVariables&&b.some(d.visualVariables,function(a){if("sizeInfo"===a.type&&!a.target)return!0}))return!1;k=b.map(b.filter(g,function(a){return"esriFieldTypeDate"===a.type}),function(a){return a.name});return k.length&&(-1<b.indexOf(k,d.field)||-1<b.indexOf(k,d.field1)||d.visualVariables&&b.some(d.visualVariables,function(a){if(a.field&&-1<b.indexOf(k,a.field))return!0}))||f||!c&&e&&e.length?!1:!0}
function k(a,c){var d=a.drawingInfo.renderer,e=a.drawingInfo.labelingInfo,f=a.featureReduction,g=a.fields,k;if(-1===b.indexOf(["esriGeometryPoint","esriGeometryMultiPatch"],a.geometryType)||d.observationRenderer||d.latestObservationRenderer||"heatmap"===d.type||d.valueExpression&&d.valueExpression.length)return!1;if(d.visualVariables)for(a=0;a<d.visualVariables.length;a++)if(d.visualVariables[a].valueExpression&&d.visualVariables[a].valueExpression.length)return!1;k=b.map(b.filter(g,function(a){return"esriFieldTypeDate"===
a.type}),function(a){return a.name});return k.length&&(-1<b.indexOf(k,d.field)||-1<b.indexOf(k,d.field1)||d.visualVariables&&b.some(d.visualVariables,function(a){if(a.field&&-1<b.indexOf(k,a.field))return!0}))||f||!c&&e&&e.length?!1:!0}return function(a,b,d){return"Feature Layer"===a.type&&a.drawingInfo?"scene"===d?k(a,b):h(a,b):!1}})},"arcgisonline/pages/dijit/Alert":function(){define("require exports tslib ../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/query dojo/text!./Alert/Alert.html dojo/i18n!../../nls/arcgisonline dojo/_base/lang".split(" "),
function(b,h,k,a,c,d,e,f,g,l){a=k.__importDefault(a);c=k.__importDefault(c);d=k.__importDefault(d);e=k.__importDefault(e);f=k.__importDefault(f);g=k.__importDefault(g);l=k.__importDefault(l);return function(){function b(){this.templateString=f.default;this.i18n=g.default}b.prototype.postMixInProperties=function(){"success"===this.type?(this.modifier="green",this.icon="Success",this.iconAltText=g.default.GroupWidget.successIcon):"error"===this.type&&(this.modifier="red",this.icon="Error",this.iconAltText=
g.default.GroupWidget.errorIcon)};b.prototype.postCreate=function(){this.inherited(arguments);this.listHTML&&(this._listContainer.innerHTML=this.listHTML);this._addEventListeners()};b.prototype._addEventListeners=function(){this.own(e.default(".js-alert-close",this.domNode).on("click",l.default.hitch(this,this._dismiss)))};b.prototype._dismiss=function(a){a.preventDefault();this.destroy()};return b=k.__decorate([a.default(c.default,d.default)],b)}()})},"arcgisonline/sharing/geow/Account":function(){define(["dojo",
"dijit","dojox","dojo/require!dojo/DeferredList,dojo/data/ItemFileReadStore,dojo/data/ItemFileWriteStore,dojo/data/util/sorter,dojo/json,arcgisonline/sharing/dijit/Role,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SimpleDlg,arcgisonline/sharing/util,arcgisonline/sharing/geow/Geow"],function(b,h,k){b.provide("arcgisonline.sharing.geow.Account");b.require("dojo.DeferredList");b.require("dojo.data.ItemFileReadStore");b.require("dojo.data.ItemFileWriteStore");b.require("dojo.data.util.sorter");
b.require("dojo.json");b.require("arcgisonline.sharing.dijit.Role");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.dialog.SimpleDlg");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Geow");arcgisonline.sharing.geow.Account={util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,displayedPortalNonSSLNotice:!1,getCurrentUserInfo:function(a,c){c=this.util.getUser();null!==c&&this.util.getJson(esriGeowConfig.restBaseUrl+
"community/users/"+(c.username||c.email),b.hitch(this,a))},i18n:function(){return this._i18n?this._i18n:this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common},loadMapSettings:function(a){this.geow.checkSharedCookie();arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,function(c,d){if(c){this.geow.setCookies(c);c.allSSL&&(esriGeowConfig.allSSL=c.allSSL);esri.isDefined(esriGeowConfig.allSSL)&&esriGeowConfig.allSSL&&"http:"===location.protocol&&(window.location=arcgisonline.sharing.util.getSecureUrl(location.href));
c.basemapGalleryGroupQuery&&(esriGeowConfig.basemapGalleryGroupQuery=c.basemapGalleryGroupQuery);c.templatesGroupQuery&&(esriGeowConfig.templatesGroupQuery=c.templatesGroupQuery);c.defaultBasemap&&(esriGeowConfig.defaultBasemap=c.defaultBasemap);c.defaultExtent&&(esriGeowConfig.defaultExtent=c.defaultExtent);c.symbolSetsGroupQuery&&(esriGeowConfig.symbolSetsGroupQuery=c.symbolSetsGroupQuery);c.staticImagesUrl&&(esriGeowConfig.staticImagesUrl=c.staticImagesUrl);c.layerTemplatesGroupQuery&&(esriGeowConfig.layerTemplatesGroupQuery=
c.layerTemplatesGroupQuery);c.colorSetsGroupQuery&&(esriGeowConfig.colorSetsGroupQuery=c.colorSetsGroupQuery);c.helpBase&&(esriGeowConfig.help=c.helpBase,esriGeowConfig.helpBase=c.helpBase);c.helpMap&&c.helpMap.m&&(esriGeowConfig.helpMap=c.helpMap.m);c.urlKey&&(esriGeowConfig.urlKey=c.urlKey);var e;if(c.authorizedCrossOriginDomains&&0<c.authorizedCrossOriginDomains.length)for(d=0;d<c.authorizedCrossOriginDomains.length;d++)e=c.authorizedCrossOriginDomains[d],esri.isDefined(e)&&0<e.length&&esri.config.defaults.io.corsEnabledServers.push({host:e,
withCredentials:!0});c.isPortal&&arcgisonline.sharing.util._cookies&&-1===arcgisonline.sharing.util._cookies.esri_auth&&delete arcgisonline.sharing.util._cookies.esri_auth;d=!1===esriGeowConfig.isMultiTenant;var f=(e=arcgisonline.sharing.util.getUser())?!0:!1,g=window.location.pathname.toLowerCase(),k=-1!=g.indexOf(esriGeowConfig.signin),h=-1!=g.indexOf("troubleshoot.html"),g=-1!=g.indexOf("setup.html");d||!e||"account_admin"!==e.role&&"org_admin"!==e.role||!c.id||c.urlKey||g||(window.location=esriGeowConfig.baseUrl+
"setup.html");if(d){!c.access||"private"!==c.access||f||this.isSignInPage||this.isTroubleshootPage||(window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location));e=b.query(".esriLogoIcon");for(d=0;d<e.length;d++)b.replaceClass(e[d],"esriLogoIcon esriOrgIcon");c.isPortal&&"singletenant"===c.portalMode&&("7080"!==location.port&&"7443"!==location.port||arcgisonline.sharing.util.checkForIAA().then(b.hitch(this,function(a){if(a&&a.hasIAA&&
(c.portalHostname.match(/:7080\//)&&"http:"===location.protocol&&-1===location.href.indexOf("error.html")&&(window.location=arcgisonline.sharing.util.getHttpUrl(esriGeowConfig.baseUrl)+"error.html?c\x3dWebAdaptorRequired"),!c.portalHostname.match(/:7080\//)&&80!==esriGeowConfig.self.httpPort&&443!==esriGeowConfig.self.httpsPort&&"http:"===location.protocol&&-1===location.href.indexOf("error.html"))){a=new b._Url(location.href);var d=a.path.indexOf("/home/"),d=a.path.substring(d+6);a=esri.isDefined(a.query)?
"?"+a.query:"";window.location=arcgisonline.sharing.util.getHttpUrl("http://"+c.portalHostname)+"/home/"+d+a}})))}else if(!c.id&&c.urlKey&&!f)k||h||(window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?returnUrl\x3d"+encodeURIComponent(window.location));else if(c.id&&c.urlKey&&!f)for(e=b.query(".esriLogoIcon"),d=0;d<e.length;d++)b.replaceClass(e[d],"esriLogoIcon esriOrgIcon")}a&&a(c)}))},getAccountResource:function(a,c,d,e){this.util.getJson(esriGeowConfig.restBaseUrl+
"portals/self/resources/"+c,b.hitch(this,d),b.hitch(this,e))},uploadAccountResource:function(a,c,d,e){this.util.postJson(c,esriGeowConfig.restBaseUrl+"portals/self/addResource",b.hitch(this,d),b.hitch(this,e))},deleteAccountResource:function(a,c,d,e){this.util.postJson({key:c},esriGeowConfig.restBaseUrl+"portals/self/removeResource",b.hitch(this,d),b.hitch(this,e))},getAccountSettings:function(a,c){this.util.getJson(esriGeowConfig.restBaseUrl+"portals/self/resources/accountSettings",b.hitch(this,
function(a){c&&c(a)}),b.hitch(this,function(a){c&&c({})}))},getSelf:function(a,c,d){if(this._isRequestingSelf)setTimeout(b.hitch(this,"getSelf",a,c),75);else{var e=esriGeowConfig.restBaseUrl+"portals/self?culture\x3d"+b.locale;d&&(e+="\x26token\x3d"+d);d=esriGeowConfig&&esriGeowConfig.self||this.util._requestWithAppHandlers({url:e}).then(b.hitch(this,function(a){this.setupAfterSelf(a);this._isRequestingSelf=!1;10>=b.isIE&&this.throwawayIEPostFix();return a}),b.hitch(this,function(a){throw a;}));this._isRequestingSelf=
!esriGeowConfig.self;return b.when(d,a,c)}},setupAfterSelf:function(a){esriGeowConfig.self=a;esriGeowConfig.userInfo=a.user&&b.mixin(esriGeowConfig.userInfo||{},a.user);a.user&&a.user.username&&(esriGeowConfig.userInfo.email=a.user&&a.user.username);a.user&&a.user.role&&(esriGeowConfig.userRole=new arcgisonline.sharing.dijit.Role({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),a.user.privileges&&esriGeowConfig.userRole.setPrivileges(a.user.privileges));this.normalizeOrgIdAndRole()},
normalizeOrgIdAndRole:function(){esri.isDefined(esriGeowConfig.self.user)&&(esri.isDefined(esriGeowConfig.self.user.orgId)&&(esriGeowConfig.self.user.accountId=esriGeowConfig.self.user.orgId),esri.isDefined(esriGeowConfig.self.user.role)&&(esriGeowConfig.self.user.role=this.util.normalizeOrgRole(esriGeowConfig.self.user.role)));esri.isDefined(esriGeowConfig.userInfo)&&(esri.isDefined(esriGeowConfig.userInfo.orgId)&&(esriGeowConfig.userInfo.accountId=esriGeowConfig.userInfo.orgId),esri.isDefined(esriGeowConfig.userInfo.role)&&
(esriGeowConfig.userInfo.role=this.util.normalizeOrgRole(esriGeowConfig.userInfo.role)))},throwawayIEPostFix:function(){var a=b.create("form",{encoding:"multipart/form-data",method:"POST"});b.create("input",{type:"hidden",name:"f",value:"json"},a);b.create("input",{type:"hidden",name:"q",value:"*"},a);b.create("input",{type:"hidden",name:"callback.html",value:"textarea"},a);b.io.iframe.send({url:esriGeowConfig.restBaseUrl+"community/users",form:a,handleAs:"json"}).then(function(a){}).otherwise(function(a){})},
activateAccount:function(a,b,d){null!==this.util.getUser()&&this.util.postJson({code:a},esriGeowConfig.restBaseUrl+"portals/activate",b,d)},getAccount:function(a,c,d){null!==this.util.getUser()&&this.util.getJson(esriGeowConfig.restBaseUrl+"portals/self",b.hitch(this,c))},updateAccount:function(a,c,d){if(null!==this.util.getUser()){var e="";a.defaultBasemap&&(e=b.json.stringify(a.defaultBasemap));var f=a.metadataFormats&&0<a.metadataFormats.length?a.metadataFormats.join(","):"",e={id:a.id,name:a.name,
description:a.description,access:a.access,allSSL:a.allSSL,culture:a.culture,cultureFormat:a.cultureFormat,region:a.region,featuredItemsGroupQuery:a.featuredItemsGroupQuery,canSharePublic:a.canSharePublic,canSearchPublic:a.canSearchPublic,thumbnail:a.thumbnail,basemapGalleryGroupQuery:a.basemapGalleryGroupQuery,defaultBasemap:e,defaultExtent:a.defaultExtent?b.json.stringify(a.defaultExtent):"",featuredGroups:b.json.stringify(a.featuredGroups),homePageFeaturedContent:a.homePageFeaturedContent,homePageFeaturedContentCount:a.homePageFeaturedContentCount,
rotatorPanels:b.json.stringify(a.rotatorPanels),showHomePageDescription:a.showHomePageDescription,templatesGroupQuery:a.templatesGroupQuery,analysisLayersGroupQuery:a.analysisLayersGroupQuery,galleryTemplatesGroupQuery:a.galleryTemplatesGroupQuery,stylesGroupQuery:a.stylesGroupQuery,urlKey:a.urlKey,commentsEnabled:a.commentsEnabled,geocodeService:b.json.stringify(a.helperServices.geocode),printServiceTask:b.json.stringify(a.helperServices.printTask),geometryService:b.json.stringify(a.helperServices.geometry),
routeServiceLayer:b.json.stringify(a.helperServices.route),bingKey:a.bingKey,canShareBingPublic:a.canShareBingPublic,backgroundImage:a.backgroundImage,canSignInIDP:a.canSignInIDP,canSignInArcGIS:a.canSignInArcGIS,useStandardizedQuery:a.useStandardizedQuery,portalProperties:b.json.stringify(a.portalProperties),units:a.units,mfaEnabled:a.mfaEnabled,mfaAdmins:b.json.stringify(a.mfaAdmins),metadataEditable:a.metadataEditable,metadataFormats:f,authorizedCrossOriginDomains:b.json.stringify(a.authorizedCrossOriginDomains),
allowedOrigins:a.allowedOrigins,allowedRedirectUris:b.json.stringify(a.allowedRedirectUris),updateUserProfileDisabled:a.updateUserProfileDisabled,useVectorBasemaps:a.useVectorBasemaps,eueiEnabled:a.eueiEnabled,clearEmptyFields:!0};esri.isDefined(a.helperServices.asyncRoute)&&(e.asyncRouteService=b.json.stringify(a.helperServices.asyncRoute));esri.isDefined(a.helperServices.closestFacility)&&(e.closestFacilityService=b.json.stringify(a.helperServices.closestFacility));esri.isDefined(a.helperServices.asyncClosestFacility)&&
(e.asyncClosestFacilityService=b.json.stringify(a.helperServices.asyncClosestFacility));esri.isDefined(a.helperServices.serviceArea)&&(e.serviceAreaService=b.json.stringify(a.helperServices.serviceArea));esri.isDefined(a.helperServices.asyncServiceArea)&&(e.asyncServiceAreaService=b.json.stringify(a.helperServices.asyncServiceArea));esri.isDefined(a.helperServices.syncVRP)&&(e.syncVRPService=b.json.stringify(a.helperServices.syncVRP));esri.isDefined(a.helperServices.asyncVRP)&&(e.asyncVRPService=
b.json.stringify(a.helperServices.asyncVRP));esri.isDefined(a.helperServices.asyncLocationAllocation)&&(e.asyncLocationAllocationService=b.json.stringify(a.helperServices.asyncLocationAllocation));esri.isDefined(a.helperServices.routingUtilities)&&(e.routingUtilitiesService=b.json.stringify(a.helperServices.routingUtilities));esri.isDefined(a.helperServices.traffic)&&(e.trafficService=b.json.stringify(a.helperServices.traffic));esri.isDefined(a.helperServices.asyncODCostMatrix)&&(e.asyncODCostMatrixService=
b.json.stringify(a.helperServices.asyncODCostMatrix));this.util.isPortal()?(esri.isDefined(a.helperServices.analysis)&&(e.analysisService=b.json.stringify(a.helperServices.analysis)),esri.isDefined(a.helperServices.asyncGeocode)&&(e.asyncGeocodeService=b.json.stringify(a.helperServices.asyncGeocode)),esri.isDefined(a.helperServices.geoenrichment)&&(e.geoenrichmentService=b.json.stringify(a.helperServices.geoenrichment)),esri.isDefined(a.helperServices.hydrology)&&(e.hydrologyService=b.json.stringify(a.helperServices.hydrology)),
esri.isDefined(a.helperServices.orthomappingElevation)&&(e.orthomappingElevationService=b.json.stringify(a.helperServices.orthomappingElevation)),esri.isDefined(a.helperServices.elevation)&&(e.elevationService=b.json.stringify(a.helperServices.elevation)),esri.isDefined(a.helperServices.elevationSync)&&(e.elevationSyncService=b.json.stringify(a.helperServices.elevationSync)),esri.isDefined(a.helperServices.defaultElevationLayers)&&(e.elevation3DService=b.json.stringify(a.helperServices.defaultElevationLayers))):
e.contacts=b.json.stringify(a.contacts);a=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"portals/self/update";this.util.postJson(e,a,b.hitch(this,c),b.hitch(this,d))}},getAccountGroups:function(a,c,d,e){if(null!==this.util.getUser()){e=1;var f=10;null!==c.start&&(e=c.start);null!==c.num&&(f=c.num);a="(orgid:"+a+" AND (access:org OR access:public)";this.util.isPortal()&&(a+=" -owner:esri_nav -owner:esri_livingatlas -owner:esri_boundaries -owner:esri_demographics");this.util.getJson(esriGeowConfig.restBaseUrl+
"community/groups?q\x3d"+(a+")")+"\x26sortField\x3dtitle\x26sortOrder\x3dasc\x26start\x3d"+e+"\x26num\x3d"+f,b.hitch(this,d))}},checkUsernames:function(a,b,d){a=a&&0<a.length?a.join(","):"";this.util.postJson({usernames:a},esriGeowConfig.restBaseUrl+"community/checkUsernames",b,d)},inviteUsers:function(a,b,d){null!==this.util.getUser()&&this.util.postJson(a,esriGeowConfig.restBaseUrl+"portals/self/invite",b,d)},inviteAccountUsersByEmail:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson(c,
esriGeowConfig.restBaseUrl+"portals/self/inviteByEmail",b.hitch(this,d),b.hitch(this,e))},getPendingAccountUsers:function(a,c,d,e){if(null!==this.util.getUser()){a=1;e=10;var f,g,k;esri.isDefined(c.start)&&(a=c.start);esri.isDefined(c.num)&&(e=c.num);esri.isDefined(c.sortField)&&(f=c.sortField);esri.isDefined(c.sortOrder)&&(g=c.sortOrder);esri.isDefined(c.type)&&(k=c.type);c=esriGeowConfig.restBaseUrl+"portals/self/invitations?start\x3d"+a+"\x26num\x3d"+e;f&&(c+="\x26sortField\x3d"+f);g&&(c+="\x26sortOrder\x3d"+
g);k&&(c+="\x26type\x3d"+k);this.util.getJson(c,b.hitch(this,d))}},retrieveInvitations:function(a,b,d){a=esriGeowConfig.restBaseUrl+"portals/self/invitations?start\x3d"+a+"\x26num\x3d"+b;d&&(a+="\x26type\x3d"+d);return this.util.request({url:a})},getInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+a,b.hitch(this,c),d)},acceptInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({invitationId:a},esriGeowConfig.restBaseUrl+
"community/invitations/"+a+"/accept",b.hitch(this,c),b.hitch(this,d))},declineInvitation:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"community/invitations/"+a+"/decline",b.hitch(this,c))},approvePendingInvitation:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"portals/self/invitations/"+c+"/approve",b.hitch(this,d))},removePendingInvitation:function(a,c,d,e){null!==this.util.getUser()&&this.util.postJson({},
esriGeowConfig.restBaseUrl+"portals/self/invitations/"+c+"/delete",b.hitch(this,d))},getAccountUsers:function(a,c,d,e){if(null!==this.util.getUser()){a=1;e=10;var f,g,k,h;esri.isDefined(c.start)&&(a=c.start);esri.isDefined(c.num)&&(e=c.num);esri.isDefined(c.sortField)&&(f=c.sortField);esri.isDefined(c.sortOrder)&&(g=c.sortOrder);esri.isDefined(c.adminOnly)&&(k=c.adminOnly);esri.isDefined(c.excludeSystemUsers)&&(h=c.excludeSystemUsers);c=esriGeowConfig.restBaseUrl+"portals/self/users?start\x3d"+a+
"\x26num\x3d"+e;f&&(c+="\x26sortField\x3d"+f);g&&(c+="\x26sortOrder\x3d"+g);k&&(c+="\x26role\x3dorg_admin");h&&(c+="\x26excludeSystemUsers\x3dtrue");this.util.getJson(c,b.hitch(this,d))}},searchAccountUsers:function(a,c,d,e){null!==this.util.getUser()&&(a=1,e=10,esri.isDefined(c.start)&&(a=c.start),esri.isDefined(c.num)&&(e=c.num),a=esriGeowConfig.restBaseUrl+"portals/self/users?start\x3d"+a+"\x26num\x3d"+e,esri.isDefined(c.sortField)&&(a+="\x26sortField\x3d"+c.sortField),esri.isDefined(c.sortOrder)&&
(a+="\x26sortOrder\x3d"+c.sortOrder),esri.isDefined(c.role)&&(a+="\x26role\x3d"+c.role),esri.isDefined(c.username)&&(a+="\x26username\x3d"+c.username),esri.isDefined(c.fullname)&&(a+="\x26fullname\x3d"+c.fullname),esri.isDefined(c.lastname)&&(a+="\x26lastname\x3d"+c.lastname),esri.isDefined(c.firstname)&&(a+="\x26firstname\x3d"+c.firstname),esri.isDefined(c.excludeSystemUsers)&&(a+="\x26excludeSystemUsers\x3dtrue"),this.util.getJson(a,b.hitch(this,d)))},searchAccountGroups:function(a,c,d,e,f){if(null!==
this.util.getUser()){var g=1,k=10;null!==d.start&&(g=d.start);null!=d.num&&(k=d.num);this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+("("+c+" orgid:"+a+")")+"\x26start\x3d"+g+"\x26num\x3d"+k+"\x26sortField\x3dtitle\x26sortOrder\x3dasc",b.hitch(this,e),b.hitch(this,f))}},updateUserRole:function(a,c,d,e){var f=null,g=this.util.getUser();if(null!==g){var f=g.accountId,k=g.username||g.email;null!==f&&(k===a&&"account_admin"===g.role&&"account_admin"!==c?(a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
a.onOkClick=function(){h.byId("general-dialog").hide();d(null)},a.show({title:"Account Administrator",message:"You are an account administrator and cannot remove yourself from the administrator role. Another account administrator must change your role."})):this.util.postJson({user:a,role:c},esriGeowConfig.restBaseUrl+"portals/self/updateUserRole",b.hitch(this,d),b.hitch(this,e)))}},deleteUser:function(a,c,d){null!==this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"community/users/"+
a+"/delete",b.hitch(this,c),b.hitch(this,d))},blankUserStore:function(){return new b.data.ItemFileReadStore({data:{identifier:"username",label:"fullName",items:[]}})},caseInsensitiveComparator:function(a,c){a&&(a=a.toLowerCase());c&&(c=c.toLowerCase());return b.data.util.sorter.basicComparator(a,c)},lastLoginComparator:function(a,c){var d=0===a||-1===a?void 0:a,e=0===c||-1===c?void 0:c,f=-1;esriGeowConfig.self&&esriGeowConfig.self.isPortal||!1===esriGeowConfig.isMultiTenant?f=b.data.util.sorter.basicComparator(d,
e):d==e?f=a==c?0:a<c?-1:1:d&&e&&a>c?f=1:d&&!e?f=1:!d&&e&&(f=-1);return f},pendingUsersToStore:function(a,c){var d=[];b.forEach(a,function(a,b){d[b]={id:a.id,fromUsername:a.fromUsername,email:a.email,username:a.username,role:this.util.normalizeOrgRole(a.role),targetId:a.targetId,type:a.type,targetType:a.targetType,mustApprove:a.mustApprove,accepted:a.accepted,dateAccepted:a.dateAccepted,expiration:a.expiration,created:a.created,culture:c}},this);a=new b.data.ItemFileReadStore({data:{identifier:"id",
label:"fullName",items:d}});a.comparatorMap={email:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,username:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};return a},usersToStore:function(a,c){var d=[];b.forEach(a,function(a,b){d[b]={email:a.email,fullName:a.fullName,username:a.username,created:a.created,storageUsage:a.storageUsage,role:this.util.normalizeOrgRole(a.role),lastLogin:a.lastLogin,culture:c,disabled:a.disabled,idpUsername:a.idpUsername,userType:a.userType,mfaEnabled:a.mfaEnabled,
availableCredits:a.availableCredits,assignedCredits:a.assignedCredits};esriGeowConfig.userLicenseLevelsEnabled&&(d[b].level=a.level||"2")},this);a=new b.data.ItemFileReadStore({data:{identifier:"username",label:"fullName",items:d}});a.comparatorMap={fullName:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,username:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,lastLogin:arcgisonline.sharing.geow.Account.lastLoginComparator};return a},groupsToStore:function(a){var c=[];b.forEach(a,
function(a,b){c[b]={id:a.id,title:a.title}},this);return new b.data.ItemFileWriteStore({data:{identifier:"id",label:"group",items:c}})},getSupportedLanguages:function(a,b){return esri.request({url:esriGeowConfig.restBaseUrl+"portals/languages",content:{f:"json"},load:a,callbackParamName:"callback",error:b})},getSupportedRegions:function(a,c){return esri.request({url:esriGeowConfig.restBaseUrl+"portals/regions",content:{f:"json",culture:b.locale},load:a,callbackParamName:"callback",error:c})},getSupportedLanguagesAndRegions:function(a,
c){var d=new b.Deferred;(void 0!==a&&null!==a||void 0!==c&&null!==c)&&d.addBoth(a,c);a=[];a.push(arcgisonline.sharing.geow.Account.getSupportedLanguages(null,null));a.push(arcgisonline.sharing.geow.Account.getSupportedRegions(null,null));a=new b.DeferredList(a);a.addCallback(function(a){var b={};b.languages=a[0][1];b.regions=a[1][1];d.callback(b)});a.addErrback(function(a){d.callback(a)});return d}}})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),
function(b,h,k,a,c,d,e){return h("dojo.data.ItemFileWriteStore",d,{constructor:function(a){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(a){return e.toISOString(a,{zulu:!0})});a&&!1===a.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(a){if(!a)throw Error("assertion failed in ItemFileWriteStore");
},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(a,c){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof a&&"undefined"!=typeof a)throw Error("newItem() was passed something other than an object");var d=null,e=this._getIdentifierAttribute();if(e===Number)d=this._arrayOfAllItems.length;else{d=a[e];if("undefined"===typeof d)throw Error("newItem() was not passed an identity for the new item");if(b.isArray(d))throw Error("newItem() was not passed an single-valued identity");
}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[d]);this._assert("undefined"===typeof this._pending._newItems[d]);this._assert("undefined"===typeof this._pending._deletedItems[d]);var f={};f[this._storeRefPropName]=this;f[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[d]=f,f[e]=[d]);this._arrayOfAllItems.push(f);e=null;if(c&&c.parent&&c.attribute){var e={item:c.parent,attribute:c.attribute,oldValue:void 0},g=this.getValues(c.parent,
c.attribute);if(g&&0<g.length){var k=g.slice(0,g.length);e.oldValue=1===g.length?g[0]:g.slice(0,g.length);k.push(f);this._setValueOrValues(c.parent,c.attribute,k,!1);e.newValue=this.getValues(c.parent,c.attribute)}else this._setValueOrValues(c.parent,c.attribute,f,!1),e.newValue=f}else f[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(f);this._pending._newItems[d]=f;for(var h in a){if(h===this._storeRefPropName||h===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
c=a[h];b.isArray(c)||(c=[c]);f[h]=c;if(this.referenceIntegrity)for(d=0;d<c.length;d++)g=c[d],this.isItem(g)&&this._addReferenceToMap(g,f,h)}this.onNew(f,e);return f},_removeArrayElement:function(a,b){b=k.indexOf(a,b);return-1!=b?(a.splice(b,1),!0):!1},deleteItem:function(a){this._assert(!this._saveInProgress);this._assertIsItem(a);var c=a[this._itemNumPropName],d=this.getIdentity(a);if(this.referenceIntegrity){var e=this.getAttributes(a);a[this._reverseRefMap]&&(a["backup_"+this._reverseRefMap]=b.clone(a[this._reverseRefMap]));
k.forEach(e,function(b){k.forEach(this.getValues(a,b),function(c){this.isItem(c)&&(a["backupRefs_"+this._reverseRefMap]||(a["backupRefs_"+this._reverseRefMap]=[]),a["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(c),attr:b}),this._removeReferenceFromMap(c,a,b))},this)},this);if(e=a[this._reverseRefMap])for(var f in e){var h=null;if(h=this._itemsByIdentity?this._itemsByIdentity[f]:this._arrayOfAllItems[f])for(var t in e[f]){var p=this.getValues(h,t)||[],u=k.filter(p,function(a){return!(this.isItem(a)&&
this.getIdentity(a)==d)},this);this._removeReferenceFromMap(a,h,t);u.length<p.length&&this._setValueOrValues(h,t,u,!0)}}}this._arrayOfAllItems[c]=null;a[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[d];this._pending._deletedItems[d]=a;a[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,a);this.onDelete(a);return!0},setValue:function(a,b,c){return this._setValueOrValues(a,b,c,!0)},setValues:function(a,b,c){return this._setValueOrValues(a,
b,c,!0)},unsetAttribute:function(a,b){return this._setValueOrValues(a,b,[],!0)},_setValueOrValues:function(a,c,d,e){this._assert(!this._saveInProgress);this._assertIsItem(a);this._assert(b.isString(c));this._assert("undefined"!==typeof d);var f=this._getIdentifierAttribute();if(c==f)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var f=this._getValueOrValues(a,c),g=this.getIdentity(a);if(!this._pending._modifiedItems[g]){var l={},h;for(h in a)l[h]=
h===this._storeRefPropName||h===this._itemNumPropName||h===this._rootItemPropName?a[h]:h===this._reverseRefMap?b.clone(a[h]):a[h].slice(0,a[h].length);this._pending._modifiedItems[g]=l}g=!1;if(b.isArray(d)&&0===d.length){if(g=delete a[c],d=void 0,this.referenceIntegrity&&f){h=f;b.isArray(h)||(h=[h]);for(var m=0;m<h.length;m++)l=h[m],this.isItem(l)&&this._removeReferenceFromMap(l,a,c)}}else{g=b.isArray(d)?d.slice(0,d.length):[d];if(this.referenceIntegrity)if(f){h=f;b.isArray(h)||(h=[h]);var w={};k.forEach(h,
function(a){this.isItem(a)&&(a=this.getIdentity(a),w[a.toString()]=!0)},this);k.forEach(g,function(b){if(this.isItem(b)){var d=this.getIdentity(b);w[d.toString()]?delete w[d.toString()]:this._addReferenceToMap(b,a,c)}},this);for(m in w)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[m]:this._arrayOfAllItems[m],a,c)}else for(m=0;m<g.length;m++)l=g[m],this.isItem(l)&&this._addReferenceToMap(l,a,c);a[c]=g;g=!0}if(e)this.onSet(a,c,f,d);return g},_addReferenceToMap:function(a,
b,c){b=this.getIdentity(b);var d=a[this._reverseRefMap];d||(d=a[this._reverseRefMap]={});(a=d[b])||(a=d[b]={});a[c]=!0},_removeReferenceFromMap:function(a,b,c){b=this.getIdentity(b);var d=a[this._reverseRefMap],e;if(d){for(e in d)e==b&&(delete d[e][c],this._isEmpty(d[e])&&delete d[e]);this._isEmpty(d)&&delete a[this._reverseRefMap]}},_dumpReferenceMap:function(){var a;for(a=0;a<this._arrayOfAllItems.length;a++);},_getValueOrValues:function(a,b){var c=void 0;this.hasAttribute(a,b)&&(a=this.getValues(a,
b),c=1==a.length?a[0]:a);return c},_flatten:function(a){if(this.isItem(a))return{_reference:this.getIdentity(a)};if("object"===typeof a)for(var c in this._datatypeMap){var d=this._datatypeMap[c];if(b.isObject(d)&&!b.isFunction(d)){if(a instanceof d.type){if(!d.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+c+"]");return{_type:c,_value:d.serialize(a)}}}else if(a instanceof d)return{_type:c,_value:a.toString()}}return a},_getNewFileContentString:function(){var b=
{},c=this._getIdentifierAttribute();c!==Number&&(b.identifier=c);this._labelAttr&&(b.label=this._labelAttr);b.items=[];for(c=0;c<this._arrayOfAllItems.length;++c){var d=this._arrayOfAllItems[c];if(null!==d){var e={},k;for(k in d)if(k!==this._storeRefPropName&&k!==this._itemNumPropName&&k!==this._reverseRefMap&&k!==this._rootItemPropName){var h=this.getValues(d,k);if(1==h.length)e[k]=this._flatten(h[0]);else for(var t=[],p=0;p<h.length;++p)t.push(this._flatten(h[p])),e[k]=t}b.items.push(e)}}return a.toJson(b,
!0)},_isEmpty:function(a){var c=!0;if(b.isObject(a))for(var d in a){c=!1;break}else b.isArray(a)&&0<a.length&&(c=!1);return c},save:function(a){this._assert(!this._saveInProgress);this._saveInProgress=!0;var b=this,d=function(){b._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};b._saveInProgress=!1;a&&a.onComplete&&a.onComplete.call(a.scope||c.global)},e=function(d){b._saveInProgress=!1;a&&a.onError&&a.onError.call(a.scope||c.global,d)};if(this._saveEverything){var f=this._getNewFileContentString();
this._saveEverything(d,e,f)}this._saveCustom&&this._saveCustom(d,e);this._saveEverything||this._saveCustom||d()},revert:function(){this._assert(!this._saveInProgress);for(var a in this._pending._modifiedItems){var c=this._pending._modifiedItems[a],d=null,d=this._itemsByIdentity?this._itemsByIdentity[a]:this._arrayOfAllItems[a];c[this._storeRefPropName]=this;for(var e in d)delete d[e];b.mixin(d,c)}var h;for(a in this._pending._deletedItems)h=this._pending._deletedItems[a],h[this._storeRefPropName]=
this,c=h[this._itemNumPropName],h["backup_"+this._reverseRefMap]&&(h[this._reverseRefMap]=h["backup_"+this._reverseRefMap],delete h["backup_"+this._reverseRefMap]),this._arrayOfAllItems[c]=h,this._itemsByIdentity&&(this._itemsByIdentity[a]=h),h[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(h);for(a in this._pending._deletedItems)h=this._pending._deletedItems[a],h["backupRefs_"+this._reverseRefMap]&&(k.forEach(h["backupRefs_"+this._reverseRefMap],function(a){this._addReferenceToMap(this._itemsByIdentity?
this._itemsByIdentity[a.id]:this._arrayOfAllItems[a.id],h,a.attr)},this),delete h["backupRefs_"+this._reverseRefMap]);for(a in this._pending._newItems)c=this._pending._newItems[a],c[this._storeRefPropName]=null,this._arrayOfAllItems[c[this._itemNumPropName]]=null,c[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,c),this._itemsByIdentity&&delete this._itemsByIdentity[a];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(a){return a?
(a=this.getIdentity(a),(new Boolean(this._pending._newItems[a]||this._pending._modifiedItems[a]||this._pending._deletedItems[a])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(a,b,c,d){},onNew:function(a,b){},onDelete:function(a){},close:function(a){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"arcgisonline/sharing/dijit/dialog/SimpleDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/form/Button,dijit/_Widget,dijit/_Templated"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.dialog.SimpleDlg");b.require("dijit.Dialog");b.require("dijit.form.Button");b.require("dijit._Widget");b.require("dijit._Templated");b.declare("arcgisonline.sharing.dijit.dialog.SimpleDlg",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"dialog" title\x3d"${title}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_content"\x3e${content}\x3c/div\x3e\x3cbr /\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing right"\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick: hide" class\x3d"primary" type\x3d"button"\x3e${i18n.ok}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()}})})},"arcgisonline/sharing/geow/Geow":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/map/utils/deleteMapStorageNoFeedback"],function(b,h,k){b.provide("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.util");b.require("arcgisonline.map.utils.deleteMapStorageNoFeedback");
arcgisonline.sharing.geow.Geow={util:arcgisonline.sharing.util,generatetoken:function(a,b,d){var c=esriGeowConfig.restBaseUrl.replace("http:","https:")+"generatetoken",f=document.domain,g=f.split(".");1<g.length&&(f=g[g.length-2]+"."+g[g.length-1]);a.referer=f;this._tokenExpiration=a.expiration;this.util.postJson(a,c,b,d)},signup:function(a,b,d){var c=esriGeowConfig.restBaseUrl+"community/signup",f=document.domain,g=f.split(".");1<g.length&&(f=g[g.length-2]+"."+g[g.length-1]);a.referer=f;this.util.postJson(a,
c,b,d)},signin:function(a,c,d){this.generatetoken(a,b.hitch(arcgisonline.sharing.geow.Geow,"signInHandler",a.username,c,d),d)},setAuthCookie:function(a,c){var d=document.domain,e={path:"/"};a.persistent&&(e.expires=new Date(a.expires));"https:"===window.location.protocol&&a.allSSL&&(e.secure=!0);a.portalApp&&delete a.portalApp;!esriGeowConfig.isDebug&&esriGeowConfig.self&&!esriGeowConfig.self.isPortal&&esriGeowConfig.self.urlKey?(a.urlKey=esriGeowConfig.self&&esriGeowConfig.self.urlKey,a.customBaseUrl=
esriGeowConfig.self&&esriGeowConfig.self.urlKey&&esriGeowConfig.self.customBaseUrl||esriGeowConfig.self.portalHostname||window.location.hostname,b.cookie("esri_auth",b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"}))):esriGeowConfig.isDebug||!esriGeowConfig.self||esriGeowConfig.self.isPortal?c&&(esriGeowConfig.self.isPortal||b.cookie("esri_auth",b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"}))):(a.customBaseUrl=esriGeowConfig.self&&esriGeowConfig.self.portalHostname||window.location.hostname,
b.cookie("esri_auth",b.json.stringify(a),b.mixin(e,{domain:"arcgis.com"})));b.cookie("esri_auth",b.json.stringify(b.mixin({portalApp:!0},a)),b.mixin(e,{domain:d}));(a=arcgisonline.sharing.util._cookies)&&a.esri_auth&&(a.esri_auth=null,arcgisonline.sharing.util.getCookie("esri_auth"))},signInHandler:function(a,c,d,e,f){var g=new Date,k=new Date(g.setMinutes(g.getMinutes()+(this._tokenExpiration||120))),g=b.hitch(this,function(a,d){a.culture&&(a.culture=a.culture.toLowerCase());d={email:a.username,
privacy:a.privacy,token:e.token,ssl:e.ssl,culture:a.culture,region:a.region,expires:k.getTime()};a.orgId&&a.role&&(d.accountId=a.orgId,d.role=a.role);this.setAuthCookie(d);if(a.preferredView&&null!==a.preferredView)this.util.userPreferences({contentMode:a.preferredView},esriGeowConfig.contentModeCookieName);else{var g=this.util.userPreferences(null,esriGeowConfig.contentModeCookieName);if(g&&g.contentMode){var h=b.create,l=h("form",{method:"POST"},b.body());h("input",{type:"hidden",name:"preferredView",
value:g.contentMode},l);h("input",{type:"hidden",name:"clearEmptyFields",value:"false"},l);arcgisonline.sharing.geow.Community.updateProfile(l,function(a){})}}d=b.mixin(d,a);c&&c(d,f);b.publish("onSignIn",[d])});this.util.getJson(this.util.useSSL(esriGeowConfig.restBaseUrl+"community/users/"+a+"?token\x3d"+e.token),b.hitch(this,g),d)},signInHandler2:function(a){var c=esriGeowConfig.restBaseUrl+"community/users/"+a.username+"?token\x3d"+a.token,d=new Date,e=Number(a.expires_in),f=new Date(d.setSeconds(d.getSeconds()+
Number(e))),g=a&&!!a.ssl;return this.util.getJson(this.util.useSSL(c)).then(b.hitch(this,"_hasSecurityQuestion")).then(b.hitch(this,function(c){var d={email:c.username,privacy:c.privacy,token:a.token,culture:c.culture&&c.culture.toLowerCase()||"",region:c.region,expires:f&&f.getTime()||null,persistent:a.persist?!0:void 0,allSSL:g};c.orgId&&c.role&&(d.accountId=c.orgId,d.role=c.role);c.preferredView&&this.util.userPreferences({contentMode:c.preferredView},esriGeowConfig.contentModeCookieName);this.setAuthCookie(d);
d=b.mixin(d,c);b.publish("onSignIn",[d]);return d}))},_hasSecurityQuestion:function(a){var c=new b.Deferred;a.validateUserProfile=!0;!a||a.idpUsername||"arcgisonly"!==a.userType&&"both"!==a.userType||!a.validateUserProfile?c.resolve(a):c=this.util.request({url:esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/forgotPassword",content:{}},{}).then(b.hitch(this,function(b){b&&"enterprise"!==b.provider&&-1===b.securityQuestionIdx&&(a.noSecurityQuestion=!0);return a}));return c},signout:function(a){var c=
this.util.getCookie("esri_auth");esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});arcgisonline.map.utils.deleteMapStorageNoFeedback().then(function(){b.publish("onSignOut",[])});var d;a&&(d=b.mixin({},{client_id:"arcgisonline",redirect_uri:a}));c&&c.token&&esriGeowConfig.self&&esriGeowConfig.self.user&&"enterprise"===esriGeowConfig.self.user.provider&&(d=b.mixin(d||{},{token:c.token}));a=a||window.location.href;
window.location=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl+"oauth2/signout")+(d?"?"+b.objectToQuery(d):"")},checkSharedCookie:function(){var a=this.util.getCookie("esri_auth"),c=!1;a&&!a.portalApp&&!a.urlKey&&location.hostname.match(/\.+\maps.*\..+\..+/i)&&(c=!0);!c&&a&&!a.portalApp&&a.customBaseUrl&&-1===document.domain.toLowerCase().indexOf(a.customBaseUrl.toLowerCase())&&-1===a.customBaseUrl.toLowerCase().indexOf(document.domain.toLowerCase())&&(c=!0);!c&&a&&!a.portalApp&&
a.urlKey&&-1===window.location.hostname.toLowerCase().indexOf(a.urlKey.toLowerCase()+".")&&(c=!0);c&&(b.cookie("esri_auth",null,{expires:-1,path:"/",domain:".arcgis.com"}),arcgisonline.sharing.util&&arcgisonline.sharing.util._cookies&&arcgisonline.sharing.util._cookies.esri_auth&&delete arcgisonline.sharing.util._cookies.esri_auth)},setCookies:function(a){var b=this.util.getCookie("esri_auth");!a.isPortal&&b&&(!esriGeowConfig.isDebug&&a.urlKey&&-1===window.location.hostname.toLowerCase().indexOf(a.urlKey.toLowerCase())?
(a=window.location.href.replace(window.location.hostname,a.urlKey+"."+a.customBaseUrl),window.location=this.util.getBridgeUrl(a,b)):b.portalApp?b.portalApp&&(esriGeowConfig.isDebug||this.setAuthCookie(b)):(delete b.urlKey,delete b.customBaseUrl,this.setAuthCookie(b)))}}})},"arcgisonline/map/utils/deleteMapStorageNoFeedback":function(){define(["dojo/Deferred","dojo/cookie","arcgisonline/persist"],function(b,h,k){return function(){var a=new b,c=new k.Store("ESRI_Webmap");sessionStorage.removeItem("Esri_webmap");
h("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});try{c.set("webmap",""),localStorage.removeItem("PSESRI__WebmapPSwebmap")}catch(d){}a.resolve(!0);return a}})},"arcgisonline/sharing/geow/Community":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/NotificationsDlg"],function(b,h,k){b.provide("arcgisonline.sharing.geow.Community");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.NotificationsDlg");
arcgisonline.sharing.geow.Community={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").community);return this._i18n},getProfile:function(a,c,d){if(null===a)return b.publish("globalMessage",[{message:this.i18n().noUser,type:"error",duration:0}]),null;this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+a,c,null)},getProfileThumbnailUrl:function(a,
b){if(null!==a.thumbnail){var c=this.util.getToken();return b?(b=esriGeowConfig.restBaseUrl,esriGeowConfig.useDefaultIdentityStore&&(b=!1!==esriGeowConfig.useSSL?this.util.getSecureUrl(b):b),b+"community/users/"+a.username+"/info/"+a.thumbnail+(null===c||0===c.length?"":"?token\x3d"+c)):esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/info/"+a.thumbnail+(null===c||0===c.length?"":"?token\x3d"+c)}return null},updateProfile:function(a,c,d){d=this.util.getUser();null==d&&b.publish("globalMessage",
[{message:this.i18n().mustLogIn,type:"error",duration:0}]);d=d.username||d.email;d=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+d+"/update";this.util.postForm(a,d,c)},updateProfileByUser:function(a,b,d){null!=this.util.getUser()&&(d=this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"community/users/"+a.username.value+"/update",this.util.postForm(a,d,b))},getUserGroups:function(a,c){var d=this.util.getUser();(d=d&&(d.username||d.email))?a=this.getUserGroupsByUser(d,a,c):(a=
new b.Deferred,a.resolve());return a},getUserGroupsByUser:function(a,c,d){a=esriGeowConfig.restBaseUrl+"community/users/"+a;var e=new b.Deferred;this.util.request({url:a}).then(b.hitch(this,function(a){e.resolve(a);c&&c(a)}),b.hitch(this,function(a){e.reject(a);d&&d(a)}));return e},getGroup:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups/"+a,b,d)},createGroup:function(a,b,d){null!=this.util.getUser()&&this.util.postForm(a,esriGeowConfig.restBaseUrl+"community/createGroup",
b,d)},updateGroup:function(a,b,d,e){null!=this.util.getUser()&&this.util.postForm(b,esriGeowConfig.restBaseUrl+"community/groups/"+a+"/update",d,e)},deleteGroup:function(a,b,d){null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/delete",b,d)},reassignGroup:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson({targetUsername:b},esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/reassign",d,e)},leaveGroup:function(a,b,d){this.util.postJson("",
esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/leave",b,d)},inviteToGroup:function(a,b,d){null!=this.util.getUser()&&this.util.globalMessage("TODO: not implemented in rest","error",0)},searchGroups:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+a,b)},searchToStore:function(a){var c=[];b.forEach(a.results,function(a,b){a={id:b,title:this._getGroupTitleLink(a),owner:a.owner,description:a.description,imageUrl:a.imageUrl,tags:a.keywords,created:a.created};
c[b]=a},this);return new b.data.ItemFileReadStore({data:{identifier:"id",label:"item",items:c}})},_getGroupTitleLink:function(a){return"\x3ca href\x3d'group.html?owner\x3d"+a.owner+"\x26title\x3d"+encodeURIComponent(a.title)+'\' class\x3d"esriGroupTitle" alt\x3d'+this.i18n().viewGroupDetails+" title\x3d"+this.i18n().viewGroupDetails+"\x3e"+a.title+"\x3c/a\x3e"},getNotifications:function(){arcgisonline.sharing.dijit.dialog.NotificationsDlg.prototype.statics.getInstance().show()},getNotificationsCount:function(){var a=
this.util.getUser();if(null!=a){var c=function(a,c){b.publish("onNotificationCount",[a.notifications.length])},d;this.util.getJson(esriGeowConfig.restBaseUrl+"community/users/"+(a.username||a.email)+"/notifications").then(b.hitch(this,function(a){d=(a&&a.notifications||[]).filter(function(a){return a&&"message_received"!==a.type});c({notifications:d})}))}},deleteNotifictation:function(a){var c=this.util.getUser();null!=c&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+(c.username||
c.email)+"/notifications/"+a+"/delete",b.hitch(this,function(a,c){b.publish("onNotificationDelete",[""])}))},updateUserSecure:function(a,b,d,e){e=esriGeowConfig.restBaseUrl;esriGeowConfig.useDefaultIdentityStore&&(e=!1!==esriGeowConfig.useSSL?this.util.getSecureUrl(e):e);this.util.postForm(b,e+"community/users/"+a+"/update",d)},getProvisionedListings:function(a,b,d){return this.util.request({url:esriGeowConfig.restBaseUrl+"community/users/"+a+"/provisionedListings",content:{start:b||1,num:d||100}})}}})},
"arcgisonline/sharing/dijit/dialog/NotificationsDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/NotificationsList"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.dialog.NotificationsDlg");b.require("dijit.Dialog");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.dijit.NotificationsList");b.declare("arcgisonline.sharing.dijit.dialog.NotificationsDlg",[h._Widget,h._Templated],
{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \t\x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_notificationDlg" title\x3d"${i18n.notificationDlgTitle}" style\x3d"width:435px;"\x3e\r\n\t\t\x3clabel \x3e${i18n.notificationMsg}\x3c/label\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" id\x3d"notificationsContainer"\r\n\t\t\t\t\t\t data-dojo-props\x3d"region:\'center\',gutters:false,design:\'headline\'" jsid\x3d"container" style\x3d"height: 180px;"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region:\'top\',splitter:false"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"arcgisonline/sharing/dijit/NotificationsList" jsid\x3d"notificationsList" id\x3d"notificationsList"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t  \t\x3cbr /\x3e\r\n\t  \t\x3cdiv class\x3d"esriFloatTrailing right" style\x3d"padding-top:0px; padding-bottom:5px;"\x3e\r\n\t\t  \t\x3cbutton id\x3d"button_notifications-close" data-dojo-type\x3d"dijit/form/Button"\r\n\t\t\t\t\t\t\t\tclass\x3d"primary" data-dojo-attach-event\x3d"onClick:_handleCloseBtn"\x3e${i18n.close}\x3c/button\x3e\r\n\t  \t\x3c/div\x3e\r\n  \t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
i18n:null,_notificationDlg:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.NotificationsDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").notificationsDlg)},postCreate:function(){this.loadConnections()},show:function(){notificationsList.loadList();
this._notificationDlg.show()},loadConnections:function(){b.subscribe("onNotificationDelete",this,"onNotificationDelete")},_handleCloseBtn:function(a){a.preventDefault();this._notificationDlg.hide()},onNotificationDelete:function(){notificationsList.updateList()},hide:function(){this._notificationDlg.hide()}})})},"arcgisonline/sharing/dijit/NotificationsList":function(){define("require dojo/_base/declare dojo/_base/lang dojo/date/locale dojo/dom dojo/string dojo/topic dijit/_WidgetBase ../util dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(b,h,k,a,c,d,e,f,g,l){return h([f],{declaredClass:"arcgisonline.sharing.dijit.NotificationsList",basePath:b.toUrl("arcgisonline/sharing/dijit"),postMixInProperties:function(){this.inherited(arguments);this.i18n=k.mixin(l.common,l.notificationsList)},loadList:function(){var a=g.getUser(),b=esriGeowConfig.restBaseUrl+"community/users/"+a.email+"/notifications",d=function(a,b){e.publish("onNotificationCount",[a.notifications.length]);a=this._notificationsToHTML(a.notifications);c.byId("notificationsList").innerHTML=
a}.bind(this),f;null!=a&&g.getJson(b).then(function(a){f=(a&&a.notifications||[]).filter(function(a){return a&&"message_received"!==a.type});d({notifications:f})}.bind(this))},updateList:function(){this.loadList()},_notificationsToHTML:function(b){var c='\x3cul class\x3d"notifications-list"\x3e',d=dojo.string,e=g.isPortal(),f,k,h,l,m;(b||{}).forEach(function(b,g){f=b.type;k=new Date(b.received);h=a.format(k,{selector:"date",format:"short"});l=b.data.groupTitle;m="";switch(f){case "group_join":m=d.substitute(this.i18n.joinGroupByDate,
{groupTitle:l,dateStr:h});break;case "group_application_accepted":m=d.substitute(this.i18n.joinGroupAccepted,{groupTitle:l,dateStr:h});break;case "group_application_declined":m=d.substitute(this.i18n.declineGroupRequest,{groupTitle:l,dateStr:h});break;case "user_invite":m=d.substitute(this.i18n.inviteGroupRequest,{groupTitle:l,dateStr:h})+"\x3cbr\x3e"+this.i18n.viewInvitation;break;case "user_invitation_accepted":m=d.substitute(this.i18n.acceptedInvite,{groupTitle:l,dateStr:h});break;case "user_invitation_declined":m=
d.substitute(this.i18n.declinedInvite,{groupTitle:l,dateStr:h});break;case "user_added_to_group":m=d.substitute(this.i18n.addedToGroup,{groupTitle:l,dateStr:h});break;case "user_email_bounced":m=d.substitute(this.i18n.emailBounced,{email:b.data.toEmail,reason:b.data.reason});break;case "collaboration_workspace_added":m=d.substitute(this.i18n.collabAddWorkspace,{collaborationName:b.data.collaborationName,workspaceName:b.data.collaborationWorkspaceName,dateStr:h});break;case "collaboration_deleted":m=
d.substitute(this.i18n.collabDeleted,{collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_join":m=d.substitute(this.i18n.collabParticipantJoin,{collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_participant_join":m=d.substitute(this.i18n.collabOtherParticipantJoin,{guestName:b.data.participantName,collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_participant_workspace_unjoin":m=d.substitute(this.i18n.collabWorkspaceLeave,
{guestName:b.data.participantName,workspaceName:b.data.collaborationWorkspaceName,collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_participant_workspace_join":m=d.substitute(this.i18n.collabWorkspaceJoin,{guestName:b.data.participantName,workspaceName:b.data.collaborationWorkspaceName,collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_participant_removed":m=d.substitute(this.i18n.collabParticipantRemoved,{collaborationName:b.data.collaborationName,
contactName:b.data.contactName,contactEmail:b.data.contactEmail,dateStr:h});break;case "collaboration_peer_participant_removed":m=d.substitute(this.i18n.collabOtherParticipantRemoved,{guestName:b.data.participantName,collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_participant_access_changed":m=d.substitute(this.i18n.collabAccessChanged,{collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_leaving":m=d.substitute(this.i18n.collabLeft,{guestName:b.data.participantName,
collaborationName:b.data.collaborationName,dateStr:h});break;case "collaboration_content_store_disk_limit_reached":m=d.substitute(this.i18n.collabDiskLimit,{limit:b.data.collaborationContentStoreDiskLimit});break;case "feature_layer_copy_over_failed":m=d.substitute(this.i18n.featureLayerCopyFailed,{collaborationName:b.data.collaborationName,workspaceName:b.data.collaborationWorkspaceName,itemName:d.substitute('\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"${url}" target\x3d"_blank"\x3e${name}\x3c/a\x3e',
{url:esriGeowConfig.baseUrl+"item.html?id\x3d"+b.data.itemId,name:b.data.itemTitle})});break;case "feature_view_copy_over_failed":m=d.substitute(this.i18n.featureLayerViewCopyFailed,{collaborationName:b.data.collaborationName,workspaceName:b.data.collaborationWorkspaceName,itemName:d.substitute('\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"${url}" target\x3d"_blank"\x3e${name}\x3c/a\x3e',{url:esriGeowConfig.baseUrl+"item.html?id\x3d"+b.data.itemId,name:b.data.itemTitle})});break;case "webapp_not_copied":m=
d.substitute(e?this.i18n.webAppNotCopied:this.i18n.webAppNotCopiedOnline,{itemName:d.substitute('\x3cspan class\x3d""\x3e\x3ca href\x3d"${url}" target\x3d""\x3e${name}\x3c/a\x3e',{url:esriGeowConfig.baseUrl+"item.html?id\x3d"+b.data.itemId,name:b.data.itemTitle}),groupName:b.data.sourcePortalGroup,guestName:b.data.participantName});break;case "insights_item_not_copied":m=d.substitute(this.i18n.insightsNotCopied,{itemName:d.substitute('\x3cspan class\x3d""\x3e\x3ca href\x3d"${url}" target\x3d""\x3e${name}\x3c/a\x3e',
{url:esriGeowConfig.baseUrl+"item.html?id\x3d"+b.data.itemId,name:b.data.itemTitle}),groupName:b.data.sourcePortalGroup,guestName:b.data.participantName});break;default:m=f&&l&&h?d.substitute(this.i18n.defaultMsg,{type:f,groupTitle:l,dateStr:h}):void 0}m&&(c+='\x3cli class\x3d"notifications-list-item"\x3e'+m+'\x3ca class\x3d"notifications-list-close link-red" href\x3d"JavaScript:arcgisonline.sharing.geow.Community.deleteNotifictation(\''+b.id+'\')" alt\x3d"'+this.i18n.deleteLabel+'" title\x3d"'+this.i18n.deleteLabel+
'"\x3e\x3cspan class\x3d"deleteNotificationIcon icon-ui-close icon-ui-red"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/li\x3e')},this);0===b.length&&(c+=this.i18n.noNotificationsMsg);return c+="\x3c/ul\x3e"}},this)})},"arcgisonline/sharing/dijit/Search":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/_Search,dijit/form/Button,dijit/form/TextBox,dijit/Menu,arcgisonline/sharing/dijit/dialog/GeneralDlg,dojo/NodeList-traverse"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.Search");b.require("arcgisonline.sharing.util");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing._Search");b.require("dijit.form.Button");b.require("dijit.form.TextBox");b.require("dijit.Menu");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("dojo.NodeList-traverse");b.declare("arcgisonline.sharing.dijit.Search",[h._Widget,h._Templated,arcgisonline.sharing._Search],{util:arcgisonline.sharing.util,
widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"search leader-half" id\x3d"search-form-box" style\x3d"position: relative;" role\x3d"search"\x3e\r\n  \x3cform id\x3d"search-form" autocomplete\x3d"off" class\x3d"dropdown" action\x3d"./search.html"\x3e\r\n    \x3cinput name\x3d"q" type\x3d"search" dojoType\x3d"dijit.form.TextBox" trim\x3d"true" id\x3d"search-box" dojoAttachPoint\x3d"searchText" dojoAttachEvent\x3d"onKeyPress:_onSearchKeyPress,onFocus:_onSearchTextFocus,onBlur:_onSearchBoxBlur" alt\x3d"${i18n.searchFor}" title\x3d"${i18n.searchFor}"/\x3e\r\n    \x3cnav dojoAttachPoint\x3d"_domainsContainer" class\x3d"js-domains dropdown-menu dropdown-right dropdown-menu-search" role\x3d"menu"\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link is-active" filter\x3d"" href\x3d"#"\x3e${i18n.searchAllContent}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"maps" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForMaps}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"layers" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForLayers}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"applications" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForApps}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"scenes" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForScenes}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"tools" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForTools}\x3c/a\x3e\r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"files" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForFiles}\x3c/a\x3e      \r\n      \x3ca dojoAttachEvent\x3d"onclick:_onFilterClick" class\x3d"dropdown-link" filter\x3d"groups" role\x3d"menuitem" href\x3d"#"\x3e${i18n.searchForGroups}\x3c/a\x3e\r\n    \x3c/nav\x3e\r\n    \x3cbutton type\x3d"submit" class\x3d"screen-readers-only"\x3e${i18n.submit}\x3c/button\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
query:"",domain:null,focus:null,owner:"",group:"",searchButton:null,searchText:null,_domainsContainer:null,_groupSeachAnchor:null,showDomainsAnim:null,hidedomainsAnim:null,_currentSearchBoxTip:null,searchBoxTip:null,searchBoxTipGroup:null,searchBoxTipGroups:null,_firstLinkPos:0,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").search);this.searchBoxTip=
this.i18n.searchBoxTip;this.searchBoxTipGroup=this.i18n.searchBoxTipGroup;this.searchBoxTipGroups=this.i18n.searchBoxTipGroups},postCreate:function(){this.restrict=(this._queryStringParams=b.queryToObject(window.location.search.slice(1)))&&this._queryStringParams.restrict;b.query("input",this.domNode).addClass("leader-0").addClass("calcite-web-input");var a=b.query(".js-domains a",this.domNode);a.removeClass("is-active");this._queryStringParams.t&&"content"!==this._queryStringParams.t?b.query(".js-domains a[filter\x3d"+
this._queryStringParams.t+"]",this.domNode).addClass("is-active"):-1!==window.location.pathname.toLowerCase().indexOf("groups.html")?b.query(".js-domains a[filter\x3d'groups']",this.domNode).addClass("is-active"):b.query(".js-domains a[filter\x3d'']",this.domNode).addClass("is-active");0===b.query(".js-domains a.dropdown-link.is-active",this.domNode).length&&b.query(".js-domains a[filter\x3d'']",this.domNode).addClass("is-active");b.forEach(a,function(a,d){b.hasClass(a,"is-active")&&(this._firstLinkPos=
d)},this);this._loadSearchBoxTip();b.connect(this.searchText,"onFocus",this,this._onSearchTextFocus);b.subscribe("onRestrictSearchChange",b.hitch(this,function(a){this.restrict=a.restrictSearch}));this.showDomainsAnim=b.anim(this._domainsContainer,{opacity:1,beforeBegin:function(a){b.query("#search-form").addClass("is-active")}},300);this.hidedomainsAnim=b.anim(this._domainsContainer,{opacity:0,onEnd:function(a){b.query("#search-form").removeClass("is-active")}},300);this.hidedomainsAnim.play();b.query(".searchNode").removeClass("openSearch")},
_loadSearchBoxTip:function(a){this.searchText.set("value",this._queryStringParams.q||"")},doSearch:function(a){if(-1<a.indexOf("*"))this.page?b.publish("alert/show",[{type:"error",text:this.i18n.error.wildCardSearchError}]):arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorLabel,message:this.i18n.error.wildCardSearchError}),this.searchText.focus();else if(a===this._currentSearchBoxTip||""===a)this.searchText.focus();else{this.hidedomainsAnim.play();
b.query(".searchNode").removeClass("openSearch");var c={};c.q=a;c.t="content";this.focus&&(c.focus=this.focus,c.scope=this.focus);esri.isDefined(this.restrict)&&(c.restrict=this.restrict);a=b.query(".js-domains a.is-active")[0];void 0!==a&&b.hasAttr(a,"filter")&&(a=b.trim(b.attr(a,"filter")),"groups"==a?c.t="groups":"group"==a&&(c.t="group"));this.goToSearch(c,{useCurrentPageLocation:"group"===c.t,clearParams:"group"!==c.t})}},_onFilterClick:function(a){this.focus=b.attr(a.currentTarget,"filter");
null!=this.focus&&(b.query(".js-domains a",this.domNode).removeClass("is-active"),b.addClass(a.currentTarget,"is-active"),this._onSearchClick(a))},_onSearchTextFocus:function(a){var c=b.connect(this.showDomainsAnim,"onEnd",b.hitch(this,function(){b.disconnect(c);this.searchText.focus()}));b.query(".searchNode").addClass("openSearch");this.showDomainsAnim.play()},_onBlur:function(a){this.hidedomainsAnim.play();b.query(".searchNode").removeClass("openSearch")},_onSearchBoxFocus:function(a){},_onSearchBoxBlur:function(a){""===
this.searchText.getValue()&&(this._queryStringParams.q=null,this._loadSearchBoxTip())},_onSearchClick:function(a){b.stopEvent(a);var c=this.searchText.getValue();null!=a&&a.preventDefault&&a.preventDefault();0===b.trim(c).length?this.searchText.focus():this.doSearch(c)},_onSearchKeyPress:function(a){if(a.keyCode==b.keys.ENTER)b.stopEvent(a),this._onSearchClick(a);else if(a.keyCode===b.keys.DOWN_ARROW||a.keyCode===b.keys.UP_ARROW){a.preventDefault();var c=b.query(".js-domains a"),d=b.query(".js-domains a.is-active").shift()||
b.query(".js-domains a").first().shift(),e=a.keyCode===b.keys.DOWN_ARROW?"next":"prev";(d=b.query(d)[e]().shift())||(d=c["next"===e?"first":"last"]().shift());c.removeClass("is-active");b.addClass(d,"is-active");this.focus=b.attr(d,"filter")}this.onSearchFieldKeyPress(a)},onSearchFieldKeyPress:function(a){}})})},"arcgisonline/sharing/_Search":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/geow/Content"],function(b,h,k){b.provide("arcgisonline.sharing._Search");
b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Content");b.declare("arcgisonline.sharing._Search",null,{MAX_PAGE_COUNT:100,MAX_RESULTS_PER_PAGE:10,_content:arcgisonline.sharing.geow.Content,_queryStringParams:null,_lastQuery:null,keywords:null,_searchPage:esriGeowConfig.baseUrl+"search.html",_queryTypes:{content:{queryUrl:esriGeowConfig.restBaseUrl+"search"},group:{queryUrl:esriGeowConfig.restBaseUrl+"search"},groups:{queryUrl:esriGeowConfig.restBaseUrl+"community/groups"}},
_getSearchParams:function(){return b.queryToObject(window.location.search.slice(1))},goToSearch:function(a,b){window.location.href=this.getSearchUrl(a,b)},getSearchUrl:function(a,c){c||(c={});var d=b.queryToObject(window.location.search.slice(1));if(!c.clearParams){a.resetSort||delete d.resetSort;var e=d.q;a=b.mixin(d,a);"group"===a.t&&e!==a.q&&(a.sortField=null,a.sortOrder=null,a.start=1)}c=c.useCurrentPageLocation?window.location.href.substring(window.location.href.lastIndexOf("/")+1,window.location.href.indexOf(window.location.search)):
this._searchPage;c+="?"+b.objectToQuery(a);a=esriGeowConfig.self&&esriGeowConfig.self.allSSL;d=arcgisonline.sharing.util.usePortalSSL();return a||d?arcgisonline.sharing.util.getSecureUrl(c):arcgisonline.sharing.util.getHttpUrl(c)},doQuery:function(a){var c="";if(a.start&&-1===a.start)this._handleSearchResult(a);else{a.q&&(c=this._checkParenthesis(b.trim(a.q)),this.keywords=b.trim(a.q));a.f&&(c=null!==c&&0<c.length?"("+c+") "+b.trim(unescape(a.f)):c+(" "+b.trim(unescape(a.f))));if(null==c||0===c.length)c=
"all"==a.focus?"access:public":"";a.focus&&esriGeowConfig.filterQueries[a.focus]&&(c+=" "+esriGeowConfig.filterQueries[a.focus].f);var d=arcgisonline.sharing.util.getCookie("esri_search")||{},e={},f=-1<location.href.indexOf("search.html");e.q=c;void 0!==a.sortField?e.sortField=a.sortField:f&&d.sortField&&!a.resetSort&&(e.sortField=d.sortField);void 0!==a.sortOrder?e.sortOrder=a.sortOrder:f&&d.sortOrder&&!a.resetSort&&(e.sortOrder=d.sortOrder);void 0!==a.start&&(e.start=a.start);0<this.resultsPerPage&&
(e.num=this.resultsPerPage);"groups"===a.t&&-1<b.indexOf(["numviews","avgrating"],e.sortField)&&delete e.sortField;this._lastQuery=e;this._content.search(a.t?this._queryTypes[a.t].queryUrl:this._queryTypes.content.queryUrl,e,b.hitch(this,this._onQueryResult));this.onQueryExecute(e,this._cleanQuery(e.q))}},_onQueryResult:function(a){this.onQueryResult(a)},_checkParenthesis:function(a){return/\((.*)\)/.exec(a)?a:"("+a+")"},_cleanQuery:function(a){if((a=a.replace(/\s+/g," ").replace(/: /g,":"))&&0<=
a.indexOf(":")){a=a.replace(/\(/g," ( ").replace(/\)/g," ) ");a=a.split(" ");for(var b=[],d=0;d<a.length;d++){for(var e=a[d],f=e.replace(/[^"]/g,"").length;1==f%2&&d<a.length-1;)e+=" "+a[d+1],d++,f=e.replace(/[^"]/g,"").length;-1===e.indexOf(":")&&b.push(e)}b=this.checkLastKeyword(b);a=b.join(" ");a=a.replace(/  /g," ").replace(/ OR OR /g," OR ").replace(/\( /g,"(").replace(/ \)/g,")").replace(/\(OR OR /g,"(").replace(/ OR OR\)/g,")");a=a.replace(/\(OR/g,"(").replace(/OR\)/g,")").replace(/\( \)/g,
"").replace(/\(\)/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}return a},checkLastKeyword:function(a){if(a&&0<a.length){var b=a[a.length-1];if(b.match(/^AND$/i)||b.match(/^OR$/i))return a.pop(),this.checkLastKeyword(a)}return a},onQueryExecute:function(a,b){},onQueryResult:function(a){}})})},"arcgisonline/sharing/geow/Content":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,esri/arcgis/Portal"],function(b,h,k){b.provide("arcgisonline.sharing.geow.Content");b.require("arcgisonline.sharing.util");
b.require("esri.arcgis.Portal");arcgisonline.sharing.geow.Content={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,{source:b.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties.source});b.mixin(this._i18n,{viewsWidget:b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget});return this._i18n},getUserInfo:function(a,b){var c=this.util.getUser();null!=c&&
this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+(c.username||c.email),a,b)},getUserItems:function(a,b,d){var c=this.util.getUser();null!=c&&(c=esriGeowConfig.restBaseUrl+"content/users/"+(c.username||c.email),null!=a&&""!==a&&(c=c+"/"+a),this.util.getJson(c,b,d))},getUserItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&(a=esriGeowConfig.restBaseUrl+"content/users/"+a,null!=b&&""!==b&&(a=a+"/"+b),this.util.getJson(a,d,e))},getUserServers:function(a){void 0!==this._userServers&&
a(this._userServers);this.util.getJson(esriGeowConfig.serversRestBaseUrl,function(b){a(this._userServers=b.servers)},function(b){a(null)})},addItem:function(a,c,d,e){var f=this.util.getUser();if(null!=f){f=esriGeowConfig.restBaseUrl+"content/users/"+(f.username||f.email);null!=a&&(f=f+"/"+a);f+="/addItem";a=!1;for(var g=0;g<c.childNodes.length;g++){var k=c.childNodes[g];if("async"===k.name&&"true"===k.value){a=!0;break}}a?this.util.postForm(c,f,b.hitch(arcgisonline.sharing.geow.Content,"addItemAsyncHandler",
d,e),e):this.util.postForm(c,f,d,e)}},addItemByUser:function(a,c,d,e,f){if(null!=this.util.getUser()){a=esriGeowConfig.restBaseUrl+"content/users/"+a;null!=c&&(a=a+"/"+c);a+="/addItem";c=!1;for(var g=0;g<d.childNodes.length;g++){var k=d.childNodes[g];if("async"===k.name&&"true"===k.value){c=!0;break}}c?this.util.postForm(d,a,b.hitch(arcgisonline.sharing.geow.Content,"addItemByUserAsyncHandler",e,f),f):this.util.postForm(d,a,e,f)}},addItemAsyncHandler:function(a,c,d,e){d&&d.success&&!0===d.success?
arcgisonline.sharing.geow.Content.itemStatus(d,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusHandler",0,d,a,c),c):c(d,e)},addItemByUserAsyncHandler:function(a,c,d,e){d&&d.success&&!0===d.success?arcgisonline.sharing.geow.Content.itemStatus(d,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusByUserHandler",0,d,a,c),c):c(d,e)},deleteService:function(a,c){this.getUserServers(b.hitch(this,function(d){if(d&&d.length&&-1<a.indexOf(esriGeowConfig.featuresRestBaseUrl+d[0].id+"/")){d=esriGeowConfig.serversRestBaseUrl+
d[0].id+"/arcgis/admin/services/";d+=a.substr(a.indexOf(c)).replace("/",".")+"/delete";esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;var e=b.hitch(this,function(a){esri.config.defaults.io.proxyUrl=null});this.util.postJson("",d,e,e)}}))},publishService:function(a,c,d,e){a=this.util.getUser();if(null!=a){a=esriGeowConfig.restBaseUrl+"content/users/"+(a.username||a.email)+"/publish";c=c.params;var f=b.hitch(this,function(a){d(a)});this.util.postJson(c,a,b.hitch(this,function(a){a=a.services[0];
a.success=a.success||a.serviceurl&&0<a.serviceurl.length;a.success?(a.id=a.serviceItemId,d(a)):f(a)}),b.hitch(this,function(a){f({success:!1})}))}},itemStatus:function(a,b,d){var c=this.util.getUser();if(null!=c){var f=c.username||c.email,c=a.folder,f=esriGeowConfig.restBaseUrl+"content/users/"+(a.overrideUser||f);c&&0<c.length&&"/"!=c&&(f+="/"+c);f=f+"/items/"+a.id+"/status";a.jobid&&(f+="?jobid\x3d"+a.jobid);a.type&&"image service"===a.type.toLowerCase()&&(f+="\x26jobType\x3dPublishImageService");
this.util.getJson(f,b,d)}},itemStatusByUser:function(a,b,d){if(null!=this.util.getUser()){var c=a.folder,f=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;c&&0<c.length&&"/"!=c&&(f+="/"+c);f=f+"/items/"+a.id+"/status";this.util.getJson(f,b,d)}},itemStatusHandler:function(a,c,d,e,f,g){f&&f.status&&"processing"===f.status?(a++,setTimeout(b.hitch(this,function(){arcgisonline.sharing.geow.Content.itemStatus(c,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusHandler",a,c,d,e),e)}),Math.min(1E3*
Math.pow(2,a),6E4))):(b.mixin(f,c),d(f,g))},itemStatusByUserHandler:function(a,c,d,e,f,g){f&&f.status&&"processing"===f.status?(a++,setTimeout(b.hitch(this,function(){arcgisonline.sharing.geow.Content.itemStatusByUser(c,b.hitch(arcgisonline.sharing.geow.Content,"itemStatusByUserHandler",a,c,d,e),e)}),Math.min(1E3*Math.pow(2,a),6E4))):(b.mixin(f,c),d(f,g))},deleteItems:function(a,c,d){var e=this.util.getUser();if(null!=e){e=e.username||e.email;if(1==a.length)return a=a[0],e=esriGeowConfig.restBaseUrl+
"content/users/"+e,null!=a.folderId&&""!==a.folderId&&"/"!=a.folderId&&(e+="/"+a.folderId),e=e+"/items/"+a.id+"/delete",this.util.postJson("",e,c,d);if(1<a.length){var f="",g="";b.forEach(a,function(a){f+=g+a.id;g=","},this);a={items:f};e=esriGeowConfig.restBaseUrl+"content/users/"+e+"/deleteItems";return this.util.postJson(a,e,c,d)}}},deleteItemsByUser:function(a,c,d,e){if(null!=this.util.getUser()){if(1==c.length)return c=c[0],a=esriGeowConfig.restBaseUrl+"content/users/"+a,null!=c.folderId&&""!==
c.folderId&&"/"!=c.folderId&&(a+="/"+c.folderId),a=a+"/items/"+c.id+"/delete",this.util.postJson("",a,d,e);if(1<c.length){var f="",g="";b.forEach(c,function(a){f+=g+a.id;g=","},this);c={items:f};a=esriGeowConfig.restBaseUrl+"content/users/"+a+"/deleteItems";return this.util.postJson(c,a,d,e)}}},getApplicationCode:function(a,c,d){var e=null,f="WMA2Code";b.isObject(a)?(e=a.id,"Mobile Application"===a.type&&(f="MobileApp2Code")):e=a;this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+e+"/relatedItems?relationshipType\x3d"+
f,c,d)},addApplicationCodeRelate:function(a,c,d,e){var f=this.util.getUser();if(null==f)b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]);else{var g=null,k="WMA2Code";b.isObject(a)?(g=a.id,"Mobile Application"===a.type&&(k="MobileApp2Code")):g=a;this.util.postJson({relationshipType:k,originItemId:g,desinationItemId:c},esriGeowConfig.restBaseUrl+"content/users/"+(f.username||f.email)+"/addRelationship?relationshipType\x3d"+k+"\x26originItem\x3d"+g+"\x26destinationItemId\x3d"+
c,d,e)}},getComments:function(a,b,d,e){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a+"/comments",d,e)},addComment:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]):this.util.postJson({comment:c},esriGeowConfig.restBaseUrl+"content/items/"+a+"/addComment",d,e)},deleteComment:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]):
this.util.postJson({},esriGeowConfig.restBaseUrl+"content/items/"+a+"/comments/"+c+"/delete",d,e)},addRating:function(a,c,d,e){null==this.util.getUser()?b.publish("globalMessage",[{message:this.i18n().mustLogIn,type:"error",duration:0}]):this.util.postJson({rating:c},esriGeowConfig.restBaseUrl+"content/items/"+a+"/addRating",d,e)},getRating:function(a,b,d){null!=this.util.getUser()&&this.util.postJson({},esriGeowConfig.restBaseUrl+"content/items/"+a+"/rating",b,d)},deleteItem:function(a,b,d){var c=
this.util.getUser();if(null!=c){var c=c.username||c.email,c=esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||c),f=a.ownerFolder||a.folderId;f&&"/"!==f&&(c=c+"/"+f);c=c+"/items/"+a.id+"/delete";this.util.postJson("",c,b,d)}},deleteItemByUser:function(a,b,d){if(null!=this.util.getUser()){var c=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(c=c+"/"+a.folderId);c=c+"/items/"+a.id+"/delete";this.util.postJson("",c,b,d)}},updateItem:function(a,b,d,e){var c=this.util.getUser();
null!=c&&(c=c.username||c.email,c=esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||c),null!=a.folderId&&(c=c+"/"+a.folderId),c=c+"/items/"+a.id+"/update",this.util.postForm(b,c,d,e))},updateItemByUser:function(a,b,d,e){if(null!=this.util.getUser()){var c=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(c=c+"/"+a.folderId);c=c+"/items/"+a.id+"/update";this.util.postForm(b,c,d,e)}},updateItemJson:function(a,b,d,e){var c=this.util.getUser();null!=c&&(c=c.username||c.email,
c=esriGeowConfig.restBaseUrl+"content/users/"+(a.overrideUser||c),null!=a.folderId&&(c=c+"/"+a.folderId),c=c+"/items/"+a.id+"/update",this.util.postJson(b,c,d,e))},updateItemJsonByUser:function(a,b,d,e){null!=this.util.getUser()&&(a=esriGeowConfig.restBaseUrl+"content/users/"+a,null!=b.folderId&&(a=a+"/"+b.folderId),a=a+"/items/"+b.id+"/update",this.util.postJson(d,a,e))},filterErrors:function(a){return(a=a&&a.results)&&a.length&&(a=b.filter(a,"return item.error"))&&a.length?(this.util.checkError(a[0].error),
a):!1},shareItems:function(a,c,d){var e=this.util.getUser();null!=e&&(e=e.username||e.email,this.util.postJson(a,esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||e)+"/shareItems",b.hitch(this,function(a){var b=this.filterErrors(a);b?d(b):c(a)}),d))},shareItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/users/"+a+"/shareItems",d,e)},shareItem:function(a,b,d,e){var c=this.util.getUser();null!=c&&(c=esriGeowConfig.restBaseUrl+"content/users/"+
(c.username||c.email),null!=a.folderId&&(c=c+"/"+a.folderId),c=c+"/items/"+a.id+"/share",this.util.postJson(b,c,d,e))},shareItemByID:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/share",d,e)},unshareItems:function(a,c,d){var e=this.util.getUser();null!=e&&(e=e.username||e.email,this.util.postJson(a,esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||e)+"/unshareItems",b.hitch(this,function(a){var b=this.filterErrors(a);b?d(b):
c(a)}),d))},unshareItemsByUser:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+"content/users/"+a+"/unshareItems",d,e)},unshareItem:function(a,b,d,e){var c=this.util.getUser();null!=c&&(c=esriGeowConfig.restBaseUrl+"content/users/"+(c.username||c.email),null!=a.folderId&&(c=c+"/"+a.folderId),c=c+"/items/"+a.id+"/unshare",this.util.postJson(b,c,d,e))},unshareItemByID:function(a,b,d,e){null!=this.util.getUser()&&this.util.postJson(b,esriGeowConfig.restBaseUrl+
"content/items/"+a.id+"/unshare",d,e)},moveItems:function(a,c,d,e){var f=this.util.getUser();if(null!=f){var g="",k="";b.forEach(a,function(a){g+=k+a.id;k=","},this);c.items=g;this.util.postJson(c,esriGeowConfig.restBaseUrl+"content/users/"+(f.username||f.email)+"/moveItems",d,e)}},moveItemsByUser:function(a,c,d,e,f){if(null!=this.util.getUser()){var g="",k="";b.forEach(c,function(a){g+=k+a.id;k=","},this);d.items=g;this.util.postJson(d,esriGeowConfig.restBaseUrl+"content/users/"+a+"/moveItems",e,
f)}},reassignItem:function(a,b,d,e,f){if(null!=this.util.getUser()){var c=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!==a.folderId&&(c=c+"/"+a.folderId);c=c+"/items/"+a.id+"/reassign";this.util.postJson({targetUsername:b,targetFolderName:d},c,e,f)}},moveItem:function(a,b,d,e){var c=this.util.getUser();null!=c&&(c=esriGeowConfig.restBaseUrl+"content/users/"+(c.username||c.email),null!=a.folderId&&(c=c+"/"+a.folderId),c=c+"/items/"+a.id+"/move",this.util.postJson(b,c,d,e))},moveItemByUser:function(a,
b,d,e){if(null!=this.util.getUser()){var c=esriGeowConfig.restBaseUrl+"content/users/"+a.owner;null!=a.folderId&&(c=c+"/"+a.folderId);c=c+"/items/"+a.id+"/move";this.util.postJson(b,c,d,e)}},search:function(a,c,d,e){if(a){e="";if(0>a.indexOf("community/groups")){var f=this.util.userPreferences(null,"contentModePrefs"),g=b.queryToObject(window.location.search.slice(1));g.content&&"all"===g.content.toLowerCase()?f.contentMode="GIS":g.content&&"web"===g.content.toLowerCase()&&(f.contentMode="Web");e=
f&&f.contentMode&&"GIS"===f.contentMode?esriGeowConfig.viewQueries.gis:e+esriGeowConfig.viewQueries.web;e+=esriGeowConfig.viewQueries.none}c.q+=e;this.util.getJsonWithContent(a,c,d)}},getFeaturedItems:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a+"/relatedItems?relationshipType\x3dFeaturedItems2Item\x26direction\x3dforward",b)},getUserItem:function(a,b,d){d=this.util.getUser();null!=d&&(d=esriGeowConfig.restBaseUrl+"content/users/"+(d.username||d.email),null!=a.folderId&&
(d=d+"/"+a.folderId),d=d+"/items/"+a.id,this.util.getJson(d,b))},getItem:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a,b,d)},getItemData:function(a,b,d){this.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a+"/data",b,d)},getItemFolder:function(a,c){var d=this.util.getUser();if(null!=d){var e=d.username||d.email;this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+e,b.hitch(this,function(d,g){var f=null;for(g=0;g<d.items.length;g++)if(d.items[g].id==
a){f="";break}if(null!=f)c(f);else{var k=function(b,d){d=b.currentFolder.id;for(var e=0;e<b.items.length;e++)if(b.items[e].id==a){f=d;c(f);break}};b.forEach(d.folders,function(a,c){this.util.getJson(esriGeowConfig.restBaseUrl+"content/users/"+e+"/"+a.folderName,b.hitch(this,k))},this)}}))}},itemsToStore:function(a){var c=a.currentFolder?a.currentFolder.id:"",d=[];b.forEach(a.items,function(a,b){a.folderId=c;a.imageUrl=this._getItemIconUrl(a);a.selected=!1;a.item=a.name||a.url||a.title;if(a.snippet&&
0<a.snippet.length&&"null"!=a.snippet)a.snippet=a.snippet;else if(a.description&&0<a.description.length&&"null"!=a.description){var e=arcgisonline.sharing.util.removeHTMLTags(a.description);a.snippet=150<e.length?e.substring(0,150)+"...":e}else a.snippet="";delete a.listingProperties;delete a.properties;d[b]=a},this);return new b.data.ItemFileWriteStore({data:{identifier:"id",label:"item",items:d}})},searchToStore:function(a){var c=[];b.forEach(a.items?a.items:a.results,function(a,b){a={id:a.id,owner:a.owner,
title:a.title,description:a.description,tags:a.tags?a.tags.join(","):[],imageUrl:this._getItemImageUrl(a),created:a.created,modified:a.modified};c[b]=a},this);return new b.data.ItemFileReadStore({data:{identifier:"id",label:"item",items:c}})},_getPremiumItemNode:function(a){var c=(new esri.arcgis.PortalItem(b.mixin(a,{portal:{isPortal:esriGeowConfig.self&&esriGeowConfig.self.isPortal}}))).getTypeInfo(),d=esriGeowConfig.self&&esriGeowConfig.self.isPortal?"portal":"";a=-1<b.indexOf(a.typeKeywords,"Requires Credits");
return c.isPremiumContent?(d=b.create("div",{className:"esri-premium-content",title:a?this.i18n()["premiumcontentcreditstitle"+d]:this.i18n()["premiumcontenttitle"+d],innerHTML:a?this.i18n().premiumcontent:this.i18n().subscriptioncontent}),b.create("img",{className:"esri-premium-icon",src:c.premiumIconUrl},d,"first"),d):!1},_getItemIconUrl:function(a){return(new esri.arcgis.PortalItem(b.mixin(a,{portal:{isPortal:esriGeowConfig.self&&esriGeowConfig.self.isPortal}}))).iconUrl},_getItemImageUrl:function(a,
b){a=a.type?a.type.toLowerCase():"";return this.util.relativeToExplicitUrl("geocoding service"==a||"network analysis service"==a||"geoprocessing service"==a||"geodata service"==a||"geometry service"==a||"workflow manager service"==a?b?"images/tool_16x16.png":"images/tool_32x32.png":"wms"==a||"kml"==a||"globe service"==a||"map service"==a||"image service"==a||"feature service"==a||"scene service"===a||"stream service"===a?b?"images/layer_16x16.png":"images/layer_32x32.png":"web mapping application"==
a||"mobile application"==a||"web map"==a?b?"images/map_16x16.png":"images/map_32x32.png":"layer"==a||"layer package"==a||"tile package"===a||"vector tile package"===a||"scene package"===a||"image collection"===a||"explorer layer"==a||"cad drawing"===a?b?"images/layer-download_16x16.png":"images/layer-download_32x32.png":"explorer add in"==a||"desktop add in"==a||"geoprocessing package"==a||"locator package"==a?b?"images/tool-download_16x16.png":"images/tool-download_32x32.png":b?"images/map-download_16x16.png":
"images/map-download_32x32.png")},changeTypename:function(a,c,d){var e=new esri.arcgis.PortalItem(b.mixin(a,{portal:{isPortal:esriGeowConfig.self&&esriGeowConfig.self.isPortal}})),f=e.getTypeInfo(),e=a.type&&-1<a.type.toLowerCase().indexOf("add in")?e.displayName:e.type,g=-1<b.indexOf(a.typeKeywords,"Hosted Service"),k=-1<b.indexOf(a.typeKeywords,"View Service"),h="Feature Service"===a.type,f=f.displayName;d&&(f=g?f+(" ("+(k?this.i18n().viewsWidget.hostedView:h?this.i18n().viewsWidget.hostedData:
this.i18n().viewsWidget.hostedService)+")"):f+(" ("+this.i18n().viewsWidget.locatorView+")"));a=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?this.i18n().source+" ":"";return c?"\x3cspan title\x3d'"+a+e+"'\x3e"+f+"\x3c/span\x3e":f},getFavorites:function(){var a,c={};return this.util.request({url:esriGeowConfig.restBaseUrl+"content/groups/"+esriGeowConfig.self.user.favGroupId}).then(b.hitch(this,function(d){a=d.items||[];b.forEach(a,b.hitch(this,function(a){c[a.id]=!0}));
return c}))},addToFavorites:function(a){var b=this.util.getUser().favGroupId;return this.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/share",content:{f:"json",everyone:a.access&&"public"===a.access||a.sharing&&a.sharing.access&&"public"===a.sharing.access||!1,org:a.access&&"org"===a.access||a.sharing&&a.sharing.access&&"org"===a.sharing.access||!1,groups:[b],items:[a.id]}},{usePost:!0})},removeFromFavorites:function(a){var b=this.util.getUser().favGroupId;return this.util.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+a.id+"/unshare",content:{f:"json",everyone:!1,org:!1,groups:[b],items:[a.id]}},{usePost:!0})}}})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){m("dijit-legacy-requires")&&u(0,function(){b(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem",
"dijit/MenuSeparator"])});return k("dijit.Menu",p,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):h.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return q.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},
_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(b){b=a.byId(b,this.ownerDocument);var d;if("iframe"==b.tagName.toLowerCase()){var e=b;d=this._iframeContentWindow(e);d=n.body(d.document)}else d=b==n.body(this.ownerDocument)?this.ownerDocument.documentElement:b;var k={node:b,iframe:e};c.set(b,"_dijitMenu"+this.id,this._bindings.push(k));var h=g.hitch(this,
function(a){var b=this.selector,c=b?function(a){return l.selector(b,a)}:function(a){return a},d=this;return[l(a,c(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<d._lastKeyDown+500||d._scheduleOpen(this,e,{x:a.pageX,y:a.pageY},a.target)}),l(a,c("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==f.F10||d.leftClickToOpen&&a.keyCode==f.SPACE)a.stopPropagation(),a.preventDefault(),d._scheduleOpen(this,e,null,a.target),d._lastKeyDown=
(new Date).getTime()})]});k.connects=d?h(d):[];e&&(k.onloadHandler=g.hitch(this,function(){var a=this._iframeContentWindow(e),a=n.body(a.document);k.connects=h(a)}),e.addEventListener?e.addEventListener("load",k.onloadHandler,!1):e.attachEvent("onload",k.onloadHandler))},unBindDomNode:function(b){var d;try{d=a.byId(b,this.ownerDocument)}catch(y){return}b="_dijitMenu"+this.id;if(d&&c.has(d,b)){for(var e=c.get(d,b)-1,f=this._bindings[e],g;g=f.connects.pop();)g.remove();(g=f.iframe)&&(g.removeEventListener?
g.removeEventListener("load",f.onloadHandler,!1):g.detachEvent("onload",f.onloadHandler));c.remove(d,b);delete this._bindings[e]}},_scheduleOpen:function(a,b,c,d){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:d,delegatedTarget:a,iframe:b,coords:c})},1))},_openMyself:function(b){function c(){u.refocus&&q&&q.focus();t.close(u)}var f=b.target,g=b.iframe,k=b.coords,h=!k;this.currentTarget=b.delegatedTarget;if(k){if(g){b=d.position(g,!0);var f=
this._iframeContentWindow(g),f=d.docScroll(f.document),l=e.getComputedStyle(g),n=e.toPixelValue,p=(m("ie")&&m("quirks")?0:n(g,l.paddingLeft))+(m("ie")&&m("quirks")?n(g,l.borderLeftWidth):0),g=(m("ie")&&m("quirks")?0:n(g,l.paddingTop))+(m("ie")&&m("quirks")?n(g,l.borderTopWidth):0);k.x+=b.x+p-f.x;k.y+=b.y+g-f.y}}else k=d.position(f,!0),k.x+=10,k.y+=10;var u=this,g=this._focusManager.get("prevNode");b=this._focusManager.get("curNode");var q=!b||a.isDescendant(b,this.domNode)?g:b;t.open({popup:this,
x:k.x,y:k.y,onExecute:c,onCancel:c,orient:this.isLeftToRight()?"L":"R"});this.focus();h||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);t.close(this)}},destroy:function(){h.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(b,h,k,a){return b("dijit.DropDownMenu",
a,{templateString:k,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p){return h("dijit._MenuBase",[n,p,t,q],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){c.toggle(this.domNode,"dijitMenuActive",a);c.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var b=m.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:d.hitch(this,"childSelector");this.own(f(this.containerNode,f.selector(b,e.enter),function(){a.onItemHover(m.byNode(this))}),f(this.containerNode,f.selector(b,e.leave),function(){a.onItemUnhover(m.byNode(this))}),f(this.containerNode,f.selector(b,l),function(b){a.onItemClick(m.byNode(this),b);b.stopPropagation()}),
f(this.containerNode,f.selector(b,"focusin"),function(){a._onItemFocus(m.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;a.popup?(this.set("selected",a),this.set("activated",!0),b=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY,this._openItemPopup(a,b)):(this.onExecute(),a._onClick?a._onClick(b):a.onClick(b))},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=f.once(c.domNode,"mouseover",d.hitch(this,"_onPopupHover")));var e=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
e.focusChild(a);e._cleanUp()},onExecute:d.hitch(this,"_cleanUp",!0),onClose:function(){e._mouseoverHandle&&(e._mouseoverHandle.remove(),delete e._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(a.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang",
"./_base/array"],function(b,h,k){var a=b.NodeList;h.extend(a,{_buildArrayFromCallback:function(a){for(var b=[],c=0;c<this.length;c++){var f=a.call(this[c],this[c],b);f&&(b=b.concat(f))}return b},_getUniqueAsNodeList:function(a){for(var b=[],c=0,f;f=a[c];c++)1==f.nodeType&&-1==k.indexOf(b,f)&&b.push(f);return this._wrap(b,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(a,d){a=this._getUniqueAsNodeList(a);a=d?b._filterResult(a,d):a;return a._stash(this)},_getRelatedUniqueNodes:function(a,
b){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(b),a)},children:function(a){return this._getRelatedUniqueNodes(a,function(a,b){return h._toArray(a.childNodes)})},closest:function(a,d){return this._getRelatedUniqueNodes(null,function(c,f){do if(b._filterResult([c],a,d).length)return c;while(c!=d&&(c=c.parentNode)&&1==c.nodeType);return null})},parent:function(a){return this._getRelatedUniqueNodes(a,function(a,b){return a.parentNode})},parents:function(a){return this._getRelatedUniqueNodes(a,
function(a,b){for(b=[];a.parentNode;)a=a.parentNode,b.push(a);return b})},siblings:function(a){return this._getRelatedUniqueNodes(a,function(a,b){b=[];for(var c=a.parentNode&&a.parentNode.childNodes,d=0;d<c.length;d++)c[d]!=a&&b.push(c[d]);return b})},next:function(a){return this._getRelatedUniqueNodes(a,function(a,b){for(a=a.nextSibling;a&&1!=a.nodeType;)a=a.nextSibling;return a})},nextAll:function(a){return this._getRelatedUniqueNodes(a,function(a,b){for(b=[];a=a.nextSibling;)1==a.nodeType&&b.push(a);
return b})},prev:function(a){return this._getRelatedUniqueNodes(a,function(a,b){for(a=a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a})},prevAll:function(a){return this._getRelatedUniqueNodes(a,function(a,b){for(b=[];a=a.previousSibling;)1==a.nodeType&&b.push(a);return b})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(a,
b){return 0!=b%2})},odd:function(){return this.filter(function(a,b){return 0==b%2})}});return a})},"arcgisonline/sharing/dijit/TextMenu":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.declare("arcgisonline.sharing.dijit.TextMenu",[h._Widget],{_util:arcgisonline.sharing.util,textMenuItems:[{label:"No menu items",href:"#",iconClass:null}],labelNode:null,triggerNode:null,
menu:null,handlers:[],constructor:function(a){b.mixin(this,a)},postCreate:function(){this.menu=(new h.Menu({})).placeAt(b.body());b.addClass(this.menu.domNode,"esriTextMenu");h.popup.moveOffScreen(this.menu.domNode);null!==this.textMenuItems&&this._renderItems(this.textMenuItems);b.style(this.triggerNode,"cursor","hand");b.style(this.triggerNode,"cursor","pointer");this.handlers.push(b.connect(this.triggerNode,"onclick",this,this.show));b.connect(this.menu,"onMouseLeave",b.hitch(this,function(){this.hide()}))},
show:function(a){a.preventDefault();h.popup.open({popup:this.menu,around:this.labelNode,orient:{BL:"TL",BR:"TR",TL:"BL",TR:"BR"},onExecute:b.hitch(this,this.hide),onCancel:b.hitch(this,this.hide)});this.menu.focus()},hide:function(){h.popup.close(this.menu)},destroy:function(){this.hide();b.forEach(this.handlers,function(a){b.disconnect(a)});b.forEach(b.query(".esriTextMenuItem"),function(a){h.byNode(a).destroy()},this);this.menu.destroy();this.inherited(arguments)},_renderItems:function(a){b.forEach(a,
function(a){a=new h.MenuItem(a);b.addClass(a.domNode,"esriTextMenuItem");this.menu.addChild(a)},this)}})})},"arcgisonline/sharing/dijit/AppSwitcher":function(){define("arcgisonline/sharing/dijit/_SortableLibraryMixin arcgisonline/sharing/dijit/Role arcgisonline/sharing/geow/Geow arcgisonline/sharing/util arcgisonline/sharing/geow/Account arcgisonline/pages/utils/notebook calcite-web/js/calcite-web dijit/_WidgetBase dijit/_AttachMixin dijit/_WidgetsInTemplateMixin dijit/_TemplatedMixin dojo/_base/declare dojo/_base/json dojo/dom-construct dojo/dom-attr dojo/on dojo/ready dojo/_base/lang dojo/_base/config dojo/Deferred dojo/promise/all dojo/json dojo/_base/window dojo/dom-style dojo/dom-class dojo/query dojo/_base/array dojo/hash dojo/sniff dojo/keys esri/config esri/arcgis/Portal esri/IdentityManager esri/Evented esri/request require dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!./templates/AppSwitcher.html".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v,B,A,z,y,E,D,x,K,J,H,Q,N,V,P,L,F,I,M,R,X){return n("arcgisonline.sharing.dijit.AppSwitcher",[f,g,l,m],{templateString:X,baseClass:"appSwitcherModalContent",basePath:M.toUrl("arcgisonline/sharing/dijit"),appIconPath:"/css/images/app-icons/",esriPortalConfig:esriGeowConfig,maxDragErrorTollerance:1,_browserIsEdge:!1,defaultSortableOptions:{group:"Apps",sort:!0,disabled:!1,animation:150,forceFallback:!0,delay:0,fallbackTolerance:0,ghostClass:"sortable-ghost-class",
dragClass:"sortable-drag-class"},postMixInProperties:function(){this.inherited(arguments);this.i18n=v.mixin({},R.appSwitcher);this._appsTitle=R.searchFilters.applications;this._settingsText=R.itemProperties.settings;this._clearText=R.configAGOLUtilServices.clear;this._portalUser=(this._portal=esriGeowConfig.portal)&&(this._portal.user||this._portal.getPortalUser());this.imgDir=this.basePath+this.appIconPath;this.appSwitcherInConfig=esriGeowConfig.appSwitcherConfigItemQuery?!0:null;this.__displayIntro=
!1},postCreate:function(){this.appSwitcherInConfig&&"signin.html"!==window.location.pathname.split("/home/")[1]&&(this.inherited(arguments),this._Sortable=b.init(),this.__localStorageIsAvailable=this._checkIfLocalStorageIsAvailable(),c.getSelf(v.hitch(this,function(a){this._portal?this._queryItemsAndInitApps():(this._portal=new P.Portal({url:esriGeowConfig.restBaseUrl,self:v.clone(a)}),this._connect=this._portal.on("load",v.hitch(this,function(a){this._connect.remove();this._queryItemsAndInitApps()})))})))},
startup:function(){this.inherited(arguments)},_queryItemsAndInitApps:function(a,b){this._modifyGhostClassIfUsingIe();this._portalUser=this._portal.getPortalUser();this.__changedApp=a&&b?a:null;var c=!this._cookieForQueryingItemsExists();this._portalUser&&this._portalUser.orgId&&(esriGeowConfig.self.isPortal||x.remove(this._appSwitcherBtn,"hide"),this._portal.queryItems(esriGeowConfig.appSwitcherConfigItemQuery,!0).forEach(v.hitch(this,function(a){z({config:I({url:a.itemDataUrl,content:{f:"json"}}),
marketplace:this._getMarketPlaceProvisionedListings(),preferences:this._getUserProperties(),customOrgApps:this._getApprovedApps(),notebookServerConfigured:d.notebookServerConfigured()}).then(v.hitch(this,function(a){this.userApps=a.config.appSwitcher;this.userProperties=a.preferences.properties||{};this.approvedApps=a.customOrgApps.approvedApps||[];this.notebookServerConfigured=a.notebookServerConfigured;this.userProperties.appLauncher||(c=!1,this.__displayIntro=!0);this._init(a.marketplace.provisionedListings,
c)}))})))},_init:function(a,b,c,d){this._getLicensedApps(a,b).then(v.hitch(this,function(a){this._appDictionary=a[1];this.userProperties.appLauncher&&this.userProperties.appLauncher.primary&&this.userProperties.appLauncher.secondary?this._queryAppItemsForChanges(this.approvedApps,b).then(v.hitch(this,function(){this._newAppDictionary=v.clone(this._appDictionary);this.primaryApps=this.userProperties.appLauncher.primary.reduce(this._populateAppIdentifiers.bind(this),[]);this.secondaryApps=this.userProperties.appLauncher.secondary.reduce(this._populateAppIdentifiers.bind(this),
[]);for(var b in this._newAppDictionary)this._newAppDictionary[b].canAccess&&(this._newAppDictionary[b].isNew=!0,this._appDictionary[b]=this._newAppDictionary[b],this.primaryApps.push(this._newAppDictionary[b]));this._postMessageAppsOrInitAppSwitcher(a[0])})):(this.primaryApps=a[0].slice().sort(function(a,b){return a.label<b.label?-1:1}),this.secondaryApps=[],this._postMessageAppsOrInitAppSwitcher(a[0]))}))},_postMessageAppsOrInitAppSwitcher:function(a){var b=this.parseParms(window.location.hash.substring(1));
this.postMessageCurrentUserApps?(a=this.primaryApps.concat(this.secondaryApps).unshift(this._getAgoApp()),this._postMessageAppsToOrigin(a,b.origin)):0!==a.length&&this._initAppSwitcher()},_initFromLocalStorage:function(a){var b=this.parseParms(window.location.hash.substring(1));this.primaryApps=a.primaryApps;this.secondaryApps=a.secondaryApps;this.postMessageCurrentUserApps?(a=this.primaryApps.concat(this.secondaryApps).unshift(this._getAgoApp()),this._postMessageAppsToOrigin(a,b.origin)):(this._initAppSwitcher(),
this._refreshAppSwitcherIcons())},_getLicensedApps:function(a,b){for(var c={},d={},e=this._getAppExceptions(),f=[],g=new A,k=this.userApps.apps.length,h=0;h<k;h++){var l=this.userApps.apps[h],m=l.itemId||l.title,n=!0;c[m]=1;d[m]=l;if(!e[l.title]||e[l.title].hasAccess(l.title))if(l.privileges&&0!==l.privileges.length||l.isLicensed){if(l.privileges&&0<l.privileges.length&&this._portalUser.privileges){for(var p=0;p<l.privileges.length;p++)if(0>this._portalUser.privileges.indexOf(l.privileges[p])){n=
!1;break}if(!l.isLicensed&&n){d[m].canAccess=!0;f.push(this._modifyAppForView(l));continue}}if(l.isLicensed&&n)for(n=0;n<a.length;n++)if(m===a[n].itemId||m===a[n].title){d[m].canAccess=!0;f.push(this._modifyAppForView(l));break}}else d[m].canAccess=!0,f.push(this._modifyAppForView(l))}a.forEach(v.hitch(this,function(a){"Web Mapping Application"===a.type&&!c[a.itemId]&&a.url&&a.title&&0>a.typeKeywords.indexOf("hideFromAppSwitcher")&&(a.canAccess=!0,a.webMappingApp=!0,d[a.itemId]=a,f.push(a))}));return g.resolve([this.approvedApps.map(function(a){var c=
v.mixin(a.appProperties,{itemId:a.itemId,webMappingApp:!0,approvedApp:!0,canAccess:!b});return d[a.itemId]=c}).concat(f),d])},_getApprovedApps:function(a){var b=esriGeowConfig.restBaseUrl.replace("http://","https://")+"portals/"+esriGeowConfig.self.id+"/approvedApps";return I({url:b,content:{f:"json",returnAllApps:a}})},_populateAppIdentifiers:function(a,b,c){if((c=this._appDictionary[b.uid])&&c.hasBeenPopulated)return a;c?((b.hasChanged||c.hasChanged||!c.canAccess&&!c.ignoreNoAccess)&&esriGeowConfig.userRole&&
esriGeowConfig.userRole.isAdmin()&&(b.hasChanged||b.ignoreNoAccess||(this.__saveOnLoad=!0),this._appDictionary[b.uid].hasChanged=!0,(this._appDictionary[b.uid].ignoreNoAccess=b.ignoreNoAccess)||x.remove(this._displayGoToSettingsWarning,"hide")),b.isNew&&(this._appDictionary[b.uid].isNew=!0),delete this._newAppDictionary[b.uid]):(c=b,c.canAccess=!1,c.itemId=b.uid,this._appDictionary[b.uid]=c);this._appDictionary[b.uid].hasBeenPopulated=!0;a.push(c);return a},_dismissGoToSettingsWarning:function(){this._saveCurrentOrderOfAppsAndIgnoreNoAccess();
x.add(this._displayGoToSettingsWarning,"hide")},_dismissRemovedAppWarning:function(){x.add(this._displayRemovedAppWarning,"hide");this.__removedAppWithFoucs=null},_goToOrgSettings:function(){this._saveCurrentOrderOfAppsAndIgnoreNoAccess().then(v.hitch(this,function(a){window.location.href=esriGeowConfig.baseUrl+"organization.html"}))},_modifyAppForView:function(a){delete a.isLicensed;delete a.privileges;return a},_saveAppOrderToUserProperties:function(a,b){this.userProperties.appLauncher||(this.userProperties.appLauncher=
{});if(JSON.stringify(this.userProperties.appLauncher.primary)!==JSON.stringify(a)||JSON.stringify(this.userProperties.appLauncher.secondary)!==JSON.stringify(b))return this.userProperties.appLauncher.primary=a,this.userProperties.appLauncher.secondary=b,this._updateUserProperties(this.userProperties)},_saveCurrentOrderOfApps:function(a,b,c){return this._saveAppOrderToUserProperties(this.populateDataIdAttributes(this.primarySortable.toArray(),a,b,c),this.populateDataIdAttributes(this.secondarySortable.toArray(),
a,b,c))},_saveCurrentOrderOfAppsAndIgnoreNoAccess:function(){return this._saveAppOrderToUserProperties(this.populateDataIdAttributesAndIgnoreNoAccess(this.primarySortable.toArray()),this.populateDataIdAttributesAndIgnoreNoAccess(this.secondarySortable.toArray()))},_getUserProperties:function(){return I({url:esriGeowConfig.restBaseUrl+"community/users/"+this._portalUser.username+"/properties",content:{f:"json"}})},_updateUserProperties:function(a){return I({url:esriGeowConfig.restBaseUrl+"community/users/"+
this._portalUser.username+"/setProperties",content:{f:"json",properties:y.stringify(a)}},{usePost:!0})},_getMarketPlaceProvisionedListings:function(){return I({url:this._portal.portalUrl+"community/users/"+this._portalUser.username+"/provisionedListings",content:{f:"json",start:1,num:200,reservedType:"Registered App"}})},_getAppExceptions:function(){return{"Open Data":{hasAccess:this._userHasAccessToOpenData.bind(this)},"ArcGIS Hub":{hasAccess:this._userHasAccessToHub.bind(this)},"ArcGIS Enterprise Sites":{hasAccess:this._userHasAccessToSites.bind(this)},
"Operations Dashboard for ArcGIS":{hasAccess:function(a){return esriGeowConfig.showCreateDashboard&&this._isInPortalConfig(a)}.bind(this)},"Workforce for ArcGIS":{hasAccess:this._isInPortalConfig.bind(this)},"Ortho Maker":{hasAccess:this._isInPortalConfig.bind(this)},Notebook:{hasAccess:this._hasAccessToNotebooks.bind(this)}}},_hasAccessToNotebooks:function(a){return this.notebookServerConfigured&&this._isInPortalConfig(a)&&esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateNotebooks()},_isInPortalConfig:function(a){return!esriGeowConfig.self.isPortal||
esriGeowConfig.showInAppLauncher&&-1!==esriGeowConfig.showInAppLauncher.indexOf(a)},_userHasAccessToOpenData:function(){return this.esriPortalConfig.self&&this.esriPortalConfig.self.portalProperties&&(!this.esriPortalConfig.self.portalProperties.openData||this.esriPortalConfig.self.portalProperties.openData&&!this.esriPortalConfig.self.portalProperties.openData.enabled)?!1:!0},_userHasAccessToHub:function(){return this.esriPortalConfig.self&&this.esriPortalConfig.self.subscriptionInfo&&this.esriPortalConfig.self.subscriptionInfo.hubSettings&&
this.esriPortalConfig.self.subscriptionInfo.hubSettings.enabled||this._userHasAccessToOpenData()?!0:!1},_userHasAccessToSites:function(a){return this.esriPortalConfig.userRole&&this.esriPortalConfig.userRole.isAdmin()&&this._isInPortalConfig(a)},_getAgoApp:function(){return{image:"arcgis-online.png",label:"ArcGIS Online",title:"ArcGIS Online",url:this._getOriginOfUrl()}},_getOriginOfUrl:function(a){a=a||window.location;return a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")},_postMessageAppsToOrigin:function(a,
b){b&&window.parent&&window.parent.postMessage(JSON.stringify(a?{success:!0,apps:a}:{success:!1}),b)},_initAppSwitcher:function(){esriGeowConfig.self.isPortal&&x.remove(this._appSwitcherBtn,"hide");this._removeDisabledState();this._createDropdown();e.init(["dropdown"])},_removeDisabledState:function(){D.set(this._appSwitcherBtn,"opacity","1");x.remove(this._appSwitcherBtn,"disabled-state");p.set(this._appSwitcherBtn,"tabindex","0")},_createDropdown:function(){var a=t.create;this._dropdownContent&&
(this._dropdownContent.innerHTML="");this._dropdownContent=a("div",{style:"width:100%;"},this._dropdownAppWrapper);this._adjustDropdownHeight();this.__displayIntro&&this._createDragAndDropIntroIn(this._dropdownContent);this.topAppContainer=a("ul",{"class":"appContainer appContainer-primary block-group js-prevent-dropdown__app-switcher",id:"dropdownAppContainer",role:"menu"},this._dropdownContent);this._secondaryDropdownMenu=a("div",{"class":"appContainer-secondary secondary-dropdown-menu js-prevent-dropdown__app-switcher",
"aria-expanded":this.__displayIntro?"true":"false",innerHTML:"\x3chr\x3e"},this._dropdownContent);a("button",{class:"show-more-button js-prevent-dropdown__app-switcher",innerHTML:this.i18n.showMore,onclick:this._expandSecondaryDropdown.bind(this)},this._secondaryDropdownMenu).innerHTML+=" "+this._getDownCarrotSvg();var b=a("div",{"class":"bottomContainer"},this._secondaryDropdownMenu),c=!this.secondaryApps.length;this.bottomAppContainer=a("ul",{"class":"appContainer appContainer-secondary block-group js-prevent-dropdown__app-switcher"+
(c?" drag-apps-here-box":""),role:"menu"},b);this._dragAppsHereText=a("p",{innerHTML:this.i18n.dragAppsHere,"class":"hide"},this.bottomAppContainer);this._assignEventListeners();this._moveIfRightToLeft(this.topAppContainer);this.primaryApps.forEach(this.appendAppToContainer.bind(this,this.topAppContainer));c?x.remove(this._dragAppsHereText,"hide"):this.secondaryApps.forEach(this.appendAppToContainer.bind(this,this.bottomAppContainer));this.primarySortable=this._Sortable.create(this.topAppContainer,
v.mixin(this.defaultSortableOptions,{onStart:v.hitch(this,function(a){x.add(this._dragAppsHereText,"hide");this._removeMouseUpListener();this._disableLinkHref(a,!0)}),onEnd:v.hitch(this,function(a){a.preventDefault();this._removeMouseOverListener();this._disableLinkHref(a,!1);x.remove(this._dropdownContent,"dragging");x.remove(this.bottomAppContainer,"on-drag-over");this._hideOrShowDropAppsHereMessage(a.to);return!1}),onMove:v.hitch(this,function(a,b){a.to===this.bottomAppContainer?x.add(this.bottomAppContainer,
"on-drag-over"):x.remove(this.bottomAppContainer,"on-drag-over")}),store:{get:function(a){return a.options.group.name&&a.options.group.name.split("!")||[]},set:v.hitch(this,function(a){if(this.__simulatedDragEvent){a=this.populateDataIdAttributes(a.toArray());var b=this.populateDataIdAttributes(this.secondarySortable.toArray());this._saveAppOrderToUserProperties(a,b)}else this._generateCustomLinkClick(this.__startApp,this.__startElement,this.__removeStartApp);this.__startElement&&x.remove(this.__startElement,
"sortable-drag-class");this.__simulatedDragEvent=!1})}}));this.secondarySortable=this._Sortable.create(this.bottomAppContainer,v.mixin(this.defaultSortableOptions,{onStart:v.hitch(this,function(a){this._removeMouseUpListener();this._disableLinkHref(a,!0)}),onEnd:v.hitch(this,function(a){a.preventDefault();this._removeMouseOverListener();this._disableLinkHref(a,!1);x.remove(this._dropdownContent,"dragging");a.to!==this.topAppContainer||this.secondarySortable.toArray().length||(x.add(this.bottomAppContainer,
"drag-apps-here-box"),x.remove(this._dragAppsHereText,"hide"))}),store:{get:function(a){return a.options.group.name&&a.options.group.name.split("!")||[]},set:v.hitch(this,function(a){if(this.__simulatedDragEvent){a=this.populateDataIdAttributes(a.toArray());var b=this.populateDataIdAttributes(this.primarySortable.toArray());this._saveAppOrderToUserProperties(b,a)}else this._generateCustomLinkClick(this.__startApp,this.__startElement,this.__removeStartApp);this.__startElement&&x.remove(this.__startElement,
"sortable-drag-class");this.__simulatedDragEvent=!1})}}));this.__changedApp?this._saveCurrentOrderOfApps(this.__changedApp,"hasChanged",null):this.__saveOnLoad&&this._saveCurrentOrderOfApps()},appendAppToContainer:function(a,b,c){b.webMappingApp?this._createWebMappingAppLayout(a,b,b.itemId||b.title,c):this._createBasicAppLayout(a,b,b.itemId||b.title,c)},populateDataIdAttributes:function(a,b,c,d){return a.map(function(e,f){var g=this._appDictionary[e],k={label:g.label,uid:e};g.isNew&&(k.isNew=!0);
g.hasChanged&&!g.ignoreNoAccess&&(k.hasChanged=!0);b&&e===b&&(a[f-1]===e&&(this.__duplicateValueIndex=f),d?(this._appDictionary[e][c]=d,k[c]=d):(delete this._appDictionary[e][c],delete k[c]));g.canAccess&&g.ignoreNoAccess&&delete k.ignoreNoAccess;return k},this)},populateDataIdAttributesAndIgnoreNoAccess:function(a){return a.map(function(a){var b=this._appDictionary[a];a={label:b.label,uid:a};b.isNew&&(a.isNew=!0);b.canAccess||(a.ignoreNoAccess=!0);return a},this)},_generateCustomLinkClick:function(a,
b,c){a&&b&&(a.canAccess?(this._closeAppSwitcher(),window.open(a.url,"_blank")):c?(this.__removeStartApp=!1,this._removeAppFromDropdown(a.itemId||a.title,b)):this._showRemovedAppWarning(a.itemId||a.title,b))},_expandSecondaryDropdown:function(a){this._secondaryDropdownMenu.setAttribute("aria-expanded","true")},_hideOrShowDropAppsHereMessage:function(a){a===this.bottomAppContainer&&1===this.secondarySortable.toArray().length?(x.remove(this.bottomAppContainer,"drag-apps-here-box"),x.add(this._dragAppsHereText,
"hide")):this.secondarySortable.toArray().length||(x.add(this.bottomAppContainer,"drag-apps-here-box"),x.remove(this._dragAppsHereText,"hide"))},_createDragAndDropIntroIn:function(a){this.__dragAndDropIntro=t.create("div",{"class":"js-prevent-dropdown__app-switcher text-center"},a);t.create("p",{"class":"drag-and-drop-intro js-prevent-dropdown__app-switcher",innerHTML:this.i18n.dragAndDropIntroText},this.__dragAndDropIntro);t.create("button",{"class":"dismiss-intro-button js-prevent-dropdown__app-switcher",
innerHTML:this.i18n.gotIt,onclick:this._onClickDismissIntroButton.bind(this)},this.__dragAndDropIntro)},_onClickDismissIntroButton:function(a){this._saveCurrentOrderOfApps();this.__displayIntro=!1;t.destroy(this.__dragAndDropIntro)},_disableLinkHref:function(a,b){var c=this._appDictionary[a.item.getAttribute("data-id")].isNew?a.item.children[1]:a.item.children[0];b?(this.__recentlyRemovedHref=c.href,p.remove(c,"href")):setTimeout(v.hitch(this,function(){c.href=this.__recentlyRemovedHref},1))},_moveIfRightToLeft:function(a){this.esriPortalConfig.isRightToLeft&&
(D.set(this._dropdownAppNav,"right","-290px"),D.set(this._dropdownAppNav,"top","64px"))},_assignEventListeners:function(){dojo.subscribe("appLauncher/app/updated",this._updateAppIconWithinAppSwitcher.bind(this));dojo.subscribe("appLauncher/app/deleted",this._deleteAppSwitcherIcon.bind(this));dojo.subscribe("appLauncher/restart",this._refreshAppSwitcherIcons.bind(this));var a=this._dropdownWrapper,b=this._dropdownAppNav;u(document,"click",v.hitch(this,function(c){!c.target||x.contains(c.target,"js-prevent-dropdown__app-switcher")||
c.target.className.baseVal&&"js-prevent-dropdown__app-switcher"===c.target.className.baseVal||c.target.parentNode&&x.contains(c.target.parentNode,"js-prevent-dropdown__app-switcher")||c.target===b?(x.remove(a,"is-active"),x.add(a,"is-active")):(this._closeAppSwitcher(),this._closeSecondaryDropdown())}))},_removeMouseUpListener:function(){this.__listenForMouseUp&&this.__listenForMouseUp.remove&&this.__listenForMouseUp.remove()},_removeMouseOverListener:function(){this.__listenForMouseOver&&this.__listenForMouseOver.remove&&
this.__listenForMouseOver.remove()},_closeAppSwitcher:function(){this._removeMouseUpListener();this._removeMouseOverListener();setTimeout(v.hitch(this,function(){x.remove(this._dropdownWrapper,"is-active")}),0)},_closeSecondaryDropdown:function(){!this.__displayIntro&&this._secondaryDropdownMenu&&this._secondaryDropdownMenu.setAttribute("aria-expanded","false")},_adjustDropdownWidth:function(a){var b=110,c=b*=5>a?a:4.6;D.set(this._dropdownAppNav,"min-width",String(c)+"px");2<a&&x.add(this._dropdownAppNav,
"greater-than-2-apps")},_adjustDropdownHeight:function(){D.set(this._dropdownAppNav,"max-height",String(window.innerHeight-80)+"px")},_getAppImg:function(a){return this.imgDir+a.replace(/\s/,"-").toLowerCase()+".png"},_getAbbreviation:function(a){return a.replace(/[a-z]?\s?/g,"").substring(0,4)},_createBasicAppLayout:function(a,b,c,d){d=t.create;var e=this._browserIsEdge?" user-select-none":"",f=[0,28,20,16,14,14,12];a=d("li",{alt:"","class":"js-prevent-dropdown__app-switcher block link-off-black appLinkContainer grabbable "+
(b.canAccess?"with-hover":"no-hover"),onmousedown:this._interactWithAppLi.bind(this,b),onkeyup:this._activateAccessibilityMode.bind(this,b),onkeydown:this._preventBrowserKeyboardDefaults,role:"menuitem","data-id":c},a);if(b.canAccess)if(b.isNew&&d("div",{"class":"app-indicator app-indicator-new js-prevent-dropdown__app-switcher"},a),a=d("a",{href:b.url||"",onblur:this._deactivateAccessibilityMode.bind(this,b),target:"_blank","class":"appLink"},a),b.image)f=this.imgDir+b.image,c=d("div",{"class":"js-prevent-dropdown__app-switcher appIconImage"+
e},a),c.appendChild(this._getAccessibleAppArrows()),d("img",{"class":"appIconPng",alt:"",src:f},c);else{c=b.abbr||b.abbreviation;var f=String(f[c.length])+"px",g=d("div",{"class":"js-prevent-dropdown__app-switcher appIconImage"},a);g.appendChild(this._getAccessibleAppArrows());d("span",{innerHTML:c,style:"font-size:"+f,"class":"avenir appIconSvgText"+e,"aria-hidden":"true"},g);d("img",{src:this.imgDir+"svg-app-icon.svg",alt:"","class":e},g)}else d("div",{"class":"app-indicator app-indicator-removed js-prevent-dropdown__app-switcher"+
(Q("highcontrast")?" high-contrast-fill":""),tabindex:0,innerHTML:this._getRemoveAppX(),onclick:this._removeAppFromDropdown.bind(this,b.uid,a),onkeyup:this._removeAppFromDropdown.bind(this,b.uid,a),onkeydown:this._preventBrowserKeyboardDefaults},a),d("div",{"class":"missing-app-icon appIconImage js-prevent-dropdown__app-switcher",tabindex:0,onblur:this._deactivateAccessibilityMode.bind(this,b),"aria-label":this.i18n.noLongerAvailable,onkeyup:this._showRemovedAppWarning.bind(this,b.uid,a),onclick:this._showRemovedAppWarning.bind(this,
b.uid,a)},a).appendChild(this._getAccessibleAppArrows());d("p",{innerHTML:b.label,style:"margin:0 auto; text-align:center","class":e},a)},_createWebMappingAppLayout:function(a,b,c,d){d=t.create;var e=this._browserIsEdge?" user-select-none":"",f=[0,32,24,20,18,16,14];b.appSwitcher=b.properties&&b.properties.appSwitcher?b.properties.appSwitcher:{};c=d("li",{alt:"","class":"js-prevent-dropdown__app-switcher block link-off-black appLinkContainer"+(b.canAccess?" grabbable with-hover":""),role:"menuitem",
onmousedown:this._interactWithAppLi.bind(this,b),onkeyup:this._activateAccessibilityMode.bind(this,b),onkeydown:this._preventBrowserKeyboardDefaults,"data-id":c},a||null);if(b.canAccess){b.isNew&&d("div",{"class":"app-indicator app-indicator-new js-prevent-dropdown__app-switcher"},c);var g=d("a",{href:b.url,target:"_blank",onblur:this._deactivateAccessibilityMode.bind(this,b),"class":"appLink"},c);if(b.appSwitcher.image||b.icon){var k=this._getImgSrcForWebMappingApp(b),f=d("div",{"class":"js-prevent-dropdown__app-switcher appIconImage"+
e},g);f.appendChild(this._getAccessibleAppArrows());d("img",{"class":"appIconPng",alt:"",src:k},f)}else{var k=b.appSwitcher.abbr||b.abbreviation,h=Math.round(this._getTextWidth(k,"avenir")/5),f=k?String(f[h])+"px":"",h=d("div",{"class":"js-prevent-dropdown__app-switcher appIconImage"},g);h.appendChild(this._getAccessibleAppArrows());d("span",{innerHTML:k||"",style:f?"font-size:"+f:"","class":"avenir appIconSvgText"+e,"aria-hidden":"true"},h);d("img",{src:this.imgDir+"svg-app-circle.svg",alt:"","class":e},
h)}d("p",{innerHTML:b.title||b.label,style:"margin:0 auto; text-align:center","class":e},g)}else d("div",{"class":"app-indicator app-indicator-removed js-prevent-dropdown__app-switcher"+(Q("highcontrast")?" high-contrast-fill":""),tabindex:0,innerHTML:this._getRemoveAppX(),onclick:this._removeAppFromDropdown.bind(this,b.uid,c)},c),d("div",{"class":"missing-app-icon appIconImage js-prevent-dropdown__app-switcher","aria-label":this.i18n.noLongerAvailable,tabindex:0,onblur:this._deactivateAccessibilityMode.bind(this,
b),onclick:this._showRemovedAppWarning.bind(this,b.uid,c)},c).appendChild(this._getAccessibleAppArrows()),d("p",{innerHTML:b.label,style:"margin:0 auto; text-align:center","class":e},c);if(!a)return c},_getTextWidth:function(a,b){var c=(this._getTextWidth.canvas||(this._getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");c.font=b;return c.measureText(a).width},_getAccessibleAppArrows:function(){return t.create("span",{"class":"arrow-keys-disabled"},null)},_getDownCarrotSvg:function(){return'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"13" height\x3d"13" viewBox\x3d"0 0 32 32" class\x3d"down-carrot-svg js-prevent-dropdown__app-switcher"\x3e\x3cpath d\x3d"M28 9v5L16 26 4 14V9l12 12L28 9z"\x3e\x3c/path\x3e\x3c/svg\x3e'},
_getRemoveAppX:function(){return'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"12" height\x3d"12" viewBox\x3d"0 0 32 32" class\x3d"js-prevent-dropdown__app-switcher"\x3e\x3cpath class\x3d"js-prevent-dropdown__app-switcher" d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\x3c/svg\x3e'},_removeAppFromDropdown:function(a,b,c){if(!c||this._verifyKeyPress(c.keyCode))t.destroy(b),setTimeout(v.hitch(this,
function(){var a=this.populateDataIdAttributes(this.secondarySortable.toArray()),b=this.populateDataIdAttributes(this.primarySortable.toArray());this._saveAppOrderToUserProperties(b,a)},0))},_removeAppWithFocus:function(){var a=this.__removedAppWithFoucs;a&&(this._removeAppFromDropdown(a.uid,a.el),this._dismissRemovedAppWarning())},_showRemovedAppWarning:function(a,b,c){this.__removedAppWithFoucs||c&&!this._verifyKeyPress(c.keyCode)?(this.__removedAppWithFoucs=null,x.add(this._displayRemovedAppWarning,
"hide")):(x.remove(this._displayRemovedAppWarning,"hide"),x.add(this._displayGoToSettingsWarning,"hide"),this._dropdownAppNav.scrollTop=0,this.__removedAppWithFoucs={uid:a,el:b})},_interactWithAppLi:function(a,b){if(0===b.button){this.__startClientX=b.clientX;this.__startClientY=b.clientY;this.__startApp=a;this.__startElement=b.currentTarget;setTimeout(v.hitch(this,function(a){x.remove(this.__startElement,"sortable-drag-class")},1));if(a.isNew){var c=this.populateDataIdAttributes(this.secondarySortable.toArray()),
d=this.populateDataIdAttributes(this.primarySortable.toArray(),b.currentTarget.getAttribute("data-id"),"isNew",!1);this.__duplicateValueIndex&&d.splice(this.__duplicateValueIndex,1);this._saveAppOrderToUserProperties(d,c)}x.remove(b.currentTarget,"sortable-drag-class");if(a.canAccess)this.__listenForMouseUp=u(this._dropdownWrapper,"mouseup",v.hitch(this,function(a){this._closeAppSwitcher()})),this.__listenForMouseOver=u(b.currentTarget.parentNode,"mousemove",v.hitch(this,function(a){if(Math.abs(a.clientX-
this.__startClientX)>this.maxDragErrorTollerance||Math.abs(a.clientY-this.__startClientY)>this.maxDragErrorTollerance)this.__simulatedDragEvent=!0,x.add(this._dropdownContent,"dragging"),this._removeMouseOverListener()}));else if(x.contains(b.target,"app-indicator-removed")||x.contains(b.target.parentNode,"app-indicator-removed")||x.contains(b.target.parentNode.parentNode,"app-indicator-removed"))this.__removeStartApp=!0}},_activateAccessibilityMode:function(a,b){if(!x.contains(b.target,"app-indicator-removed")&&
(b.preventDefault(),b.keyCode===N.SPACE)){if(this.__activeAccessibleListElement)return this._deactivateAccessibilityMode(a,b);var c=a.canAccess?b.target.firstChild.firstChild:b.target.firstChild,d=b.target.parentNode,e=d.parentNode,f=this._getIndexOfListItem(d);b=this.primaryApps.length;this._expandSecondaryDropdown();var g=this._getCombinedIndexOfApp(f,e,b);this.__activeAccessibleListElement=!0;this.__activeAccessibleListElementEvent=u(d,"keydown",v.hitch(this,function(b){this._moveAppWithArrowKeys(a,
this._getArrowKeyDirection(b),this._getArrayOfDirections(g,e),d,e,f,b)}));this._populateAccessibleArrows(c,f,e,b)}return!1},_deactivateAccessibilityMode:function(a,b){b=b.target||b;x.replace(a.canAccess?b.firstChild.firstChild:b.firstChild,"arrow-keys-disabled","arrow-keys-enabled");this.__activeAccessibleListElement=!1;this.__activeAccessibleListElementEvent&&this.__activeAccessibleListElementEvent.remove&&this.__activeAccessibleListElementEvent.remove()},_getArrowKeyDirection:function(a){if(a.keyCode===
N.DOWN_ARROW)return"bottom";if(a.keyCode===N.UP_ARROW)return"top";if(a.keyCode===N.RIGHT_ARROW)return esriGeowConfig.isRightToLeft?"left":"right";if(a.keyCode===N.LEFT_ARROW)return esriGeowConfig.isRightToLeft?"right":"left"},_preventBrowserKeyboardDefaults:function(a){a.keyCode!==N.SPACE&&a.keyCode!==N.DOWN_ARROW&&a.keyCode!==N.UP_ARROW||a.preventDefault()},_moveAppWithArrowKeys:function(a,b,c,d,e,f,g){"bottom"===b&&-1<c.indexOf("bottom")&&this._moveAppByNumberOfSpaces(d,f,e,3,a,g);"top"===b&&-1<
c.indexOf("top")&&this._moveAppByNumberOfSpaces(d,f,e,-3,a,g);"right"===b&&-1<c.indexOf("right")&&this._moveAppByNumberOfSpaces(d,f,e,1,a,g);"left"===b&&-1<c.indexOf("left")&&this._moveAppByNumberOfSpaces(d,f,e,-1,a,g)},_moveAppByNumberOfSpaces:function(a,b,c,d,e,f){var g=b+d,k=c===this.bottomAppContainer?c.children.length-1:c.children.length,h=c===this.topAppContainer;h&&g<k||!h&&g<=k&&0<g?c.insertBefore(a,0>d?c.children[g]:c.children[g].nextSibling):h?(this._moveAppToSecondaryList(a,b,d),this._hideOrShowDropAppsHereMessage(this.bottomAppContainer)):
(this._moveAppToPrimaryList(a,b,d),this._hideOrShowDropAppsHereMessage(this.topAppContainer));this._deactivateAccessibilityMode(e,f);e.canAccess&&!e.isNew?a.children[0].focus():a.children[1].focus();setTimeout(v.hitch(this,function(){if(e.isNew){var a=this.populateDataIdAttributes(this.secondarySortable.toArray()),b=this.populateDataIdAttributes(this.primarySortable.toArray(),e.itemId||e.title,"isNew",!1);this._saveAppOrderToUserProperties(b,a)}else this._saveCurrentOrderOfApps()},0))},_moveAppToPrimaryList:function(a,
b,c){var d=this.topAppContainer;b=b%3||3;var e=f%3||3,f=this.topAppContainer.children.length;if(1===Math.abs(c)||3===e)return d.appendChild(a);if(2===b&&1<e)return d.insertBefore(a,d.children[f-(e-1)]);if(1===b&&f)return d.insertBefore(a,d.children[f-e]);d.appendChild(a)},_moveAppToSecondaryList:function(a,b,c){var d=this.bottomAppContainer,e=this.bottomAppContainer.children.length-1;b=(b+1)%3||3;if(!e)return d.appendChild(a);if(1===Math.abs(c))return d.insertBefore(a,d.children[1]);if(2===b&&1<e)return d.insertBefore(a,
d.children[2]);if(3===b&&2===e)return d.insertBefore(a,d.children[3]);d.insertBefore(a,d.children[1])},_getCombinedIndexOfApp:function(a,b,c){return a+(b===this.bottomAppContainer?c:1)},_getIndexOfListItem:function(a){return Array.prototype.indexOf.call(a.parentNode.children,a)},_populateAccessibleArrows:function(a,b,c,d){x.replace(a,"arrow-keys-enabled","arrow-keys-disabled");b=this._getCombinedIndexOfApp(b,c,d);a.innerHTML=this._getAccessibleArrows(this._getArrayOfDirections(b,c),c)},_getAccessibleArrows:function(a){return a.reduce(function(a,
b){return a+this._getAccessibleArrow(b)}.bind(this),"")},_getAccessibleArrow:function(a){return'\x3cdiv class\x3d"app-arrow app-arrow-'+a+'"\x3e\x3c/div\x3e'},_getArrayOfDirections:function(a,b){var c=[],d=this.topAppContainer.children.length,e=this.bottomAppContainer.children.length-1,f=d+e;0<a-1&&c.push("left");(a+1<=f||!e)&&a!==d&&c.push("right");0<a-3&&c.push("top");(a-d+2<e||b===this.topAppContainer)&&c.push("bottom");return c},_getAppLiElementFromAppId:function(a){var b=this.primarySortable.toArray().indexOf(a);
if(-1<b)return this.topAppContainer.children[b];a=this.secondarySortable.toArray().indexOf(a);return-1<a?this.bottomAppContainer.children[a+1]:!1},_refreshAppSwitcherIcons:function(){this._queryItemsAndInitApps()},_updateAppIconWithinAppSwitcher:function(a,b){b=v.mixin(JSON.parse(b),{itemId:a,webMappingApp:!0,approvedApp:!0,canAccess:!0});if(this._appDictionary[a]){var c=this._getAppLiElementFromAppId(a);if(c){var d=this._createWebMappingAppLayout(null,b,a);c.parentNode.replaceChild(d,c)}}else b.isNew=
!0,this.appendAppToContainer(this.topAppContainer,b);this._appDictionary[a]=b},_deleteAppSwitcherIcon:function(a,b){if(a=this._getAppLiElementFromAppId(a))t.destroy(a),setTimeout(v.hitch(this,function(){this._saveCurrentOrderOfApps()},0))},_getImgSrcForWebMappingApp:function(a){return a.icon?esriGeowConfig.restBaseUrl+"portals/self/resources/"+a.icon+"?token\x3d"+esriGeowConfig.userInfo.token:"https://"+esriGeowConfig.self.portalHostname+"/sharing/rest/content/items/"+a.itemId+"/resources/"+a.appSwitcher.image+
"?token\x3d"+esriGeowConfig.userInfo.token},parseParms:function(a){a=a.split("\x26");var b={},c,d;for(c=0;c<a.length;c++)d=a[c].split("\x3d"),2>d.length&&d.push(""),b[decodeURIComponent(d[0])]=decodeURIComponent(d[1]);return b},_queryAppItemsForChanges:function(a,b){var c=new A,d=esriGeowConfig.restBaseUrl+"search?";if(!b)return c.resolve({success:!0});d=d+"f\x3djson\x26num\x3d100\x26q\x3d id:("+(a.map(function(a){return'"'+a.itemId+'"'}).join(" OR ")+")");return I({url:d,content:{f:"json"}}).then(v.hitch(this,
function(a){a.results&&0<a.results.length&&a.results.forEach(function(a){var b=this._appDictionary[a.id];b.canAccess=1;b.hasChanged=b.url!==a.url?a.url:0},this);return c.resolve({success:!0})}))},_getAppsFromLocalStorage:function(){if(!this.__localStorageIsAvailable)return!1;var a=localStorage.getItem("APSW-primary"),b=localStorage.getItem("APSW-secondary");return a?{primaryApps:a,secondaryApps:b}:!1},_saveApssToLocalStorage:function(a,b){this.__localStorageIsAvailable&&(localStorage.setItem("APSW-primary",
JSON.stringify(a)),localStorage.setItem("APSW-secondary",JSON.stringify(b)))},_cookieForQueryingItemsExists:function(){var a=dojo.cookie("APSW-query")&&JSON.parse(dojo.cookie("APSW-query"));if(a&&a.expires>(new Date).setHours((new Date).getHours()))return!0;a=JSON.stringify({expires:(new Date).setHours((new Date).getHours()+5)});dojo.cookie("APSW-query",a,{path:"/",domain:document.domain});return!1},getCookie:function(a){if(a=dojo.cookie(a))a=y.parse(a),L.registerToken({server:this.portal.portalUrl,
token:a.token,userId:a.email,expires:a.expires?new Date(a.expires):(new Date).setHours((new Date).getHours()+2),ssl:a.ssl||!1});return a},_checkIfLocalStorageIsAvailable:function(){if("object"===typeof localStorage)try{return localStorage.setItem("testLocalStorage",1),localStorage.removeItem("testLocalStorage"),!0}catch(O){return!1}},_modifyGhostClassIfUsingIe:function(){10>=Q("ie")||6<Q("trident")?this.defaultSortableOptions.ghostClass="sortable-ghost-class-with-pointer-events":Q("edge")&&(this._browserIsEdge=
!0)},_verifyKeyPress:function(a){return!a||13===a},signIn:function(){var a,b=this.getCookie(this.esriPortalConfig.cookieName||"esri_auth");b?a=this.portal.signIn().then(v.hitch(this,function(a){a.orgUrl=a.portal.urlKey&&a.portal.customBaseUrl?a.portal.urlKey+"."+a.portal.customBaseUrl:a.portal.portalUrl;a.cookie=b;a.isOrgUser=a.portal.urlKey&&a.portal.customBaseUrl;a.userRole=new h({portalUser:a});k.setCookies(this.portal);esriGeowConfig=v.mixin(esriGeowConfig,{self:this.portal,userInfo:a,portal:this.portal,
userRole:a.userRole});return this.portal.allSSL&&"https:"!==window.location.protocol?(window.location=window.location.href.replace("http:","https:"),null):a})):(a=new A,a.resolve(null));return a}})})},"arcgisonline/sharing/dijit/_SortableLibraryMixin":function(){define([],function(){return{init:function(){return function(){function b(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a;this.options=b=v({},b);a[T]=this;var d={group:Math.random(),
sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":"\x3e*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,
y:0}},e;for(e in d)e in b||(b[e]=d[e]);fa(b);for(var f in this)"_"===f.charAt(0)&&"function"==typeof this[f]&&(this[f]=this[f].bind(this));this.nativeDraggable=!b.forceFallback&&qa;c(a,"mousedown",this._onTapStart);c(a,"touchstart",this._onTapStart);c(a,"pointerdown",this._onTapStart);this.nativeDraggable&&(c(a,"dragover",this),c(a,"dragenter",this));ba.push(this._onDragOver);b.store&&this.sort(b.store.get(this))}function h(a,b){"clone"!==a.lastPullMode&&(b=!0);D&&D.state!==b&&(f(D,"display",b?"none":
""),b||D.state&&(a.options.group.revertClone?(x.insertBefore(D,K),a._animate(z,D)):x.insertBefore(D,z)),D.state=b)}function k(b,c,d){if(b){d=d||S;do if("\x3e*"===c&&b.parentNode===d||u(b,c))return b;while(b=a(b))}return null}function a(a){var b=a.host;return b&&b.nodeType?b:a.parentNode}function c(a,b,c){a.addEventListener(b,c,ha)}function d(a,b,c){a.removeEventListener(b,c,ha)}function e(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(ca," ").replace(" "+
b+" "," ");a.className=(d+(c?" "+b:"")).replace(ca," ")}}function f(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return S.defaultView&&S.defaultView.getComputedStyle?c=S.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b);d[b]=c+("string"==typeof c?"":"px")}}function g(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;if(c)for(;b<d;b++)c(a[b],b);return a}return[]}function l(a,b,c,d,e,f,g,k){a=a||b[T];var h=S.createEvent("Event"),
l=a.options,m="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0);h.to=e||b;h.from=f||b;h.item=d||b;h.clone=D;h.oldIndex=g;h.newIndex=k;b.dispatchEvent(h);l[m]&&l[m].call(a,h)}function m(a,b,c,d,e,f,g,k){var h,l,m=a[T],n=m.options.onMove;return h=S.createEvent("Event"),h.initEvent("move",!0,!0),h.to=b,h.from=a,h.dragged=c,h.draggedRect=d,h.related=e||b,h.relatedRect=f||b.getBoundingClientRect(),h.willInsertAfter=k,a.dispatchEvent(h),n&&(l=n.call(m,h,g)),l}function n(a){a.draggable=!1}
function q(){ia=!1}function t(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var b=a.length,c=0;b--;)c+=a.charCodeAt(b);return c.toString(36)}function p(a,b){var c=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"===a.nodeName.toUpperCase()||"\x3e*"!==b&&!u(a,b)||c++;return c}function u(a,b){if(a){b=b.split(".");var c=b.shift().toUpperCase(),d=new RegExp("\\s("+b.join("|")+")(?\x3d\\s)","g");return!(""!==c&&a.nodeName.toUpperCase()!=c||b.length&&((" "+a.className+
" ").match(d)||[]).length!=b.length)}return!1}function w(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c);c=void 0},b))}}function v(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function B(a){return ga&&ga.dom?ga.dom(a).cloneNode(!0):G?G(a).clone(!0)[0]:a.cloneNode(!0)}function A(a){a=a.getElementsByTagName("input");for(var b=a.length;b--;){var c=a[b];c.checked&&da.push(c)}}if("undefined"==typeof window||
!window.document)return function(){throw Error("Sortable.js requires a window with a document");};var z,y,E,D,x,K,J,H,Q,N,V,P,L,F,I,M,R,X,O,W,Y={},ca=/\s+/g,Z=/left|right|inline/,T="Sortable"+(new Date).getTime(),aa=window,S=aa.document,ea=aa.parseInt,G=aa.jQuery||aa.Zepto,ga=aa.Polymer,ha=!1,qa=!!("draggable"in S.createElement("div")),ja=function(a){return!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&(a=S.createElement("x"),a.style.cssText="pointer-events:auto","auto"===a.style.pointerEvents)}(),
ia=!1,U=Math.abs,oa=Math.min,da=[],ba=[],pa=w(function(a,b,c){if(c&&b.scroll){var d,e,f,g,k,h,l=c[T],m=b.scrollSensitivity,n=b.scrollSpeed,p=a.clientX,t=a.clientY,u=window.innerWidth,q=window.innerHeight;if(Q!==c&&(H=b.scroll,Q=c,N=b.scrollFn,!0===H)){H=c;do if(H.offsetWidth<H.scrollWidth||H.offsetHeight<H.scrollHeight)break;while(H=H.parentNode)}H&&(d=H,e=H.getBoundingClientRect(),f=(U(e.right-p)<=m)-(U(e.left-p)<=m),g=(U(e.bottom-t)<=m)-(U(e.top-t)<=m));f||g||(f=(u-p<=m)-(p<=m),g=(q-t<=m)-(t<=m),
(f||g)&&(d=aa));Y.vx===f&&Y.vy===g&&Y.el===d||(Y.el=d,Y.vx=f,Y.vy=g,clearInterval(Y.pid),d&&(Y.pid=setInterval(function(){return h=g?g*n:0,k=f?f*n:0,"function"==typeof N?N.call(l,k,h,a):void(d===aa?aa.scrollTo(aa.pageXOffset+k,aa.pageYOffset+h):(d.scrollTop+=h,d.scrollLeft+=k))},24)))}},30),fa=function(a){function b(a,b){return void 0!==a&&!0!==a||(a=c.name),"function"==typeof a?a:function(c,d){c=d.options.group.name;return b?a:a&&(a.join?-1<a.indexOf(c):c==a)}}var c={},d=a.group;d&&"object"==typeof d||
(d={name:d});c.name=d.name;c.checkPull=b(d.pull,!0);c.checkPut=b(d.put);c.revertClone=d.revertClone;a.group=c};b.prototype={constructor:b,_onTapStart:function(a){var b,c=this,d=this.el,e=this.options,f=e.preventOnFilter,g=a.type,h=a.touches&&a.touches[0],m=(h||a).target,n=a.target.shadowRoot&&a.path&&a.path[0]||m,t=e.filter;if(A(d),!(z||/mousedown|pointerdown/.test(g)&&0!==a.button||e.disabled||n.isContentEditable)&&(m=k(m,e.draggable,d),m&&J!==m)){if(b=p(m,e.draggable),"function"==typeof t){if(t.call(this,
a,m,this))return l(c,n,"filter",m,d,d,b),void(f&&a.preventDefault())}else if(t&&(t=t.split(",").some(function(a){if(a=k(n,a.trim(),d))return l(c,a,"filter",m,d,d,b),!0})))return void(f&&a.preventDefault());e.handle&&!k(n,e.handle,d)||this._prepareDragStart(a,h,m,b)}},_prepareDragStart:function(a,b,d,f){var k,h=this,m=h.el,p=h.options,t=m.ownerDocument;d&&!z&&d.parentNode===m&&(X=a,x=m,z=d,y=z.parentNode,K=z.nextSibling,J=d,M=p.group,F=f,this._lastX=(b||a).clientX,this._lastY=(b||a).clientY,z.style["will-change"]=
"all",k=function(){h._disableDelayedDrag();z.draggable=h.nativeDraggable;e(z,p.chosenClass,!0);h._triggerDragStart(a,b);l(h,x,"choose",z,x,x,F)},p.ignore.split(",").forEach(function(a){g(z,a.trim(),n)}),c(t,"mouseup",h._onDrop),c(t,"touchend",h._onDrop),c(t,"touchcancel",h._onDrop),c(t,"pointercancel",h._onDrop),c(t,"selectstart",h),p.delay?(c(t,"mouseup",h._disableDelayedDrag),c(t,"touchend",h._disableDelayedDrag),c(t,"touchcancel",h._disableDelayedDrag),c(t,"mousemove",h._disableDelayedDrag),c(t,
"touchmove",h._disableDelayedDrag),c(t,"pointermove",h._disableDelayedDrag),h._dragStartTimer=setTimeout(k,p.delay)):k())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer);d(a,"mouseup",this._disableDelayedDrag);d(a,"touchend",this._disableDelayedDrag);d(a,"touchcancel",this._disableDelayedDrag);d(a,"mousemove",this._disableDelayedDrag);d(a,"touchmove",this._disableDelayedDrag);d(a,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(a,b){(b=
b||("touch"==a.pointerType?a:null))?(X={target:z,clientX:b.clientX,clientY:b.clientY},this._onDragStart(X,"touch")):this.nativeDraggable?(c(z,"dragend",this),c(x,"dragstart",this._onDragStart)):this._onDragStart(X,!0);try{S.selection?setTimeout(function(){S.selection.empty()}):window.getSelection().removeAllRanges()}catch(ma){}},_dragStarted:function(){if(x&&z){var a=this.options;e(z,a.ghostClass,!0);e(z,a.dragClass,!1);b.active=this;l(this,x,"start",z,x,x,F)}else this._nulling()},_emulateDragOver:function(){if(O&&
(this._lastX!==O.clientX||this._lastY!==O.clientY)){this._lastX=O.clientX;this._lastY=O.clientY;ja||f(E,"display","none");var a=S.elementFromPoint(O.clientX,O.clientY),b=a,c=ba.length;if(b){do{if(b[T]){for(;c--;)ba[c]({clientX:O.clientX,clientY:O.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode)}ja||f(E,"display","")}},_onTouchMove:function(a){if(X){var c=this.options,d=c.fallbackTolerance,e=c.fallbackOffset,c=a.touches?a.touches[0]:a,g=c.clientX-X.clientX+e.x,e=c.clientY-X.clientY+e.y,
g=a.touches?"translate3d("+g+"px,"+e+"px,0)":"translate("+g+"px,"+e+"px)";if(!b.active){if(d&&oa(U(c.clientX-this._lastX),U(c.clientY-this._lastY))<d)return;this._dragStarted()}this._appendGhost();W=!0;O=c;f(E,"webkitTransform",g);f(E,"mozTransform",g);f(E,"msTransform",g);f(E,"transform",g);a.preventDefault()}},_appendGhost:function(){if(!E){var a,b=z.getBoundingClientRect();a=f(z);var c=this.options;E=z.cloneNode(!0);e(E,c.ghostClass,!1);e(E,c.fallbackClass,!0);e(E,c.dragClass,!0);f(E,"top",b.top-
ea(a.marginTop,10));f(E,"left",b.left-ea(a.marginLeft,10));f(E,"width",b.width);f(E,"height",b.height);f(E,"opacity","0.8");f(E,"position","fixed");f(E,"zIndex","100000");f(E,"pointerEvents","none");c.fallbackOnBody&&S.body.appendChild(E)||x.appendChild(E);a=E.getBoundingClientRect();f(E,"width",2*b.width-a.width);f(E,"height",2*b.height-a.height)}},_onDragStart:function(a,b){var d=a.dataTransfer,g=this.options;this._offUpEvents();M.checkPull(this,this,z,a)&&(D=B(z),D.draggable=!1,D.style["will-change"]=
"",f(D,"display","none"),e(D,this.options.chosenClass,!1),x.insertBefore(D,z),l(this,x,"clone",z));e(z,g.dragClass,!0);b?("touch"===b?(c(S,"touchmove",this._onTouchMove),c(S,"touchend",this._onDrop),c(S,"touchcancel",this._onDrop),c(S,"pointermove",this._onTouchMove),c(S,"pointerup",this._onDrop)):(c(S,"mousemove",this._onTouchMove),c(S,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(d&&(d.effectAllowed="move",g.setData&&g.setData.call(this,d,z)),c(S,"drop",this),setTimeout(this._dragStarted,
0))},_onDragOver:function(a){var c,d,e,g,l=this.el;c=this.options;d=c.group;var n=b.active,p=M===d,t=!1,u=c.sort;if((void 0!==a.preventDefault&&(a.preventDefault(),!c.dragoverBubble&&a.stopPropagation()),!z.animated&&(W=!0,n&&!c.disabled&&(p?u||(g=!x.contains(z)):R===this||(n.lastPullMode=M.checkPull(this,n,z,a))&&d.checkPut(this,n,z,a))&&(void 0===a.rootEl||a.rootEl===this.el)))&&(pa(a,c,this.el),!ia)){if(c=k(a.target,c.draggable,l),d=z.getBoundingClientRect(),R!==this&&(R=this,t=!0),g)return h(n,
!0),y=x,void(D||K?x.insertBefore(z,D||K):u||x.appendChild(z));!(g=0===l.children.length||l.children[0]===E)&&(g=l===a.target)&&(g=l.lastElementChild.getBoundingClientRect(),g=5<a.clientY-(g.top+g.height)||5<a.clientX-(g.left+g.width));if(g){if(0!==l.children.length&&l.children[0]!==E&&l===a.target&&(c=l.lastElementChild),c){if(c.animated)return;e=c.getBoundingClientRect()}h(n,p);!1!==m(x,l,z,d,c,e,a)&&(z.contains(l)||(l.appendChild(z),y=l),this._animate(d,z),c&&this._animate(e,c))}else if(c&&!c.animated&&
c!==z&&void 0!==c.parentNode[T]){V!==c&&(V=c,P=f(c),L=f(c.parentNode));e=c.getBoundingClientRect();var v=e.right-e.left;g=e.bottom-e.top;var w=Z.test(P.cssFloat+P.display)||"flex"==L.display&&0===L["flex-direction"].indexOf("row"),u=c.offsetWidth>z.offsetWidth,B=c.offsetHeight>z.offsetHeight,A=.5<(w?(a.clientX-e.left)/v:(a.clientY-e.top)/g),v=c.nextElementSibling,U=!1;w?(t=z.offsetTop,w=c.offsetTop,U=t===w?c.previousElementSibling===z&&!u||A&&u:c.previousElementSibling===z||z.previousElementSibling===
c?.5<(a.clientY-e.top)/g:w>t):t||(U=v!==z&&!B||A&&B);a=m(x,l,z,d,c,e,a,U);!1!==a&&(1!==a&&-1!==a||(U=1===a),ia=!0,setTimeout(q,30),h(n,p),z.contains(l)||(U&&!v?l.appendChild(z):c.parentNode.insertBefore(z,U?v:c)),y=z.parentNode,this._animate(d,z),this._animate(e,c))}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();1===a.nodeType&&(a=a.getBoundingClientRect());f(b,"transition","none");f(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)");
b.offsetWidth;f(b,"transition","all "+c+"ms");f(b,"transform","translate3d(0,0,0)");clearTimeout(b.animated);b.animated=setTimeout(function(){f(b,"transition","");f(b,"transform","");b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;d(S,"touchmove",this._onTouchMove);d(S,"pointermove",this._onTouchMove);d(a,"mouseup",this._onDrop);d(a,"touchend",this._onDrop);d(a,"pointerup",this._onDrop);d(a,"touchcancel",this._onDrop);d(a,"pointercancel",this._onDrop);d(a,"selectstart",this)},
_onDrop:function(a){var c=this.el,f=this.options;clearInterval(this._loopId);clearInterval(Y.pid);clearTimeout(this._dragStartTimer);d(S,"mousemove",this._onTouchMove);this.nativeDraggable&&(d(S,"drop",this),d(c,"dragstart",this._onDragStart));this._offUpEvents();a&&(W&&(a.preventDefault(),!f.dropBubble&&a.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),x!==y&&"clone"===b.active.lastPullMode||D&&D.parentNode&&D.parentNode.removeChild(D),z&&(this.nativeDraggable&&d(z,"dragend",this),
n(z),z.style["will-change"]="",e(z,this.options.ghostClass,!1),e(z,this.options.chosenClass,!1),l(this,x,"unchoose",z,y,x,F),x!==y?(I=p(z,f.draggable),0<=I&&(l(null,y,"add",z,y,x,F,I),l(this,x,"remove",z,y,x,F,I),l(null,y,"sort",z,y,x,F,I),l(this,x,"sort",z,y,x,F,I))):z.nextSibling!==K&&(I=p(z,f.draggable),0<=I&&(l(this,x,"update",z,y,x,F,I),l(this,x,"sort",z,y,x,F,I))),b.active&&(null!=I&&-1!==I||(I=F),l(this,x,"end",z,y,x,F,I),this.save())));this._nulling()},_nulling:function(){x=z=y=E=K=D=J=H=
Q=X=O=W=I=V=P=R=M=b.active=null;da.forEach(function(a){a.checked=!0});da.length=0},handleEvent:function(a){switch(a.type){case "drop":case "dragend":this._onDrop(a);break;case "dragover":case "dragenter":z&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault());break;case "selectstart":a.preventDefault()}},toArray:function(){for(var a,b=[],c=this.el.children,d=0,e=c.length,f=this.options;d<e;d++)a=c[d],k(a,f.draggable,this.el)&&b.push(a.getAttribute(f.dataIdAttr)||
t(a));return b},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,d){d=c.children[d];k(d,this.options.draggable,c)&&(b[a]=d)},this);a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return k(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:(c[a]=b,void("group"===a&&fa(c)))},destroy:function(){var a=this.el;a[T]=null;d(a,"mousedown",
this._onTapStart);d(a,"touchstart",this._onTapStart);d(a,"pointerdown",this._onTapStart);this.nativeDraggable&&(d(a,"dragover",this),d(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});ba.splice(ba.indexOf(this._onDragOver),1);this._onDrop();this.el=a=null}};c(S,"touchmove",function(a){b.active&&a.preventDefault()});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){ha={capture:!1,
passive:!1}}}))}catch(ka){}return b.utils={on:c,off:d,css:f,find:g,is:function(a,b){return!!k(a,b,a)},extend:v,throttle:w,closest:k,toggleClass:e,clone:B,index:p},b.create=function(a,c){return new b(a,c)},b.version="1.6.1",b}()}}})},"arcgisonline/pages/utils/notebook":function(){define("require exports tslib ../../esriGeowConfig esri/lang ../../sharing/util dojo/Deferred".split(" "),function(b,h,k,a,c,d,e){a=k.__importDefault(a);c=k.__importDefault(c);d=k.__importDefault(d);e=k.__importDefault(e);
return function(){function b(){}b.notebookServerConfigured=function(){var c=new e.default;a.default.notebookServerEnabled?b.getNotebookServer().then(function(a){null!==a?c.resolve(!0):c.resolve(!1)},function(a){c.resolve(!1)}):c.resolve(!1);return c};b.getNotebookServer=function(){var d=new e.default;(a.default.portal||a.default.self).isPortal?b.getFederatedServers().then(function(a){c.default.isDefined(a)&&c.default.isDefined(a.servers)&&c.default.isDefined(a.servers.length)?(a=a.servers.filter(function(a){return"ARCGIS_NOTEBOOK_SERVER"===
a.serverType&&"NotebookServer"===a.serverFunction}),a.length?(a=a[0],a.adminContext="/admin",d.resolve(a)):d.resolve(null)):d.resolve(null)},function(a){d.resolve(null)}):a.default.notebookServerUrl?d.resolve({url:a.default.notebookServerUrl,adminContext:""}):d.resolve(null);return d};b.getFederatedServers=function(){return d.default.request({url:a.default.restBaseUrl+"portals/self/servers/"})};return b}()})},"calcite-web/js/calcite-web":function(){(function(b,h){"object"===typeof exports&&"undefined"!==
typeof module?module.exports=h():"function"===typeof define&&define.amd?define(h):b.calcite=h()})(this,function(){function b(a,b){return(new RegExp("(\\s|^)"+b+"(\\s|$)")).test(a.getAttribute("class"))}function h(a,c){c.split(" ").forEach(function(c){if(!b(a,c)){var d=a.getAttribute("class")||"";a.setAttribute("class",d+" "+c)}})}function k(a,c){c.split(" ").forEach(function(c){var d=a.getAttribute("class").replace(new RegExp("(\\s|^)"+c+"(\\s|$)","g"),"$2");b(a,c)&&a.setAttribute("class",d)})}function a(a,
c){b(a,c)?k(a,c):h(a,c)}function c(a){a=f(a);a.forEach(function(a){k(a,"is-active")})}function d(a,b){c(a);h(b,"is-active")}function e(a,c){for(;c&&(1!==c.nodeType||!b(c,a));c=c.parentNode);return c}function f(a){return Array.isArray(a)?a:Array.prototype.slice.call(a)}function g(a,b){a=(b||document).querySelectorAll(a);return f(a)}function l(a,b){return b.filter(function(b){var c=a.toLowerCase();return-1!==b.innerHTML.toLowerCase().indexOf(c)})}function m(a){a.forEach(function(a){a&&a.setAttribute("aria-hidden",
!0)})}function n(a){a.forEach(function(a){a&&a.removeAttribute("aria-hidden")})}function q(a){a&&(a.getAttribute("aria-expanded")?a.removeAttribute("aria-expanded"):a.setAttribute("aria-expanded","true"))}function t(){return"click"}function p(a,b,c){if(a.addEventListener)return a.addEventListener(b,c,!1);if(a.attachEvent)return a.attachEvent("on"+b,c)}function u(a,b,c){if(a.removeEventListener)return a.removeEventListener(b,c,!1);if(a.detachEvent)return a.detachEvent("on"+b,c)}function w(a){return a.target||
a.srcElement}function v(a){if(a.preventDefault)return a.preventDefault();a.returnValue&&(a.returnValue=!1)}function B(a){a=a||window.event;if(a.stopPropagation)return a.stopPropagation();a.cancelBubble&&(a.cancelBubble=!0)}function A(a,b,c){var d,e,f,g;g=function(){d=!1;e&&(f.apply(c,e),e=!1)};return f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}}function z(){}function y(a){B(a);a=e("accordion-section",w(a));G.emit("accordion:toggle",{node:a})}function E(b){a(b.node,"is-active");
q(b.node)}function D(a){13===a.keyCode&&b(w(a),"accordion-title")&&y(a)}function x(a){var b=g(".js-accordion");a?K(a.node):b.forEach(function(a){K(a)})}function K(a){a.setAttribute("aria-live","polite");a.setAttribute("role","tablist");f(a.children).forEach(function(a){var c=a.querySelector(".accordion-title");c.setAttribute("role","tab");c.setAttribute("tabindex","0");b(a,"is-active")&&a.setAttribute("aria-expanded","true");var d=!1;ea.accordions.forEach(function(a){a.target===c&&a.event===t()&&
a.fn===y&&(d=!0)});d||(ea.accordions.push({target:c,event:t(),fn:y}),ea.accordions.push({target:a,event:"keyup",fn:D}),p(c,t(),y),p(a,"keyup",D))})}function J(){ga||(G.on("accordion:bind",x),G.on("accordion:toggle",E),ga=!0);G.emit("accordion:bind")}function H(a){u(document.body,t(),H);g(".js-dropdown").forEach(function(a){k(a,"is-active")});g(".js-dropdown-toggle").forEach(function(a){a.setAttribute("aria-expanded","false")});u(document,"keydown",N)}function Q(a){if(a){var c=b(a.node,"is-active");
G.emit("dropdown:close");c||(h(a.node,"is-active"),a.target&&a.target.setAttribute("aria-expanded","true"),p(document,"keydown",N));b(a.node,"is-active")&&p(document.body,t(),H)}}function N(a){40===a.keyCode|38===a.keyCode&&a.preventDefault()}function V(a){g(".js-dropdown-toggle").forEach(function(a){var b=!1;ea.dropdowns.forEach(function(c){c.target===a&&c.event===t()&&c.fn===M&&(b=!0)});b||(ea.dropdowns.push({target:a,event:t(),fn:M}),p(a,t(),M))})}function P(){var a=document.querySelector(".js-dropdown.is-active");
return a?a:!1}function L(a){var b=a.links.indexOf(document.activeElement);-1===b?b=a.forward?0:a.links.length-1:a.forward?(b+=1,b===a.links.length&&(b=0)):(--b,-1===b&&(b=a.links.length-1));a.links[b].focus()}function F(){var a=P();a&&(a=g(".dropdown-link",a),G.emit("dropdown:focus",{links:a,forward:!0}))}function I(){var a=P();a&&(a=g(".dropdown-link",a),G.emit("dropdown:focus",{links:a,forward:!1}))}function M(a){v(a);B(a);var b=e("js-dropdown",a.target);G.emit("dropdown:toggle",{node:b,target:a.target})}
function R(){ha||(G.on("dropdown:toggle",Q),G.on("dropdown:close",H),G.on("keyboard:escape",H),G.on("keyboard:arrow:down",F),G.on("keyboard:arrow:up",I),G.on("dropdown:focus",L),ha=!0);V()}function X(){function a(a){a?(a=document.querySelector('.js-drawer[data-drawer\x3d"'+a.id+'"]'),a.removeAttribute("tabindex"),k(a,"is-active")):y.forEach(function(a){a.removeAttribute("tabindex");k(a,"is-active")});k(l,"drawer-left-is-active");k(l,"drawer-right-is-active");n([l,q]);u(document,"focusin",c);B&&B.focus()}
function c(a){e("js-drawer",a.target)||y.forEach(function(a){b(a,"is-active")&&a.focus()})}function d(a){b(a.target,"js-drawer")&&G.emit("drawer:close")}function f(a){v(a);a=a.target.getAttribute("data-drawer");G.emit("drawer:open",{id:a})}var l=document.querySelector(".wrapper"),q=document.querySelector(".footer"),w=g(".js-drawer-toggle"),y=g(".js-drawer"),B;G.on("drawer:open",function(a){G.emit("drawer:close");a=document.querySelector('.js-drawer[data-drawer\x3d"'+a.id+'"]');var e=b(a,"drawer-right"),
f=b(a,"drawer-left");a.setAttribute("tabindex",0);h(a,"is-active");e?h(l,"drawer-right-is-active"):f&&h(l,"drawer-left-is-active");m([l,q]);p(a,t(),d);p(document,"focusin",c)});G.on("keyboard:escape",a);G.on("drawer:close",a);G.on("drawer:bind",function(a){a?p(a.node,t(),f):w.forEach(function(a){p(a,t(),f)})});G.emit("drawer:bind")}function O(){function d(a){var b=e("js-filter-dropdown",a.target);return{parent:b,id:b.getAttribute("data-filter-dropdown"),item:a.target}}function m(a){B(a);a=d(a);G.emit("filterDropdown:input:focus",
a)}function n(a){v(a);B(a);a=d(a);G.emit("filterDropdown:select",a)}function u(b){b.preventDefault();var c=d(b);a(b.target,"is-active");G.emit("filterDropdown:toggle",c)}function q(a){a=document.querySelectorAll(".filter-dropdown-list");c(a);a=g(".js-filter-dropdown-open");var b=g(".js-filter-dropdown-close");a.forEach(function(a){return h(a,"is-active")});b.forEach(function(a){return k(a,"is-active")})}function w(a){a.preventDefault();var b=d(a);b.i=a.target.getAttribute("data-item-id");G.emit("filterDropdown:select:remove",
b)}G.on("filterDropdown:bind",function(){g(".js-filter-dropdown").forEach(function(a){var b=a.getAttribute("data-filter-dropdown"),c=a.querySelector(".filter-dropdown-input");p(c,"focus",m);for(var d=a.querySelectorAll(".js-filter-dropdown-open"),e=0;e<d.length;e++){var g=d[e];g.setAttribute("data-id",b);p(g,t(),u)}d=a.querySelectorAll(".js-filter-dropdown-close");for(e=0;e<d.length;e++)g=d[e],g.setAttribute("data-id",b),p(g,t(),u);var q=a.querySelectorAll(".filter-dropdown-link");for(a=0;a<q.length;a++)b=
q[a],b.setAttribute("data-item-id",a),p(b,t(),n);p(c,"keyup",function(a){a=f(q);a.forEach(function(a){h(a,"hide")});l(c.value,a).forEach(function(a){k(a,"hide")})})})});G.on("filterDropdown:select",function(b){a(b.item,"is-active")});G.on("filterDropdown:select",function(a){var b=a.parent.querySelectorAll(".filter-dropdown-link.is-active");G.emit("filterDropdown:active",{parent:a.parent,id:a.id,active:b})});G.on("filterDropdown:select:remove",function(a){var b=a.parent.querySelectorAll(".filter-dropdown-link.is-active")[a.i];
k(b,"is-active");b=a.parent.querySelectorAll(".filter-dropdown-link.is-active");G.emit("filterDropdown:active",{parent:a.parent,id:a.id,active:b})});G.on("filterDropdown:active",function(a){G.emit("filterDropdown:active:clear",a);var b=a.parent.querySelector(".js-flilter-dropdown-no-filters");0<a.active.length?h(b,"hide"):k(b,"hide");for(b=0;b<a.active.length;b++){a.parent.insertAdjacentHTML("beforeend",'\x3cspan class\x3d"filter-dropdown-active"\x3e\n        '+a.active[b].innerHTML+'\n        \x3ca class\x3d"filter-dropdown-remove" href\x3d"#" data-item-id\x3d\''+
b+'\'\x3e\n          \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"14" height\x3d"14" viewBox\x3d"0 0 32 32" class\x3d"svg-icon"\x3e\x3cpath d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\x3c/svg\x3e\n        \x3c/a\x3e\n      \x3c/span\x3e');var c=a.parent.querySelector('.filter-dropdown-remove[data-item-id\x3d"'+b+'"]');p(c,t(),w)}});G.on("filterDropdown:active:clear",function(a){for(var b=a.parent.querySelectorAll(".filter-dropdown-active"),
c=0;c<b.length;c++)a.parent.removeChild(b[c])});G.on("filterDropdown:toggle",function(a){var c=a.parent.querySelector(".filter-dropdown-list");b(c,"is-active")?G.emit("filterDropdown:close",a):G.emit("filterDropdown:open",a)});G.on("filterDropdown:open",function(a){q();var b=a.parent.querySelector(".filter-dropdown-list");h(b,"is-active");b=g(".js-filter-dropdown-close",a.parent);g(".js-filter-dropdown-open",a.parent).forEach(function(a){return k(a,"is-active")});b.forEach(function(a){return h(a,
"is-active")})});G.on("filterDropdown:close",q);G.on("keyboard:escape",q);G.emit("filterDropdown:bind")}function W(){function a(){var a=[];w&&a.push(w);y&&a.push(y);return a}function d(d){b(q,"drawer-no-overflow")&&k(q,"drawer-no-overflow");if(!d)return c(A);d=document.querySelector('.js-modal[data-modal\x3d"'+d+'"]');k(d,"is-active");d.setAttribute("tabindex",0);u(document,"focusin",f);n(a())}function f(a){e("js-modal",a.target)||A.forEach(function(a){b(a,"is-active")&&a.focus()})}function l(a){v(a);
G.emit("modal:open",a.target.dataset.modal)}var q=document.documentElement,w=document.querySelector(".wrapper"),y=document.querySelector(".footer"),B=g(".js-modal-toggle"),A=g(".js-modal");G.on("modal:open",function(b){G.emit("modal:close");b&&(b=document.querySelector('.js-modal[data-modal\x3d"'+b+'"]'),b.removeAttribute("tabindex"),p(document,"focusin",f),h(b,"is-active"),h(q,"drawer-no-overflow"),m(a()),b.focus())});G.on("keyboard:escape",d);G.on("modal:close",d);G.on("modal:bind",function(a){a?
p(a,t(),l):B.forEach(function(a){p(a,t(),l)})});G.emit("modal:bind")}function Y(){function c(b){var c=b.querySelector(".js-search-icon");b=b.querySelector(".js-close-icon");a(c,"hide");a(b,"hide");a(h,"is-active");a(document.body,"overflow-hidden");G.emit("search:focus")}function d(a){v(a);G.emit("search:toggle",a.target)}var e=g(".js-search-toggle"),h=g(".js-search")[0];G.on("search:bind",function(a){a?p(a,t(),d):e.forEach(function(a){p(a,t(),d)})});G.on("search:toggle",c);G.on("keyboard:escape",
function(){if(b(h,"is-active")){k(h,"is-active");k(document.body,"overflow-hidden");f(e).forEach(c);var a=document.querySelector(".js-search-input");a&&a.blur()}});G.on("search:focus",function(){document.querySelector(".js-search-input").focus()});G.emit("search:bind")}function ca(){function a(a){window.location.assign(a.currentTarget.value)}G.on("selectnav:bind",function(){b.forEach(function(b){p(b,"change",a)})});var b=g(".js-select-nav");G.emit("selectnav:bind")}function Z(a){for(var b="",c=0;c<
a;c++)b+=(65536*(1+Math.random())|0).toString(16).substring(1);return b}function T(a){if(!a)throw new TypeError("Invalid argument `value` has no value.");this.value=T.EMPTY;a&&a instanceof T?this.value=a.toString():a&&"[object String]"===Object.prototype.toString.call(a)&&T.isGuid(a)&&(this.value=a);this.equals=function(a){return T.isGuid(a)&&this.value===a};this.isEmpty=function(){return this.value===T.EMPTY};this.toString=function(){return this.value};this.toJSON=function(){return this.value}}function aa(){G.on("scrolling:at",
function(c){a.forEach(function(a){var d=a.element;b(a.element,"is-sticky")&&(d=a.element.getAttribute("data-sticky-id"),d=document.querySelector('.js-shim[data-sticky-id\x3d"'+d+'"]'));if(d){var e=d.getAttribute("data-top")||0;a.top=d.offsetTop-parseInt(e,0)}a.top<c?G.emit("sticky:stick",a):G.emit("sticky:unstick",a)})});G.on("sticky:stick",function(a){var b=a.element.getAttribute("data-sticky-id"),c=document.querySelector('.js-shim[data-sticky-id\x3d"'+b+'"]');b&&c&&(h(a.element,"is-sticky"),c.style.display=
"")});G.on("sticky:unstick",function(a){var b=a.element.getAttribute("data-sticky-id"),c=document.querySelector('.js-shim[data-sticky-id\x3d"'+b+'"]');b&&c&&(k(a.element,"is-sticky"),c.style.display="none")});var a=g(".js-sticky").map(function(a){var b=a.offsetTop,c=a.getAttribute("data-top")||0;a.style.top=c+"px";if(!a.getAttribute("data-sticky-id")){var d=T.raw();a.setAttribute("data-sticky-id",d);var e=a.parentNode,f=a.cloneNode("deep");h(f,"js-shim");k(f,"js-sticky");f.setAttribute("data-sticky-id",
d);f.style.visibility="hidden";f.style.display="none";e.insertBefore(f,a)}return{top:b-parseInt(c,0),element:a}})}function S(){function a(a){var b=a.getAttribute("data-tab");if(b)return b;b=T.raw();a.setAttribute("data-tab",b);return b}function c(b){b=b.target;var c=e("js-tab-group",b),d=a(c);return{parent:c,id:d,active:b}}function k(a){a.preventDefault();a=c(a);G.emit("tabs:active",a)}function h(a){var b=c(a);13===a.keycode&&G.emit("tabs:active",b)}G.on("tabs:bind",function(){var c=g(".js-tab"),
d=g(".js-tab-group"),e=g(".js-tab-section");d.forEach(function(b){b.setAttribute("aria-live","polite");a(b);b.children[0].setAttribute("role","tablist");b=b.querySelectorAll(".js-tab");for(var c=100/b.length,d=0;d<b.length;d++)b[d].style.maxWidth=c+"%"});c.forEach(function(a){a.setAttribute("aria-expanded","false");a.setAttribute("role","tab");a.setAttribute("tabindex","0");p(a,t(),k);p(a,"keyup",h)});e.forEach(function(a){a.setAttribute("role","tabpanel");b(a,"is-active")?a.setAttribute("aria-expanded",
!0):a.setAttribute("aria-expanded",!1)})});G.on("tabs:active",function(a){var b=a.parent,c=f(b.querySelectorAll(".js-tab"));a=a.active;var b=f(b.querySelectorAll(".js-tab-section")),e=c.indexOf(a),e=b[e];c.forEach(function(a){a.setAttribute("aria-expanded",!1)});a.setAttribute("aria-expanded",!0);d(c,a);b.forEach(function(a){a.setAttribute("aria-expanded",!1)});e.setAttribute("aria-expanded",!0);d(b,e)});G.emit("tabs:bind")}var ea={dropdowns:[],accordions:[]};z.prototype={on:function(a,b,c){var d=
this.e||(this.e={});(d[a]||(d[a]=[])).push({fn:b,ctx:c});return this},once:function(a,b,c){function d(){e.off(a,d);b.apply(c,arguments)}var e=this;d._=b;return this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);e.length?c[a]=e:delete c[a];return this}};
var G=new z,ga=!1,ha=!1,qa=/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/i;T.EMPTY="00000000-0000-0000-0000-000000000000";T.isGuid=function(a){return a&&(a instanceof T||qa.test(a.toString()))};T.create=function(){return new T([Z(2),Z(1),Z(1),Z(1),Z(3)].join("-"))};T.raw=function(){return[Z(2),Z(1),Z(1),Z(1),Z(3)].join("-")};p(document,"keyup",function(a){27===a.keyCode?G.emit("keyboard:escape"):13===a.keyCode?G.emit("keyboard:return"):32===a.keyCode?G.emit("keyboard:space"):38===
a.keyCode?G.emit("keyboard:arrow:up"):40===a.keyCode?G.emit("keyboard:arrow:down"):37===a.keyCode?G.emit("keyboard:arrow:left"):39===a.keyCode&&G.emit("keyboard:arrow:right")});p(window,"scroll",A(function(){G.emit("scrolling:at",window.pageYOffset)},100));var ja=[J,function(){function a(a){a.preventDefault();a=a.target.getAttribute("data-clipboard-target");document.querySelector(a).select();document.execCommand("copy")}var b=g(".js-copy-to-clipboard");G.on("clipboard:bind",function(c){c?p(c.node,
"click",a):b.forEach(function(b){p(b,"click",a)})});G.emit("clipboard:bind")},R,X,O,W,Y,ca,aa,S];return{version:"1.0.0",click:t,addEvent:p,removeEvent:u,eventTarget:w,preventDefault:v,stopPropagation:B,throttle:A,hasClass:b,addClass:h,removeClass:k,toggleClass:a,removeActive:c,addActive:function(a){a=f(a);a.forEach(function(a){h(a,"is-active")})},toggleActive:d,toggleAriaHidden:function(a){a.forEach(function(a){a&&("true"!==a.getAttribute("aria-hidden")?a.setAttribute("aria-hidden",!0):a.removeAttribute("aria-hidden"))})},
toggleAriaExpanded:q,closest:e,nodeListToArray:f,findElements:g,bus:G,accordion:J,dropdown:R,drawer:X,filterDropdown:O,modal:W,search:Y,selectNav:ca,sticky:aa,tabs:S,extend:function(a){"function"!==typeof Object.assign&&(Object.assign=function(a){var b=arguments;if(null==a)throw new TypeError("Cannot convert undefined or null to object");a=Object(a);for(var c=1;c<arguments.length;c++){var d=b[c];if(null!=d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a});for(var b in a)ja.push(a[b]);
Object.assign(this,a)},init:function(){ja.forEach(function(a){a()})}}})},"arcgisonline/sharing/dijit/SiteFooter":function(){define("require exports tslib ../../esriGeowConfig ../util ../geow/Account ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/dom dojo/dom-construct dojo/i18n!../../nls/arcgisonline dojo/string dojo/text!./templates/SiteFooter.html dojo/_base/lang esri/lang".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u){a=k.__importDefault(a);c=k.__importDefault(c);
d=k.__importDefault(d);e=k.__importDefault(e);f=k.__importDefault(f);g=k.__importDefault(g);l=k.__importDefault(l);m=k.__importDefault(m);n=k.__importDefault(n);q=k.__importDefault(q);t=k.__importDefault(t);p=k.__importDefault(p);u=k.__importDefault(u);return function(){function b(){this.templateString=t.default;this.isTroubleshootPage=this.isSignInPage=!1}b.prototype.postMixInProperties=function(){this.i18n=p.default.mixin({},n.default.common);p.default.mixin(this.i18n,n.default.siteFooter);p.default.mixin(this.i18n,
n.default.supportPage.helpLabel)};b.prototype.postCreate=function(){var b=window.location.pathname.toLowerCase();this.isSignInPage=-1!==b.indexOf(a.default.signin);this.isTroubleshootPage=-1!==b.indexOf("troubleshoot.html")};b.prototype.startup=function(){this._loadLinks()};b.prototype.refresh=function(){m.default.destroy(this.id+"_links");m.default.create("span",{id:this.id+"_links",className:"esriItemLinks"},this.domNode);this._loadLinks()};b.prototype._getTitle=function(a){return a&&-1<a.indexOf("${")&&
-1<a.indexOf("}")?q.default.substitute(a,{i18n:this.i18n}):a};b.prototype._loadLinks=function(){var b=this;d.default.getSelf(function(d){var e=c.default.getUser(),f=l.default.byId(b.id+"_links"),g=window.location.href,k=!1,h=null;-1<g.indexOf("?useExisting\x3d1")&&(g=g.substring(0,g.length-14));-1<g.indexOf("viewer.html")&&-1===g.indexOf("returnUrl")&&(k=!0);(a.default.footerLinks||[]).forEach(function(l){var n=!(!l||"ArcGIS Marketplace"!==l.title||e);h&&!n&&m.default.place(h,f,"last");var p=b._getTitle(l.title);
l.url?(-1===l.url.indexOf("http")&&k&&(l.url="support.html"===l.url?d.helpBase||a.default.baseUrl+l.url:a.default.baseUrl+l.url),"${i18n.help}"!==l.title&&"support.html"!==l.url||!b.isSignInPage&&!b.isTroubleshootPage||e||d.id||!d.urlKey||!d.access||"private"!==d.access||d.isPortal?"support.html"!==l.url||d.isPortal||(l.url=d.helpBase):l.url=d.helpBase,"ArcGIS Marketplace"===l.title&&(l.url=c.default.getSecureUrl(a.default.marketplaceUrl)),p=m.default.create("a",{href:l.url,target:"_blank",innerHTML:p}),
n||m.default.place(p,f,"last")):"contactUs"===l.type?(n="mailto:"+l.email,n+="?subject\x3d"+q.default.substitute("A comment about ${appTitle}",{appTitle:a.default.portalName||"ArcGIS.com"}),n+="\x26body\x3d"+q.default.substitute("I have the following comment about the ${appTitle} Web site. %0AReferring page: ${referringPage} %0A %0A(Please provide as much detail as possible. Note: Contact Us is not meant for obtaining technical support or general product information.)",{appTitle:a.default.portalName||
"ArcGIS.com",referringPage:escape(g)}),p=m.default.create("a",{id:b.id+"_contactEsri",href:n,innerHTML:p}),m.default.place(p,f,"last")):"reportAbuse"===l.type&&(n="mailto:"+l.email+"?subject\x3dConcerns about an item",n+="\x26body\x3d"+q.default.substitute("I have concerns about the following. %0AReferring page: ${referringPage} %0A %0A(Please describe your concerns. If you have concerns about a particular item, it's best to click the 'Report Abuse' link while viewing the item description. Doing so will include the URL to the specific item in this e-mail.)",
{referringPage:escape(g)}),p=m.default.create("a",{href:n,innerHTML:p}),m.default.place(p,f,"last"));h=k?m.default.create("span",{innerHTML:"\x26nbsp;. "}):m.default.create("span",{innerHTML:"\x26nbsp;\x26nbsp;|\x26nbsp;\x26nbsp;"})});if(u.default.isDefined(d.portalProperties)&&u.default.isDefined(d.portalProperties.links)&&u.default.isDefined(d.portalProperties.links.contactUs)&&d.portalProperties.links.contactUs.visible&&!l.default.byId(b.id+"_customContactUs")){var n=m.default.create("a",{href:d.portalProperties.links.contactUs.url,
innerHTML:b.i18n.customContactUs,id:b.id+"_customContactUs"}),p=l.default.byId(b.id+"_contactEsri");u.default.isDefined(p)?(m.default.place(n,p,"after"),m.default.place(h,p,"after")):(0<a.default.footerLinks.length&&m.default.place(h,f,"last"),m.default.place(n,f,"last"))}})};return b=k.__decorate([e.default(g.default,f.default)],b)}()})},"arcgisonline/sharing/dijit/SiteFooterMap":function(){define("require exports tslib ./SiteFooter ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/text!./templates/SiteFooterMap.html".split(" "),
function(b,h,k,a,c,d,e,f){a=k.__importDefault(a);c=k.__importDefault(c);d=k.__importDefault(d);e=k.__importDefault(e);f=k.__importDefault(f);return function(){function b(){this.templateString=f.default}return b=k.__decorate([c.default(e.default,d.default,a.default)],b)}()})},"arcgisonline/sharing/dijit/SignIn":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Form,dijit/form/Button,dijit/form/ValidationTextBox,dojo/DeferredList,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/Role,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.SignIn");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Form");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("dojo.DeferredList");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.Role");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
b.require("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");b.requireLocalization("arcgisonline","arcgisonline");b.declare("arcgisonline.sharing.dijit.SignIn",[h._Widget,h._Templated],{_util:arcgisonline.sharing.util,_geow:arcgisonline.sharing.geow.Geow,_account:arcgisonline.sharing.geow.Account,redirectUrl:esriGeowConfig.baseUrl+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl+"organization.html",setupRedirectUrl:esriGeowConfig.baseUrl+"setup.html",widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" role\x3d"main"\x3e\r\n  \x3cdiv id\x3d"login-form" class\x3d"esriFloatLeading respond" style\x3d"display:block; clear:both; width: 100%;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"sign-in-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cdiv id\x3d"organizationTitle" style\x3d"display:none; margin:10px 0 40px 0; text-align:center;"\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"left" style\x3d"display:none;" class\x3d"grid_7 alpha first esriFloatLeading"\x3e\r\n        \x3ch1 id\x3d"leftPanelTitle"\x3e${i18n.firstTimeSign}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n\r\n        \x3cdiv id\x3d"not_a_member_msg"\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr/\x3e\r\n        \x3cbr/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"leftAgo" style\x3d"display:none;font-size:14px;" class\x3d"grid_7 alpha first esriFloatLeading"\x3e\r\n        \x3ch1 style\x3d"font-size:24px;"\x3e${i18n.agsNoAccount}\x3c/h1\x3e\r\n        \x3c!--\x3cdiv id\x3d"trial" style\x3d"display:none;"\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d\'margin:20px 0 5px 0\'\x3e${i18n.agsTrial}\x3c/div\x3e--\x3e\r\n          \x3c!--\x26lt;!\x26ndash;\x3cp\x3e${i18n.agsSubscriptionInfo}\x3c/p\x3e\x26ndash;\x26gt;--\x3e\r\n          \x3c!--\x3cbutton dojoAttachPoint\x3d"_trialUrl" style\x3d"margin:10px 0 10px 0;" class\x3d"calcite blue" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e--\x3e\r\n            \x3c!--${i18n.ags30DayTrial}--\x3e\r\n          \x3c!--\x3c/button\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d\'font-weight:bold;margin:20px 0 5px 0;padding-top:35px;border-top:1px solid #e5e5e5;\'\x3e${i18n.agsNoTrial}\x3c/div\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3c!--\x3cdiv\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d"margin:10px 0 10px 0;"\x3e${i18n.agsCreatePersonalMsg}\x3c/div\x3e--\x3e\r\n          \x3c!--\x3cdiv style\x3d\'margin:15px 0 5px 0\'\x3e${i18n.agsHavePersonal}\x3c/div\x3e--\x3e\r\n          \x3c!--\x3cbutton dojoAttachPoint\x3d"_agoRegister" style\x3d"margin:10px 0 10px 0;" type\x3d"button" class\x3d"calcite light" dojotype\x3d"dijit.form.Button"\x3e--\x3e\r\n            \x3c!--${i18n.agsRegisterPersonalBtn}--\x3e\r\n          \x3c!--\x3c/button\x3e--\x3e\r\n        \x3c!--\x3c/div\x3e--\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv style\x3d\'margin:15px 0 15px 0\'\x3e${i18n.createPublicAccountMsg}\x3c/div\x3e\r\n          \x3cbutton dojoAttachPoint\x3d"_agoCreate" id\x3d"esriCreateAccountBtn" class\x3d"calcite createAccount transparent" style\x3d"margin:10px 0 10px 0;" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e\r\n            ${i18n.agsCreatePersonalBtn}\r\n          \x3c/button\x3e\r\n          \x3cp style\x3d"font-size:11px;color:#767676;"\x3e${!i18n.publicAccountMsg}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"rightAgo" class\x3d"grid_7 omega last esriFloatTrailing"\x3e\r\n        \x3c!--\x3ch1 id\x3d"rightPanelTitle"\x3e${i18n.SignIn}\x3c/h1\x3e--\x3e\r\n        \x3cp id\x3d\'rightPanelSubTitle\'\x3e\x3c/p\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"sign-in-error"\x3e\r\n        \x3c/div\x3e\r\n        \x3ciframe name\x3d"sign_in" dojoattachpoint\x3d"_iFrame" id\x3d"oAuthFrame" scrolling\x3d"no" style\x3d"display:none; border:0" marginheight\x3d"0" marginwidth\x3d"0" frameborder\x3d"0" width\x3d"450" height\x3d"500"\x3e\r\n           Your browser does not support iframes.\r\n        \x3c/iframe\x3e\r\n        \x3ctable id\x3d"authTable" style\x3d"width:100%;display:none"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_username" style\x3d"padding:0;margin:0;"\x3e${i18n.userLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_username" name\x3d"user_username" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_password" style\x3d"padding:0;margin:0;"\x3e${i18n.passwordLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_password" name\x3d"user_password" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox"trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"signInHelp"\x3e\r\n                  \x3ca id\x3d"signInHelpLink"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                \x3c/div\x3e\r\n                \x3cinput id\x3d"remember-me" style\x3d"height:24px;margin:auto;" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                \x3clabel id\x3d"remember-me-label" for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                \x3cdiv id\x3d"invitationReminder" style\x3d"display:none; font-size:0.9em;"\x3e\x3c/div\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbutton id\x3d"button_sign_in" style\x3d"margin:0;padding:0;" type\x3d"submit" dojotype\x3d"dijit.form.Button"\x3e\r\n                  ${i18n.SignIn}\r\n                \x3c/button\x3e\r\n                \x3cimg dojoAttachPoint\x3d\'_keyImgicon\' class\x3d"esriLeadingMargin1" style\x3d"position:absolute;"/\x3e\r\n                \x3cbr/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriSignIn",activationId:null,defaultOrgTitleText:null,invitation:null,orgName:null,usr:null,pwd:null,exp:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signInWidget);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signInForm);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot);
this.i18n.errors=b.mixin(b.i18n.getLocalization("arcgisonline","arcgisonline").signInForm.errors,b.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot.errors);this.i18n.error.createInitialAdminAccount=b.i18n.getLocalization("arcgisonline","arcgisonline").createInitialAdminAccount.errors;this.defaultOrgTitleText=this.i18n.myAccount;this._viewTrialLink=["us"]},postCreate:function(){b.attr(this._keyImgicon,"src",this._util.relativeToExplicitUrl("images/goldKey.gif"));esriGeowConfig.portalName&&
b.style(this._keyImgicon,"display","none");this._account.getSelf(b.hitch(this,function(a){esriGeowConfig.self&&esriGeowConfig.self.supportsOAuth?(window.onOAuthSignIn=b.hitch(this,"onOAuthSignIn"),window.checkOAuthResponse=b.hitch(this,"checkOAuthResponse"),window.onOAuthSignInError=b.hitch(this,"onOAuthSignInError"),this._oAuthInfo={url:esriGeowConfig.restBaseUrl+"oauth2/authorize",clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",parent:window.location.protocol+"//"+window.location.host,
expiration:20160,locale:b.locale,showSocialLogins:!this._util.isPortal()&&esriGeowConfig&&esriGeowConfig.self&&!esriGeowConfig.self.id&&!this.activationcode&&!this.invitation,hideEnterpriseLogins:this.activationcode?!0:!1},this._oAuthInfo.url=arcgisonline.sharing.util.getSecureUrl(this._oAuthInfo.url),this._authorizeUrl=esri.substitute(this._oAuthInfo,"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26showSocialLogins\x3d${showSocialLogins}\x26hideEnterpriseLogins\x3d${hideEnterpriseLogins}\x26response_type\x3dtoken\x26display\x3diframe\x26parent\x3d${parent}\x26expiration\x3d${expiration}\x26locale\x3d${locale}"),
this.activationcode&&(this._authorizeUrl+="\x26activationCode\x3d"+this.activationcode),b.attr(this._iFrame,"src",this._authorizeUrl),esri.hide(b.byId("authTable")),esri.show(b.byId("oAuthFrame"))):(esri.show(b.byId("authTable")),esri.hide(b.byId("oAuthFrame")));document.referrer&&-1<document.referrer.indexOf("https://")?(this.redirectUrl=this.redirectUrl.replace("http:","https:"),this.orgRedirectUrl=this.orgRedirectUrl.replace("http:","https:"),this.setupRedirectUrl=this.setupRedirectUrl.replace("http:",
"https:")):(this.redirectUrl=this.redirectUrl.replace("https:","http:"),this.orgRedirectUrl=this.orgRedirectUrl.replace("https:","http:"),this.setupRedirectUrl=this.setupRedirectUrl.replace("https:","http:"))}))},startup:function(){this.inherited(arguments);b.mixin(this,b.queryToObject(window.location.search.slice(1)));this.returnUrl&&!arcgisonline.sharing.util.isValidOnlineReturnUrl(this.returnUrl)&&(this.returnUrl=null);this.activationcode&&esriGeowConfig.userInfo&&this._geow.signout(window.location.href);
esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";this._usersUri=this._communityUri+"users/";this._accountsUri=this._svcUrl+"portals/";this._geoIPUri=this._svcUrl+"geoip.jsp";this._optinlistUri=document.location.protocol+"//"+document.location.hostname+"/about/js/optinlist.js";this._requestParams={f:"json"};var a=
esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline;if(this.activationcode){b.style(b.byId("left"),"display","block");b.create("h1",{id:"rightPanelTitle",innerHTML:b.string.substitute(this.i18n.alreadyUsingPortal,{portalName:a})},"rightPanelSubTitle","before");b.byId("rightPanelSubTitle").innerHTML=b.string.substitute(this.i18n.alreadyUserSignIn,{portalName:a});var c="\x3ch1\x3e"+this.i18n.activationTitle+"\x3c/h1\x3e";b.byId("organizationTitle").innerHTML=c;b.style(b.byId("organizationTitle"),
{display:"block",textAlign:"left",marginBottom:"20px"});b.addClass(b.byId("left"),"invitation");b.style(b.byId("left"),"width","47%");b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.firstTimeWith,{portalName:a});b.byId("not_a_member_msg")&&(a="\x3cspan\x3e"+b.string.substitute(this.i18n.userNewToPortal,{portalName:a})+"\x3c/span\x3e",a+='\x3cbr/\x3e\x3cbr /\x3e\x3cspan\x3e\x3cbutton id\x3d"registerLink" class\x3d"calcite light" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e'+
this.i18n.createNewAccount+"\x3c/button\x3e\x3c/span\x3e",c=b.byId("invitationReminder"),b.create("strong",{innerHTML:"\x3cbr/\x3ePlease note\x3cbr/\x3e"},c),b.create("em",{innerHTML:this.i18n.signInExistingNewOrg},c),b.style(c,"display","block"),b.byId("not_a_member_msg").innerHTML=a,b.parser.parse(b.byId("not_a_member_msg")),b.connect(b.byId("registerLink"),"onclick",b.hitch(this,function(a){a=esriGeowConfig.createAccount;var b=this.activationcode;b&&(a+="?activationcode\x3d"+b);document.location=
a})))}else this.invitation?(b.style(b.byId("left"),"display","block"),this._fetchInvitation().then(b.hitch(this,function(a){a.account&&a.account.name&&(this.orgName=a.account.name,b.byId("organizationTitle").innerHTML="\x3ch1\x3e"+b.string.substitute(this.i18n.useOption,{orgName:this.orgName})+"\x3c/h1\x3e",b.style(b.byId("organizationTitle"),"display","block"),a=b.byId("invitationReminder"),b.create("strong",{innerHTML:"\x3cbr/\x3e\x3cbr/\x3e\x3cbr/\x3e"+this.i18n.pleaseNote+"\x3cbr/\x3e"},a),b.create("em",
{innerHTML:b.string.substitute(this.i18n.signInExisting,{orgName:this.orgName})},a),b.style(a,"display","block"))})),b.addClass(b.byId("left"),"invitation"),b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.firstTimeWith,{portalName:a}),b.addClass(b.byId("leftPanelTitle"),"subtitle"),b.style(b.byId("left"),"width","47%"),b.addClass(b.byId("rightAgo"),"invitation"),b.create("h1",{id:"rightPanelTitle",innerHTML:b.string.substitute(this.i18n.alreadyUsingPortal,{portalName:a})},rightAgo,
"first"),b.addClass(b.byId("rightPanelTitle"),"subtitle"),b.place(b.create("br"),b.byId("rightPanelTitle"),"after"),b.byId("not_a_member_msg")&&(a="\x3cbr/\x3e\x3cbr/\x3e",esriGeowConfig.account_registration&&0<esriGeowConfig.account_registration.length?a+='\x3cspan\x3e\x3ca id\x3d"registerLink" class\x3d"calcite light"\x3e'+this.i18n.createAccount+"\x3c/a\x3e\x3c/span\x3e":esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&(a+='\x3cspan\x3e\x3cbutton id\x3d"registerLink" class\x3d"calcite light" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e'+
this.i18n.createNewAccount+"\x3c/button\x3e\x3c/span\x3e"),b.byId("not_a_member_msg").innerHTML=a,b.parser.parse(b.byId("not_a_member_msg")),esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&b.connect(b.byId("registerLink"),"onclick",b.hitch(this,function(a){a=esriGeowConfig.createAccount;this.invitation&&(a+="?invitation\x3d"+this.invitation);document.location=a})))):this._account.getSelf(b.hitch(this,function(a){function c(){var a=esriGeowConfig.signup,b=this.returnUrl;null!==b?a+=
"?returnUrl\x3d"+b:document.referrer&&-1<document.referrer.indexOf("https://")&&(a+="?returnUrl\x3d"+esriGeowConfig.baseUrl.replace("http:","https:")+"user.html?newUser\x3dtrue");document.location=a}function d(){document.location=esriGeowConfig.createAccount}if(a.urlKey||"singletenant"===a.portalMode){if(b.byId("not_a_member_msg")){var e="\x3cspan\x3e"+b.string.substitute(this.i18n.signinMsg,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount,portal:esriGeowConfig.portalName?
esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/span\x3e",e=e+"     \x3cbr /\x3e\x3cbr /\x3e"+('    \x3cbutton id\x3d"registerButton" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e'+b.string.substitute(this.i18n.registerAccount,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/button\x3e");esriGeowConfig.account_registration&&0<esriGeowConfig.account_registration.length?(e=e+"     \x3cbr /\x3e\x3cbr /\x3e"+('    \x3cspan style\x3d"line-height:20px;"\x3e\x3cb\x3e'+
b.string.substitute(this.i18n.dontHaveAccount,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/b\x3e\x3c/span\x3e"),e=e+"     \x3cbr /\x3e"+('    \x3cspan\x3e\x3ca id\x3d"registerLink"\x3e'+this.i18n.createAccount+"\x3c/a\x3e\x3c/span\x3e ")):esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&(e=e+"     \x3cbr /\x3e\x3cbr /\x3e"+('    \x3cspan style\x3d"line-height:20px;"\x3e\x3cb\x3e'+b.string.substitute(this.i18n.dontHaveAccount,
{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount})+"\x3c/b\x3e\x3c/span\x3e"),e=e+"     \x3cbr /\x3e"+('    \x3cspan\x3e\x3cbutton id\x3d"registerLink" type\x3d"button" dojotype\x3d"dijit.form.Button"\x3e'+this.i18n.createAccount+"\x3c/button\x3e\x3c/span\x3e "));b.byId("not_a_member_msg").innerHTML=e;b.parser.parse(b.byId("not_a_member_msg"));b.connect(h.byId("registerButton"),"onClick",c);esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&
b.connect(h.byId("registerLink"),"onClick",d);b.style(b.byId("left"),"display","singletenant"!==a.portalMode?"none":"block");"singletenant"!==a.portalMode&&a.name&&(b.byId("signInTitle").innerHTML=this.i18n.signInTo+" "+a.name)}}else b.connect(this._agoRegister,"onClick",c),esriGeowConfig.accountApi&&0<esriGeowConfig.accountApi.length&&b.connect(this._agoCreate,"onClick",d),b.style("left","display","none"),b.style("leftAgo","display","block")}));this.loadConnections();a=this.returnUrl||null;null!==
a&&(this.redirectUrl=a);if(c=this.error){var d={code:c};if("400"!==c&&"403"!==c)this._showError(d);else if(a&&-1!==a.indexOf("viewer.html"))if("400"==c)this._account.getSelf(b.hitch(this,function(a){-1<document.location.href.indexOf(a.customBaseUrl)&&this.signInError({code:400})}));else return"";else this._showError(d)}b.byId("registerLink")&&(b.byId("registerLink").href=esriGeowConfig.account_registration);this.checkCookieSupport();try{setTimeout(function(){b.byId("user_username").focus()},350)}catch(e){}},
checkCookieSupport:function(){if(10>=b.isIE){b.cookie("test","enabled",{path:"/"});var a=b.cookie("test");b.cookie("test",null,{expires:-1});"enabled"!==a&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})}else b.cookie.isSupported()||arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})},loadConnections:function(){b.connect(h.byId("sign-in-form"),
"onSubmit",this,"signIn")},signIn:function(a){a.preventDefault();-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"));if(!1===this.validateForm())return!1;h.byId("button_sign_in").set("disabled",!0);h.byId("button_sign_in").set("label",this.i18n.signingIn);this._user=this._user||{};b.mixin(this._user,{username:b.byId("user_username").value,password:b.byId("user_password").value,expiration:b.byId("remember-me").checked?
esriGeowConfig.longTokenExpiration:esriGeowConfig.tokenExpiration});this._signin().then(b.hitch(this,"onSignIn"))},onOAuthSignIn:function(){-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"))},checkOAuthResponse:function(a){a=new b._Url(a);a=a.fragment?b.queryToObject(a.fragment):null;a.error?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this._getLocalizedError(a)+"\x3cbr/\x3e\x3cbr/\x3e"),
b.attr(this._iFrame,"src",this._authorizeUrl)):(this._user=b.mixin(this._user,b.mixin(a,{token:a.access_token})),this._geow.signInHandler2(this._user).then(b.hitch(this,"onSignIn")))},_getLocalizedError:function(a){a=a.error_description||a.error||"";return-1<a.toLowerCase().indexOf("because you do not have an organization account associated with your")?this.orgName?b.string.substitute(this.i18n.error.noSocialWithOrgName,{account:this.orgName}):this.i18n.error.noSocialAccount:-1<a.toLowerCase().indexOf("joining this organization is supported by invitation only")?
this.i18n.error.notMemberOfOrg:a},onOAuthSignInError:function(a){a&&a.length&&-1!==a[0].toLowerCase().indexOf("not a member")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.notOrgMember+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&(-1!==a[0].toLowerCase().indexOf("too many invalid logins")||-1!==a[0].toLowerCase().indexOf("too many invalid attempts"))?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.tooManyAttempts+
"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1!==a[0].toLowerCase().indexOf("invalid verification code")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.invalidVerificationCode+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("disabled by your organization")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.disabledByOrg+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("account has been blocked from logging in")?
(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.accountBlocked+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("unable to sign you in. please contact customer service for assistance.")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.disabledByCSR+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("joining this organization is supported by invitation only")?(b.addClass("sign-in-error",
"error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.notMemberOfOrg+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("provide an an answer to the security question")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.createInitialAdminAccount.required.identityAnswer.message+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("security answer to long")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),
"innerHTML",this.i18n.error.createInitialAdminAccount.required.identityAnswerTooLong.message+doubleBreak)):this.signInError({code:400})},onSignIn:function(a,c){this._user=b.mixin(this._user||{},a);this._requestParams.token=this._user.token;this.invitation?this._fetchInvitation().then(b.hitch(this,"onFetchInvitation")):this.activationcode?this._activateAccount().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser")):(this.returnUrl=a&&a.noSecurityQuestion?esriGeowConfig.baseUrl.replace("http:",
"https:")+"user.html?requireSecurity\x3dtrue":this.returnUrl,this.routeUser())},_setCookie:function(a){return this._geow.signInHandler2({username:this._user.username,token:this._user.token,expires_in:this._user.expires_in})},onFetchInvitation:function(a,c){c={google:1,facebook:1};if(a&&a.code&&a.message&&(403===a.code||"IdentityManagerBase.1"===a.code)){var d="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkInstructions+"\x3c/p\x3e";c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c);c.show({title:this.i18n.notice,message:d})}else if(a&&a.code&&a.message&&400===a.code)d="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin},c),c.show({title:this.i18n.notice,
message:d});else if(a&&a.id&&a.id===this.invitation)if(this._user&&this._user.provider in c)this._geow.signout(arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.createAccount+"?invitation\x3d"+this.invitation);else{var e="\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";c="\x3cp\x3e\x3cstrong\x3e"+b.string.substitute(this.i18n.ByAcceptingInvite,{account:a.account.name,name:this._user.username})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+
this.i18n.transferMsg+"\x3c/li\x3e\x3cli\x3e"+this.i18n.accountManagedMsg+"\x3c/li\x3e\x3cli\x3e"+this.i18n.sharedContentMsg+"\x3c/li\x3e\x3cli\x3e"+this.i18n.groupsMsg+"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveOrganization+"\x3c/li\x3e\x3cp\x3e"+b.string.substitute(this.i18n.currentOrNewAccount,{account:a.account.name})+"\x3c/p\x3e";d={title:this.i18n.notice,message:c,choiceOneTitle:this.i18n.useCurrentAccount,choiceTwoTitle:this.i18n.createNewOne};d.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&
!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();this._acceptInvitation().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser"))},c),c.show({title:this.i18n.notice,message:e})):this._acceptInvitation().then(b.hitch(this,"_setCookie")).then(b.hitch(this,"routeUser"))});d.choiceTwoHandler=b.hitch(this,function(a){a=arcgisonline.sharing.util.getSecureUrl();this._geow.signout(a+esriGeowConfig.createAccount+
"?invitation\x3d"+this.invitation)});c=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();c.show(d)}else this.routeUser()},onInvitationAcceptedError:function(a,c){var d;a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)?(a="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();
window.location=d?esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin:esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?invitation\x3d"+this.invitation+"\x26org\x3d"+this.orgName},c),c.show({title:this.i18n.notice,message:a})):(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=d?esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin:esriGeowConfig.baseUrl.replace("http:",
"https:")+esriGeowConfig.signin+"?invitation\x3d"+this.invitation+"\x26org\x3d"+this.orgName},c),a.code&&a.message?("User already member of an account."===a.message&&(d=!0,a.message=this.i18n.userAnotheOrg),c.show({title:this.i18n.unableJoin,message:a.message})):c.show({title:this.i18n.unableJoin,message:this.i18n.problemJoingOrg}))},onActivationAcceptedError:function(a){a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=
a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=b.mixin(b.mixin({},this.i18n.errors.error),a);var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a){a.hide();this.routeUser()},c);c.show(a)},routeUser:function(){var a=this.returnUrl,c=esriGeowConfig.baseUrl+esriGeowConfig.signin;a&&-1<a.indexOf(c)&&(a=null);var d=(c=this._user=this._util.getUser())&&(c.username||c.email),e=b.hitch(this,
function(a){this._user.properties=a&&a.properties;this._fetchSelf().then(b.hitch(this,esriGeowConfig.isDebug?"routeDebug":"routeOrg"))});c&&c.accountId?this._util.loadUserProperties(d).then(e,e):window.location=a?a:this.redirectUrl},routeDebug:function(a){var b=this.returnUrl;a=(this._organization=a||{}).allSSL;var d=this._user,d=d.properties&&d.properties.landingPage&&d.properties.landingPage.url?d.properties.landingPage.url:void 0;window.location=b?b:d?(a?this._util.getSecureUrl(esriGeowConfig.baseUrl):
esriGeowConfig.baseUrl)+d:a?this._util.getSecureUrl(this.redirectUrl):this.redirectUrl},routeOrg:function(a){var c=this._user,d=this.returnUrl,e=new arcgisonline.sharing.dijit.Role({portalUser:a.user||{}}),f=c.properties&&c.properties.landingPage&&c.properties.landingPage.url?c.properties.landingPage.url:void 0,g=esriGeowConfig.baseUrl+esriGeowConfig.signin;d&&-1<d.indexOf(g)&&(d=null);var g=this._organization=a||{},k=g.allSSL;if(d)c=this._util.parseUrl(d).host,a&&!a.isPortal&&c===a.portalHostname?
g.urlKey&&g.customBaseUrl&&-1===c.indexOf(g.urlKey+"."+g.customBaseUrl)&&(a=this._util.getCookie("esri_auth"),this._geow.setAuthCookie(a),d=d.replace(c,g.urlKey+"."+g.customBaseUrl),d=k?d.replace("http:","https:"):d,d=this._util.getBridgeUrl(d,a)):g&&!g.isPortal&&g.urlKey&&g.customBaseUrl&&(a=this._util.getCookie("esri_auth"),this._geow.setAuthCookie(a)),window.location=k?d.replace("http:","https:"):d;else{var h;if(g.urlKey&&g.customBaseUrl){d=(k?"https:":"http:")+"//"+g.urlKey+"."+g.customBaseUrl;
a=null;-1===window.location.host.indexOf(g.urlKey+"."+g.customBaseUrl)&&(a=this._util.getCookie("esri_auth"));var n=esriGeowConfig.baseUrl.indexOf(location.host);-1<n?(d+=esriGeowConfig.baseUrl.substring(n+location.host.length),d=f?d+f:d+("account_admin"===c.role&&e.canViewOrgUsers()?"organization.html":"index.html")):d=k?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:");a&&(this._geow.setAuthCookie(a),d=this._util.getBridgeUrl(d,a));h=k?d.replace("http:","https:"):
d}else h="account_admin"!==c.role||g.urlKey?"account_admin"===c.role&&this.activationcode?k?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:","http:"):f?(k?this._util.getSecureUrl(esriGeowConfig.baseUrl):esriGeowConfig.baseUrl)+f:k?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"):k?this.setupRedirectUrl.replace("http:","https:"):this.setupRedirectUrl.replace("https:","http:");if(g.subscriptionInfo&&"active"!==g.subscriptionInfo.state){var q=
arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg.prototype.statics.getInstance();q.onOkClick=b.hitch(this,function(){q.hide();window.location=h});q.show(g.subscriptionInfo)}else window.location=h}},validateForm:function(){var a=h.byId("user_username").get("value"),b=h.byId("user_password").get("value"),d=null;if(!(null!==a&&""!==a||null!==b&&""!==b))d=this.i18n.error.userNamePassRqd;else if(null===a||""===a)d=this.i18n.error.usernameRqd;else if(null===b||""===b)d=this.i18n.error.passRqd;if(null===
d)return!0;this._showError({message:d});return!1},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);h.byId("button_sign_in").set("label",this.i18n.SignIn);if(void 0!==a&&null!==a&&""!==a)switch(b.addClass("sign-in-error","error"),a.code){case 400:a='\x3cb style\x3d"font-size:1.2em;line-height:30px;"\x3e'+b.string.substitute(this.i18n.unableSignIn,{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/b\x3e\x3cbr/\x3e";a=a+'\x3cspan style\x3d"color:#000000;"\x3e'+
(this._util.isPortal()?this.i18n.usernamePasswordSpell+'\x26nbsp;\x26nbsp;\x3ca href\x3d"troubleshoot.html"\x3e'+this.i18n.troubleshootTitle+"\x3c/a\x3e":this.i18n.usernamePasswordSpell);this._showError({title:"Sign in error",message:a+"\x3c/span\x3e"});try{b.byId("user_username").focus()}catch(d){}break;default:this._showError({message:this.i18n.error.signinError})}},_activateAccount:function(){return this._request(this._accountsUri+"activate",{code:this.activationcode},{usePost:!0,errBack:b.hitch(this,
"onActivationAcceptedError")})},_fetchSelf:function(){esriGeowConfig.self=null;return this._request(this._accountsUri+"self?culture\x3d"+b.locale).then(function(a){return esriGeowConfig.self=a})},_fetchInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation,null,{errBack:b.hitch(this,"onFetchInvitation")})},_acceptInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation+"/accept",null,{usePost:!0,errBack:b.hitch(this,"onInvitationAcceptedError")})},
_signin:function(){var a=new b.Deferred;this._geow.signin({username:this._user.username,password:this._user.password,expiration:this._user.expiration},b.hitch(this,"_resolveDfd",a),b.hitch(this,"signInError"));return a},_resolveDfd:function(a,b){if(b.error)throw this.signInError(b.error),b.error;a.resolve(b)},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this._util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?d.errBack?d.errBack(a.error):this._showError(a.error):
a}),b.hitch(this,function(a){d&&d.errBack?d.errBack(a):this._showError(a);throw a;}))},_showError:function(a){a=a.error||a||{};a.code=a.code||0;var c=a.code;a=this.i18n.errors[a.code]||a;a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);var d=b.mixin(b.mixin({},this.i18n.errors.error),a);this._account.getSelf(b.hitch(this,
function(a){("400"===c||"403"===c)&&-1<document.location.href.indexOf(a.customBaseUrl)&&-1===document.location.href.indexOf("error\x3d403")&&(d.message=this.i18n.error.notOrgMember);b.addClass("sign-in-error","error");b.attr(b.byId("sign-in-error"),"innerHTML",d.message+"\x3cbr/\x3e\x3cbr/\x3e")}));return!0}})})},"arcgisonline/sharing/dijit/dialog/ChoiceDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-construct dojo/on dojo/query dojo/aspect dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/lang ../../../esriGeowConfig dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/ChoiceDlg.html".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p,u,w,v){var B=h("arcgisonline.sharing.dijit.dialog.ChoiceDlg",[n,q,t],{declaredClass:"arcgisonline.sharing.dijit.dialog.ChoiceDlg",widgetsInTemplate:!0,templateString:v,title:"",message:"",choiceOneButton:null,choiceOneTitle:"",choiceOneHandler:null,choiceTwoButton:null,choiceTwoTitle:"",choiceTwoHandler:null,choiceOneConn:null,choiceTwoConn:null,postCreate:function(){this.choiceOneHandler=e(this.choiceOneButton,"click",k.hitch(this,"onChoiceOneClick"));this.choiceTwoHandler=
e(this.choiceTwoButton,"click",k.hitch(this,"onChoiceTwoClick"))},postMixInProperties:function(){this.inherited(arguments);this.i18n=k.mixin({},w.common);k.mixin(this.i18n,w.choiceDlg);this.choiceOneTitle=this.i18n.ok;this.choiceTwoTitle=this.i18n.cancel},destroy:function(){this.inherited(arguments);p.isDefined(this.choiceOneConn)&&this.choiceOneConn.remove();p.isDefined(this.choiceTwoConn)&&this.choiceTwoConn.remove()},show:function(a){a.title&&""!==a.title&&(this.title=a.title);a.message&&""!==
a.message&&(this.message=a.message);a.choiceOneTitle&&""!==a.choiceOneTitle&&(this.choiceOneTitle=a.choiceOneTitle);a.choiceTwoTitle&&""!==a.choiceTwoTitle&&(this.choiceTwoTitle=a.choiceTwoTitle);a.choiceOneHandler&&(this.choiceOneHandler=a.choiceOneHandler,this.setChoiceOneHandler());a.choiceTwoHandler&&(this.choiceTwoHandler=a.choiceTwoHandler,this.setChoiceTwoHandler());a.closeHandler&&g.after(this._dialog,"onCancel",a.closeHandler);this._dialog.set("title",this.title);c.set(this.choiceContent,
"innerHTML",this.message);this.choiceOneButton.set("label",this.choiceOneTitle);this.choiceTwoButton.set("label",this.choiceTwoTitle);u.isRightToLeft&&d.place(this.choiceOneButton.domNode,this.choiceTwoButton.domNode,"after");this._dialog.show()},setChoiceOneHandler:function(){p.isDefined(this.choiceOneConn)&&(this.choiceOneConn.remove(),this.choiceOneConn=void 0);this.choiceOneConn=e(this.choiceOneButton,"click",k.hitch(this,function(){this.hide();this.choiceOneHandler()}))},setChoiceTwoHandler:function(){p.isDefined(this.choiceTwoConn)&&
(this.choiceTwoConn.remove(),this.choiceTwoConn=void 0);this.choiceTwoConn=e(this.choiceTwoButton,"click",k.hitch(this,function(){this.hide();this.choiceTwoHandler()}))},onChoiceOneClick:function(){this.hide()},onChoiceTwoClick:function(){this.hide()},hide:function(){this._dialog.hide()}});B.prototype.statics={getInstance:function(){this._instance||(this._instance=new B);return this._instance}};return B})},"arcgisonline/sharing/dijit/SignInInternal":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Form,dijit/form/Button,dijit/form/ValidationTextBox,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/Role"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.SignInInternal");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Form");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.Role");b.declare("arcgisonline.sharing.dijit.SignInInternal",[h._Widget,h._Templated],{widgetsInTemplate:!0,
templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"login-form" class\x3d"grid_16 esriFloatLeading" style\x3d"display:block;clear:both;"\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"sign-in-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cdiv id\x3d"organizationTitle" style\x3d"display:none; margin:10px 0 40px 0; text-align:center;"\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"left" class\x3d"grid_7 esriFloatLeading"\x3e\r\n        \x3ch1 id\x3d"leftPanelTitle"\x3e${i18n.firstTimeSignIn}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"not_a_member_msg"\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr/\x3e\r\n        \x3cbr/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"right" class\x3d"grid_7 esriFloatTrailing"\x3e\r\n        \x3ch1 id\x3d"rightPanelTitle"\x3e${i18n.signIn}\x3c/h1\x3e\r\n        \x3cbr/\x3e\r\n        \x3cdiv id\x3d"sign-in-error"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"rightPanelDesc" style\x3d"font-weight:bold;"\x3e\x3c/div\x3e\x3cbr/\x3e\r\n        \x3ciframe dojoattachpoint\x3d"_iFrame" id\x3d"oAuthFrame" scrolling\x3d"no" style\x3d"display:none; border:0" marginheight\x3d"0" marginwidth\x3d"0" frameborder\x3d"0" width\x3d"450" height\x3d"500"\x3e\r\n           Your browser does not support iframes.\r\n        \x3c/iframe\x3e\r\n        \x3ctable id\x3d"authTable" style\x3d"width:100%;display:none"\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_username" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.userLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_username" name\x3d"user_username" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" dojoAttachEvent\x3d"keyDown: onKeyDown"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"user_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.passwordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"user_password" name\x3d"user_password" class\x3d"grid_5 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" dojoAttachEvent\x3d"keyDown: onKeyDown"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"signInHelp"\x3e\r\n                  \x3ca id\x3d"signInHelpLink"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                \x3c/div\x3e\r\n                \x3cinput id\x3d"remember-me" style\x3d"height:24px;margin:auto;" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                \x3clabel id\x3d"remember-me-label" for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbr/\x3e\r\n                \x3cbutton id\x3d"button_sign_in" class\x3d"calcite small btn primary" style\x3d"margin:0;padding:0;" type\x3d"submit" dojotype\x3d"dijit.form.Button"\x3e\r\n                  ${i18n.signIn}\r\n                \x3c/button\x3e\r\n                \x3cbr/\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,account:arcgisonline.sharing.geow.Account,redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"organization.html",defaultOrgTitleText:null,invitationId:null,orgName:null,usr:null,pwd:null,exp:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);var a=b.i18n.getLocalization("arcgisonline","arcgisonline");this.i18n=a.common;b.mixin(this.i18n,
a.signInInternalWidget);b.mixin(this.i18n.error,{signInSoftAuth:a.errorWidget.signInSoftAuth,disabledByOrg:a.signInWidget.error.disabledByOrg,createInitialAdminAccount:a.createInitialAdminAccount.errors});this.defaultOrgTitleText=this.i18n.myAccount;this._oAuthInfo={url:esriGeowConfig.restBaseUrl+"oauth2/authorize",clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",parent:window.location.protocol+"//"+window.location.host,expiration:20160,locale:b.locale}},postCreate:function(){this.account.getSelf(b.hitch(this,
function(a){a&&a.isPortal&&(esriGeowConfig.self&&esriGeowConfig.self.supportsOAuth?(window.onOAuthSignIn=b.hitch(this,"onOAuthSignIn"),window.checkOAuthResponse=b.hitch(this,"checkOAuthResponse"),window.onOAuthSignInError=b.hitch(this,"onOAuthSignInError"),this._authorizeUrl=esri.substitute(this._oAuthInfo,"${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26display\x3diframe\x26parent\x3d${parent}\x26expiration\x3d${expiration}\x26locale\x3d${locale}"),
b.attr(this._iFrame,"src",this._authorizeUrl),esri.hide(b.byId("authTable")),esri.show(b.byId("oAuthFrame"))):(esri.show(b.byId("authTable")),esri.hide(b.byId("oAuthFrame"))),arcgisonline.sharing.util.checkForIAA().then(b.hitch(this,function(a){(a=a&&a.error)&&a.status&&a.code&&"error"===a.status&&503===a.code&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.siteUnavailable})})))}))},startup:function(){this.inherited(arguments);
if(b.byId("not_a_member_msg")){var a="\x3cbutton id\x3d'registerButton' class\x3d'calcite blue' type\x3d'button' data-dojo-type\x3d'dijit.form.Button'\x3e"+this.i18n.createAccount+"\x3c/button\x3e";b.byId("not_a_member_msg").innerHTML=a;b.parser.parse(b.byId("not_a_member_msg"));b.connect(b.byId("registerButton"),"onclick",function(){var a=esriGeowConfig.signup,d=b.queryToObject(window.location.search.slice(1)).invitation;d?a+="?invitation\x3d"+d:(d=b.queryToObject(window.location.search.slice(1)).returnUrl,
null!=d&&arcgisonline.sharing.util.isValidPortalReturnUrl(d)&&(a+="?returnUrl\x3d"+d));document.location=a});esriGeowConfig.signInHelp?b.byId("signInHelpLink").href=esriGeowConfig.signInHelp:b.byId("signInHelpLink").href="troubleshoot.html"}this.loadConnections();a=b.queryToObject(window.location.search.slice(1)).error;null!=a&&this.showError(this.getErrorMsg(a));a=b.queryToObject(window.location.search.slice(1)).returnUrl;null!=a&&arcgisonline.sharing.util.isValidPortalReturnUrl(a)&&(this.redirectUrl=
a);esriGeowConfig.esriGlobalAccount?(a=b.string.substitute(this.i18n.signInAccountDesc,{account:esriGeowConfig.esriGlobalAccount}),b.attr(b.byId("rightPanelDesc"),"innerHTML",a)):b.style(b.byId("rightPanelDesc"),"display","none");(a=b.queryToObject(window.location.search.slice(1)).invitation)?(this.invitationId=a,this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitationId,b.hitch(this,function(a){a.account&&a.account.name&&(this.orgName=a.account.name,esriGeowConfig.useDefaultIdentityStore?
(b.byId("organizationTitle").innerHTML="\x3ch1\x3e"+b.string.substitute(this.i18n.joinOptions,{account:this.orgName})+"\x3c/h1\x3e",b.style(b.byId("organizationTitle"),"display","block"),b.addClass(b.byId("left"),"invitation"),b.byId("leftPanelTitle").innerHTML=b.string.substitute(this.i18n.joinFirstTime,{account:this.orgName}),b.addClass(b.byId("leftPanelTitle"),"subtitle"),b.style(b.byId("left"),"width","47%"),b.addClass(b.byId("right"),"invitation"),b.byId("rightPanelTitle").innerHTML=b.string.substitute(this.i18n.joinAlreadyUsing,
{account:this.orgName}),b.addClass(b.byId("rightPanelTitle"),"subtitle")):(b.style(b.byId("left"),"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),"padding-left","30%"),b.removeClass(b.byId("login-form"),"esriFloatLeading")))}))):esriGeowConfig.useDefaultIdentityStore?b.style(b.byId("left"),"width","300px"):(b.style(b.byId("left"),"display","none"),b.removeClass(b.byId("right"),
"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),"padding-left","30%"),b.removeClass(b.byId("login-form"),"esriFloatLeading"));this.account.getSelf(b.hitch(this,function(a){esriGeowConfig.self.disableSignup&&(b.style(b.byId("left"),"display","none"),b.removeClass(b.byId("right"),"esriFloatTrailing"),esriGeowConfig.isRightToLeft?b.style(b.byId("right"),"padding-right","30%"):b.style(b.byId("right"),"padding-left","30%"),b.removeClass(b.byId("login-form"),
"esriFloatLeading"))}));this.checkCookieSupport();try{setTimeout(function(){b.byId("user_username").focus()},350)}catch(c){}},checkCookieSupport:function(){if(10>=b.isIE){b.cookie("test","enabled",{path:"/"});var a=b.cookie("test");b.cookie("test",null,{expires:-1});"enabled"!==a&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.cookiesRequired})}else b.cookie.isSupported()||arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:this.i18n.error.cookiesRequired})},loadConnections:function(){b.connect(h.byId("sign-in-form"),"onSubmit",this,"signIn")},signIn:function(a){a.preventDefault();-1!=b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"));if(!1===this.validateForm())return!1;h.byId("button_sign_in").set("disabled",!0);h.byId("button_sign_in").set("label",this.i18n.signingIn);a=b.byId("user_username").value;var c=b.byId("user_password").value,
d=esriGeowConfig.tokenExpiration;b.byId("remember-me").checked&&(d=esriGeowConfig.longTokenExpiration);this.invitationId&&(this.usr=a,this.pwd=c,this.exp=d);this.geow.signin({username:a,password:c,expiration:d},b.hitch(this,this.onSignIn),b.hitch(this,"signInError"))},onOAuthSignIn:function(){-1!==b.byId("sign-in-error").className.indexOf("error")&&(b.byId("sign-in-error").innerHTML="\x26nbsp;",b.removeClass("sign-in-error","error"))},checkOAuthResponse:function(a){a=new b._Url(a);a=a.fragment?b.queryToObject(a.fragment):
null;a.error?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this._getLocalizedError(a)+"\x3cbr\x3e\x3cbr\x3e"),b.attr(this._iFrame,"src",this._authorizeUrl)):(this._user=b.mixin(this._user,b.mixin(a,{token:a.access_token})),this.geow.signInHandler2(this._user).then(b.hitch(this,"onSignIn")))},_getLocalizedError:function(a){a=a.error_description||a.error||"";return-1<a.toLowerCase().indexOf("because you do not have an organization account associated with your")?this.orgName?
b.string.substitute(this.i18n.error.noSocialWithOrgName,{account:this.orgName}):this.i18n.error.noSocialAccount:-1<a.toLowerCase().indexOf("joining this organization is supported by invitation only")?this.i18n.error.notMemberOfOrg:a},onOAuthSignInError:function(a){a&&a.length&&-1!==a[0].toLowerCase().indexOf("not a member")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.notOrgMember+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("software authorization error")?
(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.signInSoftAuth+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&(-1<a[0].toLowerCase().indexOf("too many invalid logins")||-1!==a[0].toLowerCase().indexOf("too many invalid attempts"))?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.tooManyAttempts+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("disabled by your organization")?(b.addClass("sign-in-error",
"error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.disabledByOrg+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("account has been blocked from logging in")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.accountBlocked+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("joining this organization is supported by invitation only")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),
"innerHTML",this.i18n.error.notMemberOfOrg+"\x3cbr/\x3e\x3cbr/\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("provide an an answer to the security question")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.createInitialAdminAccount.required.identityAnswer.message+"\x3cbr\x3e\x3cbr\x3e")):a&&a.length&&-1<a[0].toLowerCase().indexOf("security answer to long")?(b.addClass("sign-in-error","error"),b.attr(b.byId("sign-in-error"),"innerHTML",this.i18n.error.createInitialAdminAccount.required.identityAnswerTooLong.message+
"\x3cbr\x3e\x3cbr\x3e")):this.signInError({code:400})},onKeyDown:function(a){a.keyCode===b.keys.ENTER&&this.signIn(a)},onSignIn:function(a,c){this.invitationId?arcgisonline.sharing.geow.Account.getInvitation(this.invitationId,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.routeUser()},onInvitationInfo:function(a,c){if(a&&a.code&&a.message&&403===a.code){var d="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e";c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c);c.show({title:this.i18n.noticeLabel,message:d})}else if(a&&a.code&&a.message&&400===a.code)d="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},c),c.show({title:this.i18n.noticeLabel,message:d});else if(a&&a.id&&a.id===this.invitationId){var e=
"\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";c="\x3cp\x3e\x3cstrong\x3e"+b.string.substitute(this.i18n.byAcceptingInvite,{account:a.account.name})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+b.string.substitute(this.i18n.itemsMsg,{beginStrong:"\x3cstrong\x3e",endStrong:"\x3c/strong\x3e"})+"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveMsg+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e";d={title:this.i18n.noticeLabel,
message:c,choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel};d.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.noticeLabel,message:e})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,
b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))});d.choiceTwoHandler=b.hitch(this,function(a){this.routeUser()});c=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();c.show(d)}else this.routeUser()},onInvitationAccepted:function(a,c){a&&a.success&&!0===a.success?this.geow.signin({username:this.usr,password:this.pwd,expiration:this.exp},b.hitch(this,this.routeUser),b.hitch(this,"signInError")):a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===
b.trim(a.message)?(a="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},c),c.show({title:this.i18n.noticeLabel,message:a})):(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=
arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin+"?invitation\x3d"+this.invitationId},c),a.code&&a.message?("User already member of an account."===a.message&&(a.message=this.i18n.userAnotherOrg),c.show({title:this.i18n.unableJoin,message:a.message})):c.show({title:this.i18n.unableJoin,message:this.i18n.problemJoining}))},routeUser:function(){this.exp=this.pwd=this.usr=null;esriGeowConfig.self=null;var a=this.util.getUser(),a=a.username||a.email,c=b.hitch(this,function(a){this._userProperties=
a&&a.properties;arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeOrg))});arcgisonline.sharing.util.loadUserProperties(a).then(c)},routeOrg:function(a,c){c=this.util.getUser();var d=b.queryToObject(window.location.search.slice(1)).returnUrl,e=new arcgisonline.sharing.dijit.Role({portalUser:a.user||{}}),f=this._userProperties&&this._userProperties.landingPage&&this._userProperties.landingPage.url?this._userProperties.landingPage.url:void 0,g=esriGeowConfig.baseUrl+esriGeowConfig.signin;
d&&-1<d.indexOf(g)&&(d=null);d&&(arcgisonline.sharing.util.isValidPortalReturnUrl(d)||(d=null));!a||a.code||a.message?window.location=d?d:arcgisonline.sharing.util.getHttpUrl(this.redirectUrl):(a=a.allSSL,g=arcgisonline.sharing.util.usePortalSSL(),this.redirectUrl=arcgisonline.sharing.util.getHttpUrl()+"index.html",this.orgRedirectUrl=arcgisonline.sharing.util.getHttpUrl()+"organization.html",d?(g=-1<d.indexOf("https:"),window.location=a||g?arcgisonline.sharing.util.getSecureUrl(d):d):f?window.location=
(a||g?arcgisonline.sharing.util.getSecureUrl():arcgisonline.sharing.util.getHttpUrl())+f:"account_admin"===c.role&&(!esriGeowConfig.self.restrictOrganizationPageToAdmin&&e.canViewOrgUsers()||esriGeowConfig.self.restrictOrganizationPageToAdmin&&e.isAdmin())?window.location=a||g?arcgisonline.sharing.util.getSecureUrl(this.orgRedirectUrl):this.orgRedirectUrl:window.location=a||g?arcgisonline.sharing.util.getSecureUrl(this.redirectUrl):this.redirectUrl)},getErrorMsg:function(a){if("498"==a||"IdentityManagerBase.5"==
a)return this.i18n.error.sessionExpired;if("403"==a||"400"==a)return(a=b.queryToObject(window.location.search.slice(1)).returnUrl)&&-1<a.indexOf("viewer.html")?"":this.i18n.error.requireSignIn},validateForm:function(){var a=h.byId("user_username").getValue(),b=h.byId("user_password").getValue(),d=null;if(!(null!=a&&""!==a||null!=b&&""!==b))d=this.i18n.error.userNamePassRqd;else if(null==a||""===a)d=this.i18n.error.usernameRqd;else if(null==b||""===b)d=this.i18n.error.passReqd;if(null==d)return!0;
this.showError(d);return!1},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);h.byId("button_sign_in").set("label",this.i18n.SignIn);if(null!=a&&""!==a)switch(b.addClass("sign-in-error","error"),a.code=500===a.code?400:a.code,a.code){case 400:a="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+b.string.substitute(this.i18n.unableSignIn,{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/b\x3e\x3cbr\x3e";a=a+'\x3cspan style\x3d"color:#000000;"\x3e'+
this.i18n.usernamePassCorrect;a+='\x3c/span\x3e\x3cdiv style\x3d"color:#000000; padding-top:15px;"\x3e';c=esriGeowConfig.signup;document.referrer&&-1<document.referrer.indexOf("https://")&&(c+="?returnUrl\x3d"+arcgisonline.sharing.util.getSecureUrl()+"user.html?newUser\x3dtrue");this.invitation&&(c+=(-1<c.indexOf("?")?"\x26":"?")+"invitation\x3d"+this.invitation);esriGeowConfig.self.disableSignup||(a+=this.i18n.ifFirstTime+"\x3cbr\x3e\x3ca href\x3d'"+c+"'\"\x3e"+this.i18n.createAccount+"\x3c/a\x3e.");
this.showError(a+"\x3c/div\x3e");try{b.byId("user_username").focus()}catch(d){}break;default:this.showError(this.i18n.error.signInError)}},showError:function(a){b.addClass("sign-in-error","error");b.byId("sign-in-error").innerHTML=a+"\x3cbr\x3e\x3cbr\x3e"}})})},"arcgisonline/sharing/dijit/SignUp":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/ValidationTextBox,arcgisonline/sharing/util,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.SignUp");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.declare("arcgisonline.sharing.dijit.SignUp",[h._Widget,h._Templated],
{util:arcgisonline.sharing.util,termsOfUseDlg:arcgisonline.sharing.dijit.dialog.TermsOfUseDlg,geow:arcgisonline.sharing.geow.Geow,redirectUrl:esriGeowConfig.baseUrl+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl+"organization.html",setupRedirectUrl:esriGeowConfig.baseUrl+"setup.html",widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"sign-up-form" class\x3d"grid_16"\x3e\r\n    \x3ch1 id\x3d"sign_up_title"\x3e\x3c/h1\x3e\r\n    \x3cdiv id\x3d"register-error"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojotype\x3d"dijit.form.Form" id\x3d"register-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cp class\x3d"register"\x3e\r\n        \x3cb id\x3d"sign-up-title"\x3e\x3c/b\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"freeTrial" style\x3d"display:none;"\x3e${i18n.activateTrialMsg}\x3c/p\x3e\r\n      \x3cp\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"register_username" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.userLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"register_username" name\x3d"register_username" class\x3d"grid_6 omega" style\x3d"padding:2px;margin:0;" dojotype\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr height\x3d"5"\x3e\r\n              \x3ctd colspan\x3d"2" height\x3d"5"\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd class\x3d"grid_2 alpha"\x3e\r\n                \x3clabel for\x3d"register_password" style\x3d"padding:0;margin:0;"\x3e\r\n                  ${i18n.passwordLabel}\r\n                \x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv id\x3d"register_password" name\x3d"register_password" class\x3d"grid_6 omega" style\x3d"padding:2px;margin:0;" type\x3d"password" dojotype\x3d"dijit.form.TextBox"trim\x3d"true"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"freeTrial" style\x3d"display:none;"\x3e\r\n                  \x3ca dojoAttachPoint\x3d"_signInHelpLink" href\x3d"troubleshoot.html"\x3e${i18n.needHelpSign}\x3c/a\x3e\r\n                  \x3cdiv\x3e\r\n                    \x3cinput id\x3d"remember-me" value\x3d"off" dojotype\x3d"dijit.form.CheckBox" /\x3e\r\n                    \x3clabel for\x3d"remember-me"\x3e${i18n.rememberMe}\x3c/label\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"register"\x3e\r\n                  \x3cdiv id\x3d"forgotPasswordLinkDiv"\x3e\r\n                    \x3ca id\x3d"forgotPasswordLink"\x3e${i18n.forgotPassword}\x3c/a\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-top:10px;"\x3e\r\n                  \x3cbutton id\x3d"button_sign_in" class\x3d"calcite blue" dojoAttachPoint\x3d\'_btnSignIn\' type\x3d"submit" label\x3d"${i18n.register}" dojotype\x3d"dijit.form.Button"\x3e\r\n\r\n                  \x3c/button\x3e\r\n                  \x3cimg dojoAttachPoint\x3d\'_keyImgicon\' style\x3d"display:none; position:absolute; padding-left:10px;"/\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cbr/\x3e\r\n                  \x3cdiv id\x3d"registerDiv"\x3e\r\n                  \x3cp\x3e\r\n                    \x3cb id\x3d"sign-up-no-account"\x3e\x3c/b\x3e\r\n                    \x3cbr/\x3e\r\n                    \x3cspan\x3e\x3ca id\x3d"registerLink"\x3e${i18n.createAccount}\x3c/a\x3e\x3c/span\x3e\r\n                  \x3c/p\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"width:100%; clear:both;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n',
i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget);this.defaultOrgTitleText=this.i18n.myAccount},postCreate:function(){b.attr(this._keyImgicon,"src",this.util.relativeToExplicitUrl("images/goldKey.gif"));esriGeowConfig.portalName&&b.style(this._keyImgicon,"display","none")},startup:function(){this.inherited(arguments);b.mixin(this,
b.queryToObject(window.location.search.slice(1)));this.trial=this.type&&("trial"===this.type.toLowerCase()||"trial press"===this.type.toLowerCase());esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";this._usersUri=this._communityUri+"users/";this._accountsUri=this._svcUrl+"portals/";this._requestParams={f:"json"};
this.loadConnections();esriGeowConfig.account_registration?b.byId("registerLink").href=esriGeowConfig.account_registration:b.style(b.byId("registerDiv"),"display","none");esriGeowConfig.forgotPwd?b.byId("forgotPasswordLink").href=esriGeowConfig.forgotPwd:b.style(b.byId("forgotPasswordLinkDiv"),"display","none");b.byId("sign-up-title").innerHTML=b.string.substitute(this.i18n.enterYourAccountInfo,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount});
b.byId("sign-up-no-account").innerHTML=b.string.substitute(this.i18n.dontHaveAccount,{account:esriGeowConfig.esriGlobalAccount?esriGeowConfig.esriGlobalAccount:this.i18n.esriGlobalAccount});this.trial?(b.attr("registerYour","innerHTML",this.i18n.activateTrial),this._btnSignIn.set("label",this.i18n.signIn),b.query(".registerYour").style("display","none"),b.query(".freeTrial").style("display","block")):esriGeowConfig.useDefaultIdentityStore?b.attr("registerYour","innerHTML",this.i18n.createAccount):
b.attr("registerYour","innerHTML",this.i18n.registerYour+(esriGeowConfig.esriGlobalAccount||this.i18n.esriGlobalAccount));setTimeout(function(){b.byId("register_username").focus()},350);b.subscribe("registerUser",this,"registerUser");b.subscribe("declineTermsOfUse",this,"declineTermsOfUse")},loadConnections:function(){b.connect(h.byId("button_register"),"onClick",this,"signUp");b.connect(h.byId("register-form"),"onSubmit",this,"signUp")},signIn:function(a){this.invitation?arcgisonline.sharing.geow.Account.getInvitation(this.invitation,
b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.activationcode?this._activateAccount(a).then(b.hitch(this,"routeUser")):this.routeUser()},onInvitationInfo:function(a,c){if(a&&a.code&&a.message&&403===a.code){var d="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkInstructions+"\x3c/p\x3e";c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c);c.show({title:this.i18n.notice,
message:d})}else if(a&&a.code&&a.message&&400===a.code)d="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.notice,message:d});else if(a&&a.id&&a.id===this.invitation){c=arcgisonline.sharing.util.getUser();var e="\x3cp\x3e"+b.string.substitute(this.i18n.membershipPending,{account:"\x3cstrong\x3e"+
a.account.name+"\x3c/strong\x3e"})+"\x3c/p\x3e";c="\x3cp\x3e\x3cstrong\x3e"+b.string.substitute(this.i18n.ByAcceptingInvite,{account:a.account.name,name:c.username})+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e\x3cli\x3e"+b.string.substitute(this.i18n.transferMsg,{account:a.account.name,name:c.username})+"\x3c/li\x3e\x3cli\x3e"+this.i18n.leaveOrganization+"\x3c/li\x3e\x3cli\x3e"+b.string.substitute(this.i18n.itemsMsg,{beginStrong:"\x3cstrong\x3e",endStrong:"\x3c/strong\x3e"})+"\x3c/li\x3e\x3cli\x3e"+
this.i18n.accountManagedMsg+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e\x3cp\x3e"+b.string.substitute(this.i18n.currentOrNewAccount,{account:a.account.name})+"\x3c/p\x3e";d={title:this.i18n.notice,message:c,choiceOneTitle:this.i18n.useCurrentAccount,choiceTwoTitle:this.i18n.createNewOne};d.choiceOneHandler=b.hitch(this,function(c){a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,
b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.notice,message:e})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))});d.choiceTwoHandler=b.hitch(this,function(a){this.routeUser()});c=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();c.show(d)}else this.routeUser()},onInvitationAccepted:function(a){var c;a&&a.success&&
!0===a.success?(c={username:h.byId("register_username").getValue(),password:h.byId("register_password").getValue(),expiration:esriGeowConfig.tokenExpiration},this.geow.signin(c,b.hitch(this,this.routeUser),b.hitch(this,"signInError"))):a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)?(a="\x3cp\x3e"+this.i18n.acceptedInvite+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOk+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.notice,message:a})):(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin+"?invitation\x3d"+this.invitation},c),a.code&&a.message?("User already member of an account."===a.message&&(a.message=this.i18n.userAnotheOrg),c.show({title:this.i18n.unableJoin,
message:a.message})):c.show({title:this.i18n.unableJoin,message:this.i18n.problemJoingOrg}))},routeUser:function(){var a=this.returnUrl,c=esriGeowConfig.baseUrl+esriGeowConfig.signin;a&&-1<a.indexOf(c)&&(a=null);(this._user=this.util.getUser()).accountId?this._fetchSelf().then(b.hitch(this,"routeOrg")):window.location=a?a:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html?newUser\x3dtrue"},routeOrg:function(a,b){b=this._user;var c=this.returnUrl,e=esriGeowConfig.baseUrl+esriGeowConfig.signin;
c&&-1<c.indexOf(e)&&(c=null);var f=this._organization=a||{};a=f.allSSL;c?(f.urlKey&&f.customBaseUrl&&(b=this._util.parseUrl(c).host,-1===b.indexOf(f.urlKey+"."+f.customBaseUrl)&&(e=this.util.getCookie("esri_auth"),c=c.replace(b,f.urlKey+"."+f.customBaseUrl),c=this.util.getBridgeUrl(c,e))),window.location=a?c.replace("http:","https:"):c):f.urlKey&&f.customBaseUrl?(e=null,-1===window.location.host.indexOf(f.urlKey+"."+f.customBaseUrl)&&(e=this.util.getCookie("esri_auth")),c=(a?"https:":"http:")+"//"+
f.urlKey+"."+f.customBaseUrl,f=esriGeowConfig.baseUrl.indexOf(location.host),c=-1<f?c+(esriGeowConfig.baseUrl.substring(f+location.host.length)+("account_admin"===b.role?"organization.html":"index.html")):a?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"),e&&(c=esriGeowConfig.bridgeUrl+"?url\x3d"+c+"\x26exp\x3d"+Math.ceil((new Date(e.expires)-new Date)/1E3)),window.location=c):window.location="account_admin"!==b.role||f.urlKey?"account_admin"===b.role&&this.activationcode?
a?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:","http:"):a?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"):a?this.setupRedirectUrl.replace("http:","https:"):this.setupRedirectUrl.replace("https:","http:")},signUp:function(a){a.preventDefault();b.query("#register-error")&&(b.byId("register-error").innerHTML="",b.removeClass("register-error","error"));!1!==this.validateForm()&&(h.byId("button_sign_in").set("disabled",!0),this.trial||
h.byId("button_sign_in").set("label",this.i18n.registering),esriGeowConfig.portalName?this.registerUser():this.trial&&this.activationcode?(this.signout(),this._signin(b.hitch(this,function(){this.termsOfUseDlg.prototype.statics.getInstance().show()})).then(b.hitch(this,function(){this._showAlreadyRegisteredDlg()}))):this.termsOfUseDlg.prototype.statics.getInstance().show())},_showAlreadyRegisteredDlg:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.show({title:this.i18n.alreadyRegisteredTitle,
message:this.i18n.alreadyRegistered});var c=b.connect(a,"onHide",b.hitch(this,function(){b.disconnect(c);h.byId("register_username").set("value","");h.byId("register_password").set("value","");h.byId("button_sign_in").set("disabled",!1);setTimeout(b.hitch(function(){h.byId("register_username").focus()}),300)}))},validateForm:function(){var a=h.byId("register_username").getValue(),b=h.byId("register_password").getValue(),d=null;if(!(null!=a&&""!==a||null!=b&&""!==b))d=this.i18n.error.userNamePassRqd;
else if(null==a||""===a)d=this.i18n.error.usernameRqd;else if(null==b||""===b)d=this.i18n.error.passRqd;if(null==d)return!0;this.showError({message:d});return!1},signout:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});b.cookie("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});b.publish("onSignOut",[])},registerUser:function(a){a=b.byId("register_username").value;var c=b.byId("register_password").value;
a={username:a,password:c};this.signout();this.geow.signup(a,b.hitch(this,function(a,c){if(null!=a.error&&""!==a.error)h.byId("button_sign_in").set("disabled",!1),h.byId("button_sign_in").set("label",this.trial?this.i18n.signIn:this.i18n.register),this.errorHandler(a,c);else return this._signin().then(b.hitch(this,"signIn"))}),b.hitch(this,"signInError"))},declineTermsOfUse:function(){h.byId("button_sign_in").set("disabled",!1)},signInError:function(a,c){h.byId("button_sign_in").set("disabled",!1);
h.byId("button_sign_in").set("label",this.trial?this.i18n.signIn:this.i18n.register);c="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+b.string.substitute(this.i18n.unableRegister,{portalName:esriGeowConfig.portalName?esriGeowConfig.portalName:this.i18n.arcgisOnline})+"\x3c/b\x3e\x3cbr/\x3e";c+="\x3cspan style\x3d'color:#000000;'\x3e";c=a.code&&500===a.code&&a.message&&"Unable to register user. Username contains unsupported characters."===a.message?c+this.i18n.invalidUsername:c+(this.i18n.usernameSpellCheck+
"\x3cbr/\x3e"+this.i18n.caseSensitive);this.showError({message:c+"\x3c/span\x3e\x3cbr/\x3e\x26nbsp;"})},_activateAccount:function(a){return this._request(this._accountsUri+"activate",{code:this.activationcode,token:a.token},{usePost:!0,errBack:b.hitch(this,"_activateError")}).then(b.hitch(this,"_signin"))},_activateError:function(a){a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=
a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=b.mixin(b.mixin({},{title:"Error",message:"There was an error."}),a);var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a){a.hide();this.routeUser()},c);c.show(a)},_signin:function(a){var c=new b.Deferred,d={username:h.byId("register_username").getValue(),password:h.byId("register_password").getValue(),expiration:b.byId("remember-me").checked?esriGeowConfig.longTokenExpiration:
esriGeowConfig.tokenExpiration};this.geow.signin(d,b.hitch(this,"_resolveDfd",c),a||b.hitch(this,"signInError"));return c},_resolveDfd:function(a,b){if(b.error)throw this.signInError(b.error),b.error;a.resolve(b)},_fetchSelf:function(){var a=this.util.getUser();esriGeowConfig.self=null;return this._request(this._accountsUri+"self",{token:a.token})},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this.util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?
d.errBack?d.errBack(a.error):this._showError(a.error):a}),b.hitch(this,function(a){d.errBack?d.errBack(a):this._showError(a);throw a;}))},showError:function(a){a=a.error||a||{};a.code=a.code||0;a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",
a.message+"");return!0}})})},"arcgisonline/sharing/dijit/dialog/TermsOfUseDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/util,dijit/Dialog"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.require("dijit._Widget");b.require("dijit._Templated");b.require("arcgisonline.sharing.util");b.require("dijit.Dialog");b.declare("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg",[h._Widget,h._Templated],{util:arcgisonline.sharing.util,
widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" id\x3d"terms-of-use-dialog" title\x3d"${i18n.title}" execute\x3d"" style\x3d"overflow-y:auto;"\x3e\r\n    \x3cform id\x3d"terms-of-use-form" method\x3d"POST" action\x3d"" style\x3d"height:100%;overflow-y:auto;padding-left:10px;"\x3e\r\n      \x3cdiv style\x3d"height:30px; text-align:center;"\x3e\r\n        \x3cspan style\x3d"font-size:1.1em; font-weight:bold"\x3e${i18n.termsOfUseTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" id\x3d"tos" style\x3d"background:#FFF;border:solid 1px #000;overflow-x:hidden;overflow-y:hidden;width:400px;height:250px;"\x3e\r\n        \x3ca href\x3d\'\'\x3e\x3c/a\x3e\r\n        \x3ciframe id\x3d"termsFrame" src\x3d"termsofuse.html" style\x3d"width:100%;height:250px;max-width:100%;max-height:250px;"\x3e\x3c/iframe\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"padding-top:10px;"\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"http://www.esri.com/legal/licensing-translations" target\x3d"_blank"\x3e${i18n.otherLanguages}\x3c/a\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"height:40px; padding-top:10px;"\x3e\r\n        \x3cbutton id\x3d"button_accept" type\x3d"submit" class\x3d"primary" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.accept}\r\n        \x3c/button\x3e\r\n        \x3cbutton id\x3d"button_decline" class\x3d"jevent cancel" type\x3d"cancel" data-dojo-type\x3d"dijit.form.Button"\x3e\r\n            ${i18n.noaccept}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
_firstLoad:!0,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.TermsOfUseDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").termsOfUseDlg)},postCreate:function(){this.loadConnections()},show:function(a){h.byId("terms-of-use-dialog").show();esri.isTouchEnabled?
(b.style(b.byId("terms-of-use-dialog"),"width","500px"),b.style(b.byId("tos"),"width","455px"),b.style(b.byId("tos"),"overflow-y","scroll")):this._firstLoad&&(b.style(b.byId("terms-of-use-dialog"),"width","455px"),b.isFF||10>b.isIE?(b.isFF&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-169+"px"),9>b.isIE&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-208+"px"),8>b.isIE&&b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),
"height"))-133+"px")):b.style(b.byId("tos"),"height",parseInt(b.style(b.byId("terms-of-use-dialog"),"height"))-169+"px"),b.style(b.byId("terms-of-use-form"),"overflow-y","hidden"),this._firstLoad=!1)},loadConnections:function(){b.query(".jevent").connect("onclick",function(a){a.preventDefault()});b.connect(b.byId("button_decline"),"onclick",this,"declineTerms");b.connect(b.byId("terms-of-use-form"),"onsubmit",this,"registerUser")},hide:function(){h.byId("terms-of-use-dialog").hide()},registerUser:function(a){a.preventDefault();
this.hide();b.publish("registerUser",["true"])},declineTerms:function(a){a.preventDefault();this.hide();b.publish("declineTermsOfUse",["true"])}})})},"arcgisonline/sharing/dijit/SignUpInternal":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/ValidationTextBox,dojo/data/ItemFileReadStore,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/Role,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.SignUpInternal");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.ValidationTextBox");b.require("dojo.data.ItemFileReadStore");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");b.require("arcgisonline.sharing.dijit.Role");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.declare("arcgisonline.sharing.dijit.SignUpInternal",
[h._Widget,h._Templated],{util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv id\x3d"sign-up-form" class\x3d"newStyles grid-50"\x3e\r\n    \x3c!--\x3ch1\x3e${i18n.signUpInternalTitle}\x3c/h1\x3e--\x3e\r\n    \x3cbr/\x3e\x3cdiv id\x3d"register-error"\x3e\x3c/div\x3e\r\n    \x3cform data-dojo-type\x3d"dijit.form.Form" id\x3d"signup-form" method\x3d"POST" action\x3d""\x3e\r\n      \x3cp\x3e${i18n.enterAccountInfo}\x3c/p\x3e\r\n      \x3c!--\x3cdiv class\x3d"formBlock"\x3e--\x3e\r\n        \x3c!--\x3clabel class\x3d"requiredLabel" for\x3d"register_fullname"\x3e${i18n.fullNameLabel}\x3c/label\x3e--\x3e\r\n        \x3c!--\x3cinput id\x3d"register_fullname" name\x3d"register_fullname" data-dojo-attach-point\x3d"_fullname" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e--\x3e\r\n      \x3c!--\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"formBlock" id\x3d"first-name-block"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_firstname"\x3e${i18n.firstNameLabel}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_firstname" name\x3d"register_firstname" data-dojo-attach-point\x3d"_firstname" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock" id\x3d"last-name-block"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_lastname"\x3e${i18n.lastNameLabel}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_lastname" name\x3d"register_lastname" data-dojo-attach-point\x3d"_lastname" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_email"\x3e${i18n.currentEmailAdr}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_email" name\x3d"register_email" data-dojo-attach-point\x3d"_email" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"confirm_register_email"\x3e${i18n.confirmEmailAdr}\x3c/label\x3e\r\n        \x3cinput id\x3d"confirm_register_email" name\x3d"confirm_register_email" data-dojo-attach-point\x3d"_confirmEmail" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_username"\x3e${i18n.yourUserName}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_username" name\x3d"register_username" data-dojo-attach-point\x3d"_username" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-attach-event\x3d"onChange:onUsernameChange" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_password"\x3e${i18n.choosePwd}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_password" name\x3d"register_password" data-dojo-attach-point\x3d"_pwd" type\x3d"password" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"register_password2"\x3e${i18n.renterPwd}\x3c/label\x3e\r\n        \x3cinput id\x3d"register_password2" name\x3d"register_password2" data-dojo-attach-point\x3d"_verifyPwd" type\x3d"password" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"identity_question"\x3e${i18n.identityQLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_question" data-dojo-attach-point\x3d"_identityQuestion" data-dojo-type\x3d"dijit.form.ComboBox"\r\n             data-dojo-attach-event\x3d"onChange:onIdentityQuestionChange" style\x3d"width:350px;margin-left:0;margin-right:0;"\r\n             data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel class\x3d"requiredLabel" for\x3d"identity_answer"\x3e${i18n.identityALabel}\x3c/label\x3e\r\n        \x3cinput id\x3d"identity_answer" data-dojo-attach-point\x3d"_identityAnswer" data-dojo-type\x3d"dijit.form.TextBox" data-dojo-props\x3d"trim:true"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"bottom-buttons"\x3e\r\n        \x3cbutton id\x3d"button_create_account" class\x3d"calcite blue" type\x3d"submit" data-dojo-attach-point\x3d"_createAccountBtn" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.createAcc}\x3c/button\x3e\r\n        \x3cbutton id\x3d"button_cancel" class\x3d"calcite transparent" type\x3d"button" data-dojo-attach-event\x3d"onClick:onCancel" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"index.html",orgRedirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"organization.html",isValidUsername:!1,invitation:null,invitationOrgName:null,identityQuestions:null,accountMode:"arcgis",i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").signUpInternalWidget);
this.i18n.securityQuestions=b.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions;var a=b.i18n.getLocalization("arcgisonline","arcgisonline").organizationInvite.step2Create.invalid;this.i18n.invalid={usernameTooShort:a.usernameTooShort,usernameTooLong:a.usernameTooLong,usernameInvalidChars:a.usernameInvalidChars}},postCreate:function(){this.getPasswordPolicy()},startup:function(){this.inherited(arguments);b.mixin(this,b.queryToObject(window.location.search.slice(1)));esri.config.defaults.io.proxyUrl=
esriGeowConfig.proxyServer;this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";b.attr(b.byId("registerYour"),"innerHTML",this.i18n.signUpInternalTitle);this.setupQuestions();this.loadConnections();this.checkInvitation();setTimeout(b.hitch(this,function(){this._firstname.focus()}),50);b.subscribe("registerUser",this,"registerUser");this.adjustNameRows()},adjustNameRows:function(){"ja"===
b.locale&&b.place(b.byId("first-name-block"),b.byId("last-name-block"),"after")},setupQuestions:function(){this.identityQuestions=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},
{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}];this._identityQuestion.set("store",new b.data.ItemFileReadStore({data:{identifier:"name",label:"id",items:this.identityQuestions}}));this._identityQuestion.set("value",this.i18n.securityQLabel)},loadConnections:function(){b.connect(h.byId("signup-form"),"onSubmit",this,"signUp")},
getPasswordPolicy:function(){this.util.request({url:this.util.getSecureUrl(esriGeowConfig.restBaseUrl)+"portals/self/securityPolicy/passwordPolicy"}).then(b.hitch(this,function(a){this._passwordPolicy=!a||a.code||a.messageCode?null:a}))},checkInvitation:function(){this.invitation&&this._fetchInvitation().then(b.hitch(this,function(a){this.invitationOrgName=a.account.name}))},signIn:function(a,c){esriGeowConfig.self=null;arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeUser))},routeUser:function(a,
c){c=this.util.getUser();var d=new arcgisonline.sharing.dijit.Role({portalUser:a.user||{}}),e=b.queryToObject(window.location.search.slice(1)).returnUrl;if(!a||a.code||a.message)window.location=null!==e?e:arcgisonline.sharing.util.getHttpUrl()+"user.html?newUser\x3dtrue";else{a=a.allSSL;var f=arcgisonline.sharing.util.usePortalSSL();this.redirectUrl=arcgisonline.sharing.util.getHttpUrl()+"index.html";this.orgRedirectUrl=arcgisonline.sharing.util.getHttpUrl()+"organization.html";e?(f=-1<e.indexOf("https:"),
window.location=a||f?arcgisonline.sharing.util.getSecureUrl(e):e):"account_admin"===c.role&&(!esriGeowConfig.self.restrictOrganizationPageToAdmin&&d.canViewOrgUsers()||esriGeowConfig.self.restrictOrganizationPageToAdmin&&d.isAdmin())?window.location=a||f?arcgisonline.sharing.util.getSecureUrl(this.orgRedirectUrl):this.orgRedirectUrl:window.location=a||f?arcgisonline.sharing.util.getSecureUrl(this.redirectUrl):this.redirectUrl}},signUp:function(a){a.preventDefault();b.query("#register-error")&&(b.byId("register-error").innerHTML=
"",b.removeClass("register-error","error"));!1!==this.validateForm()&&(this._createAccountBtn.set("disabled",!0),this._createAccountBtn.set("label",this.i18n.creatingAcc),this.registerUser(!0))},onUsernameChange:function(a){arcgisonline.sharing.geow.Account.checkUsernames([this.util.stripHTML(a)],b.hitch(this,this._handleCheckUsername),b.hitch(this,this._handleCheckUsername))},_handleCheckUsername:function(a){this.isValidUsername=!1;if(!a||a.code||a.message)a.messageCode&&"DB_0006"===a.messageCode?
this.showError(this.i18n.error.restrictedCharacters):b?this.showError(this.i18n.error.checkingUsername):(this.isValidUsername=!0,this.clearError());else if(a.usernames&&0<a.usernames.length){var b=this.util.stripHTML(this._username.get("value"));b!==a.usernames[0].suggested?(b=arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.baseUrl),a=esri.substitute({username:a.usernames[0].requested,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+b+esriGeowConfig.signin+window.location.search+
"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.error.usernameInUse),this.showError(a)):(this.isValidUsername=!0,this.clearError())}},onIdentityQuestionChange:function(a){var c=this._identityQuestion.get("store"),d;c.fetch({onComplete:b.hitch(this,function(b){for(d=0;d<b.length;d++)if(a==c.getValue(b[d],"name")){this._identityQuestionID=c.getValue(b[d],"id");break}})})},onCancel:function(a){a=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin;this.invitation&&(a+="?invitation\x3d"+
this.invitation);window.location=a},usernameContainsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.]+$/g;return a&&!!b.test(a)},validateForm:function(){var a=this._firstname.get("value"),b=this._lastname.get("value"),d=this._email.get("value"),e=this._confirmEmail.get("value"),f=this.util.stripHTML(this._username.get("value")),g=this._pwd.get("value"),k=this._verifyPwd.get("value"),h=this._identityAnswer.get("value"),n=[];esri.isDefined(a)&&""!==a||n.push(this.i18n.error.firstNameReqd);esri.isDefined(b)&&
""!==b||n.push(this.i18n.error.lastNameReqd);esri.isDefined(d)&&""!==d||n.push(this.i18n.error.emailReqd);esri.isDefined(e)&&""!==e?d!==e&&n.push(this.i18n.error.confirmEmailNoMatch):n.push(this.i18n.error.confirmEmailReqd);esri.isDefined(f)&&""!==f?6>f.length?n.push(this.i18n.invalid.usernameTooShort):128<f.length?n.push(this.i18n.invalid.usernameTooLong):this.usernameContainsAlphaNumeric(f)?this.isValidUsername||n.push(esri.substitute({username:f,linkStart:"\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+
this.util.getSecureUrl(esriGeowConfig.baseUrl)+esriGeowConfig.signin+window.location.search+"'\x3e",linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.error.usernameInUse)):n.push(this.i18n.invalid.usernameInvalidChars):n.push(this.i18n.error.userReqd);esri.isDefined(g)&&""!==g?this._passwordPolicy?(a=this.util.meetsPasswordPolicyStrength(this._passwordPolicy,g),a.meetsRequirements()?f.toLowerCase()===g.toLowerCase()&&n.push(this.i18n.passwordNotToPolicy):(a.minLength||n.push(esri.substitute({num:this._passwordPolicy.minLength},
this.i18n.error.passwordLength)),a.minLetter||n.push(esri.substitute({num:this._passwordPolicy.minLetter},this.i18n.error.passwordLetter)),a.minUpper||n.push(esri.substitute({num:this._passwordPolicy.minUpper},this.i18n.error.passwordUpper)),a.minLower||n.push(esri.substitute({num:this._passwordPolicy.minLower},this.i18n.error.passwordLower)),a.minDigit||n.push(esri.substitute({num:this._passwordPolicy.minDigit},this.i18n.error.passwordDigit)),a.minOther||n.push(esri.substitute({num:this._passwordPolicy.minOther},
this.i18n.error.passwordOther)))):8>g.length||28<g.length?n.push(this.i18n.error.invalidPassword):f.toLowerCase()===g.toLowerCase()&&n.push(this.i18n.passwordNotToPolicy):n.push(this.i18n.error.passReqd);g!==k&&n.push(this.i18n.error.passwordsNotMatch);(!this._identityQuestionID||1>this._identityQuestionID)&&n.push(this.i18n.error.questionSelection);esri.isDefined(h)&&""!==h||n.push(this.i18n.error.answerIsBlank);60<h.length&&n.push(this.i18n.error.answerTooLong);if(0===n.length)return!0;f="";for(g=
0;g<n.length;g++)f+=n[g],f+="\x3cbr\x3e";arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:f});return!1},registerUser:function(a){a=this._firstname.get("value");var c=this._lastname.get("value"),d=this._email.get("value"),e=this.util.stripHTML(this._username.get("value")),f=this._pwd.get("value"),g=this._identityAnswer.get("value"),k={fullname:"ja"===b.locale?c+" "+a:a+" "+c,firstname:a,lastname:c,email:d,username:e,password:f,securityQuestionIdx:this._identityQuestionID,
securityAnswer:g};this.invitation&&(k.invitationId=this.invitation,k.provider=this.accountMode);this.geow.signup(k,b.hitch(this,function(a,c){null!=a.error&&""!==a.error?(this._createAccountBtn.set("disabled",!1),this._createAccountBtn.set("label",this.i18n.createAcc),a.error.messageCode&&"COM_1054"===a.error.messageCode?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:this.i18n.error.maxUsers}):this.errorHandler(a,c)):this.invitation?
this.geow.signInHandler(k.username,b.hitch(this,"acceptInvitation",k),b.hitch(this,"signInError"),a,c):this.geow.signInHandler(k.username,b.hitch(this,"signIn"),b.hitch(this,"signInError"),a,c)}),b.hitch(this,"signUpError"))},acceptInvitation:function(a,c,d){arcgisonline.sharing.geow.Account.acceptInvitation(this.invitation,b.hitch(this,function(){this.geow.signin({username:a.username,password:a.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,"signIn"),b.hitch(this,"signInError"))}),
b.hitch(this,this.onAcceptFail))},signUpError:function(a,b){h.byId("button_create_account").set("disabled",!1);h.byId("button_create_account").set("label",this.i18n.createAccount);b=this.i18n.unableCreateAccount;var c=this.i18n.contactAdmin;-1<a.message.indexOf("already registered")&&(c=this.i18n.error.emailInUse);-1<a.message.indexOf("Username '")&&-1<a.message.indexOf("' not available.")&&(c=this.i18n.error.usernameInValid);a='\x3cb style\x3d"font-size:1.2em;line-height:30px;"\x3e'+b+'\x3c/b\x3e\x3cbr\x3e\x3cspan style\x3d"color:#000000;"\x3e'+
c;a+="\x3c/span\x3e\x3cbr\x3e\x26nbsp;";this.showError(a)},signInError:function(a,b){h.byId("button_create_account").set("disabled",!1);h.byId("button_create_account").set("label",this.i18n.createAccount);a="\x3cb style\x3d'font-size:1.2em;line-height:30px;'\x3e"+this.i18n.unableSignAuto+"\x3c/b\x3e\x3cbr\x3e";a=a+'\x3cspan style\x3d"color:#000000;"\x3e'+this.i18n.pleaseTrySignManually;this.showError(a+"\x3c/span\x3e\x3cbr\x3e\x26nbsp;")},clearError:function(){b.removeClass("register-error","error");
b.attr(b.byId("register-error"),"innerHTML","")},showError:function(a){b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",a)},onFetchInvitation:function(a,c){a&&a.code&&a.message&&403===a.code?(c="\x3cp\x3e"+this.i18n.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:",
"https:")+esriGeowConfig.signin},a),a.show({title:this.i18n.notice,message:c})):a&&a.code&&a.message&&400===a.code?(c="\x3cp\x3e"+this.i18n.invitationUsedMsg+"\x3c/p\x3e\x3cp\x3e"+this.i18n.clickOkSignIn+"\x3c/p\x3e",a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=arcgisonline.sharing.util.getSecureUrl()+esriGeowConfig.signin},a),a.show({title:this.i18n.notice,message:c})):a&&a.id&&a.id===this.invitation?
this.invitationOrgName=a.account.name:this.invitation=null},onAcceptFail:function(a,c){a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.onOkClick=b.hitch(this,function(a,b){a.hide();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAcc)},a);a.show({title:this.i18n.unableToJoin,message:this.i18n.problemJoining})},_fetchInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation,null,{errBack:b.hitch(this,
"onFetchInvitation")})},_acceptInvitation:function(){return this._request(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitation+"/accept",{token:this.util.getUser().token},{errBack:b.hitch(this,"onAcceptFail")})},_request:function(a,c,d){c=b.mixin(c||{},this._requestParams);return this.util.request({url:a,content:c},d||{}).then(b.hitch(this,function(a){return a.error?d.errBack?d.errBack(a.error):this._showError(a.error):a}),b.hitch(this,function(a){d.errBack?d.errBack(a):this._showError(a);
throw a;}))},_showError:function(a){a=a.error||a||{};a.code=a.code||0;a=this.i18n.errors[a.code]||a;a.details=a.details&&a.details.length?b.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=b.mixin(b.mixin({},this.i18n.errors.error),a);b.addClass("register-error","error");b.attr(b.byId("register-error"),"innerHTML",a.message+"\x3cbr\x3e");return!0}})})},"arcgisonline/sharing/dijit/CreateAccount":function(){define(["dojo",
"dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/Form,dijit/form/TextBox,dojo/io/iframe,dojo/store/Memory,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.CreateAccount");
b.require("dijit._Widget");b.require("dijit._Templated");b.require("dijit.form.Button");b.require("dijit.form.Form");b.require("dijit.form.TextBox");b.require("dojo.io.iframe");b.require("dojo.store.Memory");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.geow.Geow");b.require("arcgisonline.sharing.dijit.ComboBox");b.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");b.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
b.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");b.requireLocalization("arcgisonline","arcgisonline");b.declare("arcgisonline.sharing.dijit.CreateAccount",[h._Widget,h._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"${baseClass}" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_socialLinkSection" id\x3d"_socialLinkSection" class\x3d"esriItemLinks socialLinkSection newStyles grid-50 hide"\x3e\r\n          \x3cul class\x3d"text-center"\x3e\r\n              \x3cli class\x3d"facebook"\x3e\x3ca class\x3d"social-btn social-btn-facebook" aria-label\x3d"facebook" target\x3d"_blank" data-dojo-attach-point\x3d"_facebookSocialLink" href\x3d""\x3e\x3cspan\x3e\x3c/span\x3e${i18n.continueFacebook}\x3c/a\x3e\x3c/li\x3e\r\n              \x3cli class\x3d"google"\x3e\x3ca class\x3d"social-btn social-btn-google"aria-label\x3d"google" target\x3d"_blank" data-dojo-attach-point\x3d"_googleSocialLink" href\x3d""\x3e\x3cspan\x3e\x3c/span\x3e${i18n.continueGoogle}\x3c/a\x3e\x3c/li\x3e\r\n              \x3cli class\x3d"btn-line js-or"\x3e\x3cspan\x3e${i18n.or}\x3c/span\x3e\x3c/li\x3e\r\n              \x3cli data-dojo-attach-point\x3d"_enterInfo"\x3e\x3ca href\x3d"#" data-dojo-attach-event\x3d"onClick:onEnterInfoClick" class\x3d"calcite blue enterInfo"\x3e${i18n.enterInformation}\x3c/a\x3e\x3c/li\x3e\r\n          \x3c/ul\x3e\r\n          \x3cp class\x3d"accountMessage"\x3e${!i18n.publicAccountMsg}\x3c/p\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" autocomplete\x3d"off" id\x3d"_agoAccountSection" class\x3d"esriItemLinks esriFloatLeading newStyles grid-50" style\x3d"margin-top:20px;"\x3e\r\n    \x3cp class\x3d"sectionHeader hide" id\x3d"agoAccountTitle"\x3e${i18n.formTitle}\x3c/p\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" data-dojo-attach-point\x3d"_messageRow"\x3e\r\n      \x3clabel for\x3d"messageRow" id\x3d"messageRowLabel"\x3e\x26nbsp;\x3c/label\x3e\r\n      \x3cdiv id\x3d"messageRow" data-dojo-attach-point\x3d"_message" style\x3d"color:red;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"account-username" class\x3d"requiredLabel" id\x3d"usernameLabel"\x3e${i18n.usernameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"account-username" class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_username" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"autocomplete:\'off\',autocorrect:\'off\',autocapitalize:\'off\',spellcheck:false,trim:true"\x3e\x3c/div\x3e\r\n        \x3cdiv id\x3d"username_coachmark" class\x3d"coachMarkMsg hide"\x3e${i18n.arcgisAccountMsg}\x3c/div\x3e\r\n        \x3cdiv id\x3d"username_org_coachmark" class\x3d"coachMarkMsg coachMarkMsgOrg hide" data-dojo-attach-point\x3d"_accountMessage"\x3e${i18n.arcgisAccountMsg}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"password" class\x3d"requiredLabel" id\x3d"passwordLabel"\x3e${i18n.passwordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"password" class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_password" data-dojo-type\x3d"dijit/form/TextBox" type\x3d"password" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3cdiv id\x3d"password_coachmark" class\x3d"coachMarkMsg hide"\x3e${i18n.passwordHintText}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_password" class\x3d"requiredLabel" id\x3d"confirmPasswordLabel"\x3e${i18n.confirmPasswordLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_password" data-dojo-attach-point\x3d"_confirmPassword" data-dojo-type\x3d"dijit/form/TextBox" type\x3d"password" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"first_name" class\x3d"requiredLabel" id\x3d"firstNameLabel"\x3e${i18n.firstNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"first_name" data-dojo-attach-point\x3d"_firstName" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"last_name" class\x3d"requiredLabel" id\x3d"lastNameLabel"\x3e${i18n.lastNameLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"last_name" data-dojo-attach-point\x3d"_lastName" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_organizationRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"organization" class\x3d"requiredLabel" id\x3d"organizationLabel"\x3e${i18n.organizationLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"organization" data-dojo-attach-point\x3d"_organizationName" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"email" class\x3d"requiredLabel" id\x3d"emailLabel"\x3e${i18n.emailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"email" data-dojo-attach-point\x3d"_email" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"confirm_email" class\x3d"requiredLabel" id\x3d"confirmEmailLabel"\x3e${i18n.confirmEmailLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"confirm_email" data-dojo-attach-point\x3d"_confirmEmail" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_phoneNumberRow" class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"phoneNumber" class\x3d"requiredLabel" id\x3d"phoneNumberLabel"\x3e${i18n.phoneNumberLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"phoneNumber" data-dojo-attach-point\x3d"_phoneNumber" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"hintBox esriAlignLeading" id\x3d"identityQuestionMessage" data-dojo-attach-point\x3d"_identityQuestionMessage"\x3e${i18n.identityQuestionMsg}\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_question" class\x3d"requiredLabel" id\x3d"identityQuestionLabel"\x3e${i18n.identityQuestionLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_question" data-dojo-attach-point\x3d"_identityQuestion" data-dojo-type\x3d"arcgisonline/sharing/dijit/ComboBox" data-dojo-attach-event\x3d"onChange:onIdentityQuestionChange" style\x3d"width:350px;" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock"\x3e\r\n        \x3clabel for\x3d"identity_answer" class\x3d"requiredLabel" id\x3d"identityAnswerLabel"\x3e${i18n.answerLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"identity_answer" data-dojo-attach-point\x3d"_identityAnswer" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"formBlock" id\x3d"terms_of_use_container"\x3e\r\n        \x3cdiv class\x3d"termsOfUse" data-dojo-attach-point\x3d"_termsOfUseLink"\x3e${!i18n.termsOfUseMessage}\x3c/div\x3e\r\n        \x3clabel class\x3d"tosCheck" for\x3d"tosCheck1"\x3e\x3cinput data-dojo-attach-point\x3d"_acceptTermsOfUseChk1" name\x3d"tosCheck1" data-dojo-type\x3d"dijit/form/CheckBox" value\x3d"agreed" /\x3e${!i18n.touAcceptMsg1}\x3c/label\x3e\r\n        \x3clabel class\x3d"tosCheck" for\x3d"tosCheck2"\x3e\x3cinput data-dojo-attach-point\x3d"_acceptTermsOfUseChk2" name\x3d"tosCheck2" data-dojo-type\x3d"dijit/form/CheckBox" value\x3d"agreed" /\x3e${!i18n.touAcceptMsg2}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"bottom-buttons esriFloatLeading"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_createAccount" class\x3d"calcite blue" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:onCreateAccountClick" type\x3d"button"\x3e${i18n.createAccountLabel}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_cancel" class\x3d"calcite transparent" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:onCancelClick" type\x3d"button"\x3e${i18n.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!--\x3cdiv class\x3d"esriFloatLeading newStyles" data-dojo-attach-point\x3d"_columnThree"\x3e--\x3e\r\n    \x3c!--\x3cdiv class\x3d"hintBox esriAlignLeading esriLeadingMargin3 grid-30" id\x3d"accountMessage" data-dojo-attach-point\x3d"_accountMessage"\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n  \x3cform id\x3d"form_new_account" data-dojo-attach-point\x3d"_form_new_account" method\x3d"post"\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_username" data-dojo-attach-point\x3d"_form_username" name\x3d"username"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_password" data-dojo-attach-point\x3d"_form_password" name\x3d"password"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_confirmationPassword" data-dojo-attach-point\x3d"_form_confirmationPassword" name\x3d"confirmationPassword"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_firstName" data-dojo-attach-point\x3d"_form_firstName" name\x3d"firstName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_lastName" data-dojo-attach-point\x3d"_form_lastName" name\x3d"lastName"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_organization" data-dojo-attach-point\x3d"_form_organization" name\x3d"organization"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_email" data-dojo-attach-point\x3d"_form_email" name\x3d"email"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_phoneNumber" data-dojo-attach-point\x3d"_form_phoneNumber" name\x3d"phoneNumber"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestion" data-dojo-attach-point\x3d"_form_identifyQuestion" name\x3d"identifyQuestion"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyQuestionID" data-dojo-attach-point\x3d"_form_identifyQuestionID" name\x3d"identifyQuestionID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_identifyAnswer" data-dojo-attach-point\x3d"_form_identifyAnswer" name\x3d"identifyAnswer"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_ipAddress" data-dojo-attach-point\x3d"_form_ipAddress" name\x3d"ipAddress"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_apiKey" data-dojo-attach-point\x3d"_form_apiKey" name\x3d"apiKey"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_appID" data-dojo-attach-point\x3d"_form_appID" name\x3d"appID"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_languageCode" data-dojo-attach-point\x3d"_form_languageCode" name\x3d"languageCode"/\x3e\r\n    \x3cinput type\x3d"hidden" id\x3d"form_format" data-dojo-attach-point\x3d"_form_format" name\x3d"format"/\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriAGOCreateAccount",geow:arcgisonline.sharing.geow.Geow,util:arcgisonline.sharing.util,ipLookupUrl:"serverapi.arcgisonline.com/veadaptor/production/services/identity/clientIp",newUserUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html?newUser\x3dtrue",redirectUrl:esriGeowConfig.baseUrl.replace("https:","http:")+"user.html",accountMode:null,activationId:null,invitationId:null,orgName:null,termsAccepted:!1,newAccount:null,identityQuestions:null,_accountMessage:null,_pageTitle:null,
_formTitle:null,_columnThree:null,_identityQuestionMessage:null,_messageRow:null,_phoneNumberRow:null,_organizationRow:null,_usernameLabel:null,_passwordLabel:null,_confirmPasswordLabel:null,_firstNameLabel:null,_lastNameLabel:null,_organizationLabel:null,_emailLabel:null,_confirmEmailLabel:null,_phoneNumberLabel:null,_identityQuestionLabel:null,_identityAnswerLabel:null,_termsOfUseLabel:null,_message:null,_username:null,_password:null,_confirmPassword:null,_firstName:null,_lastName:null,_organizationName:null,
_email:null,_confirmEmail:null,_phoneNumber:null,_identityQuestionID:-1,_identityQuestion:null,_identityAnswer:null,_ipAddress:null,_terms:null,_createAccount:null,_cancel:null,_settingUsername:!1,_form_new_account:null,_form_username:null,_form_password:null,_form_confirmationPassword:null,_form_firstName:null,_form_lastName:null,_form_organization:null,_form_email:null,_form_phoneNumber:null,_form_identifyQuestion:null,_form_identifyQuestionID:null,_form_identifyAnswer:null,_form_ipAddress:null,
_form_apiKey:null,_form_appID:null,_form_languageCode:null,_form_format:null,i18n:null,ecasAccountMode:"ecas",arcgisAccountMode:"arcgis",bothUserType:"both",arcgisUserType:"arcgisonly",postMixInProperties:function(){this.inherited(arguments);this.i18n=b.mixin({},b.i18n.getLocalization("arcgisonline","arcgisonline").common);b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").createAccount);this.i18n.signUpWidget=b.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget;
this.i18n.securityQuestions=b.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions},startup:function(){this.inherited(arguments);esriGeowConfig.isRightToLeft&&b.place(this._cancel.domNode,this._createAccount.domNode,"before");b.style(this._messageRow,"display","none");this._createAccount.set("disabled",!0);this.setupQuestions();this.accountMode=this.arcgisAccountMode;this.userType=this.bothUserType;var a=b.queryToObject(window.location.search.slice(1)).activationcode,c=b.queryToObject(window.location.search.slice(1)).invitation,
d=b.queryToObject(window.location.search.slice(1)).type,e=b.queryToObject(window.location.search.slice(1)).idpName,f=b.queryToObject(window.location.search.slice(1)).trial;a?(this.activationId=a,this.accountMode=this.arcgisAccountMode,this.subType=d,this.userType=this.arcgisUserType,this.showArcGISAccountUI()):c?(this.accountMode=this.arcgisAccountMode,this.invitationId=c,this.idpName=e,this.isJoiningTrialOrg=f,this.util.getJson(esriGeowConfig.restBaseUrl+"community/invitations/"+this.invitationId,
b.hitch(this,function(a){a=b.mixin({},{account:{}},a);this._socialProviders=a.account.socialProviders||[];this._supportsEnterprise=a.account.idpName&&("all"===a.account.targetUserProvider||"enterprise"===a.account.targetUserProvider);this._supportsSocial=this._socialProviders&&this._socialProviders.length&&("all"===a.account.targetUserProvider||"social"===a.account.targetUserProvider);a.account&&a.account.name&&(this.orgName=a.account.name);f&&(this._supportsSocial&&this.setupOauthLinks(f),b.query(".accountMessage").addClass("hide"))})),
b.style(b.byId("terms_of_use_container"),"display","none"),this.termsAccepted=!0,this._createAccount.set("disabled",!1),this.userType=this.arcgisUserType,this.showArcGISAccountUI(),f&&b.query(".accountMessage").addClass("hide")):(this.showArcGISAccountUI(),this.setupOauthLinks(!1));this.accountMode===this.ecasAccountMode&&this.lookupIPAddress();a=this.i18n.createAccountTitle;this.activationId||this.invitationId||(a=this.i18n.createPublicAccountTitle);b.attr(b.byId("pageTitle"),"innerHTML",a);a="";
this.activationId||this.invitationId||(a+=this.i18n.publicAccountMsg+"\x3cbr/\x3e\x3cbr/\x3e");a+=(this.accountMode===this.arcgisAccountMode?this.i18n.arcgisAccountMsg:this.i18n.accountMsg)+" "+this.i18n.passwordHintText;b.attr(this._accountMessage,"innerHTML",a);b.subscribe("registerUser",this,"onTermsAccepted");b.subscribe("declineTermsOfUse",this,"onTermsDeclined");b.connect(this._acceptTermsOfUseChk1,"onChange",b.hitch(this,function(a){b.publish(this._acceptTermsOfUseChk2.checked&&a?"registerUser":
"declineTermsOfUse",["true"])}));b.connect(this._acceptTermsOfUseChk2,"onChange",b.hitch(this,function(a){b.publish(this._acceptTermsOfUseChk1.checked&&a?"registerUser":"declineTermsOfUse",["true"])}));this.adjustNameRows()},setupOauthLinks:function(a){var c={url:arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl+"oauth2/social/authorize"),clientId:"arcgisonline",redirectUri:esriGeowConfig.baseUrl+"postsignin.html",response_type:"token",autoAccountCreateForSocial:!0,createNewSocialUser:!0,
locale:b.locale},c=esri.substitute(c,"${url}?client_id\x3d${clientId}\x26response_type\x3d${response_type}\x26createNewSocialUser\x3d${createNewSocialUser}\x26autoAccountCreateForSocial\x3d${autoAccountCreateForSocial}\x26redirect_uri\x3d${redirectUri}\x26locale\x3d${locale}");a&&(c+="\x26join\x3d"+this.invitationId);b.attr(this._facebookSocialLink,"href",c+"\x26socialLoginProviderName\x3dfacebook");b.attr(this._googleSocialLink,"href",c+"\x26socialLoginProviderName\x3dgoogle");b.addClass(this._accountMessage,
"hide");window.checkOAuthResponse=b.hitch(this,"checkOAuthResponse");this._showSocial=!0;b.addClass("_agoAccountSection","hide");b.addClass(this.domNode,"showSocial");b.removeClass(b.byId("_agoAccountSection"),"esriFloatLeading");b.removeClass(this._socialLinkSection,"hide");b.query(".sectionHeader",this.domNode).removeClass("hide");b.connect(this._username,"onFocus",b.hitch(this,function(){b.removeClass(b.byId("username_coachmark"),"hide")}));b.connect(this._username,"onBlur",b.hitch(this,function(){b.addClass(b.byId("username_coachmark"),
"hide")}));b.connect(this._password,"onFocus",b.hitch(this,function(){b.removeClass(b.byId("password_coachmark"),"hide")}));b.connect(this._password,"onBlur",b.hitch(this,function(){b.addClass(b.byId("password_coachmark"),"hide")}));b.connect(this._confirmPassword,"onFocus",b.hitch(this,function(){b.removeClass(b.byId("password_coachmark"),"hide")}));b.connect(this._confirmPassword,"onBlur",b.hitch(this,function(){b.addClass(b.byId("password_coachmark"),"hide")}))},adjustNameRows:function(){"ja"===
b.locale&&b.place(b.byId("firstNameRow"),b.byId("lastNameRow"),"after")},showArcGISAccountUI:function(){b.style(this._identityQuestionMessage,"display","none");b.style(this._organizationRow,"display","none");b.style(this._phoneNumberRow,"display","none");b.removeClass(this._accountMessage,"hide");b.connect(this._username,"onChange",b.hitch(this,this.onUsernameChanged))},lookupIPAddress:function(){esri.request({url:esriGeowConfig.geoIPService}).then(b.hitch(this,function(a){a&&a.clientip&&(this._ipAddress=
a.clientip)}),b.hitch(this,function(a,b){}))},setupQuestions:function(){this.identityQuestions=[{id:1,name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},
{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}];var a=new b.store.Memory({idProperty:"name",data:this.identityQuestions});this._identityQuestion.set("store",a);this.accountMode===this.ecasAccountMode?this._identityQuestion.set("value",this.i18n.chooseQuestionLabel):this._identityQuestion.set("value",this.i18n.securityQuestionLabel)},compileAccountInfo:function(){var a=
b.locale?b.locale:"en",a=-1<a.indexOf("-")?a.substring(0,a.indexOf("-")):a;this.newAccount={};this.newAccount.username=this._username.get("value");this.newAccount.password=this._password.get("value");this.newAccount.confirmPassword=this._confirmPassword.get("value");this.newAccount.firstName=this._firstName.get("value");this.newAccount.lastName=this._lastName.get("value");this.newAccount.organization=this._organizationName.get("value");this.newAccount.email=this._email.get("value");this.newAccount.confirmEmail=
this._confirmEmail.get("value");this.newAccount.phoneNumber=this._phoneNumber.get("value");this.newAccount.identifyQuestion=this._identityQuestion.get("value");this.newAccount.identifyQuestionID=this._identityQuestionID;this.newAccount.identifyAnswer=this._identityAnswer.get("value");this.newAccount.ipAddress=this._ipAddress;this.newAccount.apiKey=esriGeowConfig.accountApiKey;this.newAccount.appID=esriGeowConfig.accountAppKey;this.newAccount.languageCode=a},validates:function(){this.compileAccountInfo();
var a=null,b="\x3cp\x3e"+this.i18n.validationErrorHeader+"\x3c/p\x3e\x3cp\x3e",d=!1;if(this.notSet(this.newAccount.username))d=!0,b+=this.i18n.invalid.usernameIsBlank+"\x3cbr/\x3e",a||(a=this._username);else{6>this.newAccount.username.length&&(d=!0,b+=this.i18n.invalid.usernameTooShort+"\x3cbr/\x3e",a||(a=this._username));128<this.newAccount.username.length&&(d=!0,b+=this.i18n.invalid.usernameTooLong+"\x3cbr/\x3e",a||(a=this._username));var e=this.findRestrictedChars(this.newAccount.username,arcgisonline.sharing.dijit.CreateAccount.validation.restrictedCharlist+
" ");e&&0<e.length&&(d=!0,b+=esri.substitute({characters:this.util.escapeHTML(e)},this.i18n.invalid.usernameBadChars)+"\x3cbr/\x3e",a||(a=this._username));this.usernameContainsAlphaNumeric(this.newAccount.username)||(d=!0,b+=this.i18n.invalid.usernameInvalidChars+"\x3cbr/\x3e",a||(a=this._username))}this.notSet(this.newAccount.password)||!this.util.meetsPasswordStrength(this.newAccount.password)?(d=!0,b+=this.i18n.passwordHintText+"\x3cbr/\x3e",a||(a=this._password)):this.newAccount.username.toLowerCase()===
this.newAccount.password.toLowerCase()&&(d=!0,b+=this.i18n.passwordNotToPolicy+"\x3cbr\x3e",a||(a=this._password));this.notSet(this.newAccount.confirmPassword)&&(d=!0,b+=this.i18n.invalid.passwordConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmPassword));this.isSet(this.newAccount.password)&&this.isSet(this.newAccount.confirmPassword)&&this.newAccount.password!==this.newAccount.confirmPassword&&(d=!0,b+=this.i18n.invalid.passwordConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._password));this.notSet(this.newAccount.firstName)?
(d=!0,b+=this.i18n.invalid.firstNameIsBlank+"\x3cbr/\x3e",a||(a=this._firstName)):40<this.newAccount.firstName.length?(d=!0,b+=this.i18n.invalid.firstNameTooLong+"\x3cbr/\x3e",a||(a=this._firstName)):this.accountMode!==this.ecasAccountMode||this.containsAlphaNumericWithSpaces(this.newAccount.firstName)||(d=!0,b+=this.i18n.invalid.firstNameInvalidChars+"\x3cbr/\x3e",a||(a=this._firstName));this.notSet(this.newAccount.lastName)?(d=!0,b+=this.i18n.invalid.lastNameIsBlank+"\x3cbr/\x3e",a||(a=this._lastName)):
40<this.newAccount.lastName.length?(d=!0,b+=this.i18n.invalid.lastNameTooLong+"\x3cbr/\x3e",a||(a=this._lastName)):this.accountMode!==this.ecasAccountMode||this.containsAlphaNumericWithSpaces(this.newAccount.lastName)||(d=!0,b+=this.i18n.invalid.lastNameInvalidChars+"\x3cbr/\x3e",a||(a=this._lastName));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.organization)?(d=!0,b+=this.i18n.invalid.organizationIsBlank+"\x3cbr/\x3e",a||(a=this._organizationName)):255<this.newAccount.organization.length?
(d=!0,b+=this.i18n.invalid.organizationTooLong+"\x3cbr/\x3e",a||(a=this._organizationName)):this.containsAlphaNumericWithSpaces(this.newAccount.organization)||(d=!0,b+=this.i18n.invalid.organizationInvalidChars+"\x3cbr/\x3e",a||(a=this._organizationName)));this.notSet(this.newAccount.email)?(d=!0,b+=this.i18n.invalid.emailIsBlank+"\x3cbr/\x3e",a||(a=this._email)):this.util.isValidEmailAddress(this.newAccount.email)||(d=!0,b+=esri.substitute({email:this.util.escapeHTML(this.newAccount.email)},this.i18n.invalid.emailAddress+
"\x3cbr/\x3e"),a||(a=this._email));this.notSet(this.newAccount.confirmEmail)?(d=!0,b+=this.i18n.invalid.emailConfirmIsBlank+"\x3cbr/\x3e",a||(a=this._confirmEmail)):this.util.isValidEmailAddress(this.newAccount.confirmEmail)||(d=!0,b+=esri.substitute({email:this.util.escapeHTML(this.newAccount.confirmEmail)},this.i18n.invalid.emailConfirmAddress)+"\x3cbr/\x3e",a||(a=this._confirmEmail));this.isSet(this.newAccount.email)&&this.isSet(this.newAccount.confirmEmail)&&this.newAccount.email!==this.newAccount.confirmEmail&&
(d=!0,b+=this.i18n.invalid.emailConfirmNoMatch+"\x3cbr/\x3e",a||(a=this._email));this.accountMode===this.ecasAccountMode&&(this.notSet(this.newAccount.phoneNumber)?(d=!0,b+=this.i18n.invalid.phoneIsBlank+"\x3cbr/\x3e",a||(a=this._phoneNumber)):(e=this.findRestrictedPhoneChars(this.newAccount.phoneNumber,arcgisonline.sharing.dijit.CreateAccount.validation.phoneValidChars),0!==e.length&&(d=!0,b+=esri.substitute({characters:this.util.escapeHTML(e)},this.i18n.invalid.phoneBadChars)+"\x3cbr/\x3e",a||(a=
this._phoneNumber))));1>this.newAccount.identifyQuestionID&&(d=!0,b+=this.i18n.invalid.questionSelection+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyQuestion)&&(d=!0,b+=this.i18n.invalid.questionIsBlank+"\x3cbr/\x3e",a||(a=this._identityQuestion));this.notSet(this.newAccount.identifyAnswer)?(d=!0,b+=this.i18n.invalid.answerIsBlank+"\x3cbr/\x3e",a||(a=this._identityAnswer)):60<this.newAccount.identifyAnswer.length&&(d=!0,b+=this.i18n.invalid.answerTooLong+"\x3cbr/\x3e",
a||(a=this._identityAnswer));b+="\x3c/p\x3e";d&&(a&&a.focus(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:b}));return!d},onTermsAccepted:function(){this.termsAccepted=!0;this._createAccount.set("disabled",!1)},onTermsDeclined:function(){this.invitationId||(this.termsAccepted=!1,this._createAccount.set("disabled",!0))},onTermsClick:function(){arcgisonline.sharing.dijit.dialog.TermsOfUseDlg.prototype.statics.getInstance().show()},
onEnterInfoClick:function(){b.removeClass("_agoAccountSection","hide");b.addClass("_socialLinkSection","hide")},onUsernameChanged:function(){b.style(this._messageRow,"display","none");b.attr(this._message,"innerHTML","");if(this._settingUsername)this._settingUsername=!1;else{var a=this._username.get("value"),c=this.findRestrictedChars(a,arcgisonline.sharing.dijit.CreateAccount.validation.restrictedCharlist+" ");if(a&&c&&0<c.length)b.style(this._messageRow,"display","table-row"),b.attr(this._message,
"innerHTML",this.i18n.errors.restrictedCharacters);else if(a&&!this.usernameContainsAlphaNumeric(a))b.style(this._messageRow,"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.restrictedCharacters);else if(a&&0<a.length)arcgisonline.sharing.geow.Account.checkUsernames([a],b.hitch(this,this.handleCheckUsername),b.hitch(this,this.handleCheckUsername));else this.onTermsDeclined()}},handleCheckUsername:function(a){if(!a||a.code||a.message)a.messageCode&&"DB_0006"===a.messageCode?
(b.style(this._messageRow,"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.restrictedCharacters)):(b.style(this._messageRow,"display","table-row"),b.attr(this._message,"innerHTML",this.i18n.errors.checkingUsername)),this.onTermsDeclined();else if(a.usernames&&0<a.usernames.length&&this._username.get("value")!==a.usernames[0].suggested){var c="\x3cspan class\x3d'esriItemLinks'\x3e\x3ca href\x3d'"+esriGeowConfig.baseUrl.replace("http:","https:")+(esri.isDefined(this.invitationId)&&
!this.isJoiningTrialOrg?"acceptinvite.html":esriGeowConfig.signin)+window.location.search+"'\x3e";a=esri.substitute({username:a.usernames[0].requested,linkStart:c,linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.isJoiningTrialOrg?this.i18n.invalid.usernameIsTakenTrial:this.i18n.invalid.usernameIsTaken);b.style(this._messageRow,"display",this.isJoiningTrialOrg?"block":"table-row");b.attr(this._message,"innerHTML",a);this.onTermsDeclined()}},onIdentityQuestionChange:function(a){this._identityQuestion.get("store").query({name:a}).forEach(b.hitch(this,
function(a){this._identityQuestionID=a.id}))},onCreateAccountClick:function(){this.termsAccepted?this.validates()&&this.createAccount(this.newAccount,esriGeowConfig.accountApi):arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:this.i18n.termsOfUseReminder})},onCancelClick:function(){var a=b.queryToObject(window.location.search.slice(1)).referrer;a?(a="acceptInvite"===esriGeowConfig.baseUrl.replace("http://","https://")+a?"acceptinvite.html":
"activate.html",this.invitationId?a+="?invitation\x3d"+this.invitationId:this.activationId&&(a+="?activationcode\x3d"+this.activationId+(this.subType?"\x26type\x3d"+this.subType:"")),window.location=a):this._showSocial?(b.addClass("_agoAccountSection","hide"),b.removeClass("_socialLinkSection","hide")):(a=esriGeowConfig.baseUrl.replace("http://","https://")+esriGeowConfig.signin,this.activationId?a+="?activationcode\x3d"+this.activationId+(this.subType?"\x26type\x3d"+this.subType:""):this.invitationId&&
(a+="?invitation\x3d"+this.invitationId),window.location=a)},handleArcGISAccount:function(a,c){if(a&&a.success&&!0===a.success)this.onSignUp(a,c);else{c=this.i18n.errors.creatingAccount;var d=this.i18n.errorLabel,e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.code&&400===a.code&&a.message&&"Unable to signup user."===a.message&&a.details&&a.details[0]&&"Invitation email does not match."===a.details[0]?(d=this.i18n.noticeLabel,c="\x3cp\x3e"+this.i18n.invite.emailInvitation+
"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.correctEmail+"\x3c/p\x3e",e.onOkClick=b.hitch(this,function(a,b){a.hide();this._email.set("value","");this._confirmEmail.set("value","");this._email.focus();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},e),e.show({title:d,message:c})):a.code&&500===a.code&&a.message&&-1<a.message.indexOf("Username")&&-1<a.message.indexOf("not available.")?(d=this.i18n.noticeLabel,c=this.i18n.errors.restrictedCharacters,
e.onOkClick=b.hitch(this,function(a,b){a.hide();this._username.focus();this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)})):(e.show({title:d,message:c}),this._createAccount.set("disabled",!1),this._createAccount.set("label",this.i18n.createAccountLabel))}},handleCreateAccount:function(a){if(a&&a.status)if("success"===a.status)this.register();else{if("error"===a.status){var b="";(a=a.errorcode)?"Missing_FirstName"===a?(b=this.i18n.invalid.ecasFirstNameIsMissing,
this._firstName.focus()):"Missing_LastName"===a?(b=this.i18n.invalid.ecasLastNameIsMissing,this._lastName.focus()):"Missing_Organization"===a?(b=this.i18n.invalid.ecasOrganizationIsMissing,this._organizationName.focus()):"Missing_Email"===a||"Email_Bad_Format"===a?("Missing_Email"===a?b=this.i18n.invalid.ecasEmailIsMissing:"Email_Bad_Format"===a&&(b=this.i18n.invalid.ecasEmailBadFormat),this._email.focus()):"Missing_PhoneNumber"===a||"PhoneNumber_Bad_Format"===a?(""===a?b=this.i18n.invalid.ecasPhoneIsMissing:
""===a&&(b=this.i18n.invalid.ecasPhoneBadFormat),this._phoneNumber.focus()):"Missing_Password"===a||"Password_Length"===a||"Password_Missmatch"===a?("Missing_Password"===a?b=this.i18n.invalid.ecasPasswordIsMissing:"Password_Length"===a?b=this.i18n.invalid.ecasPasswordLength:"Password_Missmatch"===a&&(b=this.i18n.invalid.ecasPasswordMissmatch),this._password.focus()):"Missing_PasswordConfirmation"===a?(b=this.i18n.invalid.ecasPasswordConfirmIsMissing,this._confirmPassword.focus()):"Missing_IdentifyQuestion"===
a?(b=this.i18n.invalid.ecasQuestionIsMissing,this._identityQuestion.focus()):"Missing_Answer"===a?(b=this.i18n.invalid.ecasAnswerIsMissing,this._identityAnswer.focus()):"Missing_Username"===a||"Username_Taken"===a||"Username_Length"===a?("Username_Taken"===a?b=esri.substitute({username:this.newAccount.username},this.i18n.invalid.ecasUsernameIsTaken):"Missing_Username"===a?b=this.i18n.invalid.ecasUsernameIsMissing:"Username_Length"===a&&(b=this.i18n.invalid.ecasUsernameLength),this._username.focus()):
"Delayed_Creation"===a?b=esri.substitute({p:"\x3cp\x3e",pEnd:"\x3c/p\x3e"},this.i18n.errors.delayedCreation):"Restricted_Characters"===a?this.usernameContainsAlphaNumeric(this.newAccount.username)?this.containsLatinCharset(this.newAccount.password)?this.containsAlphaNumeric(this.newAccount.firstName)?this.containsAlphaNumeric(this.newAccount.lastName)?this.containsAlphaNumericWithSpaces(this.newAccount.organization)?(b=this.i18n.errors.restrictedIdentifyAnswerCharacters,this._identityAnswer.focus()):
b=this.i18n.errors.restrictedOrganizationCharacters:b=this.i18n.errors.restrictedLastNameCharacters:b=this.i18n.errors.restrictedFirstNameCharacters:(b=this.i18n.invalid.ecasPasswordRestrictedCharacters,this._password.focus()):(b=this.i18n.errors.restrictedCharacters,this._username.focus()):b=this.i18n.errors.creatingAccount:b=this.i18n.errors.creatingAccount;a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.show({title:this.i18n.errorLabel,message:b});this._createAccount.set("disabled",
!1);this._createAccount.set("label",this.i18n.createAccountLabel)}}else a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.show({title:this.i18n.errorLabel,message:this.i18n.errors.creatingAccount}),this._createAccount.set("disabled",!1),this._createAccount.set("label",this.i18n.createAccountLabel)},register:function(){var a={username:this.newAccount.username,password:this.newAccount.password};this.signout();this.geow.signup(a,b.hitch(this,this.onSignUp),b.hitch(this,
this.signUpError))},signUpError:function(a,c){a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();a.onOkClick=b.hitch(this,function(a,b){a.hide();a=esriGeowConfig.baseUrl+esriGeowConfig.signin;this.invitationId?a+="?invitation\x3d"+this.invitationId+"\x26org\x3d"+this.orgName:this.activationId&&(a+="?activationcode\x3d"+this.activationId);window.location=a},a);a.show({title:this.i18n.noticeLabel,message:this.i18n.errors.loggingIn});this._createAccount.set("disabled",!1);
this._createAccount.set("label",this.i18n.createAccountLabel)},onSignUp:function(a,c){null!=a.error&&""!==a.error?this.errorHandler(a,c):arcgisonline.sharing.geow.Geow.signInHandler(this.newAccount.username,b.hitch(this,this.signIn),b.hitch(this,this.signInError),a,c)},signIn:function(a,c){this.invitationId?arcgisonline.sharing.geow.Account.getInvitation(this.invitationId,b.hitch(this,this.onInvitationInfo),b.hitch(this,this.onInvitationInfo)):this.activationId?arcgisonline.sharing.geow.Account.activateAccount(this.activationId,
b.hitch(this,this.onActivation),b.hitch(this,this.onActivation)):this.routeUser()},checkOAuthResponse:function(a){a=this.util.parseUrl(a);a=a.hash?b.queryToObject(a.hash):null;var c=this.i18n.errorLabel,d=this.i18n.errors.joiningOrg,e;a.error?(a.error_description&&-1<a.error_description.indexOf("Your account email address must match the email address the invitation was sent to.")?(c=this.i18n.noticeLabel,d="\x3cp\x3e"+this.i18n.invite.emailInvitation+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.correctEmail+
"\x3c/p\x3e"):d=a.error_description||d,e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),e.show({title:c,message:d}),e.onOkClick=b.hitch(this,function(a,b){e.hide()})):this._updateCookie(a).then(b.hitch(this,"routeUser"))},_updateCookie:function(a){var c=new b.Deferred;a=b.mixin({},a,{token:a.access_token});this.geow.signInHandler2(a).then(function(a){c.resolve(a)});return c},signInError:function(a){a=this.i18n.errors.registering+"\x3cbr/\x3e"+this.i18n.errors.caseSensitive;
arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.noticeLabel,message:a});this._createAccount.set("disabled",!1);this._createAccount.set("label",this.i18n.createAccountLabel)},onActivation:function(a){!a||a.code||a.message?this.routeUser():this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError))},onInvitationInfo:function(a,
c){if(a&&a.code&&a.message&&403===a.code){var d="\x3cp\x3e"+this.i18n.invite.cantJoin+"\x3c/p\x3e",d=d+("\x3cp\x3e"+esri.substitute({a:"\x3ca href\x3d'"+esriGeowConfig.account_edit+"' target\x3d'_blank' style\x3d'text-decoration:underline;'\x3e",aEnd:"\x3c/a\x3e"},this.i18n.invite.editEmail)+"\x3c/p\x3e"),d=d+("\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e");c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},
c);c.show({title:this.i18n.noticeLabel,message:d})}else if(a&&a.code&&a.message&&400===a.code)d="\x3cp\x3e"+this.i18n.invite.alreadyAccepted+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.signInNoJoin+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.noticeLabel,message:d});else if(a&&a.id&&a.id===this.invitationId){var e="\x3cp\x3e"+esri.substitute({organization:"\x3cstrong\x3e"+
a.account.name+"\x3c/strong\x3e"},this.i18n.invite.pendingApproval)+"\x3c/p\x3e",d="\x3cp\x3e\x3cstrong\x3e"+esri.substitute({organization:a.account.name},this.i18n.invite.joiningOrg)+"\x3c/strong\x3e\x3c/p\x3e\x3cp\x3e\x3cul\x3e",d=d+("\x3cli\x3e"+this.i18n.invite.createdContent+" \x3cstrong\x3e"+this.i18n.invite.adminRights+"\x3c/strong\x3e\x3c/li\x3e"),d=d+("\x3cli\x3e"+this.i18n.signUpWidget.accountManagedMsg+"\x3c/li\x3e"),d=d+("\x3cli\x3e"+this.i18n.signUpWidget.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e");
c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.onOkClick=b.hitch(this,function(c){c.hide();a.mustApprove&&!0===a.mustApprove?(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a){a.hide();arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c),c.show({title:this.i18n.noticeLabel,message:e})):arcgisonline.sharing.geow.Account.acceptInvitation(this.invitationId,
b.hitch(this,this.onInvitationAccepted),b.hitch(this,this.onInvitationAccepted))},c);c.show({title:this.i18n.noticeLabel,message:d})}else this.routeUser()},onInvitationAccepted:function(a,c){a&&a.success&&!0===a.success?this.geow.signin({username:this.newAccount.username,password:this.newAccount.password,expiration:esriGeowConfig.tokenExpiration},b.hitch(this,this.routeUser),b.hitch(this,this.signInError)):a&&a.code&&a.message&&500===a.code&&"Invitation has already been accepted."===b.trim(a.message)?
(a="\x3cp\x3e"+this.i18n.invite.awaitingApproval+"\x3c/p\x3e\x3cp\x3e"+this.i18n.invite.clickToSignIn+"\x3c/p\x3e",c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();this.routeUser()},c),c.show({title:this.i18n.noticeLabel,message:a})):(c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),c.onOkClick=b.hitch(this,function(a,b){a.hide();window.location=esriGeowConfig.baseUrl.replace("http:","https:")+
esriGeowConfig.signin},c),a.code&&a.message?c.show({title:this.i18n.unableToJoinLabel,message:a.message}):c.show({title:this.i18n.unableToJoinLabel,message:this.i18n.errors.joiningOrg}))},routeUser:function(){var a=this.util.getUser(),c=b.queryToObject(window.location.search.slice(1)).returnUrl;!esriGeowConfig.isDebug&&a&&a.accountId?(esriGeowConfig.self=null,arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.routeOrg))):window.location=null!=c?c:this.newUserUrl},routeOrg:function(a,c){var d=
this.util.getUser(),e=b.queryToObject(window.location.search.slice(1)).returnUrl;if(!a||a.code||a.message)window.location=e?e:this.newUserUrl;else if(c=a.allSSL,e){if(a.urlKey&&a.customBaseUrl){var f=this.util.parseUrl(e).host;-1===f.indexOf(a.urlKey+"."+a.customBaseUrl)&&(d=this.util.getCookie("esri_auth"),e=e.replace(f,a.urlKey+"."+a.customBaseUrl),e=this.util.getBridgeUrl(e,d))}window.location=c?e.replace("http:","https:"):e}else a.urlKey&&a.customBaseUrl?(d=null,-1===window.location.host.indexOf(a.urlKey+
"."+a.customBaseUrl)&&(d=this.util.getCookie("esri_auth")),a=(c?"https:":"http:")+"//"+a.urlKey+"."+a.customBaseUrl,e=esriGeowConfig.baseUrl.indexOf(location.host),a=-1<e?a+(esriGeowConfig.baseUrl.substring(e+location.host.length)+"user.html"):c?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"),d&&(a=esriGeowConfig.bridgeUrl+"?url\x3d"+a+"\x26exp\x3d"+Math.ceil((new Date(d.expires)-new Date)/1E3)),window.location=a):window.location="account_admin"!==d.role||a.urlKey?
c?this.redirectUrl.replace("http:","https:"):this.redirectUrl:(c?esriGeowConfig.baseUrl.replace("http:","https:"):esriGeowConfig.baseUrl.replace("https:","http:"))+"setup.html"},isSet:function(a){return a&&null!==a&&0<a.length},notSet:function(a){return!a||null===a||""===a},findRestrictedChars:function(a,b){var c="",e;if(a&&b)for(e=0;e<b.length;e++){var f=b.charAt(e);-1!==a.indexOf(f)&&(" "==f&&(f="spaces"),c=0===c.length?f:c+(" "+f))}return c},findRestrictedPhoneChars:function(a,b){var c="",e;if(a&&
b)for(e=0;e<a.length;e++){var f=a.charAt(e);-1===b.indexOf(f)&&(c+=f+" ")}return c},containsLatinCharset:function(a){return/^[\u0000-\u00FF]+$/g.test(a)},usernameContainsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.]+$/g;return a&&!!b.test(a)},containsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.\-]+$/g;return a&&!!b.test(a)},containsAlphaNumericWithSpaces:function(a){var b=/^[a-zA-Z0-9@_\.\-\s]+$/g;return a&&!!b.test(a)},createAccount:function(a,c){this._createAccount.set("disabled",!0);this._createAccount.set("label",
this.i18n.creatingAccountLabel);if(this.accountMode===this.ecasAccountMode){if(esriGeowConfig.proxyServer){var d=esriGeowConfig.proxyServer;-1!==location.protocol.indexOf("https")&&(d=d.replace("http:","https:"));c=d+"?"+c}b.attr(this._form_new_account,"action",c);b.attr(this._form_username,"value",a.username);b.attr(this._form_password,"value",a.password);b.attr(this._form_confirmationPassword,"value",a.confirmPassword);b.attr(this._form_firstName,"value",a.firstName);b.attr(this._form_lastName,
"value",a.lastName);b.attr(this._form_organization,"value",a.organization);b.attr(this._form_email,"value",a.email);b.attr(this._form_phoneNumber,"value",a.phoneNumber);b.attr(this._form_identifyQuestion,"value",a.identifyQuestion);b.attr(this._form_identifyQuestionID,"value",a.identifyQuestionID);b.attr(this._form_identifyAnswer,"value",a.identifyAnswer);b.attr(this._form_ipAddress,"value",this._ipAddress);b.attr(this._form_apiKey,"value",a.apiKey);b.attr(this._form_appID,"value",a.appID);b.attr(this._form_languageCode,
"value",a.languageCode);b.attr(this._form_format,"value","json");b.xhrPost({url:c,form:this._form_new_account,handleAs:"json",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},load:b.hitch(this,this.handleCreateAccount),error:b.hitch(this,this.handleCreateAccount)})}else this.accountMode===this.arcgisAccountMode&&(c="ja"===b.locale?a.lastName+" "+a.firstName:a.firstName+" "+a.lastName,a={username:a.username,password:a.password,email:a.email,firstName:a.firstName,
lastName:a.lastName,securityQuestionIdx:a.identifyQuestionID,securityAnswer:a.identifyAnswer,provider:this.arcgisAccountMode,usertype:this.userType},"ja"===b.locale&&(a.fullName=c),this.invitationId&&(a.invitationId=this.invitationId),this.activationId&&(a.activationCode=this.activationId),this.signout(),this.geow.signup(a,b.hitch(this,this.onSignUp),b.hitch(this,this.handleArcGISAccount)))},signout:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;b.cookie("esri_auth",null,
{expires:-1,path:"/",domain:document.domain});b.cookie("ESRI_Webmap",null,{expires:-1,path:"/",domain:document.domain});b.publish("onSignOut",[])}});arcgisonline.sharing.dijit.CreateAccount.validation={restrictedCharlist:"'\"\x3c\x3e{}[]#$%^\x26;:/\\",phoneValidChars:"0123456789().-+ "}})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q){k.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");d=q._iframeName;d=d.substring(0,d.lastIndexOf("_"));var t=a.delegate(q,{create:function(){return t._frame=q.create.apply(q,arguments)},get:null,post:null,send:function(a){var d,e=c._ioSetArgs(a,function(a){d&&d.cancel()},function(a){var b=null;a=a.ioArgs;try{var c=a.handleAs;"xml"===c||"html"===c?b=d.response.data:(b=d.response.text,"json"===c?b=h.fromJson(b):"javascript"===c&&(b=k.eval(b)))}catch(x){b=
x}return b},function(a,b){b.ioArgs._hasError=!0;return a}),g=e.ioArgs,l="GET",m=f.byId(a.form);a.method&&"POST"===a.method.toUpperCase()&&m&&(l="POST");a={method:l,handleAs:"json"===a.handleAs||"javascript"===a.handleAs?"text":a.handleAs,form:a.form,query:m?null:a.content,data:m?a.content:null,timeout:a.timeout,ioArgs:g};a.method&&(a.method=a.method.toUpperCase());if(b.ioPublish&&k.publish&&!1!==g.args.ioPublish)var p=n.after(q,"_notifyStart",function(a){a.options.ioArgs===g&&(p.remove(),c._ioNotifyStart(e))},
!0);d=q(g.url,a,!0);g._callNext=d._callNext;d.then(function(){e.resolve(e)}).otherwise(function(a){e.ioArgs.error=a;e.reject(a)});return e},_iframeOnload:e.global[d+"_onload"]});a.setObject("dojo.io.iframe",t);return t})},"arcgisonline/sharing/dijit/ComboBox":function(){define("require exports tslib ../../tsutils/declareDecorator dijit/form/ComboBox dojo/text!./templates/ComboBox.html".split(" "),function(b,h,k,a,c,d){a=k.__importDefault(a);c=k.__importDefault(c);return function(){function b(){this.autoComplete=
!1;this.templateString=d}return b=k.__decorate([a.default(c.default)],b)}()})},"arcgisonline/sharing/dijit/HelpManager":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dojo/io/script,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.HelpManager");b.require("dijit._Widget");b.require("dojo.io.script");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.geow.Account");b.declare("arcgisonline.sharing.dijit.HelpManager",
[h._Widget],{helpBaseUrl:null,helpTopics:null,_isSingleTenant:!1,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.HelpManager);return this._instance}},postCreate:function(){this._isSingleTenant=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;this._load()},_load:function(){arcgisonline.sharing.geow.Account.getSelf(b.hitch(this,this.handleGetHelp))},handleGetHelp:function(a,
b){!a||a.code||a.message||(this.helpBaseUrl=a.helpBase,this.helpTopics=a.helpMap.m,this.onLoad(this.helpBaseUrl,this.helpTopics))},onLoad:function(a,b){},isLoaded:function(){return this.helpBaseUrl&&this.helpTopics},getHelpUrl:function(a){return this.isLoaded()?this.helpBaseUrl+this.helpTopics[a]:"#"}})})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(b,
h,k,a,c,d,e,f,g,l){h.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var m={get:function(a){var b,c=this._makeScriptDeferred(a,function(a){b&&b.cancel()}),e=c.ioArgs;d._ioAddQueryToUrl(e);d._ioNotifyStart(c);b=g.get(e.url,{timeout:a.timeout,jsonp:e.jsonp,checkString:a.checkString,ioArgs:e,frameDoc:a.frameDoc,canAttach:function(a){e.requestId=a.id;e.scriptId=a.scriptId;e.canDelete=a.canDelete;return m._canAttach(e)}},!0);l.around(b,"isValid",function(a){return function(b){m._validCheck(c);
return a.call(this,b)}});b.then(function(){c.resolve(c)}).otherwise(function(a){c.ioArgs.error=a;c.reject(a)});return c},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(a,b){b=d._ioSetArgs(a,b||this._deferredCancel,this._deferredOk,this._deferredError);var c=b.ioArgs;c.id=h._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);c.canDelete=!1;c.jsonp=a.callbackParamName||a.jsonp;c.jsonp&&(c.query=c.query||"",0<c.query.length&&(c.query+="\x26"),c.query+=c.jsonp+"\x3d"+(a.frameDoc?
"parent.":"")+h._scopeName+".io.script.jsonp_"+c.id+"._jsonpCallback",c.frameDoc=a.frameDoc,c.canDelete=!0,b._jsonpCallback=this._jsonpCallback,this["jsonp_"+c.id]=b);b.addBoth(function(a){c.canDelete&&(a instanceof Error?m["jsonp_"+c.id]._jsonpCallback=function(){delete m["jsonp_"+c.id];if(c.requestId)h.global[g._callbacksProperty][c.requestId]()}:m._addDeadScript(c))});return b},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,
b){return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){m._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=m._deadScripts)&&0<a.length){for(var b=0;b<a.length;b++)m.remove(a[b].id,a[b].frameDoc),delete m["jsonp_"+a[b].id],a[b].frameDoc=null;m._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},_resHandle:function(a){m._ioCheck(a)?
a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)h.global[g._callbacksProperty][this.ioArgs.requestId](a)}};k.setObject("dojo.io.script",m);return m})},"dojox/widget/Rotator":function(){define("dojo/aspect dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/topic dojo/on dojo/parser dojo/query dojo/fx/easing dojo/NodeList-dom".split(" "),
function(b,h,k,a,c,d,e,f,g,l,m,n,q,t,p){h=h("dojox.widget.Rotator",null,{transition:"dojox.widget.rotator.swap",transitionParams:"duration:500",panes:null,constructor:function(b,d){a.mixin(this,b);var f=this;b=f.transition;var k=f._transitions={};f._idMap={};var h=f.transitionParams=eval("({ "+f.transitionParams+" })");d=f._domNode=e.byId(d);f._domNodeContentBox=l.getContentBox(d);f.id=d.id||(new Date).getTime();"static"==m.get(d,"position")&&m.set(d,"position","relative");k[b]=a.getObject(b);k[b]||
(this._transitionWarn(b,"dojox.widget.rotator.swap"),k[f.transition="dojox.widget.rotator.swap"]=a.getObject("dojox.widget.rotator.swap"));h.duration||(h.duration=500);c.forEach(f.panes,function(a){g.create("div",a,d)});f.panes=[];p("\x3e *",d).forEach(function(a,b){f._initializePane(a,b)});f._controlSub=n.subscribe(f.id+"/rotator/control",a.hitch(f,this.control))},insert:function(a,b){var c;c=this.panes;null==b&&(b=c.length);b<c.length?(c=c[b],g.place(a,c.node,"before")):g.place(a,this._domNode,
"last");this._initializePane(a,b)},remove:function(a){function b(a){var b=e.splice(a,1)[0];b&&(b.id&&(d._idMap[b.id]=void 0),d._domNode.removeChild(b.node));d.idx>a&&d.idx--}var c,d=this,e=this.panes;if("number"===typeof a)c=a;else{for(var f=0;f<e.length;f++)if(e[f].node===a){c=f;break}if(null==c)return}if(c===this.idx&&(a=this.go(this.idx-1)))return a.then(function(){b(c)});b(c)},destroy:function(){c.forEach([this._controlSub,this.wfe],function(a){a&&a.remove()});g.destroy(this._domNode);this.panes=
[]},next:function(){return this.go(this.idx+1)},prev:function(){return this.go(this.idx-1)},go:function(c){var d=this,e=d.idx,f=d.panes,g=f.length,h=d._idMap[c];d._resetWaitForEvent();c=null!=h?h:c||0;c=c<g?0>c?g-1:c:0;if(c==e||d.anim)return null;var l=f[e],p=f[c];m.set(l.node,"zIndex",2);m.set(p.node,"zIndex",1);var t={current:l,next:p,rotator:d};if(e=d.anim=d._transitions[p.trans](a.mixin({rotatorBox:d._domNodeContentBox},t,p.params))){var q=new k,u=p.waitForEvent,J=b.after(e,"onEnd",function(){m.set(l.node,
{display:"none",left:0,opacity:1,top:0,zIndex:0});J.remove();d.anim=null;d.idx=c;if(l.onAfterOut)l.onAfterOut(t);if(p.onAfterIn)p.onAfterIn(t);d.onUpdate("onAfterTransition");u||(d._resetWaitForEvent(),q.callback())},!0);d.wfe=u?n.subscribe(u,function(){d._resetWaitForEvent();q.callback(!0)}):null;d.onUpdate("onBeforeTransition");if(l.onBeforeOut)l.onBeforeOut(t);if(p.onBeforeIn)p.onBeforeIn(t);e.play();return q}},onUpdate:function(a,b){n.publish(this.id+"/rotator/update",a,this,b||{})},_initializePane:function(b,
d){var e={node:b,idx:d,params:a.mixin({},this.transitionParams,eval("({ "+(f.get(b,"transitionParams")||"")+" })"))},g=e.trans=f.get(b,"transition")||this.transition,k=this._transitions,h=this.panes,l={left:0,top:0,position:"absolute",display:"none"};c.forEach(["id","title","duration","waitForEvent"],function(a){e[a]=f.get(b,a)});e.id&&(this._idMap[e.id]=d);k[g]||(k[g]=a.getObject(g))||this._transitionWarn(g,e.trans=this.transition);if(null==this.idx||f.get(b,"selected"))null!=this.idx&&m.set(h[this.idx].node,
"display","none"),this.idx=d,l.display="";m.set(b,l);p("\x3e script[type^\x3d'dojo/method']",b).orphan().forEach(function(a){var b=f.get(a,"event");b&&(e[b]=t._functionFromScript(a))});h.splice(d,0,e)},_resetWaitForEvent:function(){this.wfe&&(this.wfe.remove(),delete this.wfe)},control:function(b){var c=a._toArray(arguments),d=this;c.shift();d._resetWaitForEvent();d[b]&&((c=d[b].apply(d,c))&&c.addCallback(function(){d.onUpdate(b)}),d.onManualChange(b))},resize:function(a,b){var d=this._domNodeContentBox=
{w:a,h:b};l.setContentSize(this._domNode,d);c.forEach(this.panes,function(a){l.setContentSize(a.node,d)})},onManualChange:function(){},_transitionWarn:function(a,b){}});a.setObject("dojox.widget.rotator.swap",function(a){return new d.Animation({play:function(){m.set(a.current.node,"display","none");m.set(a.next.node,"display","");this._fire("onEnd")}})});return h})},"dojo/fx/easing":function(){define(["../_base/lang"],function(b){var h={linear:function(b){return b},quadIn:function(b){return Math.pow(b,
2)},quadOut:function(b){return b*(b-2)*-1},quadInOut:function(b){b*=2;return 1>b?Math.pow(b,2)/2:-1*(--b*(b-2)-1)/2},cubicIn:function(b){return Math.pow(b,3)},cubicOut:function(b){return Math.pow(b-1,3)+1},cubicInOut:function(b){b*=2;return 1>b?Math.pow(b,3)/2:(Math.pow(b-2,3)+2)/2},quartIn:function(b){return Math.pow(b,4)},quartOut:function(b){return-1*(Math.pow(b-1,4)-1)},quartInOut:function(b){b*=2;return 1>b?Math.pow(b,4)/2:-.5*(Math.pow(b-2,4)-2)},quintIn:function(b){return Math.pow(b,5)},quintOut:function(b){return Math.pow(b-
1,5)+1},quintInOut:function(b){b*=2;return 1>b?Math.pow(b,5)/2:(Math.pow(b-2,5)+2)/2},sineIn:function(b){return-1*Math.cos(Math.PI/2*b)+1},sineOut:function(b){return Math.sin(Math.PI/2*b)},sineInOut:function(b){return-1*(Math.cos(Math.PI*b)-1)/2},expoIn:function(b){return 0==b?0:Math.pow(2,10*(b-1))},expoOut:function(b){return 1==b?1:-1*Math.pow(2,-10*b)+1},expoInOut:function(b){if(0==b)return 0;if(1==b)return 1;b*=2;if(1>b)return Math.pow(2,10*(b-1))/2;--b;return(-1*Math.pow(2,-10*b)+2)/2},circIn:function(b){return-1*
(Math.sqrt(1-Math.pow(b,2))-1)},circOut:function(b){return Math.sqrt(1-Math.pow(b-1,2))},circInOut:function(b){b*=2;return 1>b?-.5*(Math.sqrt(1-Math.pow(b,2))-1):.5*(Math.sqrt(1-Math.pow(b-2,2))+1)},backIn:function(b){return Math.pow(b,2)*(2.70158*b-1.70158)},backOut:function(b){--b;return Math.pow(b,2)*(2.70158*b+1.70158)+1},backInOut:function(b){b*=2;if(1>b)return Math.pow(b,2)*(3.5949095*b-2.5949095)/2;b-=2;return(Math.pow(b,2)*(3.5949095*b+2.5949095)+2)/2},elasticIn:function(b){if(0==b||1==b)return b;
--b;return-1*Math.pow(2,10*b)*Math.sin(2*(b-.075)*Math.PI/.3)},elasticOut:function(b){return 0==b||1==b?b:Math.pow(2,-10*b)*Math.sin(2*(b-.075)*Math.PI/.3)+1},elasticInOut:function(b){if(0==b)return 0;b*=2;if(2==b)return 1;var a=.3*1.5,c=a/4;if(1>b)return--b,-.5*Math.pow(2,10*b)*Math.sin(2*(b-c)*Math.PI/a);--b;return.5*Math.pow(2,-10*b)*Math.sin(2*(b-c)*Math.PI/a)+1},bounceIn:function(b){return 1-h.bounceOut(1-b)},bounceOut:function(b){return b<1/2.75?7.5625*Math.pow(b,2):b<2/2.75?7.5625*Math.pow(b-
1.5/2.75,2)+.75:b<2.5/2.75?7.5625*Math.pow(b-2.25/2.75,2)+.9375:7.5625*Math.pow(b-2.625/2.75,2)+.984375},bounceInOut:function(b){return.5>b?h.bounceIn(2*b)/2:h.bounceOut(2*b-1)/2+.5}};b.setObject("dojo.fx.easing",h);return h})},"dojox/widget/AutoRotator":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on dojo/mouse dojox/widget/Rotator".split(" "),function(b,h,k,a,c,d){return b("dojox.widget.AutoRotator",d,{suspendOnHover:!1,duration:4E3,autoStart:!0,pauseOnManualChange:!1,
cycles:-1,random:!1,reverse:!1,constructor:function(){var b=this;b.cycles-0==b.cycles&&0<b.cycles?b.cycles++:b.cycles=b.cycles?-1:0;b._signals=[a(b._domNode,c.enter,function(){if(b.suspendOnHover&&!b.anim&&!b.wfe){var a=b._endTime,c=b._now();b._suspended=!0;b._resetTimer();b._resumeDuration=a>c?a-c:.01}}),a(b._domNode,c.leave,function(){b.suspendOnHover&&!b.anim&&(b._suspended=!1,b.playing&&!b.wfe&&b.play(!0))})];b.autoStart&&1<b.panes.length?b.play():b.pause()},destroy:function(){h.forEach(this._signals,
function(a){a.remove()});delete this._signals;dojo.forEach(this._connects,dojo.disconnect);this.inherited(arguments)},play:function(a,b){this.playing=!0;this._resetTimer();!0!==a&&0<this.cycles&&this.cycles--;0==this.cycles?this.pause():this._suspended||(this.onUpdate("play"),b?this._cycle():(a=(this._resumeDuration||0)-0,a=(0<a?a:this.panes[this.idx].duration||this.duration)-0,this._resumeDuration=0,this._endTime=this._now()+a,this._timer=setTimeout(k.hitch(this,"_cycle",!1),a)))},pause:function(){this.playing=
this._suspended=!1;this.cycles=-1;this._resetTimer();this.onUpdate("pause")},_now:function(){return(new Date).getTime()},_resetTimer:function(){clearTimeout(this._timer)},_cycle:function(a){var b=this;a=b.idx;var c;if(b.random){do c=Math.floor(Math.random()*b.panes.length+1);while(c==a)}else c=a+(b.reverse?-1:1);(a=b.go(c))&&a.addCallback(function(a){b.onUpdate("cycle");b.playing&&b.play(!1,a)})},onManualChange:function(a){this.cycles=-1;"play"!=a&&(this._resetTimer(),this.pauseOnManualChange&&this.pause());
this.playing&&this.play()}})})},"dojox/widget/rotator/Controller":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/event dojo/_base/array dojo/_base/connect dojo/query".split(" "),function(b,h,k,a,c,d,e){return b("dojox.widget.rotator.Controller",null,{rotator:null,commands:"prev,play/pause,info,next",constructor:function(b,g){h.mixin(this,b);var f=this.rotator;if(f){for(;g.firstChild;)g.removeChild(g.firstChild);var m=this._domNode=k.create("ul",null,g),n=function(b,
c,d){k.create("li",{className:c,innerHTML:'\x3ca href\x3d"#"\x3e\x3cspan\x3e'+b+"\x3c/span\x3e\x3c/a\x3e",onclick:function(b){a.stop(b);f&&f.control.apply(f,d)}},m)};c.forEach(this.commands.split(","),function(a,b){switch(a){case "prev":n("Prev","dojoxRotatorPrev dojoxRotatorIcon",["prev"]);break;case "play/pause":n("Play","dojoxRotatorPlay dojoxRotatorIcon",["play"]);n("Pause","dojoxRotatorPause dojoxRotatorIcon",["pause"]);break;case "info":this._info=k.create("li",{className:"dojoxRotatorInfo",
innerHTML:this._buildInfo(f)},m);break;case "next":n("Next","dojoxRotatorNext dojoxRotatorIcon",["next"]);break;case "#":case "titles":for(b=0;b<f.panes.length;b++)n("#"==a?b+1:f.panes[b].title||"Tab "+(b+1),("#"==a?"dojoxRotatorNumber":"dojoxRotatorTab")+" "+(b==f.idx?"dojoxRotatorSelected":"")+" dojoxRotatorPane"+b,["go",b])}},this);e("li:first-child",m).addClass("dojoxRotatorFirst");e("li:last-child",m).addClass("dojoxRotatorLast");this._togglePlay();this._con=d.connect(f,"onUpdate",this,"_onUpdate")}},
destroy:function(){d.disconnect(this._con);k.destroy(this._domNode)},_togglePlay:function(a){a=this.rotator.playing;e(".dojoxRotatorPlay",this._domNode).style("display",a?"none":"");e(".dojoxRotatorPause",this._domNode).style("display",a?"":"none")},_buildInfo:function(a){return"\x3cspan\x3e"+(a.idx+1)+" / "+a.panes.length+"\x3c/span\x3e"},_onUpdate:function(a){var b=this.rotator;switch(a){case "play":case "pause":this._togglePlay();break;case "onAfterTransition":this._info&&(this._info.innerHTML=
this._buildInfo(b)),a=function(a){b.idx<a.length&&k.addClass(a[b.idx],"dojoxRotatorSelected")},a(e(".dojoxRotatorNumber",this._domNode).removeClass("dojoxRotatorSelected")),a(e(".dojoxRotatorTab",this._domNode).removeClass("dojoxRotatorSelected"))}}})})},"dojox/widget/rotator/Fade":function(){define(["dojo/_base/lang","dojo/_base/fx","dojo/dom-style","dojo/fx"],function(b,h,k,a){function c(c,d){var e=c.next.node;k.set(e,{display:"",opacity:0});c.node=c.current.node;return a[d]([h.fadeOut(c),h.fadeIn(b.mixin(c,
{node:e}))])}var d={fade:function(a){return c(a,"chain")},crossFade:function(a){return c(a,"combine")}};b.mixin(b.getObject("dojox.widget.rotator"),d);return d})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(b,h,k,a,c,d,e,f,g,l,m){k.isAsync||l(0,function(){m(["./fx/Toggler"])});k=k.fx={};l={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var n=function(b){this._index=
-1;this._animations=b||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;a.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};n.prototype=new h;b.extend(n,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=
this._animations[++this._index],this._onAnimateCtx=c.after(this._current,"onAnimate",b.hitch(this,"_onAnimate"),!0),this._onEndCtx=c.after(this._current,"onEnd",b.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,d){this._current||(this._current=this._animations[this._index=0]);if(!d&&"playing"==this._current.status())return this;var e=c.after(this._current,"beforeBegin",b.hitch(this,function(){this._fire("beforeBegin")}),!0),f=c.after(this._current,"onBegin",b.hitch(this,function(a){this._fire("onBegin",
arguments)}),!0),g=c.after(this._current,"onPlay",b.hitch(this,function(a){this._fire("onPlay",arguments);e.remove();f.remove();g.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=c.after(this._current,"onAnimate",b.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=c.after(this._current,"onEnd",b.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=c.after(this._current,
"onPause",b.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(b,c){this.pause();var d=this.duration*b;this._current=null;a.some(this._animations,function(a,b){if(d<=a.duration)return this._current=a,this._index=b,!0;d-=a.duration;return!1},this);this._current&&this._current.gotoPercent(d/this._current.duration);c&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);
this._current=this._animations[this._index]}var d=c.after(this._current,"onStop",b.hitch(this,function(a){this._fire("onStop",arguments);d.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});b.extend(n,l);k.chain=function(a){return new n(b.isArray(a)?a:Array.prototype.slice.call(a,0))};var q=function(e){this._animations=
e||[];this._connects=[];this.duration=this._finished=0;a.forEach(e,function(a){var d=a.duration;a.delay&&(d+=a.delay);this.duration<d&&(this.duration=d);this._connects.push(c.after(a,"onEnd",b.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new d.Animation({curve:[0,1],duration:this.duration});var f=this;a.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){f._connects.push(c.after(f._pseudoAnimation,a,function(){f._fire(a,arguments)},!0))})};b.extend(q,
{_doAction:function(b,c){a.forEach(this._animations,function(a){a[b].apply(a,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var c=this._pseudoAnimation;c[a].apply(c,b)},play:function(a,b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(b,c){var d=this.duration*b;a.forEach(this._animations,
function(a){a.gotoPercent(a.duration<d?1:d/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();a.forEach(this._connects,function(a){a.remove()})}});b.extend(q,l);k.combine=function(a){return new q(b.isArray(a)?a:Array.prototype.slice.call(a,0))};k.wipeIn=function(a){var g=a.node=e.byId(a.node),h=g.style,k;a=
d.animateProperty(b.mixin({properties:{height:{start:function(){k=h.overflow;h.overflow="hidden";if("hidden"==h.visibility||"none"==h.display)return h.height="1px",h.display="",h.visibility="",1;var a=f.get(g,"height");return Math.max(a,1)},end:function(){return g.scrollHeight}}}},a));var l=function(){h.height="auto";h.overflow=k};c.after(a,"onStop",l,!0);c.after(a,"onEnd",l,!0);return a};k.wipeOut=function(a){var f=(a.node=e.byId(a.node)).style,g;a=d.animateProperty(b.mixin({properties:{height:{end:1}}},
a));c.after(a,"beforeBegin",function(){g=f.overflow;f.overflow="hidden";f.display=""},!0);var h=function(){f.overflow=g;f.height="auto";f.display="none"};c.after(a,"onStop",h,!0);c.after(a,"onEnd",h,!0);return a};k.slideTo=function(a){var h=null,k=null,l=function(a){return function(){var b=f.getComputedStyle(a),c=b.position;h="absolute"==c?a.offsetTop:parseInt(b.top)||0;k="absolute"==c?a.offsetLeft:parseInt(b.left)||0;"absolute"!=c&&"relative"!=c&&(b=g.position(a,!0),h=b.y,k=b.x,a.style.position=
"absolute",a.style.top=h+"px",a.style.left=k+"px")}}(a.node=e.byId(a.node));l();a=d.animateProperty(b.mixin({properties:{top:a.top||0,left:a.left||0}},a));c.after(a,"beforeBegin",l,!0);return a};return k})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),function(b,h,k,a,c,d,
e,f,g,l,m,n,q,t){a=h("dijit.layout._StackButton",t,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});h=h("dijit.layout.StackController",[m,n,q],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:a,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return l.byId(this.id+
"_"+a)},postCreate:function(){this.inherited(arguments);this.own(f.subscribe(this.containerId+"-startup",d.hitch(this,"onStartup")),f.subscribe(this.containerId+"-addChild",d.hitch(this,"onAddChild")),f.subscribe(this.containerId+"-removeChild",d.hitch(this,"onRemoveChild")),f.subscribe(this.containerId+"-selectChild",d.hitch(this,"onSelectChild")),f.subscribe(this.containerId+"-containerKeyDown",d.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(e(this.containerNode,"click",
d.hitch(this,function(a){var b=l.getEnclosingWidget(a.target);if(b!=this.containerNode&&!b.disabled&&b.page)for(a=a.target;a!==this.containerNode;a=a.parentNode)if(k.contains(a,this.buttonWidgetCloseClass)){this.onCloseButtonClick(b.page);break}else if(a==b.domNode){this.onButtonClick(b.page);break}})))},onStartup:function(a){this.textDir=a.textDir;b.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var c=l.byId(this.containerId).containerNode,f=d.hitch(this,"pane2button");
a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var g=function(a,b){return e(c,"attrmodified-"+a,function(a){var c=f(a.detail&&a.detail.widget&&a.detail.widget.id);c&&c.set(b,a.detail.newValue)})},h;for(h in a)this.own(g(h,a[h]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var c=new (d.isString(this.buttonWidget)?d.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(c,b);a.controlButton=c;if(!this._currentChild)this.onSelectChild(a);b=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+c.id:c.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",
b)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");l.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);
g.focus(b.focusNode);this._currentChild&&this._currentChild.id===a.id&&b.set("checked",!0);l.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){l.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&g.focus(a.focusNode||a.domNode)},adjacent:function(a){this.isLeftToRight()||this.tabPosition&&!/top|bottom/.test(this.tabPosition)||(a=!a);var c=this.getChildren(),d=b.indexOf(c,this.pane2button(this._currentChild.id)),e=c[d],f;do d=(d+
(a?1:c.length-1))%c.length,f=c[d];while(f.disabled&&f!=e);return f},onkeydown:function(a,b){if(!this.disabled&&!a.altKey&&(b=null,a.ctrlKey||!a._djpage)){switch(a.keyCode){case c.LEFT_ARROW:case c.UP_ARROW:a._djpage||(b=!1);break;case c.PAGE_UP:a.ctrlKey&&(b=!1);break;case c.RIGHT_ARROW:case c.DOWN_ARROW:a._djpage||(b=!0);break;case c.PAGE_DOWN:a.ctrlKey&&(b=!0);break;case c.HOME:for(var d=this.getChildren(),e=0;e<d.length;e++){var f=d[e];if(!f.disabled){this.onButtonClick(f.page);break}}a.stopPropagation();
a.preventDefault();break;case c.END:d=this.getChildren();for(e=d.length-1;0<=e;e--)if(f=d[e],!f.disabled){this.onButtonClick(f.page);break}a.stopPropagation();a.preventDefault();break;case c.DELETE:case 87:this._currentChild.closable&&(a.keyCode==c.DELETE||a.ctrlKey)&&(this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault());break;case c.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==b&&(this.onButtonClick(this.adjacent(b).page),
a.stopPropagation(),a.preventDefault())}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});h.StackButton=a;return h})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(b){return b._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(b,h,k,
a){var c=h("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(a){if(this._hash[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");this._hash[a.id]=a;this.length++},remove:function(a){this._hash[a]&&(delete this._hash[a],this.length--)},forEach:function(a,b){b=b||k.global;var c=0,d;for(d in this._hash)a.call(b,this._hash[d],c++,this._hash);return this},filter:function(a,b){b=b||k.global;var d=new c,e=0,h;for(h in this._hash){var m=
this._hash[h];a.call(b,m,e++,this._hash)&&d.add(m)}return d},byId:function(a){return this._hash[a]},byClass:function(a){var b=new c,d,g;for(d in this._hash)g=this._hash[d],g.declaredClass==a&&b.add(g);return b},toArray:function(){var a=[],b;for(b in this._hash)a.push(this._hash[b]);return a},map:function(a,c){return b.map(this.toArray(),a,c)},every:function(a,b){b=b||k.global;var c=0,d;for(d in this._hash)if(!a.call(b,this._hash[d],c++,this._hash))return!1;return!0},some:function(a,b){b=b||k.global;
var c=0,d;for(d in this._hash)if(a.call(b,this._hash[d],c++,this._hash))return!0;return!1}});b.forEach("forEach filter byClass map every some".split(" "),function(b){a[b]=c.prototype[b]});return c})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(b,h,k,a,c,d,e,f){d.focus=function(a){if(a){var b="node"in a?a.node:a,e=a.bookmark;a=a.openedForWindow;var g=e?e.isCollapsed:!1;if(b){var h="iframe"==
b.tagName.toLowerCase()?b.contentWindow:b;if(h&&h.focus)try{h.focus()}catch(t){}d._onFocusNode(b)}if(e&&c.withGlobal(a||c.global,f.isCollapsed)&&!g){a&&a.focus();try{c.withGlobal(a||c.global,f.moveToBookmark,null,[e])}catch(t){}}}};d.watch("curNode",function(b,c,d){f._curFocus=d;f._prevFocus=c;d&&a.publish("focusNode",d)});d.watch("activeStack",function(a,b,c){f._activeStack=c});d.on("widget-blur",function(b,c){a.publish("widgetBlur",b,c)});d.on("widget-focus",function(b,c){a.publish("widgetFocus",
b,c)});k.mixin(f,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return f.getBookmark().isCollapsed},getBookmark:function(){return(c.global==window?e:new e.SelectionManager(c.global)).getBookmark()},moveToBookmark:function(a){return(c.global==window?e:new e.SelectionManager(c.global)).moveToBookmark(a)},getFocus:function(a,b){a=!d.curNode||a&&h.isDescendant(d.curNode,a.domNode)?f._prevFocus:d.curNode;return{node:a,bookmark:a&&a==d.curNode&&c.withGlobal(b||c.global,f.getBookmark),openedForWindow:b}},
_activeStack:[],registerIframe:function(a){return d.registerIframe(a)},unregisterIframe:function(a){a&&a.remove()},registerWin:function(a,b){return d.registerWin(a,b)},unregisterWin:function(a){a&&a.remove()}});return f})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(b,h,k,a,c){var d={getViewport:function(){return k.getBox()}};d.placeOnScreen=a.at;d.placeOnScreenAroundElement=function(b,c,d,k){var e;if(h.isArray(d))e=d;else{e=
[];for(var f in d)e.push({aroundCorner:f,corner:d[f]})}return a.around(b,c,e,!0,k)};d.placeOnScreenAroundNode=d.placeOnScreenAroundElement;d.placeOnScreenAroundRectangle=d.placeOnScreenAroundElement;d.getPopupAroundAlignment=function(a,c){var d={};b.forEach(a,function(a){var b=c;switch(a){case "after":d[c?"BR":"BL"]=c?"BL":"BR";break;case "before":d[c?"BL":"BR"]=c?"BR":"BL";break;case "below-alt":b=!b;case "below":d[b?"BL":"BR"]=b?"TL":"TR";d[b?"BR":"BL"]=b?"TR":"TL";break;case "above-alt":b=!b;default:d[b?
"TL":"TR"]=b?"BL":"BR",d[b?"TR":"TL"]=b?"BR":"BL"}});return d};h.mixin(c,d);return c})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(b,h,k){var a=k._createWrapper;k._createWrapper=function(c){c.declaredClass||(c={_popupWrapper:c.parentNode&&b.contains(c.parentNode,"dijitPopup")?c.parentNode:null,domNode:c,destroy:function(){},ownerDocument:c.ownerDocument,ownerDocumentBody:h.body(c.ownerDocument)});return a.call(this,c)};var c=
k.open;k.open=function(a){if(a.orient&&"string"!=typeof a.orient&&!("length"in a.orient)){var b=[],d;for(d in a.orient)b.push({aroundCorner:d,corner:a.orient[d]});a.orient=b}return c.call(this,a)};return k})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(b,h){h.scrollIntoView=function(h,a){b.scrollIntoView(h,a)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr",
"dojo/_base/lang","../main","../hccss"],function(b,h,k){h.mixin(k,{hasWaiRole:function(a,b){a=this.getWaiRole(a);return b?-1<a.indexOf(b):0<a.length},getWaiRole:function(a){return h.trim((b.get(a,"role")||"").replace("wairole:",""))},setWaiRole:function(a,c){b.set(a,"role",c)},removeWaiRole:function(a,c){var d=b.get(a,"role");d&&(c?(c=h.trim((" "+d+" ").replace(" "+c+" "," ")),b.set(a,"role",c)):a.removeAttribute("role"))},hasWaiState:function(a,b){return a.hasAttribute?a.hasAttribute("aria-"+b):
!!a.getAttribute("aria-"+b)},getWaiState:function(a,b){return a.getAttribute("aria-"+b)||""},setWaiState:function(a,b,d){a.setAttribute("aria-"+b,d)},removeWaiState:function(a,b){a.removeAttribute("aria-"+b)}});return k})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(b,h){h.getDocumentWindow=function(h){return b.get(h)}})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),
function(b,h,k,a,c){return b("dijit.form.ComboButton",a,{templateString:c,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(a){a.keyCode==h[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(k.focus(this._popupStateNode),a.stopPropagation(),a.preventDefault())},_onArrowKeyDown:function(a){a.keyCode==
h[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]&&(k.focus(this.titleNode),a.stopPropagation(),a.preventDefault())},focus:function(a){this.disabled||k.focus("start"==a?this.titleNode:this._popupStateNode)}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(b,h,k){return b("dijit.form.RadioButton",[h,k],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(b,h,k,a,c,d){return h("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var b=[];c("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(a.hitch(this,function(a){a.name==this.name&&a.form==this.focusNode.form&&(a=d.getEnclosingWidget(a))&&b.push(a)}));return b},_setCheckedAttr:function(c){this.inherited(arguments);this._created&&c&&b.forEach(this._getRelatedWidgets(),a.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==
a?"on":a},_onClick:function(c){if(this.checked||this.disabled)return c.stopPropagation(),c.preventDefault(),!1;if(this.readOnly)return c.stopPropagation(),c.preventDefault(),b.forEach(this._getRelatedWidgets(),a.hitch(this,function(a){k.set(this.focusNode||this.domNode,"checked",a.checked)})),!1;var d=!1,e;b.some(this._getRelatedWidgets(),function(a){return a.checked?(e=a,!0):!1});this.checked=!0;e&&(e.checked=!1);if(!1===this.onClick(c)||c.defaultPrevented)d=!0;this.checked=!1;e&&(e.checked=!0);
d?c.preventDefault():this.set("checked",!0);return!d}})})},"dijit/PopupMenuItem":function(){define("dojo/_base/declare dojo/dom-style dojo/_base/lang dojo/query ./popup ./registry ./MenuItem ./hccss".split(" "),function(b,h,k,a,c,d,e){return b("dijit.PopupMenuItem",e,{baseClass:"dijitMenuItem dijitPopupMenuItem",_fillContent:function(){if(this.srcNodeRef){var b=a("*",this.srcNodeRef);this.inherited(arguments,[b[0]]);this.dropDownContainer=this.srcNodeRef}},_openPopup:function(a,b){var d=this.popup;
c.open(k.delegate(a,{popup:this.popup,around:this.domNode}));b&&d.focus&&d.focus()},_closePopup:function(){c.close(this.popup);this.popup.parentMenu=null},startup:function(){if(!this._started){this.inherited(arguments);if(!this.popup){var b=a("[widgetId]",this.dropDownContainer)[0];this.popup=d.byNode(b)}this.ownerDocumentBody.appendChild(this.popup.domNode);this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);this.popup.startup();this.popup.domNode.style.display="none";this.arrowWrapper&&
h.set(this.arrowWrapper,"visibility","");this.focusNode.setAttribute("aria-haspopup","true")}},destroyDescendants:function(a){this.popup&&(this.popup._destroyed||this.popup.destroyRecursive(a),delete this.popup);this.inherited(arguments)}})})},"arcgisonline/sharing/dijit/Gallery":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!arcgisonline/sharing/dijit/views,dijit/_Widget,dijit/_Templated,dojo/NodeList-fx,dijit/layout/ContentPane,arcgisonline/sharing/util,dijit/form/Button,arcgisonline/sharing/geow/QueryReadStore"],
function(b,h,k){b.provide("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.dijit.views");b.require("dijit._Widget");b.require("dijit._Templated");b.require("dojo.NodeList-fx");b.require("dijit.layout.ContentPane");b.require("arcgisonline.sharing.util");b.require("dijit.form.Button");b.requireLocalization("arcgisonline","arcgisonline");b.require("arcgisonline.sharing.geow.QueryReadStore");b.declare("arcgisonline.sharing.dijit.Gallery",[h._Widget,h._Templated],{widgetsInTemplate:!0,
templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"clearfix galleryBackground"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"flowContainer" class\x3d"clearfix"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"pageControls" class\x3d"esriFloatLeading" style\x3d"maxheight: 3em; width: 100%; clear: both;"\x3e\r\n      \x3cp style\x3d"text-align: center;"\x3e\r\n        \x3cspan dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_prev" style\x3d"display:none;"\x3e${i18n.previous}\x3c/span\x3e\r\n        \x3cspan dojoAttachPoint\x3d"_pages" dojoAttachEvent\x3d"onClick:goToPage" class\x3d"esriItemLinks esriPagingLinks"\x3e\x3c/span\x3e\r\n        \x3cspan dojoType\x3d"dijit.form.Button" dojoAttachPoint\x3d"_next" style\x3d"display:none;"\x3e${i18n.next}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
tooltip:null,showToolTip:!0,showNodeLabels:!0,showThumbnailInDetails:!0,fadeOutOtherNodes:!0,animFadeOut:!0,unfocusedOpacity:.5,highlightFocusedNode:!0,largeNodes:0,maxNodes:0,flowContainer:null,showDelay:300,nodesPerPage:4,currentPage:1,pageCount:1,maxPages:null,showPageControls:!0,_prev:null,_next:null,_pages:null,nodeClass:"galleryNode",nodeHighlightClass:"highlight",thumbClass:"galleryThumbnail",labelClass:"label",labelBgClass:"galleryLabelContainer",detailsClass:"galleryDetail",detailsThumbClass:"galleryDetailThumb",
messageClass:"galleryMessage",_lastFocusedNode:null,_timer:null,_galleryFadeIn:null,_galleryFadeOut:null,_galleryFadeOutTotal:null,_suspendTooltip:!1,includeNode:null,_defaultNoResultsMessage:null,noResultsMessage:null,items:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this.i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").gallery);this._defaultNoResultsMessage=this.i18n.filterNoResults},
postCreate:function(){this._userToken=(this._user=arcgisonline.sharing.util.getUser())&&this._user.token;null===this.tooltip&&(this.tooltip=new arcgisonline.sharing.dijit._GalleryContentPane({_gallery:this},b.create("div",{id:this.id+"_popup"},b.body())),this._galleryFadeIn=b.animateProperty({node:this.flowContainer,properties:{opacity:1}}),this._galleryFadeOut=b.animateProperty({node:this.flowContainer,properties:{opacity:this.unfocusedOpacity}}),this._galleryFadeOutTotal=b.animateProperty({node:this.flowContainer,
properties:{opacity:0}}),b.connect(this.domNode,"scroll",this,function(){this.tooltip&&this.tooltip.isShowing&&this.tooltip.hide()}),this.showPageControls&&(b.connect(this,"onContentChange",this,this._layoutPageControls),b.connect(this,"onPageChange",this,this._layoutPageControls)))},_showTooltip:function(a,c){var d=this.tooltip.domNode,e;esriGeowConfig.isRightToLeft||(e=this.showThumbnailInDetails?{TL:"TL",TR:"TR"}:{TL:"TR",TR:"TL"});esriGeowConfig.isRightToLeft&&(e=this.showThumbnailInDetails?{BR:"BR"}:
{BR:"TR"});e=h.placeOnScreenAroundNode(d,a,e);this.tooltip.set("content",this._buildItemDetailsLayout(c,e,a));if(this.showThumbnailInDetails){(a="none"==b.style(d,"display"))&&b.style(d,{visibility:"hidden",display:"block"});var f=b.contentBox(d),g=b.coords(d);a&&b.style(d,{visibility:"",display:"none"});"TR"==e.aroundCorner?(b.style(d,"top",g.t-f.t+"px"),b.style(d,"left",g.l+f.l+"px")):"TL"==e.aroundCorner&&(b.style(d,"top",g.t-f.t+"px"),b.style(d,"left",g.l-f.l+"px"))}this._highlightNode(c);this.tooltip.show()},
node_onMouseEnter:function(a){var c=a.currentTarget,d=this._getItemByNode(c);this.onNodeMouseEnter(a,d);!this._suspendTooltip&&this.showToolTip&&(this.tooltip.isShowing&&this.tooltip.hide(),this._timer&&(clearTimeout(this._timer),this._timer=null),this._unhighlightNodes(),this._timer||(this._timer=setTimeout(b.hitch(this,function(){this._showTooltip(c,d)}),this.showDelay)))},node_onMouseLeave:function(a){this._timer&&(clearTimeout(this._timer),this._timer=null);var b=this._getItemByNode(a.currentTarget);
this.onNodeMouseLeave(a,b)},tooltip_onMouseLeave:function(a){this._unhighlightNodes();this.tooltip.hide()},_highlightNode:function(a){a=b.byId("galleryNode_"+a.id);this.fadeOutOtherNodes&&(this.animFadeOut?(this._galleryFadeIn.stop(),this._galleryFadeOut.play()):b.style(this.flowContainer,"opacity",this.unfocusedOpacity));this.highlightFocusedNode&&b.addClass(a,this.nodeHighlightClass);this._lastFocusedNode=a},_unhighlightNodes:function(){this.fadeOutOtherNodes&&(this.animFadeOut?(this._galleryFadeOut.stop(),
this._galleryFadeIn.play()):b.style(this.flowContainer,"opacity",1));null!==this._lastFocusedNode&&b.removeClass(this._lastFocusedNode,this.nodeHighlightClass);this._lastFocusedNode=null},_loadItems:function(a){this.tooltip&&this.tooltip.hide();this._galleryFadeIn.stop();this._galleryFadeOut.stop();this._galleryFadeOutTotal.onEnd=b.hitch(this,function(a){b.empty(this.flowContainer);0<a.length?(this.maxNodes&&(a=a.splice(0,this.maxNodes)),b.forEach(a,b.hitch(this,function(a,b){a.id||(a.id=b);this.flowContainer.appendChild(this._buildNodeLayout(a,
b<this.largeNodes))})),b.create("br",{style:{clear:"both"}},this.flowContainer),a=b.query("."+this.nodeClass,this.domNode),a.connect("onmouseenter",this,this.node_onMouseEnter),a.connect("onmouseleave",this,this.node_onMouseLeave),this.tooltip&&b.connect(this.tooltip.domNode,"onmouseleave",this,this.tooltip_onMouseLeave)):b.create("span",{innerHTML:this.noResultsMessage||this._defaultNoResultsMessage,"class":this.messageClass},this.flowContainer);this._galleryFadeIn.play();this._galleryFadeOut.onEnd=
null;this._suspendTooltip=!1},a);this._galleryFadeOutTotal.play()},clear:function(a){this.tooltip&&this.tooltip.hide();this._galleryFadeIn.stop();this._galleryFadeOut.stop();b.empty(this.flowContainer);b.empty(this._pages);b.create("span",{innerHTML:a,"class":this.messageClass},this.flowContainer);this._galleryFadeIn.play();this._galleryFadeOut.onEnd=null;this._suspendTooltip=!1},_buildNodeLayout:function(a,c){var d=b.create("div",{id:"galleryNode_"+a.id,"class":this.nodeClass});b.addClass(d,c?"large":
"small");var e=arcgisonline.sharing.util;c=e.relativeToExplicitUrl("images/transparent.gif");"Web Mapping Application"==a.type&&(c=e.getStaticImagesUrl()+"/webapp.png");c="Mobile Application"==a.type?e.getStaticImagesUrl()+"/mobileapp.png":"Web Scene"===a.type||"Scene Service"===a.type?e.getStaticImagesUrl()+"/desktopapp.png":"Workforce Project"===a.type?e.getStaticImagesUrl()+"/workforceproject.png":"Hub Initiative"===a.type?e.getStaticImagesUrl()+"/hubinitiative.png":"Hub Page"===a.type?e.getStaticImagesUrl()+
"/hubpage.png":"Hub Site Application"===a.type?e.getStaticImagesUrl()+"/hubsite.png":"Dashboard"===a.type?e.getStaticImagesUrl()+"/opsdashboard.png":"Geoprocessing Service"===a.type&&esriGeowConfig.self&&esriGeowConfig.self.isPortal?e.getStaticImagesUrl()+"/webtool.png":"Ortho Mapping Project"===a.type?e.getStaticImagesUrl()+"/orthomappingproject.png":"Ortho Mapping Template"===a.type?e.getStaticImagesUrl()+"/orthomappingtemplate.png":e.getStaticImagesUrl()+"/desktopapp.png";e.getGalleryMainLinkInfo(a);
e=b.create("a",{href:"#"},d);b.connect(e,"onclick",this,this.onNodeClick,a);b.create("img",{"class":this.thumbClass,src:a.thumbnail?this._getThumbailUrl(a):c},e);this.showNodeLabels&&(c=b.create("div",{"class":"galleryLabelContainer"},d),a=a.title||"",b.create("span",{innerHTML:a,alt:a,title:a},c));return d},_buildItemDetailsLayout:function(a,b,d){return arcgisonline.sharing.dijit.views.item.medium(a,{showThumb:this.showThumbnailInDetails,align:(esriGeowConfig.isRightToLeft?0:"TR"==b.aroundCorner)?
"right":"left",hideOpenMenu:!0,showProfilePopup:!1})},_getItemByNode:function(a){for(;!b.hasClass(a,this.nodeClass);)a=a.parentNode;a=a.id.substr(a.id.indexOf("_")+1);for(var c=0;c<this.items.length;c++)if(this.items[c].id==a)return this.items[c];return null},_getThumbailUrl:function(a){var b=this._userToken;return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},_layoutPageControls:function(){b.empty(this._pages);if(1!==this.pageCount){for(var a=1;a<=this.pageCount;a++){var c=
b.create("span",{innerHTML:a},b.create("a",{onclick:b.hitch(this,this.goToPage,a)},this._pages));a==this.currentPage&&b.addClass(c,"currentPage")}1==this.currentPage?b.style(this._prev.domNode,"visibility","hidden"):b.style(this._prev.domNode,"visbility","");this.currentPage==this.pageCount?b.style(this._next.domNode,"visibility","hidden"):b.style(this._next.domNode,"visbility","")}},nextPage:function(){this.currentPage<this.pageCount&&this.goToPage(this.currentPage+1)},prevPage:function(){1<this.currentPage&&
this.goToPage(this.currentPage-1)},goToPage:function(a){0<this.pageCount&&!isNaN(a)&&0<a&&(this._suspendTooltip=!0,this._loadRange((a-1)*this.nodesPerPage,this.nodesPerPage),this.currentPage=a,this.onPageChange(this.currentPage,-1))},_loadRange:function(a,c){var d=b.clone(this.items);this._loadItems(d.splice(a,c))},_setItemsAttr:function(a){this.items=this.includeNode?b.filter(a,this.includeNode):a;0==this.items.length?(this.pageCount=1,this.onContentChange(0)):(this.pageCount=Math.ceil(this.items.length/
this.nodesPerPage),this.onContentChange(this.items.length));this.currentPage=1;this.goToPage(1)},onPageChange:function(a,b){},onContentChange:function(a){},onNodeClick:function(a,b){},onNodeMouseEnter:function(a,b){},onNodeMouseLeave:function(a,b){}});b.declare("arcgisonline.sharing.dijit._GalleryContentPane",h.layout.ContentPane,{_gallery:null,animateShowHide:!0,"class":"galleryPopup",fadeDuration:300,isShowing:!1,postCreate:function(){this.inherited(arguments);b.style(this.domNode,{position:"absolute",
top:"-1000px",opacity:0});b.style(this.domNode,esriGeowConfig.isRightToLeft||-1<b.indexOf(["ar","he"],b.locale)?"right":"left","-1000px");this.fadeIn=b.fadeIn({node:this.domNode,duration:this.fadeDuration});this.fadeOut=b.fadeOut({node:this.domNode,duration:this.fadeDuration,onEnd:b.hitch(this,"_afterFade")})},_afterFade:function(){b.style(this.domNode,{top:"-1000px"});b.style(this.domNode,esriGeowConfig.isRightToLeft?"right":"left","-1000px")},show:function(a){this.isShowing=!0;this.animateShowHide?
(this.fadeOut.stop(),this.fadeIn.play()):b.style(this.domNode,"display","block")},hide:function(){this.isShowing=!1;this.animateShowHide?(this.fadeIn.stop(),this.fadeOut.play()):b.style(this.domNode,"display","none")}})})},"arcgisonline/sharing/dijit/views":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/util,arcgisonline/sharing/dijit/ProfilePopup,arcgisonline/pages/pageUtil,arcgisonline/pages/item/_Info"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.views");
b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.ProfilePopup");b.require("arcgisonline.pages.pageUtil");b.require("arcgisonline.pages.item._Info");arcgisonline.sharing.dijit.views.item={detailClass:"itemDetail",thumbClass:"itemThumbnail",thumbContainerClass:"itemThumbnailContainer",titleClass:"esriItemTitle",snippetClass:"esriItemSnippet",i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline",
"arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);b.mixin(this._i18n,{source:b.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties.source});b.mixin(this._i18n,{visitOrganization:b.i18n.getLocalization("arcgisonline","arcgisonline").itemProperties.visitOrganization});return this._i18n},_util:arcgisonline.sharing.util,small:function(a,c,d){var e=b.create,f=e("div",{"class":this.detailClass+" small"}),g=this._util.getGalleryMainLinkInfo(a);
c&&(c=e("div",{"class":this.thumbContainerClass},f),b.addClass(f,d),e("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},e("a",{href:g.href||"#",target:g.target,alt:g.tip,title:g.tip},c)));e("a",{href:"#",innerHTML:a.title},e("span",{"class":this.titleClass},f));d=this._util.getSnippet(a.snippet,a.description);e("span",{"class":this.snippetClass,innerHTML:d},f);a=arcgisonline.sharing.geow.Content.changeTypename(a)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy+"\x3cspan class\x3d'esriItemOwner'\x3e"+
a.owner+"\x3c/span\x3e ("+this._util.toFullDateString(a.modified)+")";e("span",{innerHTML:a},f);return f},mediumFormat:function(a,b){return this.medium(b,!0,"left")},itemLinkInfo:function(a){var b=this._util.getGalleryMainLinkInfo(a);a=this._util.getItemDetailsLinkInfo(a);return{openLink:b,detailLink:a}},medium:function(a,c){var d=b.create,e=d("div",{"class":this.detailClass+" medium"});if(c.unshareHandler){var f=d("a",{href:"#",className:"unshare esriFloatTrailing",style:{display:"none"}},e);d("img",
{src:arcgisonline.sharing.util.relativeToExplicitUrl("images/delete_20x20.png"),alt:arcgisonline.sharing.dijit.views.item.i18n().removeItemFromGroup,title:arcgisonline.sharing.dijit.views.item.i18n().removeItemFromGroup},f);b.connect(f,"onclick",b.partial(c.unshareHandler,a.id,e))}var g=this.itemLinkInfo(a),f=g.openLink,g=g.detailLink;if(c.showThumb){var h=d("div",{"class":this.thumbContainerClass},e);b.addClass(e,c.align||"left");if(a.thumbnail&&0<a.thumbnail.length)var k=d("img",{src:this._getThumbnailUrl(a),
"class":this.thumbClass},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip},h));else k=this._util.relativeToExplicitUrl("images/web-thumbnail-error.png"),k="Web Mapping Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/webapp.png":"Mobile Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/mobileapp.png":"Workforce Project"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/workforceproject.png":"Hub Initiative"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+
"/hubinitiative.png":"Hub Page"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/hubpage.png":"Hub Site Application"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/hubsite.png":"Dashboard"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/opsdashboard.png":"Geoprocessing Service"===a.type&&esriGeowConfig.self&&esriGeowConfig.self.isPortal?arcgisonline.sharing.util.getStaticImagesUrl()+"/webtool.png":"Image"===a.type?arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/image-thumb.png"):
"Web Scene"===a.type||"Scene Service"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/scene.png":"Ortho Mapping Template"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/orthomappingtemplate.png":"Ortho Mapping Project"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/orthomappingproject.png":arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png",k=d("img",{src:k,"class":this.thumbClass},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip},h));f.onclick&&
b.connect(k,"onclick",f.onclick);d("br",null,h);h=d("span",{"class":"esriItemLinks"},h);k=this._util.getItemOpenLinkObjects(a);if(0<k.length){var n=d("span",{innerHTML:f.label},d("a",{href:f.href||"#",target:f.target,alt:f.tip,title:f.tip,style:{marginRight:0}},h));f.onclick&&b.connect(n,"onclick",f.onclick);c.hideOpenMenu||(d("span",{innerHTML:"\x26nbsp;"},h),f=d("div",{innerHTML:"","class":"dijitReset dijitInline esriArrows",title:arcgisonline.sharing.dijit.views.item.i18n().moreOptions,alt:arcgisonline.sharing.dijit.views.item.i18n().moreOptions,
style:{height:"11px",cursor:"pointer"}},h),new arcgisonline.sharing.dijit.TextMenu({triggerNode:f,labelNode:n,textMenuItems:k}));d("span",{innerHTML:"\x26nbsp;\x26nbsp\x26nbsp;"},h)}null!==g&&d("span",{innerHTML:g.label},d("a",{href:g.link||"#",alt:g.tip,title:g.tip,target:g.target?g.target:""},h))}f=d("div",{"class":"itemTextContainer"},e);d("a",{href:g.link,innerHTML:a.title,alt:g.tip,title:g.tip},d("span",{"class":this.titleClass},f));g=this._util.getSnippet(a.snippet,a.description);d("span",{"class":this.snippetClass,
innerHTML:g||""},f);g=d("div",null,f);(h=this._getTypeIcon(a))&&d("span",{innerHTML:h},g);h="";h=arcgisonline.sharing.geow.Content.changeTypename(a)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy;k=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?arcgisonline.sharing.dijit.views.item.i18n().source+" ":"";n="GeoJson"===a.type?"GeoJSON":a.type;n=-1<n.toLowerCase().indexOf("add in")?n.replace(/(add in)/ig,"Add-In"):n;d("span",{title:k+n,innerHTML:h,"class":"dim"},g);h=
d("span",{"class":"esriItemAuthor"},g);h=d("a",{innerHTML:a.owner,"class":"linkNoHref",owner:a.owner,alt:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile},h);c.showProfilePopup?(b.connect(h,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==d&&b.hitch(d,d.showProfile,c,a.currentTarget).call()}),b.attr(h,{"class":"linkNoHref",
owner:a.owner})):b.attr(h,"href",esriGeowConfig.baseUrl+"user.html?user\x3d"+a.owner);d("div",{innerHTML:"\x3cspan\x3e"+arcgisonline.sharing.dijit.views.item.i18n().lastModifiedTitle+"\x3c/span\x3e\x3cspan\x3e"+this._util.toFullDateString(a.modified)+"\x3c/span\x3e","class":"dim esriLastModified"},g);(c=arcgisonline.sharing.geow.Content._getPremiumItemNode(a))&&b.place(c,b.create("div",{className:"dim esriPremiumContent"},g,"last"));c=b.create("span",{"class":"dojoxRating dijitInline"});9>b.isIE&&
b.style(c,"zoom",0);g=b.create("ul",null,c);h=Math.round(a.avgRating);for(k=1;k<=h;k++)b.create("li",{"class":"dojoxRatingStar dijitInline dojoxRatingStarChecked"},g);for(;5>h;h++)b.create("li",{"class":"dojoxRatingStar dijitInline Hover"},g);a=this._getMsgRatings(a);d=d("span",{innerHTML:a,"class":"dim"},f);b.place(c,d,"first");return e},map:function(a,c){var d=b.create;c=c||d("div",{"class":this.detailClass+" medium"});if("public_authoritative"===a.contentStatus&&!a.orgSelf)if(esriGeowConfig.self.id&&
a.orgId===esriGeowConfig.self.id)a.orgSelf=esriGeowConfig.self;else return esri.request({url:location.protocol+"//"+esriGeowConfig.self.portalHostname+"/sharing/rest/portals/"+a.orgId+"?f\x3djson",callbackParamName:"callback",load:function(b,d){a.orgSelf=b;arcgisonline.sharing.dijit.views.item.map(a,c)},error:function(b,d){a.orgSelf={};arcgisonline.sharing.dijit.views.item.map(a,c)}}),c;var e=d("div",{"class":"itemTextContainer"},c),f=this._util.getSnippet(a.snippet,a.description);d("span",{"class":this.snippetClass,
innerHTML:f?this._util.htmlEncode(f):""},e);var f=d("span",null,e),g=this._getTypeIcon(a,!0);g&&d("span",{innerHTML:g},f);var g="",g=a.url&&-1<b.indexOf(a.typeKeywords,"Hosted Service")&&(arcgisonline.sharing.util.isHostedServiceItem(a)||arcgisonline.sharing.util.portalSupportsHostedServices())?arcgisonline.sharing.geow.Content.changeTypename(a,!0)+arcgisonline.sharing.dijit.views.item.i18n().startBracket+arcgisonline.sharing.dijit.views.item.i18n().hostedService+arcgisonline.sharing.dijit.views.item.i18n().endBracket+
arcgisonline.sharing.dijit.views.item.i18n().spaceBy:arcgisonline.sharing.geow.Content.changeTypename(a,!1)+arcgisonline.sharing.dijit.views.item.i18n().spaceBy,h=-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?arcgisonline.sharing.dijit.views.item.i18n().source+" ":"",k="GeoJson"===a.type?"GeoJSON":a.type,k=-1<k.toLowerCase().indexOf("add in")?k.replace(/(add in)/ig,"Add-In"):k;d("span",{title:h+k,innerHTML:g,"class":"dim"},f);g=d("span",{"class":"esriItemAuthor"},f);"public_authoritative"===
a.contentStatus&&a.orgSelf&&a.orgSelf.name?(g=d("a",{innerHTML:a.orgSelf.name,"class":"linkNoHref",owner:a.orgSelf.name,alt:arcgisonline.sharing.dijit.views.item.i18n().visitOrganization,title:arcgisonline.sharing.dijit.views.item.i18n().visitOrganization},g),b.connect(g,"onclick",this,function(b){arcgisonline.map.storage.saveMapInCookie(null,!1);a.orgSelf.urlKey?b=location.protocol+"//"+a.orgSelf.urlKey+"."+a.orgSelf.customBaseUrl+"/home/index.html":(b=location.protocol+"//"+a.orgSelf.portalHostname+
"/home/index.html","7443"===location.port&&(b=arcgisonline.sharing.util.getSecureUrl(baseUrl)));window.open(b)})):(g=d("a",{innerHTML:a.owner,"class":"linkNoHref",owner:a.owner,alt:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.item.i18n().viewUserprofile},g),b.connect(g,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==d&&(b.hitch(d,d.showProfile,c,
a.currentTarget).call(),b.style(d.domNode,"zIndex","10"))}));b.attr(g,{"class":"linkNoHref",owner:a.owner});d("div",{innerHTML:"\x3cbr/\x3e\x3cspan\x3e"+arcgisonline.sharing.dijit.views.item.i18n().lastModifiedTitle+"\x3c/span\x3e\x3cspan\x3e"+this._util.toFullDateString(a.modified)+"\x3c/span\x3e","class":"dim esriLastModified"},f);(g=arcgisonline.sharing.geow.Content._getPremiumItemNode(a))&&b.place(g,b.create("div",{className:"dim esriPremiumContent"},f,"last"));f=b.create("span",{"class":"dojoxRating dijitInline"});
9>b.isIE&&b.style(f,"zoom",0);g=b.create("ul",null,f);h=Math.round(a.avgRating);for(k=1;k<=h;k++)b.create("li",{"class":"dojoxRatingStar dijitInline dojoxRatingStarChecked"},g);for(;5>h;h++)b.create("li",{"class":"dojoxRatingStar dijitInline Hover"},g);g=this._getMsgRatings(a);d=d("span",{innerHTML:g,"class":"dim"},e);b.place(f,d,"first");return c},_getMsgRatings:function(a){var c="",c=1===a.numRatings?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().ratingMsg,{ratingcount:b.number.format(a.numRatings,
{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().ratingsMsg,{ratingcount:b.number.format(a.numRatings,{pattern:"#,###,###,##0"})}),c=1===a.numComments?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().commentMsg,{commentcount:b.number.format(a.numComments,{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().commentsMsg,{commentcount:b.number.format(a.numComments,{pattern:"#,###,###,##0"})}),
d=a.type,d=d?arcgisonline.pages.item._Info[d]||null:null,c=!d||"file"!==d.classification||arcgisonline.pages.pageUtil.includes(d.types,"is-views")||arcgisonline.pages.pageUtil.includes(d.types,"is-pdf")?1===a.numViews?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().viewMsg,{viewcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().viewsMsg,{viewcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):
1===a.numViews?c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().downloadMsg,{downloadcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})}):c+b.string.substitute(arcgisonline.sharing.dijit.views.item.i18n().downloadsMsg,{downloadcount:b.number.format(a.numViews,{pattern:"#,###,###,##0"})});return c=arcgisonline.sharing.dijit.views.item.i18n().startBracket+c+arcgisonline.sharing.dijit.views.item.i18n().endBracket},_getThumbnailUrl:function(a){var b=this._util.getToken(),b=
b?"?token\x3d"+b:"";if(a.thumbnail)return esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/"+a.thumbnail+b;b=this._util.relativeToExplicitUrl("images/web-thumbnail-error.png");return b="Web Mapping Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/webapp.png":"Mobile Application"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/mobileapp.png":"Workforce Project"==a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/workforceproject.png":"Geoprocessing Service"===
a.type&&esriGeowConfig.self&&esriGeowConfig.self.isPortal?arcgisonline.sharing.util.getStaticImagesUrl()+"/webtool.png":"Web Scene"==a.type||"Scene Service"===a.type?arcgisonline.sharing.util.getStaticImagesUrl()+"/scene.png":arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png"},_getTypeIcon:function(a,c){c=arcgisonline.sharing.geow.Content._getItemIconUrl(a,!0);var d=(-1<b.indexOf(a.typeKeywords,"ArcGIS Server")||"Feature Collection"==a.type?this.i18n().source+" ":"")+("GeoJson"===a.type?
"GeoJSON":a.type),e="";c&&("Web Scene"===d&&(d=-1<b.indexOf(a.typeKeywords,"ViewingMode-Local")?this.i18n().localWebScene:this.i18n().globalWebScene),e='\x3cimg src\x3d"'+c+'" alt\x3d"'+d+'" title\x3d"'+d+'" style\x3d"vertical-align:middle;"/\x3e\x26nbsp;');return e}};arcgisonline.sharing.dijit.views.group={_util:arcgisonline.sharing.util,detailClass:"itemDetail group",thumbClass:"groupThumbnail",thumbContainerClass:"itemThumbnailContainer",titleClass:"esriItemTitle",snippetClass:"esriItemSnippet",
i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);return this._i18n},_getThumbnailUrl:function(a){var b=this._util.getToken();return esriGeowConfig.restBaseUrl+"community/groups/"+a.id+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},small:function(a,c,d){var e=b.create,f=e("div",{"class":this.detailClass});b.addClass(f,"small");var g={target:"",href:"#"};
c&&(c=e("div",{"class":this.thumbContainerClass},f),b.addClass(f,d||"left"),a.thumbnail&&0<a.thumbnail.length?e("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},c):e("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},c));e("a",{href:g.href,target:g.target,innerHTML:a.title,alt:g.tip,title:g.tip},e("span",{"class":this.titleClass},f));d=this._util.getSnippet(a.snippet,a.description);e("span",{"class":this.snippetClass,innerHTML:d},f);d=e("span",
null,null);e("span",{innerHTML:"owned by ","class":"dim"},d);d=e("span",{"class":"esriItemAuthor"},d);e("a",{innerHTML:a.owner,href:""},d);return f},medium:function(a,c){var d=b.create,e=d("div",{"class":this.detailClass+" medium"}),f=esriGeowConfig.baseUrl+"group.html?id\x3d"+a.id;arcgisonline.sharing.dijit.views.group.i18n();arcgisonline.sharing.dijit.views.group.i18n();if(c.showThumb){var g=d("div",{"class":this.thumbContainerClass},e);b.addClass(e,c.align||"left");if(c.groupsUser){var h=this._util.getUser();
arcgisonline.sharing.geow.Community.getProfile(a.owner,b.hitch(this,function(b,c,e){c.code||c.message?d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):"public"===b.access||c.orgId&&c.orgId===h.accountId?a.thumbnail&&0<a.thumbnail.length?d("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},
d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),"class":this.thumbClass},
d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g))},a))}else a.thumbnail&&0<a.thumbnail.length?d("img",{src:this._getThumbnailUrl(a),"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)):d("img",{src:this._util.relativeToExplicitUrl("images/group-no-image.png"),
"class":this.thumbClass},d("a",{href:f||"#",alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},g)),d("br",null,g),b.place(this._util.getGroupLinks(a),g)}var k=d("div",{"class":"itemTextContainer"},e);d("a",{href:f,innerHTML:a.title,alt:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails,title:arcgisonline.sharing.dijit.views.group.i18n().viewGroupDetails},d("span",{"class":this.titleClass},k));var n=this._util.getSnippet(a.snippet,
a.description);d("span",{"class":this.snippetClass,innerHTML:n||""},k);k=d("span",null,k);d("span",{innerHTML:arcgisonline.sharing.dijit.views.group.i18n().createdBy,"class":"dim"},k);n=d("span",{"class":"esriItemAuthor"},k);n=d("a",{innerHTML:a.owner,alt:arcgisonline.sharing.dijit.views.group.i18n().viewUserprofile,title:arcgisonline.sharing.dijit.views.group.i18n().viewUserprofile},n);c.showProfilePopup?(b.connect(n,"onclick",this,function(a){var c=b.attr(a.currentTarget,"owner"),d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();
null!==d&&b.hitch(d,d.showProfile,c,a.currentTarget).call()}),b.attr(n,{"class":"linkNoHref",owner:a.owner})):b.attr(n,"href",esriGeowConfig.baseUrl+"user.html?user\x3d"+a.owner);c=a.created;d("span",{innerHTML:"\x26nbsp;"+arcgisonline.sharing.dijit.views.group.i18n().createdOn+"\x26nbsp;"+this._util.toFullDateString(c),"class":"dim"},k);return e}};arcgisonline.sharing.dijit.views.profile={_util:arcgisonline.sharing.util,detailClass:"itemDetail",thumbClass:"profileThumbnail",thumbContainerClass:"itemThumbnailContainer",
titleClass:"esriItemTitle esriProfilePopupTitle",snippetClass:"esriItemSnippet",noDescriptionText:"",i18n:function(){if(this._i18n)return this._i18n;this._i18n=b.i18n.getLocalization("arcgisonline","arcgisonline").common;b.mixin(this._i18n,b.i18n.getLocalization("arcgisonline","arcgisonline").viewsWidget);return this._i18n},_getThumbnailUrl:function(a){var b=this._util.getToken();return esriGeowConfig.restBaseUrl+"community/users/"+a.username+"/info/"+a.thumbnail+(b?"?token\x3d"+b:"")},medium:function(a,
c){arcgisonline.sharing.dijit.views.profile.noDescriptionText=arcgisonline.sharing.dijit.views.profile.i18n().userPersonalInfoMsg;arcgisonline.sharing.dijit.views.profile.memberNoDescriptionText=arcgisonline.sharing.dijit.views.profile.i18n().memberPersonalInfoMsg;var d=arcgisonline.sharing.util.getUser(),e=b.create,f=e("div",{"class":this.detailClass});b.addClass(f,"medium");e("div",{"class":this.titleClass,innerHTML:a.fullName||a.username},f);if(d&&d.accountId&&a.accountId&&a.role&&d.accountId==
a.accountId){var g="\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;";"account_publisher"===a.role?g+=arcgisonline.sharing.dijit.views.profile.i18n().publisher:"account_admin"===a.role?g+=arcgisonline.sharing.dijit.views.profile.i18n().administrator:"account_user"===a.role&&(g+=arcgisonline.sharing.dijit.views.profile.i18n().user);e("span",{innerHTML:g},e("strong",{},f))}c.showThumb&&(g=e("div",{"class":this.thumbContainerClass},f),b.addClass(f,c.align||"left"),a.thumbnail&&0<a.thumbnail.length?e("img",
{src:this._getThumbnailUrl(a),"class":this.thumbClass},g):e("img",{src:this._util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg"),"class":this.thumbClass,style:"width:150px; height:150px;"},g));c=e("div",{"class":this.snippetClass},e("span",{"class":"esriItemLinks"},f));var g=this._util.removeHTMLTags(a.description),h=d&&d.accountId&&a.orgId&&d.accountId===a.orgId?arcgisonline.sharing.dijit.views.profile.memberNoDescriptionText:arcgisonline.sharing.dijit.views.profile.noDescriptionText,
g=0<g.length?a.description:h,g=this._util.linkifyText(g);8>b.isIE&&(g="\x3cpre class\x3d'esriProfileDesc'\x3e"+g+"\x3c/pre\x3e");e("span",{innerHTML:g,style:"white-space:pre-wrap;"},c,"only");if("undefined"!==typeof isEmbedded&&isEmbedded)return f;c=e("div",{style:{clear:"both"},"class":"profileLinks esriItemLinks esriFloatTrailing left"},f);g=e("a",{tabIndex:0,href:esriGeowConfig.baseUrl+"user.html?user\x3d"+a.username,innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().profile},c,"last");
b.connect(g,"onclick",function(){-1<window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&arcgisonline.map.main.map&&arcgisonline.map.main.mapInitialized?arcgisonline.map.storage.saveMapInCookie(null,!0,null,null,b.hitch(this,function(){window.location=esriGeowConfig.baseUrl+"user.html?user\x3d"+a.username})):window.location=esriGeowConfig.baseUrl+"user.html?user\x3d"+a.username});this._util.relativeToExplicitUrl("js/arcgisonline/css/images/transparent.gif");-1<window.location.href.indexOf(esriGeowConfig.webmapViewerPath)&&
this._util.relativeToExplicitUrl("images/transparent.gif");var g=esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin(),k=(h=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom())&&esriGeowConfig.userRole.canViewUsers()&&esriGeowConfig.userRole.canViewOrgItems();d&&(d.username===a.username?e("a",{tabIndex:0,href:esriGeowConfig.baseUrl+"content.html",innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().manageItems},c,"last"):d.accountId&&d.role&&a.orgId&&a.role&&(g||h&&k)&&d.accountId===
a.orgId&&e("a",{tabIndex:0,href:esriGeowConfig.baseUrl+"content.html?user\x3d"+a.username,innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().manageItems},c,"last"));e("a",{tabIndex:0,href:esriGeowConfig.baseUrl+"search.html?q\x3downer:"+a.username+"\x26restrict\x3dfalse",innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().items},c,"last");e("a",{tabIndex:0,href:esriGeowConfig.baseUrl+"search.html?t\x3dgroups\x26q\x3downer:"+a.username+"\x26restrict\x3dfalse",innerHTML:arcgisonline.sharing.dijit.views.profile.i18n().groups},
c,"last");e("div",{style:{clear:"both",width:"100%"}},f);return f}}})},"arcgisonline/sharing/dijit/ProfilePopup":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/views,arcgisonline/sharing/geow/Community,dijit/layout/ContentPane,esri/Evented,dijit/_OnDijitClickMixin,dijit/a11y,dijit/a11yclick"],function(b,h,k){b.provide("arcgisonline.sharing.dijit.ProfilePopup");b.require("arcgisonline.sharing.dijit.views");b.require("arcgisonline.sharing.geow.Community");b.require("dijit.layout.ContentPane");
b.require("esri.Evented");b.require("dijit._OnDijitClickMixin");b.require("dijit.a11y");b.require("dijit.a11yclick");b.declare("arcgisonline.sharing.dijit.ProfilePopup",[h.layout.ContentPane,h._OnDijitClickMixin,esri.Evented],{"class":"profilePopup",_lastTrigger:null,_resizeConnect:null,_blurConnect:null,_profileContentPane:null,animateShowHide:!0,fadeDuration:300,onHide:function(){},onShow:function(){},statics:{cache:[],_instance:null,getInstance:function(){null===this._instance&&(this._instance=
new arcgisonline.sharing.dijit.ProfilePopup,this._instance.startup());return this._instance},showProfilePopup:function(a){var c=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance();null!==c&&c.showProfile(b.attr(a.currentTarget,"owner"),a.currentTarget)}},postCreate:function(){this.inherited(arguments);b.style(this.domNode,{position:"absolute",top:"-1000px",left:"-1000px",opacity:0});b.attr(this.domNode,"tabIndex",0);this.fadeIn=b.fadeIn({node:this.domNode,duration:this.fadeDuration,
onEnd:function(){h.focus(this.domNode)}});this.fadeOut=b.fadeOut({node:this.domNode,duration:this.fadeDuration,onEnd:b.hitch(this,"_afterFade")})},startup:function(){this.inherited(arguments);var a=b.create("div",{style:{position:"relative",top:0,left:0}},this.domNode);this._profileContentPane=new h.layout.ContentPane({style:{overflow:"hidden"}});this._profileContentPane.placeAt(a);a=b.create("span",{role:"button",tabIndex:0,"class":"dijitDialogCloseIcon",title:arcgisonline.sharing.dijit.views.profile.i18n().close,
style:{position:"absolute",top:"-5px"}},a);b.style(a,esriGeowConfig.isRightToLeft?{left:"-5px"}:{right:"-5px"});this.own(h.a11yclick(a,b.hitch(this,function(a){a.preventDefault();this.hide()})),b.connect(this.domNode,"onkeypress",b.hitch(this,"_tabFence")))},_getFocusItems:function(){var a=h.a11y._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem},_tabFence:function(a){if(a.keyCode==
b.keys.TAB){this._getFocusItems();var c=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):c==this._firstFocusItem&&a.shiftKey?(h.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):c!=this._lastFocusItem||a.shiftKey||(h.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else a.keyCode==b.keys.ESCAPE&&(this.hide(),a.stopPropagation(),a.preventDefault())},showProfile:function(a,c){this._lastTrigger=c;var d=arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a];
d&&null!==d?(this._profileContentPane.set("content",d),a=arcgisonline.sharing.dijit.views.profile.medium(d,{showThumb:!0,showProfilePopup:!0,align:"left"}),this._placeNextTo(a,c)):(arcgisonline.sharing.geow.Community.getProfile(a,b.hitch(this,this._handleGetProfile),b.hitch(this,this._handleGetProfile)),this._profileContentPane.set("content",b.create("span",{innerHTML:"loading..."})))},showProfileFromPopup:function(a,c){b.style(this.domNode,{zIndex:1E3,opacity:1});this.showProfile(a,c)},_handleGetProfile:function(a,
b){a&&(b=arcgisonline.sharing.dijit.views.profile.medium(a,{showThumb:!0,showProfilePopup:!0,align:"left"}),arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.cache[a.username]=a,this._placeNextTo(b,this._lastTrigger))},_placeNextTo:function(a,b){h.placeOnScreenAroundNode(this.domNode,b,esriGeowConfig.isRightToLeft?{BR:"TR",BL:"TL",TR:"BR",TL:"BL"}:{BL:"TL",BR:"TR",TL:"BL",TR:"BR"});this._profileContentPane.set("content",a);this.show()},_afterFade:function(){b.style(this.domNode,{top:"-1000px",
left:"-1000px"});this.onHide()},show:function(a){this.isShowing=!0;this.animateShowHide?(this.fadeOut.stop(),this.fadeIn.play()):(b.style(this.domNode,"display","block"),h.focus(this.domNode));this._clearConnects();this._resizeConnect=b.connect(window,"onresize",this,this.hide);this.onShow();h.focus(this.domNode)},hide:function(){this._clearConnects();this.animateShowHide?(this.fadeIn.stop(),this.fadeOut.play()):(b.style(this.domNode,"display","none"),this.onHide())},_clearConnects:function(){null!==
this._resizeConnect&&(b.disconnect(this._resizeConnect),this._resizeConnect=null);null!==this._blurConnect&&(b.disconnect(this._blurConnect),this._blurConnect=null)}})})},"arcgisonline/pages/item/_Info":function(){define(["dojo/_base/lang","../../sharing/util","../pageUtil","dojo/i18n!../../nls/arcgisonline"],function(b,h,k,a){return{"default":{privileges:[],openIn:[],types:["is-views"],attributes:[],classification:"file"},Unknown:{privileges:[],openIn:[],types:[],attributes:[],classification:"file"},
"Feature Service":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:"is-layer is-2d is-scene-2 is-feature is-data is-desktop".split(" "),classification:"layer",hasServiceInfo:!0},"Map Service":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-scene-2","is-tile","is-desktop"],classification:"layer",hasServiceInfo:!0},"Map Image Layer":{defaultOpenText:a.itemLinks.openMapViewer,
defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-scene-2","is-desktop","is-service"],classification:"layer",hasServiceInfo:!0},"Image Service":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-desktop","is-service","is-scene-2"],classification:"layer",hasServiceInfo:!0},"Scene Service":{defaultOpenText:a.itemLinks.openSceneViewer,defaultOpenIcon:"link-external",openIn:["sceneViewer"],
types:["is-3d","is-service"],classification:"layer",hasServiceInfo:!0},Table:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-table","is-data"],classification:"layer",hasServiceInfo:!0},"Feature Collection":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-featureCollection","is-data","is-publish","is-views"],classification:"layer"},"Route Layer":{defaultOpenText:a.itemLinks.openMapViewer,
defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-featureCollection","is-publish","is-views"],classification:"layer"},"Geocoding Service":{types:["is-service"],classification:"layer"},"Network Analysis Service":{types:["is-service"],classification:"layer"},"Globe Service":{types:["is-desktop"],classification:"layer",openLyr:!0},"Geoprocessing Service":{types:["is-desktop","is-service"],classification:"layer"},Tool:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",
openIn:["mapViewer"],types:["is-2d","is-desktop","is-service","is-tool"],classification:"layer",hasServiceInfo:!0},"Geodata Service":{types:["is-service"],classification:"layer"},"Geometry Service":{classification:"layer"},"Workflow Manager Service":{types:["is-service"],classification:"layer"},"Stream Service":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-service","is-streamLayer","is-scene-2"],classification:"layer",
hasServiceInfo:!0},WMS:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-desktop","is-scene-2"],classification:"layer"},WFS:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-2d","is-desktop"],classification:"layer"},WMTS:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer"],types:["is-2d","is-desktop","is-scene-2"],
classification:"layer"},KML:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-2d","is-download","is-desktop"],classification:"layer"},"Elevation Layer":{defaultOpenText:a.itemLinks.openSceneViewer,defaultOpenIcon:"link-external",openIn:["sceneViewer"],types:["is-3d"],classification:"layer",hasServiceInfo:!0},"Vector Tile Service":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","sceneViewer","viewStyle",
"downloadStyle"],types:["is-vectorTile","is-service","is-scene-2"],classification:"layer",hasServiceInfo:!0,hasViewStyle:!0},"Relational Database Connection":{classification:"layer"},Markup:{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer"],types:["is-featureCollection","is-views"],classification:"layer"},"Web Map":{defaultOpenText:a.itemLinks.openMapViewer,defaultOpenIcon:"link-external",openIn:["mapViewer","createPresentation","openPresentation"],types:["is-map",
"is-desktop"],classification:"map",openPkg:!0},"Web Scene":{defaultOpenText:a.itemLinks.openSceneViewer,defaultOpenIcon:"link-external",openIn:["sceneViewer"],types:["is-3d","is-scene"],classification:"map"},"3D Web Scene":{defaultOpenText:a.itemLinks.openSceneViewer,defaultOpenIcon:"link-external",openIn:["sceneViewer"],types:["is-3d"],classification:"map"},"Web Mapping Application":{defaultOpenText:a.itemLinks.viewApp,defaultOpenIcon:"link-external",openIn:["appViewer","configureApp","downloadAttachment"],
types:["is-app","is-web"],classification:"app",hasItemData:!0},"Hub Initiative":{defaultOpenText:a.itemLinks.viewApp,defaultOpenIcon:"link-external",openIn:["appViewer","configureApp"],types:["is-app","is-web"],classification:"app"},"Hub Site Application":{defaultOpenText:a.itemLinks.viewApp,defaultOpenIcon:"link-external",openIn:["appViewer","configureApp"],types:["is-app","is-web"],classification:"app"},"Hub Page":{defaultOpenText:a.itemLinks.viewApp,defaultOpenIcon:"link-external",openIn:["appViewer",
"configureApp"],types:["is-app","is-web"],classification:"app"},Application:{classification:"app",types:["is-app"]},"Mobile Application":{defaultOpenText:a.itemLinks.getApp,defaultOpenIcon:"link-external",openIn:["appViewer","downloadAttachment"],types:["is-mobile-app","is-mobile"],classification:"app"},"Desktop Application":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",openIn:["downloadAttachment"],types:["is-file","is-update","is-platform"],classification:"app"},"Native Application":{classification:"app"},
"Workforce Project":{defaultOpenText:a.itemLinks.openWorkforce,defaultOpenIcon:"link-external",openIn:["workforceViewer"],types:["is-workforceProject"],classification:"app",hasItemData:!0},Form:{defaultOpenText:a.itemLinks.openSurvey123,defaultOpenIcon:"link-external",openIn:["surveyViewer"],classification:"app"},"Insights Workbook":{defaultOpenText:a.itemLinks.openInsights,defaultOpenIcon:"link-external",openIn:["insightsViewer"],types:["is-insights"],classification:"app"},"Insights Page":{defaultOpenText:a.itemLinks.openInsights,
defaultOpenIcon:"link-external",openIn:["insightsViewer"],types:["is-insights","is-insightsPage"],classification:"app"},"Insights Model":{defaultOpenText:a.itemLinks.openInsights,defaultOpenIcon:"link-external",openIn:["insightsViewer"],types:["is-insights","is-insightsModel"],classification:"app"},"Insights Theme":{defaultOpenText:a.itemLinks.openInsights,defaultOpenIcon:"link-external",openIn:["insightsViewer"],types:["is-insights","is-insightsTheme"],classification:"app"},"Ortho Mapping Project":{defaultOpenText:a.itemLinks.openOrthoMaker,
defaultOpenIcon:"link-external",openIn:["orthoMaker"],types:["is-orthoMaker"],classification:"app"},Solution:{classification:"app"},Notebook:{defaultOpenText:a.itemLinks.openNotebook,defaultOpenIcon:"link-external",openIn:["notebookViewer"],types:["is-notebook","is-download"],classification:"notebook"},CSV:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-feature","is-documentUrl"],classification:"file"},Shapefile:{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-feature"],classification:"file"},"File Geodatabase":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-feature"],classification:"file"},GeoJSON:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-feature"],classification:"file"},"Service Definition":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",
types:["is-file","is-update","is-publish","is-feature","is-tile"],classification:"file"},"Tile Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-tile","is-desktop"],classification:"file",openPkg:!0},"Scene Layer Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-scene-package"],classification:"file"},"Vector Tile Package":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-vector-tile"],classification:"file",openPkg:!0},"Image Collection":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-publish","is-image-collection"],classification:"file"},Layout:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file",openData:!0},"Desktop Add In":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",
types:["is-file","is-desktop","is-update"],classification:"file",openData:!0},"ArcGIS Pro Add In":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Explorer Add In":{types:["is-explorer","is-update"],classification:"file"},"Operations Dashboard Add In":{types:["is-update","is-views"],classification:"file"},"Operations Dashboard Extension":{types:["is-views"],classification:"file"},"AppBuilder Extension":{types:["is-views"],classification:"file"},
"AppBuilder Widget Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file"],classification:"file"},"Windows Viewer Add In":{types:["is-file","is-desktop","is-update"],classification:"file",openData:!0},"ArcGIS Pro Configuration":{types:["is-file","is-update"],classification:"file"},"Globe Document":{types:["is-desktop","is-update"],classification:"file",openData:!0},"Map Document":{types:["is-desktop","is-update"],classification:"file",openData:!0},"Pro Map":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Published Map":{types:["is-desktop","is-update"],classification:"file",openData:!0},"Scene Document":{types:["is-desktop","is-update"],classification:"file",openData:!0},"CityEngine Web Scene":{defaultOpenText:a.itemLinks.viewApp,defaultOpenIcon:"link-external",openIn:["cityEngineViewer"],types:["is-city-engine","is-download","is-update"],classification:"file"},"Desktop Style":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",
types:["is-file","is-update"],classification:"file"},"Geoprocessing Sample":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Task File":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},Layer:{types:["is-update","is-desktop"],classification:"file",openData:!0},"Pro Layer":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-download","is-update"],
classification:"file"},Style:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Operation View":{defaultOpenText:a.itemLinks.openOperationViewUrl,defaultOpenIcon:"link-external",openIn:["operationsDashboardWeb","operationsDashboard","dashboard"],types:["is-operationView","is-views"],classification:"file"},Dashboard:{defaultOpenText:a.itemLinks.dashboardView,openIn:["dashboard"],types:["is-dashboard","is-views"],classification:"file"},
"Geoprocessing Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-desktop","is-update"],classification:"file",openPkg:!0},"Layer Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-desktop","is-update"],classification:"file",openData:!0},"Locator Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-desktop","is-update"],classification:"file",openPkg:!0},"Map Package":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-desktop","is-file","is-download","is-update"],classification:"file",openData:!0},"Mobile Basemap Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Windows Mobile Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Toolbox Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file",
"is-desktop","is-update"],classification:"file",openPkg:!0},"ArcPad Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Basemap Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Mobile Map Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Mobile Scene Package":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Project Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Rule Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Window Mobile Package":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Workflow Manager Package":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Desktop Application Template":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Native Application Template":{classification:"file"},"Native Application Installer":{types:["is-file","is-update"],classification:"file"},"Application Configuration":{classification:"file"},"Viewer Configuration":{classification:"file"},"Windows Viewer Configuration":{classification:"file"},
"Map Template":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Project Template":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Raster function template":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update","is-download"],classification:"file"},"Feature Collection Template":{classification:"file"},"Layer Template":{classification:"file"},
"Report Template":{classification:"file"},"Color Set":{classification:"file"},"Explorer Layer":{types:["is-explorer","is-update"],classification:"file"},"Explorer Map":{types:["is-explorer","is-update"],classification:"file"},"Symbol Set":{classification:"file"},"Document Link":{defaultOpenText:a.itemLinks.open,defaultOpenIcon:"link-external",openIn:["appViewer"],types:["is-link","is-documentUrl"],classification:"file"},PDF:{defaultOpenText:a.itemLinks.open,defaultOpenIcon:"link-external",types:["is-dataUrl",
"is-pdf","is-update","is-documentUrl"],classification:"file"},"CAD Drawing":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"CSV Collection":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},Image:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"KML Collection":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"Code Attachment":{types:["is-file","is-update"],classification:"file"},"Code Sample":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},"iWork Keynote":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"iWork Numbers":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"iWork Pages":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"Microsoft Excel":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:"is-publish is-feature is-dataUrl is-file is-update is-documentUrl".split(" "),classification:"file"},"Microsoft Powerpoint":{defaultOpenText:a.itemLinks.download,
defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"Microsoft Word":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"Visio Document":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-dataUrl","is-file","is-update","is-documentUrl"],classification:"file"},"Statistical Data Collection":{types:[],classification:"file"},
"360 VR Experience":{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file","is-update"],classification:"file"},netCDF:{defaultOpenText:a.itemLinks.download,defaultOpenIcon:"download",types:["is-file"],classification:"file"},getItemInfo:function(c){var d=this[c.displayName]?c.displayName:c.type,e=this[c.type];"GeoJson"===c.type&&(c.type="GeoJSON");var f=c.iconUrl&&c.iconUrl.split("/").pop();"featureshosted16.png"===f&&(f="features16.png");c.svgIconUrl16=f&&"js/arcgisonline/img/item-types/"+
f.replace("16.png","16.svg")||c.iconUrl;c.svgIconUrl32=f&&"js/arcgisonline/img/item-types/"+f.replace("16.png","32.svg")||c.iconUrl;this[c.displayName]&&(e=this[c.displayName]);"Layer"===c.type&&k.includes(c.typeKeywords,"lyrx")&&(e=this["Pro Layer"]);e=b.mixin({},this["default"],e||{});"Feature Collection"===c.type&&k.includes(c.typeKeywords,"Table")&&(e.types=k.filterOut(e.types,["is-data"]));"Feature Service"===c.type&&(e.types=k.filterOut(e.types,["is-data","is-layer"]));if("Operation View"===
c.type){var f=k.includes(c.typeKeywords,"V2"),g=k.includes(c.typeKeywords,"TabletLayout");f&&(e.types=k.filterOut(e.types,["is-operationView"]),e.types.push("is-operationView-V2"),e.openIn=[]);!f&&h.couldHaveArcGISDesktop()&&(e.types.push("is-windows"),e.defaultOpenText=a.itemLinks.openOperationViewDesktop,e.openIn=["operationsDashboard","dashboard"],g?e.openIn.push("operationsDashboardWeb"):e.types=["is-operationView","is-views","is-windows"]);h._isOperationsViewSupportedBrowser()?(g&&(e.types.push("is-browser"),
e.types.push("is-operationView-single")),c.isSupportedBrowser=!0):e.types=k.filterOut(e.types,["can-create-dashboard"]);f||h.couldHaveArcGISDesktop()||g||(e.defaultOpenText=a.itemLinks.viewDetails,e.types=k.filterOut(e.types,["is-operationView-single"]))}f="Desktop Add In;Layer Package;Map Package;Globe Document;Map Document;Published Map;Scene Document;Geoprocessing Package;Geoprocessing Service;Globe Service;Layer;Locator Package;Tile Package".split(";");h.couldHaveArcGISDesktop()&&-1<f.indexOf(d)&&
(e.defaultOpenText=a.itemLinks.openDesktop,e.defaultOpenIcon="link-external");"Dashboard"===c.type&&h._isOperationsViewSupportedBrowser(!0)&&(e.types.push("is-browser"),c.isSupportedBrowser=!0);"public"===c.access&&e.types.push("is-public");h.couldHaveArcGISDesktop()||(e.types=e.types.filter(function(a){return"is-desktop"!==a}));return e}}})},"dojo/NodeList-fx":function(){define(["./query","./_base/lang","./aspect","./_base/fx","./fx"],function(b,h,k,a,c){b=b.NodeList;h.extend(b,{_anim:function(a,
b,f){f=f||{};var d=c.combine(this.map(function(c){c={node:c};h.mixin(c,f);return a[b](c)}));return f.auto?d.play()&&this:d},wipeIn:function(a){return this._anim(c,"wipeIn",a)},wipeOut:function(a){return this._anim(c,"wipeOut",a)},slideTo:function(a){return this._anim(c,"slideTo",a)},fadeIn:function(b){return this._anim(a,"fadeIn",b)},fadeOut:function(b){return this._anim(a,"fadeOut",b)},animateProperty:function(b){return this._anim(a,"animateProperty",b)},anim:function(b,e,f,g,h){var d=c.combine(this.map(function(c){return a.animateProperty({node:c,
properties:b,duration:e||350,easing:f})}));g&&k.after(d,"onEnd",g,!0);return d.play(h||0)}});return b})},"arcgisonline/sharing/geow/QueryReadStore":function(){define(["dojo","dijit","dojox","dojo/require!dojox/data/QueryReadStore,arcgisonline/sharing/geow/Content"],function(b,h,k){b.provide("arcgisonline.sharing.geow.QueryReadStore");b.require("dojox.data.QueryReadStore");b.require("arcgisonline.sharing.geow.Content");b.declare("arcgisonline.sharing.geow.QueryReadStore",k.data.QueryReadStore,{_fetchItems:function(a,
c,d){var e=a.serverQuery||a.query||{};e.start=a.start||0;e.start++;a.count&&(e.num=a.count);arcgisonline.sharing.geow.Content.search(this.url,e,b.hitch(this,function(d){var f=d.total||-1;b.publish("gridCount",[d.total]);this.onResultCount(d.total);this._total=d.total;this._items=[];b.forEach(d.results,function(a,b){b=a.tags||a.keywords||[];var c=void 0==a.imageUrl?arcgisonline.sharing.geow.Content._getItemImageUrl(a):a.imageUrl,d=a.uploaded||a.created,e=void 0==a.extent?arcgisonline.sharing.geow.Community._getGroupTitleLink(a):
a.title,f=a.item||"",g="";a.snippet&&0<a.snippet.length&&"null"!=a.snippet?g=150<a.snippet.length?a.snippet.substring(0,150)+"...":a.snippet:a.description&&0<a.description.length&&"null"!=a.description&&(g=150<a.description.length?a.description.substring(0,150)+"...":a.description);a={id:a.id||"",owner:a.owner,title:e,description:a.description,snippet:g,snippetFull:a.snippet,tags:b.join?b.join(","):b,imageUrl:c,thumbnail:a.thumbnail,isInvitationOnly:a.isInvitationOnly,created:d,modified:a.modified,
itemType:a.itemType||"",typeKeywords:a.typeKeywords||"",type:a.type||"",extent:a.extent||"",item:f,numComments:a.numComments,numRatings:a.numRatings,avgRating:a.avgRating,numViews:a.numViews};this._items.push({i:a,r:this})},this);this._itemsByIdentity={};this._identifier="id";for(i=0;i<this._items.length;++i){d=this._items[i].i;var h=d.id;this._itemsByIdentity[h]||(this._itemsByIdentity[h]=d)}f=-1===f?this._items.length:f;c(this._items,a,f);this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2);
this._lastServerQuery=b.mixin({},e)}))},onResultCount:function(a){}})})},"dojox/data/QueryReadStore":function(){define(["dojo","dojox","dojo/data/util/sorter","dojo/string"],function(b,h){return b.declare("dojox.data.QueryReadStore",null,{url:"",requestMethod:"get",_className:"dojox.data.QueryReadStore",_items:[],_lastServerQuery:null,_numRows:-1,lastRequestHash:null,doClientPaging:!1,doClientSorting:!1,_itemsByIdentity:null,_identifier:null,_features:{"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0},
_labelAttr:"label",constructor:function(h){b.mixin(this,h)},getValue:function(h,a,c){this._assertIsItem(h);if(!b.isString(a))throw Error(this._className+".getValue(): Invalid attribute, string expected!");return!this.hasAttribute(h,a)&&c?c:h.i[a]},getValues:function(b,a){this._assertIsItem(b);var c=[];this.hasAttribute(b,a)&&c.push(b.i[a]);return c},getAttributes:function(b){this._assertIsItem(b);var a=[],c;for(c in b.i)a.push(c);return a},hasAttribute:function(b,a){return this.isItem(b)&&"undefined"!=
typeof b.i[a]},containsValue:function(b,a,c){b=this.getValues(b,a);a=b.length;for(var d=0;d<a;d++)if(b[d]==c)return!0;return!1},isItem:function(b){return b?"undefined"!=typeof b.r&&b.r==this:!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){this.isItemLoaded(b.item)},fetch:function(h){h=h||{};h.store||(h.store=this);var a=this;this._fetchItems(h,function(c,d,e){var f=d.abort||null,g=!1,h=d.start?d.start:0;0==a.doClientPaging&&(h=0);var k=d.count?h+d.count:c.length;d.abort=function(){g=
!0;f&&f.call(d)};var n=d.scope||b.global;d.store||(d.store=a);d.onBegin&&d.onBegin.call(n,e,d);d.sort&&a.doClientSorting&&c.sort(b.data.util.sorter.createSortFunction(d.sort,a));if(d.onItem)for(e=h;e<c.length&&e<k;++e){var q=c[e];g||d.onItem.call(n,q,d)}d.onComplete&&!g&&(e=null,d.onItem||(e=c.slice(h,k)),d.onComplete.call(n,e,d))},function(a,d){d.onError&&d.onError.call(d.scope||b.global,a,d)});return h},getFeatures:function(){return this._features},close:function(b){},getLabel:function(b){if(this._labelAttr&&
this.isItem(b))return this.getValue(b,this._labelAttr)},getLabelAttributes:function(b){return this._labelAttr?[this._labelAttr]:null},_xhrFetchHandler:function(h,a,c,d){h=this._filterResponse(h);h.label&&(this._labelAttr=h.label);d=h.numRows||-1;this._items=[];b.forEach(h.items,function(a){this._items.push({i:a,r:this})},this);h=h.identifier;this._itemsByIdentity={};if(h){this._identifier=h;var e;for(e=0;e<this._items.length;++e){var f=this._items[e].i,g=f[h];if(this._itemsByIdentity[g])throw Error(this._className+
":  The json data as specified by: ["+this.url+"] is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+g+"]");this._itemsByIdentity[g]=f}}else for(this._identifier=Number,e=0;e<this._items.length;++e)this._items[e].n=e;d=this._numRows=-1===d?this._items.length:d;c(this._items,a,d);this._numRows=d},_fetchItems:function(h,a,c){var d=h.serverQuery||h.query||{};this.doClientPaging||(d.start=h.start||0,h.count&&(d.count=h.count));if(!this.doClientSorting&&h.sort){var e=[];
b.forEach(h.sort,function(a){a&&a.attribute&&e.push((a.descending?"-":"")+a.attribute)});d.sort=e.join(",")}if(this.doClientPaging&&null!==this._lastServerQuery&&b.toJson(d)==b.toJson(this._lastServerQuery))this._numRows=-1===this._numRows?this._items.length:this._numRows,a(this._items,h,this._numRows);else{var f=("post"==this.requestMethod.toLowerCase()?b.xhrPost:b.xhrGet)({url:this.url,handleAs:"json-comment-optional",content:d,failOk:!0});h.abort=function(){f.cancel()};f.addCallback(b.hitch(this,
function(b){this._xhrFetchHandler(b,h,a,c)}));f.addErrback(function(a){c(a,h)});this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2);this._lastServerQuery=b.mixin({},d)}},_filterResponse:function(b){return b},_assertIsItem:function(b){if(!this.isItem(b))throw Error(this._className+": Invalid item argument.");},_assertIsAttribute:function(b){if("string"!==typeof b)throw Error(this._className+": Invalid attribute argument ('"+b+"').");},fetchItemByIdentity:function(h){if(this._itemsByIdentity){var a=
this._itemsByIdentity[h.identity];if(void 0!==a){h.onItem&&h.onItem.call(h.scope?h.scope:b.global,{i:a,r:this});return}}this._fetchItems({serverQuery:{id:h.identity}},function(a,d){d=h.scope?h.scope:b.global;try{var c=null;a&&1==a.length&&(c=a[0]);h.onItem&&h.onItem.call(d,c)}catch(f){h.onError&&h.onError.call(d,f)}},function(a,d){d=h.scope?h.scope:b.global;h.onError&&h.onError.call(d,a)})},getIdentity:function(b){var a=null;return a=this._identifier===Number?b.n:b.i[this._identifier]},getIdentityAttributes:function(b){return[this._identifier]}})})},
"dojo/dnd/AutoSource":function(){define(["../_base/declare","./Source"],function(b,h){return b("dojo.dnd.AutoSource",h,{constructor:function(){this.autoSync=!0}})})},"dojo/dnd/Target":function(){define(["../_base/declare","../dom-class","./Source"],function(b,h,k){return b("dojo.dnd.Target",k,{constructor:function(){this.isSource=!1;h.remove(this.node,"dojoDndSource")}})})},"dojo/fx/Toggler":function(){define(["../_base/lang","../_base/declare","../_base/fx","../aspect"],function(b,h,k,a){return h("dojo.fx.Toggler",
null,{node:null,showFunc:k.fadeIn,hideFunc:k.fadeOut,showDuration:200,hideDuration:200,constructor:function(c){b.mixin(this,c);this.node=c.node;this._showArgs=b.mixin({},c);this._showArgs.node=this.node;this._showArgs.duration=this.showDuration;this.showAnim=this.showFunc(this._showArgs);this._hideArgs=b.mixin({},c);this._hideArgs.node=this.node;this._hideArgs.duration=this.hideDuration;this.hideAnim=this.hideFunc(this._hideArgs);a.after(this.showAnim,"beforeBegin",b.hitch(this.hideAnim,"stop",!0),
!0);a.after(this.hideAnim,"beforeBegin",b.hitch(this.showAnim,"stop",!0),!0)},show:function(a){return this.showAnim.play(a||0)},hide:function(a){return this.hideAnim.play(a||0)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(b,h,k,a,c,d,e,f,g,l,m,n,q){b=b("dijit.TooltipDialog",
[f,m,l,g],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:n,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"keydown",c.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft",
"BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];h.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();e.focus(this._firstFocusItem)},
onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(b){if(b.keyCode==a.ESCAPE)this.defer("onCancel"),
b.stopPropagation(),b.preventDefault();else if(b.keyCode==a.TAB){var c=b.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(b.stopPropagation(),b.preventDefault()):c==this._firstFocusItem&&b.shiftKey?(e.focus(this._lastFocusItem),b.stopPropagation(),b.preventDefault()):c!=this._lastFocusItem||b.shiftKey?b.stopPropagation():(e.focus(this._firstFocusItem),b.stopPropagation(),b.preventDefault())}}});k("dojo-bidi")&&b.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&
this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return b})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(b,h,k,a,c,d){return b("dijit.MenuSeparator",
[k,a,c],{templateString:d,buildRendering:function(){this.inherited(arguments);h.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"arcgisonline/gallery":function(){define(["dojo","dijit","dojox","dojo/require!dojo/date/locale,esri/utils,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/util,arcgisonline/sharing/dijit/views,dojo/parser,dijit/_base,dijit/form/DropDownButton,dijit/form/ComboButton,dijit/form/ToggleButton,dijit/form/RadioButton,dijit/PopupMenuItem"],function(b,
h,k){b.provide("arcgisonline.gallery");b.require("dojo.date.locale");b.require("esri.utils");b.require("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.views");b.require("dojo.parser");b.require("dijit._base");b.require("dijit.form.DropDownButton");b.require("dijit.form.ComboButton");b.require("dijit.form.ToggleButton");b.require("dijit.form.RadioButton");b.require("dijit.PopupMenuItem")})},"xstyle/core/load-css":function(){define([],
function(){function b(b){if(a.createStyleSheet){var d=a.createStyleSheet();d.cssText=b;return d.owningElement}d=a.createElement("style");d.setAttribute("type","text/css");d.appendChild(a.createTextNode(b));c.insertBefore(d,c.firstChild);return d}function h(d,e,f){var g=k[d];if(g)return h=b(g),e(h);var h=a.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=d;var m=!f||!1!==f.wait;d=(d=navigator.userAgent.match(/AppleWebKit\/(\d+\.?\d*)/))&&+d[1];if(null===h.onload&&!(536>d))h.onload=
function(){h.onload=null;h.onerror=null;m&&e(h)},h.onerror=function(){m&&e(h)};else if(m)var n=setInterval(function(){h.style&&(clearInterval(n),e(h))},15);(c||a.getElementsByTagName("head")[0]).appendChild(h);m||e(h)}var k="undefined"==typeof _css_cache?{}:_css_cache,a=document,c=a.head;h.insertCss=b;return h})},"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\r\n\x3chtml\x3e\r\n\x3chead\x3e\r\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\r\n\r\n  \x3cscript\x3e\r\n    var dojoConfig \x3d {\r\n      async: true,\r\n      baseUrl: "../../../dojo/",\r\n      has: {\r\n        "csp-restrictions": true,\r\n        "dojo-preload-i18n-Api": false\r\n      }\r\n    };\r\n  \x3c/script\x3e\r\n  \x3c!--\r\n  This src is relative to this page and assumes dojo is a sibling to esri.\r\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\r\n  --\x3e\r\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\r\n\r\n  \x3cscript\x3e\r\n    function windowMessageHandler(event) {\r\n      window.removeEventListener("message", windowMessageHandler);\r\n\r\n      var port \x3d event.ports[0];\r\n\r\n      require([\r\n        "dojo/request/script"\r\n      ], function(script) {\r\n        port.postMessage("ready");\r\n\r\n        port.addEventListener("message", function(event) {\r\n          var data \x3d event.data;\r\n          script.get(data.url, data.options)\r\n              .then(function(response) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  response: response\r\n                });\r\n              })\r\n              .otherwise(function(error) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  isError: true,\r\n                  message: error.message\r\n                });\r\n              });\r\n        });\r\n        port.start();\r\n      });\r\n    }\r\n\r\n    window.addEventListener("message", windowMessageHandler);\r\n  \x3c/script\x3e\r\n\x3c/head\x3e\r\n\x3cbody\x3e\r\n\x3c/body\x3e\r\n\x3c/html\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/_Empty.html":'\x3cdiv class\x3d"text-center trailer-half"\x3e\r\n  \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"${width}"\x3e\x3cpath fill\x3d"#ccc" d\x3d"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"/\x3e\x3c/svg\x3e\r\n  \x3cp class\x3d"leader-0 font-size-1 avenir-regular"\x3e\r\n    \x3cspan\x3e${message}\x3c/span\x3e\r\n  \x3c/p\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/GeneralDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"general-dialog-${id}" class\x3d"general-dialog" title\x3d"${i18n.notificationDlgTitle}" role\x3d"alertdialog"\x3e\r\n    \x3cdiv id\x3d"general-dialog-content" class\x3d"general-dialog-content"\x3e\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing clearfix right"\x3e\r\n      \x3cbutton id\x3d"button_general-close" data-dojo-attach-event\x3d"onClick:onOkClick" class\x3d"jevent primary right" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.ok}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/actionBar.html":'\x3cdiv class\x3d"dijitDialogPaneActionBar esriAlignTrailing right clearfix" data-dojo-attach-point\x3d"actionBarNode"\x3e\r\n  \x3cspan class\x3d"busyMessage hide" data-dojo-attach-point\x3d"busyMessageSpan"\x3e\x3c/span\x3e\r\n  \x3cbutton class\x3d"calcite cancel right" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-attach-point\x3d"cancelButton" data-dojo-attach-event\x3d"click:onCancel"\x3e\x3c/button\x3e\r\n  \x3cbutton class\x3d"calcite primary right js-submit-button" data-dojo-type\x3d"dijit/form/Button" type\x3d"submit" data-dojo-attach-point\x3d"okButton"\x3e\x3c/button\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Alert/Alert.html":'\x3cdiv class\x3d"alert alert-${modifier} alert-fixed alert-fade-in-down leader-1 trailer-1 is-active"\x3e\r\n  \x3cimg src\x3d"js/arcgisonline/img/toast-icons/${icon}32.svg"  alt\x3d"${iconAltText}" class\x3d"padding-right-half alert-icon" width\x3d"32" height\x3d"32"\x3e\r\n  ${text}\r\n  \x3ca href\x3d"#" class\x3d"alert-close icon-ui-close icon-ui-flush js-alert-close" aria-label\x3d"${i18n.common.close}"\x3e\x3c/a\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_listContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:arcgisonline/sharing/dijit/templates/AppSwitcher.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"dropdown js-dropdown padding-right-half padding-left-half" data-dojo-attach-point\x3d"_dropdownWrapper"\x3e\r\n    \x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:_closeSecondaryDropdown" id\x3d"appSwitcherBtn" class\x3d"js-dropdown-toggle top-nav-link disabled-state hide" tabindex\x3d"-1" aria-haspopup\x3d"true" aria-expanded\x3d"false" data-modal\x3d"appSwitcher" data-dojo-attach-point\x3d"_appSwitcherBtn" title\x3d${_appsTitle} aria-label\x3d"App Switcher"\x3e\r\n\t\t\t\x3csvg height\x3d"24px" width\x3d"24px" class\x3d"app-switcher-svg" shape-rendering\x3d"crispEdges" \x3e\r\n\t\t\t\x3crect x\x3d"1" y\x3d"1" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"10" y\x3d"1" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"19" y\x3d"1" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"1" y\x3d"10" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"10" y\x3d"10" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"19" y\x3d"10" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"1" y\x3d"19" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"10" y\x3d"19" width\x3d"4" height\x3d"4"/\x3e\r\n\t\t\t\x3crect x\x3d"19" y\x3d"19" width\x3d"4" height\x3d"4"/\x3e\r\n\t\x3c/svg\x3e\r\n    \x3c/a\x3e\r\n    \x3c!-- dropdown content in nav --\x3e\r\n    \x3cnav class\x3d"dropdown-menu dropdown-right app-switcher-dropdown-menu" role\x3d"menu" data-dojo-attach-point\x3d\'_dropdownAppNav\'\x3e\r\n      \x3c!-- Go To Seetings Notification --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_displayGoToSettingsWarning" class\x3d"go-to-settings-warning hide js-prevent-dropdown__app-switcher"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"16" height\x3d"20" viewBox\x3d"0 0 32 32" class\x3d"warning-svg-icon js-prevent-dropdown__app-switcher"\x3e\x3cpath d\x3d"M28.764 30a2 2 0 0 0 1.789-2.894L17.791 1.579a2 2 0 0 0-3.578 0L1.447 27.106a1.997 1.997 0 0 0 .088 1.945c.363.59 1.008.949 1.701.949h25.527zM3.236 28L16.002 2.473 28.764 28H3.237zM14 11.2a1.2 1.2 0 0 1 1.2-1.2h1.6a1.2 1.2 0 0 1 1.2 1.2v7.6a1.2 1.2 0 0 1-1.2 1.2h-1.6a1.2 1.2 0 0 1-1.2-1.2v-7.6zm4 13.601A1.2 1.2 0 0 1 16.801 26h-1.602A1.2 1.2 0 0 1 14 24.801v-1.602A1.2 1.2 0 0 1 15.199 22h1.602A1.2 1.2 0 0 1 18 23.199v1.602z"/\x3e\x3c/svg\x3e\r\n        \x3csvg data-dojo-attach-event\x3d"onclick:_dismissGoToSettingsWarning" xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"13" height\x3d"13" viewBox\x3d"0 0 32 32" class\x3d"x-svg-icon js-prevent-dropdown__app-switcher"\x3e\x3cpath class\x3d"js-prevent-dropdown__app-switcher" d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\x3c/svg\x3e\r\n        \x3cstrong\x3e${i18n.someAppsNeedYourAttention}\x3c/strong\x3e\x3cdiv class\x3d"description-text"\x3e${i18n.pleaseGoToOrgSettings}\x3c/div\x3e\r\n        \x3cbutton data-dojo-attach-event\x3d"onclick:_goToOrgSettings" class\x3d"calcite-transparent-btn js-prevent-dropdown__app-switcher"\x3e${_settingsText}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- Removed App Notification --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_displayRemovedAppWarning" class\x3d"go-to-settings-warning hide js-prevent-dropdown__app-switcher"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"16" height\x3d"20" viewBox\x3d"0 0 32 32" class\x3d"warning-svg-icon js-prevent-dropdown__app-switcher"\x3e\x3cpath d\x3d"M28.764 30a2 2 0 0 0 1.789-2.894L17.791 1.579a2 2 0 0 0-3.578 0L1.447 27.106a1.997 1.997 0 0 0 .088 1.945c.363.59 1.008.949 1.701.949h25.527zM3.236 28L16.002 2.473 28.764 28H3.237zM14 11.2a1.2 1.2 0 0 1 1.2-1.2h1.6a1.2 1.2 0 0 1 1.2 1.2v7.6a1.2 1.2 0 0 1-1.2 1.2h-1.6a1.2 1.2 0 0 1-1.2-1.2v-7.6zm4 13.601A1.2 1.2 0 0 1 16.801 26h-1.602A1.2 1.2 0 0 1 14 24.801v-1.602A1.2 1.2 0 0 1 15.199 22h1.602A1.2 1.2 0 0 1 18 23.199v1.602z"/\x3e\x3c/svg\x3e\r\n        \x3csvg data-dojo-attach-event\x3d"onclick:_dismissRemovedAppWarning" xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"13" height\x3d"13" viewBox\x3d"0 0 32 32" class\x3d"x-svg-icon js-prevent-dropdown__app-switcher"\x3e\x3cpath class\x3d"js-prevent-dropdown__app-switcher" d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\x3c/svg\x3e\r\n        \x3cstrong\x3e${i18n.removedApp}\x3c/strong\x3e\x3cdiv class\x3d"description-text"\x3e${i18n.noLongerAvailable}\x3c/div\x3e\r\n        \x3cbutton data-dojo-attach-event\x3d"onclick:_removeAppWithFocus" class\x3d"calcite-transparent-btn js-prevent-dropdown__app-switcher"\x3e${_clearText}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- Dropdown Apps --\x3e\r\n      \x3cdiv class\x3d"bg-darker-gray" data-dojo-attach-point\x3d\'_dropdownAppWrapper\'\x3e\x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"app-switcher__pointer" data-dojo-attach-point\x3d"_dropdownPointer"\x3e\x3c/div\x3e --\x3e\r\n    \x3c/nav\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/SiteFooter.html":'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"footer text-center leader-2 padding-trailer-1 font-size--2 text-light-gray" role\x3d"contentinfo"\x3e\r\n\x3c!-- style\x3d"padding-top: 0.5em; margin-bottom: 1em; white-space: nowrap; text-align: center;"\x3e--\x3e\r\n  \x3cspan id\x3d"${id}_links" class\x3d"esriItemLinks"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:arcgisonline/sharing/dijit/templates/SiteFooterMap.html":'\x3cdiv style\x3d"border-top:1px solid #ccc; padding-top: 0.5em; padding-left:2px; margin-bottom: 3em; white-space: nowrap; text-align: center;"\x3e\r\n  \x3cspan id\x3d"${id}_links" class\x3d"esriItemLinks esriFloatLeading esriAlignLeading" style\x3d"color:#777; line-height:14px"\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/ChoiceDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"choice-dialog" class\x3d"general-dialog" title\x3d"${i18n.notice}"\x3e\r\n    \x3cdiv style\x3d"margin-top:1em;" data-dojo-attach-point\x3d"choiceContent"\x3e\x3c/div\x3e\r\n    \x3cdiv style\x3d"clear: both; margin-top: 2em;" class\x3d"esriAlignTrailing right"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"choiceOneButton" class\x3d"primary trailer-quarter" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n        ${i18n.ok}\r\n      \x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"choiceTwoButton" class\x3d"cancel btn-two trailer-quarter" type\x3d"button" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both; float:none; height: 0;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/ComboBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"combobox" aria-haspopup\x3d"true"\r\n     data-dojo-attach-point\x3d"_popupStateNode"\x3e\r\n  \x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n       data-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\x3e\r\n    \x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1"\r\n           readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true" ${_buttonInputDisabled}/\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\x3e\r\n    \x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text"\r\n           tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"/\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\x3e\r\n    \x3cinput class\x3d\'dijitReset dijitInputInner\' readonly\x3d"readonly" ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n           data-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\r\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\r\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\r\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\r\n\t\t\ttitle\x3d"${optionsTitle}"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\r\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\r\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"*now":function(b){b(['dojo/i18n!*preload*arcgisonline/nls/base*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("arcgisonline/base",["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!esri/main,esri/utils,arcgisonline/init,arcgisonline/persist,arcgisonline/sharing/dijit/ClassificationBanner,arcgisonline/sharing/dijit/SiteHeader,arcgisonline/sharing/dijit/SiteFooter,arcgisonline/sharing/dijit/SiteFooterMap,arcgisonline/sharing/dijit/SignIn,arcgisonline/sharing/dijit/SignInInternal,arcgisonline/sharing/dijit/SignUp,arcgisonline/sharing/dijit/SignUpInternal,dijit/form/Form,arcgisonline/sharing/dijit/CreateAccount,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/HelpManager,dojo/date/locale,dojox/widget/Rotator,dojox/widget/AutoRotator,dojox/widget/rotator/Controller,dojox/widget/rotator/Fade,dijit/layout/StackController,dojo/cookie,dojo/json,arcgisonline/sharing/dijit/TextMenu,arcgisonline/sharing/util,dojo/topic,dijit/_base,dijit/form/DropDownButton,dijit/form/ComboButton,dijit/form/ToggleButton,dijit/form/RadioButton,dijit/PopupMenuItem,dijit/_Contained,dijit/_Container,dijit/_WidgetBase,dijit/main,dojo/Stateful,dojo/date/locale,esri/utils,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/util,arcgisonline/sharing/dijit/views,dojo/parser,dijit/_base,dojo/dnd/AutoSource,dojo/dnd/Target,dojo/fx/Toggler,dijit/TooltipDialog,dijit/MenuSeparator"],function(b,
h,k){b.provide("arcgisonline.base");b.require("esri.main");b.require("esri.utils");b.require("arcgisonline.init");b.require("arcgisonline.persist");b.require("arcgisonline.sharing.dijit.ClassificationBanner");b.require("arcgisonline.sharing.dijit.SiteHeader");b.require("arcgisonline.sharing.dijit.SiteFooter");b.require("arcgisonline.sharing.dijit.SiteFooterMap");b.require("arcgisonline.sharing.dijit.SignIn");b.require("arcgisonline.sharing.dijit.SignInInternal");b.require("arcgisonline.sharing.dijit.SignUp");
b.require("arcgisonline.sharing.dijit.SignUpInternal");b.require("dijit.form.Form");b.require("arcgisonline.sharing.dijit.CreateAccount");b.require("arcgisonline.sharing.geow.Account");b.require("arcgisonline.sharing.dijit.HelpManager");b.require("dojo.date.locale");b.require("dojox.widget.Rotator");b.require("dojox.widget.AutoRotator");b.require("dojox.widget.rotator.Controller");b.require("dojox.widget.rotator.Fade");b.require("dijit.layout.StackController");b.require("dojo.cookie");b.require("dojo.json");
b.require("arcgisonline.sharing.dijit.TextMenu");b.require("arcgisonline.sharing.util");b.require("dojo.topic");b.require("dijit._base");b.require("dijit.form.DropDownButton");b.require("dijit.form.ComboButton");b.require("dijit.form.ToggleButton");b.require("dijit.form.RadioButton");b.require("dijit.PopupMenuItem");b.require("dijit._Contained");b.require("dijit._Container");b.require("dijit._WidgetBase");b.require("dijit.main");b.require("dojo.Stateful");b.require("dojo.date.locale");b.require("esri.utils");
b.require("arcgisonline.sharing.dijit.Gallery");b.require("arcgisonline.sharing.util");b.require("arcgisonline.sharing.dijit.views");b.require("dojo.parser");b.require("dijit._base");b.require("dojo.dnd.AutoSource");b.require("dojo.dnd.Target");b.require("dojo.fx.Toggler");b.require("dijit.TooltipDialog");b.require("dijit.MenuSeparator");b.requireLocalization("arcgisonline","arcgisonline")});