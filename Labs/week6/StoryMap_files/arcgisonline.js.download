// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
require({cache:{"dijit/form/VerticalRule":function(){define(["dojo/_base/declare","./HorizontalRule"],function(c,l){return c("dijit.form.VerticalRule",l,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerV"\x3e\x3c/div\x3e',_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkV" style\x3d"top:',_isHorizontal:!1})})},"dijit/form/VerticalRuleLabels":function(){define(["dojo/_base/declare","./HorizontalRuleLabels"],function(c,l){return c("dijit.form.VerticalRuleLabels",
l,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV"\x3e\x3c/div\x3e',_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerV" style\x3d"top:',_labelPrefix:'"\x3e\x3cspan class\x3d"dijitRuleLabel dijitRuleLabelV"\x3e',_calcPosition:function(c){return 100-c},_isHorizontal:!1})})},"esri/dijit/editing/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/string dijit/_Widget dijit/_Templated ../../domUtils ../../graphicsUtils ../../geometry/Polyline ../../geometry/Polygon ../../graphic ../../undoManager ../../tasks/query ../../layers/FeatureLayer ../../layers/FeatureTemplate ../../toolbars/draw ../../toolbars/edit ../AttributeInspector ./Util ./Add ./Update ./Delete ./Cut ./Union ./toolbars/Drawing ./SelectionHelper ./TemplatePicker ../../kernel ../../config dojo/i18n!../../nls/jsapi dojo/text!./templates/Editor.html dijit/ProgressBar dojo/NodeList-dom".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S){var G=c([p,q],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:!0,templateString:S,onLoad:function(){},constructor:function(a,b){a=a||{};this._settings=a.settings;this._eConnects=[]},startup:function(){this.inherited(arguments);this._setDefaultOptions();this._settings.map.setInfoWindowOnClick(!1);var b=this._settings.layerInfos;this.featureReductionEnabledLayers=[];h.forEach(b,function(a){a=a.featureLayer;
a.isFeatureReductionEnabled()&&(a.disableFeatureReduction(),this.featureReductionEnabledLayers.push(a))},this);if(h.every(b,function(a){return a.featureLayer.loaded}))this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0;else{var d=b.length;h.forEach(b,function(b){b=b.featureLayer;if(b.loaded)d--;else var c=a.connect(b,"onLoad",this,function(b){a.disconnect(c);c=null;d--;d||(this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=
!0)})},this)}this._reset();this._enableMapClickHandler()},stopEditing:function(a){this._updateCurrentFeature(l.hitch(this,function(){this._clearSelection(!1);a&&a()}))},destroy:function(){this._settings.map.setInfoWindowOnClick(!0);this.drawingToolbar&&this.drawingToolbar.destroy();this.attributeInspector&&this.attributeInspector.destroy();this.templatePicker&&this.templatePicker.destroy();this._selectionHelper&&this._selectionHelper.destroy();this._drawToolbar&&this._drawToolbar.deactivate();this._reset();
this._disableMapClickHandler();h.forEach(this._eConnects,a.disconnect);a.disconnect(this._dtConnect);a.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this.editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures&&this._settings.map.infoWindow.clearFeatures();h.forEach(this.featureReductionEnabledLayers,
function(a){a.enableFeatureReduction()});this.inherited(arguments)},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new B(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this.editToolbar=this._settings.editToolbar||new z(this._settings.map,{textSymbolEditorHolder:this.domNode});this._settings.editToolbar=this.editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||!1;this._settings.toolbarOptions=l.mixin({reshapeVisible:!1,cutVisible:!1,
mergeVisible:!1},this._settings.toolbarOptions);this._settings.createOptions=l.mixin({polylineDrawTools:[G.CREATE_TOOL_POLYLINE],polygonDrawTools:[G.CREATE_TOOL_POLYGON],editAttributesImmediately:!0},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?
!0:!1;this._datePackage=this._settings.datePackage;var a=Q.defaults;this._settings.geometryService=this._settings.geometryService||a.geometryService;a.geometryService=a.geometryService||this._settings.geometryService},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};h.forEach(this._settings.layerInfos,function(a){if(a.featureLayer&&a.featureLayer.loaded){this._settings.layers.push(a.featureLayer);var b=a.featureLayer.id;a.featureLayer.credential&&
(this._settings.userIds[b]=a.featureLayer.credential.userId);a.userId&&(this._settings.userIds[b]=a.userId);var d=a.featureLayer.getEditCapabilities();this._settings.createOnlyLayer[b]=d.canCreate&&!d.canUpdate?!0:!1;this._isTextSymbolPointLayer(a.featureLayer)&&(a.disableAttributeUpdate=!0)}},this)},_reset:function(){this._hideAttributeInspector();this.editToolbar.deactivate();this._editVertices=!0;this._drawingTool=this._activeTemplate=this._activeType=this._currentGraphic=this._layer=null;this._attributeChanged=
!1},_saveFeatureOnClient:function(b){var d=this.templatePicker.getSelected(),c;c=d.template?d.featureLayer.renderer.getSymbol(d.template.prototype):d.symbolInfo.symbol;this._tempGraphic=new w(b,c,null,null);this._tempGraphic.setAttributes(l.mixin({},d.template.prototype.attributes));c=this._settings.map;c.graphics.add(this._tempGraphic);b=this._findCenterPoint(b);this._createAttributeInspector();c.infoWindow.setTitle(d.featureLayer?d.featureLayer.name:U.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,
d.featureLayer);this._showInfoWindow(b,c.getInfoWindowAnchor(b));if(this._settings.createOnlyLayer[d.featureLayer.id]||this._settings.invalidTemplate)this._infoWindowHideEvent=a.connect(c.infoWindow,"onHide",this,"_infoWindowHide");a.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();this.drawingToolbar&&this.drawingToolbar.deactivate();this._templatePickerOnSelectionChangeEvent=a.connect(this.templatePicker,
"onSelectionChange",l.hitch(this,"_onCreateFeature"))},_saveAttributesOnClient:function(a,b,d){this._tempGraphic.attributes[b]="number"===typeof d&&isNaN(d)?null:d},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);a.disconnect(this._infoWindowHideEvent)},_createFeature:function(a,b){this._editClickPoint=this._findCenterPoint(a);a.rings?this._simplify(a,l.hitch(this,function(a){this._drawingTool!==x.TOOL_AUTO_COMPLETE_POLYGON?this._applyEdits([{layer:this._layer,
adds:[this._createGraphic(a,b)]}],l.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})):this._autoComplete(a,l.hitch(this,function(a){a&&a.length&&this._applyEdits([{layer:this._layer,adds:h.map(a,l.hitch(this,function(a){return this._createGraphic(a,b)}))}],function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})}))})):this._applyEdits([{layer:this._layer,
adds:[this._createGraphic(a,b)]}],l.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer);this._layer&&this._layer.renderer&&"heatmap"===this._layer.renderer.type&&this._layer.refresh()}))},_chainAttachment:function(a,b){this.attributeInspector&&this.attributeInspector._attachmentEditor&&this.attributeInspector._attachmentEditor._tempUpload&&this.attributeInspector._attachmentEditor._chainAttachment(a,b)},_updateCurrentFeature:function(a){var b=
this._isModified();b?this._updateFeature(b,a):a&&a(!1)},_updateFeature:function(a,b,d){var c=a.geometry,e=a.getLayer();e.hasZ&&!e.enableZDefaults||e.hasM&&!e.allowUpdateWithoutMValues||d&&!this._isModified()?(d=new w,d.setAttributes(a.attributes),this._applyEdits([{layer:a.getLayer(),updates:[d]}],b)):c.rings?this._simplify(c,l.hitch(this,function(d){this._applyEdits([{layer:a.getLayer(),updates:[l.mixin(a,{geometry:d})]}],b)})):this._applyEdits([{layer:a.getLayer(),updates:[a]}],b)},_deleteFeature:function(a,
b){if(this._settings.invalidTemplate&&a===this._tempGraphic)this._settings.map.graphics.remove(this._tempGraphic),this._hideAttributeInspector();else{var d=[];a?d.push({layer:a.getLayer(),deletes:[a]}):(d=h.map(h.filter(this._settings.layers,function(a){return 0<a.getSelectedFeatures().length}),function(a){return{layer:a,deletes:a.getSelectedFeatures()}}))&&d.length||!this._currentGraphic||d.push({layer:this._layer,deletes:[this._currentGraphic]});this._applyEdits(d,b)}},_stopEditing:function(a,b,
d,c){n.hide(this.progressBar.domNode);this._settings.createOnlyLayer[a.id]||this._undoRedoAdd();var e;!0===a._isSelOnly||1===a.mode||6===a.mode?b&&b.length&&(this.templatePicker.clearSelection(),e=new y,e.objectIds=[b[0].objectId],this._settings.createOnlyLayer[a.id]||this._settings.invalidTemplate?this._settings.map.graphics.remove(this._tempGraphic):this._selectFeatures([a],e,l.hitch(this,"_onEditFeature"))):((e=this._selectionHelper.findMapService(this._settings.map,a))&&e.refresh(),b&&b.length&&
(this.templatePicker.clearSelection(),this._settings.createOnlyLayer[a.id]||this._settings.invalidTemplate?this._settings.map.graphics.remove(this._tempGraphic):A.findFeatures(b,a,l.hitch(this,"_onEditFeature"))));c&&c.length&&(this._clearSelection(!0),this._undoRedo&&(e=this._selectionHelper.findMapService(a,this._settings.map))&&e.refresh());this._undoRedo&&d&&d.length&&((e=this._selectionHelper.findMapService(a,this._settings.map))&&e.refresh(),this.attributeInspector.refresh(),this._undoRedo=
!1);this.drawingToolbar&&this.drawingToolbar._updateUI();this._undoRedo=!1;this._settings.invalidTemplate=!1},_undoRedoAdd:function(){this._settings._isApplyEditsCall=!1;if(this._settings.undoManager){var a=this._edits&&this._edits.length?this._edits[0]:null;if(a){var b=a.adds||[],d=a.updates||[],c=a.deletes||[],e=a.preUpdates||[],a={featureLayer:a.layer};"CUT"===this._activeTool?b.length&&d.length&&e.length&&this.undoManager.add(new K(l.mixin(a,{preUpdatedGraphics:e,addedGraphics:b,postUpdatedGraphics:d}))):
"UNION"===this._activeTool?c.length&&d.length&&e.length&&this.undoManager.add(new H(l.mixin(a,{preUpdatedGraphics:e,deletedGraphics:c,postUpdatedGraphics:d}))):b.length?this.undoManager.add(new E(l.mixin(a,{addedGraphics:b}))):c.length?this.undoManager.add(new O(l.mixin(a,{deletedGraphics:c}))):d.length&&(this._rollbackGraphic||e.length)&&this.undoManager.add(new N(l.mixin(a,{preUpdatedGraphics:e.length?e:[this._rollbackGraphic],postUpdatedGraphics:d})));this._rollbackGraphic=this._edits=null}}},
_activateDrawToolbar:function(b){this._layer=b.featureLayer;this._activeType=b.type;this._drawingTool=(this._activeTemplate=b.template)?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,b.featureLayer);a.disconnect(this._dtConnect);var d=this._layer.fields;this._settings.invalidTemplate=!1;if(this._activeTemplate&&this._activeTemplate.prototype){var c=l.mixin({},this._activeTemplate.prototype.attributes),d=d.filter(function(a){return!1===a.nullable&&!0===a.editable});
this._settings.invalidTemplate=d.some(function(a){a=c[a.name];return null===a||void 0===a})}this._dtConnect=this._settings.createOnlyLayer[b.featureLayer.id]||this._settings.invalidTemplate?a.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient"):a.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");this.editToolbar.deactivate();this._disableMapClickHandler();this.drawingToolbar?this.drawingToolbar.activateEditing(this._drawTool,this._layer):this._drawToolbar.activate(this._drawTool)},
_activateEditToolbar:function(a,b){var d=a.getLayer(),c=d?d.geometryType:null,e=this._isTextSymbolPoint(a),f=z.MOVE;"esriGeometryPoint"!==c&&!0===this._isNotesFeature(a)?(f=f|z.ROTATE|z.SCALE,this._editVertices=!1):"esriGeometryPoint"!==c&&!0===this._editVertices?(f=f|z.ROTATE|z.SCALE,this._editVertices=!1):e?(f=f|z.ROTATE|z.SCALE|z.EDIT_TEXT,this._editVertices=!1):(f|=z.EDIT_VERTICES,this._editVertices=!0);this._attributeChanged=this._isModified();this._rollbackGraphic=new w(a.toJson());var c=d.getEditCapabilities({feature:a,
userId:this._settings.userIds[d.id]}),g=h.filter(this._settings.layerInfos,function(a){return a.featureLayer.layerId===d.layerId})[0];c.canUpdate&&!g.disableGeometryUpdate&&c.canUpdateGeometry&&(this.editToolbar.activate(f,a),e&&(this.editToolbar._textEditor._addTextBox(a),this.editToolbar._textSymbolEditor&&this.editToolbar._textSymbolEditor.hide()));this._settings.map.infoWindow.isShowing||this._updateAttributeDisabled(a)||(a=b&&b.screenPoint||this._findCenterPoint(a),this._showInfoWindow(a,this._settings.map.getInfoWindowAnchor(a)))},
_createGraphic:function(a,b){var d=new w(a,this._activeType&&this._activeType.symbol||this._layer.defaultSymbol,b);this._activeTemplate||b?d.attributes=b||l.mixin({},this._activeTemplate.prototype.attributes):(d.attributes=d.attributes||[],h.forEach(this._layer.fields,function(a){d.attributes[a.name]=null},this));return d},_connectEvents:function(){var a=this._settings.layers;h.forEach(a,function(a){this._connect(a,"onEditsComplete",l.hitch(this,"_stopEditing",a))},this);h.forEach(a,function(a){this._connect(a,
"onBeforeApplyEdits",l.hitch(this,function(){n.show(this.progressBar.domNode);this._settings._isApplyEditsCall=!0}))},this);this._connect(this.editToolbar,"onGraphicClick",l.hitch(this,"_activateEditToolbar"));this._connect(this.editToolbar,"onGraphicFirstMove",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onVertexFirstMove",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onScaleStart",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,
"onRotateStart",l.hitch(this,"_hideAttributeInspector"))},_connect:function(b,d,c){this._eConnects.push(a.connect(b,d,c))},_createWidgets:function(){this._selectionHelper=new L(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager()},_createTemplatePicker:function(){if(this._settings.templatePicker)this.templatePicker=this._settings.templatePicker,n.hide(this.templatePickerDiv);else{var b=h.filter(this._settings.layers,
function(a){return a.getEditCapabilities().canCreate});this.templatePicker=new R({"class":"esriTemplatePicker",featureLayers:b,showTooltip:!0,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker}this._templatePickerOnSelectionChangeEvent=a.connect(this.templatePicker,"onSelectionChange",l.hitch(this,"_onCreateFeature"))},_createAttributeInspector:function(){var a=this._settings.map;
this._settings.attributeInspector?(this._customAttributeInspector=!0,this.attributeInspector=this._settings.attributeInspector):(this._customAttributeInspector=!1,this.attributeInspector=new F({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},k.create("div")),this.attributeInspector.startup(),a.infoWindow.setContent(this.attributeInspector.domNode),a.infoWindow.setTitle(U.widgets.attributeInspector.NLS_title),a.infoWindow.resize(350,375),e.query(".esriAttributeInspector .atiLayerName").style({display:"none"}));
this._connect(this.attributeInspector,"onDelete",l.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",l.hitch(this,function(a){this._updateCurrentFeature(l.hitch(this,function(){this._attributeChanged=!1;this._onEditFeature(a)}))}));this._usePopup&&a.infoWindow._setPagerCallbacks(this.attributeInspector,l.hitch(this.attributeInspector,"previous"),l.hitch(this.attributeInspector,"next"));this._connect(this.attributeInspector,"onAttributeChange",l.hitch(this,function(a,b,d){if(this._settings.createOnlyLayer[this._layer.id]||
this._settings.invalidTemplate)this._saveAttributesOnClient(a,b,d);else{var c=a.getLayer();(c=h.filter(c.fields,function(a){return a.name===b})[0])&&""===d&&(d=null);this._rollbackGraphic=new w(l.clone(a.toJson()));this.attributeInspector._rollbackInfo={field:c,graphic:this._rollbackGraphic};this._currentGraphic.attributes[b]="number"===typeof d&&isNaN(d)?null:d;this._currentGraphic.setAttributes(this._currentGraphic.attributes);this._updateFeature(this._currentGraphic,null,!0);this._attributeChanged=
!1}}))},_createDrawingToolbar:function(){!0===this._settings.toolbarVisible&&(this.drawingToolbar=new J({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this.editToolbar,settings:this._settings,onDelete:l.hitch(this,"_deleteFeature"),onApplyEdits:l.hitch(this,"_applyEdits"),onShowAttributeInspector:l.hitch(this,"_onEditFeature")},this.drawingToolbarDiv))},_createUndoRedoManager:function(){if(this._settings.enableUndoRedo||this._settings.undoManager)this._settings.enableUndoRedo=
!0,this.undoManager=this._settings.undoManager,this.undoManager||(this.undoManager=this._settings.undoManager=new t({maxOperations:this._settings.maxUndoRedoOperations})),this._connect(this.undoManager,"onUndoComplete",l.hitch(this,this._updateUndoRedoOperations)),this._connect(this.undoManager,"onRedoComplete",l.hitch(this,this._updateUndoRedoOperations)),this._connect(document,"onkeypress",l.hitch(this,function(a){if(a.metaKey||a.ctrlKey)"z"===a.charOrCode&&this._undo(),"y"===a.charOrCode&&this._redo()}))},
_updateUndoRedoOperations:function(a){if(a&&a.addedIds){var b;for(b=0;b<this.undoManager.length;b++){var d=this.undoManager.get(b);d&&a.layer===d._featureLayer&&d.updateObjectIds(a.oldIds,a.addedIds)}}a&&"Update Features"===a.operation.label&&this.attributeInspector.refresh()},_enableMapClickHandler:function(){this._mapClickHandler=a.connect(this._settings.map,"onClick",l.hitch(this,function(a){this._drawToolbar._geometryType||("SELECT"===this._activeTool?this._activeTool="":this._updateCurrentFeature(l.hitch(this,
function(){this._reset();this._updateSelection(a)})))}))},_disableMapClickHandler:function(){a.disconnect(this._mapClickHandler)},_onCreateFeature:function(){var b=this.templatePicker.getSelected();b?this._updateCurrentFeature(l.hitch(this,function(){this._currentGraphic&&this._clearSelection(!1);this._reset();this._activateDrawToolbar(b)})):(this._reset(),a.disconnect(this._dtConnect),this._drawToolbar.deactivate(),this._enableMapClickHandler(),this.drawingToolbar&&this.drawingToolbar.deactivate())},
_isTextSymbolPoint:function(a){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var b=a.getLayer(),d=b.renderer;a=a.symbol||b._getSymbol(a);!a&&(d.hasVisualVariables("sizeInfo",!1)||d.hasVisualVariables("colorInfo",!1)||d.hasVisualVariables("opacityInfo",!1))&&d.addBreak&&d.infos&&1===d.infos.length&&(a=d.infos[0].symbol||d.defaultSymbol);if(a&&"textsymbol"===a.type)return!0}return!1},_isTextSymbolPointLayer:function(a){return"esriGeometryPoint"===a.geometryType&&a.renderer&&a.renderer._symbols&&
a.renderer._symbols[0]&&a.renderer._symbols[0].symbol&&"textsymbol"===a.renderer._symbols[0].symbol.type?!0:!1},_updateAttributeDisabled:function(a){a=a.getLayer();if(!a)return!1;var b,d,c=!1;for(b=0;b<this._settings.layerInfos.length;b++)if(d=this._settings.layerInfos[b],d.featureLayer==a){c=d.disableAttributeUpdate;break}return c},_onEditFeature:function(a,b){if(a=(l.isArray(a)?a[0]:a)||null){var d;this._layer=a.getLayer();if(!this._customAttributeInspector&&!this._updateAttributeDisabled(a)){b=
b||this._editClickPoint||this._findCenterPoint(a);1<this._currentFeatureCount?(d=this._popupFeatures.indexOf(a),d=m.substitute(U.widgets.popup.NLS_pagingInfo,{index:d+1,total:this._currentFeatureCount})):d=this._layer?this._layer.name:U.widgets.attributeInspector.NLS_title;this._settings.map.infoWindow.setTitle(d);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing)this.attributeInspector.refresh(),this._showInfoWindow(b,this._settings.map.getInfoWindowAnchor(b));this._editClickPoint=
null}a!==this._currentGraphic&&(this._editVertices=!0,this._currentGraphic=a,a.getDojoShape()&&a.getDojoShape().moveToFront(),b=this._layer.hasM,this._layer.hasZ&&!this._layer.enableZDefaults||b&&!this._layer.allowUpdateWithoutMValues||this._activateEditToolbar(a))}},_applyEdits:function(a,d){a=a||[];if(!(0>=a.length)){this._edits=this._oEdits=a;var c=[];h.forEach(a,function(a){a.layer&&c.push(a.layer.applyEdits(a.adds,a.updates,a.deletes))});0<c.length&&(this._deferredsList=(new b(c)).addCallback(l.hitch(this,
function(){n.hide(this.progressBar.domNode);d&&d();var a=this._settings.map;a&&a.infoWindow.reposition&&a.infoWindow.isShowing&&a.infoWindow.reposition()})))}},_undo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.undo())},_redo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.redo())},_simplify:function(a,
b){u.prototype.isSelfIntersecting(a)?this._settings.geometryService.simplify([a],function(a){var d=a&&a.length?a[0]:d;b&&b(d)}):b&&b(a)},_autoComplete:function(a,b){var d=this._getLayers("esriGeometryPolygon"),c=new y;c.geometry=a;c.returnGeometry=!0;this._selectFeatures(d,c,l.hitch(this,function(d){!d||0>=d.length?b&&b([a]):this._settings.geometryService.autoComplete(r.getGeometries(d),this._toPolylines([c.geometry]),function(a){b&&b(a)})}))},_getLayers:function(a){return h.filter(this._settings.layers,
function(b){return b.geometryType===a})},_selectFeatures:function(a,b,d,c){this._selectionHelper.selectFeatures(a,b,c||C.SELECTION_NEW,d)},_updateSelection:function(a){var b=a.mapPoint,d=a.graphic,c=this._settings.layerInfos,e;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,b,C.SELECTION_NEW,l.hitch(this,function(a){var f=h.some(a,l.hitch(this,function(a){return a==d}));if(d&&!f)if(f=d.getLayer(),this._isValidLayer(f)){var g=new y;g.objectIds=[d.attributes[f.objectIdField]];this._selectionHelper.selectFeatures([f],
g,C.SELECTION_ADD,l.hitch(this,function(d){d&&d.length&&(d=d.concat(a),e=A.sortFeaturesById(c,d),this._updatePopupButtons(e),this._onEditFeature(e,b))}))}else a&&a.length?(e=A.sortFeaturesById(c,a),this._updatePopupButtons(e),this._onEditFeature(e,b)):this._clearSelection();else a&&a.length?(e=A.sortFeaturesById(c,a),this._updatePopupButtons(e),this._onEditFeature(e,b)):this._clearSelection()}));d&&this._isTextSymbolPoint(d)&&this._isValidLayer(d.getLayer())&&this.editToolbar.activate(0|z.MOVE|z.ROTATE|
z.SCALE|z.EDIT_TEXT,d)},_updatePopupButtons:function(a){if(this._usePopup&&a){var b=a.length;h.forEach([this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton],l.hitch(this,function(a){1<b?g.remove(a,"hidden"):g.add(a,"hidden")}));var d=1<b?"block":"none";e.query(".esriAttributeInspector .atiLayerName").style({display:d});this._currentFeatureCount=b;this._popupFeatures=a}else this._currentFeatureCount=this._popupFeatures=null},_clearSelection:function(a){this._currentFeatureCount=
0;this._popupFeatures=null;this._selectionHelper.clearSelection(a||!1);this._reset()},_findCenterPoint:function(a){a=a.geometry||a;var b;switch(a.type){case "point":b=a;break;case "polyline":b=a.getPoint(0,Math.ceil(a.paths[0].length/2));break;case "polygon":b=a.rings.length-1,b=a.getPoint(b,a.rings[b].length-1)}return this._settings.map.toScreen(b)},_hideAttributeInspector:function(){!this._customAttributeInspector&&this._settings.map.infoWindow&&this._settings.map.infoWindow.hide()},_toPolylines:function(a){return h.map(a,
function(a){var b=new v(a.spatialReference);h.forEach(a.rings,function(a){b.addPath(a)});return b})},_isNotesFeature:function(a){var b=a.getLayer(),d=b?b.types||null:null;if(!d)return!1;var c=a.attributes[b.typeIdField],e;h.some(d,function(a){return a.id===c?(e=a.templates,!0):!1});return e?(a=e[0]||null)?this._isShapeTool(a.drawingTool)?!0:!1:!1:!1},_isValidLayer:function(a){var b,d=this._settings.layerInfos;for(b=0;b<d.length;b++){var c=d[b];if(a.id==(c.featureLayer?c.featureLayer.id:c.layerId))return!0}return!1},
_isShapeTool:function(a){switch(a){case x.TOOL_ARROW:return B.ARROW;case x.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case x.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case x.TOOL_UP_ARROW:return B.UP_ARROW;case x.TOOL_DOWN_ARROW:return B.DOWN_ARROW;case x.TOOL_CIRCLE:return B.CIRCLE;case x.TOOL_ELLIPSE:return B.ELLIPSE;case x.TOOL_TRIANGLE:return B.TRIANGLE;case x.TOOL_RECTANGLE:return B.RECTANGLE;default:return null}},_toDrawTool:function(a,b){b=b.geometryType;switch(a){case x.TOOL_POINT:return B.POINT;case x.TOOL_ARROW:return B.ARROW;
case x.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case x.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case x.TOOL_UP_ARROW:return B.UP_ARROW;case x.TOOL_DOWN_ARROW:return B.DOWN_ARROW;case x.TOOL_CIRCLE:return B.CIRCLE;case x.TOOL_ELLIPSE:return B.ELLIPSE;case x.TOOL_TRIANGLE:return B.TRIANGLE;case x.TOOL_RECTANGLE:return B.RECTANGLE;case x.TOOL_LINE:return B.POLYLINE;case x.TOOL_POLYGON:return B.POLYGON;case x.TOOL_FREEHAND:return"esriGeometryPolyline"===b?B.FREEHAND_POLYLINE:B.FREEHAND_POLYGON;default:return a=
B.POINT,"esriGeometryPolyline"===b?(a=B.POLYLINE,this._settings.createOptions.polylineDrawTools[0]===G.CREATE_TOOL_FREEHAND_POLYLINE&&(a=B.FREEHAND_POLYLINE)):"esriGeometryPolygon"===b&&(a=B.POLYGON,this._settings.createOptions.polygonDrawTools[0]===G.CREATE_TOOL_FREEHAND_POLYGON&&(a=B.FREEHAND_POLYGON)),a}},_isModified:function(){var a=this.editToolbar.getCurrentState();return(a.isModified||this._attributeChanged)&&a.graphic?a.graphic:null},_showInfoWindow:function(a,b){this._customAttributeInspector||
this._settings.map.infoWindow.show(a,b)}});l.mixin(G,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",
CREATE_TOOL_LEFT_ARROW:"leftarrow"});l.setObject("dijit.editing.Editor",G,M);return G})},"esri/undoManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented ./OperationBase".split(" "),function(c,l,h,a,e,f){c=c([f],{declaredClass:"esri.UndoManager",maxOperations:10,canUndo:!1,canRedo:!1,position:0,length:0,onUndo:function(){},onRedo:function(){},onUndoComplete:function(){},onRedoComplete:function(){},onAdd:function(){},onChange:function(){},constructor:function(a){a=
a||{};a.maxOperations&&(this.maxOperations=a.maxOperations);this._historyStack=[]},add:function(a){if(0<this.maxOperations)for(;this._historyStack.length>=this.maxOperations;)this._historyStack.shift();this._historyStack.splice(this.position,0,a);this.position++;this.clearRedo();this.onAdd();this._checkAvailability()},undo:function(){if(0===this.position)return null;var d=this.peekUndo();this.position--;d?(d=d.performUndo(),this.onUndo(),this._checkAvailability(),a(d).then(l.hitch(this,this.onUndoComplete))):
(this.onUndo(),this._checkAvailability())},redo:function(){if(this.position===this._historyStack.length)return null;var d=this.peekRedo();this.position++;d?(d=d.performRedo(),this.onRedo(),this._checkAvailability(),a(d).then(l.hitch(this,this.onRedoComplete))):(this.onRedo(),this._checkAvailability())},_checkAvailability:function(){this.length=this._historyStack.length;0===this.length?this.canUndo=this.canRedo=!1:0===this.position?(this.canRedo=!0,this.canUndo=!1):this.position===this.length?(this.canUndo=
!0,this.canRedo=!1):this.canRedo=this.canUndo=!0;this.onChange()},clearUndo:function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()},clearRedo:function(){this._historyStack.splice(this.position,this._historyStack.length-this.position);this.position=this._historyStack.length;this._checkAvailability()},peekUndo:function(){if(0<this._historyStack.length&&0<this.position)return this.get(this.position-1)},peekRedo:function(){if(0<this._historyStack.length&&this.position<
this._historyStack.length)return this.get(this.position)},get:function(a){return this._historyStack[a]},remove:function(a){0<this._historyStack.length&&(this._historyStack.splice(a,1),0<this.position&&a<this.position&&this.position--,this._checkAvailability())},destroy:function(){this._historyStack=null}});return e.UndoManager=c})},"esri/OperationBase":function(){define(["dojo/_base/declare","dojo/has","./kernel"],function(c,l,h){c=c(null,{declaredClass:"esri.OperationBase",type:"not implemented",
label:"not implemented",constructor:function(a){a=a||{};a.label&&(this.label=a.label)},performUndo:function(){},performRedo:function(){}});return h.OperationBase=c})},"esri/toolbars/edit":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/has dojo/dom-construct dojo/dom-style ../kernel ../lang ../sniff ./_toolbar ./_Box ./_GraphicMover ./_VertexEditor ./TextEditor ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/TextSymbol ../graphic".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C){var x=l(q,{declaredClass:"esri.toolbars.Edit",constructor:function(b,c){this._map=b;this._tool=0;if(this._map.loaded)this._scratchGL=b.graphics;else var e=a.connect(this._map,"onLoad",this,function(){a.disconnect(e);e=null;this._scratchGL=this._map.graphics});b=d("esri-mobile");this._defaultOptions=h.mixin({vertexSymbol:new w(w.STYLE_CIRCLE,b?20:12,new t(t.STYLE_SOLID,new f([0,0,0,.5]),1),new f([128,128,128])),ghostVertexSymbol:new w(w.STYLE_CIRCLE,
b?18:10,new t(t.STYLE_SOLID,new f([0,0,0,.5]),1),new f([255,255,255,.75])),ghostLineSymbol:new t(t.STYLE_DOT,new f([128,128,128]),2),allowDeleteVertices:!0,allowAddVertices:!0,rotateHandleOffset:b?24:16,boxLineSymbol:new t(t.STYLE_DASH,new f([64,64,64]),1),boxHandleSymbol:new w(w.STYLE_SQUARE,b?16:9,new t(t.STYLE_SOLID,new f([0,0,0,.5]),1),new f([255,255,255,.75])),textAnchorSymbol:new w(w.STYLE_CIRCLE,10,null,new f([255,0,0]))},c||{})},activate:function(b,d,c){this.deactivate();this._graphic=d;this._options=
h.mixin(h.mixin({},this._defaultOptions),c||{});var e=x.MOVE;c=x.EDIT_VERTICES;var f=x.SCALE,g=x.ROTATE,k=x.EDIT_TEXT,n=!1,m=!1,t=!1,r=this._map,q=r.spatialReference,p=d.geometry.spatialReference;this._geo=!(!q||!p||q.equals(p)||!q.isWebMercator()||4326!==p.wkid);this._isTextPoint=this._prepareTextSymbolEditing(d,b);(b&e)===e&&(n=this._enableMove(d));e=(b&f)===f;g=(b&g)===g;if(e||g)t=this._enableBoxEditing(d,e,g);(b&c)===c&&(m=this._enableVertexEditing(d));(b&k)===k&&this._enableTextEditing(d);if(!(n||
m||t))throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");if(this._tool=b)this._mapPanEndHandle=a.connect(r,"onPanEnd",this,this._mapPanEndHandler),this._mapExtChgHandle=a.connect(r,"onExtentChange",this,this._mapExtentChangeHandler),this.onActivate(this._tool,d);r.snappingManager&&(n||m)&&r.snappingManager._startSelectionLayerQuery()},deactivate:function(){this._isTextPoint=null;var b=this._tool,d=this._graphic;if(b){var c=
!!this._modified;this._clear();a.disconnect(this._mapPanEndHandle);a.disconnect(this._mapExtChgHandle);this._graphic=this._geo=this._mapPanEndHandle=this._mapExtChgHandle=null;this.onDeactivate(b,d,{isModified:c});this._map.snappingManager&&this._map.snappingManager._stopSelectionLayerQuery()}},refresh:function(){this._refreshMoveables(!0)},getCurrentState:function(){return{tool:this._tool,graphic:this._graphic,isModified:!!this._modified}},onActivate:function(a,b){},onDeactivate:function(a,b,d){},
onGraphicMoveStart:function(a){},onGraphicFirstMove:function(a){this._modified=!0},onGraphicMove:function(a,b){},onGraphicMoveStop:function(a,b){},onGraphicClick:function(a,b){},onVertexMoveStart:function(a,b){},onVertexFirstMove:function(a,b){this._modified=!0},onVertexMove:function(a,b,d){},onVertexMoveStop:function(a,b,d){},onVertexAdd:function(a,b){this._modified=!0},onVertexClick:function(a,b){},onVertexMouseOver:function(a,b){},onVertexMouseOut:function(a,b){},onVertexDelete:function(a,b){this._modified=
!0},onTextEditStart:function(a,b){},onTextEditEnd:function(a){},onScaleStart:function(a){},onScaleFirstMove:function(a){this._modified=!0},onScale:function(a,b){},onScaleStop:function(a,b){},onRotateStart:function(a){},onRotateFirstMove:function(a){this._modified=!0},onRotate:function(a,b){},onRotateStop:function(a,b){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic","transform"],
"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic","vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],
"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_prepareTextSymbolEditing:function(a,d){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var e=a.getLayer(),f=e.renderer,e=a.symbol||e._getSymbol(a);!e&&(f.hasVisualVariables("sizeInfo",!1)||f.hasVisualVariables("colorInfo",!1)||f.hasVisualVariables("opacityInfo",!1))&&f.addBreak&&
f.infos&&1===f.infos.length&&(e=f.infos[0].symbol||f.defaultSymbol);if(e&&"textsymbol"===e.type){if((d&x.SCALE)===x.SCALE||(d&x.ROTATE)===x.ROTATE||(d&x.EDIT_TEXT)===x.EDIT_TEXT){a.setSymbol(new y(e.toJson()));var k=this;this._textSymbolEditor?(this._textSymbolEditor.createForm(a),this._textSymbolEditor.show()):this._options&&this._options.textSymbolEditor?(this._textSymbolEditor=this._options.textSymbolEditor,this._textSymbolEditor.on("symbol-change",function(){k._boxEditor&&k._boxEditor.refresh()})):
c(["../dijit/SymbolEditor"],function(d){if(!k._textSymbolEditor){var c;c=k._options.textSymbolEditorHolder?b.create("div",null,k._options.textSymbolEditorHolder):b.create("div",null,k._map.root);k._textSymbolEditor=new d({graphic:a},c);d=k._textSymbolEditor.domNode.parentNode.id;g.set(k._textSymbolEditor.domNode,{position:"map_root"===d?"absolute":"relative",left:"map_root"===d?k._map.width/2-100+"px":"5px",top:"20px","z-index":50});k._textSymbolEditor.startup();k._textSymbolEditor.createForm(a);
k._textSymbolEditor.show();k._textSymbolEditor.on("symbol-change",function(){k._boxEditor&&k._boxEditor.refresh()})}})}if((d&x.MOVE)===x.MOVE||(d&x.ROTATE)===x.ROTATE||(d&x.SCALE)===x.SCALE)this._textAnchor=new C(a.geometry,this._options.textAnchorSymbol),this._scratchGL.add(this._textAnchor);return!0}}return!1},_enableMove:function(a){var b=this._map;switch(a.geometry.type){case "point":case "polyline":case "polygon":return this._graphicMover=new r(a,b,this,this._textAnchor),!0}return!1},_enableVertexEditing:function(a){var b=
this._map;switch(a.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=v.create(a,b,this),!0}return!1},_enableBoxEditing:function(a,b,d){var c=this._map,e=a.geometry.type;return"polyline"===e||"polygon"===e||this._isTextPoint?(this._boxEditor=new n(a,c,this,b,d,this._options.uniformScaling,this._isTextPoint),!0):!1},_enableTextEditing:function(b){return this._isTextPoint?(this._textEditor=new u(b,this._map,this),a.connect(this._textEditor,"onEditStart",h.hitch(this,
function(){this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._map.disableKeyboardNavigation();this._disableMove();this._disableBoxEditing()})),!0):!1},_disableMove:function(){var a=this._graphicMover;a&&(a.destroy(),this._graphicMover=null)},_disableVertexEditing:function(){var a=this._vertexEditor;a&&(a.destroy(),this._vertexEditor=null)},_disableBoxEditing:function(){var a=this._boxEditor;a&&(a.destroy(),this._boxEditor=null)},_disableTextEditing:function(){this._textEditor&&
(this._textEditor.destroy(),this._textEditor=null);this._map.enableKeyboardNavigation()},_disableSymbolEditing:function(){this._textSymbolEditor&&this._textSymbolEditor.hide()},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._disableTextEditing();this._disableSymbolEditing();this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._tool=0;this._modified=!1},_mapPanEndHandler:function(){this._refreshMoveables()},
_mapExtentChangeHandler:function(a,b,d){d&&this._refreshMoveables()},_refreshMoveables:function(a){var b=e.filter([this._graphicMover,this._vertexEditor,this._boxEditor],m.isDefined);e.forEach(b,function(b){b.refresh(a)})},_beginOperation:function(a){e.forEach(this._getAffectedTools(a),function(a){a.suspend()})},_endOperation:function(a){e.forEach(this._getAffectedTools(a),function(a){a.resume()})},_getAffectedTools:function(a){var b=[];switch(a){case "MOVE":b=[this._vertexEditor,this._boxEditor];
break;case "VERTICES":b=[this._boxEditor];break;case "BOX":b=[this._vertexEditor]}return b=e.filter(b,m.isDefined)}});h.mixin(x,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8,EDIT_TEXT:16});h.setObject("toolbars.Edit",x,k);return x})},"esri/toolbars/_Box":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../lang ../geometry/Point ../geometry/Polyline ../symbols/SimpleMarkerSymbol ../geometry/webMercatorUtils ../geometry/jsonUtils ../graphic".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u){c=c(null,{declaredClass:"esri.toolbars._Box",constructor:function(a,b,d,c,e,f,g){this._graphic=a;this._map=b;this._toolbar=d;this._scale=c;this._rotate=e;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=f;a=d._options;this._markerSymbol=a.boxHandleSymbol;this._lineSymbol=a.boxLineSymbol;this._moveStartHandler=l.hitch(this,this._moveStartHandler);this._firstMoveHandler=l.hitch(this,this._firstMoveHandler);
this._moveStopHandler=l.hitch(this,this._moveStopHandler);this._moveHandler=l.hitch(this,this._moveHandler);this._isTextPoint=g;this._init()},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null},refresh:function(){this._draw()},suspend:function(){h.forEach(this._getAllGraphics(),function(a){a.hide()})},resume:function(){h.forEach(this._getAllGraphics(),function(a){a.show()});this._draw()},_init:function(){this._draw()},_cleanUp:function(){this._connects&&
h.forEach(this._connects,a.disconnect);var b=this._toolbar._scratchGL;this._anchors&&h.forEach(this._anchors,function(a){b.remove(a.graphic);(a=a.moveable)&&a.destroy()});this._box&&b.remove(this._box);this._box=this._anchors=this._connects=null},_draw:function(){if(this._graphic.getDojoShape()){var a=this._map,b=this._toolbar._scratchGL,d=this._getBoxCoords(),c=new q(a.spatialReference),e=l.clone(h.filter(d,function(a,b){return 8!==b&&0===b%2}));e[0]&&e.push([e[0][0],e[0][1]]);c.addPath(e);this._rotate&&
c.addPath([d[1],d[8]]);this._box?this._box.setGeometry(c):(this._box=new u(c,this._lineSymbol),b.add(this._box));this._anchors?h.forEach(this._anchors,function(b,c){this._scale||(c=8);var e=new p(d[c],a.spatialReference);b.graphic.setGeometry(e);var e=b.moveable,f=b.graphic.getDojoShape();f&&(e?f!==e.shape&&(e.destroy(),b.moveable=this._getMoveable(b.graphic,c)):b.moveable=this._getMoveable(b.graphic,c))},this):(this._anchors=[],this._connects=[],h.forEach(d,function(d,c){!this._scale&&8>c||(d=new p(d,
a.spatialReference),d=new u(d,this._markerSymbol),this._isTextPoint&&1===c%2&&d.hide(),b.add(d),this._anchors.push({graphic:d,moveable:this._getMoveable(d,c)}))},this))}else this._cleanUp()},_getBoxCoords:function(a){var b=this._map,d,c=[],e,f,g;if(this._isTextPoint){d=this._graphic.getNode().getBoundingClientRect();var k=b.__container.getBoundingClientRect();d=[{x:d.left-k.left,y:d.top-k.top},{x:d.right-k.left,y:d.top-k.top},{x:d.right-k.left,y:d.bottom-k.top},{x:d.left-k.left,y:d.bottom-k.top}]}else d=
this._getTransformedBoundingBox(this._graphic);h.forEach(d,function(d,k,n){e=d;(f=n[k+1])||(f=n[0]);g={x:(e.x+f.x)/2,y:(e.y+f.y)/2};a||(e=b.toMap(e),g=b.toMap(g));c.push([e.x,e.y]);c.push([g.x,g.y])});this._rotate&&(d=l.clone(c[1]),d=a?{x:d[0],y:d[1]}:b.toScreen({x:d[0],y:d[1],spatialReference:b.spatialReference}),d.y-=this._toolbar._options.rotateHandleOffset,a||(d=b.toMap(d)),c.push([d.x,d.y]));return c},_getTransformedBoundingBox:function(a){var b=this._map,d=a.geometry.getExtent(),c=a.geometry.spatialReference;
a=new p(d.xmin,d.ymax,c);d=new p(d.xmax,d.ymin,c);a=b.toScreen(a);d=b.toScreen(d);return[{x:a.x,y:a.y},{x:d.x,y:a.y},{x:d.x,y:d.y},{x:a.x,y:d.y}]},_getAllGraphics:function(){var a=[this._box];this._anchors&&h.forEach(this._anchors,function(b){a.push(b.graphic)});return a=h.filter(a,m.isDefined)},_getMoveable:function(c,e){var f=c.getDojoShape();if(f)return c=new b(f),c._index=e,this._connects.push(a.connect(c,"onMoveStart",this._moveStartHandler)),this._connects.push(a.connect(c,"onFirstMove",this._firstMoveHandler)),
this._connects.push(a.connect(c,"onMoveStop",this._moveStopHandler)),c.onMove=this._moveHandler,(f=f.getEventSource())&&d.set(f,"cursor",this._toolbar._cursors["box"+e]),c},_moveStartHandler:function(a){this._toolbar["on"+(8===a.host._index?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic)},_firstMoveHandler:function(a){this._toolbar._deactivateScrollWheel();var b=a.host._index,d=this._wrapOffset=a.host.shape._wrapOffsets[0]||0,c=this._graphic.getLayer()._getTransform(),e;a=h.map(this._getBoxCoords(!0),
function(a){return{x:a[0]+d,y:a[1]}});e=this._isTextPoint?this._map.toScreen(this._graphic.geometry):{x:a[1].x,y:a[3].y};this._centerCoord=g.multiplyPoint(g.invert(c),e);if(8===b)e=g.multiplyPoint(g.invert(c),a[1]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,e)),this._startLine=[this._centerCoord,e],this._moveLine=l.clone(this._startLine);else if(e=g.multiplyPoint(g.invert(c),a[b]),c=g.multiplyPoint(g.invert(c),a[(b+4)%8]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,
e)),this._firstMoverToAnchor=Math.sqrt((e.x-this._centerCoord.x)*(e.x-this._centerCoord.x)+(e.y-this._centerCoord.y)*(e.y-this._centerCoord.y)),this._startBox=c,this._startBox.width=a[4].x-a[0].x,this._startBox.height=a[4].y-a[0].y,this._moveBox=l.clone(this._startBox),this._xfactor=e.x>c.x?1:-1,this._yfactor=e.y>c.y?1:-1,1===b||5===b)this._xfactor=0;else if(3===b||7===b)this._yfactor=0;this._toolbar._beginOperation("BOX");this._toolbar["on"+(8===b?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic)},
_moveHandler:function(a,b){a=a.host._index;var d=this._defaultEventArgs,c,e,f;d.angle=0;d.scaleX=1;d.scaleY=1;if(8===a)c=this._startLine,e=this._moveLine,f=e[1],f.x+=b.dx,f.y+=b.dy,b=this._getAngle(c,e),this._isTextPoint&&(b+=this._graphic.symbol.angle),e=g.rotategAt(b,c[0]),this._graphic.getDojoShape().setTransform(e),d.transform=e,d.angle=b,d.around=c[0];else{c=this._startBox;e=this._moveBox;e.width+=b.dx*this._xfactor;e.height+=b.dy*this._yfactor;this._uniformScaling||this._isTextPoint?(c=e.x+
this._xfactor*e.width,e=e.y+this._yfactor*e.height,c=Math.sqrt((c-this._centerCoord.x)*(c-this._centerCoord.x)+(e-this._centerCoord.y)*(e-this._centerCoord.y)),this._scaleRatio=b=f=c/this._firstMoverToAnchor,c=this._centerCoord):(b=e.width/c.width,f=e.height/c.height,c={x:c.x,y:c.y});if(isNaN(b)||Infinity===b||-Infinity===b)b=1;if(isNaN(f)||Infinity===f||-Infinity===f)f=1;e=g.scaleAt(b,f,c);if(this._isTextPoint){var k=g.rotategAt(this._graphic.symbol.angle,c);this._graphic.getDojoShape().setTransform([k,
e])}else this._graphic.getDojoShape().setTransform(e);d.transform=e;d.scaleX=b;d.scaleY=f;d.around=c}this._toolbar["on"+(8===a?this._rotateEvent:this._scaleEvent)](this._graphic,d)},_moveStopHandler:function(a){this._toolbar._activateScrollWheel();var b=this._graphic,d=this._toolbar,c=d._geo?r.geographicToWebMercator(b.geometry):b.geometry,e=c.spatialReference,f=b.getDojoShape(),g=f.getTransform(),k=b.getLayer()._getTransform();this._isTextPoint?(b=this._graphic.symbol,8===a.host._index?b.angle+=
this._getAngle(this._startLine,this._moveLine):b.font.setSize(Math.round(b.font.size*this._scaleRatio*100)/100),this._graphic.setSymbol(b)):(c=c.toJson(),this._updateSegments(c.paths||c.rings,g,k,e),f.setTransform(null),c=v.fromJson(c),b.setGeometry(d._geo?r.webMercatorToGeographic(c,!0):c));this._draw();this._startLine=this._moveLine=this._startBox=this._moveBox=this._xfactor=this._yfactor=null;d._endOperation("BOX");this._defaultEventArgs.transform=g;d["on"+(8===a.host._index?this._rotateEvent:
this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs)},_updateSegments:function(a,b,d,c){var e=this._map,f=this._wrapOffset||0;h.forEach(a,function(a){h.forEach(a,function(a){this._updatePoint(a,c,f,g,e,d,b)},this)},this)},_updatePoint:function(a,b,d,c,e,f,g){b=e.toScreen({x:a[0],y:a[1],spatialReference:b},!0);b.x+=d;b=c.multiplyPoint([f,g,c.invert(f)],b);b.x-=d;d=e.toMap(b);a[0]=d.x;a[1]=d.y},_getAngle:function(a,b){return 180*Math.atan2(b[0].y-b[1].y,b[0].x-b[1].x)/Math.PI-180*Math.atan2(a[0].y-
a[1].y,a[0].x-a[1].x)/Math.PI},_deNormalizePoint:function(a,b){var d=this._map._getFrameWidth();if(-1===d)return a;for(a={x:a.x,y:a.y};Math.abs(a.x-b.x)>=d;)a.x=a.x<b.x?a.x+d:a.x-d;var c=Math.abs(a.x-b.x);Math.abs(a.x-b.x+d)<c?a.x+=d:Math.abs(a.x-b.x-d)<c&&(a.x-=d);return a}});l.setObject("toolbars._Box",c,k);return c})},"dojox/gfx/Moveable":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/_base/event dojo/topic dojo/touch dojo/dom-class dojo/_base/window ./Mover dojo/mouse".split(" "),
function(c,l,h,a,e,f,d,b,g,k){return l("dojox.gfx.Moveable",null,{constructor:function(a,b){this.shape=a;this.delay=b&&0<b.delay?b.delay:0;this.mover=b&&b.mover?b.mover:g;this.leftButtonOnly=b&&b.leftButtonOnly;this.events=[this.shape.on(f.press,c.hitch(this,"onMouseDown"))]},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.events=this.shape=null},onMouseDown:function(b){this.delay?(this.events.push(this.shape.on(f.move,c.hitch(this,"onMouseMove")),this.shape.on(f.release,c.hitch(this,
"onMouseUp"))),this._lastX=b.clientX,this._lastY=b.clientY):this.leftButtonOnly&&!k.isLeft(b)||new this.mover(this.shape,b,this);a.stop(b)},onMouseMove:function(b){var d=b.clientY;if(Math.abs(b.clientX-this._lastX)>this.delay||Math.abs(d-this._lastY)>this.delay)this.onMouseUp(b),new this.mover(this.shape,b,this);a.stop(b)},onMouseUp:function(a){this.events.pop().remove()},onMoveStart:function(a){e.publish("/gfx/move/start",a);d.add(b.body(),"dojoMove")},onMoveStop:function(a){e.publish("/gfx/move/stop",
a);d.remove(b.body(),"dojoMove")},onFirstMove:function(a){},onMove:function(a,b,d){this.onMoving(a,b,d);this.shape.applyLeftTransform(b);this.onMoved(a,b)},onMoving:function(a,b){},onMoved:function(a,b){}})})},"dojox/gfx/Mover":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/on dojo/touch dojo/_base/event".split(" "),function(c,l,h,a,e,f){return h("dojox.gfx.Mover",null,{constructor:function(d,b,g){this.shape=d;this.lastX=b.clientX;this.lastY=b.clientY;d=this.host=g;b=
document;g=a(b,e.move,c.hitch(this,"onFirstMove"));this.events=[a(b,e.move,c.hitch(this,"onMouseMove")),a(b,e.release,c.hitch(this,"destroy")),a(b,"dragstart",c.hitch(f,"stop")),a(b,"selectstart",c.hitch(f,"stop")),g];if(d&&d.onMoveStart)d.onMoveStart(this)},onMouseMove:function(a){var b=a.clientX,d=a.clientY;this.host.onMove(this,{dx:b-this.lastX,dy:d-this.lastY},a);this.lastX=b;this.lastY=d;f.stop(a)},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove()},destroy:function(){l.forEach(this.events,
function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.shape=null}})})},"esri/toolbars/_GraphicMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/dom-style dojox/gfx/Moveable dojox/gfx/Mover dojox/gfx/matrix ../kernel ../PointerEvents ../sniff ../geometry/webMercatorUtils ../geometry/ScreenPoint ../geometry/Point".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n){var r=c(null,{declaredClass:"esri.toolbars._GraphicMover",
constructor:function(a,b,d,c){this.graphic=a;this.map=b;this.toolbar=d;this.tempPt=c;this._enableGraphicMover();this._moved=!1},refresh:function(a){var b=this.graphic.getDojoShape();!b||!a&&b._hostGraphic||(this._disableGraphicMover(),this._enableGraphicMover())},destroy:function(){this._disableGraphicMover()},hasMoved:function(){return this._moved},_enableGraphicMover:function(){var a=this.graphic,b=a.getDojoShape();b&&(b._hostGraphic=a,this._moveable=new f(b,{mover:r.Mover}),this._moveStartHandle=
h.connect(this._moveable,"onMoveStart",this,this._moveStartHandler),this._firstMoveHandle=h.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=h.connect(this._moveable,"onMoving",this,this._movingHandler),this._moveStopHandle=h.connect(this._moveable,"onMoveStop",this,this._moveStopHandler),(a=b.getEventSource())&&e.set(a,"cursor",this.toolbar._cursors.move))},_disableGraphicMover:function(){var a=this._moveable;if(a){h.disconnect(this._moveStartHandle);h.disconnect(this._firstMoveHandle);
h.disconnect(this._movingHandle);h.disconnect(this._moveStopHandle);var b=a.shape;b&&(b._hostGraphic=null,(b=b.getEventSource())&&e.set(b,"cursor","inherit"));a.destroy()}this._moveable=null},_moveStartHandler:function(){var a=this.graphic,b=this.map;this._startTx=a.getDojoShape().getTransform();"point"===this.graphic.geometry.type&&b.snappingManager&&b.snappingManager._setUpSnapping();this.toolbar.onGraphicMoveStart(a)},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic)},
_movingHandler:function(a,b,d){a=a.shape.getTransform();b=this.map;var c;m("esri-pointer")?c=b.navigationManager.pointerEvents._processTouchEvent(d,d):d&&"pointermove"===d.type&&(c=k.prototype._processTouchEvent.call({map:b},d,d));c&&b.snappingManager&&b.snappingManager._onSnappingMouseMoveHandler(c);this.tempPt&&this.tempPt.getDojoShape().setTransform(a);this.toolbar.onGraphicMove(this.graphic,a)},_moveStopHandler:function(d){var c=this.graphic,e=this.toolbar,f=this.map,g=e._geo?p.geographicToWebMercator(c.geometry):
c.geometry,k=g.type,m=c.getDojoShape(),r=m.getTransform();if(a.toJson(r)!==a.toJson(this._startTx)){this._moved=!0;switch(k){case "point":var k=[r,b.invert(this._startTx)],v;f.snappingManager&&(v=f.snappingManager._snappingPoint);g=v||f.toMap(b.multiplyPoint(k,f.toScreen(g,!0)));f.snappingManager&&f.snappingManager._killOffSnapping();break;case "polyline":g=this._updatePolyGeometry(g,g.paths,r);break;case "polygon":g=this._updatePolyGeometry(g,g.rings,r)}m.setTransform(null);c.setGeometry(e._geo?
p.webMercatorToGeographic(g,!0):g);this.tempPt&&this.tempPt.setGeometry(new n(c.geometry.toJson()))}else this._moved=!1;e._endOperation("MOVE");e.onGraphicMoveStop(c,r);this._moved||(d=d.__e,f=this.map.position,d=new q(d.pageX-f.x,d.pageY-f.y),e.onGraphicClick(c,{screenPoint:d,mapPoint:this.map.toMap(d)}))},_updatePolyGeometry:function(a,b,d){var c=this.map,e=a.getPoint(0,0),c=c.toMap(c.toScreen(e).offset(d.dx,d.dy));d=c.x-e.x;for(var e=c.y-e.y,f,g,k,c=0;c<b.length;c++)for(g=b[c],f=0;f<g.length;f++)k=
a.getPoint(c,f),a.setPoint(c,f,k.offset(d,e));return a}});r.Mover=c(d,{declaredClass:"esri.toolbars._Mover",constructor:function(a,b,d){this.__e=b}});l.setObject("toolbars._GraphicMover",r,g);l.setObject("toolbars._Mover",r.Mover,g);return r})},"esri/toolbars/_VertexEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dijit/Menu dijit/MenuItem ../kernel ./_VertexMover ../geometry/Point ../geometry/jsonUtils dojo/i18n!../nls/jsapi".split(" "),function(c,
l,h,a,e,f,d,b,g,k,m,p){var q=c(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(a,b,d){this.graphic=a;this.map=b;this.toolbar=d;a=d._options;this._symbol1=a.vertexSymbol;this._symbol2=a.ghostVertexSymbol;b=a.ghostLineSymbol;this._lineStroke={style:b.style,width:b.width,color:b.color};this._canDel=a.allowDeleteVertices;this._canAdd=a.allowAddVertices;this._addControllers()},destroy:function(){this._removeControllers()},refresh:function(a){a?(this._removeControllers(),this._addControllers()):
(this._refresh(this._vertexMovers),this._refresh(this._mpVertexMovers))},suspend:function(){this._suspended||this._removeControllers();this._suspended=!0},resume:function(){this._suspended&&this._addControllers();this._suspended=!1},_addControllers:function(){this._firstMoveHandle=h.connect(g,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=h.connect(g,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);this._canAdd&&
(this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,!0));var a=this._getGraphicsLayer();this._mouseOverHandle=h.connect(a,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=h.connect(a,"onMouseOut",this,this._mouseOutHandler);this._canDel&&(this._ctxMenu=new f({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"}),a=this._ctxDelete=new d({label:p.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}),this._deleteHandle=
h.connect(a,"onClick",this,this._deleteHandler),this._ctxMenu.addChild(a),this._ctxMenu.startup())},_removeControllers:function(){h.disconnect(this._firstMoveHandle);h.disconnect(this._moveStopHandle);h.disconnect(this._mouseOverHandle);h.disconnect(this._mouseOutHandle);h.disconnect(this._deleteHandle);this._ctxMenu&&(this._ctxDelete=null,this._unbindCtxNode(),this._ctxMenu.destroyRecursive());this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=
null},_add:function(a,b,d){var c,e,f=this.graphic,k=[];for(c=0;c<a.length;c++){var n=a[c],m=[];for(e=0;e<n.length;e++)m.push(new g(n[e],b,f,c,e,n.length,this,d));k.push(m)}return k},_remove:function(b){b&&a.forEach(b,function(b){a.forEach(b,function(a){a.destroy()})})},_refresh:function(b){b&&a.forEach(b,function(b){a.forEach(b,function(a){a.refresh()})})},_isNew:function(b){return-1===a.indexOf(this._vertexMovers[b.segIndex],b)?!0:!1},_getGraphicsLayer:function(){return this.toolbar._scratchGL},
_deleteHandler:function(a){a=this._selectedMover;this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,!1,!0);this._canAdd&&this._deleteMidpoints(a);this._deleteVertex(a);this.toolbar._endOperation("VERTICES")},_mouseOverHandler:function(a){a=a.graphic;var b=this._findMover(a);b&&(this.toolbar.onVertexMouseOver(this.graphic,b._getInfo()),b._placeholder||(this._selectedMover=b,this._canDel&&this._bindCtxNode(a.getDojoShape().getNode())))},_mouseOutHandler:function(a){if(a=
this._findMover(a.graphic))this.toolbar.onVertexMouseOut(this.graphic,a._getInfo())},_bindCtxNode:function(a){this._unbindCtxNode();this._ctxDelete.set("disabled",this._selectedMover.segLength<=this.minLength?!0:!1);this._ctxMenu.bindDomNode(a);this._bindNode=a},_unbindCtxNode:function(){var a=this._bindNode;a&&this._ctxMenu.unBindDomNode(a)},_findMover:function(b){var d,c=[];d=this._mpVertexMovers;a.forEach(this._vertexMovers,function(a){c=c.concat(a)});d&&a.forEach(d,function(a){c=c.concat(a)});
for(d=0;d<c.length;d++){var e=c[d];if(e.graphic===b)return e}},_firstMoveHandler:function(a){!this._isNew(a)&&this._canAdd&&this._hideRelatedMidpoints(a);this.toolbar._beginOperation("VERTICES")},_moveStopHandler:function(a,b){var d=this._isNew(a);b&&(b.dx||b.dy)?(this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,d),this._canAdd&&(d?this._addMidpoints(a):(this._repositionRelatedMidpoints(a),this._showRelatedMidpoints(a))),this.toolbar._endOperation("VERTICES")):
!d&&this._canAdd&&this._showRelatedMidpoints(a)},_showRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),d=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++){var c=d[b[a]];c.graphic.show();c.refresh()}},_hideRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),d=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++)d[b[a]].graphic.hide()},_repositionRelatedMidpoints:function(a){var b,d=this._getAdjacentMidpoints(a.ptIndex,a.segLength),
c=this._mpVertexMovers[a.segIndex];for(b=0;b<d.length;b++){var e=this._getAdjacentVertices(d[b],a.segLength),f=a.relatedGraphic.geometry.getPoint(a.segIndex,e[0]),e=a.relatedGraphic.geometry.getPoint(a.segIndex,e[1]),f=new k({x:(f.x+e.x)/2,y:(f.y+e.y)/2,spatialReference:f.spatialReference.toJson()});c[d[b]].graphic.setGeometry(f)}},_addMidpoints:function(a){var b=a.segIndex,d=a.ptIndex,c=a.segLength,e=d+1,f,m=c+1;this._mpVertexMovers[b].splice(d,1);var n=this._vertexMovers[b];for(f=0;f<e;f++)n[f].segLength+=
1;for(f=e;f<n.length;f++)n[f].ptIndex+=1,n[f].segLength+=1;a.ptIndex=e;a.segLength=n.length+1;n.splice(e,0,a);a.graphic.setSymbol(this._symbol1);n=this._mpVertexMovers[b];for(f=0;f<d;f++)n[f].segLength+=1;for(f=d;f<c-1;f++)n[f].ptIndex+=1,n[f].segLength+=1;e=this._getAdjacentVertices(d,m);b=this._getAdjacentVertices(d+1,m);c=a.relatedGraphic.geometry.getPoint(a.segIndex,e[0]);f=a.relatedGraphic.geometry.getPoint(a.segIndex,e[1]);e=new k({x:(c.x+f.x)/2,y:(c.y+f.y)/2,spatialReference:c.spatialReference.toJson()});
c=a.relatedGraphic.geometry.getPoint(a.segIndex,b[0]);f=a.relatedGraphic.geometry.getPoint(a.segIndex,b[1]);b=new k({x:(c.x+f.x)/2,y:(c.y+f.y)/2,spatialReference:c.spatialReference.toJson()});c=new g(e,this._symbol2,this.graphic,a.segIndex,d,m,this,!0);a=new g(b,this._symbol2,this.graphic,a.segIndex,d+1,m,this,!0);n.splice(d,0,c,a)},_deleteVertex:function(a){var b,d=a.ptIndex,c=this._vertexMovers[a.segIndex];for(b=0;b<d;b++)--c[b].segLength;for(b=d+1;b<c.length;b++){var e=c[b];--e.ptIndex;--e.segLength}c.splice(d,
1);b=a._getInfo();a.destroy();this.toolbar.onVertexDelete(this.graphic,b)}});l.mixin(q,{create:function(a,b,d){switch(a.geometry.type){case "multipoint":return new q.MultipointVertexEditor(a,b,d);case "polyline":return new q.PolylineVertexEditor(a,b,d);case "polygon":return new q.PolygonVertexEditor(a,b,d)}}});q.MultipointVertexEditor=c(q,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=h.connect(g,"onMoveStart",this,this._moveStartHandler);
h.disconnect(this._firstMoveHandle)},destroy:function(){this.inherited(arguments);h.disconnect(this._moveStartHandle)},_getSegments:function(a){var b=a.points,d=[],c=a.spatialReference;for(a=0;a<b.length;a++){var e=b[a];d.push(new k({x:e[0],y:e[1],spatialReference:c.toJson()}))}return[d]},_getMidpointSegments:function(a){return[]},_getControlPoints:function(a,b,d,c,e){return[]},_getGraphicsLayer:function(){return this.graphic._graphicsLayer},_mouseOverHandler:function(a){var b=a.graphic;if(a=this._findMover(a))this.toolbar.onVertexMouseOver(b,
a._getInfo()),this._selectedMover=a,this._canDel&&this._bindCtxNode(a.graphic.getDojoShape().getNode())},_mouseOutHandler:function(a){var b=a.graphic;if(a=this._findMover(a))this.toolbar.onVertexMouseOut(b,a._getInfo())},_findMover:function(a){var b=[].concat(this._vertexMovers[0]),d=a.target;for(a=0;a<b.length;a++){var c=b[a];if(c.graphic.getDojoShape().getNode()===d)return c}},_moveStartHandler:function(a){var b=a.ptIndex,d=a.segLength-1,c=a.relatedGraphic.geometry.points;a=c.splice(b,1);c.push(a[0]);
c=this._vertexMovers[0];for(a=d;a>b;a--)--c[a].ptIndex;a=c.splice(b,1);c.push(a[0]);a[0].ptIndex=d},_moveStopHandler:function(a){this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength);this.toolbar._endOperation("VERTICES")},_updateRelatedGraphic:function(a,b,d,c,e,f,g,k){a=b.geometry;k?a.removePoint(e):a.setPoint(e,d);b.setGeometry(a)},_deleteMidpoints:function(a){}});q.PolylineVertexEditor=c(q,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,
_getSegments:function(a){var b,d,c=a.paths,e=[];for(b=0;b<c.length;b++){var f=c[b],g=[];for(d=0;d<f.length;d++)g.push(a.getPoint(b,d));e.push(g)}return e},_getMidpointSegments:function(a){var b,d,c=a.paths,e=[],f=a.spatialReference;for(b=0;b<c.length;b++){var g=c[b],m=[];for(d=0;d<g.length-1;d++){var n=a.getPoint(b,d),q=a.getPoint(b,d+1),n=new k({x:(n.x+q.x)/2,y:(n.y+q.y)/2,spatialReference:f.toJson()});m.push(n)}e.push(m)}return e},_getControlPoints:function(a,b,d,c,e){var f=this.map,g,k;this._isNew(a)?
(a=c,c+=1,0<=a&&(g=f.toScreen(b.getPoint(d,a))),c<=e&&(k=f.toScreen(b.getPoint(d,c)))):(a=c-1,c+=1,0<=a&&(g=f.toScreen(b.getPoint(d,a))),c<e&&(k=f.toScreen(b.getPoint(d,c))));return[g,k]},_getAdjacentMidpoints:function(a,b){var d=[],c=a-1;0<=c&&d.push(c);a<b-1&&d.push(a);return d},_getAdjacentVertices:function(a,b){return[a,a+1]},_deleteMidpoints:function(a){var b=this._mpVertexMovers[a.segIndex],d=b.length-1,c=this._getAdjacentMidpoints(a.ptIndex,a.segLength).sort(),e,f=c[0];for(e=0;e<f;e++)--b[e].segLength;
for(e=f+1;e<b.length;e++){var m=b[e];--m.ptIndex;--m.segLength}if(1===c.length)b.splice(f,1)[0].destroy();else for(m=this._getAdjacentVertices(f,d),e=a.relatedGraphic.geometry.getPoint(a.segIndex,m[0]),m=a.relatedGraphic.geometry.getPoint(a.segIndex,m[1]),e=new k({x:(e.x+m.x)/2,y:(e.y+m.y)/2,spatialReference:e.spatialReference.toJson()}),a=new g(e,this._symbol2,this.graphic,a.segIndex,f,d,this,!0),b=b.splice(f,c.length,a),e=0;e<b.length;e++)b[e].destroy()},_updateRelatedGraphic:function(a,b,d,c,e,
f,g,k){a=b.geometry;g?a.insertPoint(c,e+1,m.fromJson(d.toJson())):k?a.removePoint(c,e):a.setPoint(c,e,m.fromJson(d.toJson()));b.setGeometry(a)}});q.PolygonVertexEditor=c(q,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(a){var b,d,c=a.rings,e=[];for(b=0;b<c.length;b++){var f=c[b],g=[];for(d=0;d<f.length-1;d++)g.push(a.getPoint(b,d));e.push(g)}return e},_getMidpointSegments:function(a){var b,d,c=a.rings,e=[],f=a.spatialReference;for(b=0;b<c.length;b++){var g=c[b],
m=[];for(d=0;d<g.length-1;d++){var n=a.getPoint(b,d),q=a.getPoint(b,d+1),n=new k({x:(n.x+q.x)/2,y:(n.y+q.y)/2,spatialReference:f.toJson()});m.push(n)}e.push(m)}return e},_getControlPoints:function(a,b,d,c,e){var f=this.map;this._isNew(a)?a=c:(a=c-1,a=0>a?(e+a)%e:a);c=(c+1)%e;e=f.toScreen(b.getPoint(d,a));b=f.toScreen(b.getPoint(d,c));return[e,b]},_getAdjacentMidpoints:function(a,b){var d=a-1;return[0>d?(b+d)%b:d,a]},_getAdjacentVertices:function(a,b){return[a,(a+1)%b]},_deleteMidpoints:function(a){var b=
a.ptIndex,d=this._mpVertexMovers[a.segIndex],c=d.length-1,e=this._getAdjacentMidpoints(b,a.segLength).sort(),f,m;m=e[0];var n=e[e.length-1];if(0===b)for(f=this._getAdjacentVertices(c-1,c),b=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]),f=a.relatedGraphic.geometry.getPoint(a.segIndex,f[1]),b=new k({x:(b.x+f.x)/2,y:(b.y+f.y)/2,spatialReference:b.spatialReference.toJson()}),a=new g(b,this._symbol2,this.graphic,a.segIndex,c-1,c,this,!0),d.splice(n,1,a)[0].destroy(),d.splice(m,1)[0].destroy(),e=
0;e<d.length-1;e++)m=d[e],--m.ptIndex,--m.segLength;else{f=this._getAdjacentVertices(m,c);b=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]);f=a.relatedGraphic.geometry.getPoint(a.segIndex,f[1]);b=new k({x:(b.x+f.x)/2,y:(b.y+f.y)/2,spatialReference:b.spatialReference.toJson()});a=new g(b,this._symbol2,this.graphic,a.segIndex,m,c,this,!0);n=d.splice(m,e.length,a);for(e=0;e<n.length;e++)n[e].destroy();for(e=0;e<m;e++)--d[e].segLength;for(e=m+1;e<d.length;e++)m=d[e],--m.ptIndex,--m.segLength}},_updateRelatedGraphic:function(a,
b,d,c,e,f,g,k){a=b.geometry;g?a.insertPoint(c,e+1,m.fromJson(d.toJson())):k?(a.removePoint(c,e),0===e&&a.setPoint(c,f-1,m.fromJson(a.getPoint(c,0).toJson()))):(a.setPoint(c,e,m.fromJson(d.toJson())),0===e&&a.setPoint(c,f,m.fromJson(d.toJson())));b.setGeometry(a)}});l.setObject("toolbars._GraphicVertexEditor",q,b);l.setObject("toolbars._MultipointVertexEditor",q.MultipointVertexEditor,b);l.setObject("toolbars._PolylineVertexEditor",q.PolylineVertexEditor,b);l.setObject("toolbars._PolygonVertexEditor",
q.PolygonVertexEditor,b);return q})},"esri/toolbars/_VertexMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/sniff dojo/dom-style dojox/gfx/Moveable ../kernel ../PointerEvents ../sniff ../geometry/Point ../graphic ../geometry/webMercatorUtils".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p){c=c(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(a,b,d,c,e,f,g,k){this.point=a;this.symbol=b;this.relatedGraphic=d;this.segIndex=c;this.ptIndex=e;this.segLength=
f;this.editor=g;this.map=g.map;this._scratchGL=g.toolbar._scratchGL;this._placeholder=k||!1;this._type=d.geometry.type;this._init();this._enable()},refresh:function(a){if(a||this._needRefresh())this._disable(),this._enable()},destroy:function(){this._disable();this.graphic&&this._scratchGL.remove(this.graphic);this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null},_init:function(){var a=new k(this.point.toJson()),
a=new m(a,this.symbol);switch(this._type){case "multipoint":a._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(a)}this.graphic=a},_enable:function(){var a=this.graphic.getDojoShape();a&&(a._hasMover=!0,this._moveable=this._getMoveable(a),(a=a.getEventSource())&&e.set(a,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]))},_disable:function(){var a=this._moveable;if(a){h.disconnect(this._startHandle);
h.disconnect(this._firstHandle);h.disconnect(this._movingHandle);h.disconnect(this._stopHandle);var b=a.shape;b&&(b=b.getEventSource())&&e.set(b,"cursor","inherit");a.destroy();this._moveable=null}},_needRefresh:function(){var a=this.graphic.getDojoShape(),b=!1;if(a)switch(this._type){case "multipoint":var d=this.relatedGraphic.getDojoShape();d&&(d=d.children[this.ptIndex],a!==d&&(this.graphic._shape=d,b=!0));break;case "polyline":case "polygon":b=!a._hasMover}return b},_getMoveable:function(b){b=
new f(b,a("mac")&&a("ff")&&!g("esri-touch")&&{leftButtonOnly:!0});this._startHandle=h.connect(b,"onMoveStart",this,this._moveStartHandler);this._firstHandle=h.connect(b,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=h.connect(b,"onMoving",this,this._movingHandler);this._stopHandle=h.connect(b,"onMoveStop",this,this._moveStopHandler);return b},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0)},_getInfo:function(){return{graphic:this.graphic,isGhost:this._placeholder,
segmentIndex:this.segIndex,pointIndex:this._getPtIndex()}},_moveStartHandler:function(a){var b=this.map;b.snappingManager&&b.snappingManager._setUpSnapping();this.editor.toolbar._deactivateScrollWheel();a.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo())},_firstMoveHandler:function(a){var b=a.shape,d=this._getControlEdges(),c=this._scratchGL._div,e,f=[],g=a.host.shape._wrapOffsets[0]||0;for(e=0;e<d.length;e++){var k=d[e];
k.x1+=g;k.x2+=g;f.push([c.createLine({x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2}).setStroke(this.editor._lineStroke),k.x1,k.y1,k.x2,k.y2])}b._lines=f;a.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo())},_movingHandler:function(a,d,c){d=this.map;var e;g("esri-pointer")?e=d.navigationManager.pointerEvents._processTouchEvent(c,c):c&&"pointermove"===c.type&&(e=b.prototype._processTouchEvent.call({map:d},c,c));e&&d.snappingManager&&
d.snappingManager._onSnappingMouseMoveHandler(e);c=a.shape;a=c.getTransform();c=c._lines;for(e=0;e<c.length;e++)d=c[e],d[0].setShape({x1:d[1]+a.dx,y1:d[2]+a.dy,x2:d[3],y2:d[4]});this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),a)},_moveStopHandler:function(a){a=a.shape;var b=this.editor.toolbar,d=a.getTransform(),c=this.map,e=this.graphic,f=b._geo?p.geographicToWebMercator(e.geometry):e.geometry;b._activateScrollWheel();var g,k=a._lines;if(k){for(g=0;g<k.length;g++)k[g][0].removeShape();
a._lines=null}g=!1;var k=!0,m=this._getInfo();d&&(d.dx||d.dy)?this._placeholder&&(this._placeholder=!1,g=!0):k=!1;var q;c.snappingManager&&(q=c.snappingManager._snappingPoint);q=q||c.toMap(c.toScreen(f).offset(d.dx,d.dy));c.snappingManager&&c.snappingManager._killOffSnapping();a.setTransform(null);e.setGeometry(b._geo?p.webMercatorToGeographic(q,!0):q);this.constructor.onMoveStop(this,d);b.onVertexMoveStop(this.relatedGraphic,m,d);if(!k)b.onVertexClick(this.relatedGraphic,m);if(g)b.onVertexAdd(this.relatedGraphic,
this._getInfo())},_getControlEdges:function(){var a=this.map,b=this.relatedGraphic.geometry,d=this.segIndex,c=this.ptIndex,e=this.segLength,f=this._scratchGL._getTransform(),g=f.dx,f=f.dy,k=a.toScreen(this.graphic.geometry),a=k.x-g,k=k.y-f,m=[],b=this.editor._getControlPoints(this,b,d,c,e);b[0]&&m.push({x1:a,y1:k,x2:b[0].x-g,y2:b[0].y-f});b[1]&&m.push({x1:a,y1:k,x2:b[1].x-g,y2:b[1].y-f});return m}});l.setObject("toolbars.VertexMover",c,d);l.mixin(c,{onMoveStart:function(){},onFirstMove:function(){},
onMoveStop:function(){}});return c})},"esri/toolbars/TextEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/has dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys ../kernel".split(" "),function(c,l,h,a,e,f,d,b,g,k){c=c(null,{declaredClass:"esri.toolbars.TextEditor",constructor:function(a,b,d){this._graphic=a;this._map=b;this._toolbar=d;this._enable(this._graphic)},destroy:function(){this._disable()},onEditStart:function(){},onEditEnd:function(){},
_enable:function(b){this._editBox?(h.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null):(this._map.navigationManager.setImmediateClick(!0),this._addEditBoxHandler=h.connect(b.getLayer(),"onDblClick",this,function(d){this._map.navigationManager.setImmediateClick(!1);d.graphic==b&&(a.stop(d),h.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null,this._addTextBox(b))}))},_disable:function(){this._applyEdit();this._addEditBoxHandler&&(h.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=
null);this._removeTextBox();this.onEditEnd(this._graphic);this._toolbar.onTextEditEnd(this._graphic)},_addTextBox:function(a,c){if(!this._editBox){var e;a.symbol.text||(a.symbol.text="Tempt text",a.setSymbol(a.symbol),e="");var k=this._createInputTextStyle(a,this._map);""!==e&&(e=c||a.symbol.text);this._editBox=f.create("input",{type:"text",value:e});b.set(this._editBox,k);d.add(this._editBox,"esriTextEditorInput");this._map.container.appendChild(this._editBox);this._editBox.focus();this._editBoxKeyHandler=
h.connect(this._editBox,"onkeyup",l.hitch(this,function(a){a.keyCode!=g.ENTER&&a.keyCode!==g.TAB||this._disable()}));this._editBoxBlurHandler=h.connect(this._editBox,"onblur",l.hitch(this,function(a){this._disable()}));a.symbol.text="";a.setSymbol(a.symbol);a.hide();var m=this._editBox;this._disableBoxHandler||(this._disableBoxHandler=this._map.on("zoom-start",l.hitch(this,function(){this._disable()})));this._moveBoxHandler=this._map.on("pan",function(a){b.set(m,{left:this._editBoxLeft+a.delta.x+
"px",top:this._editBoxTop+a.delta.y+"px"})});this._moveBoxStartHandler=this._map.on("pan-start",function(){this._editBoxLeft=parseFloat(b.get(m,"left"));this._editBoxTop=parseFloat(b.get(m,"top"))});this.onEditStart(a,this._editBox);this._toolbar.onTextEditStart(a,this._editBox)}},_removeTextBox:function(){this._editBoxBlurHandler&&(h.disconnect(this._editBoxBlurHandler),this._editBoxBlurHandler=null);this._editBox&&(this._editBox.parentNode.removeChild(this._editBox),this._editBox=null);this._disableBoxHandler&&
(this._disableBoxHandler.remove(),this._disableBoxHandler=null);this._moveBoxHandler&&(this._moveBoxHandler.remove(),this._moveBoxHandler=null);this._moveBoxStartHandler&&(this._moveBoxStartHandler.remove(),this._moveBoxStartHandler=null);this._editBoxKeyHandler&&(h.disconnect(this._editBoxKeyHandler),this._editBoxKeyHandler=null)},_createInputTextStyle:function(a,b){b=a.getDojoShape().getTransformedBoundingBox();var d=a.symbol.font;return{"font-family":d.family,"font-size":d.size+"px","font-style":d.style,
"font-variant":d.variant,"font-weight":d.weight,left:b[0].x+"px",top:b[0].y+"px",width:Math.abs(b[0].x-b[1].x)/Math.cos(a.symbol.angle/180*Math.PI)+"px"}},_applyEdit:function(){if(this._editBox)if(this._editBox.value){this._graphic.show();var a=this._graphic.symbol;a.text=this._editBox.value;this._graphic.setSymbol(a)}else this._graphic.getLayer().remove(this._graphic)}});l.setObject("toolbars.TextEditor",c,k);return c})},"esri/dijit/editing/Add":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),
function(c,l,h,a,e,f){l=l(f,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(a){a=a||{};a.featureLayer&&(this._featureLayer=a.featureLayer,a.addedGraphics&&(this._addedGraphics=a.addedGraphics))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._addedGraphics,a,b)},performUndo:function(){return this._featureLayer.applyEdits(null,null,this._addedGraphics).then(h.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},
performRedo:function(){var a=c.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,null,null).then(h.hitch(this,function(b,d,e){b=c.map(b,function(a){return a.objectId});return{oldIds:a,addedIds:b,layer:this._featureLayer,operation:this}}))}});h.setObject("dijit.editing.Add",l,e);return l})},"esri/dijit/editing/EditOperationBase":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/has",
"../../kernel","../../OperationBase"],function(c,l,h,a,e){l=l(e,{declaredClass:"esri.EditOperationBase",updateIds:function(a,d,b,e){c.forEach(d,function(d,f){var g=d[a.objectIdField];c.forEach(b,function(b,c){g===b&&(d[a.objectIdField]=e[c])})})}});return a.EditOperationBase=l})},"esri/dijit/editing/Update":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),function(c,l,h,a,e,f,d){c=l(d,{declaredClass:"esri.dijit.editing.Update",
type:"edit",label:"Update Features",constructor:function(a){var b;a=a||{};if(a.featureLayer&&(this._featureLayer=a.featureLayer,a.preUpdatedGraphics)){this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(b=0;b<a.preUpdatedGraphics.length;b++)this._preUpdatedGraphicsGeometries.push(a.preUpdatedGraphics[b].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(a.preUpdatedGraphics[b].attributes);if(a.postUpdatedGraphics)for(this._postUpdatedGraphics=a.postUpdatedGraphics,
this._postUpdatedGraphicsGeometries=[],this._postUpdatedGraphicsAttributes=[],b=0;b<a.postUpdatedGraphics.length;b++)a.postUpdatedGraphics[b].geometry?this._postUpdatedGraphicsGeometries.push(a.postUpdatedGraphics[b].geometry.toJson()):this._postUpdatedGraphicsGeometries.push(a.postUpdatedGraphics[b].geometry),this._postUpdatedGraphicsAttributes.push(h.clone(a.postUpdatedGraphics[b].attributes))}},updateObjectIds:function(a,d){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,
d);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,d)},performUndo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._preUpdatedGraphicsGeometries[a]?this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[a])):this._postUpdatedGraphics[a].setGeometry(this._preUpdatedGraphicsGeometries[a]),this._postUpdatedGraphics[a].setAttributes(this._preUpdatedGraphicsAttributes[a]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,
null).then(h.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._postUpdatedGraphicsGeometries[a]?this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[a])):this._postUpdatedGraphics[a].setGeometry(this._postUpdatedGraphicsGeometries[a]),this._postUpdatedGraphics[a].setAttributes(this._postUpdatedGraphicsAttributes[a]);return this._featureLayer.applyEdits(null,
this._postUpdatedGraphics,null).then(h.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});h.setObject("dijit.editing.Update",c,e);return c})},"esri/dijit/editing/Delete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(c,l,h,a,e,f){l=l(f,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(a){a=a||{};a.featureLayer&&(this._featureLayer=a.featureLayer,
a.deletedGraphics&&(this._deletedGraphics=a.deletedGraphics))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._deletedGraphics,a,b)},performUndo:function(){var a=c.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,null,null).then(h.hitch(this,function(b,d,e){b=c.map(b,function(a){return a.objectId});return{oldIds:a,addedIds:b,layer:this._featureLayer,operation:this}}))},
performRedo:function(){return this._featureLayer.applyEdits(null,null,this._deletedGraphics).then(h.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});h.setObject("dijit.editing.Delete",l,e);return l})},"esri/dijit/editing/Cut":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),function(c,l,h,a,e,f,d){l=l(d,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",
constructor:function(a){var b;a=a||{};if(a.featureLayer&&(this._featureLayer=a.featureLayer,a.addedGraphics&&(this._addedGraphics=a.addedGraphics,a.preUpdatedGraphics))){this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(b=0;b<a.preUpdatedGraphics.length;b++)this._preUpdatedGraphicsGeometries.push(a.preUpdatedGraphics[b].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(a.preUpdatedGraphics[b].attributes);if(a.postUpdatedGraphics)for(this._postUpdatedGraphics=
a.postUpdatedGraphics,this._postUpdatedGraphicsGeometries=[],this._postUpdatedGraphicsAttributes=[],b=0;b<a.postUpdatedGraphics.length;b++)this._postUpdatedGraphicsGeometries.push(a.postUpdatedGraphics[b].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(h.clone(a.postUpdatedGraphics[b].attributes))}},updateObjectIds:function(a,d){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,d);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,d);this.updateIds(this._featureLayer,
this._addedGraphics,a,d)},performUndo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[a])),this._postUpdatedGraphics[a].setAttributes(this._preUpdatedGraphicsAttributes[a]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics).then(h.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[a])),
this._postUpdatedGraphics[a].setAttributes(this._postUpdatedGraphicsAttributes[a]);var d=c.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null).then(h.hitch(this,function(a,b,e){a=c.map(a,function(a){return a.objectId});return{oldIds:d,addedIds:a,layer:this._featureLayer,operation:this}}))}});h.setObject("dijit.editing.Cut",l,e);return l})},"esri/dijit/editing/Union":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(c,l,h,a,e,f,d){l=l(d,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(a){a=a||{};this._featureLayer=a.featureLayer;this._deletedGraphics=a.deletedGraphics;this._preUpdatedGraphics=a.preUpdatedGraphics;this._postUpdatedGraphics=a.postUpdatedGraphics;this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];var b;for(b=0;b<a.preUpdatedGraphics.length;b++)this._preUpdatedGraphicsGeometries.push(a.preUpdatedGraphics[b].geometry.toJson()),
this._preUpdatedGraphicsAttributes.push(a.preUpdatedGraphics[b].attributes);for(b=0;b<a.postUpdatedGraphics.length;b++)this._postUpdatedGraphicsGeometries.push(a.postUpdatedGraphics[b].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(h.clone(a.postUpdatedGraphics[b].attributes))},updateObjectIds:function(a,d){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,d);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,d);this.updateIds(this._featureLayer,
this._deletedGraphics,a,d)},performUndo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[a])),this._postUpdatedGraphics[a].setAttributes(this._preUpdatedGraphicsAttributes[a]);var d=c.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,this._postUpdatedGraphics,null).then(h.hitch(this,function(a,
b,e){a=c.map(a,function(a){return a.objectId});return{oldIds:d,addedIds:a,layer:this._featureLayer,operation:this}}))},performRedo:function(){var a;for(a=0;a<this._postUpdatedGraphics.length;a++)this._postUpdatedGraphics[a].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[a])),this._postUpdatedGraphics[a].setAttributes(this._postUpdatedGraphicsAttributes[a]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._deletedGraphics).then(h.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))}});h.setObject("dijit.editing.Union",l,e);return l})},"esri/dijit/editing/toolbars/Drawing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/_CssStateMixin ../Util ./ToolbarBase ../tools/ButtonToolBase ../tools/Cut ../tools/Union ../tools/Reshape ../tools/Editing ../tools/EditingTools ../tools/Selection ../tools/SelectionTools ../../../kernel".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u){c=c([b,f],{declaredClass:"esri.dijit.editing.toolbars.Drawing",
onShowAttributeInspector:function(){},_activateTool:function(a,b){this._settings.editor._activeTool=a;"EDITING"!==a&&this._settings.templatePicker.clearSelection();"ATTRIBUTES"!==a&&this._settings.editor._hideAttributeInspector();"CLEAR"!==a&&this.inherited(arguments)},_initializeToolbar:function(){h.forEach(this._settings.layers,function(b){this._tbConnects.push(a.connect(b,"onSelectionComplete",this,"_updateUI"))},this)},activateEditing:function(a,b){this._tools.EDITING._activateTool(a,b.geometryType);
this._activeTool=this._tools.EDITING;this._activeTool.setChecked(!0)},_updateUI:function(){this._settings.undoManager&&(this._tools.UNDO.set("disabled",!1===this._settings.undoManager.canUndo),this._tools.REDO.set("disabled",!1===this._settings.undoManager.canRedo));this._selectedFeatures=d.getSelection(this._settings.layers);var a=this._selectedFeatures.length;this._tools.DELETE&&this._tools.DELETE.set("disabled",0>=a);this._tools.CLEAR&&this._tools.CLEAR.set("disabled",0>=a);this._tools.ATTRIBUTES&&
this._tools.ATTRIBUTES.set("disabled",0>=a);this._tools.UNION&&this._tools.UNION.set("disabled",2>a)},_toolFinished:function(a){if("ATTRIBUTES"===a&&this._selectedFeatures&&this._selectedFeatures.length)this.onShowAttributeInspector(this._selectedFeatures[0]);if("SELECT"===a||"CUT"===a||"RESHAPING"===a||"EDITING"===a)this._activeTool.deactivate(),this._activeTool.setChecked(!1),this._activeTool=null;if("DELETE"===a)this.onDelete();this._settings.editor._activeTool=null;this._updateUI()},_createTools:function(){this._tools.SELECT=
new r({settings:this._settings,onClick:l.hitch(this,"_activateTool","SELECT",!0),onFinished:l.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new g(l.mixin(v.selectClear,{settings:this._settings,onClick:l.hitch(this._settings.editor,"_clearSelection",!1)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new g(l.mixin(n.attributes,{settings:this._settings,onClick:l.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);
this._createSeparator();this._tools.EDITING=new q({settings:this._settings,onClick:l.hitch(this,"_activateTool","EDITING",!0),onApplyEdits:l.hitch(this,"onApplyEdits"),onFinished:l.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new g(l.mixin(n.del,{settings:this._settings,onClick:l.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);this._settings.toolbarOptions&&((this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||
this._settings.toolbarOptions.reshapeVisible)&&this._createSeparator(),this._settings.toolbarOptions.cutVisible&&(this._tools.CUT=new k({settings:this._settings,onFinished:l.hitch(this,"_toolFinished","CUT"),onClick:l.hitch(this,"_activateTool","CUT",!0),onApplyEdits:l.hitch(this,"onApplyEdits")}),this.addChild(this._tools.CUT)),this._settings.toolbarOptions.mergeVisible&&(this._tools.UNION=new m({settings:this._settings,onFinished:l.hitch(this,"_toolFinished","UNION"),onApplyEdits:l.hitch(this,"onApplyEdits")}),
this.addChild(this._tools.UNION)),this._settings.toolbarOptions.reshapeVisible&&(this._tools.RESHAPING=new p({settings:this._settings,onClick:l.hitch(this,"_activateTool","RESHAPING",!0),onFinished:l.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:l.hitch(this,"onApplyEdits")}),this.addChild(this._tools.RESHAPING)));this._settings.enableUndoRedo&&(this._createSeparator(),this._tools.UNDO=new g(l.mixin(n.undo,{settings:this._settings,disabled:!0,onClick:l.hitch(this,function(){this._tools.UNDO.set("disabled",
!0);this._tools.REDO.set("disabled",!0);this._settings.editor._undo()})})),this.addChild(this._tools.UNDO),this._tools.REDO=new g(l.mixin(n.redo,{settings:this._settings,disabled:!0,onClick:l.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._redo()})})),this.addChild(this._tools.REDO))}});l.setObject("dijit.editing.toolbars.Drawing",c,u);return c})},"esri/dijit/editing/toolbars/ToolbarBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/Toolbar dijit/ToolbarSeparator ../../../kernel ../../../lang".split(" "),
function(c,l,h,a,e,f,d,b,g){c=c([f],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:!0,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(a,b){a&&a.settings&&(this._tools=[],this._tbConnects=[],this._initialize(a.settings))},postCreate:function(){this._createTools();this.deactivate()},destroy:function(){var b,d=this._tools;for(b in d)d.hasOwnProperty(b)&&g.isDefined(this._tools[b])&&this._tools[b].destroy();h.forEach(this._tbConnects,
a.disconnect);this.inherited(arguments)},activate:function(a){this._enabled=!0},deactivate:function(){var a;this._enabled=!1;this._geometryType=this._layer=null;var b=this._tools;for(a in b)b.hasOwnProperty(a)&&(this._tools[a].deactivate(),this._tools[a].setChecked(!1))},isEnabled:function(){return this._enabled},setActiveSymbol:function(a){this._activeSymbol=a},_getSymbol:function(){},_createTools:function(){},_initialize:function(a){this._settings=a;this._toolbar=a.drawToolbar;this._editToolbar=
a.editToolbar;this._initializeToolbar()},_activateTool:function(a,b){this._activeTool&&this._activeTool.deactivate();!0===b&&this._activeTool==this._tools[a]?(this._activeTool.setChecked(!1),this._activeTool=null):(this._activeTool=this._tools[a],this._activeTool.setChecked(!0),this._activeTool.activate(null))},_createSeparator:function(){this.addChild(new d)}});l.setObject("dijit.editing.toolbars.ToolbarBase",c,b);return c})},"esri/dijit/editing/tools/ButtonToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/Button ./ToolBase ../../../kernel".split(" "),
function(c,l,h,a,e,f){c=c([a,e],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){a.prototype.destroy.apply(this,arguments);e.prototype.destroy.apply(this,arguments)}});l.setObject("dijit.editing.tools.ButtonToolBase",c,f);return c})},"esri/dijit/editing/tools/ToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../../../kernel","dojo/i18n!../../../nls/jsapi"],
function(c,l,h,a,e){c=c(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:!0,showLabel:!1,constructor:function(a,d){a=a||{};l.mixin(this,a);this.label=this._label?e.widgets.editor.tools[this._label]:"";this._settings=a.settings;this._toolbar=a.settings.drawToolbar;this._editToolbar=a.settings.editToolbar;this._initializeTool()},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments)},destroy:function(){},
activate:function(a){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this._enabled&&(this._checked=!0,this._layer=a,this._toolbar&&this._drawType&&this._toolbar.activate(this._drawType))},deactivate:function(){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this.setChecked(!1);this._updateUI()},setEnabled:function(a){this._enabled=a;this._updateUI()},setChecked:function(a){this._checked=a},enable:function(a){this._updateUI()},
isEnabled:function(){return this._enabled},getToolName:function(){return this._toolName},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon)}});l.setObject("dijit.editing.tools.ToolBase",c,a);return c})},"esri/dijit/editing/tools/Cut":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/DeferredList ../../../graphicsUtils ../../../graphic ../../../tasks/query ../../../layers/FeatureLayer ../../../toolbars/draw ../Cut ./ToggleToolBase ../../../kernel".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n){c=c([q],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:m.POLYLINE,_enabled:!0,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(a.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments)},deactivate:function(){this.inherited(arguments);h.forEach(this._cutConnects,a.disconnect);this._cutConnects=[];this._edits=[]},
_onDrawEnd:function(b){var d=this._cutLayers=h.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});this._cutConnects=this._cutConnects.concat(h.map(d,l.hitch(this,function(b){return a.connect(b,"onEditsComplete",l.hitch(this,function(a,b,d){if(this._settings.undoRedoManager){var c=this._settings.undoRedoManager;h.forEach(this._edits,l.hitch(this,function(a){c.add(new p({featureLayer:a.layer,
addedGraphics:a.adds,preUpdatedGraphics:a.preUpdates,postUpdatedGraphics:a.updates}))}),this)}this.onFinished()}))})));var c=new g;c.geometry=b;h.forEach(d,function(a,b){this._settings.editor._selectionHelper.selectFeatures([a],c,k.SELECTION_NEW,l.hitch(this,"_cutFeatures",a,c))},this)},_cutFeatures:function(a,b,c){if(c&&c.length){this._edits=[];var e=[];e.push(this._settings.geometryService.cut(d.getGeometries(c),b.geometry,l.hitch(this,"_cutHandler",a,c)));(new f(e)).addCallback(l.hitch(this,function(){this.onApplyEdits(this._edits)}))}},
_cutHandler:function(a,d,c){var e=[],f=[],g=h.map(d,function(a){return new b(l.clone(a.toJson()))}),k,m;h.forEach(c.cutIndexes,function(a,g){k!=a?(k=a,f.push(d[a].setGeometry(c.geometries[g]))):(m=new b(c.geometries[g],null,l.mixin({},d[a].attributes),null),m.attributes[d[0].getLayer().objectIdField]=null,e.push(m))},this);this._edits.push({layer:a,adds:e,updates:f,preUpdates:g})}});l.setObject("dijit.editing.tools.Cut",c,n);return c})},"esri/dijit/editing/tools/ToggleToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/ToggleButton ./ToolBase ../../../kernel".split(" "),
function(c,l,h,a,e,f){c=c([a,e],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){a.prototype.destroy.apply(this,arguments);e.prototype.destroy.apply(this,arguments)},setChecked:function(d){a.prototype.setChecked.apply(this,arguments)}});l.setObject("dijit.editing.tools.ToggleToolBase",c,f);return c})},"esri/dijit/editing/tools/Union":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../graphicsUtils ../../../graphic ../../../toolbars/draw ../Union ./ButtonToolBase ../../../kernel".split(" "),
function(c,l,h,a,e,f,d,b,g,k){c=c([g],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:d.POLYLINE,_enabled:!0,_label:"NLS_unionLbl",_onClick:function(a){this._settings.editor._activeTool="UNION";a=h.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});var d=[],c=0;h.forEach(a,function(a,g){var k=a.getSelectedFeatures();2<=
k.length&&(c++,this._settings.geometryService.union(e.getGeometries(k),l.hitch(this,function(e){var g=k.shift(),m=[],n=[];m.push(new f(g.toJson()));n.push(g.setGeometry(e));d.push({layer:a,updates:n,deletes:k,preUpdates:m});c--;if(0>=c)this.onApplyEdits(d,l.hitch(this,function(){if(this._settings.undoRedoManager){var a=this._settings.undoRedoManager;h.forEach(this._edits,l.hitch(this,function(d){a.add(new b({featureLayer:d.layer,deletedGraphics:d.deletes,preUpdatedGraphics:d.preUpdates,postUpdatedGraphics:d.updates}))}),
this)}this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()}))})))},this)}});l.setObject("dijit.editing.tools.Union",c,k);return c})},"esri/dijit/editing/tools/Reshape":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has ../../../graphic ../../../layers/FeatureLayer ../../../tasks/query ../../../toolbars/draw ./ToggleToolBase ../../../kernel".split(" "),function(c,l,h,a,e,f,d,b,g,k,m){c=c([k],{declaredClass:"esri.dijit.editing.tools.Reshape",
id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:g.POLYLINE,_enabled:!0,_label:"NLS_reshapeLbl",activate:function(){a.disconnect(this._rConnect);this._rConnect=a.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments)},deactivate:function(){this.inherited(arguments);a.disconnect(this._rConnect);delete this._rConnect},_onDrawEnd:function(a){var c=this._settings.layers,e=new b;e.geometry=a;a=this._reshapeLayers=h.filter(c,
function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"});this._settings.editor._selectionHelper.selectFeatures(a,e,d.SELECTION_NEW,l.hitch(this,"_reshape",e))},_reshape:function(a,b){if(1===b.length){var d=[],c=[],e=[],g=b[0],k=g.getLayer();this._settings.geometryService.reshape(g.geometry,a.geometry,l.hitch(this,function(a){"polyline"===a.type&&a.paths&&0===a.paths.length?(this._settings.editor._selectionHelper.clearSelection(!1),this.onFinished()):"polygon"===a.type&&a.rings&&
0===a.rings.length?(this._settings.editor._selectionHelper.clearSelection(!1),this.onFinished()):(e.push(new f(g.toJson())),c.push(g.setGeometry(a)),d.push({layer:k,updates:c,preUpdates:e}),this.onApplyEdits(d,l.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()})))}))}}});l.setObject("dijit.editing.tools.Reshape",c,m);return c})},"esri/dijit/editing/tools/Editing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../layers/FeatureTemplate ./Edit ./EditingTools ./DropDownToolBase ../../../kernel ../../../lang".split(" "),
function(c,l,h,a,e,f,d,b,g,k){c=c([b],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:!1,deactivate:function(){this._enabled&&(this._enabled=!1,this.inherited(arguments),this._settings.templatePicker.clearSelection())},onItemClicked:function(a,b){this.inherited(arguments);this._activeTool===this._tools.AUTOCOMPLETE&&(this._settings.editor._drawingTool=e.TOOL_AUTO_COMPLETE_POLYGON)},_activateTool:function(a,b){var d;this.enable(b);for(d in this._tools)this._tools.hasOwnProperty(d)&&(this.dropDown.removeChild(this._tools[d]),
!0===this._tools[d]._enabled&&this.dropDown.addChild(this._tools[d]));if(this._geometryType!==b||!1===this._activeTool._enabled)this._activeTool=this._tools[a.toUpperCase()];this._geometryType=b;this._activeTool.activate();this._activeTool.setChecked(!0);this._updateUI()},_initializeTool:function(a){this.inherited(arguments);this._initializeTools()},_initializeTools:function(){var a=this._settings.layers,b=this._settings.editor,d=!1,c=!1,e=!1,f=this._toolTypes=[],g;h.forEach(a,function(a){g=a.geometryType;
d=d||"esriGeometryPoint"===g;c=c||"esriGeometryPolyline"===g;e=e||"esriGeometryPolygon"===g;f=f.concat(h.map(this._getTemplatesFromLayer(a),l.hitch(this,function(d){return b._toDrawTool(d.drawingTool,a)})))},this);a=this._settings.createOptions;d&&this._toolTypes.push("point");c&&(this._toolTypes=this._toolTypes.concat(a.polylineDrawTools));e&&(this._toolTypes=this._toolTypes.concat(a.polygonDrawTools));this._toolTypes=this._toUnique(this._toolTypes.concat(f))},_toUnique:function(a){var b={};return h.filter(a,
function(a){return b[a]?!1:b[a]=!0})},_getTemplatesFromLayer:function(a){var b=a.templates||[];h.forEach(a.types,function(a){b=b.concat(a.templates)});return h.filter(b,k.isDefined)},_createTools:function(){h.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments)},_createTool:function(a){var b=l.mixin(d[a],{settings:this._settings,onClick:l.hitch(this,"onItemClicked",d[a].id)});this._tools[a.toUpperCase()]=new f(b)}});l.setObject("dijit.editing.tools.Editing",c,g);return c})},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./MenuItemBase","../../../kernel"],function(c,l,h,a,e){c=c([a],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(a){this._enabled=a===this._geomType;this.inherited(arguments)}});l.setObject("dijit.editing.tools.Edit",c,e);return c})},"esri/dijit/editing/tools/MenuItemBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/MenuItem ./ToolBase ../../../kernel".split(" "),function(c,l,h,a,e,f){c=c([a,e],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",
destroy:function(){a.prototype.destroy.apply(this,arguments);e.prototype.destroy.apply(this,arguments)}});l.setObject("dijit.editing.tools.MenuItemBase",c,f);return c})},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","../../../toolbars/draw","../../../kernel"],function(c,l,h,a){l={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:h.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},
polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:h.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:h.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",
_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:h.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:h.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:h.POLYGON,
_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:h.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:h.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",
_drawType:h.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:h.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:h.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",
_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:h.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:h.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:h.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},
triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:h.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:!1,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:!1,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",
_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:!1,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:!1,_label:"NLS_redoLbl"}};c.setObject("dijit.editing.tools.EditingTools",l,a);return l})},"esri/dijit/editing/tools/DropDownToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-style dijit/registry dijit/Menu dijit/form/ComboButton ./ToolBase ../../../kernel ../../../lang".split(" "),
function(c,l,h,a,e,f,d,b,g,k){c=c([d,b],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:!1,_checked:!1,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){var a,b=this._tools;for(a in b)b.hasOwnProperty(a)&&k.isDefined(b[a])&&b[a].destroy();this.inherited(arguments)},_createTools:function(){var a,b=new f;this.dropDown=b;for(a in this._tools)this._tools.hasOwnProperty(a)&&b.addChild(this._tools[a]);
this._activeTool=b.getChildren()[0];this._updateUI()},activate:function(a){this.inherited(arguments);this._activeTool?this._activeTool.activate():this._activateDefaultTool()},deactivate:function(){this.inherited(arguments);this._activeTool&&this._activeTool.deactivate()},enable:function(a){for(var b in this._tools)this._tools.hasOwnProperty(b)&&this._tools[b].enable(a);this.setEnabled(!0);this.inherited(arguments)},setChecked:function(a){this._checked=a;this._updateUI()},_onDrawEnd:function(a){},
onLayerChange:function(a,b,d){this._activeTool=null;this._activeType=b;this._activeTemplate=d;this._activeLayer=a},onItemClicked:function(a,b){this._activeTool&&this._activeTool.deactivate();this._activeTool=e.byId(a);!1===this._checked?this._onClick():(this._updateUI(),this._activeTool&&(this._activeTool.activate(),this._activeTool.setChecked(!0)))},_onClick:function(a){!1!==this._enabled&&(this._checked=!this._checked,this.inherited(arguments))},_updateUI:function(){this.attr("disabled",!this._enabled);
a.set(this.focusNode,{outline:"none"});a.set(this.titleNode,{padding:"0px",border:"none"});this._checked?a.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"}):a.set(this.titleNode,{backgroundColor:"",border:""});this._activeTool&&(this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon),this.attr("label",this._activeTool.label))}});l.setObject("dijit.editing.tools.DropDownToolBase",c,g);return c})},"esri/dijit/editing/tools/Selection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleFillSymbol ./Edit ./SelectionTools ./DropDownToolBase ../../../kernel".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q){c=c([p],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:!0,activate:function(){this.inherited(arguments);this._sConnect=a.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd")},deactivate:function(){this.inherited(arguments);a.disconnect(this._sConnect);delete this._sConnect},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"]},_onDrawEnd:function(a){this.inherited(arguments);
this._settings.editor._hideAttributeInspector();var b=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(b,a,this._selectMethod,l.hitch(this,"onFinished"))},_createSymbols:function(){this._pointSelectionSymbol=new d(d.STYLE_CIRCLE,10,new b(b.STYLE_SOLID,new e([0,0,0]),1),new e([255,0,0,.5]));this._polylineSelectionSymbol=new b(b.STYLE_SOLID,new e([0,200,255]),2);this._polygonSelectionSymbol=new g(g.STYLE_SOLID,new b(b.STYLE_SOLID,
new e([0,0,0]),1),new e([0,200,255,.5]))},_initializeLayers:function(){h.forEach(this._settings.layers,this._setSelectionSymbol,this)},_setSelectionSymbol:function(a){var b=null;switch(a.geometryType){case "esriGeometryPoint":b=this._pointSelectionSymbol;break;case "esriGeometryPolyline":b=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":b=this._polygonSelectionSymbol}a.setSelectionSymbol(a._selectionSymbol||b)},_createTools:function(){h.forEach(this._toolTypes,this._createTool,this);
this.inherited(arguments)},_createTool:function(a){var b=l.mixin(m[a],{settings:this._settings,onClick:l.hitch(this,"onItemClicked",m[a].id)});this._tools[a.toUpperCase()]=new k(b)}});l.setObject("dijit.editing.tools.Selection",c,q);return c})},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","../../../layers/FeatureLayer","../../../toolbars/draw","../../../kernel"],function(c,l,h,a,e){l={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",
_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:a.EXTENT,_selectMethod:h.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:a.EXTENT,_selectMethod:h.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:a.EXTENT,_selectMethod:h.SELECTION_SUBTRACT,
_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:!1,_label:"NLS_selectionClearLbl"}};c.setObject("dijit.editing.tools.SelectionTools",l,e);return l})},"esri/dijit/editing/SelectionHelper":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dojo/DeferredList ../../geometry/Extent ../../geometry/Point ../../geometry/ScreenPoint ../../layers/FeatureLayer ../../tasks/query ../../kernel".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p){c=c(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(a){this._settings=a||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers)},destroy:function(){for(var a in this._sConnects)this._sConnects.hasOwnProperty(a)&&h.disconnect(this._sConnects[a])},selectFeatures:function(b,d,c,e){c===k.SELECTION_NEW&&(this._resetMapServiceInfos(),
this.getSelection(b));var g=[];a.forEach(b,function(a){if(!0===a.visible&&!0===a._isMapAtVisibleScale()){var b=c;a._isSelOnly&&b===k.SELECTION_NEW&&(b=k.SELECTION_ADD);g.push(a.selectFeatures(d,b))}});(new f(g)).addCallback(l.hitch(this,function(d){var f=[];a.forEach(d,function(d,c){a.forEach(d[1],function(a){(a=b[c]._mode._getFeature(a.attributes[b[c].objectIdField])||null)&&f.push(a)},this)},this);this._mapServiceCount?((d=c===k.SELECTION_SUBTRACT)?(this._resetMapServiceInfos(),this._createLayerDefs(this._getLayerInfosFromSelection(b))):
this._createLayerDefs(this._getLayerInfosFromFeatures(f)),this._updateLayerDefs(this._mapServiceInfos,!1,!(f&&f.length||d),l.hitch(this,e,f))):e(f)}))},selectFeaturesByGeometry:function(a,d,c,e){var f=d;-1!==d.declaredClass.indexOf("Extent")&&d.xmax===d.xmin&&d.ymax===d.ymin&&(f=new b(d.xmax,d.ymax,d.spatialReference));f=-1!==f.declaredClass.indexOf("Point")?this._extentFromPoint(f):f;d=new m;d.geometry=f;this.selectFeatures(a,d,c,e)},clearSelection:function(b){a.forEach(this._nonSelOnlyLayers,function(a){a.clearSelection&&
a.clearSelection()});if(this._mapServiceCount){this._resetMapServiceInfos();var d=this._getLayerInfosFromSelection(this._settings.layers);a.some(d,function(a){return a.oids&&a.oids.length})&&(this._createLayerDefs(d),this._updateLayerDefs(this._mapServiceInfos,!0,b||!1))}},findMapService:function(a){var b=this._map,d=b.layerIds;a=a&&a._url&&a._url.path?a._url.path.toLowerCase():"";var c,e,f;for(e in d)if(d.hasOwnProperty(e)&&(c=b.getLayer(d[e]),f=c._url?c._url.path?c._url.path.toLowerCase().replace("mapserver",
"featureserver"):c._url.toLowerCase().replace("mapserver","featureserver"):"",a.substr(0,f.length)===f&&"esri.layers.ArcGISDynamicMapServiceLayer"===c.declaredClass))return c},getSelection:function(b){var d=[];a.forEach(b,function(a){a._isSelOnly&&d.push(this._createLayerInfo(a))},this);a.forEach(d,function(a){var b=this._createMapServiceInfo(this.findMapService(a.layer));b&&(b.layerInfos[a.layer.layerId]=a)},this)},_initMapServiceInfos:function(b){this._nonSelOnlyLayers=[];this._mapServiceInfos=
[];a.forEach(b,function(a){var b=this.findMapService(a);b?(this._mapServiceCount++,this._createMapServiceInfo(b),b&&b.setDisableClientCaching(!0)):this._nonSelOnlyLayers.push(a)},this)},_createMapServiceInfo:function(a){if(!a)return null;var b=this._mapServiceInfos,d=b[a.id];d||(d=b[a.id]={mapService:a,layerInfos:[],layerDefs:l.mixin([],a.layerDefinitions||[]),origLayerDefs:l.mixin([],a.layerDefinitions||[])});return d},_resetMapServiceInfo:function(b){a.forEach(b.layerInfos,this._resetLayerInfo);
b.layerDefs=l.mixin([],b.origLayerDefs||[])},_resetMapServiceInfos:function(){var a=this._mapServiceInfos,b;for(b in a)a.hasOwnProperty(b)&&this._resetMapServiceInfo(a[b])},_createLayerInfo:function(b,d){var c=b.objectIdField;d=d?[]:b.getSelectedFeatures();return{layer:b,selectedFeatures:d||[],oids:a.map(d,function(a){return a.attributes[c]})}},_resetLayerInfo:function(a){a&&(a.selectedFeatures=[],a.oids=[])},_updateLayerDefs:function(a,b,d,c){for(var e in a)if(a.hasOwnProperty(e)){var f=a[e],g=f.mapService,
k=f.layerDefs=b?l.mixin([],f.origLayerDefs||[]):f.layerDefs;k?(d?c&&c():this._sConnects[g.id]=h.connect(g,"onUpdateEnd",l.hitch(this,"_onMapServiceUpdate",f,b,c)),g.setLayerDefinitions(k,d||!1)):c&&c()}},_onMapServiceUpdate:function(b,d,c){h.disconnect(this._sConnects[b.mapService.id]);a.forEach(b.layerInfos,function(a){if(d)a&&a.layer.clearSelection();else{var b=new m;b.objectIds=a?a.oids:[];b.objectIds.length&&a.layer.selectFeatures(b,k.SELECTION_SUBTRACT)}},this);d&&this._resetMapServiceInfo(b);
c&&c()},_createLayerDefs:function(b){a.forEach(b,function(b){var d=b.layer,c=this._createMapServiceInfo(this.findMapService(b.layer));if(c){var c=c.layerDefs,e=d.layerId,f='("'+d.objectIdField+'" NOT IN (',g=b.oids;g&&g.length&&(a.forEach(b.oids,function(a,b){g=!0;b&&(f+=",");f+="'"+a+"'"}),f+="))",c[e]=c.length&&c[e]&&c[e].length?c[e]+(" AND"+f):f)}},this)},_getLayerInfosFromFeatures:function(b){var d=[];a.forEach(b,function(a){var b=a.getLayer();b&&b._isSelOnly&&(d[b.id]||(d[b.id]=this._createLayerInfo(b,
!0)),d[b.id].selectedFeatures.push(a),d[b.id].oids.push(a.attributes[b.objectIdField]))},this);b=[];for(var c in d)d.hasOwnProperty(c)&&b.push(d[c]);return b},_getLayerInfosFromSelection:function(b){var d=[];a.forEach(b,function(a){a._isSelOnly&&d.push(this._createLayerInfo(a,!1))},this);return d},_extentFromPoint:function(a){var b=this._tolerance,c=this._map,e=c.toScreen(a);a=new g(e.x-b,e.y+b);b=new g(e.x+b,e.y-b);a=c.toMap(a);b=c.toMap(b);return new d(a.x,a.y,b.x,b.y,c.spatialReference)}});l.setObject("dijit.editing.SelectionHelper",
c,p);return c})},"esri/dijit/InfoWindow":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t){var y=c([w,p,q,n,u],{declaredClass:"esri.dijit.InfoWindow",isContainer:!0,
templateString:t,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:!0,isContentShowing:!0,isTitleBarShowing:!0,width:250,height:150,title:"Info Window",setMap:function(a){this.inherited(arguments);k.place(this.domNode,a.root)},startup:function(){if(!this._started){this.inherited(arguments);this._ANCHORS=[y.ANCHOR_UPPERRIGHT,y.ANCHOR_LOWERRIGHT,y.ANCHOR_LOWERLEFT,y.ANCHOR_UPPERLEFT];if(7>f("ie")){var b="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+
m.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,"")+"')",d=k.create("div",null,a.body());m.set(d,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:b});var c=setTimeout(function(){k.destroy(d);clearTimeout(c);c=d=null},100);e.query(".sprite",this.domNode).forEach(function(a){a.style.backgroundImage="none";a.style.filter=b})}this.resize(this.width,this.height);this.hide()}},destroy:function(){this._destroyed||(this.__unregisterMapListeners(),
this.destroyDijits(this._title),this.destroyDijits(this._content),this._title.innerHTML=this._content.innerHTML="",this.inherited(arguments))},resize:function(a,b){if(a&&b){var d=m.set;d(this._topleft,{height:b+"px",marginLeft:a+"px"});d(this._topright,{width:a+"px",height:b+"px"});d(this._user,"width",a-8+"px");d(this._hide,"marginLeft",a-22+"px");d(this._title,"width",a-25+"px");d(this._content,"height",b-37+"px");d(this._bottomleft,{marginLeft:a+"px",marginTop:b+"px"});d(this._bottomright,{width:a-
5+"px",marginTop:b+"px"});this.width=a;this.height=b;this.coords&&this._adjustPosition(this.coords,this.anchor);this.onResize(a,b)}},_adjustPosition:function(a,b){var d=m.set;d(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+"px"});b===y.ANCHOR_UPPERLEFT?d(this._window,{left:null,right:this.width+18+"px",top:null,bottom:this.height+50+"px"}):b===y.ANCHOR_UPPERRIGHT?d(this._window,{left:"6px",right:null,top:null,bottom:this.height+50+"px"}):b===y.ANCHOR_LOWERRIGHT?d(this._window,{left:"6px",
right:null,top:"43px",bottom:null}):b===y.ANCHOR_LOWERLEFT&&d(this._window,{left:null,right:this.width+18+"px",top:"43px",bottom:null})},_getAnchor:function(a){var b=this.map;return b&&a?(a.y<b.height/2?"lower":"upper")+(a.x<b.width/2?"right":"left"):"upperright"},show:function(a,b,d){if(a){a.spatialReference?(this.mapCoords=a,a=this.coords=this.map.toScreen(a,!0)):(this.mapCoords=null,this.coords=a);var c=this.map._getFrameWidth();if(-1!==c&&(a.x%=c,0>a.x&&(a.x+=c),this.map.width>c))for(var e=(this.map.width-
c)/2;a.x<e;)a.x+=c;b&&-1!==h.indexOf(this._ANCHORS,b)||(b=this._getAnchor(a));g.remove(this._pointer,this.anchor);b=this.anchor=this.fixedAnchor||b;this._adjustPosition(a,b);g.add(this._pointer,b);v.show(this.domNode);this.isShowing=!0;if(!d)this.onShow()}},hide:function(a,b){v.hide(this.domNode);this.isShowing=!1;if(!b)this.onHide()},showTitleBar:function(){v.show(this._titlebar);v.show(this._border);this.isTitleBarShowing=!0},hideTitleBar:function(){v.hide(this._titlebar);v.hide(this._border);this.isTitleBarShowing=
!1},showContent:function(){v.show(this._content);v.show(this._border);this.isContentShowing=!0},hideContent:function(){v.hide(this._content);v.hide(this._border);this.isContentShowing=!1},move:function(a,b){b?a=this.coords.offset(a.x,a.y):(this.coords=a,this.mapCoords&&(this.mapCoords=this.map.toMap(a)));m.set(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+"px"})},setFixedAnchor:function(a){a&&-1===h.indexOf(this._ANCHORS,a)||(this.fixedAnchor=a,this.isShowing&&this.show(this.mapCoords||
this.coords,a),this.onAnchorChange(a))},setTitle:function(a){this.destroyDijits(this._title);this.__setValue("_title",a);return this},setContent:function(a){this.destroyDijits(this._content);this.__setValue("_content",a);return this},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content)},onHide:function(){this.__unregisterMapListeners()},onResize:function(){},onAnchorChange:function(){}});l.mixin(y,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",
ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});l.setObject("dijit.InfoWindow",y,r);return y})},"esri/dijit/OverviewMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/has dojo/dom-class dojo/dom-style dojo/dnd/Moveable dijit/_Widget dijit/_Templated ../map ../geometry/Point ../geometry/ScreenPoint ../layers/TiledMapServiceLayer ../layers/DynamicMapServiceLayer ../layers/VectorTileLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/OpenStreetMapLayer ../virtualearth/VETiledLayer ../kernel ../config ../domUtils dojo/text!./templates/OverviewMap.html dojo/i18n!../nls/jsapi".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A){c=c([g,k],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:!0,templateString:F,constructor:function(b,d){l.mixin(this,A.widgets.overviewMap);b=b||{};if(b.map){var c={};d&&(this._detached=!0,c=a.coords(d,!0));this.map=b.map;this.baseLayer=b.baseLayer;this.width=b.width||c.w||this.map.width/4;this.height=b.height||c.h||this.map.height/4;this.attachTo=b.attachTo||"top-right";this.expandFactor=b.expandFactor||2;this.color=b.color||
"#000000";this.opacity=b.opacity||.5;this.maximizeButton=!!b.maximizeButton;this.visible=!!b.visible;if(this.map.loaded)this._initialSetup();else var e=h.connect(this.map,"onLoad",this,function(){h.disconnect(e);e=null;this._initialSetup()});this._detached&&(this.visible=!0);this._maximized=!1}},startup:function(){this.inherited(arguments);(!this.domNode.parentNode||9>e("ie")&&"DIV"!==this.domNode.parentNode.nodeName)&&this.map.container.appendChild(this.domNode);this._detached?(d.set(this._body,
"display","block"),d.set(this._controllerDiv,"display","none"),d.set(this._maximizerDiv,"display","none"),this.map.loaded?this._initialize():h.connect(this.map,"onLoad",this,this._initialize)):("bottom"===this.attachTo.split("-")[0]&&this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv),this.maximizeButton||f.add(this._maximizerDiv,"ovwDisabledButton"),f.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]),f.add(this._controllerDiv,
"ovwShow"),f.add(this._maximizerDiv,"ovwMaximize"),this.visible&&this.map.loaded&&(this.visible=!1,this.show()));d.set(this._focusDiv,"opacity",this.opacity)},destroy:function(){this._deactivate();this.overviewMap&&this.overviewMap.destroy();this.overviewMap=this.baseLayer=null;this.inherited(arguments)},resize:function(a){!a||0>=a.w||0>=a.h||this._resize(a.w,a.h)},show:function(){if(!this.visible){var a=this._controllerDiv;a.title=this.NLS_hide;f.remove(a,"ovwShow");f.add(a,"ovwHide");z.show(this._body);
z.show(this._maximizerDiv);this._initialize();this.visible=!0}},hide:function(){if(this.visible){var a=this._controllerDiv;a.title=this.NLS_show;f.remove(a,"ovwHide");f.add(a,"ovwShow");this._maximized&&this._maximizeHandler();z.hide(this._body);z.hide(this._maximizerDiv);this._deactivate();this.visible=!1}},_initialSetup:function(){if(this._mainMapLayer=this.map.getLayer(this.map.layerIds[0])){var a=this.baseLayer||this._mainMapLayer,b=this.map.spatialReference,d=a.spatialReference;if(d.wkid===b.wkid||
d.wkt===b.wkt){b=a.declaredClass;if(a instanceof n)if(-1!==b.indexOf("VETiledLayer"))this.baseLayer=new C({resourceInfo:a.getResourceInfo(),culture:a.culture,mapStyle:a.mapStyle,bingMapsKey:a.bingMapsKey});else if(-1!==b.indexOf("OpenStreetMapLayer"))this.baseLayer=new y({tileServers:a.tileServers});else if(-1!==b.indexOf("WebTiledLayer")){var b=a.initialExtent,d=a.fullExtent,c=a.tileInfo;this.baseLayer=new a.constructor(a.urlTemplate,{initialExtent:b&&new b.constructor(b.toJson()),fullExtent:d&&
new d.constructor(d.toJson()),tileInfo:c&&new c.constructor(c.toJson()),tileServers:a.tileServers&&a.tileServers.slice(0)})}else this.baseLayer=new u(a.url,{resourceInfo:a.getResourceInfo()});else if(a instanceof r)-1!==b.indexOf("ArcGISImageServiceLayer")?this.baseLayer=new t(a.url):(this.baseLayer=new w(a.url),this.baseLayer.setImageFormat("png24"));else if(a instanceof v)this.baseLayer=new u("https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",{});else return;!this._detached&&
this.visible&&this._controllerDiv&&(a=function(){this.visible=!1;this.show()},this.baseLayer.loaded?a.call(this):h.connect(this.baseLayer,"onLoad",this,a))}}},_visibilityHandler:function(){this.visible?this.hide():this.show()},_maximizeHandler:function(){var a=this._maximizerDiv;this._maximized?(a.title=this.NLS_maximize,f.remove(a,"ovwRestore"),f.add(a,"ovwMaximize"),this._resize(this.width,this.height)):(a.title=this.NLS_restore,f.remove(a,"ovwMaximize"),f.add(a,"ovwRestore"),this._resize(this.map.width,
this.map.height));this._maximized=!this._maximized},_resize:function(a,b){d.set(this._body,{width:a+"px",height:b+"px"});a=B.defaults.map.panDuration;b=this.overviewMap;B.defaults.map.panDuration=0;b&&(b.resize(!0),b.centerAt(this._focusExtent.getCenter()));B.defaults.map.panDuration=a},_initialize:function(){if(this.overviewMap)this._activate();else{var a,b;b=9>e("ie")?this._body.firstChild:this._body.firstElementChild;this.overviewMap=a=new m(b,{slider:!1,showAttribution:!1,logo:!1,lods:this._overviewLods,
wrapAround180:this.map.wrapAround180});h.connect(a,"onLoad",this,function(){this._map_resize_override=l.hitch(a,this._map_resize_override);a.disableMapNavigation();this._activate()});a.addLayer(this.baseLayer)}},_activate:function(){var a=this.map,d=this.overviewMap;this._moveableHandle=new b(this._focusDiv);this._soeConnect=h.connect(a,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=h.connect(a,"onPan",this,this._updateFocus);this._oecConnect=h.connect(d,"onExtentChange",this,this._ovwExtentChangeHandler);
this._opaConnect=h.connect(d,"onPan",this,this._ovwPanHandler);this._ozsConnect=h.connect(d,"onZoomStart",this,function(){z.hide(this._focusDiv)});this._ozeConnect=h.connect(d,"onZoomEnd",this,function(){z.show(this._focusDiv)});this._omsConnect=h.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(a.extent,null,null,null)},_deactivate:function(){h.disconnect(this._soeConnect);h.disconnect(this._ufoConnect);h.disconnect(this._oecConnect);h.disconnect(this._opaConnect);
h.disconnect(this._ozsConnect);h.disconnect(this._ozeConnect);h.disconnect(this._omsConnect);this._moveableHandle&&(this._moveableHandle.destroy(),this._moveableHandle=null)},_syncOverviewMap:function(a,b,d,c){this._suspendPanHandling?this._suspendPanHandling=!1:(this._focusExtent=a,this.overviewMap.setExtent(a.expand(this.expandFactor),!0))},_updateFocus:function(a){this._suspendPanHandling||(this._focusExtent=a,this._drawFocusDiv(a))},_drawFocusDiv:function(a,b){var c=this.overviewMap,e=c.toScreen(new p(a.xmin,
a.ymax,c.spatialReference)),c=c.toScreen(new p(a.xmax,a.ymin,c.spatialReference));a=c.x-e.x;var c=c.y-e.y,f=!0;a>this.overviewMap.width&&c>this.overviewMap.height&&(f=!1);d.set(this._focusDiv,{left:e.x+(b?b.x:0)+"px",top:e.y+(b?b.y:0)+"px",width:a+"px",height:c+"px",display:f?"block":"none"})},_moveStopHandler:function(a){var b=this._moveableHandle.node.style;a=this._focusExtent;var d=this.overviewMap,b=d.toMap(new q(parseInt(b.left,10),parseInt(b.top,10))),c=new p(a.xmin,a.ymax,d.spatialReference);
this._focusExtent=a.offset(b.x-c.x,b.y-c.y);this._maximized?this._maximizeHandler():d.centerAt(this._focusExtent.getCenter());this._suspendPanHandling=!0;this.map.setExtent(this._focusExtent)},_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent)},_ovwPanHandler:function(a,b){this._drawFocusDiv(this._focusExtent,b)}});l.setObject("dijit.OverviewMap",c,x);return c})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r){c=c(q,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(a){try{if(a=l.mixin({bingMapsKey:null,culture:"en-US"},a||{}),this.url=k.getProtocolForWebResource()+"//dev.virtualearth.net/REST/v1",this._url=k.urlToObject(this.url),this.spatialReference=new m({wkid:102100}),this.tileInfo=new p({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},
{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,
scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.1492910708238085,scale:564.248588}]}),this.initialExtent=this.fullExtent=new n(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new m({wkid:102100})),l.mixin(this,a),this.hasAttributionData=this.showAttribution,this._initLayer=l.hitch(this,this._initLayer),this._errorHandler=l.hitch(this,this._errorHandler),this._getTileInfo=l.hitch(this,this._getTileInfo),this.bingMapsKey)this._getTileInfo();else throw Error("BingMapsKey must be provided.");
}catch(u){throw this.onError(u),u;}},_unsetMap:function(a,b){this.inherited("_unsetMap",arguments)},_getTileInfo:function(){if(this.mapStyle){var a=this._url.path+"/Imagery/Metadata/"+this.mapStyle,b=window.location.protocol;if(this.bingMapsKey){var d=this.resourceInfo;!this.loaded&&d?this._initLayer(d):r({url:a,content:l.mixin({},{uriScheme:"https:"===b?"https":"http",key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,
error:this._errorHandler})}}},_initLayer:function(b,c){if(200!==b.statusCode)c=Error(),c.code=b.statusCode,c.message=b.statusDescription,c.details=b.errorDetails,c.authenticationResultCode=b.authenticationResultCode,this.onError(c);else try{this.resourceInfo=h.toJson(b);var e=b.resourceSets[0].resources[0],f=e.imageUrl.replace("{","${");this.tileServers=a.map(e.imageUrlSubdomains,function(a){var b=k.getProtocolForWebResource();return d.substitute(f,{subdomain:a}).replace("http:",b)});this._tsLength=
this.tileServers.length;if(this.loaded)this.refresh(),this.onMapStyleChange();else{this.copyright=this.copyright||"\x26copy; 2017 Microsoft Corporation and its data suppliers";this.loaded=!0;this.onLoad(this);var g=this.loadCallback;g&&(delete this.loadCallback,g(this))}}catch(C){this.onError(C)}},getAttributionData:function(){var a=new b,d=h.fromJson(this.resourceInfo),c;this.hasAttributionData&&d&&(c=l.getObject("resourceSets.0.resources.0.imageryProviders",!1,d));c?a.callback({contributors:c}):
(d=Error("Layer does not have attribution data"),d.log=e.isDebug,a.errback(d));return a},getTileUrl:function(a,b,c){return d.substitute(this.tileServers[b%this._tsLength].replace(/\{/g,"${"),{quadkey:this._getQuadKey(a,b,c),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(a,b,d){var c="",e,f;for(f=a;0<f;f--)a="0",e=1<<f-1,0!=(d&e)&&a++,0!=(b&e)&&(a++,a++),c+=a;return c},setMapStyle:function(a){this.mapStyle=a;this._getTileInfo()},setCulture:function(a){this.culture=a;this._getTileInfo()},
setBingMapsKey:function(a){this.bingMapsKey=a},onMapStyleChange:function(){}});l.mixin(c,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabelsOnDemand",MAP_STYLE_ROAD:"roadOnDemand"});l.setObject("virtualearth.VETiledLayer",c,g);return c})},"esri/dijit/Attribution":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry ../kernel ../lang ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w){c=c(null,{declaredClass:"esri.dijit.Attribution",itemDelimiter:" | ",listClass:"esriAttributionList",itemClass:"esriAttributionItem",lastItemClass:"esriAttributionLastItem",delimiterClass:"esriAttributionDelim",constructor:function(d,c){try{l.mixin(this,d);this._attributions={};this._pendingDfds={};this._activeLayers=[];this._sharedLayers=[];this._layerHandles={};var f=this.domNode=b.byId(c),k=this.map,m="\x3cspan class\x3d'"+this.listClass+"'\x3e\x3c/span\x3e";
f&&(g.set(f,"innerHTML",m),this.listNode=e.query(".esriAttributionList",f)[0],this.itemNodes={});this._eventConnections=[a.connect(k,"onLayerAdd",this,this._onLayerAdd),a.connect(k,"onLayerRemove",this,this._onLayerRemove),a.connect(k,"onLayerSuspend",this,this._onLayerSuspend),a.connect(k,"onLayerResume",this,this._onLayerResume),a.connect(k,"onResize",this,this._adjustFocus),a.connect(k,"onExtentChange",this,this._onExtentChange)];if(k.loaded){var n=k.layerIds.concat(k.graphicsLayerIds),t,p,q=n.length;
for(p=0;p<q;p++)t=k.getLayer(n[p]),t.loaded&&this._onLayerAdd(t)}}catch(N){}},startup:function(){},destroy:function(){h.forEach(this._eventConnections,a.disconnect);k.destroy(this.listNode);var b=this._layerHandles,d;for(d in b)b[d]&&b[d].remove();this.map=this.domNode=this._eventConnections=this.listNode=this._attributions=this._pendingDfds=this.itemNodes=this._activeLayers=this._lastItem=this._sharedLayers=this._layerHandles=null},_onLayerAdd:function(a){try{var b=this._attributions,d=a.id;if(!r.isDefined(b[d])&&
a.showAttribution){if(a.hasAttributionData){var c=a.getAttributionData();this._pendingDfds[d]=1;b[d]=c;c.addBoth(l.partial(this._onAttributionLoad,this,a))}else b[d]=a.copyright||a.copyrightText||"",b[d]?(a.suspended||this._activeLayers.push(d),this._createNode(d)):this._onLayerRemove(a);-1<a.declaredClass.toLowerCase().indexOf("vetiledlayer")&&(this._layerHandles[d]=a.on("map-style-change",l.hitch(this,function(){this._onLayerRemove(a);this._onLayerAdd(a)})))}}catch(B){}},_onAttributionLoad:function(a,
b,d){var c=a._attributions,e=a._pendingDfds,f=b.id;if(e&&e[f]){delete e[f];if(!d||d instanceof Error)d="";c[f]=d?a._createIndexByLevel(d,-1!==b.declaredClass.toLowerCase().indexOf("vetiledlayer")):b.copyright||b.copyrightText||"";c[f]?(b.suspended||a._activeLayers.push(f),a._createNode(f)):a._onLayerRemove(b)}},_onLayerRemove:function(a){try{var b=a.id,d=this.itemNodes,c,e=-1;this._onLayerSuspend(a);this._layerHandles[b]&&this._layerHandles[b].remove();delete this._attributions[b];delete this._pendingDfds[b];
delete this._layerHandles[b];c=this._getGroupIndex(b);-1!==c&&(e=h.indexOf(this._sharedLayers[c],b),-1!==e&&(this._sharedLayers[c].splice(e,1),1>=this._sharedLayers[c].length&&this._sharedLayers.splice(c,1)));d[b]&&-1===e&&k.destroy(d[b]);delete d[b];this._updateLastItem()}catch(z){}},_onLayerSuspend:function(a){try{var b=a.id;if(this._attributions[b]){var d=h.indexOf(this._activeLayers,b),c=this.itemNodes[b];-1!==d&&this._activeLayers.splice(d,1);c&&this._toggleItem(c,!1,this._getGroupIndex(b))}}catch(B){}},
_adjustFocus:function(){var a=this.domNode.scrollWidth>this.domNode.clientWidth,b=p.contains(this.domNode,"esriAttributionOpen");g.set(this.domNode,"tabIndex",a||b?"0":"")},_onLayerResume:function(a){try{var b=a.id,d=this._attributions[b],c=this.itemNodes[b];if(d&&(-1===h.indexOf(this._activeLayers,b)&&this._activeLayers.push(b),c)){var e=l.isString(d)?d:this._getContributorsList(d,this.map.extent,this.map.getLevel());l.isString(d)||g.set(c,"innerHTML",e?e+this._getDelimiter():"");e&&this._toggleItem(c,
!0,this._getGroupIndex(b))}}catch(z){}},_onExtentChange:function(a,b,d,c){try{var e=this._activeLayers,f=this._attributions,k=this.itemNodes,m,n,p,t,q=e.length||0;for(t=0;t<q;t++)if(n=e[t],p=f[n],(m=k[n])&&!l.isString(p)){var r=this._getContributorsList(p,a,c?c.level:-1);g.set(m,"innerHTML",r?r+this._getDelimiter():"");this._toggleItem(m,!!r,-1)}}catch(J){}this._adjustCursorStyle()},_createNode:function(a){if(this.domNode){var b=this._checkShareInfo(a),d=b&&b.sharedWith,d=d&&this.itemNodes[d],c=this.map,
e=this._attributions[a],e=l.isString(e)?e:this._getContributorsList(e,c.extent,c.getLevel()),c=!!e&&!c.getLayer(a).suspended;d?(this.itemNodes[a]=d,this._toggleItem(d,c,b.index)):(a=this.itemNodes[a]=k.create("span",{"class":this.itemClass,innerHTML:e?e+this._getDelimiter():"",style:{display:c?"inline":"none"}},this.listNode),c&&this._setLastItem(a));this._adjustCursorStyle()}},_checkShareInfo:function(a){var b=this._attributions,d,c,e=-1,f=b[a],g;if(f&&l.isString(f)){for(c in b)if(d=b[c],c!==a&&
d&&l.isString(d)&&d.length===f.length&&d.toLowerCase()===f.toLowerCase()){g=c;break}b=this._sharedLayers;d=b.length;if(g){for(c=0;c<d;c++)if(f=b[c],-1!==h.indexOf(f,g)){e=c;f.push(a);break}-1===e&&(e=b.push([g,a])-1)}}return-1<e?{index:e,sharedWith:g}:null},_getGroupIndex:function(a){var b=this._sharedLayers,d,c=b.length,e=-1;for(d=0;d<c;d++)if(-1!==h.indexOf(b[d],a)){e=d;break}return e},_getDelimiter:function(){var a=this.itemDelimiter;return a?"\x3cspan class\x3d'"+this.delimiterClass+"'\x3e"+a+
"\x3c/span\x3e":""},_toggleItem:function(a,b,d){if(-1<d&&!b){d=this._sharedLayers[d];var c,e=d.length,f=this._activeLayers;for(c=0;c<e;c++)if(-1!==h.indexOf(f,d[c]))return}m.set(a,"display",b?"inline":"none");this._updateLastItem()},_updateLastItem:function(){var a=this.listNode.childNodes,b;b=a.length;var d;if(b)for(--b;0<=b;b--)if(d=a[b],"none"!==m.get(d,"display")){this._setLastItem(d);break}this._adjustCursorStyle()},_setLastItem:function(a){var b=this.itemClass,d=this.lastItemClass;this._lastItem&&
p.replace(this._lastItem,b,d);a&&(p.replace(a,d,b),this._lastItem=a)},_createIndexByLevel:function(a,b){a=a.contributors;var d,c,e,f,g=a?a.length:0,k,m,n=new v(4326),p={},t;for(f=0;f<g;f++)for(d=a[f],m=(c=d.coverageAreas)?c.length:0,k=0;k<m;k++)for(e=c[k],t=e.bbox,t={extent:u.geographicToWebMercator(new w(t[1],t[0],t[3],t[2],n)),attribution:d.attribution||"",zoomMin:e.zoomMin-(b&&e.zoomMin?1:0),zoomMax:e.zoomMax-(b&&e.zoomMax?1:0),score:r.isDefined(e.score)?e.score:100,objectId:f},e=t.zoomMin;e<=
t.zoomMax;e++)p[e]=p[e]||[],p[e].push(t);return p},_getContributorsList:function(a,b,d){var c="";if(b&&r.isDefined(d)&&-1<d){a=a[d];d=b.getCenter().normalize();for(var e=a?a.length:0,f=[],g={},c=0;c<e;c++)b=a[c],!g[b.objectId]&&b.extent.contains(d)&&(g[b.objectId]=1,f.push(b));f.sort(function(a,b){return b.score-a.score||a.objectId-b.objectId});e=f.length;for(c=0;c<e;c++)f[c]=f[c].attribution;c=f.join(", ")}return c},_adjustCursorStyle:function(){var a=q.position(this.listNode.parentNode,!0).h;p.contains(this.listNode.parentNode,
"esriAttributionOpen")?(p.remove(this.listNode.parentNode,"esriAttributionOpen"),a>q.position(this.listNode.parentNode,!0).h?(m.set(this.listNode.parentNode,"cursor","pointer"),p.add(this.listNode.parentNode,"esriAttributionOpen")):m.set(this.listNode.parentNode,"cursor","default")):(p.add(this.listNode.parentNode,"esriAttributionOpen"),a<q.position(this.listNode.parentNode,!0).h?m.set(this.listNode.parentNode,"cursor","pointer"):m.set(this.listNode.parentNode,"cursor","default"),p.remove(this.listNode.parentNode,
"esriAttributionOpen"));this._adjustFocus()}});l.setObject("dijit.Attribution",c,n);return c})},"esri/dijit/TimeSlider":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/kernel dojo/has dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_Widget dijit/_Templated dijit/form/HorizontalSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dojox/timing/_base dojox/form/RangeSlider dojo/text!dojox/form/resources/HorizontalRangeSlider.html ../kernel ../lang ../TimeExtent ./_EventedWidget dojo/text!./templates/TimeSlider.html dojo/i18n!../nls/jsapi".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B){e=c([C,k,m],{declaredClass:"esri.dijit.TimeSlider",widgetsInTemplate:!0,templateString:x,intermediateChanges:!1,_slideDuration:1E3,_defaultCount:10,_eventMap:{"time-extent-change":!0,play:!0,pause:!0,next:!0,previous:!0},constructor:function(a,b){l.mixin(this,B.widgets.timeSlider);this._iconClass="tsButton tsPlayButton";this.loop=this.playing=!1;this.thumbCount=1;this.thumbMovingRate=1E3;this._createTimeInstants=!1;this._options=l.mixin({excludeDataAtTrailingThumb:!1,
excludeDataAtLeadingThumb:!1},a.options||{})},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this._timer=new r.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=l.hitch(this,"_bumpSlider",1);this._createSlider()},destroy:function(){this._timer.stop();this.timeStops=this._timer=null;this._slider.destroy();this._slider=null;this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=null);this._hLabels&&(this._hLabels.destroyRecursive(),
this._hLabels=null);this.inherited(arguments)},onTimeExtentChange:function(){},onPlay:function(){},onPause:function(){},onNext:function(){},onPrevious:function(){},_onHorizontalChange:function(){var a=this._sliderToTimeExtent();this.onTimeExtentChange(a)},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay(this._sliderToTimeExtent())):(this._timer.stop(),this.onPause(this._sliderToTimeExtent()));var a=this._getSliderValue();this._offset=l.isArray(a)?
a[1]-a[0]:0},_onNext:function(){this.playing||(this._bumpSlider(1),this.onNext(this._sliderToTimeExtent()))},_onPrev:function(){this.playing||(this._bumpSlider(-1),this.onPrevious(this._sliderToTimeExtent()))},createTimeStopsByCount:function(a,b){a&&a.startTime&&a.endTime&&(b=b||this._defaultCount,this.createTimeStopsByTimeInterval(a,Math.ceil((a.endTime-a.startTime)/(b-1)),"esriTimeUnitsMilliseconds"))},createTimeStopsByTimeInterval:function(a,b,d,c){if(a&&a.startTime&&a.endTime){this.fullTimeExtent=
new y(a.startTime,a.endTime);c&&!0===c.resetStartTime&&this._resetStartTime(this.fullTimeExtent,d);this._timeIntervalUnits=d;c=this.fullTimeExtent.startTime;for(var e=[];c<=a.endTime;)e.push(c),c=a._getOffsettedDate(c,b,d);0<e.length&&e[e.length-1]<a.endTime&&e.push(c);this.setTimeStops(e)}},getCurrentTimeExtent:function(){return this._sliderToTimeExtent()},setTimeStops:function(a){this.timeStops=a||[];this._numTicks=this._numStops=this.timeStops.length;!1===t.isDefined(this.fullTimeExtent)&&(this.fullTimeExtent=
new y(a[0],a[a.length-1]))},setLoop:function(a){this.loop=a},setThumbCount:function(a){this.thumbCount=a;this.singleThumbAsTimeInstant(this._createTimeInstants);this._slider&&this._createSlider()},setThumbIndexes:function(a){this.thumbIndexes=l.clone(a)||[0,1];this._initializeThumbs()},setThumbMovingRate:function(a){this.thumbMovingRate=a;this._timer&&this._timer.setInterval(this.thumbMovingRate)},setLabels:function(a){this.labels=a;this._slider&&this._createSlider()},setTickCount:function(a){this._numTicks=
a;this._slider&&this._createSlider()},singleThumbAsTimeInstant:function(a){this._createTimeInstants=a&&1===this.thumbCount},next:function(){this._onNext()},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(){!0!==this.playing&&(this.playing=!1,this._onPlay())},previous:function(){this._onPrev()},_setIntermediateChangesAttr:function(a){this.intermediateChanges=!!a;this._slider&&this._slider.set("intermediateChanges",!!a)},_updateUI:function(){f.remove(this.playPauseBtn.iconNode,
this._iconClass);this._iconClass=this.playing?"tsButton tsPauseButton":"tsButton tsPlayButton";f.add(this.playPauseBtn.iconNode,this._iconClass);this.previousBtn.set("disabled",this.playing);this.nextBtn.set("disabled",this.playing)},_createSlider:function(){this._slider&&(this._slider.destroy(),this._slider=null);for(var c=this.domNode;c.parentNode&&!c.dir;)c=c.parentNode;c={onChange:l.hitch(this,"_onHorizontalChange"),showButtons:!1,discreteValues:this._numStops,slideDuration:this._slideDuration,
"class":"ts",dir:"ltr",intermediateChanges:this.intermediateChanges};this._ts=d.create("div",{},a.query(".tsTmp",this.domNode)[0],"first");this._timeSliderTicks=d.create("div",{},this._ts,"first");this._timeSliderLabels=d.create("div",{},this._ts);2===this.thumbCount?this._createRangeSlider(c):this._createSingleSlider(c);this.thumbIndexes=this.thumbIndexes||[0,1];this._createHorizRule();this._createLabels();!0===this._createTimeInstants&&a.query(".dijitSliderProgressBarH, .dijitSliderLeftBumper, .dijitSliderRightBumper",
this._ts).forEach(function(a){b.set(a,{background:"none"})});this._initializeThumbs();h.disconnect(this._onChangeConnect);this._onChangeConnect=h.connect(this._slider,"onChange",l.hitch(this,"_updateThumbIndexes"))},_createRangeSlider:function(a){this._isRangeSlider=!0;this._slider=new (c([p,v],{templateString:u}))(a,this._ts)},_createSingleSlider:function(a){this._isRangeSlider=!1;this._slider=new p(a,this._ts)},_createHorizRule:function(){this._hTicks&&(this._hTicks.destroyRecursive(),this._hTicks=
null);2>this._numTicks||(this._hTicks=new q({container:"topDecoration",ruleStyle:"","class":"tsTicks",count:this._numTicks},this._timeSliderTicks))},_createLabels:function(){this._hLabels&&(this._hLabels.destroyRecursive(),this._hLabels=null);this.labels&&0<this.labels.length&&(this._hLabels=new n({labels:this.labels,labelStyle:"","class":"tsLabels"},this._timeSliderLabels))},_initializeThumbs:function(){if(this._slider){this._offset=this._toSliderValue(this.thumbIndexes[1])||0;var a=this._toSliderValue(this.thumbIndexes[0]),
a=a>this._slider.maximum||a<this._slider.minimum?this._slider.minimum:a;if(!0===this._isRangeSlider){var b=this._toSliderValue(this.thumbIndexes[1]),b=b>this._slider.maximum||b<this._slider.minimum?this._slider.maximum:b;this._setSliderValue([a,b<a?a:b])}else this._setSliderValue(a);this._onHorizontalChange()}},_bumpSlider:function(a){var b=this._getSliderValue(),d=b,c=d,e=a;l.isArray(b)&&(c=b[0],d=b[1],e=[{change:a,useMaxValue:!0},{change:a,useMaxValue:!1}]);1E-10>Math.abs(c-this._slider.minimum)&&
0>a||1E-10>Math.abs(d-this._slider.maximum)&&0<a?this._timer.isRunning&&(this.loop?(this._timer.stop(),this._setSliderValue(this._getSliderMinValue()),a=this._sliderToTimeExtent(),this.onTimeExtentChange(a),this._timer.start(),this.playing=!0):this.pause()):this._slider._bumpValue(e)},_updateThumbIndexes:function(){var a=this._getSliderValue();l.isArray(a)?(this.thumbIndexes[0]=this._toSliderIndex(a[0]),this.thumbIndexes[1]=this._toSliderIndex(a[1])):this.thumbIndexes[0]=this._toSliderIndex(a)},_sliderToTimeExtent:function(){if(this.timeStops&&
0!==this.timeStops.length){var a=new y,b=this._getSliderValue(),d,c;l.isArray(b)?(b[0]>b[1]?(c=b[0],d=b[1]):(d=b[0],c=b[1]),a.startTime=new Date(this.timeStops[this._toSliderIndex(d)]),a.endTime=new Date(this.timeStops[this._toSliderIndex(c)]),this._adjustTimeExtent(a)):(a.startTime=!0===this._createTimeInstants?new Date(this.timeStops[this._toSliderIndex(b)]):new Date(this.fullTimeExtent.startTime),a.endTime=!0===this._createTimeInstants?a.startTime:new Date(this.timeStops[this._toSliderIndex(b)]));
return a}},_adjustTimeExtent:function(a){if((!1!==this._options.excludeDataAtTrailingThumb||!1!==this._options.excludeDataAtLeadingThumb)&&a.startTime.getTime()!==a.endTime.getTime()){if(this._options.excludeDataAtTrailingThumb){var b=a.startTime;b.setUTCSeconds(b.getUTCSeconds()+1)}this._options.excludeDataAtLeadingThumb&&(a=a.endTime,a.setUTCSeconds(a.getUTCSeconds()-1))}},_resetStartTime:function(a,b){switch(b){case "esriTimeUnitsSeconds":a.startTime.setUTCMilliseconds(0);break;case "esriTimeUnitsMinutes":a.startTime.setUTCSeconds(0,
0,0);break;case "esriTimeUnitsHours":a.startTime.setUTCMinutes(0,0,0);break;case "esriTimeUnitsDays":a.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsWeeks":a.startTime.setUTCDate(a.startTime.getUTCDate()-a.startTime.getUTCDay());break;case "esriTimeUnitsMonths":a.startTime.setUTCDate(1);a.startTime.setUTCHours(0,0,0,0);break;case "esriTimeUnitsDecades":a.startTime.setUTCFullYear(a.startTime.getUTCFullYear()-a.startTime.getUTCFullYear()%10);break;case "esriTimeUnitsCenturies":a.startTime.setUTCFullYear(a.startTime.getUTCFullYear()-
a.startTime.getUTCFullYear()%100)}},_getSliderMinValue:function(){return this._isRangeSlider?[this._slider.minimum,this._slider.minimum+this._offset]:this._slider.minimum},_toSliderIndex:function(a){a=Math.floor((a-this._slider.minimum)*this._numStops/(this._slider.maximum-this._slider.minimum));0>a&&(a=0);a>=this._numStops&&(a=this._numStops-1);return a},_toSliderValue:function(a){return a*(this._slider.maximum-this._slider.minimum)/(this._numStops-1)+this._slider.minimum},_getSliderValue:function(){return this._slider.get("value")},
_setSliderValue:function(a){this._slider._setValueAttr(a,!1,!1)}});l.setObject("dijit.TimeSlider",e,w);return e})},"esri/dijit/MultidimensionalSlider":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/on dojo/json dijit/form/VerticalSlider dojox/form/VerticalRangeSlider dijit/form/VerticalRule dijit/form/VerticalRuleLabels dijit/form/HorizontalSlider dojox/form/HorizontalRangeSlider dijit/form/HorizontalRule dijit/form/HorizontalRuleLabels dijit/_Widget dijit/_Templated dojox/timing/_base dojo/_base/array dojo/Deferred dojo/DeferredList ../layers/MosaicRule ../layers/DimensionalDefinition ../kernel ../lang ./_EventedWidget dojo/text!./templates/MultidimensionalSlider_vertical.html dojo/text!./templates/MultidimensionalSlider_horizontal.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/touch dojo/query dojo/dom-construct".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L){var R={LAYOUT_VERTICAL:"vertical",LAYOUT_HORIZONTAL:"horizontal"};n=c([z,n,r],{declaredClass:"esri.dijit.MultidimensionalSlider",widgetsInTemplate:!0,templateString:F,nLabels:10,_thumbCount:1,useRanges:void 0,loop:!0,useLayersDimSlices:!0,prefetch:!0,prefetchedValues:{},showPlayButton:!0,prefetchFactor:2,_hasUnitConflict:!1,_update:!0,useDefaults:!1,playDirectionAscending:!0,unitSymbols:{meter:"m",pascal:"Pa"},_eventMap:{"dimension-value-change":!0,
play:!0,pause:!0,next:!0,previous:!0,change:!0,"dimension-array-create":!0},onChange:function(){},onPlay:function(){},onPause:function(){},onDimensionValueChange:function(){},_onPlay:function(){this.playing=!this.playing;this._updateUI();this.playing?(this._timer.start(),this.onPlay()):(this._timer.stop(),this.onPause())},constructor:function(a,b){c.safeMixin(this,a);this.playing=!1;this._iconClass="mdsButton mdsPlayButton";this.map&&this._getImageLayers();this.layout===R.LAYOUT_HORIZONTAL&&(this.templateString=
A);this.thumbMovingRate=this.thumbMovingRate||3E3;this._i18n=E;this.prefetchImgNodes={}},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);var a=this;this._getAllLayersMDInfo().then(function(){a._sortDimensionValues();a.dimensionValues=a.dimensionValues&&a.dimensionValues.length&&!a.useLayersDimSlices?a.dimensionValues:a._mapSortedDimensionValues;a.getUnit();a._setupSlider()});this._timer=new v.Timer;this._timer.setInterval(this.thumbMovingRate);this._timer.onTick=
l.hitch(this,function(){this.playDirectionAscending?this._bumpSlider(1):this._bumpSlider(-1)});this.layout===R.LAYOUT_VERTICAL&&(this.computeSliderStyle(),this.on("resize",l.hitch(this,"computeSliderStyle")));this._setupHandles()},_insertPassiveLabels:function(){var a=J(".dijitSliderMoveable.dijitSliderMoveableV",this.domNode);this._passiveLbl1=L.create("div");N.add(this._passiveLbl1,"esriMdSliderPassiveLbl");L.place(this._passiveLbl1,a[0]);2===this._thumbCount&&(this._passiveLbl2=L.create("div"),
N.add(this._passiveLbl2,"esriMdSliderPassiveLbl"),L.place(this._passiveLbl2,a[1]))},_setupHandles:function(){this._eventHandles=[];this._eventHandles.push(a(this.domNode,"mouseover",l.hitch(this,"activateSlider")));this._eventHandles.push(a(this.domNode,"mouseleave",l.hitch(this,"deactivateSlider")));this._eventHandles.push(a(this.domNode,H.press,l.hitch(this,"activateSlider")));this._eventHandles.push(a(this.domNode,H.release,l.hitch(this,"deactivateSlider")));this._eventHandles.push(a(this.prevBtn.domNode,
H.press,l.hitch(this,"activateSlider")));this._eventHandles.push(a(this.playPauseBtn.domNode,H.press,l.hitch(this,"activateSlider")));this._eventHandles.push(a(this.nextBtn.domNode,H.press,l.hitch(this,"activateSlider")));var b=J(".dijitSliderImageHandle.dijitSliderImageHandleV",this.domNode);u.forEach(b,function(b){this._eventHandles.push(a(b,H.press,l.hitch(this,"activateSlider")));this._eventHandles.push(a(b,H.release,l.hitch(this,"deactivateSlider")))},this)},_removeHandles:function(){u.forEach(this._eventHandles,
function(a){a&&a.remove()})},activateSlider:function(){9>dojo.isIE&&dojo.style(this.domNode,"background","#fff");this.sliderActive=!0;this.deactivateTimer&&clearTimeout(this.deactivateTimer);N.remove(this.domNode,"esriMdSliderPassive");N.add(this.domNode,"esriMdSliderActive");O.set(this._passiveLbl1,"display","none");this._passiveLbl2&&O.set(this._passiveLbl2,"display","none")},deactivateSlider:function(){if(!(10>dojo.isIE)){var a=this;this.deactivateTimer=setTimeout(function(){a.sliderActive=!1;
a.updatePassiveLabels();N.remove(a.domNode,"esriMdSliderActive");N.add(a.domNode,"esriMdSliderPassive");a._showPassiveLabels()},2500)}},updatePassiveLabels:function(){this._slider&&B.isDefined(this._slider.value)&&(this._passiveLbl1.innerHTML=this.value.length?this.value[0]:this.value,this._slider.value.length&&(this._passiveLbl2.innerHTML=this.value[1]),this.sliderActive||this._showPassiveLabels())},_showPassiveLabels:function(){B.isDefined(this.value)&&(O.set(this._passiveLbl1,"display","inline-block"),
this.value.length?O.set(this._passiveLbl2,"display","inline-block"):this._passiveLbl2&&O.set(this._passiveLbl2,"display","none"))},increment:function(){var a=1;!this.playDirectionAscending&&this.playing&&(a=-1);this._bumpSlider(a)},decrement:function(){var a=-1;!this.playDirectionAscending&&this.playing&&(a=1);this._bumpSlider(a)},_setDimensionAttr:function(a){this._slider&&(a.dimension&&(this.dimension=a.dimension),this.dimensionValues=a.dimensionValues&&a.dimensionValues.length?a.dimensionValues:
[],this.update())},update:function(){var a=this;this._mapSortedDimensionValues=[];this._getImageLayers();this.value=this.dimensionValues[this._slider.value];this._getAllLayersMDInfo().then(function(){a._sortDimensionValues();a.getUnit();a.dimensionValues&&a.dimensionValues.length&&!a.useLayersDimSlices||(a.dimensionValues=a._mapSortedDimensionValues);a._setupSlider()})},pause:function(){this.playing=!1;this._updateUI();this._timer.stop()},play:function(a){!0!==this.playing&&(this.playing=!1,this._onPlay())},
_setupSlider:function(){this._destroySlider();this.dimensionValues&&this.dimensionValues.length&&(this.sliderNode=document.createElement("div"),this._getDimensionAlias(),this._layers&&this._layers.length&&1===this._layers.length&&this._readMosaicRule(),this._createRule(),this._createLabels(),this._createSlider(),this._insertPassiveLabels(),this._slider.onChange(this._slider.value))},_createLabels:function(){this.layout===R.LAYOUT_HORIZONTAL?this._createHorizontalLabels():this._createVerticalLabels()},
_createRule:function(){this.layout===R.LAYOUT_HORIZONTAL?this._createHorizontalRule():this._createVerticalRule()},_createVerticalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new g({labels:this._filterLabels(),labelStyle:"font-size: 83%; padding-left: 5px;"},this.labelsNode)},_createVerticalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&
(this._sliderRules=new b({count:this.dimensionValues.length,style:"width:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalLabels:function(){this.labelsNode=document.createElement("div");this.sliderNode.appendChild(this.labelsNode);this._sliderLabels=new q({labels:this._filterLabels(),labelStyle:"font-size: 83%"},this.labelsNode)},_createHorizontalRule:function(){this.rulesNode=document.createElement("div");this.sliderNode.appendChild(this.rulesNode);100>=this.dimensionValues.length&&
(this._sliderRules=new p({count:this.dimensionValues.length,style:"height:5px;"},this.rulesNode),this._sliderRules.startup())},_createHorizontalSingleSlider:function(a){a=a?a:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new k({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width: 100%;",increment:l.hitch(this,"increment"),decrement:l.hitch(this,"decrement"),value:a||0,onChange:l.hitch(this,
this._onSingleSliderChange),showButtons:!1},this.sliderNode);this._slider.startup()},_createHorizontalRangeSlider:function(b){b=b?b:this.playDirectionAscending?[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new m({name:"horizontal",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,style:"width:100%;",increment:l.hitch(this,"increment"),decrement:l.hitch(this,"decrement"),value:b||[0,1],onChange:l.hitch(this,
this._onRangeSliderChange),showButtons:!1},this.sliderNode);this._slider.startup();a(this._slider.incrementButton,"click",this._slider.increment);a(this._slider.decrementButton,"click",this._slider.decrement);this._slider._typematicCallback=function(){}},_createVerticalSingleSlider:function(a){a=B.isDefined(a)?a:this.playDirectionAscending?0:this.dimensionValues.length-1;this._slider=new f({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,
style:this.computeSliderStyle(),increment:l.hitch(this,"increment"),decrement:l.hitch(this,"decrement"),value:a||0,onChange:l.hitch(this,this._onSingleSliderChange),showButtons:!1},this.sliderNode);this._slider.startup()},_createVerticalRangeSlider:function(a){a=a?a:this.playDirectionAscending?[0,1]:[this.dimensionValues.length-2,this.dimensionValues.length-1];this._slider=new d({name:"vertical",minimum:0,maximum:this.dimensionValues.length-1,intermediateChanges:!1,discreteValues:this.dimensionValues.length,
style:this.computeSliderStyle(),increment:l.hitch(this,"increment"),decrement:l.hitch(this,"decrement"),value:a||[0,1],onChange:l.hitch(this,this._onRangeSliderChange),showButtons:!1},this.sliderNode);this._slider.startup();this._slider._typematicCallback=function(){}},_onSingleSliderChange:function(a){var b=this.dimensionValues[a];this.setDimensionInfoText(b);u.forEach(this._layers,function(d){this._updateMosaicRule(d,b);this.prefetch&&this.playing&&this._prefetchData(a,d)},this);this._oldValue=
a;this.value=b;this.updatePassiveLabels();this.onChange(b)},_onRangeSliderChange:function(a){if(this._update){this._snap&&(a=this._snapToNearestRange(a));var b=[this.dimensionValues[a[1]],this.dimensionValues[a[0]]];b.sort(this._sortCompareFunction);this.value=b;this.setDimensionInfoText(b);this.updatePassiveLabels();u.forEach(this._layers,function(d){this._updateMosaicRule(d,b);this.prefetch&&this.playing&&this._prefetchData(a,d)},this);this._update=!0;this._oldValue=l.clone(a);this.onChange(b)}},
destroy:function(){this.inherited(arguments);this._timer.stop();this._destroySlider();this._removeHandles()},_destroySlider:function(){if(this._slider)try{this._slider.destroy()}catch(M){this._slider.domNode&&L.destroy(this._slider.domNode)}finally{this._slider=null}},_createSlider:function(){var a,b;this.mdSliderCell.appendChild(this.sliderNode);this.value&&this.value.length&&0<=u.indexOf(this.dimensionValues,this.value[0])&&0<=u.indexOf(this.dimensionValues,this.value[1])?a=[u.indexOf(this.dimensionValues,
this.value[0]),u.indexOf(this.dimensionValues,this.value[1])]:B.isDefined(this.value)&&(b=u.indexOf(this.dimensionValues,this.value),0<=b&&(a=b));B.isDefined(a)||(a=this._getDefaultSliderValue());this.useDefaults&&B.isDefined(a)&&(a===this.dimensionValues.length-1||a.length&&0<=u.indexOf(a,this.dimensionValues.length-1))&&(this.playDirectionAscending=!1);2===this._thumbCount?this.layout===R.LAYOUT_HORIZONTAL?this._createHorizontalRangeSlider(a):this._createVerticalRangeSlider(a):this.layout===R.LAYOUT_HORIZONTAL?
this._createHorizontalSingleSlider(a):this._createVerticalSingleSlider(a)},_getDefaultSliderValue:function(){if(this.dimensionValues&&this.dimensionValues.length){var a,b,d=Infinity,c=1,e,f;if(this.dimension&&"stdz"===this.dimension.toLowerCase())for(e=0;e<this.dimensionValues.length&&(f=this.dimensionValues[e],b=Math.abs(f-0),b<d&&(d=b,a=f),0!==b);e++);else a=this.dimensionValues[0];a=u.indexOf(this.dimensionValues,a);a=0>a?0:a;2===this._thumbCount&&(a===this.dimensionValues.length-1&&(c=-1),a=[a,
a+c]);return a}},_getMultidimensionalInfo:function(a){function b(){a.getMultidimensionalInfo().then(function(b){a.multidimensionalInfo=b;d.resolve(a)},function(a){d.reject(a)})}var d=new w;if(a.multidimensionalInfo)d.resolve(a);else if(a.loaded)b();else a.on("load",function(){b()});return d},_getAllLayersMDInfo:function(){var a=[];u.forEach(this._layers,function(b){a.push(this._getMultidimensionalInfo(b))},this);return new t(a)},_getImageLayers:function(){var a=this.map.layerIds.concat(this.map.graphicsLayerIds),
b;this._layers=[];u.forEach(a,function(a){b=this.map.getLayer(a);"esri.layers.ArcGISImageServiceLayer"!==b.declaredClass&&"esri.layers.ArcGISImageServiceVectorLayer"!==b.declaredClass&&"esri.layers.RasterLayer"!==b.declaredClass||this._layers.push(b)},this);return this._layers},_sortCompareFunction:function(a,b){return B.isDefined(a)&&B.isDefined(b)?a-b:!1},_getDimensionObjects:function(){function a(a){if(a&&a.values&&a.hasRanges){var c=[];u.forEach(a.values,function(a){a.length?c=b(c,a):c.push.apply(b(c.sort(this._sortCompareFunction),
[a]))},this);c=c.sort(d._sortCompareFunction);a.decodedValues=c}return a}var b=this._merge,d=this;this._allRangeValues=!0;this._thumbCount=1;this._snap=!1;this._dimensionObjects=[];this._layers=this._filterLayers();u.forEach(this._layers,function(a){a.multidimensionalInfo&&u.some(a.multidimensionalInfo.variables,function(a){u.some(a.dimensions,function(a){a.name!==this.dimension||a.hasRanges||(this._allRangeValues=!1)},this)},this)},this);this.useRanges?(this._thumbCount=2,this._snap=!1):this._allRangeValues&&
this.useLayersDimSlices?(this._thumbCount=2,this._snap=!0):this._snap=!1;u.forEach(this._layers,function(b){b.multidimensionalInfo&&u.some(b.multidimensionalInfo.variables,function(b){u.some(b.dimensions,function(b){b.name===this.dimension&&(this._allRangeValues&&b.hasRanges||this.useRanges?this._dimensionObjects.push(a(l.clone(b))):!this._allRangeValues&&b.hasRanges||this._dimensionObjects.push(l.clone(b)))},this)},this)},this)},_merge:function(a,b){for(var d=[],c=0,e=0;c<a.length&&e<b.length;)a[c]<
b[e]?d.push(a[c++]):a[c]>b[e]?d.push(b[e++]):(d.push(b[e++]),c++);d=d.concat(a.slice(c)).concat(b.slice(e));return d=u.filter(d,function(a,b,d){return d.indexOf(a)===b})},_mergeRangeArrays:function(a,b){for(var d=[],c=0,e=0;c<a.length&&e<b.length;)a[c][0]<b[e][0]||a[c][0]===b[e][0]&&a[c][1]<b[e][1]?d.push(a[c++]):a[c][0]>b[e][0]||a[c][0]===b[e][0]&&a[c][1]>b[e][1]?d.push(b[e++]):(d.push(b[e++]),c++);d=d.concat(a.slice(c)).concat(b.slice(e));return d=u.filter(d,function(a,b,d){return d.indexOf(a)===
b},this)},_sortDimensionValues:function(){var a=0,b=this._merge,d=this._mergeRangeArrays;this._getDimensionObjects();1<=this._dimensionObjects.length&&(this._mapSortedDimensionValues=this._dimensionObjects[0].decodedValues||this._dimensionObjects[0].values,this._allRangeValues&&(this._dimensionRangeValues=this._dimensionObjects[0].values));if(1<this._dimensionObjects.length)for(a=1;a<this._dimensionObjects.length;a++)this._mapSortedDimensionValues=b(this._mapSortedDimensionValues,this._dimensionObjects[a].decodedValues||
this._dimensionObjects[a].values),this._allRangeValues&&(this._dimensionRangeValues=d(this._dimensionRangeValues,this._dimensionObjects[a].values))},_createDimensionalDefinition:function(a,b){a=[a];return new C({variableName:b,dimensionName:this.dimension,values:a,isSlice:1===a.length})},_updateMosaicRule:function(a,b){var d=!1,c=a.mosaicRule||a.defaultMosaicRule||new y({multidimensionalDefinition:[]}),e=c.multidimensionalDefinition||[];b.length&&b.sort(this._sortCompareFunction);u.forEach(e,function(a){a.dimensionName===
this.dimension&&(a.values=[b],a.isSlice=!this.useRanges,d=!0)},this);!d&&u.some(a.multidimensionalInfo.variables,function(a){if(u.some(a.dimensions,function(a){if(a.name===this.dimension)return!0},this))return!0},this)&&(e.push(this._createDimensionalDefinition(b,"")),d=!0);d&&(c.multidimensionalDefinition=e,a.setMosaicRule(c))},_prefetchData:function(a,b){if(b&&b.mosaicRule){var d,c,f,g=!1,k,m=this,n;this.prefetchedValues[b.id]||(this.prefetchedValues[b.id]=[]);this.prefetchImgNodes[b.id]=[];c=l.clone(b._params);
f=l.clone(b.mosaicRule);for(d=1;d<=this.prefetchFactor;d++)g=!1,u.forEach(f.multidimensionalDefinition,function(c){c.dimensionName===this.dimension&&(this.playDirectionAscending?a.length?(this.snap?(k=this._getNextRangeIndex(a)||a,c.values=[this.dimensionValues[k[0]],this.dimensionValues[k[1]]]):c.values=[this.dimensionValues[(a[0]+d)%this.dimensionValues.length],this.dimensionValues[(a[1]+d)%this.dimensionValues.length]],c.values.sort(this._sortCompareFunction)):c.values=[this.dimensionValues[(a+
d)%this.dimensionValues.length]]:a.length?(this.snap?(k=this._getNextRangeIndex(a,-1)||a,c.values=[this.dimensionValues[k[0]],this.dimensionValues[k[1]]]):c.values=[this.dimensionValues[(this.dimensionValues.length+a[0]-d)%this.dimensionValues.length],this.dimensionValues[(this.dimensionValues.length+a[1]-d)%this.dimensionValues.length]],c.values.sort(this._sortCompareFunction)):c.values=[this.dimensionValues[(this.dimensionValues.length+a-d)%this.dimensionValues.length]],u.some(this.prefetchedValues[b.id],
function(a){if(e.stringify(a)===e.stringify(c.values))return!0})||(g=!0,this.prefetchedValues[b.id].push(c.values)))},this),g&&(c.mosaicRule=e.stringify(f.toJson()),b.getImageUrl(this.map.extent,this.map.width,this.map.height,function(a){n=new Image;m.prefetchImgNodes[b.id].push(n);n.src=a},c))}},setDimensionInfoText:function(a){if(B.isDefined(a)){var b=this.unitSymbol||this.unit;if("number"!==typeof a){a=l.clone(a.sort(this._sortCompareFunction));if(0!==a[0]%1||0!==a[1]%1)a[0]=parseFloat(a[0].toFixed(2)),
a[1]=parseFloat(a[1].toFixed(2));a="["+a[0]+", "+a[1]+"]"}else 0!==a%1&&(a=a.toFixed(2));this.dimensionInfo.innerHTML=this.unitSymbol?"\x3clabel style\x3d'font-weight:700;'\x3e"+this.dimensionAlias+" ("+b+")\x3c/label\x3e":"\x3clabel style\x3d'font-weight:700;'\x3e"+this.dimensionAlias+"\x3c/label\x3e";this.dimensionInfo.innerHTML=this.layout===R.LAYOUT_HORIZONTAL?this.dimensionInfo.innerHTML+(": "+a):this.dimensionInfo.innerHTML+("\x3cbr/\x3e "+a)}},setLabels:function(a){},_filterLabels:function(){if(this.nLabels&&
this.dimensionValues&&this.dimensionValues.length){var a=Math.ceil(this.dimensionValues.length/this.nLabels);return u.map(this.dimensionValues,function(b,d){return 0===d%a||d===this.dimensionValues.length-1?(0!==b%1&&(b=parseFloat(b.toFixed(2))),b):""},this)}},_filterLayers:function(){return u.filter(this._layers,function(a){if(a.multidimensionalInfo&&a.visible&&a.useMapDimensionValue&&u.some(a.multidimensionalInfo.variables,function(a){if(u.some(a.dimensions,function(a){if(a.name===this.dimension)return!0},
this))return!0},this))return!0},this)},_updateUI:function(){N.remove(this.playPauseBtn.iconNode,this._iconClass);this._iconClass=this.playing?"mdsButton mdsPauseButton":"mdsButton mdsPlayButton";N.add(this.playPauseBtn.iconNode,this._iconClass)},_bumpSlider:function(a){var b=this._slider.value;if(0<=a)!this._snap&&(0>b||b>=this.dimensionValues.length-1||b[0]>=this.dimensionValues.length-1||b[1]>=this.dimensionValues.length-1)?this._timer.isRunning&&(this.loop?(this._timer.stop(),this.prefetchedValues=
{},this.prefetchImgNodes={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(b)):this._slider.set("value",[0,Math.abs(b[0]-b[1])]):this._slider.set("value",0),this._timer.start(),this.playing=!0):this.pause()):2===this._thumbCount&&!this._snap&&b[0]<this.dimensionValues.length-1&&b[1]<this.dimensionValues.length-1?this._slider.set("value",[b[0]+1,b[1]+1]):1===this._thumbCount&&b<this.dimensionValues.length-1?this._slider.set("value",b+1):this._snap&&this._slider.set("value",
this._getNextRangeIndex(b));else if(0>=b||0>=b[0]||0>=b[1])this._timer.isRunning&&(this.loop?(this._timer.stop(),this.prefetchedValues={},2===this._thumbCount?this._snap?this._slider.set("value",this._getNextRangeIndex(b,-1)):this._slider.set("value",[this.dimensionValues.length-1,this.dimensionValues.length-1-Math.abs(b[0]-b[1])]):this._slider.set("value",this.dimensionValues.length-1),this._timer.start(),this.playing=!0):this.pause());else if(0<=b||0<=b[1])2===this._thumbCount&&0<b[1]&&0<b[0]?this._snap?
this._slider.set("value",this._getNextRangeIndex(b,-1)):this._slider.set("value",[b[0]-1,b[1]-1]):1===this._thumbCount&&0<b&&this._slider.set("value",b-1)},setThumbMovingRate:function(a){this.thumbMovingRate=a;this._timer&&this._timer.setInterval(this.thumbMovingRate)},getFullDimensionRange:function(a){a=a||this.dimension;var b,d;u.forEach(this._layers,function(c){c.multidimensionalInfo&&c.multidimensionalInfo.variables&&u.forEach(c.multidimensionalInfo.variables,function(c){u.forEach(c.dimensions,
function(c){if(c.name===a&&c.extent&&c.extent.length&&1<c.extent.length){if(!B.isDefined(b)||c.extent[0]<b)b=c.extent[0];if(!B.isDefined(d)||c.extent[1]>d)d=c.extent[1]}},this)},this)},this);return[b,d]},setThumbCount:function(a){this._thumbCount=2==a?2:1;this.value=this.dimensionValues[this._slider.value];this._setupSlider()},clearDimensionalDefinition:function(a){var b,d=[],c;a&&a.mosaicRule&&a.mosaicRule.multidimensionalDefinition&&(c=a.mosaicRule,b=c.multidimensionalDefinition,u.forEach(b,function(a){a.dimensionName!==
this.dimension&&d.push(a)},this),c.multidimensionalDefinition=d,a.setMosaicRule(c))},getUnit:function(){var a=null,b=!1;this.unit=null;u.forEach(this._layers,function(d){d.multidimensionalInfo&&u.forEach(d.multidimensionalInfo.variables,function(d){u.forEach(d.dimensions,function(d){d.name===this.dimension&&d.unit&&(null!=a||b?B.isDefined(d.unit)&&d.unit.replace("esri","").toLowerCase()!==a.toLowerCase()&&(a=null,b=!0):a=d.unit.replace("esri",""))},this)},this)},this);a&&(a=a.replace("esri",""));
this.unit=a;this.unitSymbol=this.getUnitSymbol();this._hasUnitConflict=b;return a},_getDimensionAlias:function(){this.dimensionAlias=this.dimension;u.some(this._layers,function(a){if(a.fields&&a.fields.length&&u.some(a.fields,function(a){if(a.name&&a.name===this.dimension&&a.alias)return this.dimensionAlias=a.alias,!0},this))return!0},this)},_readMosaicRule:function(){var a;u.forEach(this._layers,function(b){b.mosaicRule&&b.mosaicRule.multidimensionalDefinition&&u.forEach(b.mosaicRule.multidimensionalDefinition,
function(b){b&&b.dimensionName===this.dimension&&b.values&&(a=b.values.length&&b.values[0]&&b.values[0].length?b.values[0]:b.values)},this)},this);this.useRanges=B.isDefined(this.useRanges)?this.useRanges:a&&1!==a.length?!0:!1;a&&(this.useRanges?(this._thumbCount=2,this.value=1===a.length?[a[0],this.dimensionValues[this.dimensionValues.length-1]]:a):1<a.length&&this._snap?(this._thumbCount=2,this.value=a):(this._thumbCount=1,this.useRanges=!1,this.value=a[0]))},hasUnitConflict:function(){this.getUnit();
return this._hasUnitConflict},resizeSlider:function(a,b){O.set(this.domNode,{height:a+"px",width:b+"px"});O.set(this.mdSliderTable,{height:a+"px",width:b+"px"});this.computeSliderStyle()},computeSliderStyle:function(){var a,b;a=K.getContentBox(this.domNode).h-K.getContentBox(this.dimensionInfo).h-(K.getContentBox(this.playPauseBtnRow).h+20);10>=h("ie")&&(a-=53);b="height: "+a+"px;";this._slider&&this._slider.domNode&&O.set(this._slider.domNode,"height",a+"px");return b},getUnitSymbol:function(){if(!B.isDefined(this.unit))return null;
var a=this.unit.toLowerCase();if("meters"===a||"meter"===a)return this.unitSymbols.meter;if("pascal"===a||"pascals"===a)return this.unitSymbols.pascal},_snapToNearestRange:function(a){if(a&&a.length&&this._snap){var b,d,c,e,f=this,g,k,m,n;e=[this.dimensionValues[a[1]],this.dimensionValues[a[0]]];e.sort(this._sortCompareFunction);if(u.some(this._dimensionObjects,function(a){if(u.some(a.values,function(a){if(a&&a.length&&a[0]===e[0]&&a[1]===e[1])return!0}))return!0},this))return a;u.some(this._dimensionObjects,
function(a){if(u.some(a.values,function(a){if(a&&a.length&&a[0]===e[0])return b=l.clone(a.sort(this._sortCompareFunction)),!0},this))return!0},this)&&(u.some(this.dimensionValues,function(a,e){a===b[0]&&(d=e);a===b[1]&&(c=e)}),m=Math.abs(a[0]-d),g=[d,c]);u.some(this._dimensionObjects,function(a){if(u.some(a.values,function(a){if(a&&a.length&&a[1]===e[1])return b=l.clone(a.sort(this._sortCompareFunction)),!0},this))return!0},this)&&(u.some(this.dimensionValues,function(a,e){a===b[1]&&(c=e);a===b[0]&&
(d=e)}),n=Math.abs(a[1]-c),k=[d,c]);a=m&&n?this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,g)?k:this._oldValue&&this._oldValue.length&&this._arraysEqual(this._oldValue,k)?g:m<=n?g:k:g||k||a;this._update=!1;setTimeout(function(){f._slider.set("value",a)},100);return a}},_arraysEqual:function(a,b){var d;if(!B.isDefined(a)||!B.isDefined(b))return!1;if(a===b)return!0;if(a.length!==b.length)return!1;a.sort(this._sortCompareFunction);b.sort(this._sortCompareFunction);for(d=0;d<a.length;++d)if(a[d]!==
b[d])return!1;return!0},_getNextRangeIndex:function(a,b){if(!this._dimensionRangeValues||!this._dimensionRangeValues.length)return null;var d,c,e,f;b=B.isDefined(b)?b:1;u.some(this._dimensionRangeValues,function(b,c){if(this._arraysEqual(b,[this.dimensionValues[a[0]],this.dimensionValues[a[1]]]))return d=c,!0},this);c=this._dimensionRangeValues[0<b?(d+1)%this._dimensionRangeValues.length:(this._dimensionRangeValues.length+d-1)%this._dimensionRangeValues.length];u.some(this.dimensionValues,function(a,
b){a===c[0]&&(e=b);a===c[1]&&(f=b);if(e&&f)return!0},this);return[e,f]}});l.mixin(n,R);l.setObject("dijit.MultidimensionalSlider",n,x);return n})},"esri/dijit/BasemapGallery":function(){define("require dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/_base/kernel dojo/_base/sniff dojo/has dojo/query dojo/Deferred dojo/DeferredList dojo/dom dojo/dom-construct dojo/dom-class dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ../request ../geometry/Extent ../SpatialReference ../virtualearth/VETiledLayer ../layers/OpenStreetMapLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/WebTiledLayer ../layers/VectorTileLayer ../layers/TileInfo ../layers/ArcGISImageServiceLayer ../layers/ImageServiceParameters ../layers/ImageParameters ./Basemap ./_EventedWidget dojo/text!./templates/BasemapGallery.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M){l=l([R,r,v],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:!0,templateString:M,loaded:!1,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:!1,_supportsVTL:null,_selectedBasemap:null,_selectBasemapInProgress:!1,_eventMap:{load:!0,"selection-change":!0,add:["basemap"],remove:["basemap"],error:["message"]},constructor:function(a,b){a=a||{};this.map=a.map;this._hasUI=b?!0:!1;this.bingMapsKey=a.bingMapsKey&&
0<a.bingMapsKey.length?a.bingMapsKey:null;this.showArcGISBasemaps=!1!==a.showArcGISBasemaps;this.basemaps=a.basemaps||[];this.basemapIds=a.basemapIds;this.referenceIds=a.referenceIds;this.basemapsGroup=a.basemapsGroup;this.arcgisUrl=u.dijit._arcgisUrl;a.portalUrl&&(this.arcgisUrl=a.portalUrl+"/sharing/rest");0>this.arcgisUrl.indexOf("://")?this.arcgisUrl=t.getProtocolForWebResource()+"//"+this.arcgisUrl:"https:"===window.location.protocol&&(this.arcgisUrl=this.arcgisUrl.replace("http:","https:"));
this.init()},init:function(){this.inherited(arguments);h.forEach(this.basemaps,function(a){a.id&&0!==a.id.length||(a.id=this._getUniqueId());h.forEach(a.layers,function(a){a.opacity=0<=a.opacity?a.opacity:1;a.visibility=!0},this)},this);this.basemapIds&&0<this.basemapIds.length&&h.forEach(this.basemapIds,function(a){this.map.getLayer(a)._basemapGalleryLayerType="basemap"},this);this.referenceIds&&0<this.referenceIds.length&&h.forEach(this.referenceIds,function(a){a=this.map.getLayer(a);a._basemapGalleryLayerType=
"reference";a.attr("data-reference",!0)},this);this.basemapsGroup&&(this.basemapsGroup.owner&&this.basemapsGroup.title||this.basemapsGroup.id)?this._findCustomBasemapsGroup(e.hitch(this,"_handleArcGISBasemapsResponse")):this.showArcGISBasemaps?this._findArcGISBasemapsGroup(e.hitch(this,"_handleArcGISBasemapsResponse")):this._finishStartup();this._checkVTLSupport().then(e.hitch(this,function(a){this._supportsVTL=a}))},startup:function(){this.loaded?this._refreshUI():a.connect(this,"onLoad",e.hitch(this,
function(){this._refreshUI()}))},select:function(a){this._select(a)},getSelected:function(){return this._selectedBasemap},get:function(a){var b;for(b=0;b<this.basemaps.length;b++)if(this.basemaps[b].id===a)return this.basemaps[b];return null},add:function(a){return a&&!a.id?(a.id=this._getUniqueId(),this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):a&&this._isUniqueId(a.id)?(this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):!1},remove:function(a){var b;for(b=0;b<this.basemaps.length;b++){var d=
this.basemaps[b];if(d.id===a)return this._selectedBasemap&&this._selectedBasemap.id===d.id&&(this._selectedBasemap=null),this.basemaps.splice(b,1),this._refreshUI(),this.onRemove(d),d}return null},onLoad:function(){},onSelectionChange:function(){},onAdd:function(a){},onRemove:function(a){},onError:function(a){},_defaultBasemapGalleryGroupQuery:'title:"ArcGIS Online Basemaps" AND owner:esri',_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=!0;this.onLoad();0===this.map.layerIds.length&&
0<this.basemaps.length&&!this._selectBasemapInProgress&&this._select(this.basemaps[0].id)},_findCustomBasemapsGroup:function(a){this.basemapsGroup&&this.basemapsGroup.id?this._findArcGISBasemaps(this.basemapsGroup.id,a):(this._basemapGalleryGroupQuery='title:"'+this.basemapsGroup.title+'" AND owner:'+this.basemapsGroup.owner,this._findArcGISBasemapsGroup(a))},_findArcGISBasemapsGroup:function(a){if(this._basemapGalleryGroupQuery)this._findArcGISBasemapsGroupContent(a);else{var b=this.arcgisUrl+"/portals/self",
d={f:"json"};d.culture=f.locale;y({url:b,content:d,callbackParamName:"callback",load:e.hitch(this,function(b,d){b&&b.useVectorBasemaps&&b.vectorBasemapGalleryGroupQuery?this._checkVTLSupport().then(e.hitch(this,function(d){this._basemapGalleryGroupQuery=d?b.vectorBasemapGalleryGroupQuery:b&&b.basemapGalleryGroupQuery?b.basemapGalleryGroupQuery:this._defaultBasemapGalleryGroupQuery;this._findArcGISBasemapsGroupContent(a)})):(this._basemapGalleryGroupQuery=b&&b.basemapGalleryGroupQuery?b.basemapGalleryGroupQuery:
this._defaultBasemapGalleryGroupQuery,this._findArcGISBasemapsGroupContent(a))}),error:e.hitch(this,function(a,b){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery})})}},_findArcGISBasemapsGroupContent:function(a){var b=e.hitch(this,"_findArcGISBasemaps"),d=this.arcgisUrl+"/community/groups",c={};c.q=this._basemapGalleryGroupQuery;c.f="json";y({url:d,content:c,callbackParamName:"callback",load:e.hitch(this,function(d,c){if(0<d.results.length)b(d.results[0].id,a,d.results[0].sortField,
d.results[0].sortOrder);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:e.hitch(this,function(a){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_findArcGISBasemaps:function(a,b,d,c){var f=e.hitch(this,function(a,b,d,c){var f=this.arcgisUrl+"/search",g={};g.q="group:"+a+' AND type:"web map" NOT type:"web mapping application"';g.sortField=d;g.sortOrder="asc"===c?"desc":"asc";g.num=50;g.f="json";y({url:f,content:g,callbackParamName:"callback",
load:e.hitch(this,function(a,d){if(0<a.results.length)b(a.results);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:e.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})});d&&c?f(a,b,d,c):y({url:this.arcgisUrl+"/community/groups/"+a,content:{f:"json"},callbackParamName:"callback",load:e.hitch(this,function(d,c){d.sortField?f(a,b,d.sortField,d.sortOrder):f(a,b,"name","desc")}),error:e.hitch(this,function(d,
c){f(a,b,"name","desc")})})},_handleArcGISBasemapsResponse:function(a){0<a.length&&(h.forEach(a,function(a,b){if(this.bingMapsKey||!this.bingMapsKey&&a.title&&-1===a.title.indexOf("Bing Maps")){b={};b.id=this._getUniqueId();b.title=a.title;b.thumbnailUrl="";if(a.thumbnail&&a.thumbnail.length&&(b.thumbnailUrl=this.arcgisUrl+"/content/items/"+a.id+"/info/"+a.thumbnail,u.id)){var d=u.id.findCredential(t.urlToObject(this.arcgisUrl).path);d&&(b.thumbnailUrl+="?token\x3d"+d.token)}b.itemId=a.id;a=new L(b,
this);this.basemaps.splice(0,0,a)}},this),this._finishStartup())},_refreshUI:function(){this._hasUI&&(q.empty(this.flowContainer),h.forEach(this.basemaps,function(a,b){a.id||(a.id="basemap_"+b);this.flowContainer.appendChild(this._buildNodeLayout(a))},this),q.create("br",{style:{clear:"both"}},this.flowContainer),this._markSelected(this._selectedBasemap))},_buildNodeLayout:function(b){var d=q.create("div",{id:"galleryNode_"+b.id,"class":"esriBasemapGalleryNode"}),f=q.create("a",{href:"javascript:void(0);"},
d);a.connect(f,"onclick",e.hitch(this,"_onNodeClick",b));var g=b.title||"";b.thumbnailUrl?q.create("img",{"class":"esriBasemapGalleryThumbnail",src:b.thumbnailUrl,title:g,alt:g},f):q.create("img",{"class":"esriBasemapGalleryThumbnail",src:c.toUrl("./images/transparent.gif"),title:g,alt:g},f);b=q.create("div",{"class":"esriBasemapGalleryLabelContainer"},d);q.create("span",{innerHTML:g,alt:g,title:g},b);return d},_onNodeClick:function(a,b){b.preventDefault();this._markSelected(a);this.select(a.id)},
_markSelected:function(a){a&&(h.forEach(f.query(".esriBasemapGallerySelectedNode",this.domNode),function(a){n.remove(a,"esriBasemapGallerySelectedNode")}),(a=p.byId("galleryNode_"+a.id))&&n.add(a,"esriBasemapGallerySelectedNode"))},_select:function(a){this._selectBasemapInProgress=!0;var b=this.get(a);b?(b.layers?this._getServiceInfos(b):(a=b.getLayers(this.arcgisUrl),e.isArray(a)?this._getServiceInfos(b):a.addCallback(e.hitch(this,function(a){this._getServiceInfos(b)}))),this._markSelected(b)):this._selectBasemapInProgress=
!1},_getServiceInfos:function(a){"https:"===location.protocol&&h.forEach(a.layers,function(a){if(this._isAgolService(a.url)||this._isHostedService(a.url))a.url=a.url.replace("http:","https:")},this);this._selectedBasemap=a;var b=[];h.forEach(a.layers,function(a){a.url&&0<a.url.length&&!a.isReference&&!a.type&&(a.deferredsPos=b.length,b.push(this._getServiceInfo(a.url)))},this);0<b.length?(new m(b)).addCallback(e.hitch(this,function(b){var d=null;h.forEach(a.layers,function(a){if(0===a.deferredsPos||
a.deferredsPos){a.serviceInfoResponse=b[a.deferredsPos][1];var c=a.serviceInfoResponse.fullExtent;c||(c=a.serviceInfoResponse.extent);d=d?d.union(new C(c)):new C(c)}},this);this.map.extent&&5>this._getIntersectionPercent(d,this.map.extent)&&this.map.setExtent(d,!0);this._switchBasemapLayers(a);this._updateReferenceLayer(a)})):(this._switchBasemapLayers(a),this._updateReferenceLayer(a))},_checkVTLSupport:function(){var a=new k;d("ie")?a.resolve(!1):a.resolve(N.supported());return a},_switchBasemapLayers:function(b){var d=
b.layers,c=!1,f,g,k;h.forEach(d,function(a){"VectorTileLayer"===a.type&&(c=!0)});if(c&&!0!==this._supportsVTL)this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because layer type is not supported by your current browser version.");else if(0<this.map.layerIds.length&&0===this.map.getNumLevels()&&("OpenStreetMap"===d[0].type||d[0].type&&-1<d[0].type.indexOf("BingMaps")||"WebTiledLayer"===d[0].type||"VectorTileLayer"===d[0].type))this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");
else{h.forEach(d,function(a){if(!a.isReference&&a.type&&-1<a.type.indexOf("BingMaps")&&!this.bingMapsKey)this.onError("esri.dijit.BasemapGallery: Invalid Bing Maps key.")},this);var m=0;h.forEach(d,function(b,c){if(!b.isReference){var n;if("OpenStreetMap"===b.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}n=new z({id:"layer_osm",
opacity:b.opacity})}else if(b.type&&-1<b.type.indexOf("BingMaps")){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}n=B.MAP_STYLE_AERIAL_WITH_LABELS;"BingMapsAerial"===b.type?n=B.MAP_STYLE_AERIAL:"BingMapsRoad"===b.type&&(n=B.MAP_STYLE_ROAD);n=new B({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:n,opacity:b.opacity})}else if("WebTiledLayer"===
b.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");return}n=b.initialExtent||b.fullExtent;n=new E(b.templateUrl||b.url,{visible:b.visibility,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new C(b.fullExtent),initialExtent:n&&new C(n),subDomains:b.subDomains,tileInfo:b.tileInfo?new O(b.tileInfo):null,tileServers:b.tileServers})}else if("VectorTileLayer"===
b.type){n=new N(b.styleUrl,{visible:b.visibility,opacity:b.opacity});0===c&&1<d.length&&this._removeBasemapLayers();var p=this;a.connect(n,"onLoad",e.hitch(this,function(a,b,c){var e;if(p._sameSpatialReference(c.spatialReference,p.map.spatialReference))if(0<p.map.getNumLevels())if(e=p._sameTilingScheme(c.tileInfo,p.map.__tileInfo))0===b&&1===d.length&&p._removeBasemapLayers(),c._basemapGalleryLayerType="basemap",p.map.addLayer(c,a);else p.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");
else p.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");else p.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.")},m,c))}else if(b.serviceInfoResponse&&b.serviceInfoResponse.mapName){f=new x(b.serviceInfoResponse.spatialReference);g=this._sameSpatialReference(f,this.map.spatialReference);if(this.map.spatialReference&&!g){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");
return}if(!0===b.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()){if(k=this._sameTilingScheme(b.serviceInfoResponse.tileInfo,this.map.__tileInfo),!k){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");return}}else if(!0===b.serviceInfoResponse.singleFusedMapCache&&-1<b.serviceInfoResponse.capabilities.toLowerCase().indexOf("tilesonly")&&0===this.map.getNumLevels()){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.");
return}n=(0===this.map.layerIds.length||0<this.map.getNumLevels())&&!0===b.serviceInfoResponse.singleFusedMapCache?this._loadAsCached(b):this._loadAsDynamic(b)}else if(b.serviceInfoResponse&&b.serviceInfoResponse.pixelSizeX){f=new x(b.serviceInfoResponse.spatialReference);g=this._sameSpatialReference(f,this.map.spatialReference);if(!g){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.");return}if(!0===b.serviceInfoResponse.singleFusedMapCache&&
0<this.map.getNumLevels()&&(k=this._sameTilingScheme(b.serviceInfoResponse.tileInfo,this.map.__tileInfo),!k)){this.onError("esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.");return}b.serviceInfoResponse.singleFusedMapCache?n=new F(b.url,{resourceInfo:b.serviceInfoResponse,opacity:b.opacity,visible:b.visibility}):b.serviceInfoResponse.pixelSizeX?(n=new H,n.bandIds=b.bandIds,!b.bandIds&&b.serviceInfoResponse.bandCount&&3<parseInt(b.serviceInfoResponse.bandCount,
10)&&(n.bandIds=[0,1,2]),n=new K(b.url,{resourceInfo:b.serviceInfoResponse,opacity:b.opacity,visible:b.visibility,imageServiceParameters:n})):(n=new J,n.format="png24",b.serviceInfoResponse.supportedImageFormatTypes&&-1<b.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(n.format="png32"),n=new A(b.url,{resourceInfo:b.serviceInfoResponse,opacity:b.opacity,visible:b.visibility,imageParameters:n}))}"VectorTileLayer"===b.type?m++:n&&(0===c&&this._removeBasemapLayers(),n._basemapGalleryLayerType=
"basemap",this.map.addLayer(n,m),m++)}},this);this._selectBasemapInProgress=!1;this.onSelectionChange()}},_removeBasemapLayers:function(){var a=this.map.layerIds,b=[];h.forEach(a,function(a){a=this.map.getLayer(a);"basemap"===a._basemapGalleryLayerType&&b.push(a)},this);0===b.length&&0<a.length&&b.push(this.map.getLayer(a[0]));0<b.length&&h.forEach(b,function(a){this.map.removeLayer(a)},this)},_updateReferenceLayer:function(a){var b;this._removeReferenceLayer();for(b=0;b<a.layers.length;b++)!0===
a.layers[b].isReference&&this._addReferenceLayer(a.layers[b])},_removeReferenceLayer:function(){var a;for(a=this.map.layerIds.length-1;0<=a;a--){var b=this.map.getLayer(this.map.layerIds[a]);"reference"===b._basemapGalleryLayerType&&this.map.removeLayer(b)}},_addReferenceLayer:function(a){"VectorTileLayer"===a.type?this._handleReferenceServiceInfoResponse(a):this._getServiceInfo(a.url,e.hitch(this,"_handleReferenceServiceInfoResponse",a))},_handleReferenceServiceInfoResponse:function(a,b,d){var c;
a.serviceInfoResponse=b;"VectorTileLayer"===a.type?c=new N(a.styleUrl,{visible:a.visibility,opacity:a.opacity}):b&&b.mapName?c=!0===b.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a):b&&b.pixelSizeX&&(a.serviceInfoResponse.singleFusedMapCache?c=new F(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(d=new H,d.bandIds=a.bandIds,!a.bandIds&&b.bandCount&&3<parseInt(b.bandCount,10)&&(d.bandIds=[0,1,2]),c=new K(a.url,{resourceInfo:b,
opacity:a.opacity,visible:a.visibility,imageServiceParameters:d})):(b=new J,b.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(b.format="png32"),b.transparent=!0,c=new A(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:b})));c&&(c._basemapGalleryLayerType="reference",c.attr("data-reference",!0),this.map.addLayer(c))},_getServiceInfo:function(a,b){return y({url:a,content:{f:"json"},
callbackParamName:"callback",load:function(a,d){b&&b(a,d)},error:e.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: service not accessible.")})})},_loadAsCached:function(a){var b=[];a.displayLevels||(b=h.map(a.serviceInfoResponse.tileInfo.lods,function(a){return a.level}));var d=null;a.exclusionAreas&&a.exclusionAreas.length&&(d=[],h.forEach(a.exclusionAreas,function(a){d.push({minZoom:a.minZoom,maxZoom:a.maxZoom,minScale:a.minScale,maxScale:a.maxScale,geometry:new C(a.geometry)})}));
return new F(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,exclusionAreas:d,displayLevels:a.displayLevels||b})},_loadAsDynamic:function(a){var b=new A(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility});a.visibleLayers&&b.setVisibleLayers(a.visibleLayers);return b},_getIntersectionPercent:function(a,b){return(a=b.intersects(a))?(a=a.getWidth()*a.getHeight(),b=b.getWidth()*b.getHeight(),a/b*100):0},_getIds:function(){var a=[];h.forEach(this.basemaps,
function(b){a.push(b.id)},this);return a},_getUniqueId:function(){for(var a=","+this._getIds().toString()+",",b=0;;)if(-1<a.indexOf(",basemap_"+b+","))b++;else return"basemap_"+b},_isUniqueId:function(a){return-1===(","+this._getIds().toString()+",").indexOf(","+a+",")?!0:!1},_isAgolService:function(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1},_isHostedService:function(a){return a?-1!==a.indexOf(".arcgis.com/"):!1},_sameSpatialReference:function(a,
b){return a&&b&&a.wkt==b.wkt&&(a.wkid===b.wkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.wkid||w.isDefined(b.latestWkid)&&a.wkid===b.latestWkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.latestWkid)||a&&b&&a.isWebMercator()&&b.isWebMercator()?!0:!1},_sameTilingScheme:function(a,b){var d=this.map,d=d.width>d.height?d.width:d.height,c=!1,e=!1,f,g;for(f=0;f<a.lods.length;f++){var k=a.lods[f].scale;a.dpi!==b.dpi&&(k=a.lods[f].scale/a.dpi);for(g=0;g<b.lods.length;g++){var m=b.lods[g].scale;a.dpi!==
b.dpi&&(m=b.lods[g].scale/b.dpi);if(Math.abs(m-k)/m<1/d)if(c){e=!0;break}else c=!0;if(m<k)break}if(e)break}return e||c&&(1===a.lods.length||1===b.lods.length)?!0:!1}});e.setObject("dijit.BasemapGallery",l,u);return l})},"esri/layers/WebTiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/url dojo/sniff dojo/string ../config ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),function(c,l,h,a,
e,f,d,b,g,k,m,p,q,n){function r(a,b){var d=[],c;if(a&&b&&(b.customLayerParameters||b.customParameters)){c=l.clone(b.customParameters||{});l.mixin(c,b.customLayerParameters||{});a=k.urlToObject(a);for(var e in a.query)c.hasOwnProperty(e)||d.push(e+"\x3d"+a.query[e]);a=a.path+(d.length?"?"+d.join("\x26"):"")}return a}c=c(q,{declaredClass:"esri.layers.WebTiledLayer",constructor:function(b,c){c||(c={});this.urlTemplate=b=r(b,c.wmtsInfo);var q=new p(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,
2.0037508342787E7,new m({wkid:102100})),t=new p(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new m({wkid:102100}));this.initialExtent=c.initialExtent||q;this.fullExtent=c.fullExtent||t;this.tileInfo=c.tileInfo?c.tileInfo:new n({dpi:96,rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,
scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},
{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}]});this.spatialReference=new m(this.tileInfo.spatialReference.toJson());this.copyright=c.copyright||"";var v=new a(b),q=v.scheme+"://"+v.authority+"/";this.urlPath=b.substring(q.length);this.tileServers=c.tileServers||[];-1===v.authority.indexOf("{subDomain}")&&
this.tileServers.push(q);if(c.subDomains&&0<c.subDomains.length&&1<v.authority.split(".").length){this.subDomains=c.subDomains;var u;h.forEach(c.subDomains,function(a){-1<v.authority.indexOf("${subDomain}")?u=v.scheme+"://"+f.substitute(v.authority,{subDomain:a})+"/":-1<v.authority.indexOf("{subDomain}")&&(u=v.scheme+"://"+v.authority.replace(/\{subDomain\}/gi,a)+"/");this.tileServers.push(u)},this)}this.tileServers=h.map(this.tileServers,function(a){"/"!==a.charAt(a.length-1)&&(a+="/");return a});
this._levelToLevelValue=[];var x=0;h.forEach(this.tileInfo.lods,function(a,b){this._levelToLevelValue[a.level]=a.levelValue||a.level;0===b&&(x=this._levelToLevelValue[a.level])},this);this._wmtsInfo=c.wmtsInfo;var B=l.hitch(this,function(){this.loaded=!0;this.onLoad(this)});e("chrome")?(b=this.getTileUrl(x,0,0),c=d.defaults.io,q="with-credentials"===c.useCors?k.canUseXhr(b,!0):-1,(c=-1<q?c.corsEnabledServers[q]:null)&&c.withCredentials?g({url:b,handleAs:"arraybuffer"}).addBoth(function(){B()}):B()):
B()},getTileUrl:function(a,b,d){a=this._levelToLevelValue[a];var c=this.tileServers[b%this.tileServers.length]+f.substitute(this.urlPath,{level:a,col:d,row:b}),c=c.replace(/\{level\}/gi,a).replace(/\{row\}/gi,b).replace(/\{col\}/gi,d),c=this._appendCustomLayerParameters(c),c=this.addTimestampToURL(c);return k.addProxy(c)},_appendCustomLayerParameters:function(a){var b,d;if(this._wmtsInfo&&(this._wmtsInfo.customLayerParameters||this._wmtsInfo.customParameters))for(b in d=l.clone(this._wmtsInfo.customParameters||
{}),l.mixin(d,this._wmtsInfo.customLayerParameters||{}),d)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(d[b]);return a}});l.setObject("layers.WebTiledLayer",c,b);return c})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(c,l,h,a,e,f){c=c(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,
compressionQuality:null,bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(a){var b=this.bbox||this.extent;a=(b=b&&a&&b._normalize(!0))?b.spatialReference.wkid||h.toJson(b.spatialReference.toJson()):null;var d=this.imageSpatialReference,b={bbox:b?b.xmin+","+b.ymin+","+b.xmax+","+b.ymax:null,bboxSR:a,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:d?
d.wkid||h.toJson(d.toJson()):a,format:this.format,interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?h.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?h.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?h.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,
lercVersion:this.lercVersion};a=this.timeExtent;b.time=a?a.toJson().join(","):null;return f.filter(b,function(a){if(null!==a&&void 0!==a)return!0})}});l.mixin(c,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});l.setObject("layers.ImageServiceParameters",c,e);return c})},"esri/dijit/Basemap":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../request ./BasemapLayer".split(" "),
function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,itemId:null,basemapGallery:null,constructor:function(a,d){a=a||{};this.id=a.id;this.itemId=a.itemId;this.layers=a.layers;this.title=a.title||"";this.thumbnailUrl=a.thumbnailUrl;this.basemapGallery=d},getLayers:function(a){if(this.layers)return this.layers;if(this.itemId)return a=f({url:(a||e.dijit._arcgisUrl)+"/content/items/"+this.itemId+"/data",content:{f:"json"},callbackParamName:"callback",
error:h.hitch(this,function(a,b){if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.")})}),a.addCallback(h.hitch(this,function(a,b){if(a.baseMap)return this.layers=[],l.forEach(a.baseMap.baseMapLayers,function(a){this.layers.push(new d(a))},this),this.layers;if(this.basemapGallery)this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item.");return[]})),a}});h.setObject("dijit.Basemap",c,e);return c})},"esri/dijit/BasemapLayer":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(c,l,h,a){c=c(null,{declaredClass:"esri.dijit.BasemapLayer",constructor:function(a){a=a||{};this.url=a.url;this.type=a.type;this.isReference=!0===a.isReference?!0:!1;this.opacity=a.opacity;this.visibleLayers=a.visibleLayers;this.displayLevels=a.displayLevels;this.exclusionAreas=a.exclusionAreas;this.bandIds=a.bandIds;this.templateUrl=a.templateUrl;this.copyright=a.copyright;this.subDomains=a.subDomains;this.fullExtent=a.fullExtent;this.initialExtent=
a.initialExtent;this.tileInfo=a.tileInfo;this.tileServers=a.tileServers;this.styleUrl=a.styleUrl}});l.setObject("dijit.BasemapLayer",c,a);return c})},"esri/dijit/HomeButton":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/HomeButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n){c=l("esri.dijit.HomeButton",
[f,b,c],{templateString:m,options:{theme:"HomeButton",map:null,extent:null,fit:!1,visible:!0},constructor:function(a,b){a=h.mixin({},this.options,a);this.domNode=b;this._i18n=p;this.set("map",a.map);this.set("theme",a.theme);this.set("visible",a.visible);this.set("extent",a.extent);this.set("fit",a.fit);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this._css={container:"homeContainer",home:"home",loading:"loading"}},postCreate:function(){this.inherited(arguments);
this.own(g(this._homeNode,d,h.hitch(this,this.home)))},startup:function(){this.inherited(arguments);this.map||this.destroy();if(this.map.loaded)this._init();else g.once(this.map,"load",h.hitch(this,function(){this._init()}))},destroy:function(){this.inherited(arguments)},home:function(){var a=new k,b=this.get("extent");this._showLoading();var d={extent:b};b?this.map.extent!==b?this.map.setExtent(b,this.get("fit")).then(h.hitch(this,function(){this._hideLoading();this.emit("home",d);a.resolve(d)}),
h.hitch(this,function(b){b||(b=Error("HomeButton::Error setting map extent"));d.error=b;this.emit("home",d);a.reject(b)})):(this._hideLoading(),this.emit("home",d),a.resolve(d)):(this._hideLoading(),b=Error("HomeButton::home extent is undefined"),d.error=b,this.emit("home",d),a.reject(b));return a.promise},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_init:function(){this._visible();this.get("extent")||this.set("extent",this.map.extent);this.set("loaded",!0);this.emit("load",
{})},_showLoading:function(){q.add(this._homeNode,this._css.loading)},_hideLoading:function(){q.remove(this._homeNode,this._css.loading)},_updateThemeWatch:function(a,b,d){q.remove(this.domNode,b);q.add(this.domNode,d)},_visible:function(){this.get("visible")?n.set(this.domNode,"display","block"):n.set(this.domNode,"display","none")}});h.setObject("dijit.HomeButton",c,e);return c})},"esri/dijit/LocateButton":function(){define("require dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/LocateButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-attr ../geometry/webMercatorUtils ../geometry/Point ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ../tasks/ProjectParameters".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B){c=h("esri.dijit.LocateButton",[b,k,l],{templateString:q,options:{theme:"LocateButton",map:null,visible:!0,highlightLocation:!0,symbol:new x(c.toUrl("./images/sdk_gps_location.png"),28,28),infoTemplate:null,scale:null,useTracking:!1,clearOnTrackingStop:!1,setScale:!0,centerAt:!0,timeout:15E3,graphicsLayer:null,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}},constructor:function(b,d){b=a.mixin({},this.options,b);this.domNode=
d;this._i18n=n;d=navigator.geolocation;var c=window.hasOwnProperty("isSecureContext");(c&&window.isSecureContext||!c&&"https:"===window.location.protocol)&&d||(b.visible=!1);this.set("map",b.map);this.set("theme",b.theme);this.set("visible",b.visible);this.set("scale",b.scale);this.set("highlightLocation",b.highlightLocation);this.set("symbol",b.symbol);this.set("infoTemplate",b.infoTemplate);this.set("geolocationOptions",b.geolocationOptions);this.set("useTracking",b.useTracking);this.set("setScale",
b.setScale);this.set("centerAt",b.centerAt);this.set("timeout",b.timeout);this.set("graphicsLayer",b.graphicsLayer);this.set("clearOnTrackingStop",b.clearOnTrackingStop);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this.watch("tracking",this._locate);this.watch("useTracking",a.hitch(this,function(){this.get("tracking")&&!this.get("useTracking")&&this._stopTracking();this._setTitle()}));this._css={container:"locateContainer",locate:"zoomLocateButton",loading:"loading",
tracking:"tracking"}},postCreate:function(){this.inherited(arguments);this.own(m(this._locateNode,g,a.hitch(this,this.locate)))},startup:function(){this.inherited(arguments);this.get("map")||this.set("visible",!1);if(this.get("map").loaded)this._init();else m.once(this.get("map"),"load",a.hitch(this,function(){this._init()}))},destroy:function(){this.clear();this._graphicsEvent&&this._graphicsEvent.remove();this._removeWatchPosition();this.inherited(arguments)},clear:function(){var a=this.get("highlightGraphic"),
b=this.get("graphicsLayer");a&&(b?b.remove(a):this.get("map").graphics.remove(a),this.set("highlightGraphic",null))},locate:function(){this.get("useTracking")&&this.set("tracking",!this.get("tracking"));return this._locate()},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_setTitle:function(){this.get("useTracking")?this.get("tracking")?u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.stopTracking):u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.tracking):
u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.title)},_removeWatchPosition:function(){this.get("watchId")&&(navigator.geolocation.clearWatch(this.get("watchId")),this.set("watchId",null));this._removePrivateVars()},_stopTracking:function(){r.remove(this._locateNode,this._css.tracking);this._removeWatchPosition();this.get("clearOnTrackingStop")&&this.clear();this._hideLoading()},_positionToObject:function(b){return b?{coords:a.mixin({},b.coords),timestamp:b.timestamp}:{}},_startTracking:function(){r.add(this._locateNode,
this._css.tracking);this._removeWatchPosition();var b=navigator.geolocation.watchPosition(a.hitch(this,function(b){b=this._positionToObject(b);this._setPosition(b).then(a.hitch(this,function(a){this._locateEvent(a)}),a.hitch(this,function(a){a||(a=Error("LocateButton::Error setting the position."));this._locateError(a)}))}),a.hitch(this,function(a){this.set("tracking",!1);a||(a=Error("LocateButton::Could not get tracking position."));this._locateError(a)}),this.get("geolocationOptions"));this.set("watchId",
b)},_removePrivateVars:function(){this._scale=this._position=this._graphic=null},_getCurrentPosition:function(){var b=new p;this._removePrivateVars();var d=setTimeout(a.hitch(this,function(){clearTimeout(d);b.reject(Error("LocateButton::time expired for getting location."))}),this.get("timeout"));navigator.geolocation.getCurrentPosition(a.hitch(this,function(c){c=this._positionToObject(c);clearTimeout(d);this._setPosition(c).then(a.hitch(this,function(a){b.resolve(a)}),a.hitch(this,function(a){a||
(a=Error("LocateButton::Error setting map position."));b.reject(a)}))}),a.hitch(this,function(a){a||(a=Error("LocateButton::Could not get current position."));b.reject(a)}),this.get("geolocationOptions"));return b.promise},_locate:function(){var b=new p;this._showLoading();if(navigator.geolocation)this.get("useTracking")?this.get("tracking")?(this._startTracking(),b.resolve({tracking:!0})):(this._stopTracking(),b.resolve({tracking:!1})):this._getCurrentPosition().then(a.hitch(this,function(a){this._locateEvent(a);
b.resolve(a)}),a.hitch(this,function(a){a||(a=Error("LocateButton::Could not get current position."));this._locateError(a);b.reject(a)}));else{var d=Error("LocateButton::geolocation unsupported");this._locateError(d);b.reject(d)}this._setTitle();return b.promise},_projectPoint:function(b){var c=new p,e=this.get("map").spatialReference,f=e.wkid;e.isWebMercator()?(b=w.geographicToWebMercator(b),c.resolve(b)):d.defaults.geometryService&&4326!==f?(f=new B,f.geometries=[b],f.outSR=e,d.defaults.geometryService.project(f).then(a.hitch(this,
function(a){a&&a.length?c.resolve(a[0]):c.reject(Error("LocateButton::Point was not projected."))}),function(a){a||(a=Error("LocateButton::please specify a geometry service on esri/config to project."));c.reject(a)})):c.resolve(b);return c.promise},_getScale:function(a){var b=this.get("scale");return a&&a.coords?b||a.coords.accuracy||5E4:b||5E4},_createPoint:function(a){var b;a&&a.coords&&(b=new t([a.coords.longitude,a.coords.latitude],new y({wkid:4326})));return b},_setPosition:function(b){var d=
new p,c,e;this._removePrivateVars();if((this._position=b)&&b.coords){if(c=this._createPoint(b))this._graphic=e=this._createGraphic(c,b);var f=this._getScale(b);this._scale=f;c?this._projectPoint(c).then(a.hitch(this,function(c){this._graphic=e=this._createGraphic(c,b);var g={graphic:e,scale:f,position:b};this.get("setScale")&&this.get("map").setScale(f);this.get("centerAt")?this.get("map").centerAt(c).then(a.hitch(this,function(){d.resolve(g)}),a.hitch(this,function(a){a||(a=Error("LocateButton::Could not center map."));
d.reject(a)})):d.resolve(g)}),a.hitch(this,function(a){a||(a=Error("LocateButton::Error projecting point."));d.reject(a)})):(c=Error("LocateButton::Invalid point"),d.reject(c))}else c=Error("LocateButton::Invalid position"),d.reject(c);return d.promise},_createGraphic:function(a,b){var d;a&&(b={position:b},d=new C(a,this.get("symbol"),b,this.get("infoTemplate")));return d},_locateEvent:function(a){if(a.graphic){var b=this.get("highlightGraphic"),d=this.get("graphicsLayer");b?(b.setGeometry(a.graphic.geometry),
b.setAttributes(a.graphic.attributes),b.setInfoTemplate(a.graphic.infoTemplate),b.setSymbol(a.graphic.symbol)):(b=a.graphic,this.get("highlightLocation")&&(d?d.add(b):this.get("map").graphics.add(b)));this.set("highlightGraphic",b)}this._hideLoading();this.emit("locate",a)},_locateError:function(a){a={graphic:this._graphic,scale:this._scale,position:this._position,error:a};this._hideLoading();this.emit("locate",a)},_showLoading:function(){this.get("useTracking")||r.add(this._locateNode,this._css.loading)},
_hideLoading:function(){this.get("useTracking")||r.remove(this._locateNode,this._css.loading)},_init:function(){this._visible();this._setTitle();this.get("tracking")&&this.get("useTracking")&&this._locate();this.set("loaded",!0);this.emit("load",{})},_updateThemeWatch:function(a,b,d){r.remove(this.domNode,b);r.add(this.domNode,d)},_visible:function(){this.get("visible")?v.set(this.domNode,"display","block"):v.set(this.domNode,"display","none")}});a.setObject("dijit.LocateButton",c,f);return c})},
"esri/layers/graphics":function(){define(["./GraphicsLayer","../graphic","../renderer"],function(){return{}})},"esri/renderer":function(){define("./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/ClassBreaksRenderer ./renderers/TemporalRenderer ./renderers/SymbolAger ./renderers/TimeClassBreaksAger ./renderers/TimeRampAger ./renderers/StretchRenderer ./renderers/jsonUtils".split(" "),function(c,l,h,a,e,f,d,b,g,k){return{Renderer:c,SimpleRenderer:l,UniqueValueRenderer:h,
ClassBreaksRenderer:a,TemporalRenderer:e,SymbolAger:f,TimeClassBreaksAger:d,TimeRampAger:b,StretchRenderer:g,jsonUtils:k}})},"esri/layers/agstiled":function(){define(["./agscommon","./ArcGISTiledMapServiceLayer"],function(){return{}})},"esri/layers/agsdynamic":function(){define(["./agscommon","./ArcGISDynamicMapServiceLayer","../_time"],function(){return{}})},"esri/_time":function(){define(["./TimeExtent"],function(){return{}})},"esri/layers/agsimageservice":function(){define("./agscommon ./ArcGISImageServiceLayer ./ImageServiceParameters ./MosaicRule ./RasterFunction ../utils".split(" "),
function(){return{}})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B){var z=
l([t],{declaredClass:"esri.layers.KMLLayer",serviceUrl:r.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(b,d){this._outSR=d&&d.outSR||new v({wkid:4326});this._options=a.mixin({},d);p.defaults.kmlService&&(this.serviceUrl=p.defaults.kmlService);if(b=this.linkInfo=d&&d.linkInfo)this.visible=!!b.visibility,this._waitingForMap=!!b.viewFormat;(!b||b&&b.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=a.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",
!0)},getFeature:function(b){if(b){var d=b.type,c=b.id,f;switch(d){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(b=this["_"+d])&&(f=a.getObject("_mode._featureMap."+c,!1,b));break;case "GroundOverlay":if(b=this._groundLyr){var g=b.getImages(),d=g.length;for(b=0;b<d;b++)if(g[b].id===c){f=g[b];break}}break;case "NetworkLink":e.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===c?(f=a,!0):!1});break;case "Folder":for(d=(g=this.folders)?g.length:0,b=0;b<
d;b++)if(g[b].id===c){f=g[b];break}}return f}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&e.forEach(this._links,function(b){b.declaredClass&&a.push(b)});return a},setFolderVisibility:function(a,b){a&&(this._fireUpdateStart(),(a.visible=b)&&(b=this._areLocalAncestorsVisible(a)),this._setState(a,b),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},onRefresh:function(){},onOpacityChange:function(){},
onNetworkLinkError:function(){},_parseKml:function(b){var d=this;this._fireUpdateStart();this._io=n({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(b),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:f.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){d._io=null;d._initLayer(a)},error:function(b){d._io=null;b=a.mixin(Error(),b);b.message="Unable to load KML: "+(b.message||"");d._fireUpdateEnd(b);d._errorHandler(b)}})},_initLayer:function(b){var d;
this.loaded&&(d=[],e.forEach(this.folders,function(a){a.visible&&d.push(a.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=b.name;this.description=b.description;this.snippet=b.snippet;this.visibility=b.visibility;this.featureInfos=b.featureInfos;var c,f,g=this.folders=b.folders,k=[],m;if(g)for(f=g.length,c=0;c<f;c++)m=g[c]=new y(g[c]),-1===m.parentFolderId&&k.push(m);var g=this._links=b.networkLinks,
n;f=g?g.length:0;for(c=0;c<f;c++)g[c].viewRefreshMode&&-1!==g[c].viewRefreshMode.toLowerCase().indexOf("onregion")||(n=a.mixin({},this._options),n.linkInfo=g[c],n.id&&(n.id=n.id+"_"+c),m=g[c]=new z(g[c].href,n),m._parentLayer=this,m._parentFolderId=this._getLinkParentId(m.linkInfo.id),m._linkErrorHandle=m.on("error,network-link-error",a.hitch(m,function(a){this._parentLayer.onNetworkLinkError(a.error)})));if((g=b.groundOverlays)&&0<g.length)for(n=a.mixin({},this._options),n.id&&(n.id+="_mapImage"),
m=this._groundLyr=new x(n),f=g.length,c=0;c<f;c++)m.addImage(new C(g[c]));(b=a.getObject("featureCollection.layers",!1,b))&&0<b.length&&(this._fLayers=[],e.forEach(b,function(b,d){var c=a.getObject("featureSet.features",!1,b);c&&0<c.length&&(n=a.mixin({outFields:["*"],infoTemplate:b.popupInfo?new w(b.popupInfo):null,editable:!1},this._options),n.id&&(n.id=n.id+"_"+d),n.webgl=!1,b.layerDefinition.capabilities="Query,Data",b=new B(b,n),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},
this),0===this._fLayers.length&&delete this._fLayers);if(!this.loaded)for(f=k.length,c=0;c<f;c++)m=k[c],this._setState(m,m.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),e.forEach(this.folders,function(a){-1<e.indexOf(d,a.id)?this.setFolderVisibility(a,!0):this.setFolderVisibility(a,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&e.forEach(this._links,function(b){b.declaredClass&&
(a.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(a):b._wMap=a))});var b=a.spatialReference,d=this._outSR,c;if(!b.equals(d))if(b.isWebMercator()&&4326===d.wkid)c=u.geographicToWebMercator;else if(d.isWebMercator()&&4326===b.wkid)c=u.webMercatorToGeographic;else return;this._groundLyr&&(c&&e.forEach(this._groundLyr.getImages(),function(a){a.extent=c(a.extent)}),a.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&e.forEach(b,function(b){if(c){var d=b.graphics,e,f,
g=d?d.length:0;for(e=0;e<g;e++)(f=d[e].geometry)&&d[e].setGeometry(c(f))}a.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&e.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel();a._linkErrorHandle&&(a._linkErrorHandle.remove(),a._linkErrorHandle=null)});a&&e.forEach(this.getLayers(),a.removeLayer,a)},_setState:function(a,b){a=a.featureInfos;var d,c,e,f=a?a.length:0,g=b?"show":"hide";for(e=0;e<f;e++)if(d=a[e],c=this.getFeature(d))if("Folder"===
d.type)this._setState(c,b&&c.visible);else if("NetworkLink"===d.type)this._setInternalVisibility(c,b);else c[g]()},_areLocalAncestorsVisible:function(a){var b=a.parentFolderId;for(a=a.visible;a&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),a=a&&b.visible,b=b.parentFolderId;return a},_setInternalVisibility:function(a,b){var d=a._parentLayer,c=a._parentFolderId;for(b=b&&a.visible;b&&d;)b=b&&d.visible,-1<c&&(b=b&&d._areLocalAncestorsVisible(d.getFeature({type:"Folder",id:c}))),c=d._parentFolderId,
d=d._parentLayer;this._setIntState(a,b)},_setIntState:function(a,b){a&&e.forEach(a.getLayers(),function(d){d.linkInfo?a._setIntState(d,b&&d.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:d._parentFolderId}))):d.setVisibility(b)})},_getLinkParentId:function(a){var b=-1;this.folders&&e.some(this.folders,function(d){return d.networkLinkIds&&-1!==e.indexOf(d.networkLinkIds,a)?(b=d.id,!0):!1});return b},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&
this._map){var b=a.refreshMode,d=a.refreshInterval,c=a.viewRefreshMode,a=a.viewRefreshTime;b&&-1!==b.toLowerCase().indexOf("oninterval")&&0<d&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*d));c&&-1!==c.toLowerCase().indexOf("onstop")&&0<a&&!this._extChgHandle&&(this._extChgHandle=h.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),h.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);
this._timeoutHandle=null},_getQueryParameters:function(d){d=d||this._map;var e={},f=this.linkInfo,g=d&&d.extent,k;this._url.query&&(a.mixin(e,this._url.query),k=!!this._url.query.token);m.id&&!k&&(k=m.id.findCredential(this._url.path))&&(e.token=k.token);if(f){k=f.viewFormat;var n=f.httpQuery,f=f.viewBoundScale;if(g&&k){var p=g,t=g,r=g.spatialReference;r&&(r.isWebMercator()?p=u.webMercatorToGeographic(g):4326===r.wkid&&(t=u.geographicToWebMercator(g)));g=p.getCenter();t=Math.max(t.getWidth(),t.getHeight());
f&&(p=p.expand(f));k=k.replace(/\[bboxWest\]/ig,p.xmin).replace(/\[bboxEast\]/ig,p.xmax).replace(/\[bboxSouth\]/ig,p.ymin).replace(/\[bboxNorth\]/ig,p.ymax).replace(/\[lookatLon\]/ig,g.x).replace(/\[lookatLat\]/ig,g.y).replace(/\[lookatRange\]/ig,t).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,g.x).replace(/\[lookatTerrainLat\]/ig,g.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,g.x).replace(/\[cameraLat\]/ig,g.y).replace(/\[cameraAlt\]/ig,
t).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,d.width).replace(/\[vertPixels\]/ig,d.height).replace(/\[terrainEnabled\]/ig,0);a.mixin(e,b.queryToObject(k))}n&&(n=n.replace(/\[clientVersion\]/ig,m.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,c.locale),a.mixin(e,b.queryToObject(n)))}d=[];for(var h in e)q.isDefined(e[h])&&d.push(h+"\x3d"+e[h]);return(d=d.join("\x26"))?"?"+d:""},setScaleRange:function(a,
b){this.inherited(arguments);e.forEach(this.getLayers(),function(d){d.setScaleRange(a,b)})},setOpacity:function(a){this.opacity!=a&&(e.forEach(this.getLayers(),function(b){b.setOpacity(a)}),this.opacity=a,this.onOpacityChange(a))},_setMap:function(a,b){this.inherited(arguments);this._map=a;var d=this._div=g.create("div",null,b);k.set(d,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return d},_unsetMap:function(a,b){this._io&&this._io.cancel();this._stopAutoRefresh();h.disconnect(this._extChgHandle);
delete this._extChgHandle;this._removeInternalLayers();var d=this._div;d&&(b.removeChild(d),g.destroy(d));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(a){var b,
d=[];(a=this.getFeature({type:"Folder",id:a}))&&(b=e.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<b.length&&e.forEach(this._fLayers,function(a){var c,f;c=a.toJson();c.featureSet.features&&0<c.featureSet.features.length&&(f=e.filter(c.featureSet.features,function(d){if(-1!==e.indexOf(b,d.attributes[a.objectIdField]))return d},this));f&&0<f.length&&(c.featureSet.features=f,d.push(c))},this);return d},
getFeatureCount:function(a){a=this.getFeature({type:"Folder",id:a});var b={points:0,polylines:0,polygons:0};a&&e.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(b.points+=1);"esriGeometryPolyline"===a.type&&(b.polylines+=1);"esriGeometryPolygon"===a.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});a.setObject("layers.KMLLayer",z,m);return z})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(c,l,h,a,e){c=c(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(a){l.mixin(this,a);e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});l.setObject("layers.KMLFolder",c,a);return c})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(c,l,h,a,e,f){c=c([f],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(a){e.isDefined(this.visibility)&&
(this.visible=!!this.visibility)}});l.setObject("layers.KMLGroundOverlay",c,a);return c})},"esri/layers/osm":function(){define(["./OpenStreetMapLayer"],function(){return{}})},"esri/SnappingManager":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has dojo/keys ./kernel ./graphic ./geometry/ScreenPoint ./geometry/Extent ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./tasks/query".split(" "),function(c,l,h,
a,e,f,d,b,g,k,m,p,q,n,r){c=c(null,{declaredClass:"esri.SnappingManager",constructor:function(a){a=a||{};this.map=a.map;this.tolerance=a.tolerance||15;this.layerInfos=[];if(a.layerInfos)this.layerInfos=a.layerInfos;else{var c;for(c=0;c<this.map.graphicsLayerIds.length;c++){var f=this.map.getLayer(this.map.graphicsLayerIds[c]);this.layerInfos.push({layer:f})}if(this.map.loaded)this.layerInfos.push({layer:this.map.graphics});else var g=l.connect(this.map,"onLoad",this,function(a){l.disconnect(g);g=null;
this.layerInfos.push({layer:this.map.graphics});this.setLayerInfos(this.layerInfos)})}this.snapPointSymbol=a.snapPointSymbol?a.snapPointSymbol:new q(q.STYLE_CROSS,15,new n(n.STYLE_SOLID,new e([0,255,255]),1),new e([0,255,0,0]));this.alwaysSnap=a.alwaysSnap?a.alwaysSnap:!1;this.snapKey=a.snapKey?a.snapKey:d("mac")?b.META:b.CTRL;this._SelectionLyrQuery=new r;this._SelectionLyrQuery.spatialRelationship=r.SPATIAL_REL_INTERSECTS;this._snappingGraphic=new k;this.setLayerInfos(this.layerInfos);this._currentGraphicOption=
{snapToPoint:!0,snapToVertex:!0,snapToEdge:!0};this._snappingCallback=h.hitch(this,this._snappingCallback)},getSnappingPoint:function(b){var d=this.layers,c=this.tolerance,e=this.map,g=this.layerOptions,k=e.toMap(b.offset(-c,c)),c=e.toMap(b.offset(c,-c)),k=new p(k.x,k.y,c.x,c.y,e.spatialReference),m=new r;m.geometry=k;m.spatialRelationship=r.SPATIAL_REL_INTERSECTS;var n=[],q=[],v,l=this._extractPointsAndLines,E=new f,N=0,O,c=k.xmin,K=k.xmax;a.forEach(d,function(a,b){a.visible&&a.loaded&&"esri.layers.FeatureLayer"===
a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&N++});e.spatialReference._isWrappable()&&(c=p.prototype._normalizeX(k.xmin,e.spatialReference._getInfo()).x,K=p.prototype._normalizeX(k.xmax,e.spatialReference._getInfo()).x);var H=new p(c,k.ymin,K,k.ymax,e.spatialReference);a.forEach(d,function(b,d){if("esri.layers.GraphicsLayer"===b.declaredClass&&b.visible){var c=[];a.forEach(b.graphics,function(a){a&&a.visible&&H.intersects(a.geometry)&&c.push(a)});b=l(c,g[d]);n=n.concat(b[0]);q=q.concat(b[1])}});
var J=h.hitch(this,function(a){N--;a instanceof Error||(a=l(a.features,g[O]),n=n.concat(a[0]),q=q.concat(a[1]));N||(v=this._getSnappingPoint(n,q,b),E.callback(v))}),L=!1;a.forEach(d,function(a,b){a.visible&&a.loaded&&(O=b,"esri.layers.FeatureLayer"===a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&(L=!0,a.queryFeatures(m,J,J)))});L||(v=this._getSnappingPoint(n,q,b),E.callback(v));return E},setLayerInfos:function(b){this.layers=[];this.layerOptions=[];var d;for(d=0;d<b.length;d++)this.layers.push(b[d].layer),
this.layerOptions.push({snapToPoint:!0,snapToVertex:!0,snapToEdge:!0}),!1===b[d].snapToPoint&&(this.layerOptions[d].snapToPoint=b[d].snapToPoint),!1===b[d].snapToVertex&&(this.layerOptions[d].snapToVertex=b[d].snapToVertex),!1===b[d].snapToEdge&&(this.layerOptions[d].snapToEdge=b[d].snapToEdge);this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];this._selectionLayers=[];this._selectionLayerOptions=[];a.forEach(this.layers,function(a,b){"esri.layers.FeatureLayer"===a.declaredClass&&
a.mode===a.constructor.MODE_SELECTION&&(this._selectionLayers.push(a),this._selectionLayerOptions.push(this.layerOptions[b]))},this);this.layerInfos=b},destroy:function(){l.disconnect(this._onExtentChangeConnect);this._killOffSnapping();this._featurePtsFromSelectionLayer=this._featureLinesFromSelectionLayer=this._currentFeaturePts=this._currentFeatureLines=this.layers=this.map=null},_startSelectionLayerQuery:function(){l.disconnect(this._onExtentChangeConnect);this._mapExtentChangeHandler(this._selectionLayers,
this._selectionLayerOptions,this.map.extent);this._onExtentChangeConnect=l.connect(this.map,"onExtentChange",h.hitch(this,"_mapExtentChangeHandler",this._selectionLayers,this._selectionLayerOptions))},_stopSelectionLayerQuery:function(){l.disconnect(this._onExtentChangeConnect)},_mapExtentChangeHandler:function(b,d,c){this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];var e;this._SelectionLyrQuery.geometry=c;var f=h.hitch(this,function(a){a instanceof Error||(a=this._extractPointsAndLines(a.features,
d[e]),this._featurePtsFromSelectionLayer=this._featurePtsFromSelectionLayer.concat(a[0]),this._featureLinesFromSelectionLayer=this._featureLinesFromSelectionLayer.concat(a[1]))});a.forEach(b,function(a,b){a.visible&&a.loaded&&(e=b,a.queryFeatures(this._SelectionLyrQuery,f,f))},this)},_extractPointsAndLines:function(b,d){var c=[],e=[],f,g;a.forEach(b,function(a,b){if((!a._graphicsLayer||a.visible)&&a.geometry)if("point"===a.geometry.type&&d.snapToPoint)c.push(a.geometry);else if("polyline"===a.geometry.type)for(f=
0;f<a.geometry.paths.length;f++){e.push("lineStart");for(g=0;g<a.geometry.paths[f].length;g++)b=a.geometry.getPoint(f,g),d.snapToVertex&&c.push(b),d.snapToEdge&&e.push(b);e.push("lineEnd")}else if("polygon"===a.geometry.type)for(f=0;f<a.geometry.rings.length;f++){e.push("lineStart");for(g=0;g<a.geometry.rings[f].length;g++)b=a.geometry.getPoint(f,g),d.snapToVertex&&c.push(b),d.snapToEdge&&e.push(b);e.push("lineEnd")}});return[c,e]},_getSnappingPoint:function(b,d,c){var e,f,g=this.tolerance,k=this.map,
n=this.map._getFrameWidth();b=b.concat(this._featurePtsFromSelectionLayer);d=d.concat(this._featureLinesFromSelectionLayer);if(this._currentGraphic){var p=this._extractPointsAndLines([this._currentGraphic],this._currentGraphicOption);b=b.concat(p[0]);d=d.concat(p[1])}var q,r;a.forEach(b,function(a,b){a=k.toScreen(a,!0);if(-1!==n&&(a.x%=n,0>a.x&&(a.x+=n),k.width>n))for(b=(k.width-n)/2;a.x<b;)a.x+=n;e=Math.sqrt((a.x-c.x)*(a.x-c.x)+(a.y-c.y)*(a.y-c.y));e<=g&&(g=e,q=a.x,r=a.y)});if(q)d=new m(q,r),f=d=
k.toMap(d);else{var h,v,g=this.tolerance;for(b=0;b<d.length;b++)if("lineStart"===d[b])for(p=b+1;p<d.length;p++){if("lineEnd"!==d[p+1]&&"lineStart"!==d[p+1]&&"lineEnd"!==d[p]&&"lineStart"!==d[p]){var u=k.toScreen(d[p],!0),l=k.toScreen(d[p+1],!0),w=u.x>=l.x?u:l,J=u.x>=l.x?l:u;-1!==n&&(w.x%=n,0>w.x&&(w.x+=n),J.x%=n,0>J.x&&(J.x+=n),J.x>w.x&&(J.x-=n));var u=w.x,w=w.y,l=J.x,J=J.y,L,R,M,Q,U,S;u===l?(L=u,R=c.y,M=Q=u,U=w<=J?w:J,S=w<=J?J:w):w===J?(L=c.x,R=w,M=u<=l?u:l,Q=u<=l?l:u,U=S=w):(R=(J-w)/(l-u),M=(w*
l-u*J)/(l-u),L=(M-(c.y*J-c.y*w-c.x*u+c.x*l)/(J-w))/((u-l)/(J-w)-R),R=R*L+M,M=u<=l?u:l,Q=u<=l?l:u,U=w<=J?w:J,S=w<=J?J:w);L>=M&&L<=Q&&R>=U&&R<=S?(u=Math.sqrt((c.x-L)*(c.x-L)+(c.y-R)*(c.y-R)),u<=g&&(g=u,h=L,v=R)):(L=Math.sqrt((u-c.x)*(u-c.x)+(w-c.y)*(w-c.y)),R=Math.sqrt((l-c.x)*(l-c.x)+(J-c.y)*(J-c.y)),L<=R?(M=L,L=u,R=w):(M=R,L=l,R=J),M<=g&&(g=M,h=L,v=R))}if("lineEnd"===d[p]){b=p;break}}h&&(d=new m(h,v),f=d=k.toMap(d))}return f},_setGraphic:function(a){this._currentGraphic=a},_addSnappingPointGraphic:function(){var a=
this.map;this._snappingGraphic.setSymbol(this.snapPointSymbol);a.graphics.add(this._snappingGraphic)},_setUpSnapping:function(){var a=this.map;this._onSnapKeyDown_connect=l.connect(a,"onKeyDown",this,"_onSnapKeyDownHandler");this._onSnapKeyUp_connect=l.connect(a,"onKeyUp",this,"_onSnapKeyUpHandler");this._onSnappingMouseMove_connect=l.connect(a,"onMouseMove",this,"_onSnappingMouseMoveHandler");this._onSnappingMouseDrag_connect=l.connect(a,"onMouseDrag",this,"_onSnappingMouseMoveHandler");this.alwaysSnap&&
this._activateSnapping()},_killOffSnapping:function(){l.disconnect(this._onSnapKeyDown_connect);l.disconnect(this._onSnapKeyUp_connect);l.disconnect(this._onSnappingMouseMove_connect);l.disconnect(this._onSnappingMouseDrag_connect);this._deactivateSnapping()},_onSnapKeyDownHandler:function(a){a.keyCode===this.snapKey&&(l.disconnect(this._onSnapKeyDown_connect),this.alwaysSnap?this._deactivateSnapping():this._activateSnapping())},_activateSnapping:function(){this._snappingActive=!0;this._addSnappingPointGraphic();
this._currentLocation&&this._onSnappingMouseMoveHandler(this._currentLocation)},_onSnapKeyUpHandler:function(a){a.keyCode===this.snapKey&&(this._onSnapKeyDown_connect=l.connect(this.map,"onKeyDown",this,"_onSnapKeyDownHandler"),this.alwaysSnap?this._activateSnapping():this._deactivateSnapping())},_deactivateSnapping:function(){this._snappingActive=!1;this._snappingPoint=null;this.map.graphics.remove(this._snappingGraphic);this._snappingGraphic.setGeometry(null)},_onSnappingMouseMoveHandler:function(a){this._currentLocation=
a;this._snappingPoint=null;this._snappingActive&&(this._snappingGraphic.hide(),this.getSnappingPoint(a.screenPoint).addCallback(this._snappingCallback))},_snappingCallback:function(a){if(this._snappingPoint=a)this._snappingGraphic.show(),this._snappingGraphic.setGeometry(a)}});return g.SnappingManager=c})},"esri/tasks/geometry":function(){define("./GeometryService ./TrimExtendParameters ./BufferParameters ./AreasAndLengthsParameters ./LengthsParameters ./RelationParameters ./DensifyParameters ./GeneralizeParameters ./OffsetParameters ./DistanceParameters ./ProjectParameters".split(" "),
function(){return{}})},"esri/tasks/TrimExtendParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(c,l,h,a,e,f){c=c(null,{declaredClass:"esri.tasks.TrimExtendParameters",polylines:null,trimExtendTo:null,extendHow:null,toJson:function(){var d=h.map(this.polylines,function(a){return a.toJson()}),b={};b.polylines=a.toJson(d);b.trimExtendTo=a.toJson(this.trimExtendTo.toJson());b.sr=a.toJson(this.polylines[0].spatialReference.toJson());
b.extendHow=this.extendHow||0;return b}});l.mixin(c,{DEFAULT_CURVE_EXTENSION:0,RELOCATE_ENDS:1,KEEP_END_ATTRIBUTES:2,NO_END_ATTRIBUTES:4,NO_EXTEND_AT_FROM:8,NO_EXTEND_AT_TO:16});l.setObject("tasks.TrimExtendParameters",c,f);return c})},"esri/tasks/BufferParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/Polygon ../geometry/jsonUtils".split(" "),function(c,l,h,a,e,f,d,b){c=c(null,{declaredClass:"esri.tasks.BufferParameters",
geometries:null,outSpatialReference:null,bufferSpatialReference:null,distances:null,unit:null,unionResults:!1,geodesic:!1,toJson:function(){var c={unit:this.unit,unionResults:this.unionResults,geodesic:this.geodesic},e=this.distances,f=this.outSpatialReference,p=this.bufferSpatialReference,q=h.map(this.geometries,function(a){a="extent"===a.type?d.fromExtent(a):a;return a.toJson()},this),n=this.geometries;if(n&&0<n.length){var r="extent"===n[0].type?"esriGeometryPolygon":b.getJsonType(n[0]);c.geometries=
a.toJson({geometryType:r,geometries:q});c.inSR=n[0].spatialReference.wkid?n[0].spatialReference.wkid:a.toJson(n[0].spatialReference.toJson())}e&&(c.distances=e.join(","));f&&(c.outSR=f.wkid?f.wkid:a.toJson(f.toJson()));p&&(c.bufferSR=p.wkid?p.wkid:a.toJson(p.toJson()));return c}});l.setObject("tasks.BufferParameters",c,f);return c})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),
function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var b=h.map(this.geometries1,function(a){return a.toJson()}),c=h.map(this.geometries2,function(a){return a.toJson()}),e={},f=this.geometries1;f&&0<f.length&&(e.geometries1=a.toJson({geometryType:d.getJsonType(f[0]),geometries:b}),b=this.geometries1[0].spatialReference,e.sr=b.wkid?b.wkid:a.toJson(b.toJson()));(b=this.geometries2)&&0<b.length&&
(e.geometries2=a.toJson({geometryType:d.getJsonType(b[0]),geometries:c}));this.relation&&(e.relation=this.relation);this.relationParam&&(e.relationParam=this.relationParam);return e}});l.mixin(c,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",
SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});l.setObject("tasks.RelationParameters",c,f);return c})},"esri/tasks/DensifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),
function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.tasks.DensifyParameters",geometries:null,geodesic:null,lengthUnit:null,maxSegmentLength:null,toJson:function(){var b=h.map(this.geometries,function(a){return a.toJson()}),c={};this.geometries&&0<this.geometries.length&&(c.geometries=a.toJson({geometryType:d.getJsonType(this.geometries[0]),geometries:b}),c.sr=a.toJson(this.geometries[0].spatialReference.toJson()));this.geodesic&&(c.geodesic=this.geodesic);this.lengthUnit&&(c.lengthUnit=this.lengthUnit);
this.maxSegmentLength&&(c.maxSegmentLength=this.maxSegmentLength);return c}});l.setObject("tasks.DensifyParameters",c,f);return c})},"esri/tasks/GeneralizeParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.tasks.GeneralizeParameters",geometries:null,deviationUnit:null,maxDeviation:null,toJson:function(){var b=h.map(this.geometries,function(a){return a.toJson()}),
c={};this.geometries&&0<this.geometries.length&&(c.geometries=a.toJson({geometryType:d.getJsonType(this.geometries[0]),geometries:b}),c.sr=a.toJson(this.geometries[0].spatialReference.toJson()));this.deviationUnit&&(c.deviationUnit=this.deviationUnit);this.maxDeviation&&(c.maxDeviation=this.maxDeviation);return c}});l.setObject("tasks.GeneralizeParameters",c,f);return c})},"esri/tasks/OffsetParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),
function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.tasks.OffsetParameters",geometries:null,bevelRatio:null,offsetDistance:null,offsetHow:null,offsetUnit:null,toJson:function(){var b=h.map(this.geometries,function(a){return a.toJson()}),c={};this.geometries&&0<this.geometries.length&&(c.geometries=a.toJson({geometryType:d.getJsonType(this.geometries[0]),geometries:b}),c.sr=a.toJson(this.geometries[0].spatialReference.toJson()));this.bevelRatio&&(c.bevelRatio=this.bevelRatio);this.offsetDistance&&
(c.offsetDistance=this.offsetDistance);this.offsetHow&&(c.offsetHow=this.offsetHow);this.offsetUnit&&(c.offsetUnit=this.offsetUnit);return c}});l.mixin(c,{OFFSET_BEVELLED:"esriGeometryOffsetBevelled",OFFSET_MITERED:"esriGeometryOffsetMitered",OFFSET_ROUNDED:"esriGeometryOffsetRounded"});l.setObject("tasks.OffsetParameters",c,f);return c})},"esri/tasks/DistanceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(c,
l,h,a,e,f){c=c(null,{declaredClass:"esri.tasks.DistanceParameters",geometry1:null,geometry2:null,distanceUnit:null,geodesic:null,toJson:function(){var a={},b=this.geometry1;b&&(a.geometry1=h.toJson({geometryType:f.getJsonType(b),geometry:b}));if(b=this.geometry2)a.geometry2=h.toJson({geometryType:f.getJsonType(b),geometry:b});a.sr=h.toJson(this.geometry1.spatialReference.toJson());this.distanceUnit&&(a.distanceUnit=this.distanceUnit);this.geodesic&&(a.geodesic=this.geodesic);return a}});l.setObject("tasks.DistanceParameters",
c,e);return c})},"esri/tasks/identify":function(){define(["./IdentifyTask","./IdentifyParameters","./IdentifyResult"],function(){return{}})},"esri/tasks/IdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./IdentifyResult".split(" "),function(c,l,h,a,e,f,d,b,g){c=c(b,{declaredClass:"esri.tasks.IdentifyTask",_eventMap:{complete:["results"]},constructor:function(a,b){this._url.path+="/identify";this._handler=
l.hitch(this,this._handler);this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(a,b,d,c,e){try{var f=[];h.forEach(a.results,function(a,b){f[b]=new g(a)});this._successHandler([f],"onComplete",d,e)}catch(v){this._errorHandler(v,c,e)}},execute:function(a,b,d,c){var e=c.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson(e&&e[0])));var g=this._handler,k=this._errorHandler;this.gdbVersion&&(a.gdbVersion=
this.gdbVersion);return f({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,e){g(a,e,b,d,c.dfd)},error:function(a){k(a,d,c.dfd)}})},onComplete:function(){}});d._createWrappers(c);l.setObject("tasks.IdentifyTask",c,e);return c})},"esri/tasks/IdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),function(c,l,h,a,e,f){c=c(null,{declaredClass:"esri.tasks.IdentifyResult",constructor:function(a){l.mixin(this,
a);this.feature=new e(a.geometry?f.fromJson(a.geometry):null,null,a.attributes);delete this.geometry;delete this.attributes}});l.setObject("tasks.IdentifyResult",c,a);return c})},"esri/tasks/IdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils ../geometry/jsonUtils ../geometry/scaleUtils".split(" "),function(c,l,h,a,e,f,d,b,g){var k=c(null,{declaredClass:"esri.tasks.IdentifyParameters",constructor:function(){this.layerOption=
k.LAYER_OPTION_TOP},geometry:null,spatialReference:null,layerIds:null,tolerance:null,returnGeometry:!1,returnFieldName:!1,returnUnformattedValues:!1,mapExtent:null,width:400,height:400,dpi:96,layerDefinitions:null,timeExtent:null,layerTimeOptions:null,dynamicLayerInfos:null,toJson:function(c){var e=c&&c.geometry||this.geometry,f=this.mapExtent,k=this.spatialReference,m=this.layerIds;c={tolerance:this.tolerance,returnGeometry:this.returnGeometry,returnFieldName:this.returnFieldName,returnUnformattedValues:this.returnUnformattedValues,
imageDisplay:this.width+","+this.height+","+this.dpi,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision};if(e){var v=e.toJson();delete v.spatialReference;c.geometry=a.toJson(v);c.geometryType=b.getJsonType(e)}k?c.sr=k.wkid||a.toJson(k.toJson()):e&&e.spatialReference?c.sr=e.spatialReference.wkid||a.toJson(e.spatialReference.toJson()):f&&f.spatialReference&&(c.sr=f.spatialReference.wkid||a.toJson(f.spatialReference.toJson()));f&&(c.mapExtent=f.xmin+","+f.ymin+","+f.xmax+
","+f.ymax);c.layers=this.layerOption;m&&(c.layers+=":"+m.join(","));c.layerDefs=d._serializeLayerDefinitions(this.layerDefinitions,!0);e=this.timeExtent;c.time=e?e.toJson().join(","):null;c.layerTimeOptions=d._serializeTimeOptions(this.layerTimeOptions);if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){var f=g.getScale({extent:f,width:this.width,spatialReference:f.spatialReference}),u=d._getLayersForScale(f,this.dynamicLayerInfos),l=[];h.forEach(this.dynamicLayerInfos,function(a){if(!a.subLayerIds){var b=
a.id;if((!this.layerIds||this.layerIds&&-1!==h.indexOf(this.layerIds,b))&&-1!==h.indexOf(u,b)){var d={id:b};d.source=a.source&&a.source.toJson();var c;this.layerDefinitions&&this.layerDefinitions[b]&&(c=this.layerDefinitions[b]);c&&(d.definitionExpression=c);var e;this.layerTimeOptions&&this.layerTimeOptions[b]&&(e=this.layerTimeOptions[b]);e&&(d.layerTimeOptions=e.toJson());l.push(d)}}},this);f=a.toJson(l);"[]"===f&&(f="[{}]");c.dynamicLayers=f}return c}});l.mixin(k,{LAYER_OPTION_TOP:"top",LAYER_OPTION_VISIBLE:"visible",
LAYER_OPTION_ALL:"all"});l.setObject("tasks.IdentifyParameters",k,f);return k})},"esri/virtualearth/VEGeocoder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/has ../kernel ../urlUtils ../tasks/Task ./VEGeocodeResult ../deferredUtils ../request".split(" "),function(c,l,h,a,e,f,d,b,g,k,m){c=c(b,{declaredClass:"esri.virtualearth.VEGeocoder",constructor:function(a){try{if(a=l.mixin({bingMapsKey:null},a||{}),this.url=d.getProtocolForWebResource()+"//serverapi.arcgisonline.com/veadaptor/production/services/geocode/geocode",
this._url=d.urlToObject(this.url),this._queue=[],this.bingMapsKey=a.bingMapsKey,this.culture=a.culture||"en-US",this._errorHandler=l.hitch(this,this._errorHandler),this._addressToLocationsHandler=l.hitch(this,this._addressToLocationsHandler),!this.bingMapsKey)throw Error("BingMapsKey must be provided.");}catch(q){throw this.onError(q),q;}},addressToLocations:function(b,d,c){if(this.bingMapsKey){var e=l.mixin({},this._url.query,{query:b,token:this.bingMapsKey,culture:this.culture}),f=this._addressToLocationsHandler,
g=this._errorHandler,n=new a(k._dfdCanceller);n._pendingDfd=m({url:this._url.path,content:e,callbackParamName:"callback",load:function(a,b){f(a,b,d,c,n)},error:function(a){g(a,c,n)}});return n}this._queue.push(arguments)},_addressToLocationsHandler:function(a,b,d,c,e){try{h.forEach(a,function(b,d){a[d]=new g(b)}),this._successHandler([a],"onAddressToLocationsComplete",d,e)}catch(u){this._errorHandler(u,c,e)}},onAddressToLocationsComplete:function(){},setBingMapsKey:function(a){this.bingMapsKey=a},
setCulture:function(a){this.culture=a}});l.setObject("virtualearth.VEGeocoder",c,f);return c})},"esri/virtualearth/VEGeocodeResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/Point ../geometry/Extent ./VEAddress".split(" "),function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.virtualearth.VEGeocodeResult",constructor:function(a){l.mixin(this,{address:null,bestView:null,calculationMethod:null,confidence:null,displayName:null,entityType:null,location:null,
matchCodes:null},a);this.address&&(this.address=new d(this.address));this.bestView&&(this.bestView=new f(this.bestView));this.locationArray&&(this.calculationMethod=this.locationArray[0].calculationMethod,this.location=new e(this.locationArray[0]))}});l.setObject("virtualearth.VEGeocodeResult",c,a);return c})},"esri/virtualearth/VEAddress":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,h,a){c=c(null,{declaredClass:"esri.virtualearth.VEAddress",constructor:function(a){l.mixin(this,
{addressLine:null,adminDistrict:null,countryRegion:null,district:null,formattedAddress:null,locality:null,postalCode:null,postalTown:null},a)}});l.setObject("virtualearth.VEAddress",c,a);return c})},"esri/dijit/Geocoder":function(){define("require dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/_base/event dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/keys dojo/on dojo/query dojo/i18n!../nls/jsapi dojo/text!./templates/Geocoder.html dojo/uacss dojo/_base/kernel dijit/a11yclick dijit/_TemplatedMixin dijit/focus dijit/_FocusMixin ../kernel ../urlUtils ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ./_EventedWidget ../geometry/Point ../geometry/Extent ../tasks/locator ../tasks/query ../tasks/QueryTask ../geometry/scaleUtils".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J){l=l("esri.dijit.Geocoder",[A,w,y],{templateString:n,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,_eventMap:{select:["result"],"find-results":["results"],"auto-complete":["results"],"geocoder-select":["geocoder"],clear:!0,"enter-key-select":!0,load:!0},constructor:function(a,b){v.deprecated("esri.dijit.Geocoder","Use esri.dijit.Search instead","4.0");this._css={GeocoderContainerClass:"esriGeocoderContainer",GeocoderClass:"esriGeocoder",
GeocoderMultipleClass:"esriGeocoderMultiple",GeocoderIconClass:"esriGeocoderIcon",GeocoderActiveClass:"esriGeocoderActive",GeocoderResultsOpenClass:"esriGeocoderResultsOpen",GeocoderMenuOpenClass:"esriGeocoderMenuOpen",loadingClass:"esriGeocoderLoading",resultsContainerClass:"esriGeocoderResults",resultsItemClass:"esriGeocoderResult",resultsItemEvenClass:"esriGeocoderResultEven",resultsItemOddClass:"esriGeocoderResultOdd",resultsItemFirstClass:"esriGeocoderResultFirst",resultsItemLastClass:"esriGeocoderResultLast",
resultsPartialMatchClass:"esriGeocoderResultPartial",searchButtonClass:"esriGeocoderSearch",clearButtonClass:"esriGeocoderReset",hasValueClass:"esriGeocoderHasValue",geocoderMenuClass:"esriGeocoderMenu",geocoderMenuHeaderClass:"esriGeocoderMenuHeader",geocoderMenuCloseClass:"esriGeocoderMenuClose",activeMenuClass:"esriGeocoderMenuActive",geocoderMenuArrowClass:"esriGeocoderMenuArrow",geocoderSelectedClass:"esriGeocoderSelected",geocoderSelectedCheckClass:"esriGeocoderSelectedCheck",GeocoderClearClass:"esriGeocoderClearFloat"};
this.options={autoComplete:!1,arcgisGeocoder:!0,value:"",theme:"simpleGeocoder",activeGeocoderIndex:0,maxLocations:6,minCharacters:3,searchDelay:300,geocoderMenu:!0,autoNavigate:!0,showResults:!0,map:null,activeGeocoder:null,geocoders:null,zoomScale:1E4,highlightLocation:!1,symbol:new F(c.toUrl("./images/sdk_gps_location.png"),28,28),graphicsLayer:null};a=h.mixin({},this.options,a);this.set("autoComplete",a.autoComplete);this.set("arcgisGeocoder",a.arcgisGeocoder);this.set("value",a.value);this.set("theme",
a.theme);this.set("activeGeocoderIndex",a.activeGeocoderIndex);this.set("maxLocations",a.maxLocations);this.set("minCharacters",a.minCharacters);this.set("searchDelay",a.searchDelay);this.set("geocoderMenu",a.geocoderMenu);this.set("autoNavigate",a.autoNavigate);this.set("showResults",a.showResults);this.set("map",a.map);this.set("activeGeocoder",a.activeGeocoder);this.set("geocoders",a.geocoders);this.set("zoomScale",a.zoomScale);this.set("highlightLocation",a.highlightLocation);this.set("symbol",
a.symbol);this.set("graphicsLayer",a.graphicsLayer);this.set("results",[]);this._i18n=q;this._deferreds=[];this._defaultSR=new B(4326);this.watch("value",this._updateValue);this.watch("theme",this._updateTheme);this.watch("activeGeocoder",this._setActiveGeocoder);this.watch("activeGeocoderIndex",this._setActiveGeocoderIndex);this.watch("geocoders",this._updateGeocoder);this.watch("arcgisGeocoder",this._updateGeocoder);this.watch("geocoderMenu",this._updateGeocoder);this.watch("map",this._setupEvents);
this.domNode=b},startup:function(){this.inherited(arguments);if(this._geocoders.length)if(this.domNode)if(this.get("map"))if(this.get("map").loaded)this._init();else m.once(this.get("map"),"load",h.hitch(this,function(){this._init()}));else this._init();else this.destroy();else this.destroy()},postCreate:function(){this.inherited(arguments);this.own(m(this.submitNode,u,h.hitch(this,this._findThenSelect)));this.own(m(this.geocoderMenuArrowNode,u,h.hitch(this,this._toggleGeolocatorMenu)));this.own(m(this.inputNode,
u,h.hitch(this,this._inputClick)));this.own(m(this.clearNode,u,h.hitch(this,this.clear)));this.own(m(this.geocoderMenuCloseNode,u,h.hitch(this,this._hideGeolocatorMenu)));this._updateGeocoder();this._setupEvents();this.get("value")&&this._checkStatus();this._hideMenus()},destroy:function(){this._removeEvents();g.empty(this.domNode);this.inherited(arguments)},clear:function(){this.onClear();var a=this.get("highlightGraphic"),b=this.get("graphicsLayer");a&&(b?b.remove(a):this.get("map").graphics.remove(a),
this.set("highlightGraphic",null));f.set(this.inputNode,"value","");this.set("value","");this.set("results",[]);d.remove(this.containerNode,this._css.hasValueClass);f.set(this.clearNode,"title","");this._hideMenus();this._hideLoading()},show:function(){b.set(this.domNode,"display","block")},hide:function(){b.set(this.domNode,"display","none")},find:function(b){var d=new a;if(b)if("string"===typeof b)this._findQuery(b).then(function(a){d.resolve(a)});else if("object"===typeof b&&b.hasOwnProperty("geometry")){var c;
switch(b.geometry.type){case "extent":c=b.geometry.getCenter();break;case "multipoint":c=b.geometry.getExtent().getCenter();break;case "point":c=b.geometry;break;case "polygon":c=b.geometry.getExtent().getCenter();break;case "polyline":c=b.geometry.getExtent().getCenter()}c&&this._reverseGeocodePoint(c,b.geometry).then(function(a){a.results[0]&&(b.hasOwnProperty("attributes")&&a.results[0].feature.setAttributes(h.mixin(a.results[0].feature.attributes,b.attributes)),b.hasOwnProperty("infoTemplate")&&
a.results[0].feature.setInfoTemplate(b.infoTemplate),b.hasOwnProperty("symbol")&&a.results[0].feature.setSymbol(b.symbol));d.resolve(a)},function(a){d.reject(a)})}else"object"===typeof b&&"point"===b.type?this._reverseGeocodePoint(b).then(function(a){d.resolve(a)},function(a){d.reject(a)}):b instanceof Array&&2===b.length?(c=new E(b,new B({wkid:4326})),this._reverseGeocodePoint(c).then(function(a){d.resolve(a)},function(a){d.reject(a)})):d.reject("Geocoder:: Invalid find type");else this._findQuery(this.get("value")).then(function(a){d.resolve(a)});
return d.promise},focus:function(){t.focus(this.inputNode);var a=this.get("map");a&&a.disableKeyboardNavigation()},blur:function(){t.curNode&&t.curNode.blur();this.inputNode.blur();this._hideMenus();var a=this.get("map");a&&a.enableKeyboardNavigation()},select:function(a){this.onSelect(a);this._hideMenus();this._hideLoading();this.get("autoNavigate")&&a&&a.hasOwnProperty("extent")&&this.get("map")&&this.get("map").setExtent(a.extent);if(a.feature){var b=this.get("highlightGraphic"),d=this.get("graphicsLayer"),
c=this.get("symbol")||a.feature.symbol;b?(b.setGeometry(a.feature.geometry),b.setAttributes(a.feature.attributes),b.setInfoTemplate(a.feature.infoTemplate),b.setSymbol(c)):(b=a.feature,this.get("highlightLocation")&&(b.setSymbol(c),d?d.add(b):this.get("map").graphics.add(b)));this.set("highlightGraphic",b)}},onSelect:function(){},onFindResults:function(){},onAutoComplete:function(){},onGeocoderSelect:function(){},onClear:function(){},onEnterKeySelect:function(){},onLoad:function(){},_onFocus:function(){this.focus();
this.inherited(arguments)},_onBlur:function(){this.blur();this.inherited(arguments)},_autoComplete:function(){var a=this.get("activeGeocoder"),b=this.reHostedFS.test(a.url);("query"!==a.type||b)&&this._query({delay:this.get("searchDelay"),autoComplete:!0,search:this.get("value")}).then(h.hitch(this,function(a){this.onAutoComplete(a);this.get("showResults")&&this._showResults(a)}))},_init:function(){this.set("loaded",!0);this.onLoad()},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<
a.charCodeAt(b))return!0;return!1},_findQuery:function(b){var d=new a;this._query({delay:0,search:b}).then(h.hitch(this,function(a){this.onFindResults(a);d.resolve(a)}),h.hitch(this,function(a){this.onFindResults(a);d.reject(a)}));return d.promise},_reverseGeocodePoint:function(b,d){var c=new a;if(b&&this.get("activeGeocoder")){var e=d||b;d=this.get("activeGeocoder").distance||1500;this._task.outSpatialReference=this._defaultSR;this.get("map")&&(this._task.outSpatialReference=this.get("map").spatialReference);
this._task.locationToAddress(b,d,h.hitch(this,function(a){a={results:[this._hydrateResult(a)],geometry:e};this.onFindResults(a);c.resolve(a)}),h.hitch(this,function(a){c.reject(a)}))}else c.reject("Geocoder:: no point or active geocoder defined");return c.promise},_setEsriGeocoder:function(){this.get("arcgisGeocoder")?("object"===typeof this.get("arcgisGeocoder")?this._arcgisGeocoder=this.get("arcgisGeocoder"):this._arcgisGeocoder={},this._arcgisGeocoder.hasOwnProperty("suggest")||(this._arcgisGeocoder.suggest=
!0),this._arcgisGeocoder.hasOwnProperty("singleLineFieldName")||(this._arcgisGeocoder.singleLineFieldName="SingleLine"),this._arcgisGeocoder.url||(this._arcgisGeocoder.url=x.getProtocolForWebResource()+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),this._arcgisGeocoder.name||(this._arcgisGeocoder.name=q.widgets.Geocoder.esriGeocoderName),this._arcgisGeocoder.hasOwnProperty("localSearchOptions")||(this._arcgisGeocoder.localSearchOptions={minScale:3E5,distance:5E4}),this.set("arcgisGeocoder",
this._arcgisGeocoder)):this.set("arcgisGeocoder",!1)},_setActiveGeocoder:function(){this.set("activeGeocoder",this._geocoders[this.get("activeGeocoderIndex")]);this._task="query"===this.activeGeocoder.type?new H(this.get("activeGeocoder").url):new O(this.get("activeGeocoder").url);this._updatePlaceholder()},_setGeocoderList:function(){var a=[];this.get("arcgisGeocoder")&&(a=a.concat([this._arcgisGeocoder]));this.get("geocoders")&&this.get("geocoders").length&&(a=a.concat(this.get("geocoders")));this._geocoders=
a},_updateGeocoder:function(){this.set("activeGeocoderIndex",0);this._setEsriGeocoder();this._setGeocoderList();this._setActiveGeocoder();this._insertGeocoderMenuItems()},_updatePlaceholder:function(){this._placeholder="";this.get("activeGeocoder")&&this.get("activeGeocoder").placeholder&&(this._placeholder=this.get("activeGeocoder").placeholder);f.set(this.inputNode,"placeholder",this._placeholder);f.set(this.submitNode,"title",this._placeholder)},_updateValue:function(a,b,d){this._ignoreUpdateValue||
(f.set(this.inputNode,"value",d),this._checkStatus())},_updateTheme:function(a,b,c){d.remove(this.domNode,b);d.add(this.domNode,c)},_setActiveGeocoderIndex:function(a,b,d){this.set("activeGeocoderIndex",d);this._setActiveGeocoder();this._hideMenus();this._insertGeocoderMenuItems();a={attr:this.get("activeGeocoder"),oldVal:b,newVal:d};this.onGeocoderSelect(a)},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_query:function(b){b||(b={delay:0});b.search||(b.search=this.get("value"));
var d=new a;this._deferreds.push(d);b.delay?(this._clearQueryTimeout(),this._queryTimer=setTimeout(h.hitch(this,function(){this._performTask(d,b)}),b.delay)):this._performTask(d,b);return d.promise},_performTask:function(a,b){if(b.search){this._hideGeolocatorMenu();this._showLoading();var d="";this.get("activeGeocoder").prefix&&(d+=this.get("activeGeocoder").prefix);d+=b.search;this.get("activeGeocoder").suffix&&(d+=this.get("activeGeocoder").suffix);var c=this.get("activeGeocoder").outFields;c&&
(c instanceof Array||(c=[c]));var e=this.get("maxLocations")||6,f=this.get("activeGeocoder").searchExtent,g=this._defaultSR;this.get("map")&&(g=this.get("map").spatialReference);if("query"===this.get("activeGeocoder").type){var k=new K;k.outSpatialReference=g;k.returnGeometry=!0;k.num=e;f&&(k.geometry=f);e=this.get("activeGeocoder").exactMatch;f=this.get("activeGeocoder").field;g="";this.reHostedFS.test(this.get("activeGeocoder").url)&&this._containsNonLatinCharacter(d)&&(g="N");k.where=e?f+" \x3d "+
g+"'"+d+"'":"UPPER("+f+") LIKE "+g+"'%"+d.toUpperCase()+"%'";c&&(k.outFields=c);this._task.execute(k,h.hitch(this,function(d){this._receivedResults(d.features,a,b)}),h.hitch(this,function(d){this._receivedResults([],a,b)}))}else k={},this.get("activeGeocoder").categories&&(k.categories=this.get("activeGeocoder").categories),this._task.outSpatialReference=g,this.get("map")&&this.get("activeGeocoder").localSearchOptions&&this.get("activeGeocoder").localSearchOptions.hasOwnProperty("distance")&&this.get("activeGeocoder").localSearchOptions.hasOwnProperty("minScale")&&
(g=this.get("map").getScale(),!this.get("activeGeocoder").localSearchOptions.minScale||g&&g<=parseFloat(this.get("activeGeocoder").localSearchOptions.minScale))&&(k.location=this.get("map").extent.getCenter(),k.distance=this.get("activeGeocoder").localSearchOptions.distance),this.get("activeGeocoder").suggest&&b.autoComplete?(k.text=d,f&&(k.searchExtent=f),this._task.suggestLocations(k).then(h.hitch(this,function(d){this._receivedResults(d,a,b)}),h.hitch(this,function(d){this._receivedResults(d,a,
b)}))):(k.address={},k.maxLocations=e,f&&(k.searchExtent=f),this.get("activeGeocoder").sourceCountry&&(k.countryCode=this.get("activeGeocoder").sourceCountry),b.magicKey&&(k.magicKey=b.magicKey),this.get("activeGeocoder").singleLineFieldName?k.address[this.get("activeGeocoder").singleLineFieldName]=d:k.address["Single Line Input"]=d,c&&(k.outFields=c),this._task.addressToLocations(k,h.hitch(this,function(d){this._receivedResults(d,a,b)}),h.hitch(this,function(d){this._receivedResults(d,a,b)})))}else this._hideLoading(),
a.reject("Geocoder:: no search to perform")},_showResults:function(){this._hideGeolocatorMenu();var a="";if(this.get("results")&&this.get("results").length&&this.resultsNode){for(var b=this.get("value"),d=new RegExp("("+b+")","gi"),a=a+'\x3cul role\x3d"presentation"\x3e',b=0;b<this.get("results").length&&5>b;++b){var c=this.get("results")[b].text||this.get("results")[b].name,e=this._css.resultsItemClass+" ",e=0===b%2?e+this._css.resultsItemOddClass:e+this._css.resultsItemEvenClass;0===b?e+=" "+this._css.resultsItemFirstClass:
b===this.get("results").length-1&&(e+=" "+this._css.resultsItemLastClass);a+='\x3cli title\x3d"'+c+'" data-text\x3d"'+c+'" data-item\x3d"true" data-index\x3d"'+b+'" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+e+'"\x3e'+c.replace(d,'\x3cstrong class\x3d"'+this._css.resultsPartialMatchClass+'"\x3e$1\x3c/strong\x3e')+"\x3c/li\x3e"}a+="\x3c/ul\x3e";this.resultsNode&&(this.resultsNode.innerHTML=a);this._autoCompleteEvent();this._showResultsMenu()}else this.resultsNode&&(this.resultsNode.innerHTML=a),
this._hideResultsMenu()},_receivedResults:function(a,b){this._hideLoading();a=this._hydrateResults(a);this.set("results",a);a={results:a,value:this.get("value")};b.resolve(a)},_showLoading:function(){d.add(this.containerNode,this._css.loadingClass)},_hideLoading:function(){d.remove(this.containerNode,this._css.loadingClass)},_showGeolocatorMenu:function(){d.add(this.containerNode,this._css.activeMenuClass);d.add(this.domNode,this._css.GeocoderMenuOpenClass);b.set(this.geocoderMenuNode,"display","block");
f.set(this.geocoderMenuInsertNode,"aria-hidden","false");f.set(this.geocoderMenuArrowNode,"aria-expanded","true")},_hideGeolocatorMenu:function(){d.remove(this.containerNode,this._css.activeMenuClass);d.remove(this.domNode,this._css.GeocoderMenuOpenClass);b.set(this.geocoderMenuNode,"display","none");f.set(this.geocoderMenuInsertNode,"aria-hidden","true");f.set(this.geocoderMenuArrowNode,"aria-expanded","false")},_toggleGeolocatorMenu:function(){this._hideResultsMenu();"block"===b.get(this.geocoderMenuNode,
"display")?this._hideGeolocatorMenu():this._showGeolocatorMenu()},_showResultsMenu:function(){d.add(this.containerNode,this._css.GeocoderActiveClass);d.add(this.domNode,this._css.GeocoderResultsOpenClass);b.set(this.resultsNode,"display","block");f.set(this.resultsNode,"aria-hidden","false")},_hideResultsMenu:function(){b.set(this.resultsNode,"display","none");d.remove(this.containerNode,this._css.GeocoderActiveClass);d.remove(this.domNode,this._css.GeocoderResultsOpenClass);f.set(this.resultsNode,
"aria-hidden","true")},_hideMenus:function(){this._hideGeolocatorMenu();this._hideResultsMenu()},_insertGeocoderMenuItems:function(){if(this.get("geocoderMenu")&&this._geocoders&&1<this._geocoders.length){var a,c="",e;a='\x3cul role\x3d"presentation"\x3e';for(e=0;e<this._geocoders.length;e++){c=this._css.resultsItemClass+" ";c=0===e%2?c+this._css.resultsItemOddClass:c+this._css.resultsItemEvenClass;e===this.get("activeGeocoderIndex")&&(c+=" "+this._css.geocoderSelectedClass);0===e?c+=" "+this._css.resultsItemFirstClass:
e===this._geocoders.length-1&&(c+=" "+this._css.resultsItemLastClass);var f=this._geocoders[e].name||q.widgets.Geocoder.main.untitledGeocoder;a+='\x3cli data-index\x3d"'+e+'" data-item\x3d"true" role\x3d"menuitem" tabindex\x3d"0" class\x3d"'+c+'"\x3e';a+='\x3cdiv class\x3d"'+this._css.geocoderSelectedCheckClass+'"\x3e\x3c/div\x3e';a+=f;a+='\x3cdiv class\x3d"'+this._css.GeocoderClearClass+'"\x3e\x3c/div\x3e';a+="\x3c/li\x3e"}this.geocoderMenuInsertNode.innerHTML=a+"\x3c/ul\x3e";this._geocoderMenuEvent();
b.set(this.geocoderMenuNode,"display","none");b.set(this.geocoderMenuArrowNode,"display","block");d.add(this.containerNode,this._css.GeocoderMultipleClass)}else this.geocoderMenuInsertNode.innerHTML="",b.set(this.geocoderMenuNode,"display","none"),b.set(this.geocoderMenuArrowNode,"display","none"),d.remove(this.containerNode,this._css.GeocoderMultipleClass)},_checkStatus:function(){this.get("value")?(d.add(this.containerNode,this._css.hasValueClass),f.set(this.clearNode,"title",q.widgets.Geocoder.main.clearButtonTitle)):
this.clear()},_autoCompleteEvent:function(){var a=p('[data-item\x3d"true"]',this.resultsNode);this._acEvent&&this._acEvent.remove();this._acEvent=m(a,"click, keydown",h.hitch(this,function(b){this._clearQueryTimeout();var d=parseInt(f.get(b.currentTarget,"data-index"),10),c=f.get(b.currentTarget,"data-text");"click"===b.type||"keydown"===b.type&&b.keyCode===k.ENTER?(f.set(this.inputNode,"value",c),this.set("value",c),this.get("results")&&this.get("results")[d]&&(b=this.get("results")[d],b.name?this.select(b):
this._query({delay:0,search:b.text,magicKey:b.magicKey||null}).then(h.hitch(this,function(a){this.select(a.results[0])})))):"keydown"!==b.type||b.keyCode!==k.BACKSPACE&&b.keyCode!==k.DELETE?"keydown"===b.type&&b.keyCode===k.UP_ARROW?(e.stop(b),b=d-1,0>b?this.inputNode.focus():a[b].focus()):"keydown"===b.type&&b.keyCode===k.DOWN_ARROW?(e.stop(b),b=d+1,b>=a.length?this.inputNode.focus():a[b].focus()):b.keyCode===k.ESCAPE&&this._hideMenus():(e.stop(b),this.inputNode.focus(),b=this.inputNode.value.slice(0,
-1),f.set(this.inputNode,"value",b),this.set("value",b))}))},_geocoderMenuEvent:function(){var a=p('[data-item\x3d"true"]',this.geocoderMenuInsertNode);this._gmEvent&&this._gmEvent.remove();this._gmEvent=m(a,"click, keydown",h.hitch(this,function(b){var d=parseInt(f.get(b.currentTarget,"data-index"),10);"click"===b.type||"keydown"===b.type&&b.keyCode===k.ENTER?(this._setActiveGeocoderIndex(null,null,d),this._hideGeolocatorMenu()):"keydown"===b.type&&b.keyCode===k.UP_ARROW?(e.stop(b),b=d-1,0>b?this.geocoderMenuArrowNode.focus():
a[b].focus()):"keydown"===b.type&&b.keyCode===k.DOWN_ARROW?(e.stop(b),b=d+1,b>=a.length?this.geocoderMenuArrowNode.focus():a[b].focus()):b.keyCode===k.ESCAPE&&this._hideGeolocatorMenu()}))},_removeEvents:function(){var a;if(this._events&&this._events.length)for(a=0;a<this._events.length;a++)this._events[a].remove();this._acEvent&&this._acEvent.remove();this._gmEvent&&this._gmEvent.remove();this._events=[]},_setupEvents:function(){this._removeEvents();var a=m(document,"click",h.hitch(this,function(a){this._hideResultsMenu(a)}));
this._events.push(a);a=m(this.inputNode,"keyup",h.hitch(this,function(a){this._inputKeyUp(a)}));this._events.push(a);a=m(this.inputNode,"keydown",h.hitch(this,function(a){this._inputKeyDown(a)}));this._events.push(a);a=m(this.geocoderMenuArrowNode,"keydown",this._geocoderMenuButtonKeyDown());this._events.push(a);this.get("map")&&(a=m(this.get("map"),"mouse-down",h.hitch(this,function(){this.blur()})),this._events.push(a));this._geocoderMenuEvent();this._autoCompleteEvent()},_findThenSelect:function(){this.find().then(h.hitch(this,
function(a){a.results&&a.results.length&&(this.select(a.results[0]),this.onEnterKeySelect())}))},_inputKeyUp:function(a){if(a){this._clearQueryTimeout();var b=this.inputNode.value;this._ignoreUpdateValue=!0;this.set("value",b);this._ignoreUpdateValue=!1;var d=0;b&&(d=b.length);if(a.ctrlKey||a.metaKey||a.altKey||a.keyCode===k.copyKey||a.keyCode===k.ALT||a.keyCode===k.CTRL||a.keyCode===k.META||a.keyCode===k.SHIFT||a.keyCode===k.UP_ARROW||a.keyCode===k.DOWN_ARROW||a.keyCode===k.LEFT_ARROW||a.keyCode===
k.RIGHT_ARROW)return a;a&&a.keyCode===k.ENTER?(this._cancelDeferreds(),this._findThenSelect()):a&&a.keyCode===k.ESCAPE?(this._cancelDeferreds(),this._hideMenus()):a&&a.keyCode===k.TAB?(this._cancelDeferreds(),this._hideMenus()):this.get("autoComplete")&&d>=this.get("minCharacters")?this._autoComplete():this._hideMenus();this._checkStatus()}},_cancelDeferreds:function(){if(this._deferreds.length){for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel("Geocoder:: stop query");this._deferreds=
[]}},_inputKeyDown:function(a){var b=p('[data-item\x3d"true"]',this.resultsNode);a&&a.keyCode===k.TAB?(this._cancelDeferreds(),this._hideMenus()):a&&a.keyCode===k.UP_ARROW?(e.stop(a),(a=b.length)&&b[a-1].focus()):a&&a.keyCode===k.DOWN_ARROW&&(e.stop(a),b[0]&&b[0].focus())},_geocoderMenuButtonKeyDown:function(a){var b=p('[data-item\x3d"true"]',this.geocoderMenuInsertNode);a&&a.keyCode===k.UP_ARROW?(e.stop(a),this._showGeolocatorMenu(),(a=b.length)&&b[a-1].focus()):a&&a.keyCode===k.DOWN_ARROW&&(e.stop(a),
this._showGeolocatorMenu(),b[0]&&b[0].focus())},_inputClick:function(){this._hideGeolocatorMenu()},_hydrateResult:function(a){var b={},d=this._defaultSR,c;this.get("map")&&(d=this.get("map").spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("feature"))b.feature=new z(a.feature),(c=b.feature.geometry)&&c.setSpatialReference(d);else if(a.hasOwnProperty("geometry")){var e=a.symbol||null;c=a.attributes||{};b.feature=new z(a.geometry,e,c,a.infoTemplate||
null);(c=b.feature.geometry)&&c.setSpatialReference(d)}else a.hasOwnProperty("location")?(e=new E(a.location.x,a.location.y,d),c={},a.hasOwnProperty("attributes")&&(c=a.attributes),a.hasOwnProperty("score")&&(c.score=a.score),b.feature=new z(e,null,c,null)):b.feature=null;if(a.hasOwnProperty("extent"))b.extent=new N(a.extent),b.extent.setSpatialReference(new B(d));else if(b.feature&&b.feature.geometry)switch(b.feature.geometry.type){case "extent":b.extent=b.feature.geometry;break;case "multipoint":b.extent=
b.feature.geometry.getExtent();break;case "polygon":b.extent=b.feature.geometry.getExtent();break;case "polyline":b.extent=b.feature.geometry.getExtent();break;case "point":this.get("map")?this.get("map").getScale()>this.get("zoomScale")?b.extent=J.getExtentForScale(this.get("map"),this.get("zoomScale")).centerAt(b.feature.geometry):b.extent=this.get("map").extent.centerAt(b.feature.geometry):b.extent=new N({xmin:b.feature.geometry.x-.25,ymin:b.feature.geometry.y-.25,xmax:b.feature.geometry.x+.25,
ymax:b.feature.geometry.y+.25,spatialReference:{wkid:4326}})}else b.extent=null;a.hasOwnProperty("name")?b.name=a.name:"query"===this.activeGeocoder.type&&this.activeGeocoder.field&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(this.activeGeocoder.field)?b.name=a.attributes[this.activeGeocoder.field]:a.hasOwnProperty("Match_addr")&&"string"===typeof a.Match_addr?b.name=a.Match_addr:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Match_addr")?b.name=
a.address.Match_addr:a.hasOwnProperty("address")&&"string"===typeof a.address?b.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?b.name=a.address.Address:b.name=b.feature&&b.feature.geometry?b.feature.geometry.x+","+b.feature.geometry.y:"";return b},_hydrateResults:function(a){var b=[],d=0;if(a&&a.length)for(d;d<a.length;d++){var c=this._hydrateResult(a[d]);b.push(c)}return b}});h.setObject("dijit.Geocoder",l,C);return l})},"dojox/lang/functional":function(){define(["./functional/lambda",
"./functional/array","./functional/object"],function(c){return c})},"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(c,l,h){var a=l.getObject("lang.functional",!0,c),e={},f=1<"ab".split(/a*/).length?String.prototype.split:function(a){var b=this.split.call(this,a);(a=a.exec(this))&&0==a.index&&b.unshift("");return b},d=function(a){var b=[],d=f.call(a,/\s*->\s*/m);if(1<d.length)for(;d.length;)a=d.pop(),b=d.pop().split(/\s*,\s*|\s+/m),d.length&&
d.push("(function("+b.join(", ")+"){ return ("+a+"); })");else if(a.match(/\b_\b/))b=["_"];else{var d=a.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),c=a.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(d||c)d&&(b.push("$1"),a="$1"+a),c&&(b.push("$2"),a+="$2");else{var d=a.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[],e={};h.forEach(d,function(a){e.hasOwnProperty(a)||(b.push(a),e[a]=1)})}}return{args:b,body:a}},b=function(b){return b.length?function(){var d=b.length-1,c=a.lambda(b[d]).apply(this,arguments);for(--d;0<=d;--d)c=a.lambda(b[d]).call(this,c);return c}:function(a){return a}};l.mixin(a,{rawLambda:function(a){return d(a)},buildLambda:function(a){a=d(a);return"function("+a.args.join(",")+"){return ("+a.body+");}"},lambda:function(a){if("function"==typeof a)return a;
if(a instanceof Array)return b(a);if(e.hasOwnProperty(a))return e[a];var c=d(a);return e[a]=new Function(c.args,"return ("+c.body+");")},clearLambdaCache:function(){e={}}});return a})},"dojox/lang/functional/array":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","./lambda"],function(c,l,h,a){var e={};l.mixin(a,{filter:function(f,d,b){"string"==typeof f&&(f=f.split(""));b=b||c.global;d=a.lambda(d);var g=[],k,m,p;if(l.isArray(f))for(m=0,p=f.length;m<p;++m)k=f[m],d.call(b,
k,m,f)&&g.push(k);else if("function"==typeof f.hasNext&&"function"==typeof f.next)for(m=0;f.hasNext();)k=f.next(),d.call(b,k,m++,f)&&g.push(k);else for(m in f)m in e||(k=f[m],d.call(b,k,m,f)&&g.push(k));return g},forEach:function(f,d,b){"string"==typeof f&&(f=f.split(""));b=b||c.global;d=a.lambda(d);var g,k;if(l.isArray(f))for(g=0,k=f.length;g<k;d.call(b,f[g],g,f),++g);else if("function"==typeof f.hasNext&&"function"==typeof f.next)for(g=0;f.hasNext();d.call(b,f.next(),g++,f));else for(g in f)g in
e||d.call(b,f[g],g,f);return b},map:function(f,d,b){"string"==typeof f&&(f=f.split(""));b=b||c.global;d=a.lambda(d);var g,k,m;if(l.isArray(f))for(g=Array(k=f.length),m=0;m<k;g[m]=d.call(b,f[m],m,f),++m);else if("function"==typeof f.hasNext&&"function"==typeof f.next)for(g=[],m=0;f.hasNext();g.push(d.call(b,f.next(),m++,f)));else for(m in g=[],f)m in e||g.push(d.call(b,f[m],m,f));return g},every:function(f,d,b){"string"==typeof f&&(f=f.split(""));b=b||c.global;d=a.lambda(d);var g,k;if(l.isArray(f))for(g=
0,k=f.length;g<k;++g){if(!d.call(b,f[g],g,f))return!1}else if("function"==typeof f.hasNext&&"function"==typeof f.next)for(g=0;f.hasNext();){if(!d.call(b,f.next(),g++,f))return!1}else for(g in f)if(!(g in e||d.call(b,f[g],g,f)))return!1;return!0},some:function(f,d,b){"string"==typeof f&&(f=f.split(""));b=b||c.global;d=a.lambda(d);var g,k;if(l.isArray(f))for(g=0,k=f.length;g<k;++g){if(d.call(b,f[g],g,f))return!0}else if("function"==typeof f.hasNext&&"function"==typeof f.next)for(g=0;f.hasNext();){if(d.call(b,
f.next(),g++,f))return!0}else for(g in f)if(!(g in e)&&d.call(b,f[g],g,f))return!0;return!1}});return a})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(c,l,h){var a={};l.mixin(h,{keys:function(c){var e=[],d;for(d in c)d in a||e.push(d);return e},values:function(c){var e=[],d;for(d in c)d in a||e.push(c[d]);return e},filterIn:function(e,f,d){d=d||c.global;f=h.lambda(f);var b={},g,k;for(k in e)k in a||(g=e[k],f.call(d,g,k,e)&&(b[k]=g));
return b},forIn:function(e,f,d){d=d||c.global;f=h.lambda(f);for(var b in e)b in a||f.call(d,e[b],b,e);return d},mapIn:function(e,f,d){d=d||c.global;f=h.lambda(f);var b={},g;for(g in e)g in a||(b[g]=f.call(d,e[g],g,e));return b}});return h})},"dojox/charting/axis2d/common":function(){define(["dojo/_base/lang","dojo/_base/window","dojo/dom-geometry","dojox/gfx","dojo/has"],function(c,l,h,a,e){var f=c.getObject("dojox.charting.axis2d.common",!0),d=function(a){a.marginLeft="0px";a.marginTop="0px";a.marginRight=
"0px";a.marginBottom="0px";a.paddingLeft="0px";a.paddingTop="0px";a.paddingRight="0px";a.paddingBottom="0px";a.borderLeftWidth="0px";a.borderTopWidth="0px";a.borderRightWidth="0px";a.borderBottomWidth="0px"};return c.mixin(f,{createText:{gfx:function(a,d,c,e,f,q,n,r){return d.createText({x:c,y:e,text:q,align:f}).setFont(n).setFill(r)},html:function(b,c,f,m,p,q,n,r,v){c=l.doc.createElement("div");var g=c.style,k;b.getTextDir&&(c.dir=b.getTextDir(q));d(g);g.font=n;c.innerHTML=String(q).replace(/\s/g,
"\x26nbsp;");g.color=r;g.position="absolute";g.left="-10000px";l.body().appendChild(c);var t=a.normalizedLength(a.splitFontString(n).size);v||(c.getBoundingClientRect?(k=c.getBoundingClientRect(),k=k.width||k.right-k.left):k=h.getMarginBox(c).w);"rtl"==c.dir&&(f+=v?v:k);l.body().removeChild(c);g.position="relative";if(v)switch(g.width=v+"px",p){case "middle":g.textAlign="center";g.left=f-v/2+"px";break;case "end":g.textAlign="right";g.left=f-v+"px";break;default:g.left=f+"px",g.textAlign="left"}else switch(p){case "middle":g.left=
Math.floor(f-k/2)+"px";break;case "end":g.left=Math.floor(f-k)+"px";break;default:g.left=Math.floor(f)+"px"}g.top=Math.floor(m-t)+"px";g.whiteSpace="nowrap";v=l.doc.createElement("div");g=v.style;d(g);g.width="0px";g.height="0px";v.appendChild(c);b.node.insertBefore(v,b.node.firstChild);e("dojo-bidi")&&b.htmlElementsRegistry.push([v,f,m,p,q,n,r]);return v}}})})},"esri/tasks/RouteTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p){c=c([g,p],{declaredClass:"esri.tasks.RouteTask",_eventMap:{"solve-complete":["result"]},constructor:function(a){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=l.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(a,b,d,c,e){try{var g=[],n=[],p=a.directions||[],q=a.routes?a.routes.features:
[],r=a.stops?a.stops.features:[],v=a.barriers?a.barriers.features:[],u=a.polygonBarriers?a.polygonBarriers.features:[],l=a.polylineBarriers?a.polylineBarriers.features:[],A=a.messages,E=h.forEach,N=h.indexOf,O=!0,K,H,J=a.routes&&a.routes.spatialReference||a.stops&&a.stops.spatialReference||a.barriers&&a.barriers.spatialReference||a.polygonBarriers&&a.polygonBarriers.spatialReference||a.polylineBarriers&&a.polylineBarriers.spatialReference;this._chk=a.checksum;E(p,function(a){g.push(K=a.routeName);
n[K]={directions:a}});E(q,function(a){-1===N(g,K=a.attributes.Name)&&(g.push(K),n[K]={});n[K].route=a});E(r,function(a){H=a.attributes;-1===N(g,K=H.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME")&&(g.push(K),n[K]={});"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==K&&(O=!1);void 0===n[K].stops&&(n[K].stops=[]);n[K].stops.push(a)});0<r.length&&!0===O&&(n[g[0]].stops=n["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete n["esri.tasks.RouteTask.NULL_ROUTE_NAME"],g.splice(h.indexOf(g,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),
1));var L=[];E(g,function(a,b){n[a].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===a?null:a;n[a].spatialReference=J;L.push(new k(n[a]))});a=function(a){E(a,function(b,d){b.geometry&&(b.geometry.spatialReference=J);a[d]=new f(b)});return a};E(A,function(a,b){A[b]=new m(a)});var R={routeResults:L,barriers:a(v),polygonBarriers:a(u),polylineBarriers:a(l),messages:A};this._successHandler([R],"onSolveComplete",d,e)}catch(M){this._errorHandler(M,c,e)}},solve:function(a,b,c,e){var f=e.assembly;a=this._encode(l.mixin({},
this._url.query,{f:"json"},a.toJson(f&&f[0]),this._chk?{checksum:this._chk}:{}));var g=this._handler,k=this._errorHandler;return d({url:this._url.path,timeout:25E4,content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,e.dfd)},error:function(a){k(a,c,e.dfd)}})},onSolveComplete:function(){}});b._createWrappers(c);l.setObject("tasks.RouteTask",c,e);return c})},"esri/tasks/RouteResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ./DirectionsFeatureSet".split(" "),
function(c,l,h,a,e,f,d){c=c(null,{declaredClass:"esri.tasks.RouteResult",constructor:function(a){var b=a.spatialReference,c=a.route;if(a.directions){var e=[],p=[],q=[];h.forEach(a.directions.features,function(a,b){p[b]=a.compressedGeometry;e[b]=a.strings;q[b]=a.events});a.directions.strings=e;a.directions.events=q;this.directions=new d(a.directions,p)}this.routeName=a.routeName;c&&(c.geometry&&(c.geometry.spatialReference=b),this.route=new f(c));if(a.stops){var n=this.stops=[];h.forEach(a.stops,function(a,
d){a.geometry&&(a.geometry.spatialReference=b);n[a.attributes.Sequence-1]=new f(a)})}},routeName:null,directions:null,route:null,stops:null});l.setObject("tasks.RouteResult",c,e);return c})},"esri/tasks/DirectionsFeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json ../kernel ../geometry/Extent ../geometry/Polyline ../geometry/Point ../graphic ./FeatureSet".split(" "),function(c,l,h,a,e,f,d,b,g,k,m){c=c(m,{declaredClass:"esri.tasks.DirectionsFeatureSet",
constructor:function(a,b){this.routeId=a.routeId;this.routeName=a.routeName;l.mixin(this,a.summary);this.extent=new d(this.envelope);var c=this._fromCompressedGeometry,f=this.features,m=this.extent.spatialReference,p=[];h.forEach(b,function(a,b){f[b].setGeometry(p[b]=a?c(a,m):f[b].geometry)});this.mergedGeometry=this._mergePolylinesToSinglePath(p,m);this.geometryType="esriGeometryPolyline";h.forEach(a.events,function(b,d){h.forEach(b,function(a,d){b[d]=new k(new g(a.point.x,a.point.y,m),null,{ETA:a.ETA,
strings:e.stringify(a.strings),arriveTimeUTC:a.arriveTimeUTC})});a.events[d]=b});delete this.envelope},_fromCompressedGeometry:function(a,d){var c=0,e=0,f=0,g=0,k=[],m,p,q,l,B,z=0,F=0,A=0;(a=a.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(a=[]);0===parseInt(a[z],32)?(z=2,m=parseInt(a[z],32),z++,q=parseInt(a[z],32),z++,m&1&&(F=h.indexOf(a,"|")+1,l=parseInt(a[F],32),F++),m&2&&(A=h.indexOf(a,"|",F)+1,B=parseInt(a[A],32),A++)):(q=parseInt(a[z],32),z++);for(;z<a.length&&"|"!==a[z];)m=parseInt(a[z],32)+c,z++,c=m,
p=parseInt(a[z],32)+e,z++,e=p,m=[m/q,p/q],F&&(p=parseInt(a[F],32)+f,F++,f=p,m.push(p/l)),A&&(p=parseInt(a[A],32)+g,A++,g=p,m.push(p/B)),k.push(m);c=new b({paths:[k],hasZ:0<F,hasM:0<A});c.setSpatialReference(d);return c},_mergePolylinesToSinglePath:function(a,d){var c=[],e=!1;h.forEach(a,function(a){h.forEach(a.paths,function(b){e=e||a.hasM;c=c.concat(b)})});var f=[],g=[0,0];h.forEach(c,function(a){if(a[0]!==g[0]||a[1]!==g[1])f.push(a),g=a});return new b({paths:[f],spatialReference:d,hasM:e})}});l.setObject("tasks.DirectionsFeatureSet",
c,f);return c})},"esri/tasks/NAMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,h,a){c=c(null,{declaredClass:"esri.tasks.NAMessage",constructor:function(a){l.mixin(this,a)}});l.mixin(c,{TYPE_INFORMATIVE:0,TYPE_PROCESS_DEFINITION:1,TYPE_PROCESS_START:2,TYPE_PROCESS_STOP:3,TYPE_WARNING:50,TYPE_ERROR:100,TYPE_EMPTY:101,TYPE_ABORT:200});l.setObject("tasks.NAMessage",c,a);return c})},"esri/tasks/NAServiceDescription":function(){define(["dojo/_base/declare",
"dojo/json","dojo/Deferred","dojo/_base/lang","../request"],function(c,l,h,a,e){return c(null,{declaredClass:"esri.tasks._NAServiceDescription",_sd:null,getServiceDescription:function(c,d){var b=new h;if(this._sd)b.resolve(this._sd);else if(this._url&&this._url.orig){var f=this._url.orig,k=(this._url.path.match(/\/solve$/)||[]).length?"Route":(this._url.path.match(/\/solveClosestFacility$/)||[]).length?"ClosestFacility":"ServiceAreas",m,p=function(a){e({url:a+("/"===a[a.length-1]?"":"/")+"GetTravelModes/execute",
content:{f:"json",serviceName:k},callbackParamName:"callback"}).then(function(a){var d=[],c=null;if(a&&a.results&&a.results.length)for(var e=0;e<a.results.length;e++)if("supportedTravelModes"===a.results[e].paramName){if(a.results[e].value&&a.results[e].value.features)for(var f=0;f<a.results[e].value.features.length;f++)if(a.results[e].value.features[f].attributes){var g=l.parse(a.results[e].value.features[f].attributes.TravelMode);d.push(g)}}else"defaultTravelMode"===a.results[e].paramName&&(c=a.results[e].value);
m.supportedTravelModes=d;m.defaultTravelMode=c;b.resolve(m)},function(a){b.reject(a)})};e({url:f,content:{f:"json"},callbackParamName:"callback"}).then(function(a){m=a;m.supportedTravelModes||(m.supportedTravelModes=[]);for(a=0;a<m.supportedTravelModes.length;a++)m.supportedTravelModes[a].id||(m.supportedTravelModes[a].id=m.supportedTravelModes[a].itemId);d?b.resolve(m):c?p(c):10.4<=m.currentVersion?e({url:f+("/"===f[f.length-1]?"":"/")+"retrieveTravelModes",content:{f:"json"},callbackParamName:"callback"}).then(function(a){m.supportedTravelModes=
a.supportedTravelModes;m.defaultTravelMode=a.defaultTravelMode;b.resolve(m)},function(a){b.reject(a)}):e({url:f.substring(0,f.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a.owningSystemUrl?(f=a.owningSystemUrl,e({url:f+("/"===f[f.length-1]?"":"/")+"sharing/rest/portals/self",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a&&a.helperServices&&a.helperServices.routingUtilities&&a.helperServices.routingUtilities.url?p(a.helperServices.routingUtilities.url):
b.resolve(m)},function(a){b.reject(a)})):b.resolve(m)},function(a){b.reject(a)})},function(a){b.reject(a)})}else b.reject("NA Task has no URL specified.");b.then(a.hitch(this,function(a){this._sd=a}),a.hitch(this,function(){this._sd=null}));return b.promise},getOwningSystemUrl:function(){var a=new h;if(this._url&&this._url.orig){var d=this._url.orig;e({url:d.substring(0,d.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).promise.always(function(b){a.resolve(b.owningSystemUrl)})}else a.resolve(void 0);
return a.promise}})})},"esri/tasks/RouteParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../graphicsUtils ./NATypes".split(" "),function(c,l,h,a,e,f,d,b){c=c(null,{declaredClass:"esri.tasks.RouteParameters",accumulateAttributes:null,attributeParameterValues:null,barriers:null,directionsLanguage:null,directionsLengthUnits:null,directionsOutputType:null,directionsStyleName:null,directionsTimeAttribute:null,doNotLocateOnRestrictedElements:!0,
findBestSequence:null,ignoreInvalidLocations:null,impedanceAttribute:null,outputLines:"esriNAOutputLineTrueShape",outputGeometryPrecision:null,outputGeometryPrecisionUnits:null,outSpatialReference:null,overrides:null,polygonBarriers:null,polylineBarriers:null,preserveFirstStop:null,preserveLastStop:null,restrictionAttributes:null,restrictUTurns:null,returnBarriers:!1,returnDirections:!1,returnPolygonBarriers:!1,returnPolylineBarriers:!1,returnRoutes:!0,returnStops:!1,returnZ:!0,startTime:null,startTimeIsUTC:null,
timeWindowsAreUTC:null,stops:null,useHierarchy:null,useTimeWindows:null,travelMode:null,toJson:function(a){var c={returnDirections:this.returnDirections,returnRoutes:this.returnRoutes,returnZ:this.returnZ,returnStops:this.returnStops,returnBarriers:this.returnBarriers,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,attributeParameterValues:this.attributeParameterValues&&h.toJson(this.attributeParameterValues),outSR:this.outSpatialReference?this.outSpatialReference.wkid||
h.toJson(this.outSpatialReference.toJson()):null,outputLines:this.outputLines,overrides:this.overrides,findBestSequence:this.findBestSequence,preserveFirstStop:this.preserveFirstStop,preserveLastStop:this.preserveLastStop,useTimeWindows:this.useTimeWindows,startTime:this.startTime?this.startTime.getTime():null,startTimeIsUTC:this.startTimeIsUTC,timeWindowsAreUTC:this.timeWindowsAreUTC,accumulateAttributeNames:this.accumulateAttributes?this.accumulateAttributes.join(","):null,ignoreInvalidLocations:this.ignoreInvalidLocations,
impedanceAttributeName:this.impedanceAttribute,restrictionAttributeNames:this.restrictionAttributes?this.restrictionAttributes.join(","):null,restrictUTurns:this.restrictUTurns,useHierarchy:this.useHierarchy,directionsLanguage:this.directionsLanguage,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,directionsLengthUnits:b.LengthUnit[this.directionsLengthUnits],directionsTimeAttributeName:this.directionsTimeAttribute,directionsStyleName:this.directionsStyleName,
travelMode:"object"===typeof this.travelMode?h.toJson(this.travelMode):this.travelMode},e=this.stops;"esri.tasks.FeatureSet"===e.declaredClass&&0<e.features.length?c.stops=h.toJson({type:"features",features:d._encodeGraphics(e.features,a&&a["stops.features"]),doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}):"esri.tasks.DataLayer"===e.declaredClass?c.stops=e:"esri.tasks.DataFile"===e.declaredClass&&(c.stops=h.toJson({type:"features",url:e.url,doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}));
if(this.directionsOutputType)switch(this.directionsOutputType.toLowerCase()){case "complete":c.directionsOutputType="esriDOTComplete";break;case "complete-no-events":c.directionsOutputType="esriDOTCompleteNoEvents";break;case "instructions-only":c.directionsOutputType="esriDOTInstructionsOnly";break;case "standard":c.directionsOutputType="esriDOTStandard";break;case "summary-only":c.directionsOutputType="esriDOTSummaryOnly";break;default:c.directionsOutputType=this.directionsOutputType}e=function(b,
c){return b?"esri.tasks.FeatureSet"===b.declaredClass?0<b.features.length?h.toJson({type:"features",features:d._encodeGraphics(b.features,a&&a[c])}):null:"esri.tasks.DataLayer"===b.declaredClass?b:"esri.tasks.DataFile"===b.declaredClass?h.toJson({type:"features",url:b.url}):h.toJson(b):null};this.barriers&&(c.barriers=e(this.barriers,"barriers.features"));this.polygonBarriers&&(c.polygonBarriers=e(this.polygonBarriers,"polygonBarriers.features"));this.polylineBarriers&&(c.polylineBarriers=e(this.polylineBarriers,
"polylineBarriers.features"));return f.filter(c,function(a){if(null!==a)return!0})}});l.setObject("tasks.RouteParameters",c,e);return c})},"esri/tasks/NATypes":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(c,l,h){l={esriFeet:"esriNAUFeet",esriKilometers:"esriNAUKilometers",esriMeters:"esriNAUMeters",esriMiles:"esriNAUMiles",esriNauticalMiles:"esriNAUNauticalMiles",esriYards:"esriNAUYards"};var a={NONE:"esriNAOutputLineNone",STRAIGHT:"esriNAOutputLineStraight",TRUE_SHAPE:"esriNAOutputLineTrueShape",
TRUE_SHAPE_WITH_MEASURE:"esriNAOutputLineTrueShapeWithMeasure"},e={ALLOW_BACKTRACK:"esriNFSBAllowBacktrack",AT_DEAD_ENDS_ONLY:"esriNFSBAtDeadEndsOnly",NO_BACKTRACK:"esriNFSBNoBacktrack",AT_DEAD_ENDS_AND_INTERSECTIONS:"esriNFSBAtDeadEndsAndIntersections"},f={NONE:"esriNAOutputPolygonNone",SIMPLIFIED:"esriNAOutputPolygonSimplified",DETAILED:"esriNAOutputPolygonDetailed"},d={FROM_FACILITY:"esriNATravelDirectionFromFacility",TO_FACILITY:"esriNATravelDirectionToFacility"},b={LengthUnit:l,OutputLine:a,
UTurn:e,OutputPolygon:f,TravelDirection:d};c.setObject("tasks._NALengthUnit",l,h);c.setObject("tasks.NAOutputLine",a,h);c.setObject("tasks.NAUTurn",e,h);c.setObject("tasks.NAOutputPolygon",f,h);c.setObject("tasks.NATravelDirection",d,h);return b})},"esri/layers/wmts":function(){define(["./agscommon","./tiled","./WMTSLayer"],function(){return{}})},"esri/layers/tiled":function(){define(["./TiledMapServiceLayer","./TileInfo","./LOD","../geometry","../utils"],function(){return{}})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../urlUtils ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w){l=l([v],{declaredClass:"esri.layers.WMTSLayer",copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(a,b){this.version="1.0.0";this.tileUr=this._url=a;this.serviceMode="RESTful";this._parseCapabilities=h.hitch(this,this._parseCapabilities);this._getCapabilitiesError=h.hitch(this,this._getCapabilitiesError);b||(b={});if(b.serviceMode)if("KVP"===b.serviceMode||"RESTful"===b.serviceMode)this.serviceMode=b.serviceMode;
else return;this.customParameters=b.customParameters;this.customLayerParameters=b.customLayerParameters;this.layerInfo=new w;b.layerInfo&&(this.layerInfo=b.layerInfo,this._identifier=b.layerInfo.identifier,this._tileMatrixSetId=b.layerInfo.tileMatrixSet,b.layerInfo.format&&(this.format="image/"+b.layerInfo.format),this._style=b.layerInfo.style,this.title=b.layerInfo.title,this._dimension=b.layerInfo.dimension,this._dimension2=b.layerInfo.dimension2);b.resourceInfo?(this.version=b.resourceInfo.version,
b.resourceInfo.getTileUrl&&(this._url=this.tileUrl=b.resourceInfo.getTileUrl),this.copyright=b.resourceInfo.copyright,this.layerInfos=b.resourceInfo.layerInfos,this.customParameters=b.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=b.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities();this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png",
"image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""}},setActiveLayer:function(a){this.setVisibleLayer(a)},setVisibleLayer:function(a){this._setActiveLayer(a);this.refresh(!0)},setCustomParameters:function(a,b){this.customParameters=a;this.customLayerParameters=b;this.refresh(!0)},getTileUrl:function(a,b,d){a=this._levelToLevelValue[a];a=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[b%
this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,a).replace(/\{TileRow\}/gi,b).replace(/\{TileCol\}/gi,d).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,a).replace(/\{row\}/gi,b).replace(/\{col\}/gi,d);a=this._appendCustomLayerParameters(a);a=this.addTimestampToURL(a);return k.addProxy(a)},getTileUrlTemplate:function(b){var d=
b.identifier,c=b.tileMatrixSet,e=b.format,f=b.style,g=b.dimension,k=b.dimension2;d?b=a.filter(this.layers,function(a){return a.identifier===d})[0]:(b=this.layers[0],d=this.layers[0].identifier);if(b){if(!e)e=b.formats[0];else if(!(-1===e.indexOf("image/")&&-1<a.indexOf(b.formats,e))&&(-1===e.indexOf("image/")&&(e="image/"+e),-1===a.indexOf(b.formats,e))){this.onError(Error("The layer doesn't support the format of "+e));return}if(!f)f=b.styles[0];else if(-1===a.indexOf(b.styles,f)){this.onError(Error("The layer doesn't support the style of "+
f));return}if(!g&&b.dimensions)g=b.dimensions[0];else if(-1===a.indexOf(b.dimensions,g)){this.onError(Error("The layer doesn't support the dimension of "+g));return}if(!k&&b.dimensions2)k=b.dimensions2[0];else if(-1===a.indexOf(b.dimensions2,k)){this.onError(Error("The layer doesn't support the dimension of "+k));return}var m;if(c){if(m=a.filter(b.tileMatrixSetInfos,function(a){return a.tileMatrixSet===c})[0],!m){this.onError(Error("The tileMatrixSetId "+c+" is not supported by the layer of "+d));
return}}else(m=a.filter(b.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===a.tileMatrixSet})[0])||(m=b.tileMatrixSetInfos[0]),c=m.tileMatrixSet;return this._getTileUrlTemplate(d,c,e,f,g,k)}this.onError(Error("couldn't find the layer "+d))},_getTileUrlTemplate:function(a,b,d,c,e,f){var g;a||(a=this._identifier);b||(b=this._tileMatrixSetId);d||(d=this.format);c||""===c||(c=this._style);if(this.resourceUrls&&0<this.resourceUrls.length)return g=this.resourceUrls[0].template,g.indexOf(".xxx")===
g.length-4&&(g=g.slice(0,g.length-4)),g=g.replace(/\{Style\}/gi,c),g=g.replace(/\{TileMatrixSet\}/gi,b),g=g.replace(/\{TileMatrix\}/gi,"{level}"),g=g.replace(/\{TileRow\}/gi,"{row}"),g=g.replace(/\{TileCol\}/gi,"{col}"),g=g.replace(/\{dimensionValue\}/gi,e),g=g.replace(/\{dimensionValue2\}/gi,f);"KVP"===this.serviceMode?g=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+a+"\x26STYLE\x3d"+c+"\x26FORMAT\x3d"+d+"\x26TILEMATRIXSET\x3d"+b+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":
"RESTful"===this.serviceMode&&(e="",this._formatDictionary[d.toLowerCase()]&&(e=this._formatDictionary[d.toLowerCase()]),g=this._url+a+"/"+c+"/"+b+"/{level}/{row}/{col}"+e);return g},_parseResourceInfo:function(){var b=this.layerInfos,d,c;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(c=0;c<b.length;c++)if(!(this._identifier&&b[c].identifier!==this._identifier||this.title&&b[c].title!==this.title||this._tileMatrixSetId&&b[c].tileMatrixSet!==this._tileMatrixSetId||this.format&&
"image/"+b[c].format!==this.format||this._style&&b[c].style!==this._style)){h.mixin(this,{description:b[c].description,tileInfo:b[c].tileInfo,spatialReference:b[c].tileInfo.spatialReference,fullExtent:b[c].fullExtent,initialExtent:b[c].initialExtent,_identifier:b[c].identifier,_tileMatrixSetId:b[c].tileMatrixSet,format:"image/"+b[c].format,_style:b[c].style});break}for(c=0;c<b.length;c++)d=b[c].tileInfo,96!==d.dpi&&(a.forEach(d.lods,function(a){a.scale=96*a.scale/d.dpi}),d.dpi=96),a.forEach(d.lods,
function(a){a.resolution=this._getResolution(d.spatialReference.wkid,90.71428571428571*a.scale/96,b[c].tileMatrixSet)},this);this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];a.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this)},_getCapabilities:function(){var a;"KVP"===this.serviceMode?a=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:
this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:"RESTful"===this.serviceMode&&(a=this._url+"/"+this.version+"/WMTSCapabilities.xml");a=this._appendCustomParameters(a);g({url:a,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(b){b=b.replace(/ows:/gi,"");b=f.parse(b);var d=c.query("Contents",b)[0];if(d){var e=c.query("OperationsMetadata",b)[0],g=c.query("[name\x3d'GetTile']",e)[0],e=this._url,g=c.query("Get",
g),k,m=!1,n,p;for(k=0;k<g.length;k++){var q=c.query("Constraint",g[k])[0];if(!q||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,q)){e=g[k].attributes[0].nodeValue;m=!0;break}else if(!q||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",q))n=g[k].attributes[0].nodeValue;else if(!q||this._getTagWithChildTagValue("AllowedValues","Value","KVP",q))p=g[k].attributes[0].nodeValue}m||("KVP"===this.serviceMode&&n?(e=n,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&
p&&(e=p,this.serviceMode="KVP"));-1===e.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(e+="/");"KVP"===this.serviceMode&&(e+=-1<e.indexOf("?")?"":"?");this._url=e;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",b)[0];n=c.query("Layer",d);var r,t=[];this.layers=[];a.forEach(n,function(a){r=this._getTagValues("Identifier",a)[0];t.push(r);this.layers.push(this._getWMTSLayerInfo(r,a,d))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else this.onError(Error("The WMTS capabilities XML is not valid"))},
_setActiveLayer:function(b){b||(b={});b.identifier&&(this._identifier=b.identifier);b.tileMatrixSet&&(this._tileMatrixSetId=b.tileMatrixSet);b.format&&(this.format=b.format);b.style&&(this._style=b.style);b.dimension&&(this._dimension=b.dimension);b.dimension2&&(this._dimension2=b.dimension2);if(this.layers)if(this._identifier?b=a.filter(this.layers,function(a){return a.identifier===this._identifier},this)[0]:(b=this.layers[0],this._identifier=this.layers[0].identifier),b){if(this.format){if(-1===
this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===a.indexOf(b.formats,this.format)){this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=b.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(!this._style)this._style=b.styles[0];else if(-1===a.indexOf(b.styles,this._style)){this.onError(Error("The layer doesn't support the style of "+this._style));return}if(!this._dimension&&b.dimensions)this._dimension=
b.dimensions[0];else if(-1===a.indexOf(b.dimensions,this._dimension)){this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}if(!this._dimension2&&b.dimensions2)this._dimension2=b.dimensions2[0];else if(-1===a.indexOf(b.dimensions2,this._dimension2)){this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));return}var d;if(this._tileMatrixSetId){if(d=a.filter(b.tileMatrixSetInfos,function(a){return a.tileMatrixSet===this._tileMatrixSetId},
this)[0],!d){this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(d=a.filter(b.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===a.tileMatrixSet})[0])||(d=b.tileMatrixSetInfos[0]),this._tileMatrixSetId=d.tileMatrixSet;this.description=b.description;this.title=b.title;this.spatialReference=d.tileInfo.spatialReference;this.tileInfo=d.tileInfo;this._levelToLevelValue=[];a.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=
a.levelValue?a.levelValue:a.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=r.geographicToWebMercator(b.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=b.gcsExtent:(this.fullExtent=d.fullExtent,this.initialExtent=d.initialExtent);this.resourceUrls=b.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,
style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else this.onError(Error("couldn't find the layer "+this._identifier))},_getWMTSLayerInfo:function(b,d,e){var f=this._getTagValues("Abstract",d)[0],g=this._getTagValues("Title",d)[0],k=c.query("WGS84BoundingBox",d)[0],m=k?this._getTagValues("LowerCorner",k)[0].split(" "):["-180","-90"],q=k?this._getTagValues("UpperCorner",k)[0].split(" "):["180","90"],
k=parseFloat(m[0]),m=parseFloat(m[1]),r=parseFloat(q[0]),q=parseFloat(q[1]),k=new n(k,m,r,q,new p({wkid:4326})),q=this._getTagValues("Identifier",c.query("Style",d)[0]),t=this._getTagValues("Identifier",c.query("Dimension",d)[0]),h=this._getTagValues("Default",c.query("Dimension",d)[0])||this._getTagValues("Value",c.query("Dimension",d)[0]),v=1<c.query("Dimension",d).length?this._getTagValues("Identifier",c.query("Dimension",d)[1]):[],l=1<c.query("Dimension",d).length?this._getTagValues("Default",
c.query("Dimension",d)[1])||this._getTagValues("Value",c.query("Dimension",d)[1]):[],m=this._getTagValues("Format",d);e=this._getLayerMatrixInfos(d,e);b={identifier:b,tileMatrixSetInfos:e,formats:m,styles:q,title:g,description:f,gcsExtent:k,dimensions:h,dimensions2:l};d=c.query("ResourceURL",d);var u=[],w;a.forEach(d,function(a){w=a.getAttribute("template");if(t&&h&&t[0]&&h[0])if(-1<w.indexOf("{"+t+"}"))w=w.replace("{"+t+"}","{dimensionValue}");else{var b=w.toLowerCase().indexOf("{"+t[0].toLowerCase()+
"}");-1<b&&(w=w.substring(0,b)+"{dimensionValue}"+w.substring(b+t[0].length+2))}v&&l&&v[0]&&l[0]&&(-1<w.indexOf("{"+v+"}")?w=w.replace("{"+v+"}","{dimensionValue2}"):(b=w.toLowerCase().indexOf("{"+v[0].toLowerCase()+"}"),-1<b&&(w=w.substring(0,b)+"{dimensionValue2}"+w.substring(b+v[0].length+2))));u.push({template:w,format:a.getAttribute("format"),resourceType:a.getAttribute("resourceType")})});u&&0<u.length&&(b.resourceUrls=u);return b},_getLayerMatrixInfos:function(b,d){var c,e=[];this._allMatrixInfos||
(this._allMatrixInfos=[]);var f=this._getTagValues("TileMatrixSet",b);if(f&&0!==f.length)return a.forEach(f,function(a){var f;if(0<this._allMatrixInfos.length)for(c=0;c<this._allMatrixInfos.length;c++)if(this._allMatrixInfos[c].tileMatrixSet==a){f=this._allMatrixInfos[c];break}f||(f=this._getLayerMatrixInfo(a,b,d),this._allMatrixInfos.push(f));e.push(f)},this),e},_getLayerMatrixInfo:function(a,b,d){var e,f,g,k,m=[];b=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",a,b);var r=this._getTagValues("TileMatrix",
b),h=this._getTagWithChildTagValue("TileMatrixSet","Identifier",a,d),t=this._getTagValues("SupportedCRS",h)[0];e=parseInt(t.split(":").pop(),10);if(900913==e||3857==e)e=102100;if(-1<t.toLowerCase().indexOf("crs84")||-1<t.toLowerCase().indexOf("crs:84"))e=4326,k=!0;else if(-1<t.toLowerCase().indexOf("crs83")||-1<t.toLowerCase().indexOf("crs:83"))e=4269,k=!0;else if(-1<t.toLowerCase().indexOf("crs27")||-1<t.toLowerCase().indexOf("crs:27"))e=4267,k=!0;var v=new p({wkid:e}),l=c.query("TileMatrix",h)[0];
d=parseInt(this._getTagValues("TileWidth",l)[0],10);b=parseInt(this._getTagValues("TileHeight",l)[0],10);f=this._getTagValues("TopLeftCorner",l)[0].split(" ");var w=f[0],y=f[1];1<w.split("E").length&&(f=w.split("E"),w=f[0]*Math.pow(10,f[1]));1<y.split("E").length&&(f=y.split("E"),y=f[0]*Math.pow(10,f[1]));var w=parseFloat(w),y=parseFloat(y),C=k&&4326===e&&90===w&&-180===y;for(f=0;f<this._flippingAxisForWkids.length;f++)if(t.split(":").pop()>=this._flippingAxisForWkids[f][0]&&t.split(":").pop()<=this._flippingAxisForWkids[f][1]||
4326===e&&(!k||C)){4326===e&&90<w&&(w="90");g=new q(y,w,v);break}f===this._flippingAxisForWkids.length&&(g=new q(w,y,v));if(0===r.length)for(r=c.query("TileMatrix",h),f=0;f<r.length;f++)k=this._getLodFromTileMatrix(r[f],e,f,a),m.push(k);else for(f=0;f<r.length;f++)k=this._getTagWithChildTagValue("TileMatrix","Identifier",r[f],h),k=this._getLodFromTileMatrix(k,e,f,a),m.push(k);e=c.query("BoundingBox",h)[0];var M,Q;e&&(M=this._getTagValues("LowerCorner",e)[0].split(" "),Q=this._getTagValues("UpperCorner",
e)[0].split(" "));M&&1<M.length&&Q&&1<Q.length?(l=parseFloat(M[0]),e=parseFloat(M[1]),M=parseFloat(Q[0]),Q=parseFloat(Q[1])):(M=this._getTagValues("MatrixWidth",l)[0],e=this._getTagValues("MatrixHeight",l)[0],l=g.x,Q=g.y,M=l+M*b*m[0].resolution,e=Q-e*d*m[0].resolution);Q=M=new n(l,e,M,Q,v);g=new u({dpi:96,spatialReference:v,format:this.format,rows:d,cols:b,origin:g,lods:m});return{tileMatrixSet:a,fullExtent:Q,initialExtent:M,tileInfo:g}},_getCapabilitiesError:function(a){this.onError(a)},_getLodFromTileMatrix:function(a,
b,d,c){var e=this._getTagValues("Identifier",a)[0];a=this._getTagValues("ScaleDenominator",a)[0];1<a.split("E").length?(a=a.split("E"),a=a[0]*Math.pow(10,a[1])):a=parseFloat(a);b=this._getResolution(b,a,c);return{level:d,levelValue:e,scale:1.058267716535433*a,resolution:b}},_getResolution:function(a,d,c){a=b.isDefined(m[a])?m.values[m[a]]:"default028mm"===c?6370997*Math.PI/180:6378137*Math.PI/180;return 7*d/25E3/a},_getTag:function(a,b){return(a=c.query(a,b))&&0<a.length?a[0]:null},_getTagValues:function(b,
d){var f=[];b=b.split("\x3e");var g;g=c.query(b[0],d)[0];if(1<b.length){for(d=1;d<b.length-1;d++)g=c.query(b[d],g)[0];d=c.query(b[b.length-1],g)}else d=c.query(b[0],d);d&&0<d.length&&a.forEach(d,function(a){9>e("ie")?f.push(a.childNodes.length?a.childNodes[0].nodeValue:""):f.push(a.textContent)});return f},_getAttributeValues:function(b,d,e){b=c.query(b,e);var f=[];b&&0<b.length&&a.forEach(b,function(a){f.push(a.getAttribute(d))});return f},_getTagWithChildTagValue:function(a,d,f,g){g=g.childNodes;
var k,m;for(m=0;m<g.length;m++)if(-1<g[m].nodeName.indexOf(a)&&(9>e("ie")?b.isDefined(c.query(d,g[m])[0])&&(k=c.query(d,g[m])[0].childNodes[0].nodeValue):b.isDefined(c.query(d,g[m])[0])&&(k=c.query(d,g[m])[0].textContent),k===f||f.split(":")&&k===f.split(":")[1]))return g[m]},_appendCustomParameters:function(a){var b;if(this.customParameters)for(b in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(this.customParameters[b]);return a},_appendCustomLayerParameters:function(a){var b,
d;if(this.customLayerParameters||this.customParameters)for(b in d=h.clone(this.customParameters||{}),h.mixin(d,this.customLayerParameters||{}),d)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(d[b]);return a},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,
4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,
2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],
[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});h.setObject("layers.WMTSLayer",l,d);return l})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(c,l,h,a){c=c(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,
format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(a){a&&(this.title=a.title,this.tileMatrixSet=a.tileMatrixSet,this.format=a.format,this.style=a.style,this.tileInfo=a.tileInfo,this.fullExtent=a.fullExtent,this.initialExtent=a.initialExtent,this.identifier=a.identifier,this.description=a.description,this.dimension=a.dimension)}});l.setObject("layers.WMTSLayerInfo",c,a);return c})},"esri/dijit/Directions":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/_base/Color dijit/a11yclick dijit/_TemplatedMixin dijit/form/Select dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/TimeTextBox dojo/store/Memory dojo/data/ObjectStore dojo/keys dojo/has dojo/on dojo/mouse dojo/dom dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/dom-attr dojo/query dojo/number dojo/i18n!../nls/jsapi dojo/text!./templates/Directions.html ./Search dojo/dom-construct dojo/promise/all dojo/Deferred dojo/dnd/Source dojo/json ../kernel ../urlUtils ../graphic ../units ../TimeExtent ../InfoTemplate ../SpatialReference ../layers/ArcGISDynamicMapServiceLayer ../layers/GraphicsLayer ../geometry/webMercatorUtils ../geometry/geodesicUtils ../arcgis/utils ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/mathUtils ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/CartographicLineSymbol ../symbols/TextSymbol ../renderers/UniqueValueRenderer ../symbols/Font ./_EventedWidget ../tasks/FeatureSet ../tasks/RouteTask ../tasks/RouteParameters ../tasks/GeometryService ../tasks/DistanceParameters ../tasks/PrintTask ../tasks/PrintParameters ../tasks/PrintTemplate ../toolbars/edit ../toolbars/draw ../config ../tasks/ProjectParameters dojo/uacss".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca,V,aa,ba,ea,Y,ha,Z,ga,W,ia,da,ma,ka,ja,pa,la,qa,na,fa,P,ra,sa,ta,ua){var oa=M.getProtocolForWebResource();l=l("esri.dijit.Directions",[ma,b],{templateString:E,mapClickActive:!1,barrierToolActive:!1,_eventMap:{activate:!0,deactivate:!1,load:!0,"directions-start":!0,"directions-finish":["result"],"directions-clear":!0,"segment-select":["graphic"],"segment-highlight":["graphic"],error:["error"],"stops-update":["stops"],
"route-item-created":!0,"route-item-updated":!0,"feature-collection-created":!0},_emptyStop:{name:""},constructor:function(a,b){if(!a.map)throw Error('Required "map" parameter is missing. Cannot instantiate Directions Widget.');if(!b)throw Error('Required "srcNodeRef" parameter is missing. Cannot instantiate Directions Widget.');this._i18n=A;this._css={widgetContainerClass:"esriDirectionsContainer",searchSourceContainerClass:"esriSearchSourceContainer",stopsContainerClass:"esriStopsContainer",stopsTableContainerClass:"esriStopsTableContainer",
stopsTableCoverClass:"esriStopsTableCover",reverseStopsClass:"esriStopsReverse",addStopsClass:"esriStopsAdd",stopsClass:"esriStops",stopsRemovableClass:"esriStopsRemovable",stopsButtonContainerClass:"esriStopsButtons",stopsOptionsButtonClass:"esriStopsOptionsButton",stopsAddDestinationClass:"esriStopsAddDestination",stopsAddDestinationBtnClass:"esriStopsAddDestinationBtn",stopsGetDirectionsContainerClass:"esriStopsGetDirectionsContainer",stopsGetDirectionsClass:"esriStopsGetDirections",stopsClearDirectionsClass:"esriStopsClearDirections",
stopsInnerGeocoderClass:"esriInnerGeocoder",stopsOptionsOptionsEnabledClass:"esriStopsOptionsEnabled",stopsOptionsMenuClass:"esriStopsOptionsMenu",stopsFindOptimalOrderClass:"esriFindOptimalOrderOption",stopsUseTrafficClass:"esriUseTrafficOption",stopsReturnToStartClass:"esriReturnToStartOption",stopsOptionsCheckboxesClass:"esriOptionsCheckboxes",stopsOptionsToggleContainerClass:"esriOptionsToggleContainer",stopsOptionsUnitsContainerClass:"esriOptionsUnitsContainer",stopsOptionsUnitsMiClass:"esriOptionsUnitsMi",
stopsOptionsUnitsKmClass:"esriOptionsUnitsKm",stopsOptionsImpedanceContainerClass:"esriOptionsImpedanceContainer",stopsOptionsImpedanceTimeClass:"esriOptionsImpedanceTime",stopsOptionsImpedanceDistanceClass:"esriOptionsImpedanceDistance",stopClass:"esriStop",stopOriginClass:"esriStopOrigin",stopDestinationClass:"esriStopDestination",stopUnreachedFirstOrLastClass:"esriStopUnreachedFirstOrLast",stopUnreachedClass:"esriStopUnreached",esriStopGeocoderColumnClass:"esriStopGeocoderColumn",esriStopReverseColumnClass:"esriStopReverseColumn",
stopDnDHandleClass:"esriStopDnDHandle",stopDnDHandleClassHidden:"esriStopDnDHandleHidden",stopIconColumnClass:"esriStopIconColumn",stopIconClass:"esriStopIcon",stopIconRemoveColumnClass:"esriStopIconRemoveColumn",stopIconRemoveClass:"esriStopIconRemove",stopIconRemoveClassHidden:"esriStopIconRemoveHidden",resultsContainerClass:"esriResultsContainer",resultsLoadingClass:"esriResultsLoading",resultsPrintClass:"esriResultsPrint",resultsSaveClass:"esriResultsSave",resultsSummaryClass:"esriResultsSummary",
routesContainerClass:"esriRoutesContainer",routesClass:"esriRoutes",routesErrorClass:"esriRoutesError",routesInfoClass:"esriRoutesInfo",routeClass:"esriRoute",routeTextColumnClass:"esriRouteTextColumn",routeTextClass:"esriRouteText",routeLengthClass:"esriRouteLength",routeOriginClass:"esriDMTStopOrigin",routeDestinationClass:"esriDMTStopDestination",routeInfoClass:"esriRouteInfo",routeIconColumnClass:"esriRouteIconColumn",routeIconClass:"esriRouteIcon",infoWindowRouteClass:"esriInfoWindowRoute",routeZoomClass:"esriRouteZoom",
esriPrintPageClass:"esriPrintPage",esriPrintBarClass:"esriPrintBar",esriPrintButtonClass:"esriPrintButton",esriCloseButtonClass:"esriCloseButton",esriPrintMainClass:"esriPrintMain",esriPrintHeaderClass:"esriPrintHeader",esriPrintLogoClass:"esriPrintLogo",esriPrintMapClass:"esriPrintMap",esriPrintNameClass:"esriPrintName",esriPrintNotesClass:"esriPrintNotes",esriPrintLengthClass:"esriPrintLength",esriPrintDirectionsClass:"esriPrintDirections",esriPrintFooterClass:"esriPrintFooter",esriPrintStopLabelClass:"esriPrintStopLabel",
clearClass:"esriClear",dndDragBodyClass:"esriDndDragDirection",stopsButtonClass:"esriDirectionsButton",stopsButtonTabClass:"esriDirectionsTabButton",stopsButtonTabLastClass:"esriDirectionsTabLastButton",stopsPressedButtonClass:"esriDirectionsPressedButton",linkButtonClass:"esriLinkButton",activateButtonClass:"esriActivateButton",lineBarrierButtonClass:"esriLineBarrierButton",travelModesContainerClass:"esriTravelModesContainer"};this.options={map:null,autoSolve:!0,minStops:2,maxStops:20,theme:"simpleDirections",
alphabet:"1234567890",directions:null,returnToStart:!1,optimalRoute:!1,routeTaskUrl:oa+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",printTaskUrl:oa+"//utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",geometryTaskUrl:oa+"//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",routeParams:{},stops:["",""],searchOptions:{},stopsInfoTemplate:new G(A.widgets.directions.stop,"${address}${error}"),waypointInfoTemplate:new G(A.widgets.directions.maneuver,
A.widgets.directions.waypoint),segmentInfoTemplate:new G(A.widgets.directions.maneuver,'\x3cdiv class\x3d"${maneuverType}"\x3e\x3cdiv class\x3d"'+this._css.routeIconClass+" "+this._css.infoWindowRouteClass+'"\x3e\x3cstrong\x3e${step}.\x3c/strong\x3e ${formattedText}\x3c/div\x3e\x3c/div\x3e'),textSymbolFont:new da("11px",da.STYLE_NORMAL,da.VARIANT_NORMAL,da.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new f([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:(new Z({url:c.toUrl("./images/Directions/greenPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),fromSymbolDrag:(new Z({url:c.toUrl("./images/Directions/greenPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbol:(new Z({url:c.toUrl("./images/Directions/bluePoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbolDrag:(new Z({url:c.toUrl("./images/Directions/bluePointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbol:(new Z({url:c.toUrl("./images/Directions/redPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbolDrag:(new Z({url:c.toUrl("./images/Directions/redPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbol:(new Z({url:c.toUrl("./images/Directions/grayPoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbolDrag:(new Z({url:c.toUrl("./images/Directions/grayPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),waypointSymbol:new ha({color:[255,
255,255,255],size:10,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}}),maneuverSymbol:new ha({color:[255,255,255,255],size:4,type:"esriSMS",style:"esriSMSCircle",outline:{color:[30,99,137,255],width:1,type:"esriSLS",style:"esriSLSSolid"}}),routeSymbol:(new ga).setColor(new f([20,89,127,.75])).setWidth(10).setCap(ga.CAP_ROUND).setJoin(ga.JOIN_ROUND),segmentSymbol:(new ga).setColor(new f([255,255,255,1])).setWidth(6).setCap(ga.CAP_ROUND).setJoin(ga.JOIN_ROUND),
barrierRenderer:new ia({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjIyIiBoZWlnaHQ9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z181IiByeD0iMTAwIiByeT0iMTAwIi8+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z182IiByeD0iOTUiIHJ5PSI5NSIvPgo8cmVjdCBmaWxsPSIjZmYwMDAwIiBzdHJva2Utd2lkdGg9IjIwIiB4PSI2NC41IiB5PSIxMDIiIHdpZHRoPSI5NSIgaGVpZ2h0PSIxOCIgaWQ9InN2Z183IiBzdHJva2U9IiNmZmZmZmYiLz4KPC9nPgo8L3N2Zz4\x3d",
contentType:"image/svg+xml",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjg2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGZpbGw9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTAiIGQ9Im04Ljc0OTk5MiwyNTEuNzQ5OTk3bDEzNC45OTk5OTgsLTI0MS45OTk5OThsMTM0Ljk5OTk5OCwyNDEuOTk5OTk4bC0yNjkuOTk5OTk1LDBsLTAuMDAwMDAxLDB6IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMCIvPgo8cGF0aCBzdHJva2U9IiNmZmYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMTUiIGQ9Im0yMy41MDAwMDQsMjQyLjUwMDAwNWwxMTkuOTk5OTkyLC0yMTUuOTk5OTk5bDExOS45OTk5OTIsMjE1Ljk5OTk5OWwtMjM5Ljk5OTk4MywwbC0wLjAwMDAwMSwweiIgaWQ9InN2Z18yIi8+Cjx0ZXh0IGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIgeD0iMTA5IiB5PSIyMjIuNzUiIGlkPSJzdmdfNSIgZm9udC1zaXplPSIxODAiIGZvbnQtZmFtaWx5PSJHZW9yZ2lhLCBUaW1lcywgJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIHhtbDpzcGFjZT0icHJlc2VydmUiPiE8L3RleHQ+CjwvZz4KPC9zdmc+",
contentType:"image/svg+xml",width:19,height:18}}]}),polylineBarrierRenderer:new ia({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new ia({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),printPage:"",printTemplate:"",focusOnNewStop:!0,dragging:!0,canModifyStops:!0,canModifyWaypoints:!0,directionsLengthUnits:null,directionsLanguage:null,traffic:!1,trafficLayer:null,showPrintPage:!0,showSaveButton:!1,showSegmentPopup:!1,showSegmentHighlight:!0,showReverseStopsButton:!0,showReturnToStartOption:!0,
showOptimalRouteOption:!0,showTravelModesOption:!0,showMilesKilometersOption:!0,showClearButton:!1,showActivateButton:!0,showBarriersButton:!0,loaded:!1,routeLayer:{itemId:null,title:null,isItemOwner:!0,ownerFolder:null},startTime:"now"};this.userOptions=a;this.defaults=h.mixin({},this.options,a,{_waypointName:"DWWP",_userDefinedStopName:"UserDefinedStopName",_solveInProgress:!1,_moveInProgress:!1,_stopSequence:1E3});if(!this.defaults.minStops||2>this.defaults.minStops)this.defaults.minStops=2;if(2<
this.defaults.minStops&&this.defaults.stops&&","===this.defaults.stops.toString())for(a=2;a<this.defaults.minStops;a++)this.defaults.stops.splice(0,0,"");this.domNode=b},postCreate:function(){this.inherited(arguments);this.own(u(this._activateButtonNode,d,h.hitch(this,function(){this.mapClickActive?this.deactivate():this.activate()})));this.own(u(this._lineBarrierButtonNode,d,h.hitch(this,function(){this.barrierToolActive?this.deactivateBarrierTool():this.activateBarrierTool()})));this.own(u(this._addDestinationNode,
d,h.hitch(this,this._addStopButton)));this.own(u(this._optionsButtonNode,d,h.hitch(this,this._toggleOptionsMenu)));this.own(u(this._saveMenuButton,d,h.hitch(this,this._toggleSaveMenu)));this.own(u(this._saveButton,d,h.hitch(this,function(){this._saveButton._enabled&&this._storeRouteUI()})));this.own(u(this._saveAsButton,d,h.hitch(this,function(){h.mixin(this.routeLayer,{itemId:null,title:null,ownerFolder:null});this._storeRouteUI()})));this.own(u(this._findOptimalOrderNode,d,h.hitch(this,this._toggleCheckbox)));
this.own(u(this._returnToStartNode,d,h.hitch(this,this._toggleCheckbox)));this.own(u(this._useTrafficNode,d,h.hitch(this,this._toggleCheckbox)));this.own(u(this._useMilesNode,d,h.hitch(this,this._toggleUnits)));this.own(u(this._useKilometersNode,d,h.hitch(this,this._toggleUnits)));this.own(u(this._getDirectionsButtonNode,d,h.hitch(this,this.getDirections)));this.own(u(this._clearDirectionsButtonNode,d,h.hitch(this,function(){this.clearDirections()})));var a=h.hitch(this,function(){clearTimeout(this._startTimeMenu._hideTimer);
this._startTimeMenu._hideTimer=setTimeout(h.hitch(this,function(){C.set(this._startTimeMenu,"display","none")}),100)});this.own(u(this._startTimeButtonNode,d,h.hitch(this,function(){this._startTimeButtonNode.disabled||"block"===C.get(this._startTimeMenu,"display")?C.set(this._startTimeMenu,"display","none"):(C.set(this._startTimeMenu,"display","block"),this["now"===this.startTime?"_startTimeMenuLeaveNow":"none"===this.startTime?"_startTimeMenuNone":"_startTimeMenuDepartAt"].focus())})));this.own(u(this._startTimeMenuLeaveNow,
"blur",a));this.own(u(this._startTimeMenuDepartAt,"blur",a));this.own(u(this._startTimeMenuNone,"blur",a));this.own(u(this._startTimeMenuLeaveNow,"mousedown",h.hitch(this,function(){this.startTime="now";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(u(this._startTimeMenuDepartAt,"mousedown",h.hitch(this,function(){this.startTime=(new Date).getTime();this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(u(this._startTimeMenuNone,"mousedown",h.hitch(this,function(){this.startTime=
"none";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this._symbolEventPaddingDirections=(new ga).setColor(new f([0,255,0,0])).setWidth(20).setCap(ga.CAP_ROUND);this._stopLayer=new D({id:"directions_stopLayer_"+this.id,displayOnPan:!0});this._routeLayer=new D({id:"directions_routeLayer_"+this.id,displayOnPan:!0});this._waypointsEventLayer=new D({id:"directions_waypointsEventLayer_"+this.id,displayOnPan:!0});this._barriersLayer=new D({id:"directions_barriersLayer_"+this.id,displayOnPan:!0});
this._polylineBarriersLayer=new D({id:"directions_polylineBarriersLayer_"+this.id,displayOnPan:!0});this._polygonBarriersLayer=new D({id:"directions_polygonBarriersLayer_"+this.id,displayOnPan:!0});this._barriersLayer.setRenderer(this.defaults.barrierRenderer);this._polylineBarriersLayer.setRenderer(this.defaults.polylineBarrierRenderer);this._polygonBarriersLayer.setRenderer(this.defaults.polygonBarrierRenderer);this.map&&(this.map.addLayer(this._routeLayer),this.map.addLayer(this._polygonBarriersLayer),
this.map.addLayer(this._polylineBarriersLayer),this.map.addLayer(this._barriersLayer),this.map.addLayer(this._stopLayer),this._externalTimeExtent=this.map.timeExtent);this._snappingManager=this.map.enableSnapping({layerInfos:[{layer:this._waypointsEventLayer,snapToVertex:!1,snapToPoint:!0,snapToEdge:!0}],tolerance:15});this._setWidgetProperties();var b=new Q(null,this.waypointSymbol,{}),a=h.hitch(this,function(){this._moveInProgress||this._solveInProgress||!b._isShown()||(this.editToolbar.deactivate(),
this._stopLayer.remove(b),clearTimeout(b._solveTimeout),b._solveTimeout=null,b.attributes.isWaypoint=!0,b._isStopIcon&&this.stopGraphics[b._index]&&(this._stopLayer.add(this.stopGraphics[b._index]),this._stopLayer.add(this.textGraphics[b._index])));b._showTooltip()});this._handle=h.mixin(b,{_isHandle:!0,_tooltip:O.create("div",{className:this.theme+" esriDirectionsRouteTooltip",onmouseover:a},this.map.container),_showTooltip:h.hitch(this,function(a){b._tooltip.style.display=!a||a instanceof MouseEvent?
"none":"inline";a&&(a="string"===typeof a?a:"\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a)+"\x3c/table\x3e",b._tooltip.innerHTML!==a&&(b._tooltip.innerHTML=a))}),_isShown:h.hitch(this,function(){return-1<e.indexOf(this._stopLayer.graphics,b)}),_remove:a});this._activate(this.mapClickActive)},startup:function(){this.inherited(arguments);return this._enqueue(this._init)},destroy:function(){this.deactivate();this.map.removeLayer(this._barriersLayer);this.map.removeLayer(this._polylineBarriersLayer);
this.map.removeLayer(this._polygonBarriersLayer);this.map.removeLayer(this._routeLayer);this.map.removeLayer(this._stopLayer);this.map.removeLayer(this._waypointsEventLayer);this._disconnectEvents();O.empty(this.domNode);this.inherited(arguments)},activate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(h.hitch(this,function(){this.set("mapClickActive",!0)}))})},deactivate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(h.hitch(this,function(){this.set("mapClickActive",
!1)}))})},activateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!0)})},deactivateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!1)})},clearDirections:function(){return this._enqueue(function(){this.clearMessages();return this._clearDirections()})},reset:function(){return this._enqueue(this._reset)},modifyStopSequence:function(a,b){return this._enqueue(function(){return this._modifyStopSequence(a,
b)})},onActivate:function(){},onDeactivate:function(){},onActivateBarrierTool:function(){},onDeactivateBarrierTool:function(){},onLoad:function(){this._enableButton(this._getDirectionsButtonNode)},onDirectionsStart:function(){this._clearDisplayBeforeSolve();this.set("solving",!0);this._showLoadingSpinner(!0)},onDirectionsFinish:function(){this._showLoadingSpinner(!1);this.set("solving",!1)},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},onStopsUpdate:function(){},
onRouteItemCreated:function(){},onRouteItemUpdated:function(){},onFeatureCollectionCreated:function(){},onError:function(){},removeStops:function(){return this.reset()},removeStop:function(a,b,d){return this._enqueue(function(){this.clearMessages();return this._removeStop(a,b,d)})},updateStops:function(a){return this._enqueue(function(){return this._updateStops(a)})},addStops:function(a,b){return this._enqueue(function(){return this._addStops(a,b)}).then(h.hitch(this,this.zoomToFullRoute))},addStop:function(a,
b){return this._enqueue(function(){return this._addStop(a,b)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},updateStop:function(a,b,d){return this._enqueue(function(){return this._updateStop(a,b,d)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},setBarriers:function(a){this.routeParams.barriers=a;return this._getDirections().then(h.hitch(this,function(){this.zoomToFullRoute()}))},setPolylineBarriers:function(a){this.routeParams.polylineBarriers=a;return this._getDirections().then(h.hitch(this,
function(){this.zoomToFullRoute()}))},setPolygonBarriers:function(a){this.routeParams.polygonBarriers=a;return this._getDirections().then(h.hitch(this,function(){this.zoomToFullRoute()}))},clearMessages:function(){this.messages=[];this._msgNode&&(this._msgNode.innerHTML="")},getDirections:function(a){return this._enqueue(function(){return this._getDirections().then(h.hitch(this,function(){!0!==a&&this.zoomToFullRoute()}))})},selectSegment:function(a){if(!(!this.directions||!this.directions.features||
0>a||a>=this.directions.features.length))for(var b=z("[data-segment]",this._resultsNode),d=0;d<b.length;d++){var c=parseInt(B.get(b[d],"data-segment"),10);if(a===c&&b[d]!==this._focusedDirectionsItem){this._focusedDirectionsItem=b[d];this.centerAtSegmentStart(a);this.onSegmentSelect(this.directions.features[a]);b[d].focus();break}}},unhighlightSegment:function(a){var b=this._segmentGraphics;if(b&&(!this._focusedDirectionsItem||a)){for(a=0;a<b.length;a++)this._routeLayer.remove(b[a]);this._segmentGraphics=
[]}},highlightSegment:function(a,b){if(!(this._focusedDirectionsItem&&!b||a>=this.directions.features.length)){a=a||0;var d=h.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toScreen(b.offset(a,0)).x}),c=h.hitch(this,function(a){for(var b=0,c=0;c<a.length;c++)for(var e=1;e<a[c].length;e++)var f=a[c][e-1],g=a[c][e],b=b+d(Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])));return b}),e=h.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toMap({x:a,
y:0}).x-b.x}),g=function(a,b,c){b=Math.max(1,b);for(var e=c?a[0].length-1:0,f=0,g,k,m,n=[[a[0][c?e:0]]];c&&0<e||!c&&e<a[0].length-1;){k=a[0][c?e-1:e];m=a[0][c?e:e+1];if(g=d(Math.sqrt((k[0]-m[0])*(k[0]-m[0])+(k[1]-m[1])*(k[1]-m[1]))))if(f+g<b)c?n[0].splice(0,0,k):n[0].push(m),f+=g;else{b=(b-f)/g;c?n[0].splice(0,0,[m[0]-(m[0]-k[0])*b,m[1]-(m[1]-k[1])*b]):n[0].push([k[0]+(m[0]-k[0])*b,k[1]+(m[1]-k[1])*b]);break}e+=c?-1:1}return 0<f+g?n:a};b=this.get("directions").features[a];var k=new ea(b.geometry),
m=40*Math.PI/180;h.mixin(b.attributes,{_index:a});if(a){var n=g(this.get("directions").features[a-1].geometry.paths,25,!0),p="esriDMTStop"!==b.attributes.maneuverType?g(k.paths,25,!1):n,n=p!==n?[n[0].concat(p[0])]:p,D=(new ea(p)).getExtent();if(1<p[0].length&&15<=d(Math.max(D.getWidth(),D.getHeight()))){for(var g=15*Math.cos(m/2),c=15*Math.sin(m/2),q=p[0].length-2,r,m=p[0][q+1],D=0;0<=q&&!D;)r=p[0][q],D=d(Math.sqrt((r[0]-m[0])*(r[0]-m[0])+(r[1]-m[1])*(r[1]-m[1]))),q--;22>D&&(p=D+(22-D)/3,q=D+2*(22-
D)/3,q=[r[0]+q/D*(m[0]-r[0]),r[1]+q/D*(m[1]-r[1])],r=[m[0]-p/D*(m[0]-r[0]),m[1]-p/D*(m[1]-r[1])],m=q,D=22);g/=D;p=[m[0]-(m[0]-r[0])*g,m[1]-(m[1]-r[1])*g];r[1]!==m[1]?(g=(m[0]-r[0])/(m[1]-r[1]),r=e(c/Math.sqrt(1+g*g)),e=g*r):(r=0,e=e(c));Infinity===Math.abs(r)||Infinity===Math.abs(e)||isNaN(r)||isNaN(e)||(n[0].push(m),n[0].push([p[0]-r,p[1]+e]),n[0].push([p[0]+r,p[1]-e]),n[0].push(m))}else n=g(n,2*c(p),!0);k.paths=n}this.unhighlightSegment(this._segmentGraphics&&this._segmentGraphics.length);e=h.clone(this.routeSymbol).setWidth(this.segmentSymbol.width).setColor(new f([parseInt(.9*
this.segmentSymbol.color.r),parseInt(.9*this.segmentSymbol.color.g),parseInt(.9*this.segmentSymbol.color.b)]));this._segmentGraphics=[new Q(b.geometry,e,b.attributes,this.get("segmentInfoTemplate")),new Q(k,this.routeSymbol,b.attributes,this.get("segmentInfoTemplate")),new Q(k,this.segmentSymbol,b.attributes,this.get("segmentInfoTemplate"))];this.get("showSegmentHighlight")&&(this._routeLayer.add(this._segmentGraphics[0]),this._routeLayer.add(this._segmentGraphics[1]),this._routeLayer.add(this._segmentGraphics[2]));
b=h.hitch(this,function(a){if(0<a&&a<this.directions.features.length){a=this.directions.features[a]._associatedFeaturesWithWaypoints;for(var b=0;b<a.length;b++)a[b]._associatedSnapFeature&&a[b]._associatedSnapFeature.getDojoShape()&&a[b]._associatedSnapFeature.getDojoShape().moveToFront()}});b(a-1);b(a);this.onSegmentHighlight(this.directions.features[a])}},zoomToSegment:function(a){var b,d=new H;this.directions&&this.directions.features?(b=Math.max(0,Math.min(this.directions.features.length-1,a||
0)),this.map.setExtent(this.get("directions").features[b].geometry.getExtent(),!0).promise.always(h.hitch(this,function(){this.highlightSegment(b);d.resolve()}))):d.reject(Error("No directions."));return d.promise},centerAtSegmentStart:function(a){var b,d=new H;if(this.directions&&this.directions.features){b=Math.max(0,Math.min(this.directions.features.length-1,a||0));var c=this.directions.features[b];this.map.centerAt(c.geometry.getPoint(0,0)).promise.always(h.hitch(this,function(){this.highlightSegment(b,
!0);this._showSegmentPopup(c,b);d.resolve()}))}else d.reject(Error("No directions."));return d.promise},zoomToFullRoute:function(){var a=new H;this.directions&&this.directions.features?(this._clearInfoWindow(),this.unhighlightSegment(),this.get("map").setExtent(this.get("directions").extent,!0).promise.always(a.resolve)):a.resolve();return a.promise},setListIcons:function(){var a,b=this._dnd.getAllNodes();for(a=0;a<b.length;a++){var d=z("."+this._css.stopIconClass,b[a])[0];d&&(d.innerHTML=this._getLetter(a));
x.remove(b[a],this._css.stopOriginClass+" "+this._css.stopDestinationClass+" "+this._css.stopUnreachedClass+" "+this._css.stopUnreachedFirstOrLastClass);d=this._getStopSymbol(this.stops[a]);d===this.fromSymbol?x.add(b[a],this._css.stopOriginClass):d===this.toSymbol?x.add(b[a],this._css.stopDestinationClass):d===this.unreachedSymbol&&x.add(b[a],this._css.stopUnreachedClass)}a=z("[data-reverse-td]",this._dndNode)[0];O.destroy(a);this.get("showReverseStopsButton")&&O.create("td",{"data-reverse-td":"true",
rowspan:b.length,className:this._css.esriStopReverseColumnClass,innerHTML:'\x3cdiv role\x3d"button" class\x3d"'+this._css.reverseStopsClass+'" data-reverse-stops\x3d"true" title\x3d"'+A.widgets.directions.reverseDirections+'"\x3e\x3c/div\x3e',onmouseover:function(a){a.stopPropagation()},onmouseout:function(a){a.stopPropagation()}},b[0])},addRouteSymbols:function(){if(this.stopGraphics.length){this._moveLayersToFront();for(var a=0;a<this.stopGraphics.length;a++)if(this.stopGraphics[a]&&(!this._handle._isShown()||
this._handle._isShown()&&this._handle._index!==a)){this._stopLayer.add(this.stopGraphics[a]);var b=this.stopGraphics[a].getDojoShape();b&&b.moveToFront();this._stopLayer.add(this.textGraphics[a]);(b=this.textGraphics[a].getDojoShape())&&b.moveToFront()}this._moveInProgress&&!this._handle.attributes.isWaypoint&&this._handle.getDojoShape()&&this._handle.getDojoShape().moveToFront()}},createRouteSymbols:function(){this._clearStopGraphics();for(var a=this.stops,b=function(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&
0===d.indexOf("Attr_")&&(b[d]=a[d]);return b},d=0;d<a.length;d++){var c=a[d];if(c&&c.feature){var e=c.feature.attributes,f=e?e.Status:void 0,g=null;this._isStopAWaypoint(c)||(g=new W(this._getLetter(d),this.get("textSymbolFont"),this.get("textSymbolColor")),this.get("textSymbolOffset")&&g.setOffset(this.get("textSymbolOffset").x,this.get("textSymbolOffset").y));g=new Q(c.feature.geometry,g,{address:c.name},this.get("stopsInfoTemplate"));g._isStopLabel=!0;g._index=d;c=new Q(c.feature.geometry,this._getStopSymbol(c),
h.mixin({address:c.name,Status:void 0===f?0:f,CurbApproach:e&&e.CurbApproach?e.CurbApproach:null,TimeWindowStart:e&&e.TimeWindowStart?e.TimeWindowStart:null,TimeWindowEnd:e&&e.TimeWindowEnd?e.TimeWindowEnd:null,isWaypoint:this._isStopAWaypoint(c)},b(e)),this.get(this._isStopAWaypoint(c)?"waypointInfoTemplate":"stopsInfoTemplate"));c._isStopIcon=!0;c._index=d;this.stopGraphics[d]=c;this.textGraphics[d]=g}}this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);this._showBarriers();
this.addRouteSymbols();this.setListIcons()},setTravelMode:function(a){return this._enqueue(function(){this.clearMessages();this._travelModeSelector.setValue(a);return this._setTravelMode(a)})},getSupportedTravelModeNames:function(){var a=[],b=this.serviceDescription;if(b&&b.supportedTravelModes&&b.supportedTravelModes.length)for(var b=b.supportedTravelModes,d=0;d<b.length;d++)a.push(b[d].name);return a},setDirectionsLengthUnits:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLengthUnits");
return this._enqueue(function(){this.clearMessages();return this._setDirectionsLengthUnits(a)})},setDirectionsLanguage:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLanguage");return this._enqueue(function(){this.clearMessages();return this._setDirectionsLanguage(a)})},useMyCurrentLocation:function(a){this.clearMessages();return this._createLocateButton(this.geocoders[a],!0,!0)},loadRoute:function(a){return this._enqueue(h.hitch(this,function(){return this._loadRoute(a)}))},
_getStopsAttr:function(){return this.returnToStart&&this._returnToStartStop?this.stops.concat(this._returnToStartStop):this.stops},_getTravelModeNameAttr:function(){return this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.name},_reset:function(){var a=this.mapClickActive||this.barrierToolActive;this._clearBarriersGraphics();this._setWidgetProperties();return this._init().then(h.hitch(this,function(){this.mapClickActive=!a;this.set("mapClickActive",a);this._searchSourceSelector&&
this._searchSourceSelector.setValue("all")}))},_activate:function(){var a=this.get("mapClickActive"),b=h.hitch(this,function(a){for(var b=a?[this.textGraphics,this.stopGraphics,this.displayedManeuverPointGraphics,this.displayedRouteGraphics]:[this.displayedRouteGraphics,this.displayedManeuverPointGraphics,this.stopGraphics,this.textGraphics],d=0;d<b.length;d++)for(var c=b[d],e=0;e<c.length;e++){var f=c[e].getDojoShape();f&&f[a?"moveToBack":"moveToFront"].call(f)}});this.drawToolbar&&(this.barrierToolActive=
!1,this.drawToolbar.deactivate(),x.remove(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass));this._addStopOnMapClickListener&&this._addStopOnMapClickListener.remove();a?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this._addStopOnMapClickListener=u(this.map,"click",h.hitch(this,function(a){this.canModifyStops&&!this._solveInProgress&&(this.map.infoWindow.hide(),this.addStop(new Q(a.mapPoint)))})),
this.map.addLayer(this._waypointsEventLayer),this._moveLayersToFront(),x.add(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onActivate()):(this.map.removeLayer(this._waypointsEventLayer),x.remove(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onDeactivate());b(!a);this.emit("map-click-active",{mapClickActive:this.mapClickActive})},_activateBarrierTool:function(){this.get("barrierToolActive")?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&
this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this.drawToolbar.activate(sa.FREEHAND_POLYLINE),x.add(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass),this.onActivateBarrierTool()):(this.drawToolbar.deactivate(),x.remove(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass),this.onDeactivateBarrierTool());this.emit("barrier-tool-active",{barrierToolActive:this.barrierToolActive})},_moveLayersToFront:function(){var a=this.get("map"),b=a.graphicsLayerIds.length-
1;a.reorderLayer(this._routeLayer,b);a.reorderLayer(this._polygonBarriersLayer,b);a.reorderLayer(this._polylineBarriersLayer,b);a.reorderLayer(this._barriersLayer,b);a.reorderLayer(this._waypointsEventLayer,b);a.reorderLayer(this._stopLayer,b)},_destroyGeocoders:function(){for(;this.geocoders&&this.geocoders.length;){if(this.geocoders[0])try{this.geocoders[0].destroy()}catch(xa){}this.geocoders.splice(0,1)}this.geocoders=[]},_disconnectEvents:function(){var a=this._clearDirections(!0),b;if(this._watchEvents&&
this._watchEvents.length)for(b=0;b<this._watchEvents.length;b++)this._watchEvents[b].unwatch();if(this._onEvents&&this._onEvents.length)for(b=0;b<this._onEvents.length;b++)this._onEvents[b].remove();if(this._geocoderEvents)for(b=0;b<this._geocoderEvents.length;b++)this._geocoderEvents[b].value.unwatch(),this._geocoderEvents[b].blur.remove(),this._geocoderEvents[b].select.remove(),this._geocoderEvents[b].suggest.remove();this._onEvents=[];this._watchEvents=[];this._geocoderEvents=[];this._disconnectResults();
this._destroyGeocoders();this._destroyGlobalGeocoder();this._destroyDnD();return a},_getDirections:function(){var a=new H;this._removeEmptyStops();1<this._getStopCount()+this._getWaypointCount()&&this.loaded?(this.onDirectionsStart(),this.clearMessages(),this._dnd.sync(),this._sortGeocoders(),this._getCandidates(this.stops).then(h.hitch(this,function(b){this.stops=b;this._setStops();this._configureRoute().always(h.hitch(this,function(b){a.resolve(b)}))}),h.hitch(this,function(b){this.set("directions",
null);this._clearRouteGraphics();a.reject(b);this.onDirectionsFinish(b)}))):this._clearDirections(!0).always(h.hitch(this,function(){this.createRouteSymbols();a.resolve()}));return a.promise},_clearDirections:function(){var a=new H;this._handle&&this._handle._remove();this.get("routeParams")&&this.get("routeParams").stops?this.get("routeParams").stops.features.length?(this.get("routeParams").stops.features=[],this.onDirectionsClear(),a.resolve()):arguments.length?a.resolve():this._reset().then(a.resolve,
a.reject):a.resolve();this.set("directions",null);this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this._routeLayer.clear();this._waypointsEventLayer.clear();this._stopLayer.clear();return a.promise},_setTravelMode:function(a){var b=new H,d=this.serviceDescription,c=function(){b.resolve(a)};if(d&&d.supportedTravelModes&&d.supportedTravelModes.length){for(var e=d.supportedTravelModes,f=!1,d=0;d<e.length;d++)if(e[d].name===a){f=!0;!this.routeParams.travelMode||this.routeParams.travelMode&&
this.routeParams.travelMode.name!==a?(this.routeParams.travelMode=e[d].impedanceAttributeName?e[d]:e[d].itemId,this._checkStartTimeUIAvailability(),this._solveAndZoom().always(c)):c();this._travelModeSelector&&this._travelModeSelector.domNode&&(this._travelModeSelector.domNode.title=e[d].description);break}f||b.reject(a)}else b.reject(a);return b.promise},_setDirectionsLengthUnits:function(a){this._clearDisplayBeforeSolve();var b=new H;x.remove(this._useMilesNode,this._css.stopsPressedButtonClass);
x.remove(this._useKilometersNode,this._css.stopsPressedButtonClass);a===U.KILOMETERS?x.add(this._useKilometersNode,this._css.stopsPressedButtonClass):a===U.MILES&&x.add(this._useMilesNode,this._css.stopsPressedButtonClass);a===U.KILOMETERS||a===U.METERS||a===U.MILES||a===U.FEET||a===U.YARDS||a===U.NAUTICAL_MILES?(this.directionsLengthUnits=a,b.resolve(a)):b.reject(a);return b.promise},_setDirectionsLanguage:function(a){this._clearDisplayBeforeSolve();var b=new H;a=this._setDirectionsLanguageByLocale(a);
this._solveAndZoom().always(function(){b.resolve(a)},b.reject);return b.promise},_showLoadingSpinner:function(a){void 0===a&&(a=this._requestQueueTail&&!this._requestQueueTail.isFulfilled()||this._moveInProgress);a?(x.add(this._widgetContainer,this._css.resultsLoadingClass),x.add(this._resultsNode,"esriRoutesContainerBusy")):(x.remove(this._widgetContainer,this._css.resultsLoadingClass),x.remove(this._resultsNode,"esriRoutesContainerBusy"))},_enqueue:function(a,b){var d=new H;this._requestQueueTail||
(this._requestQueueTail=new H,this._requestQueueTail.resolve());this._requestQueueTail.promise.always(h.hitch(this,function(){try{h.mixin(this,{_incrementalSolveStopRange:null},b);var c=a.call(this);c&&"object"===typeof c&&c.hasOwnProperty("isFulfilled")?c.then(h.hitch(this,function(a){d.resolve(a);this._showLoadingSpinner()}),h.hitch(this,function(a){d.reject(a);this._showLoadingSpinner()})):(d.resolve(c),this._showLoadingSpinner())}catch(wa){d.reject(wa),this._showLoadingSpinner()}}));this._requestQueueTail=
d;this._showLoadingSpinner();return d.promise},_createDnD:function(){this._dnd=new J(this._dndNode,{skipForm:!0,withHandles:!0})},_destroyDnD:function(){O.empty(this._dndNode);this._dnd&&(this._dnd.destroy(),this._dnd=null)},_createDepartAtControls:function(){if(this._departAtTime)this.map&&this._restoreMapTimeExtent(),this._useTrafficItemNode.title=A.widgets.directions.trafficLabelLive,x.remove(this._departAtContainer,"departAtContainerVisible"),this.startTime="now",this._updateStartTimeUI();else{var a=
this,b=function(){this._keepDirections||a._clearDisplayBeforeSolve();this._keepDirections=!1},d=h.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),c=h.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()});this._departAtTime=new p({required:!0,value:new Date,onChange:b,onFocus:d,onBlur:c},this._departAtTimeContainer);this._departAtDate=new m({required:!0,value:new Date,onChange:b,onFocus:d,onBlur:c,constraints:{min:new Date(864E5)}},this._departAtDateContainer)}},
_setStartTime:function(a,b,d){if(isNaN(d))this.startTime="now"===d?d:"none";else{b=d instanceof Date?d:new Date(d);d=this.directions&&this.directions.features&&this.directions.features[0]&&this.directions.features[0].attributes;var c=6E4*-b.getTimezoneOffset();b=new Date(b-c+(d&&d.arriveTimeUTC?d.ETA-d.arriveTimeUTC:c));this._departAtTime._keepDirections=!a;this._departAtDate._keepDirections=!a;this._departAtTime.setValue(b);this._departAtDate.setValue(b)}this._updateStartTimeUI()},_checkStartTimeUIAvailability:function(){var a=
this._getImpedanceAttribute(),a=this._isTimeUnits(a?a.units:"")||this.serviceDescription&&10.6<=this.serviceDescription.currentVersion;this._startTimeButtonNode.disabled=!a;x[a?"remove":"add"].apply(this,[this._startTimeButtonNodeContainer,"esriLinkButtonDisabled"]);x[a?"remove":"add"].apply(this,[this._startTimeDDLArrow,"esriDirectionsDDLArrowDisabled"]);a||this.set("startTime","now")},_usingAGOL:function(a){a||(a=this.routeTaskUrl);return-1<a.search(/^(https?:)*\/\/*[^.]*\.arcgis\.com.*$/i)},_usingRouteAGOL:function(){return-1<
this.get("routeTaskUrl").search(/^(https?:)*\/\/route*[^.]*\.arcgis\.com.*$/i)},_setSearchOptions:function(){var a={map:this.get("map"),autoNavigate:!1,enableInfoWindow:!1,enableHighlight:!1,enableSourcesMenu:!1};this.searchOptions=h.mixin({maxResults:1,locationToAddressDistance:100},this.defaults.searchOptions,a)},_setDefaultUnits:function(){if(!this.get("directionsLengthUnits")){var b="EN-US"===a.locale.toUpperCase()?U.MILES:U.KILOMETERS;this.defaults.directionsLengthUnits?b=this.defaults.directionsLengthUnits:
this.userOptions.routeParams&&this.userOptions.routeParams.directionsLengthUnits&&(b=this.userOptions.routeParams.directionsLengthUnits);this.set("directionsLengthUnits",b)}this._setDirectionsLengthUnits(this.directionsLengthUnits)},_setTrafficOptions:function(){this._usingRouteAGOL()&&!this.trafficLayer&&(this.trafficLayer=new I(oa+"//traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",{opacity:.4}));this.trafficLayer&&this.trafficLayer.url&&this._usingAGOL(this.trafficLayer.url)&&(this._trafficAvailabilityButton.style.display=
"inline-block");this.set("showTrafficOption",(this.defaults.showTrafficOption||!this.defaults.hasOwnProperty("showTrafficOption"))&&!!this.trafficLayer);this._optionsMenu()},_updateCanModifyStops:function(a,b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||!this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!0);this._showAddDestination();this._showMapClickActiveButton();this._stopsTableCover.style.display=this.canModifyStops?"none":"inline"},_updateCanAddWaypoints:function(a,
b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||this.canModifyStops||!this.canModifyWaypoints||this.set("mapClickActive",!0);this._showMapClickActiveButton();this._handle._remove()},_updateStartTimeUI:function(){isNaN(this.startTime)?(this._startTimeButtonLabel.innerHTML="now"==this.startTime?this._i18n.widgets.directions.leaveNow:this._i18n.widgets.directions.noStartTime,x.remove(this._startTimeButtonNodeContainer,"departAtButton"),x.remove(this._departAtContainer,
"departAtContainerVisible")):(x.add(this._startTimeButtonNodeContainer,"departAtButton"),x.add(this._departAtContainer,"departAtContainerVisible"),this._startTimeButtonLabel.innerHTML=this._i18n.widgets.directions.departAt)},_setWidgetProperties:function(){this._disconnectEvents();this.set(this.defaults);this.routeLayer=h.clone(this.defaults.routeLayer);this._folderSelector&&(this._outputLayer.setValue(""),this._outputLayer.set("disabled",!0),this._folderSelector.set("disabled",!0));this.set("stops",
[]);this._updateCanModifyStops()},_updateStops:function(a){var b=new H;a?this.get("loaded")?this._reset().then(h.hitch(this,function(){this._addStops(a).then(b.resolve,b.reject)}),b.reject):this._addStops(a).then(b.resolve,b.reject):b.reject();return b.promise},_removeStop:function(a,b,d,c){var e=new H,f=h.hitch(this,function(a){this.stops.splice(a,1);var b=this._dnd.getAllNodes()[a],d=this.get("geocoders");this._geocoderEvents[b.id]&&(this._geocoderEvents[b.id].blur.remove(),this._geocoderEvents[b.id].select.remove(),
this._geocoderEvents[b.id].suggest.remove(),this._geocoderEvents[b.id].value.unwatch());d[a].destroy();d.splice(a,1);this.set("geocoders",d);O.destroy(b);this._dnd.sync();this._stopsRemovable();this._optionsMenu();this._checkMaxStops();this.setListIcons();this._sortGeocoders()});if(0>a||a>=this.stops.length||void 0===a)a=this.stops.length-1;var g=!1;for(c=this.stopGraphics[a]&&this._isStopAWaypoint(this.stops[a])||c;!g;)f(a),c?g=!0:(a-=0>=a||a<this.stops.length&&this._isStopAWaypoint(this.stops[a])?
0:1,g=!this._isStopAWaypoint(this.stops[a]));for(;this.stops.length-this._getWaypointCount()<this.minStops;)this._addStop();this._clearStopsStatusAttr();this._setStops();this.createRouteSymbols();d?(this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this.createRouteSymbols(),e.resolve()):this._solveAndZoom(b).then(e.resolve,e.reject);return e.promise},_removeTrafficLayer:function(){this.trafficLayer&&this.map&&this.map.removeLayer(this.trafficLayer);this._trafficLayerAdded=!1},_addStops:function(a,
b){var d=new H,c=[],e=this.autoSolve;this.autoSolve=!1;void 0===b&&(b=this._getStopCount());for(var f=0;f<Math.min(a.length,this.maxStops-this._getStopCount());f++){var g=new H;this._addStop(a[f],b+f,!0).always(g.resolve);c.push(g)}K(c).always(h.hitch(this,function(){this.autoSolve=e;this._getDirections().always(function(){d.resolve(a)})}));return d.promise},_addStop:function(a,b,d){var c=new H;this._checkMaxStops();this.maxStopsReached?(this._showMessage(A.widgets.directions.error.maximumStops),
c.reject(Error(A.widgets.directions.error.maximumStops))):(void 0===a&&void 0===b&&(b=this.stops.length),a instanceof Q&&a.attributes&&a.attributes.isWaypoint&&(!b||b===this.stops.length||2>this._getStopCount())&&!d?(this._showMessage(A.widgets.directions.error.waypointShouldBeInBetweenStops),c.reject(Error(A.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(a).then(h.hitch(this,function(a){this._isStopAWaypoint(a)&&a&&a.feature&&(a.feature.attributes=h.mixin({},a.feature.attributes,
{isWaypoint:!0,CurbApproach:3}));this._insertStop(a,b);this.autoSolve&&""!==a.name?this._getDirections().always(function(){c.resolve(a,b)}):c.resolve(a,b)}),h.hitch(this,function(a){c.reject(a)})));return c.promise},_removeEmptyStops:function(){for(var a=0,b=this.stops.length-this._getWaypointCount()-this.minStops;a<this.stops.length&&0<b;)this.stops[a]&&this.stops[a].name?a++:(this._removeStop(a,!0,!0,!0),b--,this._moveInProgress&&this._handle._index>=a&&this._handle._isStopIcon&&this._handle._index--)},
_setReverseGeocode:function(a,b,d){if(a.feature.geometry&&-1<d){var c={address:a.name};this.stopGraphics[d]&&(h.mixin(this.stopGraphics[d].attributes,c),this.stopGraphics[d].setGeometry(b));this.textGraphics[d]&&(h.mixin(this.textGraphics[d].attributes,c),this.textGraphics[d].setGeometry(b));this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);(c=this.geocoders[d])&&c.inputNode&&(c.value=a.name,c.inputNode.value=a.name);h.mixin(a.feature.attributes,this.stops[d].feature.attributes);
this.stops[d]=a;this.stops[d].feature.setGeometry(b);this._setStops();return this._enqueue(function(){return this._getDirections()})}},_insertStop:function(a,b){var d,c;if(void 0===b)for(d=0;d<this.geocoders.length;d++){if(!this.geocoders[d].get("value")){c=this.geocoders[d];break}}else d=b,this.geocoders[d]&&!this.geocoders[d].get("value")&&(c=this.geocoders[d]);!c||void 0!==b&&b!==d||this._isStopAWaypoint(a)?(void 0===b&&(b=this.geocoders.length),this.stops.splice(b,0,a),this._createGeocoder(a,
b)):(this.stops[d]=a,c.set("value",a.name),c._stopReference=a);this._optionsMenu()},_createGeocoder:function(a,b){var d=this._dnd.getAllNodes(),c=!1,f=!1,g=d.length;d[b]?(f=d[b],c=!0):c=f=!1;var k=h.hitch(this,function(a,b){var d=b?this._css.stopDnDHandleClass:this._css.stopDnDHandleClassHidden,c=b?this._css.stopDnDHandleClassHidden:this._css.stopDnDHandleClass;x.replace(a.children[0],d,c);2<this.geocoders.length&&(d=b?this._css.stopIconRemoveClass:this._css.stopIconRemoveClassHidden,c=b?this._css.stopIconRemoveClassHidden:
this._css.stopIconRemoveClass,x.replace(a.children[3].children[0],d,c))}),m=O.create("tr",{className:this._css.stopClass,style:this._isStopAWaypoint(a)?"display:none;":"",onmouseover:function(){k(this,!0)},onmouseout:function(){k(this,!1)}});O.create("td",{className:this._css.stopDnDHandleClassHidden+" dojoDndHandle"},m);d=O.create("td",{className:this._css.stopIconColumnClass},m);O.create("div",{className:this._css.stopIconClass+" dojoDndHandle",innerHTML:this._getLetter(g),"data-center-at":"true"},
d);g=O.create("td",{className:this._css.esriStopGeocoderColumnClass},m);g=O.create("div",{},g);d=O.create("td",{className:this._css.stopIconRemoveColumnClass},m);O.create("div",{className:this._css.stopIconRemoveClassHidden,role:"button","data-remove":"true"},d);this._dnd.insertNodes(!1,[m],c,f);var c=h.mixin({},this.get("searchOptions"),{value:a.name,activeSourceIndex:this._globalGeocoder.activeSourceIndex}),n=new N(c,g),p=h.hitch(this,function(a,b){this._enqueue(function(){if(b!==a&&n._stopReference&&
n._stopReference.name!==b){var d=e.indexOf(this.stops,n._stopReference);this.stops[d]={name:b};this._handle._remove();this._removeSomeWaypoints(this._markWPsForRemovalAfterUserChangedStopSequence(d));this._setStops();this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this.createRouteSymbols()}})});n._tr=m;n._stopReference=a;n.startup();this.geocoders.splice(b,0,n);this._geocoderEvents[m.id]={blur:n.on("blur",function(){""!==this.value&&this._stopReference&&!this._stopReference.feature&&
this.search()}),select:n.on("select-result",h.hitch(this,function(a){var b=!0;if(a&&(a.results||a.result)){var d=this._dnd.getAllNodes(),d=e.indexOf(d,m),c=n.value,f=a.results&&a.results.results&&a.results.results.length?a.results.results[0]:a.result;f?(f.name=c,this.stops[d]=this._toPointGeometry(f),this.geocoders[d]._stopReference=this.stops[d],p("",c)):(this.removeStop(d),this.set("directions",null),this._showMessage(A.widgets.directions.error.unknownStop.replace("\x3cname\x3e",a.target.get("value"))),
this._clearRouteGraphics(),b=!1);b&&this.getDirections()}})),suggest:n.on("suggest-results",function(){if(document.activeElement===this.inputNode)for(var a=z("LI[role\x3d'menuitem']",this.suggestionsNode),b=0;b<a.length;b++)B.set(a[b],"tabindex",-1);else this._hideSuggestionsMenu()}),value:n.watch("value",function(a,b,d){p(b,d)})};this._checkMaxStops();this.setListIcons();this._stopsRemovable();this._optionsMenu();this._sortGeocoders()},_blurGeocoders:function(){if(document.activeElement)for(var a=
0;a<this.geocoders.length;a++)if(this.geocoders[a].inputNode===document.activeElement){this.geocoders[a]._hideSuggestionsMenu();this.geocoders[a].inputNode.blur();1<this._getStopCount()+this._getWaypointCount()&&this.getDirections(!0);break}},_decorateEmptyAGOLGeocoderResponse:function(a){a&&", , "===a.name&&(a.name=a.feature&&a.feature.attributes&&a.feature.attributes.Match_addr?a.feature.attributes.Match_addr+("POI"===a.feature.attributes.Addr_type&&a.feature.attributes.City&&-1===a.feature.attributes.Match_addr.indexOf(a.feature.attributes.City)?
", "+a.feature.attributes.City:""):"");return a},_toPointGeometry:function(a){var b=a.feature.geometry;b&&(b.getCentroid?a.feature.geometry=b.getCentroid():b.getExtent&&(b=b.getExtent())&&(a.feature.geometry=b.getCenter()));return a},_removeLocateButtonVisibilityEvents:function(){for(var a=0;a<this.geocoders.length;a++){var b=this.geocoders[a];b._onMouseEnter&&b._onMouseEnter.remove();b._onMouseOut&&b._onMouseOut.remove();b._onKeyPress&&b._onKeyPress.remove();b._locateButton&&(b._locateButton._onMouseEnter&&
b._locateButton._onMouseEnter.remove(),b._locateButton._onMouseOut&&b._locateButton._onMouseOut.remove())}},_setLocateButtonVisibilityEvents:function(){this._removeLocateButtonVisibilityEvents();for(var a=this,b=function(b){b instanceof FocusEvent?this._geocoder._lbShown_f=!0:this._geocoder._lbShown_g=!0;a._createLocateButton(this._geocoder,!0)},d=function(b){b instanceof FocusEvent?this._geocoder._lbShown_f=!1:this._geocoder._lbShown_g=!1;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(h.hitch(this,
function(){this._geocoder._lbShown_lb||this._geocoder._lbShown_f||a._destroyLocateButton(this._locateButton)}),400)},c=function(){this._geocoder._lbShown_g=!0;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(h.hitch(this,function(){""===this.value?a._createLocateButton(this._geocoder,!0):a._destroyLocateButton(this._locateButton)}),400)},e=function(){this._geocoder._lbShown_lb=!0;clearTimeout(this._geocoder._destroyTimeout)},f=function(){this._geocoder._lbShown_lb=!1;clearTimeout(this._geocoder._destroyTimeout);
this._geocoder._destroyTimeout=setTimeout(h.hitch(this,function(){this._geocoder._lbShown_g||this._geocoder._lbShown_f||a._destroyLocateButton(this._geocoder.inputNode._locateButton)}),400)},g=0;g<this.geocoders.length;g++){var k=this.geocoders[g];k&&k.inputNode&&(k.inputNode._geocoder=k,k._onMouseEnter=u(k.inputNode,w.enter,b),k._onMouseOut=u(k.inputNode,[w.leave,"blur"],d),k._onKeyPress=u(k.inputNode,"keydown",c),k.inputNode._locateButton&&(k=k.inputNode._locateButton,k._onMouseEnter=u(k.domNode,
w.enter,e),k._onMouseOut=u(k.domNode,w.leave,f)))}},_createLocateButton:function(a,b,f){var g=new H;a.inputNode._locateButton&&a.inputNode._locateButton._locating?g.resolve():c(["./LocateButton"],h.hitch(this,function(c){this._destroyLocateButton(a.inputNode._locateButton);if(a&&!this._solveInProgress){var k=O.create("div",{},a.domNode);x.add(a.domNode,this._css.stopsInnerGeocoderClass);var m=new c({map:this.map,highlightLocation:!1,centerAt:!1,setScale:!1,useTracking:!1},k);m.startup();a.inputNode._locateButton=
m;m.domNode._geocoder=a;this._setLocateButtonVisibilityEvents();c=h.hitch(this,function(){m._locating=!0;a.set("value","");a.inputNode.placeholder=A.widgets.directions.retrievingMyLocation.toUpperCase()});m._onBeforeLocate=u(m._locateNode,d,c);m._onLocate=u(m,"locate",h.hitch(this,function(d){m._locating=!1;d.graphic?(b&&this._destroyLocateButton(a.inputNode._locateButton),this.updateStop(new Q(d.graphic.geometry),e.indexOf(this.geocoders,a)).then(h.hitch(this,function(){1<this.stopGraphics.length?
this.getDirections().always(function(){g.resolve(d)}):g.resolve(d)}))):(a.set("value",""),a.inputNode.placeholder=A.widgets.directions.myLocationError.toUpperCase(),g.reject(d.error))}));f?(c(),m.locate().then(null,g.reject)):g.resolve()}else g.resolve()}));return g.promise},_destroyLocateButton:function(a){if(a){var b=a.domNode._geocoder;clearTimeout(b._destroyTimeout);a._locating?b._destroyTimeout=setTimeout(h.hitch(this,function(){b._lbShown_lb||b._lbShown_f||this._destroyLocateButton(a)}),100):
(a.clear(),a._onBeforeLocate.remove(),a._onLocate.remove(),a._onMouseEnter&&a._onMouseEnter.remove(),a._onMouseOut&&a._onMouseOut.remove(),a.destroy(),b.inputNode&&(b.inputNode._locateButton=null,b._setPlaceholder(b.activeSourceIndex)))}},_sortStops:function(){this.stops.length&&(this.stops.sort(h.hitch(this,function(a,b){for(var d,c,e=0;e<this.get("geocoders").length;e++)this.geocoders[e]._stopReference===a?d=e:this.geocoders[e]._stopReference===b&&(c=e);return d>c?1:c>d?-1:0})),this._setStops())},
_getCandidate:function(a){var b=new H,d=typeof a;a?"object"===d&&a.hasOwnProperty("feature")&&a.hasOwnProperty("name")?(a.feature.attributes&&void 0!==a.feature.attributes.displayName&&!this._isStopAWaypoint(a)&&(a.name=a.feature.attributes.displayName,a.feature.attributes.Name=this._userDefinedStopName),a.name=this._isStopAWaypoint(a)?this._waypointName:String(a.name),"point"!==a.feature.geometry.type&&(a.feature.geometry=new aa([a.feature.geometry.x,a.feature.geometry.y],this.map.spatialReference)),
b.resolve(a)):"object"===d&&a.hasOwnProperty("address")&&a.hasOwnProperty("location")?(a=this._globalGeocoder._hydrateResult(a),b.resolve(a)):"object"!==d||!a.hasOwnProperty("name")||null!==a.name&&""!==a.name?a instanceof Q&&a.attributes&&(void 0!==a.attributes.Name||a.attributes.isWaypoint)?(d=this._addStopWrapperToGraphic(a,a.attributes.isWaypoint?this._waypointName:String(a.attributes.Name)),String(a.attributes.Name)&&(d.feature.attributes.Name=this._userDefinedStopName),b.resolve(d)):("object"===
d&&a.hasOwnProperty("name")&&(a=String(a.name)),this._reverseGeocode(a).then(b.resolve,b.reject)):b.resolve(h.clone(this._emptyStop)):b.resolve(h.clone(this._emptyStop));return b.promise},_reverseGeocode:function(a){var b=new H,d,c=a.geometry?a.geometry:a;if(this._globalGeocoder){var e=h.hitch(this,function(a){var b=new H,d=500;if(this.map){var e=this.map.toScreen(c);e.x+=V._calculateClickTolerance([a]);this.map.spatialReference.isWebMercator()?(d=Math.abs(this.map.toMap(e).x-c.x),b.resolve(d)):4326===
this.map.spatialReference.wkid?(d=Math.abs(X.geographicToWebMercator(this.map.toMap(e)).x-X.geographicToWebMercator(c).x),b.resolve(d)):this._geometryService&&(a=new qa,a.distanceUnit=la.UNIT_METER,a.geometry1=c,a.geometry2=this.map.toMap(e),this._geometryService.distance(a,function(a){d=a;b.resolve(d)},function(){b.resolve(d)}))}return b.promise}),f=[],g=this._globalGeocoder.sources,k=function(){g[d].featureLayer&&f.push(e(g[d].featureLayer).then(h.hitch(g[d],function(a){this.searchQueryParams=h.mixin(this.searchQueryParams,
{distance:a})})))};if("all"===this._globalGeocoder.activeSourceIndex)for(d=0;d<g.length;d++)k();else d=this._globalGeocoder.activeSourceIndex,k();K(f).always(h.hitch(this,function(){this._globalGeocoder.search(c).then(h.hitch(this,function(e){var f=!1;if(e){var g=null,k;for(d=0;d<this._globalGeocoder.sources.length;d++)if(e[d]&&e[d].length){k=e[d];break}if(k.length&&(f=!0,g=k[0],this._globalGeocoder.sources[d].featureLayer))for(e=Number.POSITIVE_INFINITY,d=0;d<k.length;d++){k[d]=this._toPointGeometry(k[d]);
var m=ca.geodesicLengths([new ea({paths:[[X.xyToLngLat(c.x,c.y),X.xyToLngLat(k[d].feature.geometry.x,k[d].feature.geometry.y)]],spatialReference:{wkid:this.map.spatialReference.wkid}})],"esriMeters")[0];e>m&&(e=m,g=k[d])}(g=this._decorateEmptyAGOLGeocoderResponse(g))&&""!==g.name&&null!==g.name&&void 0!==g.name?(g.name=String(g.name),isNaN(c.x)||isNaN(c.y)||this.map.spatialReference.wkid!==c.spatialReference.wkid?!g.feature.geometry||isNaN(g.feature.geometry.x)||isNaN(g.feature.geometry.y)?(this._showMessage(A.widgets.directions.error.locator),
b.reject(Error(A.widgets.directions.error.locator))):b.resolve(g):(g.feature.geometry=c,b.resolve(g))):f=!1}f||(a instanceof aa?a=new Q(a):a instanceof Array&&(a=new Q(new aa(a[0],a[1]))),a instanceof Q?this._decorateUngeocodedStop(a).then(b.resolve,b.reject):(this._showMessage(A.widgets.directions.error.unknownStop.replace("\x3cname\x3e",a.toString())),b.reject(Error(A.widgets.directions.error.unknownStop.replace("\x3cname\x3e",a.toString())))))}))}))}else this._showMessage(A.widgets.directions.error.locatorUndefined),
b.reject(Error(A.widgets.directions.error.locatorUndefined));return b.promise},_updateStop:function(a,b,d){var c=new H;this.stops&&this.stops[b]?a instanceof Q&&a.attributes&&a.attributes.isWaypoint&&(!b||b===this.stops.length-1||2>this._getStopCount())?(this._showMessage(A.widgets.directions.error.waypointShouldBeInBetweenStops),c.reject(Error(A.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(a).then(h.hitch(this,function(a){var e=a.feature,e=e?e.geometry:null,f=this.stops[b].feature,
f=f?f.geometry:null,e=e&&f&&(e.x!==f.x||e.y!==f.y)||!e&&f;this.stops[b]=a;this.geocoders[b]||this._createGeocoder(a,b);f=this.geocoders[b];f._stopReference=a;f._tr.style.display=this._isStopAWaypoint(a)?"none":"";f.value=a.name;f.inputNode&&(f.inputNode.value=a.name);e&&this.autoSolve&&1<this._getStopCount()+this._getWaypointCount()||d?this._getDirections().then(c.resolve,c.reject):(this._setStops(),c.resolve(a))}),h.hitch(this,function(a){c.reject(a)})):(this._showMessage(A.widgets.directions.error.couldNotUpdateStop),
c.reject(Error(A.widgets.directions.error.couldNotUpdateStop)));this._optionsMenu();return c.promise},_renderDirections:function(){var a=this.get("directions"),b;this._resultsNode&&(b=""+('\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e'),b+=this._renderDirectionsSummary(a),b+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e',b+='\x3cdiv class\x3d"'+this._css.routesClass+'"\x3e',b+=this._renderDirectionsTable(a),b+="\x3cdiv class\x3d'esriPrintFooter'\x3e"+A.widgets.directions.printDisclaimer+
"\x3c/div\x3e",b+="\x3c/div\x3e",this._resultsNode&&(this._resultsNode.innerHTML=b),this._disconnectResults(),(a=z("[data-segment]",this._resultsNode))&&a.length&&e.forEach(a,h.hitch(this,function(a){this._resultEvents.push(u(a,w.enter,h.hitch(this,function(){if(!this._focusedDirectionsItem){var b=parseInt(B.get(a,"data-segment"),10);this.highlightSegment(b)}})));this._resultEvents.push(u(a,"focusout",h.hitch(this,function(){this._focusedDirectionsItem=null;this.unhighlightSegment(!0)})));this._resultEvents.push(u(a,
w.leave,this.unhighlightSegment));this._resultEvents.push(u(a,"click, keydown",h.hitch(this,function(b){b&&("click"===b.type||"keydown"===b.type&&b.keyCode===r.ENTER)&&(this._focusedDirectionsItem!==a?this.selectSegment(parseInt(B.get(a,"data-segment"),10)):(a.blur(),this.map.infoWindow.hide(),this._focusedDirectionsItem=null,this.unhighlightSegment(!0)))})))})))},_renderDirectionsSummary:function(a){var b="",d=h.hitch(this,function(){for(var b={},d=this._getDirectionsTimeAttribute()||{},c=this._getTimeNeutralAttribute()||
{},e=0,f=0,g=this.get("stops"),k=g.length-1;0<=k;k--)if(null!==g[k].feature.attributes.ArriveCurbApproach){b=g[k].feature.attributes;break}for(var m in b)b.hasOwnProperty(m)&&(m==="Cumul_"+d.name&&(e=b[m]),m==="Cumul_"+c.name&&(f=b[m]));b="esriTrafficLabelHidden";g=A.widgets.directions.noTraffic;k=a.totalTime-a.totalDriveTime;k=(f-this._convertCostValue(k,d.units,c.units))/(e-k||1);0<k&&.8>k?(b="esriTrafficLabelHeavy",g=A.widgets.directions.heavyTraffic):1===k?(b="esriTrafficLabelNone",g=A.widgets.directions.noTraffic):
1.25<k&&(b="esriTrafficLabelLight",g=A.widgets.directions.ligthTraffic);c=this._formatTime(f,!1,c.units);return{label:g,labelClass:b,ratio:k,noTrafficCostStr:1!==k&&c?c+" "+A.widgets.directions.onAverage+"\x3cbr\x3e":"",trafficCost:e,noTrafficCost:f,timeAtt:d}});if(a.totalLength||a.totalTime){var d=d(),c=this._getImpedanceAttribute(),b=b+("\x3cdiv class\x3d'"+this._css.resultsSummaryClass+"' data-full-route\x3d'true'\x3e\x3cdiv class\x3d'esriImpedanceCost'\x3e");if(this._isTimeUnits(c.units))b+=this._formatTime(d.trafficCost,
!0,d.timeAtt.units)+"\x3cdiv class\x3d'esriImpedanceCostHrMin'\x3e\x3cdiv class\x3d'esriImpedanceCostHr'\x3e"+A.widgets.directions.time.hr+"\x3c/div\x3e\x3cdiv class\x3d'esriImpedanceCostMin'\x3e"+A.widgets.directions.time.min+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+(d.noTrafficCost?"\x3cdiv class\x3d'esriTrafficLabel "+d.labelClass+"'\x3e"+d.label+"\x3c/div\x3e"+d.noTrafficCostStr:"")+this._formatDistance(a.totalLength);else var c=(c=A.widgets.directions.units[this.directionsLengthUnits])?
c.name:"",e=this.serviceDescription&&10.6<=this.serviceDescription.currentVersion,f=this.directions.features[0].attributes,b=b+(F.format(a.totalLength,{places:1})+"\x3cdiv class\x3d'esriImpedanceCostDist'\x3e"+c+"\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+(d.noTrafficCost&&e?"\x3cdiv class\x3d'esriTrafficLabel "+d.labelClass+"'\x3e"+d.label+"\x3c/div\x3e"+d.noTrafficCostStr:"")+this._formatTime(a.totalTime)+" "+("none"!==this.startTime&&d.noTrafficCost&&e?A.widgets.directions.atTheMoment+
" "+this._toSpatiallyLocalTimeString(f.arriveTimeUTC,f.ETA):""));b+="\x3c/div\x3e\x3c/div\x3e"}return b},_renderDirectionsTable:function(a){for(var b=0,d=0,c=0,e='\x3ctable summary\x3d"'+a.routeName+'"\x3e\x3ctbody role\x3d"menu"\x3e',f=0;f<a.features.length;f++){var g=a.features[f].attributes;"esriDMTDepart"===g.maneuverType&&(d=c=0);c+=g.length;d+=g.time;b+=g.time;e+=this._renderDirectionsItemTR(a.features[f],c,d,b)}return e+"\x3c/tbody\x3e\x3c/table\x3e"},_renderDirectionsItemTR:function(a,b,d,
c){var f=this.directions,g=f?e.indexOf(f.features,a):-1;c="";var k=this._css.routeClass,m=a._associatedStopWithReturnToStart&&a._associatedStopWithReturnToStart.attributes,n=a.attributes;if(-1<g){n&&(n.step=g+1);n.maneuverType&&(k+=" "+n.maneuverType);m&&null===m.ArriveCurbApproach&&null!==m.DepartCurbApproach?k+=" "+this._css.routeOriginClass:m&&null!==m.ArriveCurbApproach&&null===m.DepartCurbApproach&&(k+=" "+this._css.routeDestinationClass+" "+this._css.routeLastClass);c+='\x3ctr tabindex\x3d"0" role\x3d"menuitem" class\x3d"'+
k+" "+this._css.routeZoomClass+'" data-segment\x3d"'+g+'"\x3e';c+='\x3ctd class\x3d"'+this._css.routeIconColumnClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.routeIconClass+'"\x3e';c+=this._getLetter(a._associatedStop);c=c+"\x3c/div\x3e\x3c/td\x3e"+('\x3ctd class\x3d"'+this._css.routeTextColumnClass+'"\x3e');c+='\x3cdiv class\x3d"'+this._css.routeInfoClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.routeTextClass+'"\x3e';a=(f.strings[g]||[]).slice();if("esriDMTDepart"===n.maneuverType||"esriDMTStop"===
n.maneuverType)for(f=0;f<this.stops.length;f++)this.stops[f]&&this.stops[f].name&&a.push({string:this.stops[f].name});if(a){k=n.text;for(f=0;f<a.length;f++)k=this._boldText(k,a[f].string);n.formattedText=k}else n.formattedText=n.text;if("esriDMTStop"===n.maneuverType&&(b||d)||"esriDMTDepart"===n.maneuverType&&0===g)b=this._formatDistance(b-n.length,!0),d=this._formatTime(d-n.time),g=this._formatTime(n.time),a=this._formatDistance(n.length,!0),n.formattedText+="\x3cdiv class\x3d'esriRouteTextColumnCumulative'\x3e"+
b+(b&&d?" \x26middot; ":"")+d+(b||d?"\x3cbr\x3e":"")+(g?A.widgets.directions.serviceTime+":\x26nbsp;"+g:"")+(g&&a?"\x3cbr\x3e":"")+(a?A.widgets.directions.serviceDistance+":\x26nbsp;"+a:"")+"\x3c/div\x3e";c+="\x3cstrong\x3e"+F.format(n.step)+".\x3c/strong\x3e "+n.formattedText;c+="\x3c/div\x3e";b=this._formatDistance(n.length,!0);d=this._formatTime(n.time);"esriDMTStop"!==n.maneuverType&&"esriDMTDepart"!==n.maneuverType||!this.routeParams.startTime||-22091616E5===n.ETA?b&&(c+='\x3cdiv class\x3d"'+
this._css.routeLengthClass+'"\x3e',c+=b,d&&(c+="\x26nbsp;\x26middot;\x3cwbr\x3e\x26nbsp;"+d),c+="\x3c/div\x3e"):c+='\x3cdiv class\x3d"'+this._css.routeLengthClass+'"\x3e'+this._toSpatiallyLocalTimeString(n.arriveTimeUTC,n.ETA)+"\x3c/div\x3e";c+="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e"}return c},_toSpatiallyLocalTimeString:function(b,d){var c=new Date(d),e=new Date(c.getTime()+6E4*c.getTimezoneOffset()),e=a.date.locale.format(e,{selector:"time"}),f="";b?(d=(d-b)/1E3/60/60,b=Math.floor(d),d=60*(d-b),b=
A.widgets.directions.GMT+(0>b?"":"+")+F.format(b,{pattern:"00"})+F.format(d,{pattern:"00"}),f=e+" "+b):f="now"===this.startTime?a.date.locale.format(c,{selector:"time"}):e;return f},_addStopWrapperToGraphic:function(a,b){return{extent:new ba({xmin:a.geometry.x-.25,ymin:a.geometry.y-.25,xmax:a.geometry.x+.25,ymax:a.geometry.y+.25,spatialReference:a.geometry.spatialReference}),feature:a,name:b}},_clearBarriersGraphics:function(){this._barriersLayer.clear();this._polylineBarriersLayer.clear();this._polygonBarriersLayer.clear()},
_showBarriers:function(){this._clearBarriersGraphics();var a=this.routeParams,b=a.polylineBarriers&&a.polylineBarriers.features||[],d=a.polygonBarriers&&a.polygonBarriers.features||[];e.forEach(a.barriers&&a.barriers.features||[],h.hitch(this,function(a){this._barriersLayer.add(a)}));e.forEach(b,h.hitch(this,function(a){this._polylineBarriersLayer.add(a)}));e.forEach(d,h.hitch(this,function(a){this._polygonBarriersLayer.add(a)}));this._barriersLayer.refresh();this._polylineBarriersLayer.refresh();
this._polygonBarriersLayer.refresh()},_showRoute:function(a){this._clearDisplayAfterSolve();var b=a.routeResults[0].directions,d=new H;if(b){this.set("solveResult",a);this.set("directions",b);var c=a.routeResults[0].stops,e,f;if(c&&c.length){var g=[];for(e=0;e<c.length;e++){var k=c[e];k.attributes.isWaypoint=k.attributes.Name===this._waypointName||k.attributes.isWaypoint;k=this._addStopWrapperToGraphic(k,k.attributes.Name);this.stops[e]&&this.stops[e].feature&&this.stops[e].feature.attributes&&this.stops[e].feature.attributes.Name===
this._userDefinedStopName&&(k.feature.attributes.Name=this._userDefinedStopName);this._returnToStartStop&&this._returnToStartStop._resultsStopIndex===e?this._returnToStartStop=k:g.push(k)}if(this.stops.length>g.length)for(e=0;e<this.stops.length;e++)this.stops[e].feature||""!==this.stops[e].name||g.splice(e,0,this._emptyStop);this.stops=g;for(e=0;e<this.stops.length;e++)this._updateStop(this.stops[e],e);this._setStops();this._setMenuNodeValues()}this.set("mergedRouteGraphic",new Q(b.mergedGeometry,
this.get("routeSymbol")));c=[];g=[];for(e=k=0;e<b.featuresWithWaypoints.length;e++){var m=b.featuresWithWaypoints[e];if("esriDMTDepart"===m.attributes.maneuverType)for(f=0;f<this.stops.length;f++)if(this.stops[f].feature===m._associatedStop){k=f+1;break}m.setSymbol(this.get("routeSymbol"));this._routeLayer.add(m);c.push(m);(f=m.getDojoShape())&&f.moveToBack();f=new Q(m.geometry,this._symbolEventPaddingDirections,m.attributes);f._nextStopIndex=k-.5;f._isSnapFeature=!0;m._associatedSnapFeature=f;this._waypointsEventLayer.add(f);
"esriDMTDepart"!==m.attributes.maneuverType&&(f=m.geometry.getPoint(0,0))&&(f=new Q(f,this.maneuverSymbol),f._directionsFeature=m._associatedFeatureNoWaypoints,g.push(f),this._waypointsEventLayer.add(g[g.length-1]))}this.set("displayedRouteGraphics",c);this.set("displayedManeuverPointGraphics",g);this._renderDirections();for(e=0;e<this.stops.length;e++)if(this._isStopAWaypoint(this.stops[e])&&this._modifiedWaypointIndex===e){for(f=0;f<b.featuresWithWaypoints.length;f++)if(c=b.featuresWithWaypoints[f],
c._associatedStop===this.stops[e].feature){if("esriDMTStop"===c.attributes.maneuverType||"esriDMTDepart"===c.attributes.maneuverType)this.stops[e].feature.geometry.x=c.geometry.paths[0][0][0],this.stops[e].feature.geometry.y=c.geometry.paths[0][0][1];break}this._modifiedWaypointIndex=null;break}C.set(this._savePrintBtnContainer,"display","inline-block");this.onDirectionsFinish(a)}else a=a.routeResults[0].route,a.setSymbol(this.routeSymbol),this._routeLayer.add(a),this._incrementalRouteSegment=a;d.resolve();
this._moveLayersToFront();this.createRouteSymbols();return d.promise},_setGeocodersStopReference:function(){if(this.geocoders)for(var a=0;a<this.geocoders.length;a++)this.geocoders[a]&&this.stops[a]&&(this.geocoders[a]._stopReference=this.stops[a])},_setStops:function(){this._setGeocodersStopReference();this.createRouteSymbols();this._set("stops",this.stops);this.onStopsUpdate(this.stops)},_getCandidates:function(a){var b=[];if(a&&a.length){for(var d=0;d<a.length;d++)b.push(this._getCandidate(a[d]));
return K(b)}a=new H;a.resolve([]);return a.promise},_clearResultsHTML:function(){this._resultsNode.innerHTML="";C.set(this._savePrintBtnContainer,"display","none")},_showSegmentPopup:function(a){if(a&&this.get("showSegmentPopup")&&this.get("map").infoWindow){var b=a.geometry.getPoint(0,0);a=new Q(b,null,a.attributes,this.get("segmentInfoTemplate"));var d=this.get("map").infoWindow;d.setFeatures([a]);d.show(b)}},_addStopButton:function(){this.addStop().then(h.hitch(this,function(){this.get("focusOnNewStop")&&
this.geocoders[this.stops.length-1].focus()}))},_sortGeocoders:function(){var a=this._dnd.getAllNodes();this.geocoders.sort(h.hitch(this,function(b,d){return b.domNode&&b.domNode.parentNode&&b.domNode.parentNode.parentNode&&d.domNode&&d.domNode.parentNode&&d.domNode.parentNode.parentNode?e.indexOf(a,b.domNode.parentNode.parentNode)>e.indexOf(a,d.domNode.parentNode.parentNode)?1:-1:0}));this.stops.length===this.geocoders.length&&this._sortStops();for(var b=0;b<this.geocoders.length;b++)this.geocoders[b]&&
this.geocoders[b].inputNode&&(this.geocoders[b].inputNode.title=A.widgets.directions.stopNoTitle+(b+1));this._setLocateButtonVisibilityEvents()},_disconnectResults:function(){if(this._resultEvents&&this._resultEvents.length)for(var a=0;a<this._resultEvents.length;a++)this._resultEvents[a]&&this._resultEvents[a].remove();this._resultEvents=[]},_formatArbitraryCostsForRouteTooltip:function(a){var b="",d;for(d in a)if(0===d.indexOf("Total_")&&a.hasOwnProperty(d)){var c=this._getCostAttribute(d.substr(6));
c&&(b+=this._isTimeUnits(c.units)?this._formatTime(a[d],!1,c.units):this._formatDistance(a[d],!0,c.units),b+=b?" \x26middot; ":"")}b&&(b=A.widgets.directions.toNearbyStops+": \x3cb\x3e"+b.substr(0,b.length-10)+"\x3c/b\x3e");return b},_formatTime:function(a,b,d){d||(d=(this._getDirectionsTimeAttribute()||{}).units);var c="";d=Math.round(this._convertCostValue(a,d,"esriNAUMinutes"));a=Math.floor(d/60);d=Math.floor(d%60);b?c=F.format(a,{pattern:100>a?"00":"000"})+":"+F.format(d,{pattern:"00"}):(a&&(c+=
a+" "+A.widgets.directions.time.hr+" "),c+=a||d?d+" "+A.widgets.directions.time.min:"");return c},_formatDistance:function(a,b,d){d||(d=this.directionsLengthUnits);var c=this.directionsLengthUnits,e=A.widgets.directions.units[c],f=c.replace("esri","").toLowerCase();a=this._convertCostValue(a,d,c);e&&(f=b?e.abbr:e.name);return a?F.format(a,{locale:"root",places:2})+" "+f:""},_createToolbars:function(){this.editToolbar||(this.editToolbar=new ra(this.map));this.drawToolbar||(this.drawToolbar=new sa(this.map),
A.toolbars.draw.freehand=A.widgets.directions.lineBarrierFreehand,this.drawToolbar.onDrawComplete=h.hitch(this,function(a){var b=new Q(a.geometry,null,{BarrierType:0});1<ca.geodesicLengths([a.geographicGeometry],U.METERS)[0]&&(this._polylineBarriersLayer.add(b),this.routeParams.polylineBarriers||(this.routeParams.polylineBarriers=new ka),this.routeParams.polylineBarriers.features.push(b),this._clearStopsStatusAttr(),this.getDirections(!0))}))},_destroyGlobalGeocoder:function(){this._globalGeocoder&&
(this._globalGeocoder.destroy(),this._globalGeocoder=null)},_createGlobalGeocoder:function(){var a=new H;this._globalGeocoder=new N(this.get("searchOptions"));u.once(this._globalGeocoder,"load",a.resolve,a.reject);this._globalGeocoder.startup();return a.promise},_init:function(){var a=new H;this.set("loaded",!1);this._enableButton(this._getDirectionsButtonNode,!1);C.set(this._saveAsButton,"display","none");this.clearMessages();if(this.get("map").loaded)this._configure().always(a.resolve);else u.once(this.get("map"),
"load",h.hitch(this,function(){this._configure().always(a.resolve)}));return a.promise},_setDefaultStops:function(){var a=new H;this.defaults.stops&&this.defaults.stops.length?this._updateStops(this.defaults.stops).then(h.hitch(this,function(){this._removeEmptyStops();a.resolve()}),a.reject):a.resolve();return a.promise},_configure:function(){var b=new H;this._handle&&this._handle._remove();this._createDnD();this._createDepartAtControls();this._setSearchOptions();this._createGlobalGeocoder().then(h.hitch(this,
function(){this._createToolbars();this._usingAGOL()||(this.printTaskUrl=this.geometryTaskUrl=null);this._createGeometryTask();this._createPrintTask();this._showActivateButton();this._showBarriersButton();this._createTravelModesDDL();this._createSearchSourceDDL();var d=[this._createRouteTask(),this._setDefaultStops()];K(d).then(h.hitch(this,function(){this._setDefaultUnits();this._setTrafficOptions();this._setMenuNodeValues();this._setupEvents();var d=this.directionsLanguage||this.userOptions.routeParams&&
this.userOptions.routeParams.directionsLanguage||a.locale.toLowerCase();this._setDirectionsLanguageByLocale(d);this._setupTravelModes().then(h.hitch(this,function(){this.set("loaded",!0);this.onLoad();b.resolve(!0)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}),function(a){b.reject(a)});this._naRouteSharing=null;return b.promise},_setDirectionsLanguageByLocale:function(a){var b=this.serviceDescription.directionsSupportedLanguages,d=function(a){if(b)for(var d=0;d<b.length;d++)if(b[d].toLowerCase().substr(0,
2)===a)return b[d];return null},c=d(a);c||(a=a.substr(0,2),c=d(a));this.directionsLanguage=c;return this.routeParams.directionsLanguage=c},_getStopSymbol:function(a,b){var d=a&&(a.feature&&a.feature.attributes||a.attributes),c=this.stopSymbol;d&&(c=this._isStopAWaypoint(a)?this.waypointSymbol:void 0===d.Status||0===d.Status||6===d.Status?null===d.ArriveCurbApproach&&null!==d.DepartCurbApproach?this.get(b?"fromSymbolDrag":"fromSymbol"):null!==d.ArriveCurbApproach&&null===d.DepartCurbApproach?this.get(b?
"toSymbolDrag":"toSymbol"):this.get(b?"stopSymbolDrag":"stopSymbol"):this.get(b?"unreachedSymbolDrag":"unreachedSymbol"));return c},_addTrafficLayer:function(){this.trafficLayer&&!this._trafficLayerAdded&&this.map&&(this.map.addLayer(this.trafficLayer),this.trafficLayer.show(),this._trafficLayerAdded=!0)},_toggleUnits:function(a){a.target===this._useMilesNode?this.setDirectionsLengthUnits(U.MILES):a.target===this._useKilometersNode&&this.setDirectionsLengthUnits(U.KILOMETERS)},_toggleCheckbox:function(a){var b=
B.get(a.target,"checked");a.target===this._findOptimalOrderNode?this.set("optimalRoute",b):a.target===this._useTrafficNode?this.set("traffic",b):a.target===this._returnToStartNode&&this.set("returnToStart",b)},_isStopLocated:function(a){return a&&a.feature&&a.feature.attributes&&(!a.feature.attributes.Status||6===a.feature.attributes.Status)},_configureRouteOptions:function(){var a=this.get("routeParams"),b;this.get("directionsLengthUnits")?a.directionsLengthUnits=this.get("directionsLengthUnits"):
this.set("directionsLengthUnits",a.directionsLengthUnits);a.findBestSequence=this.get("optimalRoute");if(a.findBestSequence)for(a.preserveFirstStop=this._isStopLocated(this.stops[0]),a.preserveLastStop=!this.returnToStart&&this._isStopLocated(this.stops[this.stops.length-1])||this.returnToStart&&this._isStopLocated(this.stops[0]),b=0;b<this.stops.length;)this._isStopAWaypoint(this.stops[b])?this._removeStop(b,!0,!0):b++;if(!this.returnToStart&&this.stops.length&&this._isStopAWaypoint(this.stops[this.stops.length-
1]))for(b=this.stops.length-1;0<b;)this._isStopAWaypoint(this.stops[b])&&this._removeStop(b,!0,!0),b--;if(this._isTimeUnits(this._getImpedanceAttribute().units)||this.serviceDescription&&10.6<=this.serviceDescription.currentVersion)if(a.useTimeWindows=!0,"now"===this.startTime)a.timeWindowsAreUTC=!0,a.startTimeIsUTC=!0,a.startTime=new Date;else if("none"===this.startTime)a.startTime=null;else{a.timeWindowsAreUTC=!1;a.startTimeIsUTC=!1;var d=this._departAtTime,c=6E4*d.getValue().getTimezoneOffset(),
d=new Date(d.getValue().getTime()+this._departAtDate.getValue().getTime()-c),d=new Date(d.getTime()-6E4*d.getTimezoneOffset());a.startTime=d}else a.startTime=null,a.useTimeWindows=!1;var d=this._getImpedanceAttribute(),c=this._getTimeNeutralAttribute(),f=this._getDirectionsTimeAttribute();b=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames;c&&-1===e.indexOf(b,c.name)&&b.push(c.name);!this._isTimeUnits(d.units)&&this.serviceDescription&&10.6<=this.serviceDescription.currentVersion&&
f&&-1===e.indexOf(b,f.name)&&b.push(f.name);this.routeParams.accumulateAttributes=b;a.returnStops=!0;f=[];for(b=0;b<this.stopGraphics.length;b++)if(this.stopGraphics[b]&&(f.push(new Q(this.stopGraphics[b].toJson())),b)){var g=f[0].attributes,k=f[b].attributes,m;for(m in k)k.hasOwnProperty(m)&&!g.hasOwnProperty(m)&&(g[m]=null)}this.get("returnToStart")&&this.stopGraphics.length&&this._isStopLocated(this.stops[0])?(m=new Q(this.stopGraphics[0].toJson()),this._returnToStartStop=this._addStopWrapperToGraphic(m,
m.attributes.Name),f.push(m)):this._returnToStartStop=null;a.stops.features=f;if(c)for(b=0;b<f.length;b++)f[b].attributes["Attr_"+c.name]=this._convertCostValue(f[b].attributes["Attr_"+d.name],d.units,c.units);this.set("routeParams",a)},_configureRoute:function(){var a=new H;a.promise.always(h.hitch(this,function(){this._checkMaxStops()}));this.createRouteSymbols();this._configureRouteOptions();if(this.routeParams.returnRoutes&&this._incrementalSolveStopRange){var b=this._incrementalSolveStopRange;
b.start<b.end?this.routeParams.stops.features=this.routeParams.stops.features.slice(b.start,b.end+1):b.start>b.end&&(this.routeParams.stops.features=this.routeParams.stops.features.slice(b.start,this.routeParams.stops.features.length-1).concat(this.routeParams.stops.features.slice(0,b.end+1)))}else this._incrementalSolveStopRange=null;for(var d={},c=this.routeParams.stops.features,e,f,b=0;b<c.length;b++)f=c[b].attributes.address,e=(b===this._handle._index&&!this._handle.attributes.isWaypoint&&this._incrementalSolveStopRange?
this._waypointName:f)+"_"+this._stopSequence++,c[b].attributes.Name=e,d[e]=f,delete c[b].attributes.address,delete c[b].attributes.isWaypoint,delete c[b].attributes.Status;this._solveInProgress=!0;var g={_incrementalSolveStopRange:this._incrementalSolveStopRange};this.routeTask.solve(this.routeParams,h.hitch(this,function(b){this._solveResultProcessing(b,d,g).then(a.resolve,a.reject)}),h.hitch(this,function(b){h.mixin(this,g);this._solveInProgress=!1;for(var d=0;d<this.stops.length;d++)this.stops[d].feature&&
(this.stops[d].feature.attributes=h.mixin(this.stops[d].feature.attributes,{Status:5}));this.set("directions",null);this._clearDisplayAfterSolve();this.createRouteSymbols();this._routeTaskError(b);a.reject(b)}));return a.promise},_solveResultProcessing:function(a,b,d){var c=new H;h.mixin(this,d);this._solveInProgress=!1;d=a.routeResults[0];var e=d.directions;d=d.stops;var f;if(e){this._solverMessages=a.messages;var g=function(a){for(var d in b)if(a&&0===e.routeName.indexOf(d)||!a&&0<e.routeName.indexOf(d))return b[d];
return""};f=g(!0);g=g(!1);e.routeName=(f!==this._waypointName?f:A.widgets.directions.waypoint)+" \u2014 "+(g!==this._waypointName?g:A.widgets.directions.waypoint);for(f=0;f<e.features.length;f++)if(g=e.features[f].attributes,"esriDMTDepart"===g.maneuverType||"esriDMTStop"===g.maneuverType)for(var k in b)if(b.hasOwnProperty(k)&&-1<g.text.indexOf(k)){g.text=g.text.replace(k,b[k]);for(var m=0;m<d.length;m++){var n=d[m].attributes;if(n.Name===k){h.mixin(e.features[f],{_associatedStop:d[this.returnToStart&&
m===d.length-1?0:m],_associatedStopWithReturnToStart:d[m]});if(!n.ArriveTime&&!n.ArriveTimeUTC&&g.ETA&&g.arriveTimeUTC){n.ArriveTime=g.ETA;n.ArriveTimeUTC=g.arriveTimeUTC;m=0;if(0==f&&"esriDMTDepart"===g.maneuverType||0<f&&"esriDMTStop"===g.maneuverType)m=this._convertCostValue(g.time,(this._getDirectionsTimeAttribute()||{}).units,"milliseconds");n.DepartTime=n.ArriveTime+m;n.DepartTimeUTC=n.ArriveTimeUTC+m}break}}}for(f=0;f<d.length;f++)this._returnToStartStop&&d[f].attributes.Name===this._returnToStartStop.feature.attributes.Name&&
(this._returnToStartStop._resultsStopIndex=f),d[f].attributes.Name=b[d[f].attributes.Name];this._directionsPostprocessing(e);this.traffic&&this._updateMapTimeExtent()}this._showRoute(a).always(h.hitch(this,function(){this._incrementalSolveStopRange=null;c.resolve(a)}));return c.promise},_directionsPostprocessing:function(a){var b,d,c=function(b,d){var c=a.features[b]._associatedFeaturesWithWaypoints||[];c.push(a.featuresWithWaypoints[d]);a.features[b]._associatedFeaturesWithWaypoints=c;a.featuresWithWaypoints[d]._associatedFeatureNoWaypoints=
a.features[b]};d=h.hitch(this,function(a){return"\x3cdiv class\x3d'"+this.theme+"'\x3e\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a._associatedFeatureNoWaypoints)+"\x3c/table\x3e\x3c/div\x3e"});a.featuresWithWaypoints=[];for(b=0;b<a.features.length;b++){var e=new Q(a.features[b].toJson());e.setInfoTemplate(new G({title:this._i18n.widgets.directions.maneuver,content:d}));a.featuresWithWaypoints.push(e);a.featuresWithWaypoints[b]._associatedStop=a.features[b]._associatedStop;
a.featuresWithWaypoints[b]._associatedStopWithReturnToStart=a.features[b]._associatedStopWithReturnToStart}a.stringsWithWaypoints=h.mixin([],a.strings);a.eventsWithWaypoints=h.mixin([],a.events);for(d=b=0;b<a.features.length;)a.features[b]._associatedStop&&a.features[b]._associatedStop.attributes.Name===this._waypointName?(a.features.splice(b,b?2:1),a.strings.splice(b,b?2:1),a.events.splice(b,b?2:1),b&&a.features[b]&&"esriDMTStraight"===a.features[b].attributes.maneuverType?(e=a.features.splice(b,
1)[0],a.strings[b-1]=(a.strings[b-1]||[]).concat(a.strings.splice(b,1)[0]||[]),a.strings[b-1].length||(a.strings[b-1]=void 0),a.events[b-1]=(a.events[b-1]||[]).concat(a.events.splice(b,1)[0]||[]),a.events[b-1].length||(a.events[b-1]=void 0),a.features[b-1].attributes.length+=e.attributes.length,a.features[b-1].attributes.time+=e.attributes.time,a.features[b-1].geometry.paths[0]=a.features[b-1].geometry.paths[0].concat(e.geometry.paths[0]),c(b-1,d++),c(b-1,d++),c(b-1,d++)):(b&&c(b-1,d++),b<a.features.length&&
c(b,d++))):(c(b,d++),b++)},_boldText:function(a,b){try{var d=new RegExp("[^\x3cstrong\x3e\x26nbsp;]"+b.replace(/(\||\$|\^|\(|\)|\[|\]|\{|\}|\/|\.|\+|\*|\?|\?)/g,"\\$1")+"[^\x26nbsp;\x3c/strong\x3e]","g");a=(" "+a+" ").replace(d,"\x3cstrong\x3e\x26nbsp;"+b+"\x26nbsp;\x3c/strong\x3e");a=a.trim()}catch(ya){}return a},_clearStopGraphics:function(){if(this.stopGraphics&&this.stopGraphics.length)for(var a=0;a<this.stopGraphics.length;a++)this._stopLayer.remove(this.stopGraphics[a]),this._stopLayer.remove(this.textGraphics[a]);
this.set("stopGraphics",[]);this.set("textGraphics",[])},_updateMapTimeExtent:function(){if(this.map){var a=this.directions&&this.directions.features[0]&&this.directions.features[0].attributes||{},b=(new Date).getTime(),b="none"==this.startTime?b:a.arriveTimeUTC||b;this._useTrafficItemNode.title="none"!==this.startTime&&a.arriveTimeUTC?A.widgets.directions.trafficLabelDepartAt+": "+this._toSpatiallyLocalTimeString(a.arriveTimeUTC,a.ETA):"";this._myTimeExtentUpdate=!0;a=new Date(b);this.map.setTimeExtent(new S(a,
a))}},_restoreMapTimeExtent:function(){this.map&&(this._myTimeExtentUpdate=!0,this.map.setTimeExtent(this._externalTimeExtent))},_clearRouteGraphics:function(){for(var a=this.displayedRouteGraphics,b=this.displayedManeuverPointGraphics,d=this._routeLayer,c=this._waypointsEventLayer,f=0,g=0,k=this._incrementalSolveStopRange?this._incrementalSolveStopRange:{start:0,end:this.stops?this.stops.length:-1};a&&g<a.length;){if(a[g]._associatedStop)for(var m=0;m<this.stops.length;m++)if(this.stops[m].feature===
a[g]._associatedStop){f=m;break}f>=k.start&&f<k.end||k.start>=k.end&&(f>=k.start||f<k.end)?(d.remove(a[g]),a.splice(g,1)):g++}d.remove(this._incrementalRouteSegment);this.set("displayedRouteGraphics",a?a:[]);b&&b.length&&e.forEach(b,function(a){c.remove(a)});this.set("displayedManeuverPointGraphics",[]);this._waypointsEventLayer.clear();this.unhighlightSegment(!0)},_clearInfoWindow:function(){var a=this.get("map").infoWindow;a&&(a.hide(),a.clearFeatures())},_clearDisplayBeforeSolve:function(){this._toggleSaveMenu(!1);
this._clearInfoWindow();this._clearResultsHTML()},_clearDisplayAfterSolve:function(){this._clearStopGraphics();this._clearRouteGraphics();this._clearBarriersGraphics();this.clearMessages()},_getLetter:function(a){var b=this.alphabet,d="",c=function(a){var d="";"0123456789"===b||"1234567890"===b?d=String(a+1):(a=a||0,a>=b.length&&(d=c(Math.floor(a/b.length)-1),a%=b.length),d+=b[a]);return d},e=a instanceof Q?h.hitch(this,function(){for(var b=this.get("returnToStart")?0:-1,d=0;d<this.stops.length;d++)if(this.stops[d].feature===
a){b=d;break}return b})():a;if(-1<e&&b&&b.length){b instanceof Array&&(b=b.toString().replace(/,/g,""));for(var d=-1,f=0;f<=e;f++)d+=this._isStopAWaypoint(this.stops[f])?0:1;d=c(d)}return d},_solveAndZoom:function(a){if(this.autoSolve)return this._getDirections().then(h.hitch(this,function(){a||this.zoomToFullRoute()}));var b=new H;b.resolve();return b.promise},_setupEvents:function(){this._onEvents.push(u(this.domNode,"[data-blur-on-click]:click",function(){this.blur()}));this._onEvents.push(u(this._dndNode,
"[data-reverse-stops]:click, [data-reverse-stops]:keydown",h.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&this.modifyStopSequence()})));this._onEvents.push(u(this._printButton,"click, keydown",h.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&this._printDirections()})));this._onEvents.push(u(this._resultsNode,"[data-full-route]:click, [data-full-route]:keydown",h.hitch(this,function(a){a&&("click"===a.type||"keydown"===
a.type&&a.keyCode===r.ENTER)&&this.zoomToFullRoute()})));this._onEvents.push(u(this._dndNode,"[data-remove]:click, [data-remove]:keydown",h.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)){var b=z("[data-remove]",this._dndNode);a=e.indexOf(b,a.target);this.removeStop(a)}})));this._onEvents.push(u(this._dndNode,"[data-center-at]:click, [data-center-at]:keydown",h.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)){var b=
z("[data-center-at]",this._dndNode);a=e.indexOf(b,a.target);this.stops[a]&&this.stops[a].feature&&this.stops[a].feature.geometry&&this.map.centerAndZoom(this.stops[a].feature.geometry)}})));this._onEvents.push(u(this.map,"zoom-end",h.hitch(this,function(){var a=this._segmentGraphics;a&&a[0]&&void 0!==a[0].attributes._index&&this.highlightSegment(a[0].attributes._index,!0)})));this._onEvents.push(u(this._dnd,"Drop",h.hitch(this,function(){this._dnd.sync();this.set("optimalRoute",!1);var a,b,d=!1,c=
[],f=this._dnd.getAllNodes();for(a=0;a<this.geocoders.length;a++)if(b=e.indexOf(f,this.geocoders[a]._tr),-1<b&&a!==b&&a!==b-1){for(;0<b&&this._isStopAWaypoint(this.stops[b]);)b--;d=!0;break}d&&(c=this._markWPsForRemovalAfterUserChangedStopSequence(a,b));this._sortGeocoders();this.setListIcons();this._removeSomeWaypoints(c);this.stops[b].name&&this.getDirections()})));this._onEvents.push(u(this._dnd,"DndStart",h.hitch(this,function(){var a=z("body")[0];x.add(a,this._css.dndDragBodyClass);this._removeLocateButtonVisibilityEvents()})));
this._onEvents.push(u(this._dnd,"DndDrop, DndCancel",h.hitch(this,function(){var a=z("body")[0];x.remove(a,this._css.dndDragBodyClass);this._setLocateButtonVisibilityEvents()})));var a=this._handle,b=h.hitch(this,function(b){var d=h.hitch(this,function(d,c,e,f,g){var k=a._isShown();a.setGeometry(d);a._tooltip.style.left=b.screenPoint.x+"px";a._tooltip.style.top=b.screenPoint.y+"px";!k||a._index===e&&a.attributes.isWaypoint===f||(a._remove(),k=!1);a.setSymbol(c);a._index=e;a._isStopIcon=a._index===
Math.floor(a._index);a.attributes.isWaypoint=f;a._isStopIcon&&(a.attributes.address=this.stopGraphics[e].attributes.address,a.setInfoTemplate(this.stopGraphics[e].infoTemplate));if(this.canModifyWaypoints||a._isStopIcon)k||(this._stopLayer.add(a),(d=a.getDojoShape())&&d[f?"moveToBack":"moveToFront"].call(d)),this.editToolbar.activate(ra.MOVE,a);f=f?a._isStopIcon?A.widgets.directions.dragWaypoint:this.canModifyWaypoints?A.widgets.directions.dragRoute:"":A.widgets.directions.dragStop;a._showTooltip(g||
f)});this.unhighlightSegment();if(this.mapClickActive&&this.dragging&&!this._solveInProgress&&!this._moveInProgress&&!a._solveTimeout)if(clearTimeout(a._removeTimeout),(b.graphic._isStopIcon||b.graphic._isStopLabel)&&!b.graphic.attributes.isWaypoint&&this.canModifyStops||b.graphic._isStopIcon&&b.graphic.attributes.isWaypoint&&this.canModifyWaypoints){var c=b.graphic._isStopLabel?this.stopGraphics[b.graphic._index]:b.graphic;d(c.geometry,this._getStopSymbol(this.stops[c._index],!0),c._index,!0===c.attributes.isWaypoint);
this._stopLayer.remove(this.stopGraphics[c._index]);this._stopLayer.remove(this.textGraphics[c._index])}else if(b.graphic._isSnapFeature||b.graphic._isHandle&&!b.graphic._isStopIcon)this._snappingManager||(this._snappingManager=this.map.snappingManager),this._snappingManager.getSnappingPoint(b.screenPoint).then(h.hitch(this,function(c){if(!this.maxStopsReached&&!this._moveInProgress&&c){for(var f=this.displayedManeuverPointGraphics,g=null,k=0;k<f.length;k++)if(f[k].geometry.x===c.x&&f[k].geometry.y===
c.y){g=f[k]._directionsFeature;f=e.indexOf(this.directions.features,g);-1<f&&this.highlightSegment(f);break}d(c,b.graphic._isHandle?a.symbol:this.waypointSymbol,b.graphic._isHandle?a._index:b.graphic._nextStopIndex,b.graphic._isHandle?a.attributes.isWaypoint:!0,g)}}))}),d=h.hitch(this,function(){clearTimeout(a._removeTimeout);a._removeTimeout=setTimeout(a._remove,100);this.unhighlightSegment()}),c=h.hitch(this,function(a){if(this.barrierToolActive){a=a.graphic;var b=this.routeParams,d=b.barriers?
e.indexOf(b.barriers.features,a):-1,c=b.polygonBarriers?e.indexOf(b.polygonBarriers.features,a):-1,f=b.polylineBarriers?e.indexOf(b.polylineBarriers.features,a):-1;-1<d&&b.barriers.features.splice(d,1);-1<c&&b.polygonBarriers.features.splice(c,1);-1<f&&b.polylineBarriers.features.splice(f,1);this._barriersLayer.remove(a);this._polygonBarriersLayer.remove(a);this._polylineBarriersLayer.remove(a);this._clearStopsStatusAttr();this.getDirections(!0)}});this._onEvents.push(this._waypointsEventLayer.on("mouse-move",
b));this._onEvents.push(this._waypointsEventLayer.on("mouse-out",d));this._onEvents.push(this._stopLayer.on("mouse-move",b));this._onEvents.push(this._stopLayer.on("mouse-out",d));this._onEvents.push(this._barriersLayer.on("click",c));this._onEvents.push(this._polylineBarriersLayer.on("click",c));this._onEvents.push(this._polygonBarriersLayer.on("click",c));this._editToolbarEvents();this._watchEvents.push(this.watch("theme",this._updateThemeWatch));this._watchEvents.push(this.watch("canModifyStops",
this._updateCanModifyStops));this._watchEvents.push(this.watch("canModifyWaypoints",this._updateCanAddWaypoints));this._watchEvents.push(this.watch("showReturnToStartOption",this._optionsMenu));this._watchEvents.push(this.watch("showOptimalRouteOption",this._optionsMenu));this._watchEvents.push(this.watch("returnToStart",this._setMenuNodeValues));this._watchEvents.push(this.watch("optimalRoute",this._setMenuNodeValues));this._watchEvents.push(this.watch("startTime",this._setStartTime));this._watchEvents.push(this.watch("traffic",
this._setMenuNodeValues));this._watchEvents.push(this.watch("trafficLayer",this._trafficLayerUpdate));this._watchEvents.push(this.watch("routeTaskUrl",h.hitch(this,function(){this._createRouteTask();this._setTrafficOptions()})));this._watchEvents.push(this.watch("printTaskUrl",h.hitch(this,function(){this._createPrintTask()})));this._watchEvents.push(this.watch("geometryTaskUrl",h.hitch(this,function(){this._createGeometryTask()})));this._watchEvents.push(this.watch("routeParams",h.hitch(this,function(){this._createRouteParams();
this._setDefaultUnits()})));this._watchEvents.push(this.watch("searchOptions",h.hitch(this,function(){this._setSearchOptions();this._createGlobalGeocoder();var a=this.get("searchOptions").sources;if(a)for(var b=0;b<this.geocoders.length;b++)this.geocoders[b].set("sources",a)})));this._watchEvents.push(this.watch("showReverseStopsButton",this.setListIcons));this._watchEvents.push(this.watch("editToolbar",this._editToolbarEvents));this._watchEvents.push(this.watch("showTravelModesOption",this._showTravelModesOption));
this._watchEvents.push(this.watch("showMilesKilometersOption",this._showMilesKilometersOption));this._watchEvents.push(this.watch("showClearButton",this._showClearButton));this._watchEvents.push(this.watch("directionsLengthUnits",this.setDirectionsLengthUnits));this._watchEvents.push(this.watch("directionsLanguage",this.setDirectionsLanguage));this._watchEvents.push(this.watch("mapClickActive",this._activate));this._watchEvents.push(this.watch("barrierToolActive",this._activateBarrierTool));this._watchEvents.push(this.watch("showActivateButton",
this._showActivateButton));this._watchEvents.push(this.watch("showBarriersButton",this._showBarriersButton));this._watchEvents.push(this.watch("showPrintPage",function(){C.set(this._printButton,"display",this.showPrintPage?"inline-block":"none")}));this._watchEvents.push(this.watch("showSaveButton",function(){C.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none")}))},_editToolbarEvents:function(){var a=h.hitch(this,function(a){var b="";if((a=a.routeResults?
a.routeResults[0]:null)&&a.route){a=a.route.attributes;var d=this.routeParams.travelMode;if(d)var b=b+("\x3cb\x3e"+d.name+"\x3c/b\x3e "+A.widgets.directions.toNearbyStops+": "),c=void 0!==a["Total_"+d.timeAttributeName]?this._formatTime(a["Total_"+d.timeAttributeName],!1,(this._getCostAttribute(d.timeAttributeName)||{}).units):"",b=b+((void 0!==a["Total_"+d.distanceAttributeName]?this._formatDistance(a["Total_"+d.distanceAttributeName],!0,(this._getCostAttribute(d.distanceAttributeName)||{}).units):
"")+(c?" \x26middot; "+c:""));else b=this._formatArbitraryCostsForRouteTooltip(a)}this._handle._showTooltip(b)}),b=h.hitch(this,function(d,c){var e=new H,f=this._handle,g=this.map.toScreen(f._origPoint).offset(d.transform.dx+f.symbol.xoffset,d.transform.dy+f.symbol.yoffset);d.origMapPoint||(d.origMapPoint=this.map.toMap(g));C.set(f._tooltip,"left",g.x+"px");C.set(f._tooltip,"top",g.y+"px");clearTimeout(f._solveTimeout);if(this._solveInProgress||!this._requestQueueTail.isFulfilled())f._solveTimeout=
setTimeout(function(){b(d,c).always(e.resolve)},100);else if(f._isStopIcon){var g=d.graphic._index,k=this.stops[g];(k=k?{name:k.name,extent:k.extent,feature:new Q(k.feature.toJson())}:null)?(k.feature.setGeometry(d.origMapPoint),this._modifiedWaypointIndex=this._isStopAWaypoint(this.stops[g])?g:null,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+g-1)%this.stops.length:Math.max(0,g-1),end:this.returnToStart?(g+1)%this.stops.length:Math.min(this.stops.length-1,g+1)},this.updateStop(k,
g,c).always(h.hitch(this,function(b){f._solveTimeout=null;b.routeResults&&a(b);e.resolve()}))):e.resolve()}else e.resolve();return e.promise});this._onEvents.push(u(this.editToolbar,"graphic-click",h.hitch(this,function(a){if(a.graphic.attributes.isWaypoint)!a.graphic._isStopIcon||this._moveInProgress||this._solveInProgress||(this._handle._remove(),this._moveInProgress=!0,this.removeStop(a.graphic._index,!0).always(h.hitch(this,function(){this._moveInProgress=!1})));else{var b=this.get("map").infoWindow;
b&&(b.setFeatures([a.graphic]),b.show(a.graphic.geometry))}})));this._onEvents.push(u(this.editToolbar,"graphic-move-start",h.hitch(this,function(a){this._blurGeocoders();this._moveInProgress=!0;this._removeEmptyStops();this.routeParams.returnDirections=!1;this.routeParams.returnRoutes=!0;a=a.graphic;a._origPoint=new aa(a.geometry.toJson());a._maxDeviation=0;a._solveHasHappened=!1;this.map.disableMapNavigation()})));this._onEvents.push(u(this.editToolbar,"graphic-move-stop",h.hitch(this,function(a){this.map.enableMapNavigation();
this.routeParams.returnDirections=!0;this.routeParams.returnRoutes=!1;if(this._handle._isStopIcon)if(this._handle._solveHasHappened)if(this._handle.attributes.isWaypoint)b(a,!0).always(h.hitch(this,function(){this._moveInProgress=!1;this._handle._isStopIcon=!0;this._handle._remove();this._showLoadingSpinner()}));else{clearTimeout(this._handle._solveTimeout);this._handle._solveTimeout=null;var d=this.stops[a.graphic._index],c=(d&&d.feature&&d.feature.attributes&&d.feature.attributes.Name)===this._userDefinedStopName,
e=d&&d.name;this._reverseGeocode(new Q(a.graphic.toJson())).then(h.hitch(this,function(b){c&&(b.name=e,b.feature.attributes.Name=this._userDefinedStopName);this._setReverseGeocode(b,b.feature.geometry,a.graphic._index).always(h.hitch(this,function(){this._moveInProgress=!1;this._handle._remove();this._showLoadingSpinner()}))}))}else this._moveInProgress=!1;else this._moveInProgress=!1})));this._onEvents.push(u(this.editToolbar,"graphic-move",h.hitch(this,function(a){var d=this._handle,c=a.transform;
c.dx&&c.dy&&(a.graphic._maxDeviation=Math.max(d._maxDeviation,Math.sqrt(c.dx*c.dx+c.dy*c.dy)));10<d._maxDeviation&&(d._solveHasHappened=!0,a.graphic===d&&d.attributes.isWaypoint&&!d._isStopIcon?(this.set("optimalRoute",!1),d._index+=.5,d._isStopIcon=!0,a.graphic._stopIndex=d._index,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+d._index-1)%this.stops.length:Math.max(0,d._index-1),end:this.returnToStart?(d._index+1)%(this.stops.length+1):Math.min(this.stops.length,d._index+
1)},this.addStop({name:this._waypointName,feature:new Q(d.geometry,d.symbol,{isWaypoint:!0,CurbApproach:3})},a.graphic._stopIndex)):((d=a.graphic.getDojoShape())&&d.moveToFront(),b(a)))})))},_isStopAWaypoint:function(a){return a&&a.feature&&a.feature.attributes&&a.feature.attributes.isWaypoint},_getStopCount:function(){var a=0,b;for(b=0;b<this.stops.length;b++)a+=!this._isStopAWaypoint(this.stops[b])&&this.stops[b].name?1:0;return a},_getWaypointCount:function(){var a=0,b;for(b=0;b<this.stops.length;b++)a+=
this._isStopAWaypoint(this.stops[b])?1:0;return a},_decorateUngeocodedStop:function(a){var b=new H,d=function(d,c){b.resolve({name:void 0===d?A.widgets.directions.unlocatedStop:d.toFixed(6)+" "+c.toFixed(6),feature:a})};if(a.geometry)if(a.geometry.spatialReference&&4326!==a.geometry.spatialReference.wkid)if(this.map&&this.map.spatialReference&&this.map.spatialReference.isWebMercator()){var c=X.xyToLngLat(a.geometry.x,a.geometry.y);d(c[0],c[1])}else this._geometryService?(c=new ua,c.outSR=new T(4326),
c.geometries=[a.geometry],this._geometryService.project(c).then(h.hitch(this,function(b){b&&b.length?d(b[0].x,b[0].y):d(a.geometry.x,a.geometry.y)}),h.hitch(this,function(){d()}))):d(a.geometry.x,a.geometry.y);else d(a.geometry.x,a.geometry.y);else d();return b.promise},_trafficLayerUpdate:function(a,b,d){a=this.get("map");b&&this._trafficLayerAdded&&(a.removeLayer(b),this._trafficLayerAdded=!1);d&&this.get("traffic")&&!this._trafficLayerAdded&&(a.addLayer(d),d.show(),this._trafficLayerAdded=!0)},
_routeTaskError:function(a){var b=A.widgets.directions.error.routeTask,d=a.details,c=function(a){return(res=a.match(/(\d+)/))?": "+res[0]:"."};d&&1===d.length&&("The distance between any inputs must be less than 50 miles (80 kilometers) when walking."===d[0]?b=A.widgets.directions.error.maxWalkingDistance:"Driving a truck is currently not supported outside of North America and Central America."===d[0]?b=A.widgets.directions.error.nonNAmTruckingMode:0===d[0].indexOf("The number of input locations loaded into Barriers")?
b=A.widgets.directions.error.tooManyBarriers+c(d[0]):0===d[0].indexOf("The number of input locations loaded into PolygonBarriers")?b=A.widgets.directions.error.tooManyPolygonBarriers+c(d[0]):0===d[0].indexOf("The number of input locations loaded into PolylineBarriers")&&(b=A.widgets.directions.error.tooManyPolylineBarriers+c(d[0])));this._showMessage(b);this.onDirectionsFinish(a)},_showMessage:function(a,b){var d="";this.messages.push({msg:a,error:!b});if(this.messages.length){for(var d=d+"\x3cul\x3e",
c=0;c<this.messages.length;c++)d+='\x3cli class\x3d"'+(this.messages[c].error?this._css.routesErrorClass:this._css.routesInfoClass)+'"\x3e'+this.messages[c].msg+"\x3c/li\x3e";d+="\x3c/ul\x3e"}this._msgNode&&(this._msgNode.innerHTML=d);if(!b)this.onError(a)},_isTimeUnits:function(a){return"milliseconds"===a||"esriNAUSeconds"===a||"esriNAUMinutes"===a||"esriNAUHours"===a||"esriNAUDays"===a},_getImpedanceAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&
this.routeParams.travelMode.impedanceAttributeName||this.routeParams.impedanceAttribute||this.serviceDescription.impedance)},_getDirectionsTimeAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.timeAttributeName||this.routeParams.directionsTimeAttribute||this.serviceDescription.directionsTimeAttribute)},_getTimeNeutralAttribute:function(){var a=(this._getDirectionsTimeAttribute()||{}).timeNeutralAttributeName;return this._getCostAttribute(a)},
_getCostAttribute:function(a){for(var b=this.serviceDescription&&this.serviceDescription.networkDataset.networkAttributes||[],d,c=0;c<b.length;c++)if(b[c].name===a&&"esriNAUTCost"===b[c].usageType){d=b[c];break}return d},_convertCostValue:function(a,b,d){var c=this._isTimeUnits(b),e=this._isTimeUnits(d);b=c?this._toMinutes(a,b):this._toMeters(a,b);return c===e?e?this._fromMinutes(b,d):this._fromMeters(b,d):a},_toMinutes:function(a,b,d){a=a||0;switch(b){case "milliseconds":a/=Math.pow(6E4,d?-1:1);
break;case "esriNAUSeconds":a/=Math.pow(60,d?-1:1);break;case "esriNAUHours":a*=Math.pow(60,d?-1:1);break;case "esriNAUDays":a*=Math.pow(1440,d?-1:1)}return a},_fromMinutes:function(a,b){return this._toMinutes(a,b,!0)},_toMeters:function(a,b,d){a=a||0;switch((b||"").replace("esriNAU","esri")){case "esriInches":a*=Math.pow(.0254,d?-1:1);break;case "esriFeet":a*=Math.pow(.3048,d?-1:1);break;case "esriYards":a*=Math.pow(.9144,d?-1:1);break;case "esriMiles":a*=Math.pow(1609.344,d?-1:1);break;case "esriNauticalMiles":a*=
Math.pow(1851.995396854,d?-1:1);break;case "esriMillimeters":a/=Math.pow(1E3,d?-1:1);break;case "esriCentimeters":a/=Math.pow(100,d?-1:1);break;case "esriKilometers":a*=Math.pow(1E3,d?-1:1);break;case "esriDecimeters":a/=Math.pow(10,d?-1:1)}return a},_fromMeters:function(a,b){return this._toMeters(a,b,!0)},_createRouteTask:function(){var a=new H;this.set("routeTask",new ja(this.get("routeTaskUrl")));this._createRouteParams();this.routeTask.getServiceDescription(this.travelModesServiceUrl,this.doNotFetchTravelModesFromOwningSystem).then(h.hitch(this,
function(b){b.networkDataset?(this.set("serviceDescription",b),this.set("maxStops",parseInt(this.userOptions.maxStops||b.serviceLimits&&b.serviceLimits.Route_MaxStops||this.defaults.maxStops)),this.defaults.portalUrl?(this.owningSystemUrl=this.defaults.portalUrl,a.resolve()):this.routeTask.getOwningSystemUrl().then(h.hitch(this,function(b){this.owningSystemUrl=b;a.resolve()}),a.reject)):(this._showMessage(A.widgets.directions.error.cantFindRouteServiceDescription),a.reject(Error(A.widgets.directions.error.cantFindRouteServiceDescription)))}),
h.hitch(this,function(){this._showMessage(A.widgets.directions.error.cantFindRouteServiceDescription);a.reject(Error(A.widgets.directions.error.cantFindRouteServiceDescription));this.mapClickActive=!1;this._activate()}));return a.promise},_createSearchSourceDDL:function(){if(this._globalGeocoder&&this._globalGeocoder.sources&&1<this._globalGeocoder.sources.length){var a=h.hitch(this,function(a){this._searchSourceSelector.domNode.blur();this._globalGeocoder.set("activeSourceIndex",a);for(var b=0;b<
this.geocoders.length;b++)this.geocoders[b].set("activeSourceIndex",a)});if(!this._searchSourceSelector){for(var b=[{value:"all",label:A.widgets.Search.main.all,selected:!0}],d=0;d<this._globalGeocoder.sources.length;d++)b.push({value:String(d),label:this._globalGeocoder.sources[d].name});this._searchSourceSelector=new g({className:"esriSearchSourcesDDL",style:"width:100%;",options:b},this._searchSourceSelectorContainer);this._searchSourceSelector.startup();this._searchSourceSelector.on("change",
a);this._searchSourceSelector.domNode.style.width=""}a("all")}else 2>this._globalGeocoder.sources.length&&(this._searchSourceContainerNode.style.display="none")},_createTravelModesDDL:function(){this._travelModeSelector||(this._travelModeSelector=new g({className:"esriTravelModesDDL",style:"width:100%;"},this._travelModeSelectorContainer),this._travelModeSelector.startup(),this._travelModeSelector._interractive=!0,this._travelModeSelector.on("change",h.hitch(this,function(a){this._travelModeSelector._interractive?
this._enqueue(function(){return this._setTravelMode(a).always(h.hitch(this,function(){this._travelModeSelector._interractive=!0}))}):this._travelModeSelector._interractive=!0})))},_setupTravelModes:function(){var a=this.get("serviceDescription"),b=a.supportedTravelModes,d=new H;if(b&&b.length&&this._travelModeSelector){for(var c=b[0].name,e=[],f=0;f<b.length;f++){for(var g="AUTOMOBILE"===b[f].type?"Driving":"TRUCK"===b[f].type?"Trucking":"WALK"===b[f].type?"Walking":"Other",k="",m=a.networkDataset.networkAttributes,
p=0;p<m.length;p++){var D=m[p];if(D.name===b[f].impedanceAttributeName){if("esriNAUCentimeters"===D.units||"esriNAUDecimalDegrees"===D.units||"esriNAUDecimeters"===D.units||"esriNAUFeet"===D.units||"esriNAUInches"===D.units||"esriNAUKilometers"===D.units||"esriNAUMeters"===D.units||"esriNAUMiles"===D.units||"esriNAUMillimeters"===D.units||"esriNAUNauticalMiles"===D.units||"esriNAUYards"===D.units)k="Distance";else if("esriNAUDays"===D.units||"esriNAUHours"===D.units||"esriNAUMinutes"===D.units||"esriNAUSeconds"===
D.units)k="Time";break}}e.push({id:b[f].name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+g+k+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName" title\x3d"'+b[f].description+'"\x3e'+b[f].name+"\x3c/div\x3e"});!a.defaultTravelMode||b[f].id!==a.defaultTravelMode&&b[f].itemId!==a.defaultTravelMode||(c=b[f].name)}this._showTravelModesOption();this._travelModeSelector.setStore(new n({objectStore:new q({data:e})}));this._travelModeSelector._interractive=
!1;this._travelModeSelector.setValue(c);this._setTravelMode(c).always(d.resolve)}else this._checkStartTimeUIAvailability(),this.set("showTravelModesOption",!1),d.resolve();return d.promise},_createPrintTask:function(){this._printService=(this.printTaskUrl=this._usingAGOL()?this.printTaskUrl:this.defaults.printTaskUrl)?new na(this.printTaskUrl,{async:!1}):null;var a=new P;a.exportOptions={width:670,height:750,dpi:96};a.format="PNG32";a.layout="MAP_ONLY";a.preserveScale=!1;a.showAttribution=!1;var b=
new fa;b.map=this.map;b.outSpatialReference=this.map.spatialReference;b.template=a;this._printParams=b},_createGeometryTask:function(){this._geometryService=null;this._usingAGOL()?this._geometryService=new la(this.geometryTaskUrl):this.geometryTaskUrl=(this._geometryService=this.defaults.geometryTaskUrl?new la(this.defaults.geometryTaskUrl):ta.defaults.geometryService)?this._geometryService.url:null},_showTravelModesOption:function(){var a=this.get("serviceDescription");C.set(this._travelModeContainerNode,
"display",this.showTravelModesOption&&a&&a.supportedTravelModes&&a.supportedTravelModes.length&&!this.doNotFetchTravelModesFromOwningSystem?"block":"none")},_showMilesKilometersOption:function(){C.set(this._agolDistanceUnitsNode,"display",this.showMilesKilometersOption?"block":"none")},_showClearButton:function(){C.set(this._clearDirectionsButtonNode,"display",this.showClearButton?"inline-block":"none")},_showActivateButton:function(){C.set(this._activateButtonNode,"display",this.showActivateButton?
"inline-block":"none");this.showActivateButton||this.deactivate()},_showBarriersButton:function(){C.set(this._lineBarrierButtonNode,"display",this.showBarriersButton?"inline-block":"none");this.showBarriersButton||this.deactivateBarrierTool()},_createRouteParams:function(){var a={returnDirections:!0,returnRoutes:!1,outputLines:"esriNAOutputLineTrueShape",preserveFirstStop:!0,preserveLastStop:!0,directionsOutputType:"complete",stops:new ka,ignoreInvalidLocations:!0,doNotLocateOnRestrictedElements:!0,
outSpatialReference:this.get("map").spatialReference};this.get("routeParams")||(this.routeParams={});var b=new pa;this.routeParams=h.mixin(b,{outputGeometryPrecision:0,outputGeometryPrecisionUnits:"esriMeters",restrictUTurns:"esriNFSBAtDeadEndsOnly"},this.get("routeParams"),a)},_markWPsForRemovalAfterUserChangedStopSequence:function(a,b){for(var d=a-1,c=[];0<=d&&this._isStopAWaypoint(this.stops[d]);)c.push(this.stops[d]),d--;for(d=a+1;d<this.stops.length&&this._isStopAWaypoint(this.stops[d]);)c.push(this.stops[d]),
d++;if(b>a)for(d=b+1;d<this.stops.length&&this._isStopAWaypoint(this.stops[d]);)c.push(this.stops[d]),d++;else if(void 0!==b)for(d=b-1;0<=d&&this._isStopAWaypoint(this.stops[d]);)c.push(this.stops[d]),d--;else if(this.returnToStart&&0===a)for(d=this.stops.length-1;0<=d&&this._isStopAWaypoint(this.stops[d]);)c.push(this.stops[d]),d--;return c},_removeSomeWaypoints:function(a){for(var b=new H,d=[],c=0;c<a.length;c++){var f=e.indexOf(this.stops,a[c]);-1<f&&d.push(this._removeStop(f,!0,!0))}K(d).always(b.resolve);
return b.promise},_modifyStopSequence:function(a,b){var d=this._dnd.getAllNodes(),c=new H,e,f=[];if(d.length)if(this._removeLocateButtonVisibilityEvents(),arguments.length&&void 0!==a)if(0<=a&&0<=b&&a<this.stops.length&&b<this.stops.length&&a!==b){var d=this._markWPsForRemovalAfterUserChangedStopSequence(a,b),g=this.stops.splice(a,1);this.stops.splice(b,0,g[0]);for(e=0;e<this.stops.length;e++)f.push(this._updateStop(this.stops[e],e));f.push(this._removeSomeWaypoints(d));K(f).always(h.hitch(this,function(){this._solveAndZoom().always(c.resolve)}))}else c.reject("Invalid From and To values.");
else{for(e=0;e<this.stops.length;)this._isStopAWaypoint(this.stops[e])?f.push(this._removeStop(e,!0,!0)):e++;K(f).always(h.hitch(this,function(){f=[];this.stops.reverse();for(e=0;e<this.stops.length;e++)f.push(this._updateStop(this.stops[e],e));K(f).always(h.hitch(this,function(){this._solveAndZoom().always(c.resolve)}))}))}else c.resolve();return c.promise},_setMenuNodeValues:function(a){"traffic"!==a&&this._clearDisplayBeforeSolve();a=this.get("optimalRoute");this._findOptimalOrderNode&&B.set(this._findOptimalOrderNode,
"checked",a);this._returnToStartNode&&(a=this.returnToStart&&!this.maxStopsReached&&this.stops[0]&&(!this.stops[0].feature||this._isStopLocated(this.stops[0])),B.set(this._returnToStartNode,"checked",a),this.set("returnToStart",a),this.maxStopsReached&&this.returnToStart&&this._showMessage(A.widgets.directions.error.maximumStops));if(!this.returnToStart&&!this._incrementalSolveStopRange&&this.directions)for(this._incrementalSolveStopRange={start:this.stops.length-1,end:this.stops.length},this._clearRouteGraphics(),
this._incrementalSolveStopRange=null,a=this.stops.length;0<a--&&this._isStopAWaypoint(this.stops[a]);)this._removeSomeWaypoints([this.stops[a]]);this._useTrafficNode&&(B.set(this._useTrafficNode,"checked",this.traffic),this.traffic?(this._updateMapTimeExtent(),this._addTrafficLayer()):(this._removeTrafficLayer(),this._restoreMapTimeExtent()));switch(this.get("directionsLengthUnits")){case U.KILOMETERS:B.set(this._useKilometersNode,"checked",!0);B.set(this._useMilesNode,"checked",!1);break;case U.MILES:B.set(this._useKilometersNode,
"checked",!1),B.set(this._useMilesNode,"checked",!0)}C.set(this._printButton,"display",this.showPrintPage?"inline-block":"none");C.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none");this._showMilesKilometersOption();this._showClearButton()},_optionsMenu:function(){this._useTrafficItemNode&&C.set(this._useTrafficItemNode,"display",this.get("showTrafficOption")?"block":"none");this._returnToStartItemNode&&C.set(this._returnToStartItemNode,"display",this.get("showReturnToStartOption")?
"block":"none");this._findOptimalOrderItemNode&&C.set(this._findOptimalOrderItemNode,"display",this.get("showOptimalRouteOption")&&3<this._getStopCount()?"block":"none");this.stops.length>=this.get("minStops")?x.add(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass):(x.remove(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass),this._optionsMenuNode&&"block"===C.get(this._optionsMenuNode,"display")&&this._toggleOptionsMenu())},_stopsRemovable:function(){2<this._dnd.getAllNodes().length-
this._getWaypointCount()?x.add(this._widgetContainer,this._css.stopsRemovableClass):x.remove(this._widgetContainer,this._css.stopsRemovableClass)},_checkMaxStops:function(){this.set("maxStopsReached",this._getStopCount()+this._getWaypointCount()+(this.returnToStart?1:0)>=this.maxStops);this._showAddDestination()},_updateThemeWatch:function(a,b,d){x.remove(this.domNode,b);x.add(this.domNode,d)},_toggleOptionsMenu:function(){"block"===C.get(this._optionsMenuNode,"display")?(C.set(this._optionsMenuNode,
"display","none"),x.remove(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=A.widgets.directions.showOptions):(C.set(this._optionsMenuNode,"display","block"),x.add(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=A.widgets.directions.hideOptions)},_toggleSaveMenu:function(a){"block"===C.get(this._saveMenuNode,"display")||!1===a?(C.set(this._saveMenuNode,"display","none"),x.remove(this._saveMenuButton,this._css.stopsPressedButtonClass)):
(this.clearMessages(),C.set(this._saveMenuNode,"display","block"),x.add(this._saveMenuButton,this._css.stopsPressedButtonClass),this._enableSharing().then(h.hitch(this,function(){this._outputLayer.setValue(this.routeLayer.title?this.routeLayer.title:this.directions&&this.directions.routeName);if(this.routeLayer.ownerFolder)for(var a=this._folderSelector.store.objectStore.data,b=0;b<a.length;b++)if(a[b].folderId===this.routeLayer.ownerFolder){this._folderSelector.getValue()!==a[b].id&&(this._folderSelector._interractive=
!1,this._folderSelector.setValue(a[b].id));break}this._enableButton(this._saveButton,this.routeLayer.isItemOwner||!this._userCanCreatePortalItem);this._outputLayer.set("disabled",!1)})))},_showToolbar:function(){x[this.stops.length<this.maxStops&&this.canModifyStops||this.canModifyWaypoints?"add":"remove"].call(O,this._widgetContainer,this._css.addStopsClass)},_showAddDestination:function(){this._showToolbar();this._addDestinationNode.style.display=this.stops.length<this.maxStops&&this.canModifyStops?
"inline":"none"},_showMapClickActiveButton:function(){this._showToolbar();this._activateButtonNode.style.display=this.canModifyStops||this.canModifyWaypoints?"inline-block":"none"},_getAbsoluteUrl:function(a){a=c.toUrl(a);return/^https?\:/i.test(a)?a:/^\/\//i.test(a)?oa+a:/^\//i.test(a)?oa+"//"+window.location.host+a:a},_getManeuverImage:function(a){return a?"esriDMTStop"===a||"esriDMTDepart"===a?"":this._getAbsoluteUrl("./images/Directions/maneuvers/"+a+".png"):""},_loadPrintDirections:function(a){var b=
this.get("printTemplate"),d=new H;this.directionsLengthUnits!==this.routeParams.directionsLengthUnits?this.getDirections().then(d.resolve,d.reject):d.resolve();d.then(h.hitch(this,function(){if(!b&&this.directions){var d=this._getAbsoluteUrl("./css/Directions.css"),c=this._getAbsoluteUrl("./css/DirectionsPrint.css"),e=this._getAbsoluteUrl("./images/Directions/print-logo.png"),f;f=y.isBodyLtr()?"ltr":"rtl";b="";b+="\x3c!DOCTYPE HTML\x3e";b+='\x3chtml lang\x3d"en" class\x3d"'+this.get("theme")+'" dir\x3d"'+
f+'"\x3e';b+="\x3chead\x3e";b+='\x3cmeta charset\x3d"utf-8"\x3e';b+='\x3cmeta http-equiv\x3d"X-UA-Compatible" content\x3d"IE\x3dEdge,chrome\x3d1"\x3e';b+="\x3ctitle\x3e"+this.get("directions").routeName+"\x3c/title\x3e";b+='\x3clink rel\x3d"stylesheet" media\x3d"screen" type\x3d"text/css" href\x3d"'+d+'" /\x3e';b+='\x3clink rel\x3d"stylesheet" media\x3d"print" type\x3d"text/css" href\x3d"'+c+'" /\x3e';b+="\x3c/head\x3e";b+='\x3cbody class\x3d"'+this._css.esriPrintPageClass+'"\x3e';b+='\x3cdiv class\x3d"'+
this._css.esriPrintBarClass+'"\x3e';b+='\x3cdiv class\x3d"'+this._css.esriCloseButtonClass+'" title\x3d"'+A.common.close+'" onclick\x3d"window.close();"\x3e'+A.common.close+"\x3c/div\x3e";b+='\x3cdiv id\x3d"printButton" class\x3d"'+this._css.esriPrintButtonClass+'" title\x3d"'+A.widgets.directions.print+'" onclick\x3d"window.print();"\x3e'+A.widgets.directions.print+"\x3c/div\x3e";b+="\x3c/div\x3e";b+='\x3cdiv class\x3d"'+this._css.esriPrintMainClass+'"\x3e';b+='\x3cdiv class\x3d"'+this._css.esriPrintHeaderClass+
'"\x3e';b+='\x3cimg class\x3d"'+this._css.esriPrintLogoClass+'" src\x3d"'+e+'" /\x3e';b+='\x3cdiv class\x3d"'+this._css.esriPrintNameClass+'"\x3e'+this.get("directions").routeName+"\x3c/div\x3e";b+=this._renderDirectionsSummary(this.directions);a&&(b+='\x3cdiv id\x3d"divMap" class\x3d"esriPrintMap esriPrintWait"\x3e\x3c/div\x3e',b+='\x3chr class\x3d"esriNoPrint"/\x3e');b+='\x3cdiv id\x3d"print_helper"\x3e\x3c/div\x3e';b+='\x3ctextarea onkeyup\x3d"document.getElementById(\'print_helper\').innerHTML\x3dthis.value;" id\x3d"print_area" class\x3d"'+
this._css.esriPrintNotesClass+'" placeholder\x3d"'+A.widgets.directions.printNotes+'"\x3e\x3c/textarea\x3e';b+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';b+="\x3c/div\x3e";b+='\x3cdiv class\x3d"'+this._css.esriPrintDirectionsClass+'"\x3e';b+=this._renderDirectionsTable(this.directions);b+="\x3c/div\x3e";b+='\x3cdiv class\x3d"'+this._css.esriPrintFooterClass+'"\x3e';b+="\x3cp\x3e"+A.widgets.directions.printDisclaimer+"\x3c/p\x3e";b+="\x3c/div\x3e";b+="\x3c/div\x3e";b+="\x3c/body\x3e";
b+="\x3c/html\x3e"}this._printWindow.document.open("text/html","replace");this._printWindow.document.write(b);this._printWindow.document.close()}))},_printDirections:function(){if(this.directions){var a=screen.width/2,b=screen.height/1.5,a="toolbar\x3dno, location\x3dno, directories\x3dno, status\x3dyes, menubar\x3dno, scrollbars\x3dyes, resizable\x3dyes, width\x3d"+a+", height\x3d"+b+", top\x3d"+(screen.height/2-b/2)+", left\x3d"+(screen.width/2-a/2);this.get("printPage")?(window.directions=this.get("directions"),
window.open(this.get("printPage"),"directions_widget_print",a,!0)):(this._printWindow=window.open("","directions_widget_print",a,!0),this._loadPrintDirections(!!this._printService),this._printService&&c(["dojo/_base/window"],h.hitch(this,function(a){this.zoomToFullRoute().then(h.hitch(this,function(){this._printService.execute(this._printParams,h.hitch(this,function(b){a.withDoc(this._printWindow.document,function(){var a=t.byId("divMap");a&&(x.remove(a,"esriPrintWait"),x.add(a,"esriPageBreak"),O.create("img",
{src:b.url,"class":"esriPrintMapImg"},a))})}),h.hitch(this,function(b){a.withDoc(this._printWindow.document,function(){var a=t.byId("divMap");a&&x.remove(a,"esriPrintWait")})}))}))})))}},_enableButton:function(a,b){b=b||void 0===b;x[b?"remove":"add"].apply(this,[a,"esriDisabledDirectionsButton"]);a._enabled=b},_clearStopsStatusAttr:function(){for(var a=0;a<this.stops.length;a++)this.stops[a].feature&&this.stops[a].feature.attributes&&(this.stops[a].feature.attributes.Status=void 0)},_enableSharing:function(){var a=
new H;!this._naRouteSharing&&this.owningSystemUrl?c(["../tasks/NARouteSharing"],h.hitch(this,function(b){this._naRouteSharing=new b(this.owningSystemUrl,this.map.spatialReference);this._folderSelector||(this._folderSelector=new g({className:"esriFoldersDDL",style:"width: 100%;",sortByLabel:!1,disabled:!0,_interractive:!0,onChange:h.hitch(this,function(){this._folderSelector._interractive?this._enableButton(this._saveButton,!this.routeLayer.itemId):this._folderSelector._interractive=!0})},this._folderSelectorContainer),
this._folderSelector.startup(),this._outputLayer=new k({style:"width: 100%",required:!0,trim:!0,regExp:'[^\x26|\x3c|\x3e|%|#|?|\\|"|/|+]+',maxLength:98,disabled:!0,onKeyPress:h.hitch(this,function(){this._enableButton(this._saveButton,!this.routeLayer.itemId||!this._userCanCreatePortalItem)}),onFocus:h.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),onBlur:h.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()})},this._outputLayerContainer),this._outputLayer.startup());
this._naRouteSharing.getFolders().then(h.hitch(this,function(b){for(var d=[],c=0;c<b.length;c++)d.push({id:b[c].url,folderId:b[c].id,label:b[c].title});this._folderSelector.setStore(new n({objectStore:new q({data:d})}));this._naRouteSharing.canCreateItem().then(h.hitch(this,function(a){this._folderSelector.set("disabled",!a);this._userCanCreatePortalItem=a}));this._enableButton(this._saveButton);a.resolve()}),h.hitch(this,function(b){this._naRouteSharing=null;this._toggleSaveMenu(!1);a.reject(b)}))})):
this.owningSystemUrl?a.resolve():(a.reject(Error("Owning system is not defined, or the Directions widget is not done initializing.")),this._naRouteSharing=null);return a.promise},_storeRouteUI:function(){var a=new H;this._outputLayer&&this._outputLayer.isValid()?this._storeRoute(this._outputLayer.getValue(),this._folderSelector.getValue(),this._folderSelector.store.objectStore.get(this._folderSelector.getValue()).folderId).then(a.resolve,a.reject):(this._outputLayer&&this._outputLayer.focus(),a.reject(Error("Need result layer name specified.")));
return a.promise},_storeRoute:function(a,b,d){var c=new H,f=this.directions;if(this._savingRoute||!this._naRouteSharing)return this._saveButton.blur(),c.reject(Error("Not ready to store route.")),c.promise;this.clearMessages();c.then(null,h.hitch(this,function(a){this._showMessage(A.widgets.directions.error.cantSaveRoute)}));c.promise.always(h.hitch(this,function(){this._enableButton(this._saveButton);C.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":
"none");this._showLoadingSpinner();this._savingRoute=!1}));if(f&&f.features&&f.features.length&&this.stops&&this.stops.length)if(this.owningSystemUrl)if(this.routeParams&&this.routeParams.travelMode)if(a&&b){var g,k;g=h.hitch(this,function(a){return this._naRouteSharing.getAttributeUnits(a,this.serviceDescription)});k=this.routeParams.travelMode.timeAttributeName;var m=this.routeParams.travelMode.distanceAttributeName,n=g(k),p=g(m),D=this.routeParams.directionsLengthUnits||this.serviceDescription.directionsLengthUnits,
q=this._naRouteSharing.toMeters,r=this._naRouteSharing.toMinutes,t=function(a,b,d){var c,f;for(f in a)a.hasOwnProperty(f)&&0===f.indexOf(b)&&-1===e.indexOf(d,f.substr(b.length))&&(c=c||{},c[f.substr(b.length)]=a[f]);return c},v=[],l=[],u=[],I;if(k&&n&&m&&p){var w=[],F=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames||[],y=this.serviceDescription.networkDataset.networkAttributes;for(g=0;g<y.length;g++)"esriNAUTCost"===y[g].usageType&&-1===e.indexOf(F,y[g].name)&&
y[g].name!==k&&y[g].name!==m&&w.push(y[g].name);var F=this.get("stops"),z={xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity};for(g=0;g<F.length;g++)if(F[g].feature&&F[g].feature.toJson){y=F[g].feature.toJson();I=y.attributes;var x=y.geometry,X=this._naRouteSharing.getUTCOffset(I.ArriveTime,I.ArriveTimeUTC),P=this._naRouteSharing.getUTCOffset(I.DepartTime,I.DepartTimeUTC);h.mixin(z,{xmin:z.xmin>x.x?x.x:z.xmin,ymin:z.ymin>x.y?x.y:z.ymin,xmax:z.xmax<x.x?x.x:z.xmax,ymax:z.ymax<x.y?x.y:z.ymax});
y.attributes={__OBJECTID:g+1,CurbApproach:I.CurbApproach,ArrivalCurbApproach:I.ArriveCurbApproach,DepartureCurbApproach:I.DepartCurbApproach,Name:I.Name===this._waypointName?A.widgets.directions.waypoint:I.Name===this._userDefinedStopName?F[g].name:I.Name,RouteName:f.routeName,Sequence:I.Sequence,Status:I.Status,LocationType:I.isWaypoint?1:0,TimeWindowStart:I.TimeWindowStart,TimeWindowEnd:I.TimeWindowEnd,TimeWindowStartUTCOffset:X,TimeWindowEndUTCOffset:X,ServiceMinutes:r(I["Attr_"+k],n),ServiceMeters:q(I["Attr_"+
m],p),ServiceCosts:L.stringify(t(I,"Attr_",w)),CumulativeMinutes:r(I["Cumul_"+k],n),CumulativeMeters:q(I["Cumul_"+m],p),CumulativeCosts:L.stringify(t(I,"Cumul_",w)),LateMinutes:r(I["Violation_"+k],n),WaitMinutes:r(I["Wait_"+k],n),ArrivalTime:this._naRouteSharing.toUTCTime(I.ArriveTime,X),DepartureTime:this._naRouteSharing.toUTCTime(I.DepartTime,P),ArrivalUTCOffset:X,DepartureUTCOffset:P};v.push(y)}m=0;p=function(a){try{a.strings=L.parse(a.strings)}catch(za){ba.strings=void 0}if(a.strings&&a.strings.length)for(var b=
0;b<a.strings.length;b++)if("esriDSTGeneral"===a.strings[b].stringType)return a.strings[b].string};F=function(a,b){for(var d=[],c=0;c<(a||[]).length;c++)a[c].stringType!==b&&b||d.push(a[c].string);return d.length?d.toString():void 0};y=function(a){switch(a){case "esriDMTStop":return"esriDPTManeuverArrive";case "esriDMTDepart":return"esriDPTManeuverDepart";case "esriDMTDoorPassage":return"esriDPTManeuverDoor";case "esriDMTBearLeft":return"esriDPTManeuverBearLeft";case "esriDMTBearRight":return"esriDPTManeuverBearRight";
case "esriDMTElevator":return"esriDPTManeuverElevator";case "esriDMTEscalator":return"esriDPTManeuverEscalator";case "esriDMTFerry":return"esriDPTManeuverFerryOn";case "esriDMTEndOfFerry":return"esriDPTManeuverFerryOff";case "esriDMTForkCenter":return"esriDPTManeuverForkCenter";case "esriDMTForkLeft":return"esriDPTManeuverForkLeft";case "esriDMTForkRight":return"esriDPTManeuverForkRight";case "esriDMTPedestrianRamp":return"esriDPTManeuverPedestrianRamp";case "esriDMTRampLeft":return"esriDPTManeuverRampLeft";
case "esriDMTRampRight":return"esriDPTManeuverRampRight";case "esriDMTRoundabout":return"esriDPTManeuverRoundabout";case "esriDMTTurnLeft":return"esriDPTManeuverTurnLeft";case "esriDMTLeftLeft":return"esriDPTManeuverTurnLeftLeft";case "esriDMTLeftRight":return"esriDPTManeuverTurnLeftRight";case "esriDMTTurnRight":return"esriDPTManeuverTurnRight";case "esriDMTRightLeft":return"esriDPTManeuverTurnRightLeft";case "esriDMTRightRight":return"esriDPTManeuverTurnRightRight";case "esriDMTSharpLeft":return"esriDPTManeuverSharpLeft";
case "esriDMTSharpRight":return"esriDPTManeuverSharpRight";case "esriDMTStraight":return"esriDPTManeuverStraight";case "esriDMTStrairs":return"esriDPTManeuverStairs";case "esriDMTUTurn":return"esriDPTManeuverUTurn"}return"esriDPTUnknown"};for(g=0;g<f.featuresWithWaypoints.length;g++){var B=f.featuresWithWaypoints[g],x=B.toJson(),X=x.attributes,P=x.geometry&&x.geometry.paths&&x.geometry.paths[0]||[],T=x.geometry.hasM||!1||P[0]&&3===P[0].length;I=this._naRouteSharing.getUTCOffset(X.ETA,X.arriveTimeUTC);
x.attributes={__OBJECTID:g+1,Sequence:++m,StopID:function(){var a=void 0,b=B._associatedStopWithReturnToStart&&B._associatedStopWithReturnToStart.attributes.Sequence;if(b)for(var d=0;d<v.length;d++)if(v[d].attributes.Sequence===b){a=v[d].attributes.__OBJECTID;break}return a}(),DirectionPointType:y(X.maneuverType),DisplayText:B._associatedStopWithReturnToStart&&B._associatedStopWithReturnToStart.attributes.isWaypoint?X.text.replace(this._waypointName,A.widgets.directions.waypoint):X.text,ArrivalTime:this._naRouteSharing.toUTCTime(X.ETA,
I),ArrivalUTCOffset:I,Azimuth:void 0,Name:F(f.stringsWithWaypoints[g],"esriDSTStreetName"),AlternateName:F(f.stringsWithWaypoints[g],"esriDSTAltName"),ExitName:F(f.stringsWithWaypoints[g],"esriDSTExit"),IntersectingName:F(f.stringsWithWaypoints[g],"esriDSTCrossStreet"),BranchName:F(f.stringsWithWaypoints[g],"esriDSTBranch"),TowardName:F(f.stringsWithWaypoints[g],"esriDSTToward"),ShortVoiceInstruction:void 0,VoiceInstruction:void 0,Level:void 0};delete x.symbol;delete x.infoTemplate;P.length?(x.geometry=
{x:P[0][0],y:P[0][1],spatialReference:x.geometry.spatialReference},T&&h.mixin(x.geometry,{m:P[0][2]})):delete x.geometry;l.push(x);x=B.toJson();X=x.attributes;P=x.geometry&&x.geometry.paths&&x.geometry.paths[0]||[];I=!0;for(k=0;k<P.length-1;k++)if(P[k][0]!==P[k+1][0]||P[k][1]!==P[k+1][1]){I=!1;break}I||(x.attributes={DirectionPointID:g+1,DirectionLineType:"esriDLTSegment",Meters:q(X.length,D),Minutes:r(X.time,n),FromLevel:void 0,ToLevel:void 0},x.geometry.hasM=T,delete x.symbol,delete x.infoTemplate,
u.push(x));var ba=f.eventsWithWaypoints[x.attributes.Sequence]||[];for(k=0;k<ba.length;k++)x=ba[k].toJson(),X=x.attributes,I=this._naRouteSharing.getUTCOffset(X.ETA,X.arriveTimeUTC),x.attributes={Sequence:++m,DirectionPointType:"esriDPTEvent",DisplayText:p(X),ArrivalTime:this._naRouteSharing.toUTCTime(X.ETA,I),ArrivalUTCOffset:I,Name:X.strings},l.push(x)}k=this.routeParams.barriers&&this.routeParams.barriers.features||[];var ra=[];for(g=0;g<k.length;g++)m=k[g].toJson(),p=m.attributes,m.attributes=
{BarrierType:p.BarrierType||0,FullEdge:p.FullEdge||!1,AddedCost:p["Attr_"+this._getImpedanceAttribute().name]||0,Costs:L.stringify(t(p,"Attr_",w)),CurbApproach:p.CurbApproach||0,Name:p.Name},ra.push(m);k=this.routeParams.polylineBarriers&&this.routeParams.polylineBarriers.features||[];var ca=[];for(g=0;g<k.length;g++)m=k[g].toJson(),p=m.attributes,m.attributes={BarrierType:p.BarrierType||0,ScaleFactor:p["Attr_"+this._getImpedanceAttribute().name]||1,Costs:L.stringify(t(p,"Attr_",w)),Name:p.Name},
ca.push(m);k=this.routeParams.polygonBarriers&&this.routeParams.polygonBarriers.features||[];var E=[];for(g=0;g<k.length;g++)m=k[g].toJson(),p=m.attributes,m.attributes={BarrierType:p.BarrierType||0,ScaleFactor:p["Attr_"+this._getImpedanceAttribute().name]||1,Costs:L.stringify(t(p,"Attr_",w)),Name:p.Name},E.push(m);var W={geometry:f.mergedGeometry,attributes:{RouteName:f.routeName,TotalMinutes:r(f.totalTime,n),TotalMeters:q(f.totalLength,D),TotalLateMinutes:function(){for(var a=0,b=0;b<v.length;b++)a+=
v[b].attributes.LateMinutes||0;return a}(),TotalWaitMinutes:function(){for(var a=0,b=0;b<v.length;b++)a+=v[b].attributes.WaitMinutes||0;return a}(),TotalCosts:v[v.length-1].attributes.CumulativeCosts,StartTime:"none"!==this.startTime?v[0].attributes.ArrivalTime:null,EndTime:"none"!==this.startTime?v[v.length-1].attributes.DepartureTime:null,StartUTCOffset:v[0].attributes.ArrivalUTCOffset,EndUTCOffset:v[v.length-1].attributes.DepartureUTCOffset,Messages:L.stringify(this._solverMessages),AnalysisSettings:L.stringify({travelMode:h.hitch(this,
function(){var a=h.clone(this.routeParams.travelMode);"\x26lt;"===a.name.substr(0,4)&&"\x26gt;"===a.name.substr(a.name.length-4,4)&&(a.name=a.name.substr(4,a.name.length-8));return a})(),directionsLanguage:this.routeParams.directionsLanguage||this.serviceDescription.directionsLanguage,startTimeIsUTC:this.routeParams.startTimeIsUTC,timeWindowsAreUTC:this.routeParams.timeWindowsAreUTC,findBestSequence:this.routeParams.findBestSequence,preserveFirstStop:this.routeParams.preserveFirstStop,preserveLastStop:this.routeParams.preserveLastStop,
accumulateAttributeNames:this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames})}};this._enableButton(this._saveButton,!1);this._savingRoute=!0;this._showLoadingSpinner(!0);h.hitch(this,function(){var a=new H;this._printService?this.zoomToFullRoute().then(h.hitch(this,function(){var b=this._printParams.template,d=b.exportOptions;b.exportOptions={width:200,height:133,dpi:96};this._printService.execute(this._printParams,function(c){b.exportOptions=d;a.resolve(c.url)},
function(c){b.exportOptions=d;a.resolve()})})):a.resolve();return a.promise})().then(h.hitch(this,function(e){var g={folder:b,name:a,stops:v,directionPoints:l,directionLines:u,barriers:ra,polylineBarriers:ca,polygonBarriers:E,extent:h.mixin(h.clone(f.extent),{xmin:z.xmin>f.extent.xmin?f.extent.xmin:z.xmin,ymin:z.ymin>f.extent.ymin?f.extent.ymin:z.ymin,xmax:z.xmax<f.extent.xmax?f.extent.xmax:z.xmax,ymax:z.ymax<f.extent.ymax?f.extent.ymax:z.ymax}),routeInfo:W,thumbnail:e};this._userCanCreatePortalItem?
this._naRouteSharing.store(g,this.routeLayer.itemId,"1.0.0").then(h.hitch(this,function(a){if(a.success){var b=this._naRouteSharing.portal,b="//"+(b.isPortal?b.portalHostname:b.urlKey+"."+b.customBaseUrl);this._toggleSaveMenu();this._showMessage(A.widgets.directions.routeIsSaved+"\x3cbr/\x3e\x3ca class\x3d'esriLinkButton' target\x3d'_blank' href\x3d'"+b+"/home/item.html?id\x3d"+a.id+"'\x3e"+A.widgets.directions.share+"\x3c/a\x3e",!0);if(this.routeLayer.itemId)this.onRouteItemUpdated(a.id);else this.onRouteItemCreated(a.id);
h.mixin(this.routeLayer,{itemId:a.id,title:g.name,isItemOwner:!0,ownerFolder:d});c.resolve(a)}else c.reject(a)}),c.reject):this._naRouteSharing.createFeatureCollection(g,"1.0.0").then(h.hitch(this,function(a){c.resolve(a);this._toggleSaveMenu();this.onFeatureCollectionCreated(a)}),c.reject)}))}else c.reject(Error("Cannot deduce the impedance used."))}else c.reject(Error("Missing required parameter: layerName, folder must be specified."));else c.reject(Error("Shared route must be built using a Travel Mode."));
else c.reject(Error("Cannot store route: owning system to store routes is not defined. Please specify Portal or ArcGIS Online Url in constructor."));else c.reject(Error("No route to share. Build a route first."));return c.promise},_loadRoute:function(a){var b=new H;b.promise.always(h.hitch(this,function(){this._showLoadingSpinner(!1);C.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._enableButton(this._saveButton,this.routeLayer.isItemOwner)}));
this._reset().then(h.hitch(this,function(){this._showLoadingSpinner(!0);this._enableSharing().then(h.hitch(this,function(){var d=h.clone(this.serviceDescription),c=h.hitch(this,function(b){h.mixin(this.routeLayer,{itemId:a,title:b.title,isItemOwner:b.isItemOwner,ownerFolder:b.ownerFolder})}),e,f,g,k;d.directionsLengthUnits=this.directionsLengthUnits;this._naRouteSharing.load(a,d).then(h.hitch(this,function(a){if(a.routeParameters){h.mixin(this.routeParams,a.routeParameters);this.routeParams.accumulateAttributes=
a.routeParameters.accumulateAttributeNames;this.set("optimalRoute",this.routeParams.findBestSequence);this.startTime=this.routeParams.startTime?this.routeParams.startTime:"none";this._setStartTime(void 0,void 0,this.startTime);var m=a.routeParameters.travelMode,p=m?this._getCostAttribute(m.impedanceAttributeName):void 0,p=p?this._isTimeUnits(p.units)?"Time":"Distance":"";k=d.supportedTravelModes&&d.supportedTravelModes.length?this._travelModeSelector.store.objectStore.data.slice():[];if(canUseRouteLayerTM=
1!==a.successCode&&p){var D="AUTOMOBILE"===m.type?"Driving":"TRUCK"===m.type?"Trucking":"WALK"===m.type?"Walking":"Other";m.name="\x26lt;"+m.name+"\x26gt;";this.serviceDescription.supportedTravelModes=(d.supportedTravelModes||[]).concat(m);k.push({id:m.name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+D+p+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName"\x3e'+m.name+"\x3c/div\x3e"});this._travelModeSelector.setStore(new n({objectStore:new q({data:k})}));
this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(m.name)}else{p=!1;if(m&&m.name)for(k=d.supportedTravelModes||[],e=0;e<k.length;e++)if(k[e].name===m.name){p=!0;this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(m.name);this.routeParams.travelMode=k[e].impedanceAttributeName?k[e]:k[e].itemId;a.loadMessages.push({message:A.widgets.directions.error.tmFromPortalSameName+" "+m.name,messageType:"Warning"});break}if(!p)if((m=d.defaultTravelMode)&&k)for(e=
0;e<k.length;e++){if(k[e].id===m){this.routeParams.travelMode=k[e].impedanceAttributeName?k[e]:k[e].itemId;a.loadMessages.push({message:A.widgets.directions.error.tmFromPortalDefault+" "+(k[e].name?k[e].name:k[e].itemId),messageType:"Warning"});break}}else this.routeParams.travelMode=null}this._checkStartTimeUIAvailability()}if(a.solveResult&&a.solveResult.routeResults){var r,t=Infinity,v,l=-Infinity,m=a.solveResult.routeResults[0].stops,u=a.solveResult.routeResults[0].directions.features,p={};for(e=
0;e<m.length;e++){var I=m[e].attributes;if(I.isWaypoint)for(f=0;f<u.length;f++)D=u[f].attributes,D._stopSequence===I.Sequence&&(D.text=D.text.replace(I.Name,this._waypointName));g=I.Name+"_"+this._stopSequence++;p[g]=I.isWaypoint?this._waypointName:I.Name;I.Name=g;I.Sequence<t&&(null!==I.ArriveCurbApproach||null!==I.DepartCurbApproach)&&(r=I.Name,t=I.Sequence);I.Sequence>l&&(null!==I.ArriveCurbApproach||null!==I.DepartCurbApproach)&&(v=I.Name,l=I.Sequence)}g=r+" - "+v;a.solveResult.routeResults[0].routeName=
g;a.solveResult.routeResults[0].directions.routeName=g;for(e=0;e<u.length;e++)if(D=u[e].attributes,void 0!==D._stopSequence)for(f=0;f<m.length;f++)if(D._stopSequence===m[f].attributes.Sequence){g=m[f].attributes.Name;D.text=(D.text||"").replace(p[g],g);delete D._stopSequence;break}r=m[m.length-1];m[0].geometry.x===r.geometry.x&&m[0].geometry.y===r.geometry.y&&(this._returnToStartStop=this._addStopWrapperToGraphic(new Q(r.geometry,null,r.attributes),p[r.attributes.Name]),this.set("returnToStart",!0));
this._solveResultProcessing(a.solveResult,p).then(h.hitch(this,function(){this._setStartTime(void 0,void 0,this.startTime);c(a);this.zoomToFullRoute();b.resolve(a)}),b.reject)}else{if(a.routeParameters){r=a.routeParameters.stops.features;this.stops=[];for(e=0;e<r.length;e++)this.stops.push(this._addStopWrapperToGraphic(r[e],r[e].attributes.Name)),this._updateStop(this.stops[e],e);this._setStops();a.loadMessages.push({message:A.widgets.directions.routeLayerStopsOnly,messageType:"Warning"})}else a.loadMessages.push({message:A.widgets.directions.routeLayerEmpty,
messageType:"Warning"});c(a);b.resolve(a)}for(e=0;e<a.loadMessages.length;e++)this._showMessage(a.loadMessages[e].message)}),h.hitch(this,function(a){b.reject(a);this._showMessage("GWM_0003"===a.messageCode?A.widgets.directions.error.accessDenied+this._naRouteSharing.portal.getPortalUser().username:A.widgets.directions.error.loadError)}))}),b.reject)}),b.reject);return b.promise}});h.setObject("dijit.Directions",l,R);return l})},"dijit/layout/AccordionPane":function(){define(["dojo/_base/declare",
"dojo/_base/kernel","./ContentPane"],function(c,l,h){return c("dijit.layout.AccordionPane",h,{constructor:function(){l.deprecated("dijit.layout.AccordionPane deprecated, use ContentPane instead","","2.0")},onSelected:function(){}})})},"arcgisonline/sharing/geow/MemberReadStore":function(){define(["dojo","dijit","dojox","dojo/require!dojox/data/QueryReadStore,arcgisonline/sharing/geow/Content"],function(c,l,h){c.provide("arcgisonline.sharing.geow.MemberReadStore");c.require("dojox.data.QueryReadStore");
c.require("arcgisonline.sharing.geow.Content");c.declare("arcgisonline.sharing.geow.MemberReadStore",h.data.QueryReadStore,{_fetchItems:function(a,e,f){var d=a.serverQuery||a.query||{};d.start=a.start||0;d.start++;a.count&&(d.num=a.count);arcgisonline.sharing.util.getJson(this.url,c.hitch(this,function(b){this._items=[];var f=null,k="";if(b.users){k="groupMembers";this._total=b.users.length+b.admins.length;c.publish("onMemberCount",[this._total]);var m={name:b.owner,memberType:"owner",requestType:k,
groupowner:b.owner||"",groupadmins:b.admins||[]};this._items.push({i:m,r:this});c.forEach(b.admins,function(a,d){a!=b.owner&&(m={name:a,memberType:"admin",requestType:k,groupowner:b.owner||"",groupadmins:b.admins||[]},this._items.push({i:m,r:this}))},this);c.forEach(b.users,function(a,d){m={name:a,memberType:"member",requestType:k,groupowner:b.owner||"",groupadmins:b.admins||[]};this._items.push({i:m,r:this})},this)}else f=b.applications,k="groupApplications",c.publish("onAppCount",[b.applications.length]),
this._total=f.length,c.forEach(f,function(a,d){this._items.push({i:{name:a.username,fullname:a.fullname,requestType:k,groupowner:b.owner||"",groupadmins:b.admins||[],received:a.received||-1},r:this})},this);this._itemsByIdentity={};this._identifier="name";for(i=0;i<this._items.length;++i)m=this._items[i].i,f=m.name,this._itemsByIdentity.name||(this._itemsByIdentity[f]=m);e(this._items,a,this._total);this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2);this._lastServerQuery=
c.mixin({},d)}))}})})},"arcgisonline/sharing/dijit/DataGrid":function(){define(["dojo","dijit","dojox","dojo/require!dojox/grid/DataGrid"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.DataGrid");c.require("dojox.grid.DataGrid");c.declare("arcgisonline.sharing.dijit.DataGrid",h.grid.DataGrid,{sort:function(){this.inherited(arguments);setTimeout(c.hitch(this,"update"),300)},_onFetchComplete:function(a,c){var e=!this._isLoaded;this.inherited(arguments);e&&this.update()}})})},"arcgisonline/sharing/dijit/FeaturedItemsGrid":function(){define(["dojo",
"dijit","dojox","dojo/require!arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Community,arcgisonline/sharing/dijit/Gallery,arcgisonline/sharing/dijit/views,arcgisonline/sharing/util"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.FeaturedItemsGrid");c.require("arcgisonline.sharing.geow.Account");c.require("arcgisonline.sharing.geow.Content");c.require("arcgisonline.sharing.geow.Community");c.require("arcgisonline.sharing.dijit.Gallery");c.require("arcgisonline.sharing.dijit.views");
c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.FeaturedItemsGrid",[l._Widget,l._Templated],{_gallery:null,_galleryPane:null,_detailsPane:null,_detailsTextPane:null,_detailsIconPane:null,_detailsTimer:null,featuredGroupId:null,featuredItemsId:null,groupQuery:null,galleryNodes:4,galleryFilter:null,_views:arcgisonline.sharing.dijit.views,_util:arcgisonline.sharing.util,_settings:null,_firstLoad:!0,sortField:null,showThumbnail:!0,templateString:"\x3cdiv dojoAttachPoint\x3d'containerNode'\x3e\x3c/div\x3e",
i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").featuredItemsGrid)},_getFeaturedItems:function(){var a=this._util.getUser();a&&a.accountId&&null!==a.accountId||!a&&this._settings.id?this._handleOrganization():!this.featuredItemsId&&this.featuredGroupId?this._util.getJson(esriGeowConfig.restBaseUrl+"/search?q\x3dgroup:"+this.featuredGroupId+
"\x26num\x3d100",c.hitch(this,this._handleFeaturedGroupChange),c.hitch(this,this._handleFeaturedGroupChange)):arcgisonline.sharing.geow.Content.getFeaturedItems(this.featuredItemsId,c.hitch(this,this._handleFeaturedIdChange),c.hitch(this,this._handleFeaturedIdChange))},_getFeaturedGroupItems:function(){var a=this._util.getUser();a&&a.accountId&&null!==a.accountId||!a&&this._settings.id?this._handleOrganization():this._util.getJson(esriGeowConfig.restBaseUrl+"/search?q\x3dgroup:"+this.featuredGroupId+
"\x26num\x3d100",c.hitch(this,this._handleFeaturedGroupChange),c.hitch(this,this._handleFeaturedGroupChange))},_getGroup:function(){arcgisonline.sharing.geow.Community.getGroup(this.groupQuery,c.hitch(this,this._handleGetGroup),c.hitch(this,this._handleGetGroup))},refresh:function(){this._getFeaturedItems()},postCreate:function(){this._gallery=new arcgisonline.sharing.dijit.Gallery({id:this.id+"_Gallery",nodesPerPage:this.galleryNodes,showNodeLabels:!0,showToolTip:!0,includeNode:this.galleryFilter},
c.create("div",null,this.domNode));this._gallery.set("noResultsMessage","\x3cp class\x3d'esriItemLinks'\x3e"+("\x3cspan\x3e"+this.i18n.noItemsAvailable+"\x3c/span\x3e")+"\x3c/p\x3e");this._gallery.startup()},_handleGetSelf:function(a,e,f){!e||e.code||e.message||(this._settings=e,void 0!==e.featuredItemsGroupQuery&&null!==e.featuredItemsGroupQuery&&(esriGeowConfig.featuredItemsGroupQuery=e.featuredItemsGroupQuery),this._settings.id&&(c.query(".nonAccount").style("display","none"),e="\x3ca id\x3d'mapFilterSelector' href\x3d'#' class\x3d'selected' onClick\x3d'page.filterGallery(this, page.mapFilter, \"organizationMapNotes\"); return false;'\x3e"+
this.i18n.maps+" \x3c/a\x3e\x3ca id\x3d'appFilterSelector' href\x3d'#' onClick\x3d'page.filterGallery(this, page.appFilter, \"organizationWebAppNotes\"); return false;'\x3e"+this.i18n.webApps+"\x3c/a\x3e\x3ca id\x3d'mobileFilterSelector' href\x3d'#' onClick\x3d'page.filterGallery(this, page.mobileFilter, \"organizationMobileAppNotes\"); return false;'\x3e"+this.i18n.mobileApps+"\x3c/a\x3e",c.attr(c.byId("gallerySelectorLinks"),"innerHTML",e)));a&&a()},_setGroupQueryAttr:function(a){var e=c.hitch(this,
function(){var e=this._util.getUser();e&&e.accountId&&null!==e.accountId||!e&&this._settings.id?this._handleOrganization():(this.groupQuery=a,!0===this._firstLoad&&(this.groupQuery=esriGeowConfig.featuredItemsGroupQuery,9>=c.isIE&&(this.groupQuery=encodeURIComponent(this.groupQuery)),this._firstLoad=!1),this.groupQuery&&0<this.groupQuery.length&&arcgisonline.sharing.geow.Community.searchGroups(this.groupQuery,c.hitch(this,this._handleGetGroup),c.hitch(this,this._handleGetGroup)))});this._settings?
e():arcgisonline.sharing.geow.Account.getSelf(c.hitch(this,this._handleGetSelf,e))},_setGalleryFilterAttr:function(a){this.galleryFilter=a;null!==this._gallery&&(this._gallery.includeNode=a,this.refresh())},_setFeaturedItemsIdAttr:function(a){null!==a&&0!==a.length&&(this.pageCount=0,this.featuredItemsId=a,this._getFeaturedItems())},_setFeaturedGroupIdAttr:function(a){null!==a&&0!==a.length&&(this.pageCount=0,this.featuredGroupId=a,this._getFeaturedGroupItems())},_sortItemsFunction:function(a,c){return a[this.sortField]&&
c[this.sortField]?c[this.sortField]-a[this.sortField]:null===a[this.sortField]&&null===c[this.sortField]?0:null!==a[this.sortField]?1:-1},_handleFeaturedIdChange:function(a,e){c.attr(this._gallery,"items",null===this.sortField?a.relatedItems:a.relatedItems.sort(c.hitch(this,this._sortItemsFunction)))},_handleFeaturedGroupChange:function(a,e){c.attr(this._gallery,"items",null===this.sortField?a.results:a.results.sort(c.hitch(this,this._sortItemsFunction)))},_handleGallerySwivel:function(a,e){c.attr(this._gallery,
"items",null===this.sortField?a.results:a.results.sort(c.hitch(this,this._sortItemsFunction)))},_handleGetGroup:function(a,e){a&&1===a.total&&(c.byId("galleryTitle").innerHTML=a.results[0].title||"",a.results[0].featuredItemsId?this._setFeaturedItemsIdAttr(a.results[0].featuredItemsId):this._setFeaturedGroupIdAttr(a.results[0].id))},_handleOrganization:function(){c.style(c.byId("sideNote"),"display","none");c.style(c.byId("organizationSideNote"),"display","block");var a=this.i18n.mostViewedItems,
e=this.i18n.recentlyAddedItems,f=this.i18n.groups;if(void 0===esriGeowConfig.isMultiTenant||!0===esriGeowConfig.isMultiTenant)a+=this.i18n.inOrgString,e=this.i18n.itemsRecentlyAddedByOrgUsers,f=this.i18n.groupsText;var d='\x3cdiv id\x3d"organizationWebAppNotes"\x3e\x3cp class\x3d"esriItemLinks"\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dcontent\x26sortField\x3dnumviews\x26sortOrder\x3ddesc\x26focus\x3dapplications-web\x26hideq\x3dtrue"\x3e'+a+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+
this._settings.id+'\x26t\x3dcontent\x26sortField\x3dmodified\x26sortOrder\x3ddesc\x26focus\x3dapplications-web\x26hideq\x3dtrue"\x3e'+e+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dgroups"\x3e'+f+"\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e",b='\x3cdiv id\x3d"organizationMobileAppNotes"\x3e\x3cp class\x3d"esriItemLinks"\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dcontent\x26sortField\x3dnumviews\x26sortOrder\x3ddesc\x26focus\x3dapplications-mobile\x26hideq\x3dtrue"\x3e'+
a+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dcontent\x26sortField\x3dmodified\x26sortOrder\x3ddesc\x26focus\x3dapplications-mobile\x26hideq\x3dtrue"\x3e'+e+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dgroups"\x3e'+f+"\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e",a='\x3cdiv id\x3d"organizationMapNotes"\x3e\x3cp class\x3d"esriItemLinks"\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dcontent\x26sortField\x3dnumviews\x26sortOrder\x3ddesc\x26focus\x3dmaps\x26hideq\x3dtrue"\x3e'+
a+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dcontent\x26sortField\x3dmodified\x26sortOrder\x3ddesc\x26focus\x3dmaps\x26hideq\x3dtrue"\x3e'+e+'\x3c/a\x3e\x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d"search.html?q\x3dorgid:'+this._settings.id+'\x26t\x3dgroups\x26hideq\x3dtrue"\x3e'+f+"\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e";c.byId("organizationWebAppNotes").innerHTML=d;c.byId("organizationMobileAppNotes").innerHTML=b;c.byId("organizationMapNotes").innerHTML=
a;(d=esriGeowConfig.featuredItemsGroupQuery)&&""!==d&&"most_viewed"!==d.toLowerCase()?arcgisonline.sharing.geow.Community.searchGroups(d,c.hitch(this,this._handleSearchGroups)):(d=this._settings.name+this.i18n.featuredContent,this._settings.thumbnail&&0<this._settings.thumbnail.length&&(d='\x3cimg src\x3d"'+this._getOrganizationThumbnailUrl(this._settings)+'" align\x3d"center" class\x3d"groupThumbnail"/\x3e '+d),c.byId("galleryTitle").innerHTML=d,this.sortField=null,d=this._util.getUser(),b={num:100},
b.q="orgid:"+(d?d.accountId:this._settings.id),b.sortField="numviews",b.sortOrder="desc",arcgisonline.sharing.geow.Content.search(esriGeowConfig.restBaseUrl+"search",b,c.hitch(this,this._handleGallerySwivel),c.hitch(this,this._handleGallerySwivel)))},_handleSearchGroups:function(a,e){a&&!a.code&&!a.message&&a.results&&1===a.results.length&&(a=a.results[0],e=a.title,this._settings.thumbnail&&0<this._settings.thumbnail.length&&(e='\x3cimg src\x3d"'+this._getOrganizationThumbnailUrl(this._settings)+
'" align\x3d"center" class\x3d"groupThumbnail"/\x3e '+e),c.byId("galleryTitle").innerHTML=e,this._loadFeaturedContent(a.id,a.sortField,a.sortOrder))},_handleGetGroupByID:function(a,e){!a||a.code||a.message||(e=a.title,this._settings.thumbnail&&0<this._settings.thumbnail.length&&(e='\x3cimg src\x3d"'+this._getOrganizationThumbnailUrl(this._settings)+'" align\x3d"center" class\x3d"groupThumbnail"/\x3e '+e),c.byId("galleryTitle").innerHTML=e,this._loadFeaturedContent(a.id,group.sortField,group.sortOrder))},
_loadFeaturedContent:function(a,e,f){this.sortField=null;this._util.getUser();var d={num:100};d.q="group:"+a;d.sortField=e?e:"modified";d.sortOrder=f?f:"desc";arcgisonline.sharing.geow.Content.search(esriGeowConfig.restBaseUrl+"search",d,c.hitch(this,this._handleGallerySwivel),c.hitch(this,this._handleGallerySwivel))},_getOrganizationThumbnailUrl:function(a){var c=this._util.getToken();return esriGeowConfig.restBaseUrl+"portals/self/resources/"+a.thumbnail+(c?"?token\x3d"+c:"")},nextPage:function(){this._gallery.nextPage()},
prevPage:function(){this._gallery.prevPage()}})})},"arcgisonline/sharing/dijit/FeatureLayerQueryResult":function(){define("esri/main dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/DeferredList dojo/_base/array esri/IdentityManager".split(" "),function(c,l,h,a,e,f,d,b){var g=function(b){function d(a){b[a]||(b[a]=function(){var d=arguments;return f.when(b,function(b){Array.prototype.unshift.call(d,b.features||b);return g(e[a].apply(e,d))})})}if(!b)return b;
b.then&&(b=a.delegate(b));b.total||(b.total=f.when(b,function(a){return c._isDefined(a.total)?a.total:a.length||0}));d("forEach");d("filter");d("map");d("some");d("every");return b};a.setObject("arcgisonline.sharing.dijit.FeatureLayerQueryResult",g);return g})},"arcgisonline/sharing/dijit/FeatureLayerQueryStore":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/FeatureLayerQueryResult"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.FeatureLayerQueryStore");
c.require("arcgisonline.sharing.dijit.FeatureLayerQueryResult");c.declare("arcgisonline.sharing.dijit.FeatureLayerQueryStore",null,{queryUrl:"",idProperty:"id",data:[],constructor:function(a){c.mixin(this,a);this.layer=a.layer;this.objectIds=a.objectIds;this.where=a.where;this.orderByFields=a.orderByFields;this.totalCount=a.totalCount;this.batchCount=a.batchCount||25;this.idProperty=this.layer.objectIdField},get:function(a,c){return this.data[a]},getIdentity:function(a){return a[this.idProperty]},
query:function(a,e){var f=new esri.tasks.Query;a=e.start||0;e=this.batchCount;this.objectIds?f.objectIds=this.objectIds.length>=a+this.batchCount?this.objectIds.slice(a,a+e):this.objectIds.slice(a):(f.start=a,f.num=e,f.where=this.where,f.orderByFields=this.orderByFields);f.returnGeometry=!1;f.outFields=["*"];var d=this.totalCount;a=this.layer.queryFeatures(f);a.total=a.then(c.hitch(this,function(a){if(this.objectIds){var b=a.objectIdFieldName;if(!b)for(var e=0;e<a.fields.length;e++)if("esriFieldTypeOID"==
a.fields[e].type){b=a.fields[e].name;break}for(var m={},e=0;e<a.features.length;e++)m[a.features[e].attributes[b]]=a.features[e];a.features=c.map(f.objectIds,function(a){return m[a]})}for(e=0;e<a.features.length;e++)a.features[e]=a.features[e].attributes,this.data[a.features[e][b]]=a.features[e];a=a.features;return d}),function(){return 0});return arcgisonline.sharing.dijit.FeatureLayerQueryResult(a)}})})},"arcgisonline/sharing/dijit/GroupMembershipRequestsGrid":function(){define(["dojo","dijit",
"dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/grid/DataGrid,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Toolbar,arcgisonline/sharing/geow/MemberReadStore,arcgisonline/sharing/dijit/ProfilePopup"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.GroupMembershipRequestsGrid");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dojox.grid.DataGrid");c.require("dojox.rpc.Service");c.require("dojo.rpc.JsonService");c.require("dijit.Toolbar");c.require("arcgisonline.sharing.geow.MemberReadStore");
c.require("arcgisonline.sharing.dijit.ProfilePopup");c.declare("arcgisonline.sharing.dijit.GroupMembershipRequestsGrid",[l._Widget,l._Templated],{widgetsInTemplate:!0,groupId:null,initialized:!1,templateString:'\x3cdiv id\x3d"esriGroupMambershipRequestsGrid" style\x3d"width: 100%; height: 100%; margin:auto;"\x3e\r\n  \x3ctable data-dojo-type\x3d"dojox.grid.DataGrid" jsid\x3d"grid" id\x3d"groupMembershipRequestsNode"\r\n         data-dojo-props\x3d"rowsperpage:10,delayscroll:true"\r\n         class\x3d"esriGrid" style\x3d"height:100%; width:100%;"\x3e\r\n    \x3cthead\x3e\r\n    \x3ctr\x3e\r\n      \x3cth get\x3d"arcgisonline.sharing.dijit.GroupMembershipRequestsGrid.formatters.name"\r\n          formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"30%" name\x3d"Name"\x3ex\x3c/th\x3e\r\n      \x3cth get\x3d"arcgisonline.sharing.dijit.GroupMembershipRequestsGrid.formatters.username"\r\n          formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"20%" name\x3d"Username"\x3ex\x3c/th\x3e\r\n      \x3cth get\x3d"arcgisonline.sharing.dijit.GroupMembershipRequestsGrid.formatters.received"\r\n          formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"26%" name\x3d"Received"\x3ex\x3c/th\x3e\r\n      \x3cth get\x3d"arcgisonline.sharing.dijit.GroupMembershipRequestsGrid.formatters.yourResponse"\r\n          formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"34%" name\x3d"Your Response"\x3ex\x3c/th\x3e\r\n    \x3c/tr\x3e\r\n    \x3c/thead\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
_eventConnections:[],i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").groupMembershipRequestsGrid)},postCreate:function(){c.subscribe("onApplicationAccept",this.refreshGrid);c.subscribe("onApplicationDecline",this.refreshGrid);this._applyGridPatches();if(esri.isTouchEnabled){var a=esri.setScrollable(grid.views.views[0].scrollboxNode);this._eventConnections.push(a[0],
a[1])}},_applyGridPatches:function(){var a=grid.adaptWidth;grid.adaptWidth=function(){var e=this.views.views,f,d;for(d=0;f=e[d];d++){c.style(f.headerNode,"display","block");var b=f.adaptWidth;f.adaptWidth=function(){this.flexCells&&null==this.headerContentNode.firstChild||b.apply(this,arguments)}}a.apply(this,arguments);for(d=0;f=e[d];d++)c.style(f.headerNode,"display","none")}},loadGrid:function(a){this.groupId=a;c.byId("membership-groupId").value=this.groupId;a=new arcgisonline.sharing.geow.MemberReadStore;
a.url=esriGeowConfig.restBaseUrl+"community/groups/"+this.groupId+"/applications";grid.noDataMessage="\x3cspan style\x3d'font-size:1.2em;color:#7a7979;'\x3e"+this.i18n.noMembershipRequests+"\x3c/span\x3e";grid.setStore(a)},onAppCount:function(a){0<a?(c.style(c.byId("membership-requests-has_no_requests"),"display","none"),c.style(c.byId("membership-requests-has_requests"),"display","block")):(c.style(c.byId("membership-requests-has_requests"),"display","none"),c.style(c.byId("membership-requests-has_no_requests"),
"display","block"))},refreshGrid:function(){grid.setQuery()},destroy:function(){this.inherited(arguments);c.forEach(this._eventConnections,c.disconnect)}});arcgisonline.sharing.dijit.GroupMembershipRequestsGrid.formatters={i18n:null,name:function(a,c){return c?'\x3cspan id\x3d"esriMemberInfo" class\x3d"esriItemLinks"\x3e\x3ca href\x3d"#" onclick\x3d"arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance().showProfile(\''+c.i.name+"', this);\"\x3e"+c.i.fullname+"\x3c/span\x3e":this.defaultValue},
username:function(a,c){if(!c)return this.defaultValue;a=c.i.name;return'\x3cspan id\x3d"esriMemberInfo" class\x3d"esriItemLinks"\x3e\x3ca href\x3d"#" onclick\x3d"arcgisonline.sharing.dijit.ProfilePopup.prototype.statics.getInstance().showProfile(\''+a+"', this);\"\x3e"+a+"\x3c/span\x3e"},received:function(a,e){if(!e)return this.defaultValue;a='\x3cspan id\x3d"esriMemberInfo"\x3e';e=e.i.received;-1<e&&(e=new Date(parseFloat(e)),a+=c.date.locale.format(e,{selector:"date",formatLength:"long"}));return a+
"\x3c/span\x3e"},yourResponse:function(a,e){if(!e)return this.defaultValue;this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").groupMembershipRequestsGrid);a=c.byId("membership-groupId").value;e=e.i.name;var f='\x3cdiv class\x3d"list-links" style\x3d"padding-left:20px;"\x3e\x3cspan class\x3d"approveApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.acceptApplication(\''+a+
"','"+e+"')\"\x3e"+this.i18n.approve+"\x3c/a\x3e";return f+='  \x3cspan class\x3d"declineApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.declineApplication(\''+a+"','"+e+"')\"'\x3e"+this.i18n.decline+"\x3c/a\x3e\x3c/div\x3e"}}})},"arcgisonline/sharing/dijit/InvitationsGrid":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojo/data/ItemFileReadStore,dojox/grid/DataGrid,dojox/rpc/Service,dojo/rpc/JsonService,dijit/Toolbar,dijit/Tooltip,dojox/layout/ContentPane,arcgisonline/sharing/geow/QueryReadStore,arcgisonline/sharing/util"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.InvitationsGrid");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dojo.data.ItemFileReadStore");c.require("dojox.grid.DataGrid");c.require("dojox.rpc.Service");c.require("dojo.rpc.JsonService");c.require("dijit.Toolbar");c.require("dijit.Tooltip");c.require("dojox.layout.ContentPane");c.require("arcgisonline.sharing.geow.QueryReadStore");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.InvitationsGrid",
[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:' \x3cdiv id\x3d"esriInvitationsGrid" style\x3d"width: 100%; height: 100%; margin:auto;"\x3e\r\n    \x3ctable dojotype\x3d"dojox.grid.DataGrid" jsid\x3d"grid" id\x3d"invitationsNode" rowsperpage\x3d"10"\r\n        delayscroll\x3d"true" class\x3d"esriGrid" style\x3d"height:100%; width:100%;"\x3e\r\n    \x3cthead\x3e\r\n        \x3ctr\x3e        \r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.groupName" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"20%" name\x3d"Group Name"\x3e${i18n.groupName}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.sender" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"20%" name\x3d"Sender"\x3e${i18n.sender}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.received" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"25%" name\x3d"Received"\x3e${i18n.received}\x3c/th\x3e\r\n        \x3cth get\x3d"arcgisonline.sharing.dijit.InvitationsGrid.formatters.yourResponse" formatter\x3d"arcgisonline.sharing.util.fix" width\x3d"60%" name\x3d"Your Response"\x3e${i18n.yourResponse}\x3c/th\x3e\r\n        \x3c/tr\x3e\r\n    \x3c/thead\x3e\r\n    \x3c/table\x3e\r\n \x3c/div\x3e   \r\n',
i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").invitationsGrid)},postCreate:function(){this._applyGridPatches()},_applyGridPatches:function(){var a=grid.adaptWidth;grid.adaptWidth=function(){for(var e=this.views.views,f=0,d;d=e[f];f++){c.style(d.headerNode,"display","block");var b=d.adaptWidth;d.adaptWidth=function(){this.flexCells&&null==
this.headerContentNode.firstChild||b.apply(this,arguments)}}a.apply(this,arguments);for(f=0;d=e[f];f++)c.style(d.headerNode,"display","none")}},loadGrid:function(a){for(var e=0,f=!1;!f;)l.byId("tooltip_"+e)?l.byId("tooltip_"+e).destroy():f=!0,e++;a={identifier:"id",label:"groupTitle",items:a};grid.noDataMessage="\x3cspan style\x3d'font-size:1.2em;color:#7a7979;'\x3e"+this.i18n.noGroupInvites+"\x3c/span\x3e";a=new c.data.ItemFileReadStore({data:a});grid.setStore(a)}});arcgisonline.sharing.dijit.InvitationsGrid.formatters=
{i18n:null,groupName:function(a,c){return c?'\x3cspan id\x3d"group_title_'+a+'" onMouseOver\x3d"JavaScript:arcgisonline.sharing.dijit.InvitationsGrid.formatters.showTooltip('+a+');"\x3e'+c.groupTitle+"\x3c/span\x3e":this.defaultValue},showTooltip:function(a){if(!l.byId("tooltip_"+a)&&c.byId("group_title_"+a)){var e=grid.getItem(a),f=null;null!=e.groupDescription&&(1==e.groupDescription.length&&null!=e.groupDescription[0]&&0<e.groupDescription[0].length?f=e.groupDescription[0]:1<e.groupDescription.length&&
(f=e.groupDescription));var d=null;null!=e.groupThumbnail&&(1==e.groupThumbnail.length&&null!=e.groupThumbnail[0]&&0<e.groupThumbnail[0].length?d=e.groupThumbnail[0]:1<e.groupThumbnail.length&&(d=e.groupThumbnail));if(null!=f||null!=d){var b='\x3cspan class\x3d"esriItemTitle" style\x3d"line-height:20px;"\x3e'+e.groupTitle+"\x3c/span\x3e";null!=d&&(b=-1<d.indexOf("http://")?b+("\x3cbr/\x3e\x3cbr/\x3e\x3cimg src\x3d'"+d+'\' width\x3d"65" height\x3d"65" /\x3e'):b+("\x3cbr/\x3e\x3cbr/\x3e\x3cimg src\x3d'"+
esriGeowConfig.restBaseUrl+"community/groups/"+e.groupId+"/info/"+d+'\' width\x3d"65" height\x3d"65" /\x3e'));null!=f&&(f=arcgisonline.sharing.util.removeHTMLTags(f),b=150<f.length?b+("\x3cbr/\x3e\x3cbr/\x3e"+f.substring(0,150)+" ..."):b+("\x3cbr/\x3e\x3cbr/\x3e"+f));(new l.Tooltip({label:b+"\x3cbr/\x3e\x26nbsp;",connectId:["group_title_"+a],id:"tooltip_"+a})).open(c.byId("group_title_"+a))}}},sender:function(a,c){return c?c.fromUserFullname:this.defaultValue},received:function(a,e){if(!e)return this.defaultValue;
a=new Date(parseFloat(e.received));return c.date.locale.format(a,{selector:"date",formatLength:"long"})},yourResponse:function(a,e){this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").invitationsGrid);if(!e)return this.defaultValue;a=e.asUser&&e.asUser[0]?e.asUser[0]:null;var f="";a?(f='\x3cdiv class\x3d"list-links"\x3e\x3cspan class\x3d"approveApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.acceptInvitationByUser(\''+
e.groupId+"','"+a+"')\"\x3e"+this.i18n.joinThisGroup+"\x3c/a\x3e",f+=' \x3cspan class\x3d"declineApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.declineInvitationByUser(\''+e.groupId+"','"+a+"')\"'\x3e"+this.i18n.decline+"\x3c/a\x3e\x3c/div\x3e"):(f='\x3cdiv class\x3d"list-links"\x3e\x3cspan class\x3d"approveApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.acceptInvitation(\''+e.groupId+"')\"\x3e"+this.i18n.joinThisGroup+
"\x3c/a\x3e",f+=' \x3cspan class\x3d"declineApplication"\x3e\x3c/span\x3e\x3ca href\x3d"JavaScript:arcgisonline.sharing.geow.Group.declineInvitation(\''+e.groupId+"')\"'\x3e"+this.i18n.decline+"\x3c/a\x3e\x3c/div\x3e");return f}}})},"dojox/layout/ContentPane":function(){define(["dojo/_base/lang","dojo/_base/xhr","dijit/layout/ContentPane","dojox/html/_base","dojo/_base/declare"],function(c,l,h,a,e){return e("dojox.layout.ContentPane",h,{adjustPaths:!1,cleanContent:!1,renderStyles:!1,executeScripts:!0,
scriptHasHooks:!1,ioMethod:l.get,ioArgs:{},onExecError:function(a){},_setContent:function(e){var d=this._contentSetter;d&&d instanceof a._ContentSetter||(d=this._contentSetter=new a._ContentSetter({node:this.containerNode,_onError:c.hitch(this,this._onError),onContentError:c.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(g){}})}));this._contentSetterParams={adjustPaths:!(!this.adjustPaths||!this.href&&!this.referencePath),referencePath:this.href||this.referencePath,
renderStyles:this.renderStyles,executeScripts:this.executeScripts,scriptHasHooks:this.scriptHasHooks,scriptHookReplacement:"dijit.byId('"+this.id+"')"};return this.inherited("_setContent",arguments)},destroy:function(){var a=this._contentSetter;a&&a.tearDown();this.inherited(arguments)}})})},"dojox/html/_base":function(){define("dojo/_base/declare dojo/Deferred dojo/dom-construct dojo/html dojo/_base/kernel dojo/_base/lang dojo/ready dojo/_base/sniff dojo/_base/url dojo/_base/xhr dojo/when dojo/_base/window".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p){var q=e.getObject("dojox.html",!0);if(b("ie"))var n=/(AlphaImageLoader\([^)]*?src=(['"]))(?![a-z]+:|\/)([^\r\n;}]+?)(\2[^)]*\)\s*[;}]?)/g;var r=/(?:(?:@import\s*(['"])(?![a-z]+:|\/)([^\r\n;{]+?)\1)|url\(\s*(['"]?)(?![a-z]+:|\/)([^\r\n;]+?)\3\s*\))([a-z, \s]*[;}]?)/g,v=q._adjustCssPaths=function(a,b){if(b&&a)return n&&(b=b.replace(n,function(b,d,c,e,f){return d+(new g(a,"./"+e)).toString()+f})),b.replace(r,function(b,d,c,e,f,k){return c?'@import "'+(new g(a,"./"+c)).toString()+
'"'+k:"url("+(new g(a,"./"+f)).toString()+")"+k})},u=/(<[a-z][a-z0-9]*\s[^>]*)(?:(href|src)=(['"]?)([^>]*?)\3|style=(['"]?)([^>]*?)\5)([^>]*>)/gi,w=q._adjustHtmlPaths=function(a,b){var d=a||"./";return b.replace(u,function(a,b,c,e,f,k,m,n){return b+(c?c+"\x3d"+e+(new g(d,f)).toString()+e:"style\x3d"+k+v(d,m)+k)+n})},t=q._snarfStyles=function(a,b,d){d.attributes=[];b=b.replace(/<[!][-][-](.|\s)*?[-][-]>/g,function(a){return a.replace(/<(\/?)style\b/ig,"\x26lt;$1Style").replace(/<(\/?)link\b/ig,"\x26lt;$1Link").replace(/@import "/ig,
'@ import "')});return b.replace(/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,function(b,c,e,f,g,k){b=(c||f||"").replace(/^\s*([\s\S]*?)\s*$/i,"$1");e?e=d.push(a?v(a,e):e):(e=d.push('@import "'+k+'";'),b=b.replace(/\s*(?:rel|href)=(['"])?[^\s]*\1\s*/gi,""));if(b){b=b.split(/\s+/);k={};f=0;for(g=b.length;f<g;f++)c=b[f].split("\x3d"),k[c[0]]=c[1].replace(/^\s*['"]?([\s\S]*?)['"]?\s*$/,"$1");d.attributes[e-1]=k}return""})},y=q._snarfScripts=
function(a,b){function d(a){b.downloadRemote&&(a=a.replace(/&([a-z0-9#]+);/g,function(a,b){switch(b){case "amp":return"\x26";case "gt":return"\x3e";case "lt":return"\x3c";default:return"#"==b.charAt(0)?String.fromCharCode(b.substring(1)):"\x26"+b+";"}}),k.get({url:a,sync:!0,load:function(a){""!==b.code&&(a="\n"+a);b.code+=a+";"},error:b.errBack}))}b.code="";a=a.replace(/<[!][-][-](.|\s)*?[-][-]>/g,function(a){return a.replace(/<(\/?)script\b/ig,"\x26lt;$1Script")});return a.replace(/<script\s*(?![^>]*type=['"]?(?:dojo\/|text\/html\b))[^>]*?(?:src=(['"]?)([^>]*?)\1[^>]*)?>([\s\S]*?)<\/script>/gi,
function(a,c,e,f){e?d(e):(""!==b.code&&(f="\n"+f),b.code+=f+";");return""})},C=q.evalInGlobal=function(a,b){b=b||p.doc.body;var d=b.ownerDocument.createElement("script");d.type="text/javascript";b.appendChild(d);d.text=a};q._ContentSetter=c(a._ContentSetter,{adjustPaths:!1,referencePath:".",renderStyles:!1,executeScripts:!1,scriptHasHooks:!1,scriptHookReplacement:null,_renderStyles:function(a){this._styleNodes=[];for(var b,d,c,e=this.node.ownerDocument,f=e.getElementsByTagName("head")[0],g=0,k=a.length;g<
k;g++){c=a[g];d=a.attributes[g];b=e.createElement("style");b.setAttribute("type","text/css");for(var m in d)b.setAttribute(m,d[m]);this._styleNodes.push(b);f.appendChild(b);b.styleSheet?b.styleSheet.cssText=c:b.appendChild(e.createTextNode(c))}},empty:function(){this.inherited("empty",arguments);this._styles=[]},onBegin:function(){this.inherited("onBegin",arguments);var a=this.content,b=this._styles;this._code=null;if(f.isString(a)){this.adjustPaths&&this.referencePath&&(a=w(this.referencePath,a));
if(this.renderStyles||this.cleanContent)a=t(this.referencePath,a,b);if(this.executeScripts){var d=this,b={downloadRemote:!0,errBack:function(a){d._onError.call(d,"Exec",'Error downloading remote script in "'+d.id+'"',a)}},a=y(a,b);this._code=b.code}}this.content=a},onEnd:function(){var a=this._code,b=this._styles;if(this._styleNodes&&this._styleNodes.length)for(;this._styleNodes.length;)h.destroy(this._styleNodes.pop());this.renderStyles&&b&&b.length&&this._renderStyles(b);var c=new l,e=this.getInherited(arguments),
g=arguments,b=f.hitch(this,function(){e.apply(this,g);m(this.parseDeferred,function(){c.resolve()})});if(this.executeScripts&&a){this.cleanContent&&(a=a.replace(/(\x3c!--|(?:\/\/)?--\x3e|<!\[CDATA\[|\]\]>)/g,""));this.scriptHasHooks&&(a=a.replace(/_container_(?!\s*=[^=])/g,this.scriptHookReplacement));try{C(a,this.node)}catch(E){this._onError("Exec","Error eval script in "+this.id+", "+E.message,E)}d(b)}else b();return c.promise},tearDown:function(){this.inherited(arguments);delete this._styles;if(this._styleNodes&&
this._styleNodes.length)for(;this._styleNodes.length;)h.destroy(this._styleNodes.pop());delete this._styleNodes;f.mixin(this,q._ContentSetter.prototype)}});q.set=function(b,d,c){return c?(new q._ContentSetter(f.mixin(c,{content:d,node:b}))).set():a._setNodeContent(b,d,!0)};return q})},"arcgisonline/sharing/dijit/OrganizationInvite":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/form/Button,dijit/form/ComboBox,dijit/form/SimpleTextarea,dijit/form/TextBox,dijit/form/RadioButton,dijit/layout/ContentPane,dijit/layout/TabContainer,dojo/data/ItemFileReadStore,dojo/data/ItemFileWriteStore,dojo/io/iframe,dojo/json,dojo/number,dojo/topic,dojo/json,dojo/Deferred,dojo/promise/all,dijit/Tooltip,dojox/data/CsvStore,arcgisonline/pages/utils/culture,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Roles,arcgisonline/sharing/dijit/_LevelAwareMixin,arcgisonline/sharing/dijit/DataGrid,arcgisonline/sharing/dijit/GroupSelector,arcgisonline/sharing/dijit/dialog/AssignCreditsDlg,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/SelectEnterpriseGroupDlg,arcgisonline/sharing/dijit/dialog/SelectEnterpriseUserDlg"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.OrganizationInvite");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit._WidgetBase");c.require("dijit._TemplatedMixin");c.require("dijit.form.Button");c.require("dijit.form.ComboBox");c.require("dijit.form.SimpleTextarea");c.require("dijit.form.TextBox");c.require("dijit.form.RadioButton");c.require("dijit.layout.ContentPane");c.require("dijit.layout.TabContainer");c.require("dojo.data.ItemFileReadStore");c.require("dojo.data.ItemFileWriteStore");
c.require("dojo.io.iframe");c.require("dojo.json");c.require("dojo.number");c.require("dojo.topic");c.require("dojo.json");c.require("dojo.Deferred");c.require("dojo.promise.all");c.require("dijit.Tooltip");c.require("dojox.data.CsvStore");c.require("arcgisonline.pages.utils.culture");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.geow.Account");c.require("arcgisonline.sharing.geow.Geow");c.require("arcgisonline.sharing.geow.Roles");c.require("arcgisonline.sharing.dijit._LevelAwareMixin");
c.require("arcgisonline.sharing.dijit.DataGrid");c.require("arcgisonline.sharing.dijit.GroupSelector");c.require("arcgisonline.sharing.dijit.dialog.AssignCreditsDlg");c.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit.dialog.SelectEnterpriseGroupDlg");c.require("arcgisonline.sharing.dijit.dialog.SelectEnterpriseUserDlg");c.requireLocalization("arcgisonline","arcgisonline");c.declare("arcgisonline.sharing.dijit.OrganizationInvite",
[l._Widget,l._Templated,arcgisonline.sharing.dijit._LevelAwareMixin],{baseClass:"orgInvite",widgetsInTemplate:!0,templateString:'\x3cdiv data-dojo-type\x3d"dijit.layout.ContentPane" data-dojo-attach-point\x3d"containerNode" class\x3d"${baseClass}"\x3e\r\n\r\n  \x3cdiv class\x3d"topButtonRow" data-dojo-attach-point\x3d"_topButtonRow"\x3e\r\n    \x3cbutton data-dojo-attach-point\x3d"_topCancelBtn" data-dojo-attach-event\x3d"onClick:onCancel" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" class\x3d"calcite transparent"\x3e${i18n.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"mainContent" data-dojo-attach-point\x3d"_mainContent"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step1"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader1"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e${i18n.step1.message}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"\x3e\r\n      \x3clabel class\x3d"optionTitle"\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_addUsersBtn" id\x3d"addUsers" name\x3d"inviteUsers" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_addOptionLabel"\x3e\x3c/span\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"optionDesc"\x3e\r\n        ${i18n.step1.addUsersMsg}\r\n      \x3c/div\x3e\r\n      \x3cbr\x3e\r\n      \x3clabel class\x3d"optionTitle"\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_createUsersBtn" id\x3d"createUsers" name\x3d"inviteUsers" checked data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_createOptionLabel"\x3e\x3c/span\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"optionDesc"\x3e\r\n        ${i18n.step1.createUsersMsg}\r\n      \x3c/div\x3e\r\n      \x3cbr\x3e\r\n      \x3clabel class\x3d"optionTitle"\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_inviteUsersBtn" id\x3d"inviteUsers" name\x3d"inviteUsers"  data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_inviteOptionLabel"\x3e\x3c/span\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"optionDesc"\x3e\r\n        ${i18n.step1.inviteUsersMsg}\r\n      \x3c/div\x3e\r\n      \x3cbr\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_idpOptionDiv"\x3e\r\n        \x3clabel class\x3d"optionTitle"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"_idpUsersBtn" id\x3d"idpUsers" name\x3d"inviteUsers" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n          ${i18n.step1.idpUsersLabel}\r\n        \x3c/label\x3e\r\n        \x3cdiv class\x3d"optionDesc"\x3e\r\n          ${i18n.step1.idpUsersMsg}\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_step1NextBtn" class\x3d"calcite secondary small" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:onNext" type\x3d"button"\x3e${i18n.next}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step1Create" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader1Create"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e${i18n.step1Create.message}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_createTypeContainer"\x3e\r\n        \x3clabel class\x3d"optionTitle"\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"memberType" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_radioBuiltin" id\x3d"userTypeBuiltin" checked\x3d"checked" value\x3d"builtin"\x3e\r\n          ${i18n.step1Create.addBuiltin}\r\n        \x3c/label\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3clabel class\x3d"optionTitle"\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"memberType" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_radioSAML" id\x3d"userTypeSAML" value\x3d"saml"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_radioSAMLLabel"\x3e\x3c/span\x3e\r\n        \x3c/label\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3clabel class\x3d"optionTitle"\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"memberType" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_radioEnterprise" id\x3d"userTypeEnterprise"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_radioEnterpriseLabel"\x3e${i18n.step1Create.addEnterprise}\x3c/span\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step2IDP" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2IDP"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3cstrong\x3e\x3clabel data-dojo-attach-point\x3d"_step2IDPMsgLabel"\x3e\x3c/label\x3e\x3c/strong\x3e\x3c/div\x3e\r\n          \x3clabel\x3e${i18n.step2IDP.instructions}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"\x3e\r\n      \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_idpErrorContainer"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_idpTabContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step2Create" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2Create"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3clabel data-dojo-attach-point\x3d"_step2CreateMsgLabel"\x3e\x3c/label\x3e\x3c/div\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_step2CreateSubMsgLabel" class\x3d"stepSubMessage"\x3e${i18n.selectNonAdmin}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_createErrorContainer"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_createTabContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_fixErrors" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2FixErrors"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3cstrong\x3e\x3clabel data-dojo-attach-point\x3d"_fixErrorsMsgLabel"\x3e\x3c/label\x3e\x3c/strong\x3e\x3c/div\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_fixErrorsMsgSubLabel"\x3e${i18n.selectNonAdmin}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_fixErrorsErrorContainer"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_fixErrorsContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step2Invite" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2Invite"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3clabel data-dojo-attach-point\x3d"_step2InviteLabel"\x3e${i18n.step3.message}\x3c/label\x3e\x3c/div\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_step2InviteSubLabel"\x3e\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_inviteErrorContainer"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_inviteTabContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step3" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader3"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3clabel data-dojo-attach-point\x3d"_step3Message"\x3e${i18n.step3.message}\x3c/label\x3e\x3c/div\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_step3SubMessage"\x3e\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_ReviewErrorContainer"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" design\x3d"headline" gutters\x3d"false" preventcache\x3d"true" usecache\x3d"false" cachecontent\x3d"false" region\x3d"center" class\x3d"borderedContent" style\x3d"width:100%; height:242px;"\x3e\r\n        \x3cdiv id\x3d"userGridContainer" data-dojo-type\x3d"dijit/layout/ContentPane" region\x3d"center" style\x3d"width:100%; height:100%;"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_validateEmailContainer" style\x3d"display:none;"\x3e\r\n        \x3clabel\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"validateEmailChoice" data-dojo-attach-point\x3d"_validateEmail" data-dojo-type\x3d"dijit/form/RadioButton" checked\x3d"true"\x3e\r\n          ${i18n.step3.mustValidateEmail}\r\n        \x3c/label\x3e\x3cbr\x3e\r\n        \x3clabel\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"validateEmailChoice" data-dojo-attach-point\x3d"_doNotValidateEmail" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n          ${i18n.step3.doNotValidateEmail}\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"step3ButtonRow" class\x3d"esriAlignTrailing"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_backInvitations" data-dojo-attach-event\x3d"onClick:onBackInvitations" class\x3d"calcite transparent small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.backLabel}\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_manageCredits" data-dojo-attach-event\x3d"onClick:onManageCredits" class\x3d"calcite tertiary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.step3.manageCredits}\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_groupSelection" data-dojo-attach-event\x3d"onClick:onGroupSelection" class\x3d"calcite tertiary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.step3.specifyGroups}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_sendInvitations" data-dojo-attach-event\x3d"onClick:onSendInvitations" class\x3d"calcite secondary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.step3.sendInvitations}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_step4" style\x3d"display:none;" class\x3d"specifyGroups"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeaderGroups"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\x3clabel data-dojo-attach-point\x3d"_step4Message"\x3e${i18n.step4.message}\x3c/label\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_groupSelector" data-dojo-type\x3d"arcgisonline/sharing/dijit/GroupSelector"\r\n           data-dojo-props\x3d"autoLoad: true, excludeEnterpriseGroups: true, excludeSharedUpdateGroups: true, enableListActions: true" class\x3d"marginBottom15"\x3e\x3c/div\x3e\r\n      \x3cdiv id\x3d"step4ButtonRow" class\x3d"esriAlignTrailing"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_backGroups" data-dojo-attach-event\x3d"onClick:onBackGroups" class\x3d"calcite transparent small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.backLabel}\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_manageCredits2" data-dojo-attach-event\x3d"onClick:onManageCredits" class\x3d"calcite tertiary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.step3.manageCredits}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_sendGroupInvitations" data-dojo-attach-event\x3d"onClick:onSendInvitations" class\x3d"calcite secondary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.step3.sendInvitations}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_completed" style\x3d"display:none;"\x3e\r\n      \x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeaderComplete"\x3e\r\n        \x3cdiv class\x3d"stepMessageContainer"\x3e\r\n          \x3cdiv class\x3d"stepMessage"\x3e\r\n            \x3ch3\x3e${i18n.completed.title}\x3c/h3\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_completedMessageSpan"\x3e\x3cimg alt\x3d"success" data-dojo-attach-point\x3d"_completeCheckIcon" class\x3d"completeSuccess"/\x3e \x3cspan data-dojo-attach-point\x3d"_completedMessage"\x3e\x3c/span\x3e\x3c/span\x3e\x3cbr\x3e\x3cbr\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_uninvitedMessageSpan" style\x3d"display:none;"\x3e\x3cdiv data-dojo-attach-point\x3d"_uninvitedMessage" style\x3d"color:red;"\x3e\x3c/div\x3e\x3cbr\x3e\x3cbr\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_existedUserMessageSpan" style\x3d"display:none;"\x3e\x3cdiv data-dojo-attach-point\x3d"_existedUserMessage" style\x3d"color:red;"\x3e\x3c/div\x3e\x3cbr\x3e\x3cbr\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_inviteMoreBtn" data-dojo-attach-event\x3d"onClick:onInviteMoreClicked" class\x3d"calcite tertiary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.completed.inviteAnother}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_returnToOrgBtn" data-dojo-attach-event\x3d"onClick:onReturnToOrgClicked" class\x3d"calcite secondary small" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${i18n.completed.returnToOrg}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
_util:arcgisonline.sharing.util,_pageUtil:arcgisonline.pages.pageUtil,_account:arcgisonline.sharing.geow.Account,_geow:arcgisonline.sharing.geow.Geow,_user:null,_settings:null,_mode:null,_isPortal:!1,_currentIDP:null,_supportsEnterpriseGroups:!1,_supportsSAML:!1,_supportsWindows:!1,_supportsLDAP:!1,_portalDefaultUser:"account_user",_portalDefaultLevel:"2",_topButtonRow:null,_mainContent:null,_step1:null,_idpOptionDiv:null,_idpOptionLabel:null,_createOptionLabel:null,_inviteOptionLabel:null,_idpUsersBtn:null,
_createUsersBtn:null,_inviteUsersBtn:null,_createUsersBtnContainer:null,_createTypeContainer:null,_nextBtn:null,_step1Create:null,_userType:null,_radioBuiltin:null,_radioSAML:null,_radioSAMLLabel:null,_radioEnterprise:null,_radioEnterpriseLabel:null,_step2IDP:null,_step2IDPMsgLabel:null,_idpErrorContainer:null,_idpTabContainer:null,_idpTabs:null,_idpSingleTab:null,_idpSingleEmail:null,_idpSingleRole:null,_idpSingleRoleStore:null,_idpEsriAccessCheckBox:null,_idpSingleMessage:null,_idpSingleInviteBtn:null,
_idpSingleReviewBtn:null,_idpBatchTab:null,_idpBatchForm:null,_idpBatchFile:null,_idpBatchMessage:null,_idpBatchUploadBtn:null,_currentSelectedIDPRole:null,_currentIDPMessage:null,_editingIDP:!1,_editingIDPUser:null,_addMode:!1,_step2Create:null,_step2CreateMsgLabel:null,_createErrorContainer:null,_createTabContainer:null,_createTabs:null,_createSingleTab:null,_createSingleEmail:null,_createSingleFirstName:null,_createSingleLastName:null,_createSingleUsername:null,_createSingleRole:null,_createSingleRoleStore:null,
_createSingleEsriAccessCheckBox:null,_createSingleMessage:null,_createSingleInviteBtn:null,_createSingleReviewBtn:null,_createBatchTab:null,_createBatchFile:null,_createBatchMessage:null,_createBatchUploadBtn:null,_createEnterpriseTab:null,_createEnterpriseGroup:null,_createEnterpriseSearchBtn:null,_createGroupRole:null,_createGroupRoleStore:null,_createGroupMessage:null,_createGroupReviewBtn:null,_createEnterpriseUser:null,_createUserInviteBtn:null,_createUserReviewBtn:null,_createUserBackBtn:null,
_currentSelectedCreateRole:null,_currentCreateMessage:null,_editingCreate:!1,_editingCreateUser:null,_settingCreateSingleEmail:!1,_settingCreateSingleUser:!1,_fixErrors:null,_fixErrorsMsgLabel:null,_fixErrorsErrorContainer:null,_fixErrorsContainer:null,_fixErrorsContentPane:null,_fixAlertDiv:null,_fixAlert:null,_fixBackBtn:null,_fixBtn:null,_fixReviewBtn:null,_fixEditDiv:null,_fixCurrent:null,_fixEmail:null,_fixFirstName:null,_fixLastName:null,_fixUsername:null,_fixPassword:null,_fixRoleStore:null,
_fixRole:null,_fixNextBtn:null,_minUsernameLength:6,_maxUsernameLength:128,_minSAMLUsernameLength:1,_maxSAMLUsernameLength:128,_minPasswordLength:8,_maxPasswordLength:28,_numToFix:0,_totalUsers:0,_fixingNumber:0,_currentlyFixing:null,_settingFixEmail:null,_settingFixUsername:null,_step2Invite:null,_step2InviteLabel:null,_inviteErrorContainer:null,_inviteTabContainer:null,_inviteTabs:null,_inviteSingleTab:null,_inviteSingleEmail:null,_inviteSingleRole:null,_inviteSingleRoleStore:null,_inviteEsriAccessCheckBox:null,
_inviteSingleMessage:null,_inviteSingleInviteBtn:null,_inviteSingleReviewBtn:null,_inviteBatchTab:null,_inviteBatchForm:null,_inviteBatchFile:null,_inviteBatchMessage:null,_inviteBatchUploadBtn:null,_currentSelectedInviteRole:null,_currentInviteMessage:null,_editingInvite:!1,_editingInviteUser:null,_step3:null,_userStore:null,_userGrid:null,_sendInvitations:null,_userLimitReached:!1,_userCount:0,_ReviewErrorContainer:null,_creditsToAssign:null,_completed:null,_completedMessage:null,_completedMessageSpan:null,
_uninvitedMessageSpan:null,_uninvitedMessage:null,_inviteMoreBtn:null,_returnToOrgBtn:null,_completeCheckIcon:null,_existedUserMessage:null,_existedUserMessageSpan:null,_invitingUser:null,accountAdminRole:"account_admin",accountPublisherRole:"account_publisher",accountUserRole:"account_user",orgAdminRole:"org_admin",orgPublisherRole:"org_publisher",orgUserRole:"org_user",modeIDP:"idp",modeCreate:"create",modeInvite:"invite",maxUsersPerInvite:25,userInviteLimitBeforeSplit:25,arcgisUserType:"arcgisonly",
arcgisProvider:"arcgis",enterpriseProvider:"enterprise",allProviders:"all",maxGroups:512,isTrialOrg:!1,trialOrgTypes:["Trial","Trial Developer","HUP Online Entitlements","Trial Press","Personal Use"],i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").organizationInvite)},postCreate:function(){esriGeowConfig.isRightToLeft&&(c.addClass(this._mainContent,
"mainContentRtl"),c.removeClass(this._mainContent,"mainContent"),c.addClass(this._topButtonRow,"topButtonRowRtl"),c.removeClass(this._topButtonRow,"topButtonRow"));this._completeCheckIcon&&c.attr(this._completeCheckIcon,"src",this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/check.png"));this._setupAssignCreditsDlg();this._setupTooltips()},startup:function(){esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;esriGeowConfig.proxyUrl&&(esri.config.defaults.io.proxyUrl=
esriGeowConfig.proxyUrl);this._rolesAPI=new arcgisonline.sharing.geow.Roles;this.hide();this._user=this._util.getUser();this._createUsersBtn.set("disabled",!0);this._inviteUsersBtn.set("disabled",!0);this._account.getSelf(c.hitch(this,this.handleGetSelf),c.hitch(this,this.handleGetSelf));this._setupAriaLabels()},destroy:function(){this.inherited(arguments);this._tooltips.forEach(function(a){a&&a.destroy()})},_setupAriaLabels:function(){this._util.overrideDojoAriaLabel(this._topCancelBtn.focusNode,
this.i18n.cancel);this._util.overrideDojoAriaLabel(this._step1NextBtn.focusNode,this.i18n.next);this._util.overrideDojoAriaLabel(this._backInvitations.focusNode,this.i18n.backLabel);this._util.overrideDojoAriaLabel(this._manageCredits.focusNode,this.i18n.step3.manageCredits);this._util.overrideDojoAriaLabel(this._groupSelection.focusNode,this.i18n.step3.specifyGroups);this._util.overrideDojoAriaLabel(this._sendInvitations.focusNode,this.i18n.step3.sendInvitations);this._util.overrideDojoAriaLabel(this._backGroups.focusNode,
this.i18n.backLabel);this._util.overrideDojoAriaLabel(this._manageCredits2.focusNode,this.i18n.step3.manageCredits);this._util.overrideDojoAriaLabel(this._sendGroupInvitations.focusNode,this.i18n.step3.sendInvitations);this._util.overrideDojoAriaLabel(this._inviteMoreBtn.focusNode,this.i18n.completed.inviteAnother)},_setupRequiredField:function(a){c.create("label",{"class":"required-field",innerHTML:"\x26nbsp;*"},a)},_setupTooltips:function(){this._tooltips=[]},_configureLevelInfoPopup:function(a){this._levelInfoTooltip?
this._levelInfoTooltip.addTarget(a):(this._levelInfoTooltip=this._createLevelInfoPopup(a),this._tooltips.push(this._levelInfoTooltip))},_createLevelInfoPopup:function(a){var c;c='\x3cdiv style\x3d"max-width:300px"\x3e\x3cdiv class\x3d"level-info-content"\x3e\x3clabel class\x3d"level-info-title"\x3e'+this.i18n.memberLevelsTitle+'\x3c/label\x3e\x3cp\x3e\x3clabel class\x3d"level-info-section-title"\x3e'+esri.substitute({level:this.LICENSE_LEVELS.ONE},this.i18n.levelTitle)+"\x3c/label\x3e\x3cbr\x3e"+
(this._isSingleTenant?this.i18n.levelOneDescPortal:this.i18n.levelOneDesc)+'\x3c/p\x3e\x3cp\x3e\x3clabel class\x3d"level-info-section-title"\x3e'+esri.substitute({level:this.LICENSE_LEVELS.TWO},this.i18n.levelTitle)+"\x3c/label\x3e\x3cbr\x3e"+this.i18n.levelTwoDesc+"\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e";return new l.Tooltip({label:c,connectId:[a],id:"level-info-popup",show:200})},_setupAssignCreditsDlg:function(){var a=c.declare([arcgisonline.sharing.dijit.dialog.AssignCreditsDlg],{postMixInProperties:function(){this.inherited(arguments);
this.i18n.setAllocation=c.i18n.getLocalization("arcgisonline","arcgisonline").organizationInvite.step3.setAllocation},_assignCredits:function(){var a=this._setAllocationRadioBtn.get("checked"),f=this._credits.get("value"),d;if(this._validates())if(this._setAssigning(!0),a)try{d=c.number.parse(f),d=isNaN(d)?parseFloat(f):d,c.topic.publish("credits-assign",{credits:d}),this.hide()}catch(b){this._createOneTimeTooltip(this.i18n.creditsNumberRequired,this._okBtn.domNode),this._setAssigning(!1)}else c.topic.publish("credits-assign",
{credits:-1}),this.hide()},show:function(a){this._username="";this._clear();a&&-1!==a?-1<a&&(this._setAllocationRadioBtn.set("checked",!0),this._credits.set("value",""+a),this._credits.set("displayedValue",""+a)):this._setUnlimitedRadioBtn.set("checked",!0);this._dialog.show()}});a.prototype.statics={_instance:null,getInstance:function(){null==this._instance&&(this._instance=new a);return this._instance}};this._assignCreditsDlg=a.prototype.statics.getInstance();c.topic.subscribe("credits-assign",
c.hitch(this,function(a){try{this._creditsToAssign=parseFloat(a.credits)}catch(f){this._creditsToAssign=-1}}))},_createProgressBars:function(){this._util.createStepProgressIndicatorAndPlace(1,4,this._stepHeader1,"first");this._util.createStepProgressIndicatorAndPlace(1,4,this._stepHeader1Create,"first");this._util.createStepProgressIndicatorAndPlace(2,4,this._stepHeader2IDP,"first");this._util.createStepProgressIndicatorAndPlace(2,4,this._stepHeader2Create,"first");this._util.createStepProgressIndicatorAndPlace(2,
4,this._stepHeader2FixErrors,"first");this._util.createStepProgressIndicatorAndPlace(2,4,this._stepHeader2Invite,"first");this._util.createStepProgressIndicatorAndPlace(3,4,this._stepHeader3,"first");this._util.createStepProgressIndicatorAndPlace(3,4,this._stepHeaderGroups,"first");this._util.createStepProgressIndicatorAndPlace(4,4,this._stepHeaderComplete,"first")},_createTable:function(a){return c.create("tbody",null,c.create("table",{style:{width:"100%"}},a))},_createSpacerRow:function(a){a=c.create("tr",
null,a);c.create("td",{innerHTML:"\x26nbsp;"},a);return a},_checkEnterpriseGroupStore:function(){var a=new c.Deferred,e=this._util.getPortalAdminBaseUrl()+"/security/config",f;this._isPortal?this._util.request({url:e}).then(c.hitch(this,function(d){d&&(d.defaultRoleForUser&&(this._portalDefaultUser=d.defaultRoleForUser),d.defaultLevelForUser&&(this._portalDefaultLevel=d.defaultLevelForUser),d.defaultIDPUsernameSuffix&&(this._samlSuffix=d.defaultIDPUsernameSuffix));d&&d.groupStoreConfig&&d.groupStoreConfig.type&&
(f=d.groupStoreConfig.type.toLowerCase(),"builtin"!==f&&"saml"!==f&&(this._isWindowsGroupStore="windows"===f,this._supportsEnterpriseGroups=!0));d&&d.userStoreConfig&&d.userStoreConfig.type&&(f=d.userStoreConfig.type.toLowerCase(),"windows"===f&&(this._supportsWindows=!0),"ldap"===f&&(this._supportsLDAP=!0));a.resolve()}),c.hitch(this,function(d){a.resolve()})):a.resolve();return a},buildFixErrors:function(){var a=c.create,e=esriGeowConfig.isRightToLeft?"labelColRtl":"labelCol",f=a("div");this._fixAlertDiv=
a("div",null,f);var d=a("span",null,a("div",null,this._fixAlertDiv));a("img",{src:this._util.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/exclamation.png"),alt:"",style:{"vertical-align":"middle"}},d);var b=esri.substitute({x:this._numToFix,n:this._totalUsers,name:this._isPortal?this._settings.name:this.i18n.arcgis},this._addMode?this.i18n.fixErrors.needAttentionAdd:this.i18n.fixErrors.needAttention);this._fixAlert=a("span",{innerHTML:" "+b},d);a("p",{innerHTML:this.i18n.fixErrors.ifNoFix},
this._fixAlertDiv);this._fixBackBtn=new l.form.Button({type:"button",label:this.i18n.backLabel},a("div",null,this._fixAlertDiv));c.addClass(this._fixBackBtn.domNode,"calcite transparent small");this._fixBtn=new l.form.Button({type:"button",label:this.i18n.fixErrors.fixTheseIssues},a("div",null,this._fixAlertDiv));c.addClass(this._fixBtn.domNode,"calcite secondary small");this._util.overrideDojoAriaLabel(this._fixBackBtn.focusNode,this._fixBackBtn.get("label"));this._util.overrideDojoAriaLabel(this._fixBtn.focusNode,
this._fixBtn.get("label"));this._fixEditDiv=a("div",null,f);d=a("tbody",null,a("table",null,this._fixEditDiv));this._createSpacerRow(d);var b=a("tr",null,d),b=a("td",{colSpan:"2"},b),g=esri.substitute({x:this._fixingNumber,n:this._numToFix,name:this._isPortal?this._settings.name:this.i18n.arcgis},this._addMode?this.i18n.fixErrors.usersNeedAttentionAdd:this.i18n.fixErrors.usersNeedAttention);this._fixCurrent=a("span",{innerHTML:g},b);this._createSpacerRow(d);"builtin"!==this._userType&&"saml"!==this._userType&&
this._isPortal||(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixEmail'\x3e"+this.i18n.fixErrors.email+"\x3c/label\x3e"},b),b=a("td",null,b),this._fixEmail=new l.form.TextBox({id:"fixEmail",trim:!0,type:"text"},a("div",null,b)),this._setupRequiredField(b),this._createSpacerRow(d),"ja"===c.locale?(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixLastName'\x3e"+this.i18n.fixErrors.lastName+"\x3c/label\x3e"},b),b=
a("td",null,b),this._fixLastName=new l.form.TextBox({id:"fixLastName",trim:!0,type:"text"},a("div",null,b)),this._setupRequiredField(b),this._createSpacerRow(d),b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixFirstName'\x3e"+this.i18n.fixErrors.firstName+"\x3c/label\x3e"},b),b=a("td",null,b),this._fixFirstName=new l.form.TextBox({id:"fixFirstName",trim:!0,type:"text"},a("div",null,b))):(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixFirstName'\x3e"+
this.i18n.fixErrors.firstName+"\x3c/label\x3e"},b),b=a("td",null,b),this._fixFirstName=new l.form.TextBox({id:"fixFirstName",trim:!0,type:"text"},a("div",null,b)),this._setupRequiredField(b),this._createSpacerRow(d),b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixLastName'\x3e"+this.i18n.fixErrors.lastName+"\x3c/label\x3e"},b),b=a("td",null,b),this._fixLastName=new l.form.TextBox({id:"fixLastName",trim:!0,type:"text"},a("div",null,b))),this._setupRequiredField(b),
this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixUsername'\x3e"+this.i18n.fixErrors.username+"\x3c/label\x3e"},b);b=a("td",null,b);this._fixUsername=new l.form.TextBox({id:"fixUsername",trim:!0,type:"text"},a("div",null,b));this._setupRequiredField(b);this._createSpacerRow(d);"builtin"!==this._userType&&this._isPortal||(this._fixPasswordRow=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixPassword'\x3e"+
this.i18n.fixErrors.password+"\x3c/label\x3e"},this._fixPasswordRow),b=a("td",null,this._fixPasswordRow),this._fixPassword=new l.form.TextBox({id:"fixPassword",trim:!0,type:"password"},a("div",null,b)),this._setupRequiredField(b),this._fixPasswordSpacer=this._createSpacerRow(d));esriGeowConfig.userLicenseLevelsEnabled&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'fixLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b),b=a("td",null,b),g=a("label",
{"for":"fixLevel1Radio",id:"fixLevel1Label",innerHTML:"\x26nbsp;"},b),this._fixLevel1Radio=new l.form.RadioButton({id:"fixLevel1Radio",name:"licenseLevel","aria-labelledby":"fixLevelLabel fixLevel1Label"},a("div",null,g)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.ONE,g,{id:"fixLevel1RadioBadge"},"last"),a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b),b=a("label",{"for":"fixLevel2Radio",id:"fixLevel2Label",innerHTML:"\x26nbsp;"},b),this._fixLevel2Radio=
new l.form.RadioButton({id:"fixLevel2Radio",name:"licenseLevel","aria-labelledby":"fixLevelLabel fixLevel2Label"},a("div",null,b)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO,b,{id:"fixLevel2RadioBadge",checked:!0},"last"),this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._fixLevel1Radio.set("checked",!0):this._fixLevel2Radio.set("checked",!0),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixRole'\x3e"+
this.i18n.fixErrors.role+"\x3c/label\x3e"},b);b=a("td",null,b);this._fixRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",label:"name",items:this._roleItems}});this._fixRoleStore.comparatorMap={name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};this._fixRole=new l.form.ComboBox({id:"fixRole",store:this._fixRoleStore,searchAttr:"name",fetchProperties:{sort:[{attribute:"name",descending:!1}]},style:{width:"125px",marginLeft:"0"}},a("div",null,b));this._isPortal?(this._fixRole.set("value",
this._lookupFullRoleName(this._portalDefaultUser)),this._fixRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._fixRole.set("value",this.i18n.userRoles.user),this._fixRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);!this._isPortal&&this._isAdmin&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'fixEsriAccess'\x3e"+this.i18n.allowEsriAccess+"\x3c/label\x3e"},b),e=a("td",null,b),this._fixEsriAccessCheckBox=new l.form.CheckBox({id:"fixEsriAccess"},
a("div",null,e)),this._createSpacerRow(d));e=a("tr",null,d);e=a("td",{colSpan:"2",style:{"text-align":"right"}},e);this._fixNextBtn=new l.form.Button({type:"button",label:this.i18n.fixErrors.next},a("div",null,e));c.addClass(this._fixNextBtn.domNode,"calcite blue small");c.connect(this._fixBackBtn,"onClick",this,this.onFixBackClicked);c.connect(this._fixBtn,"onClick",this,this.onFixClicked);c.connect(this._fixEmail,"onChange",this,this.onFixEmailChanged);c.connect(this._fixUsername,"onChange",this,
this.onFixUsernameChanged);this._fixPassword&&c.connect(this._fixPassword,"onChange",this,this.onFixPasswordChanged);c.connect(this._fixNextBtn,"onClick",this,this.onFixNextClicked);c.connect(this._fixRole,"onChange",this,this.onFixSingleRoleChanged);esriGeowConfig.userLicenseLevelsEnabled&&(c.connect(this._fixLevel1Radio,"onClick",this,this.onFixLevel1RadioClick),c.connect(this._fixLevel2Radio,"onClick",this,this.onFixLevel2RadioClick));c.style(this._fixEditDiv,"display","none");this._fixErrorsContentPane=
new l.layout.ContentPane({content:f},this._fixErrorsContainer);this._configureLevelInfoPopup("fixLevel1RadioBadge");this._configureLevelInfoPopup("fixLevel2RadioBadge")},buildCreateTabs:function(){var a=c.create,e=esriGeowConfig.isRightToLeft?"labelColRtl":"labelCol";this._createTabs=new l.layout.TabContainer({tabPosition:"top",doLayout:!1,useMenu:!1,style:{width:"550px",height:"420px"}},this._createTabContainer);var f=a("div");c.addClass(f,"tabForm");var d=this._createTable(f);this._createSpacerRow(d);
if(this._isPortal&&"saml"===this._userType){var b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3cstrong\x3e"+this.i18n.step2Create.addSAML+"\x3c/strong\x3e",colspan:2},b);this._samlSuffix&&(this._samlSuffixRow=a("tr",null,d),a("td",{className:e,innerHTML:esri.substitute({suffix:this._samlSuffix},this.i18n.step2Create.addSAMLSuffix),colspan:2},this._samlSuffixRow));this._createSpacerRow(d)}b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleEmail'\x3e"+
this.i18n.step2Create.email+"\x3c/label\x3e"},b);b=a("td",null,b);this._createSingleEmail=new l.form.TextBox({id:"createSingleEmail",trim:!0,type:"text"},a("div",null,b));this._setupRequiredField(b);this._createSpacerRow(d);"ja"===c.locale?(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleLastName'\x3e"+this.i18n.step2Create.lastName+"\x3c/label\x3e"},b),b=a("td",null,b),this._createSingleLastName=new l.form.TextBox({id:"createSingleLastName",trim:!0,
type:"text"},a("div",null,b)),this._setupRequiredField(b),this._createSpacerRow(d),b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleFirstName'\x3e"+this.i18n.step2Create.firstName+"\x3c/label\x3e"},b),b=a("td",null,b),this._createSingleFirstName=new l.form.TextBox({id:"createSingleFirstName",trim:!0,type:"text"},a("div",null,b))):(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleFirstName'\x3e"+
this.i18n.step2Create.firstName+"\x3c/label\x3e"},b),b=a("td",null,b),this._createSingleFirstName=new l.form.TextBox({id:"createSingleFirstName",trim:!0,type:"text"},a("div",null,b)),this._setupRequiredField(b),this._createSpacerRow(d),b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleLastName'\x3e"+this.i18n.step2Create.lastName+"\x3c/label\x3e"},b),b=a("td",null,b),this._createSingleLastName=new l.form.TextBox({id:"createSingleLastName",trim:!0,
type:"text"},a("div",null,b)));this._setupRequiredField(b);this._createSpacerRow(d);b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleUsername'\x3e"+this.i18n.step2Create.username+"\x3c/label\x3e"},b);b=a("td",null,b);this._createSingleUsername=new l.form.TextBox({id:"createSingleUsername",trim:!0,type:"text"},a("div",null,b));this._setupRequiredField(b);this._createSpacerRow(d);"builtin"!==this._userType&&this._isPortal||(this._createSinglePasswordRow=
a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSinglePassword'\x3e"+this.i18n.step2Create.password+"\x3c/label\x3e"},this._createSinglePasswordRow),b=a("td",null,this._createSinglePasswordRow),this._createSinglePassword=new l.form.TextBox({id:"createSinglePassword",trim:!0,type:"password"},a("div",null,b)),this._setupRequiredField(b),this._createSinglePasswordSpacer=this._createSpacerRow(d));var g;esriGeowConfig.userLicenseLevelsEnabled&&(b=a("tr",null,
d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'createSingleLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b),b=a("td",null,b),g=a("label",{"for":"createSingleLevel1Radio",id:"createSingleLevel1Label",innerHTML:"\x26nbsp;"},b),this._createSingleLevel1Radio=new l.form.RadioButton({id:"createSingleLevel1Radio",name:"licenseLevel","aria-labelledby":"createSingleLevelLabel createSingleLevel1Label"},a("div",null,g)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,
this.LICENSE_LEVELS.ONE,g,{id:"createSingleLevel1RadioBadge"},"last"),a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b),b=a("label",{"for":"createSingleLevel2Radio",id:"createSingleLevel2Label",innerHTML:"\x26nbsp;"},b),this._createSingleLevel2Radio=new l.form.RadioButton({id:"createSingleLevel2Radio",name:"licenseLevel","aria-labelledby":"createSingleLevelLabel createSingleLevel2Label"},a("div",null,b)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO,
b,{id:"createSingleLevel2RadioBadge",checked:!0},"last"),this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._createSingleLevel1Radio.set("checked",!0):this._createSingleLevel2Radio.set("checked",!0),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleRole'\x3e"+this.i18n.step2Create.role+"\x3c/label\x3e"},b);b=a("td",null,b);this._createSingleRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",
label:"name",items:this._roleItems}});this._createSingleRoleStore.comparatorMap={name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};this._createSingleRole=new l.form.ComboBox({id:"createSingleRole",store:this._createSingleRoleStore,searchAttr:"name",fetchProperties:{sort:[{attribute:"name",descending:!1}]},style:{width:"125px",marginLeft:"0"}},a("div",null,b));this._isPortal?(this._createSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._createSingleRole.set("title",
this.getRoleDesc(this._portalDefaultUser))):(this._createSingleRole.set("value",this.i18n.userRoles.user),this._createSingleRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);!this._isPortal&&this._isAdmin&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleEsriAccess'\x3e"+this.i18n.allowEsriAccess+"\x3c/label\x3e"},b),b=a("td",null,b),this._createSingleEsriAccessCheckBox=new l.form.CheckBox({id:"createSingleEsriAccess"},a("div",
null,b)),this._createSpacerRow(d));this._createSingleMsgRow=a("tr",{style:{display:this._addMode?"none":""}},d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createSingleMessage'\x3e"+this.i18n.step2Create.userMessage+"\x3c/label\x3e"},this._createSingleMsgRow);b=a("td",null,this._createSingleMsgRow);this._createSingleMessage=new l.form.SimpleTextarea({id:"createSingleMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},a("div",null,b));this.isTrialOrg&&c.style(this._createSingleMsgRow,
"display","none");b=esriGeowConfig.portalName||this.i18n.arcgis;g=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b},this.i18n.step2Create.emailMessage);this._isPortal&&(g=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name},this.i18n.step2Create.emailPortalMessage));this._createSingleMessage.set("value",g);this._createSpacerRow(d);d=a("tr",null,d);d=a("td",{colSpan:"2",className:"esriAlignTrailing"},d);this._createSingleBackBtn=
new l.form.Button({label:this.i18n.backLabel},a("div",null,d));c.addClass(this._createSingleBackBtn.domNode,"calcite transparent small");this._createSingleInviteBtn=new l.form.Button({label:this.i18n.step2Create.addAnother},a("div",null,d));this._createSingleReviewBtn=new l.form.Button({label:this.i18n.next},a("div",null,d));c.addClass(this._createSingleInviteBtn.domNode,"calcite tertiary small");c.addClass(this._createSingleReviewBtn.domNode,"calcite secondary small");this._util.overrideDojoAriaLabel(this._createSingleInviteBtn.focusNode,
this._createSingleInviteBtn.get("label"));this._util.overrideDojoAriaLabel(this._createSingleInviteBtn.focusNode,this._createSingleInviteBtn.get("label"));this._util.overrideDojoAriaLabel(this._createSingleReviewBtn.focusNode,this._createSingleReviewBtn.get("label"));var k=c.create("div"),d={firstNameHeader:this.i18n.csv.firstName,lastNameHeader:this.i18n.csv.lastName,emailHeader:this.i18n.csv.email,roleHeader:this.i18n.csv.role,usernameHeader:this.i18n.csv.username,passwordHeader:this.i18n.csv.password};
d.levelHeader=esriGeowConfig.userLicenseLevelsEnabled?this.i18n.csv.level:"";d.allowEsriAccessHeader=this._isPortal?"":this.i18n.csv.allowEsriAccess;g=esri.substitute(d,this._addMode?this.i18n.step2Create.uploadCSVAdd:this.i18n.step2Create.uploadCSV);esriGeowConfig.userLicenseLevelsEnabled||(g=g.substring(0,g.length-2));this._isPortal&&(g=esri.substitute(d,"saml"===this._userType?this.i18n.step2Create.uploadCSVAddSAML:"builtin"===this._userType?this.i18n.step2Create.uploadCSVPortal:this.i18n.step2Create.uploadCSVAddAD));
"saml"===this._userType?a("div",{className:"uploadDesc",innerHTML:"\x3cstrong\x3e"+this.i18n.step2Create.addSAML+"\x3c/strong\x3e"},k):"windows"===this._userType?a("div",{className:"uploadDesc",innerHTML:"\x3cstrong\x3e"+this.i18n.step2Create.addAD+"\x3c/strong\x3e"},k):"ldap"===this._userType&&a("div",{className:"uploadDesc",innerHTML:"\x3cstrong\x3e"+this.i18n.step2Create.addLDAP+"\x3c/strong\x3e"},k);this._createUploadMsg=a("div",{className:"uploadDesc",innerHTML:g},k);this._createBatchForm=c.create("form",
{id:"createBatchForm",enctype:"multipart/form-data",method:"post",onSubmit:"return false;"},k);9>c.isIE&&(this._createBatchForm.encoding="multipart/form-data");d=this._createTable(this._createBatchForm);this._createSpacerRow(d);g=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createBatchFile'\x3e"+this.i18n.step2Create.file+"\x3c/label\x3e"},g);g=a("td",null,g);g=a("span",null,g);this._createBatchFile=new l.form.TextBox({id:"createBatchFile",type:"file",name:"file"},
a("div",null,g));this._createSpacerRow(d);this._createBatchMsgRow=a("tr",{style:{display:this._addMode?"none":""}},d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createBatchMessage'\x3e"+this.i18n.step2Create.allUsersMessage+"\x3c/label\x3e"},this._createBatchMsgRow);g=a("td",null,this._createBatchMsgRow);this._createBatchMessage=new l.form.SimpleTextarea({id:"createBatchMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},a("div",null,g));this.isTrialOrg&&
c.style(this._createBatchMsgRow,"display","none");b=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b},this.i18n.step2Create.emailMessage);this._isPortal&&(b=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name},this.i18n.step2Create.emailPortalMessage));this._createBatchMessage.set("value",b);this._createSpacerRow(d);b=a("td",{colSpan:"2",className:"esriAlignTrailing"},a("tr",null,d));this._createBatchUploadBtn=new l.form.Button({type:"submit",
label:this._addMode||this._isPortal?this.i18n.step2Create.uploadAndReviewAdd:this.i18n.step2Create.uploadAndReview},a("div",null,b));c.addClass(this._createBatchUploadBtn.domNode,"calcite blue small");this._util.overrideDojoAriaLabel(this._createBatchUploadBtn.focusNode,this._createBatchUploadBtn.get("label"));this._createSpacerRow(d);this._createBatchTab=new l.layout.ContentPane({title:this.i18n.step2Create.batchTab,selected:!1,content:k});var m=a("div");c.addClass(m,"tabForm");d=this._createTable(m);
this._createSpacerRow(d);b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3cstrong\x3e"+("windows"===this._userType?this.i18n.step2Create.addAD:this.i18n.step2Create.addLDAP)+"\x3c/strong\x3e",colspan:2},b);this._createSpacerRow(d);b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createEnterpriseUser'\x3e"+this.i18n.step2Create.username+"\x3c/label\x3e"},b);b=a("td",null,b);b=a("span",{style:{position:"relative"}},b);this._createEnterpriseUser=new l.form.TextBox({id:"createEnterpriseUser",
type:"text",placeHolder:this.i18n.step2Create.userPlaceholder},a("div",null,b));this._setupRequiredField(b);this._createEnterpriseUserSearchBtn=new l.form.Button({type:"button",style:{position:"absolute"}},a("div",null,b));c.addClass(this._createEnterpriseUser.domNode,"enterpriseGroupSearchInput");c.addClass(this._createEnterpriseUserSearchBtn.domNode,"calcite userSearchIcon");c.addClass(this._createEnterpriseUserSearchBtn.domNode,"searchIconTrailing");this._createSpacerRow(d);esriGeowConfig.userLicenseLevelsEnabled&&
(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'createEnterpriseLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b),b=a("td",null,b),g=a("label",{"for":"createEnterpriseLevel1Radio",id:"createEnterpriseLevel1Label",innerHTML:"\x26nbsp;"},b),this._createEnterpriseLevel1Radio=new l.form.RadioButton({id:"createEnterpriseLevel1Radio",name:"licenseLevel","aria-labelledby":"createEnterpriseLevelLabel createEnterpriseLevel1Label"},a("div",null,g)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,
this.LICENSE_LEVELS.ONE,g,{id:"createEnterpriseLevel1RadioBadge"},"last"),a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b),b=a("label",{"for":"createEnterpriseLevel2Radio",id:"createEnterpriseLevel2Label",innerHTML:"\x26nbsp;"},b),this._createEnterpriseLevel2Radio=new l.form.RadioButton({id:"createEnterpriseLevel2Radio",name:"licenseLevel","aria-labelledby":"createEnterpriseLevelLabel createEnterpriseLevel2Label"},a("div",null,b)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,
this.LICENSE_LEVELS.TWO,b,{id:"createEnterpriseLevel2RadioBadge",checked:!0},"last"),this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._createEnterpriseLevel1Radio.set("checked",!0):this._createEnterpriseLevel2Radio.set("checked",!0),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createUserRole'\x3e"+this.i18n.step2Create.role+"\x3c/label\x3e"},b);b=a("td",null,b);this._createUserRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",
label:"name",items:this._roleItems}});this._createUserRole=new l.form.ComboBox({id:"createUserRole",store:this._createUserRoleStore,style:{width:"125px",marginLeft:"0"}},a("div",null,b));this._isPortal?(this._createUserRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._createUserRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._createUserRole.set("value",this.i18n.userRoles.user),this._createUserRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);
b=a("tr",null,d);b=a("td",{colSpan:"3",className:"esriAlignTrailing"},b);this._createUserBackBtn=new l.form.Button({label:this.i18n.backLabel},a("div",null,b));c.addClass(this._createUserBackBtn.domNode,"calcite transparent small");this._createUserInviteBtn=new l.form.Button({label:this.i18n.step2Create.addAnother},a("div",null,b));this._createUserReviewBtn=new l.form.Button({label:this.i18n.next},a("div",null,b));c.addClass(this._createUserInviteBtn.domNode,"calcite tertiary small");c.addClass(this._createUserReviewBtn.domNode,
"calcite secondary small");c.create("img",{src:this._util.relativeToExplicitUrl("js/arcgisonline/css/images/spinner20.gif"),width:"14",height:"14",style:{verticalAlign:"middle"}},a("span",{id:"reviewSpinnerUser",style:{display:"none"},innerHTML:" "},a("span",null,b)));this._createSpacerRow(d);var p=a("div");c.addClass(p,"tabForm");a("div",{className:"uploadDesc",innerHTML:this.i18n.step2Create.selectGroup},p);d=this._createTable(p);this._createSpacerRow(d);b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createEnterpriseGroup'\x3e"+
this.i18n.step2Create.enterpriseGroup+"\x3c/label\x3e"},b);b=a("td",null,b);b=a("span",{style:{position:"relative"}},b);this._createEnterpriseGroup=new l.form.TextBox({id:"createEnterpriseGroup",type:"text",placeHolder:this.i18n.step2Create.namePlaceholder},a("div",null,b));this._setupRequiredField(b);this._createEnterpriseSearchBtn=new l.form.Button({type:"button",style:{position:"absolute"}},a("div",null,b));c.addClass(this._createEnterpriseGroup.domNode,"enterpriseGroupSearchInput");c.addClass(this._createEnterpriseSearchBtn.domNode,
"calcite userSearchIcon");c.addClass(this._createEnterpriseSearchBtn.domNode,"searchIconTrailing");this._createSpacerRow(d);esriGeowConfig.userLicenseLevelsEnabled&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'createGroupLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b),b=a("td",null,b),g=a("label",{"for":"createGroupLevel1Radio",id:"createGroupLevel1Label",innerHTML:"\x26nbsp;"},b),this._createGroupLevel1Radio=new l.form.RadioButton({id:"createGroupLevel1Radio",
name:"licenseLevel","aria-labelledby":"createGroupLevelLabel createGroupLevel1Label"},a("div",null,g)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.ONE,g,{id:"createGroupLevel1RadioBadge"},"last"),a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b),b=a("label",{"for":"createGroupLevel2Radio",id:"createGroupLevel2Label",innerHTML:"\x26nbsp;"},b),this._createGroupLevel2Radio=new l.form.RadioButton({id:"createGroupLevel2Radio",name:"licenseLevel","aria-labelledby":"createGroupLevelLabel createGroupLevel2Label"},
a("div",null,b)),this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO,b,{id:"createGroupLevel2RadioBadge",checked:!0},"last"),this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._createGroupLevel1Radio.set("checked",!0):this._createGroupLevel2Radio.set("checked",!0),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'createGroupRole'\x3e"+this.i18n.step2Create.role+"\x3c/label\x3e"},b);e=
a("td",null,b);this._createGroupRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",label:"name",items:this._roleItems}});this._createGroupRoleStore.comparatorMap={name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};this._createGroupRole=new l.form.ComboBox({id:"createGroupRole",store:this._createGroupRoleStore,searchAttr:"name",fetchProperties:{sort:[{attribute:"name",descending:!1}]},style:{width:"125px",marginLeft:"0"}},a("div",null,e));this._isPortal?(this._createGroupRole.set("value",
this._lookupFullRoleName(this._portalDefaultUser)),this._createGroupRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._createGroupRole.set("value",this.i18n.userRoles.user),this._createGroupRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);this._createSpacerRow(d);e=a("tr",null,d);e=a("td",{colSpan:"2",className:"esriAlignTrailing"},e);this._createGroupReviewBtn=new l.form.Button({label:this.i18n.next},a("div",null,e));c.addClass(this._createGroupReviewBtn.domNode,
"calcite blue small");this._util.overrideDojoAriaLabel(this._createGroupReviewBtn.focusNode,this._createGroupReviewBtn.get("label"));c.create("img",{src:this._util.relativeToExplicitUrl("js/arcgisonline/css/images/spinner20.gif"),width:"14",height:"14",style:{verticalAlign:"middle"}},a("span",{id:"reviewSpinner",style:{display:"none"},innerHTML:" "},a("span",null,e)));this._createSpacerRow(d);this._createEnterpriseTab=new l.layout.ContentPane({title:this.i18n.step2Create.enterpriseTab,selected:!1,
content:p});c.connect(this._createBatchFile,"onClick",c.hitch(this,function(){this.resetCreateErrorMessage()}));"builtin"!==this._userType&&this._isPortal||c.connect(this._createSingleEmail,"onChange",this,this.onCreateEmailChanged);c.connect(this._createSingleUsername,"onChange",this,this.onCreateUsernameChanged);this._createSinglePassword&&c.connect(this._createSinglePassword,"onChange",this,this.onCreatePasswordChanged);c.connect(this._createBatchForm,"onSubmit",function(){return!1});c.connect(this._createBatchForm,
"onsubmit",this,this.onCreateBatchSubmit);c.connect(this._createEnterpriseGroup,"onKeyDown",this,this.onCreateEnterpriseGroupKeyDown);c.connect(this._createEnterpriseSearchBtn,"onClick",this,this.onSelectEnterpriseGroup);c.connect(this._createEnterpriseUser,"onKeyDown",this,this.onCreateEnterpriseUserKeyDown);c.connect(this._createEnterpriseUserSearchBtn,"onClick",this,this.onSelectEnterpriseUser);this._isPortal?c.connect(this._createSingleBackBtn,"onClick",this,this.onBackToStartPortal):c.connect(this._createSingleBackBtn,
"onClick",this,this.onBackToStart);c.connect(this._createUserBackBtn,"onClick",this,this.onBackToStartPortal);c.connect(this._createSingleInviteBtn,"onClick",this,this.onCreateAnotherClicked);c.connect(this._createSingleReviewBtn,"onClick",this,this.onCreateReviewClicked);c.connect(this._createSingleRole,"onChange",this,this.onCreateSingleRoleChanged);c.connect(this._createGroupReviewBtn,"onClick",this,this.onCreateGroupReviewClicked);c.connect(this._createUserInviteBtn,"onClick",this,this.onCreateAnotherUserClicked);
c.connect(this._createUserReviewBtn,"onClick",this,this.onCreateUserReviewClicked);esriGeowConfig.userLicenseLevelsEnabled&&(c.connect(this._createUserRole,"onChange",this,this.onCreateUserRoleChanged),c.connect(this._createGroupRole,"onChange",this,this.onCreateGroupRoleChanged),c.connect(this._createSingleLevel1Radio,"onClick",this,this.onCreateSingleLevel1RadioClick),c.connect(this._createSingleLevel2Radio,"onClick",this,this.onCreateSingleLevel2RadioClick),c.connect(this._createEnterpriseLevel1Radio,
"onClick",this,this.onCreateEnterpriseLevel1RadioClick),c.connect(this._createEnterpriseLevel2Radio,"onClick",this,this.onCreateEnterpriseLevel2RadioClick),c.connect(this._createGroupLevel1Radio,"onClick",this,this.onCreateGroupLevel1RadioClick),c.connect(this._createGroupLevel2Radio,"onClick",this,this.onCreateGroupLevel2RadioClick));c.subscribe("enterprise-group-selected",c.hitch(this,function(a){this._createEnterpriseGroup.set("value",a.rolename)}));c.subscribe("enterprise-user-selected",c.hitch(this,
function(a){this._createEnterpriseUser.set("value",a.username)}));this._createSingleTab=!this._isPortal||"ldap"!==this._userType&&"windows"!==this._userType?new l.layout.ContentPane({title:this.i18n.step2Create.singleTab,selected:!0,className:"tabForm",content:f}):new l.layout.ContentPane({title:this.i18n.step2Create.singleTab,selected:!0,className:"tabForm",content:m});this._createTabs.addChild(this._createSingleTab);this._createTabs.addChild(this._createBatchTab);this._isPortal&&this._supportsEnterpriseGroups&&
("ldap"===this._userType||"windows"===this._userType)&&(this._createTabs.addChild(this._createEnterpriseTab),c.attr(c.byId("item-title"),"innerHTML",this.i18n.docPortalTitle),c.connect(this._createEnterpriseTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(p)})));this._createTabs.startup();c.connect(this._createSingleTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(!this._isPortal||"ldap"!==this._userType&&"windows"!==this._userType?f:m)}));
c.connect(this._createBatchTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(k)}));(c.isIos||c.isAndroid)&&c.style(this._createBatchTab.controlButton.domNode,{display:"none"});this._configureLevelInfoPopup("createSingleLevel1RadioBadge");this._configureLevelInfoPopup("createSingleLevel2RadioBadge");this._configureLevelInfoPopup("createEnterpriseLevel1RadioBadge");this._configureLevelInfoPopup("createEnterpriseLevel2RadioBadge");this._configureLevelInfoPopup("createGroupLevel1RadioBadge");
this._configureLevelInfoPopup("createGroupLevel2RadioBadge");this._createTabs&&this._createTabs.selectedChildWidget&&this._createTabs.selectedChildWidget.onShow.call(this)},buildIDPTabs:function(){var a=c.create,e=esriGeowConfig.isRightToLeft?"labelColRtl":"labelCol";this._idpTabs=new l.layout.TabContainer({tabPosition:"top",doLayout:!1,useMenu:!1,style:{width:"550px",height:"380px"}},this._idpTabContainer);var f=a("div"),d=this._createTable(f);this._createSpacerRow(d);var b=a("tr",null,d);a("td",
{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpSingleEmail'\x3e"+this.i18n.step2IDP.email+"\x3c/label\x3e"},b);b=a("td",null,b);this._idpSingleEmail=new l.form.TextBox({id:"idpSingleEmail",trim:!0,type:"text"},a("div",null,b));this._setupRequiredField(b);this._createSpacerRow(d);if(esriGeowConfig.userLicenseLevelsEnabled){var b=a("tr",null,d),g;a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'idpLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b);
b=a("td",null,b);g=a("label",{"for":"idpLevel1Radio",id:"idpLevel1Label",innerHTML:"\x26nbsp;"},b);this._idpLevel1Radio=new l.form.RadioButton({id:"idpLevel1Radio",name:"licenseLevel","aria-labelledby":"idpLevelLabel idpLevel1Label"},a("div",null,g));this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.ONE,g,{id:"idpLevel1RadioBadge"},"last");a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b);b=a("label",{"for":"idpLevel2Radio",id:"idpLevel2Label",innerHTML:"\x26nbsp;"},
b);this._idpLevel2Radio=new l.form.RadioButton({id:"idpLevel2Radio",name:"licenseLevel","aria-labelledby":"idpLevelLabel idpLevel2Label"},a("div",null,b));this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO,b,{id:"idpLevel2RadioBadge",checked:!0},"last");this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._idpLevel1Radio.set("checked",!0):this._idpLevel2Radio.set("checked",!0);this._createSpacerRow(d)}b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpSingleRole'\x3e"+
this.i18n.step2IDP.role+"\x3c/label\x3e"},b);b=a("td",null,b);this._idpSingleRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",label:"name",items:this._roleItems}});this._idpSingleRoleStore.comparatorMap={name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};this._idpSingleRole=new l.form.ComboBox({id:"idpSingleRole",store:this._idpSingleRoleStore,searchAttr:"name",fetchProperties:{sort:[{attribute:"name",descending:!1}]},style:{width:"125px",marginLeft:"0"}},a("div",null,
b));this._isPortal?(this._idpSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._idpSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._idpSingleRole.set("value",this.i18n.userRoles.user),this._idpSingleRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);!this._isPortal&&this._isAdmin&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpEsriAccess'\x3e"+this.i18n.allowEsriAccess+"\x3c/label\x3e"},
b),b=a("td",null,b),this._idpEsriAccessCheckBox=new l.form.CheckBox({id:"idpEsriAccess"},a("div",null,b)),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpSingleMessage'\x3e"+this.i18n.step2IDP.userMessage+"\x3c/label\x3e"},b);g=a("td",null,b);this._idpSingleMessage=new l.form.SimpleTextarea({id:"idpSingleMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},a("div",null,g));this.isTrialOrg&&c.style(b,"display","none");
b=esriGeowConfig.portalName||this.i18n.arcgis;g=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b,idpName:this._currentIDP.name},this.i18n.step2IDP.emailMessage);this._isPortal&&(g=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,idpName:this._currentIDP.name},this.i18n.step2IDP.emailPortalMessage));this._idpSingleMessage.set("value",g);this._createSpacerRow(d);g=a("td",{colSpan:"2",className:"esriAlignTrailing"},
a("tr",null,d));this._idpSingleBackBtn=new l.form.Button({label:this.i18n.backLabel},a("div",null,g));this._idpSingleInviteBtn=new l.form.Button({label:this.i18n.step2IDP.inviteAnother},a("div",null,g));this._idpSingleReviewBtn=new l.form.Button({label:this.i18n.next},a("div",null,g));c.addClass(this._idpSingleBackBtn.domNode,"calcite transparent small");c.addClass(this._idpSingleInviteBtn.domNode,"calcite tertiary small");c.addClass(this._idpSingleReviewBtn.domNode,"calcite secondary small");this._util.overrideDojoAriaLabel(this._idpSingleBackBtn.focusNode,
this._idpSingleBackBtn.get("label"));this._util.overrideDojoAriaLabel(this._idpSingleInviteBtn.focusNode,this._idpSingleInviteBtn.get("label"));this._util.overrideDojoAriaLabel(this._idpSingleReviewBtn.focusNode,this._idpSingleReviewBtn.get("label"));this._createSpacerRow(d);this._idpSingleTab=new l.layout.ContentPane({title:this.i18n.step2IDP.singleTab,selected:!0,className:"tabForm",content:f});var k=c.create("div"),d={emailHeader:this.i18n.csv.email,roleHeader:this.i18n.csv.role};d.levelHeader=
esriGeowConfig.userLicenseLevelsEnabled?this.i18n.csv.level:"";d.allowEsriAccessHeader=this._isPortal?"":this.i18n.csv.allowEsriAccess;g=esri.substitute(d,this.i18n.step2IDP.uploadCSV);this._isPortal&&(g=esri.substitute(d,this.i18n.step2IDP.uploadCSVPortal));esriGeowConfig.userLicenseLevelsEnabled||(g=g.substring(0,g.length-2));a("div",{className:"uploadDesc",innerHTML:g},k);this._idpBatchForm=c.create("form",{id:"idpBatchForm",enctype:"multipart/form-data",method:"post",onSubmit:"return false;"},
k);9>c.isIE&&(this._idpBatchForm.encoding="multipart/form-data");d=this._createTable(this._idpBatchForm);this._createSpacerRow(d);g=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpBatchFile'\x3e"+this.i18n.step2IDP.file+"\x3c/label\x3e"},g);g=a("td",null,g);g=a("span",null,g);this._idpBatchFile=new l.form.TextBox({id:"idpBatchFile",type:"file",name:"file"},a("div",null,g));this._createSpacerRow(d);g=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'idpBatchMessage'\x3e"+
this.i18n.step2IDP.allUsersMessage+"\x3c/label\x3e"},g);e=a("td",null,g);this._idpBatchMessage=new l.form.SimpleTextarea({id:"idpBatchMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},a("div",null,e));this.isTrialOrg&&c.style(g,"display","none");e=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b,idpName:this._currentIDP.name},this.i18n.step2IDP.emailMessage);this._isPortal&&(e=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,
idpName:this._currentIDP.name},this.i18n.step2IDP.emailPortalMessage));this._idpBatchMessage.set("value",e);this._createSpacerRow(d);e=a("td",{colSpan:"2",className:"esriAlignTrailing"},a("tr",null,d));this._idpBatchUploadBtn=new l.form.Button({type:"submit",label:this.i18n.step2IDP.uploadAndReview},a("div",null,e));c.addClass(this._idpBatchUploadBtn.domNode,"calcite blue small");this._util.overrideDojoAriaLabel(this._idpBatchUploadBtn.focusNode,this._idpBatchUploadBtn.get("label"));this._createSpacerRow(d);
this._idpBatchTab=new l.layout.ContentPane({title:this.i18n.step2IDP.batchTab,selected:!1,content:k});c.connect(this._idpBatchFile,"onClick",c.hitch(this,function(){this.resetIDPErrorMessage()}));c.connect(this._idpBatchForm,"onSubmit",function(){return!1});c.connect(this._idpBatchForm,"onsubmit",this,this.onIDPBatchSubmit);c.connect(this._idpSingleBackBtn,"onClick",this,this.onBackToStart);c.connect(this._idpSingleInviteBtn,"onClick",this,this.onIDPAnotherClicked);c.connect(this._idpSingleReviewBtn,
"onClick",this,this.onIDPReviewClicked);c.connect(this._idpSingleRole,"onChange",this,this.onIDPSingleRoleChanged);esriGeowConfig.userLicenseLevelsEnabled&&(c.connect(this._idpLevel1Radio,"onClick",this,this.onIDPLevel1RadioClick),c.connect(this._idpLevel2Radio,"onClick",this,this.onIDPLevel2RadioClick));this._idpTabs.addChild(this._idpSingleTab);this._idpTabs.addChild(this._idpBatchTab);this._idpTabs.startup();c.connect(this._idpSingleTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(f)}));
c.connect(this._idpBatchTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(k)}));(c.isIos||c.isAndroid)&&c.style(this._idpBatchTab.controlButton.domNode,{display:"none"});this._configureLevelInfoPopup("idpLevel1RadioBadge");this._configureLevelInfoPopup("idpLevel2RadioBadge");this._idpTabs&&this._idpTabs.selectedChildWidget&&this._idpTabs.selectedChildWidget.onShow.call(this)},buildInviteTabs:function(){var a=c.create,e=esriGeowConfig.isRightToLeft?"labelColRtl":"labelCol";
this._inviteTabs=new l.layout.TabContainer({tabPosition:"top",doLayout:!1,useMenu:!1,style:{width:"550px",height:"380px"}},this._inviteTabContainer);var f=a("div"),d=this._createTable(f);this._createSpacerRow(d);var b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteSingleEmail'\x3e"+this.i18n.step2Invite.email+"\x3c/label\x3e"},b);b=a("td",null,b);this._inviteSingleEmail=new l.form.TextBox({id:"inviteSingleEmail",trim:!0,type:"text"},a("div",null,b));this._setupRequiredField(b);
this._createSpacerRow(d);if(esriGeowConfig.userLicenseLevelsEnabled){var b=a("tr",null,d),g;a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' id\x3d'inviteLevelLabel'\x3e"+this.i18n.licenseLevel+"\x3c/label\x3e"},b);b=a("td",null,b);g=a("label",{"for":"inviteLevel1Radio",id:"inviteLevel1Label",innerHTML:"\x26nbsp;"},b);this._inviteLevel1Radio=new l.form.RadioButton({id:"inviteLevel1Radio",name:"licenseLevel","aria-labelledby":"inviteLevelLabel inviteLevel1Label"},a("div",null,g));this._util.createLevelSpanAndPlace(this.i18n.levelLabel,
this.LICENSE_LEVELS.ONE,g,{id:"inviteLevel1RadioBadge"},"last");a("span",{innerHTML:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"},b);b=a("label",{"for":"inviteLevel2Radio",id:"inviteLevel2Label",innerHTML:"\x26nbsp;"},b);this._inviteLevel2Radio=new l.form.RadioButton({id:"inviteLevel2Radio",name:"licenseLevel","aria-labelledby":"inviteLevelLabel inviteLevel2Label"},a("div",null,b));this._util.createLevelSpanAndPlace(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO,b,{id:"inviteLevel2RadioBadge",checked:!0},
"last");this._isPortal&&this._portalDefaultLevel===this.LICENSE_LEVELS.ONE?this._inviteLevel1Radio.set("checked",!0):this._inviteLevel2Radio.set("checked",!0);this._createSpacerRow(d)}b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteSingleRole'\x3e"+this.i18n.step2Invite.role+"\x3c/label\x3e"},b);b=a("td",null,b);this._inviteSingleRoleStore=new c.data.ItemFileReadStore({data:{identifier:"role",label:"name",items:this._roleItems}});this._inviteSingleRoleStore.comparatorMap=
{name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};this._inviteSingleRole=new l.form.ComboBox({id:"inviteSingleRole",store:this._inviteSingleRoleStore,searchAttr:"name",fetchProperties:{sort:[{attribute:"name",descending:!1}]},style:{width:"125px",marginLeft:"0"}},a("div",null,b));this._isPortal?(this._inviteSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._inviteSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._inviteSingleRole.set("value",
this.i18n.userRoles.user),this._inviteSingleRole.set("title",this._getUserRoleTooltip()));this._createSpacerRow(d);!this._isPortal&&this._isAdmin&&(b=a("tr",null,d),a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteEsriAccess'\x3e"+this.i18n.allowEsriAccess+"\x3c/label\x3e"},b),b=a("td",null,b),this._inviteEsriAccessCheckBox=new l.form.CheckBox({id:"inviteEsriAccess"},a("div",null,b)),this._createSpacerRow(d));b=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteSingleMessage'\x3e"+
this.i18n.step2Invite.userMessage+"\x3c/label\x3e"},b);g=a("td",null,b);this._inviteSingleMessage=new l.form.SimpleTextarea({id:"inviteSingleMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},a("div",null,g));this.isTrialOrg&&c.style(b,"display","none");b=esriGeowConfig.portalName||this.i18n.arcgis;g=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b},this.i18n.step2Invite.emailMessage);this._isPortal&&(g=esri.substitute({user:this.createFullName(this._user),
organization:this._settings.name},this.i18n.step2Invite.emailPortalMessage));this._inviteSingleMessage.set("value",g);this._createSpacerRow(d);g=a("td",{colSpan:"2",className:"esriAlignTrailing"},a("tr",null,d));this._inviteSingleBackBtn=new l.form.Button({label:this.i18n.backLabel},a("div",null,g));this._inviteSingleInviteBtn=new l.form.Button({label:this.i18n.step2Invite.inviteAnother},a("div",null,g));this._inviteSingleReviewBtn=new l.form.Button({label:this.i18n.next},a("div",null,g));c.addClass(this._inviteSingleBackBtn.domNode,
"calcite transparent small");c.addClass(this._inviteSingleInviteBtn.domNode,"calcite tertiary small");c.addClass(this._inviteSingleReviewBtn.domNode,"calcite secondary small");this._util.overrideDojoAriaLabel(this._inviteSingleBackBtn.focusNode,this._inviteSingleBackBtn.get("label"));this._util.overrideDojoAriaLabel(this._inviteSingleInviteBtn.focusNode,this._inviteSingleInviteBtn.get("label"));this._util.overrideDojoAriaLabel(this._inviteSingleReviewBtn.focusNode,this._inviteSingleReviewBtn.get("label"));
this._createSpacerRow(d);this._inviteSingleTab=new l.layout.ContentPane({title:this.i18n.step2Invite.singleTab,selected:!0,className:"tabForm",content:f});var k=c.create("div"),d={emailHeader:this.i18n.csv.email,roleHeader:this.i18n.csv.role};d.levelHeader=esriGeowConfig.userLicenseLevelsEnabled?this.i18n.csv.level:"";d.allowEsriAccessHeader=this._isPortal?"":this.i18n.csv.allowEsriAccess;g=esri.substitute(d,this.i18n.step2Invite.uploadCSV);this._isPortal&&(g=esri.substitute(d,this.i18n.step2Invite.uploadCSVPortal));
esriGeowConfig.userLicenseLevelsEnabled||(g=g.substring(0,g.length-2));a("div",{className:"uploadDesc",innerHTML:g},k);this._inviteBatchForm=c.create("form",{id:"inviteBatchForm",enctype:"multipart/form-data",method:"post",onSubmit:"return false;"},k);9>c.isIE&&(this._inviteBatchForm.encoding="multipart/form-data");d=this._createTable(this._inviteBatchForm);this._createSpacerRow(d);g=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteBatchFile'\x3e"+this.i18n.step2Invite.file+
"\x3c/label\x3e"},g);g=a("td",null,g);g=a("span",null,g);this._inviteBatchFile=new l.form.TextBox({id:"inviteBatchFile",type:"file",name:"file"},a("div",null,g));this._createSpacerRow(d);g=a("tr",null,d);a("td",{className:e,innerHTML:"\x3clabel class\x3d'optionTitle' for\x3d'inviteBatchMessage'\x3e"+this.i18n.step2Invite.allUsersMessage+"\x3c/label\x3e"},g);e=a("td",null,g);this._inviteBatchMessage=new l.form.SimpleTextarea({id:"inviteBatchMessage",width:"290px",height:"80px",rows:5,style:{resize:"no"}},
a("div",null,e));this.isTrialOrg&&c.style(g,"display","none");e=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name,portalName:b},this.i18n.step2Invite.emailMessage);this._isPortal&&(e=esri.substitute({user:this.createFullName(this._user),organization:this._settings.name},this.i18n.step2Invite.emailPortalMessage));this._inviteBatchMessage.set("value",e);this._createSpacerRow(d);e=a("td",{colSpan:"2",className:"esriAlignTrailing"},a("tr",null,d));this._inviteBatchUploadBtn=
new l.form.Button({type:"submit",label:this.i18n.step2Invite.uploadAndReview},a("div",null,e));c.addClass(this._inviteBatchUploadBtn.domNode,"calcite blue small");this._util.overrideDojoAriaLabel(this._inviteBatchUploadBtn.focusNode,this._inviteBatchUploadBtn.get("label"));this._createSpacerRow(d);this._inviteBatchTab=new l.layout.ContentPane({title:this.i18n.step2Invite.batchTab,selected:!1,content:k});c.connect(this._inviteBatchFile,"onClick",c.hitch(this,function(){this.resetInviteErrorMessage()}));
c.connect(this._inviteBatchForm,"onSubmit",function(){return!1});c.connect(this._inviteBatchForm,"onsubmit",this,this.onInviteBatchSubmit);c.connect(this._inviteSingleBackBtn,"onClick",this,this.onBackToStart);c.connect(this._inviteSingleInviteBtn,"onClick",this,this.onInviteAnotherClicked);c.connect(this._inviteSingleReviewBtn,"onClick",this,this.onInviteReviewClicked);c.connect(this._inviteSingleRole,"onChange",this,this.onInviteSingleRoleChanged);esriGeowConfig.userLicenseLevelsEnabled&&(c.connect(this._inviteLevel1Radio,
"onClick",this,this.onInviteLevel1RadioClick),c.connect(this._inviteLevel2Radio,"onClick",this,this.onInviteLevel2RadioClick));this._inviteTabs.addChild(this._inviteSingleTab);this._inviteTabs.addChild(this._inviteBatchTab);this._inviteTabs.startup();c.connect(this._inviteSingleTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(f)}));c.connect(this._inviteBatchTab,"onShow",c.hitch(this,function(){this._util.applyChrome62ButtonRepaintFix(k)}));(c.isIos||c.isAndroid)&&c.style(this._inviteBatchTab.controlButton.domNode,
{display:"none"});this._configureLevelInfoPopup("inviteLevel1RadioBadge");this._configureLevelInfoPopup("inviteLevel2RadioBadge");this._inviteTabs&&this._inviteTabs.selectedChildWidget&&this._inviteTabs.selectedChildWidget.onShow.call(this)},buildCreateGridLayout:function(){var a=!!esriGeowConfig.userLicenseLevelsEnabled,e=[];e.push({field:"firstname",get:this.firstNameFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.firstName,width:a?"117px":"127px"});e.push({field:"lastname",
get:this.lastNameFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.lastName,width:a?"117px":"127px"});e.push({field:"email",get:this.emailFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.email,width:a?"117px":"127px"});a&&e.push({field:"level",get:this.levelFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.level,width:"60px"});e.push({field:"rolename",get:this.roleFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.role,
width:a?c.isSafari?"116px":"74px":c.isSafari?"126px":"84px"});e.push({field:"username",get:this.usernameFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.username,width:a?"117px":"127px"});e.push({get:this.editFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.edit,width:a?"117px":"127px"});return[e]},buildCreateUserGrid:function(){this._userGrid=new arcgisonline.sharing.dijit.DataGrid({structure:this.buildCreateGridLayout(),region:"center",noDataMessage:"",
id:"userGridNode",jsid:"userGrid",selectionMode:"none",clientSort:!0,gutters:!1,sortInfo:1,canSort:this.canSortColumns,updateDelay:0},c.byId("userGridContainer"));this._userGrid.startup()},buildInviteGridLayout:function(){var a=!!esriGeowConfig.userLicenseLevelsEnabled,c=[];c.push({field:"email",get:this.emailFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.email,width:"100%"});a&&c.push({field:"level",get:this.levelFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.level,
width:"60px"});c.push({field:"rolename",get:this.roleFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.role,width:"150px"});c.push({get:this.editFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.edit,width:"100px"});return[c]},buildInviteGroupGridLayout:function(){var a=!!esriGeowConfig.userLicenseLevelsEnabled,c=[];c.push({field:"fullname",get:this.fullNameFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.fullname,width:a?"117px":
"127px"});c.push({field:"username",get:this.usernameFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.username,width:"100%"});a&&c.push({field:"level",get:this.levelFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.level,width:"60px"});c.push({field:"rolename",get:this.roleFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.role,width:a?"140px":"150px"});c.push({field:"email",get:this.emailFormatter,formatter:arcgisonline.sharing.util.fix,
name:this.i18n.userGrid.email,width:a?"117px":"127px"});c.push({get:this.editFormatterGroup,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.edit,width:"100px"});return[c]},buildInviteUserGrid:function(){this._userGrid=new arcgisonline.sharing.dijit.DataGrid({structure:this.buildInviteGridLayout(),region:"center",noDataMessage:"",id:"userGridNode",jsid:"userGrid",selectionMode:"none",clientSort:!0,gutters:!1,sortInfo:1,canSort:this.canSortColumns},c.byId("userGridContainer"));this._userGrid.startup()},
buildInviteGroupUserGrid:function(){this._userGrid=new arcgisonline.sharing.dijit.DataGrid({structure:this.buildInviteGroupGridLayout(),region:"center",noDataMessage:"",id:"userGridNode",jsid:"userGrid",selectionMode:"none",clientSort:!0,gutters:!1,sortInfo:1,canSort:this.canSortGroupColumns},c.byId("userGridContainer"));this._userGrid.startup()},buildIDPGridLayout:function(){var a=!!esriGeowConfig.userLicenseLevelsEnabled,c=[];c.push({field:"email",get:this.emailFormatter,formatter:arcgisonline.sharing.util.fix,
name:this.i18n.userGrid.email,width:"100%"});a&&c.push({field:"level",get:this.levelFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.level,width:"60px"});c.push({field:"rolename",get:this.roleFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.role,width:"150px"});c.push({get:this.editFormatter,formatter:arcgisonline.sharing.util.fix,name:this.i18n.userGrid.edit,width:"100px"});return[c]},buildIDPUserGrid:function(){this._userGrid=new arcgisonline.sharing.dijit.DataGrid({structure:this.buildIDPGridLayout(),
region:"center",noDataMessage:"",id:"userGridNode",jsid:"userGrid",selectionMode:"none",clientSort:!0,gutters:!1,sortInfo:1,canSort:this.canSortColumns},c.byId("userGridContainer"));this._userGrid.startup()},buildUserStore:function(){var a;this._mode===this.modeInvite||this._mode===this.modeIDP?(a={identifier:"email",label:"email",items:[]},this._userStore=new c.data.ItemFileWriteStore({data:a})):this._mode===this.modeCreate&&(a={identifier:"username",label:"username",items:[]},this._userStore=new c.data.ItemFileWriteStore({data:a}));
this._userStore&&(this._userStore.comparatorMap={firstname:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,lastname:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,email:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,username:arcgisonline.sharing.geow.Account.caseInsensitiveComparator,rolename:arcgisonline.sharing.geow.Account.caseInsensitiveComparator})},initializeUserStore:function(){this._userStore||this.buildUserStore()},initializeCreateUserGrid:function(){if(this._userGrid){var a=
this.buildCreateGridLayout();this._userGrid.setStructure(a)}else this.buildCreateUserGrid();this._userStore&&(this._userGrid.set("store",this._userStore),this._userGrid.render());this.checkUserLimit()},initializeInviteUserGrid:function(){if(this._userGrid){var a=this.buildInviteGridLayout();this._userGrid.setStructure(a)}else this.buildInviteUserGrid();this._userStore&&(this._userGrid.set("store",this._userStore),this._userGrid.render());this.checkUserLimit()},initializeInviteGroupUserGrid:function(){if(this._userGrid){var a=
this.buildInviteGroupGridLayout();this._userGrid.setStructure(a)}else this.buildInviteGroupUserGrid();this._userStore.fetch({onComplete:c.hitch(this,function(a){c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(a,"email")&&""!==this._userStore.getValue(a,"email")||this.setReviewWarningMessage(this.i18n.step3.missingEmail)}))})});this._userStore&&(this._userGrid.set("store",this._userStore),this._userGrid.render());this.checkUserLimit()},initializeIDPUserGrid:function(){if(this._userGrid){var a=
this.buildIDPGridLayout();this._userGrid.setStructure(a)}else this.buildIDPUserGrid();this._userStore&&(this._userGrid.set("store",this._userStore),this._userGrid.render());this.checkUserLimit()},checkUserLimit:function(){var a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),e=esri.substitute({totalUsers:this._isPortal?this._portalLicenseInfo.currentRegisteredMembers:this._userCount,maxUsers:this._isPortal?this._portalLicenseInfo.maximumRegisteredMembers:this._settings.subscriptionInfo.maxUsers},
"\x3cp\x3e"+(this._addMode?this._isPortal?this.i18n.step3.tooManyUsersAddPortal:this.i18n.step3.tooManyUsersAdd:this._isPortal?this.i18n.step3.tooManyUsersPortal:this.i18n.step3.tooManyUsers)+"\x3c/p\x3e\x3cp\x3e"+(this._addMode?this._isPortal?this.i18n.step3.tooManyUsersAdviceAddPortal:this.i18n.step3.tooManyUsersAdviceAdd:this._isPortal?this.i18n.step3.tooManyUsersAdvicePortal:this.i18n.step3.tooManyUsersAdvice)+"\x3c/p\x3e");this._userLimitReached?(this._sendInvitations.set("disabled",!0),this._manageCredits.set("disabled",
!0),this._manageCredits2.set("disabled",!0),this._groupSelection.set("disabled",!0),this._sendGroupInvitations.set("disabled",!0),a.show({title:this.i18n.notice,message:e})):this._userStore?this._userStore.fetch({onComplete:c.hitch(this,function(c){c=this._userCount+(c?c.length:0);!this._isPortal&&-1<this._settings.subscriptionInfo.maxUsers&&c>this._settings.subscriptionInfo.maxUsers||this._isPortal&&-1<this._portalLicenseInfo.maximumRegisteredMembers&&c>this._portalLicenseInfo.maximumRegisteredMembers?
(this._sendInvitations.set("disabled",!0),this._manageCredits.set("disabled",!0),this._manageCredits2.set("disabled",!0),this._groupSelection.set("disabled",!0),this._sendGroupInvitations.set("disabled",!0),a.show({title:this.i18n.notice,message:e})):(this._sendInvitations.set("disabled",!1),this._manageCredits.set("disabled",!1),this._manageCredits2.set("disabled",!1),this._groupSelection.set("disabled",!1),this._sendGroupInvitations.set("disabled",!1))})}):(this._sendInvitations.set("disabled",
!1),this._manageCredits.set("disabled",!1),this._manageCredits2.set("disabled",!1),this._groupSelection.set("disabled",!1),this._sendGroupInvitations.set("disabled",!1))},handleGetSelf:function(a){if(a&&!a.code&&!a.message){this._settings=a;if(this._isPortal=this._util.isPortal())c.attr(this._inviteMoreBtn,"label",this.i18n.completed.addAnother),this._util.overrideDojoAriaLabel(this._inviteMoreBtn.focusNode,this.i18n.completed.addAnother);this._customRoles=[];this._isAdmin=esriGeowConfig.userRole&&
esriGeowConfig.userRole.isAdmin();this._isCustomRole=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom();this._roleCanInviteUsers=esriGeowConfig.userRole&&esriGeowConfig.userRole.canViewUsers()&&esriGeowConfig.userRole.canInviteUsers();this._roleCanAddUsers=this._isCustomRole&&esriGeowConfig.userRole.canAssignUsersToOrgGroups();this._canManageCredits=!this._util.isPortal()&&esriGeowConfig.creditBudgetingEnabled&&this._user.role&&this._isAdmin&&esri.isDefined(this._settings.creditAssignments)&&
("enabled"===this._settings.creditAssignments||"validated"===this._settings.creditAssignments);this.isTrialOrg=!this._isPortal&&this._pageUtil.includes(this.trialOrgTypes,this._settings.subscriptionInfo.type);this.setupInvitingUser(a.user);this.getPasswordPolicy();this._isAdmin||this._isCustomRole&&this._roleCanInviteUsers?this.getRoles().then(c.hitch(this,function(){c.promise.all([this.getIDP(),this.getSocialProviders()]).then(c.hitch(this,this.configure))})):this.getRoles().then(c.hitch(this,this.configure))}},
getPasswordPolicy:function(){this._util.request({url:this._util.getSecureUrl(esriGeowConfig.restBaseUrl)+"portals/self/securityPolicy/passwordPolicy"}).then(c.hitch(this,function(a){this._passwordPolicy=!a||a.code||a.messageCode?null:a}))},setupInvitingUser:function(a){this._invitingUser=c.clone(a)},getCustomRoleId:function(a){var c;if(a)for(var f=0;f<this._customRoles.length;f++)if(this._customRoles[f].name&&this._customRoles[f].name.toLowerCase()===a.toLowerCase()){c=this._customRoles[f].id;break}return c},
getCustomRoleName:function(a){for(var c,f=0;f<this._customRoles.length;f++)if(this._customRoles[f].id===a){c=this._customRoles[f].name;break}return c},getCustomRoleDesc:function(a){for(var c,f=0;f<this._customRoles.length;f++)if(this._customRoles[f].id===a){c=this._customRoles[f].description;break}return c},getRoleDesc:function(a){return a===this.accountAdminRole||a===this.orgAdminRole?this._getAdminRoleTooltip():a===this.accountPublisherRole||a===this.orgPublisherRole?this._getPublisherRoleTooltip():
a===this.accountUserRole||a===this.orgUserRole?this._getUserRoleTooltip():esriGeowConfig.userLicenseLevelsEnabled&&a===this.SYSTEM_ROLES.VIEWER?this._getViewerRoleTooltip():this.getCustomRoleDesc(a)},getRoles:function(){var a=new c.Deferred;this._rolesAPI.getAllRoles(!0).then(c.hitch(this,function(e){this._customRoles=e;esriGeowConfig.userLicenseLevelsEnabled&&(this._viewerRole=this._localizeViewerRole(this._customRoles));this._allCustomRoles=c.clone(this._customRoles);this.filterRoles();a.resolve()}));
return a},_localizeViewerRole:function(a){if(a)for(var c=0;c<a.length;c++)if(a[c]&&a[c].id===this.SYSTEM_ROLES.VIEWER)return a[c].name=this.i18n.userRoles.viewer,a[c]},filterRoles:function(a){this._roleItems=a?[]:[{role:this.accountPublisherRole,name:this.i18n.userRoles.publisher},{role:this.accountUserRole,name:this.i18n.userRoles.user}];this._isPortal&&!a&&this._pageUtil.includes([this.orgAdminRole,this.accountAdminRole],this._user.role)&&this._roleItems.push({role:this.accountAdminRole,name:this.i18n.userRoles.admin});
for(var c=[],f=0;f<this._allCustomRoles.length;f++){var d=!1,b=!1,g;if(this._allCustomRoles[f]&&this._allCustomRoles[f].privileges&&(b=esriGeowConfig.userLicenseLevelsEnabled&&!!a&&this._viewerRole&&arcgisonline.sharing.geow.Roles.exceedsRolePrivileges(["portal:user:joinNonOrgGroup"].concat(this._viewerRole.privileges),this._allCustomRoles[f].privileges),!a))for(var k=0;k<this._allCustomRoles[f].privileges.length;k++)if(g=this._allCustomRoles[f].privileges[k],-1<g.indexOf(":admin")){d=!0;break}!b&&
(!d||this._isPortal&&this._pageUtil.includes([this.orgAdminRole,this.accountAdminRole],this._user.role))&&(c.push(this._allCustomRoles[f]),this._roleItems.push({role:this._allCustomRoles[f].id,name:this._allCustomRoles[f].name}))}this._customRoles=c},_isValidLevelOneRole:function(a){for(var c=this._viewerRole,f=0;f<this._allCustomRoles.length;f++)if(this._allCustomRoles[f]&&this._allCustomRoles[f].privileges&&this._allCustomRoles[f].id===a)return c&&arcgisonline.sharing.geow.Roles.exceedsRolePrivileges(["portal:user:joinNonOrgGroup"].concat(this._viewerRole.privileges),
this._allCustomRoles[f].privileges);return!1},_coreRoleSelected:function(a){a=a.get("value");return a===this.i18n.userRoles.admin||a===this.i18n.userRoles.publisher||a===this.i18n.userRoles.user},_resetRoleStore:function(a,e){var f=e;e=new c.data.ItemFileReadStore({data:{identifier:"role",label:"name",items:this._roleItems}});e.comparatorMap={name:arcgisonline.sharing.geow.Account.caseInsensitiveComparator};a.set("store",e);f&&f.destroy&&f.destroy()},getSocialProviders:function(){var a=new c.Deferred,
e=this._util.getSecureUrl(esriGeowConfig.restBaseUrl)+"portals/self/socialProviders";this._util.request({url:e}).then(c.hitch(this,function(c){this._currentSocialProviders=esri.isDefined(c)&&esri.isDefined(c.config)?c.config:null;a.resolve()}),c.hitch(this,function(c){this._currentSocialProviders=null;a.resolve()}));return a},getIDP:function(){var a=new c.Deferred,e=this._util.getSecureUrl(esriGeowConfig.restBaseUrl),f=e+"portals/self/idp/federation";c.promise.all({idp:this._util.request({url:e+"portals/self/idp"}),
federationIdp:this._util.request({url:f})}).then(function(d){esri.isDefined(d.idp)&&esri.isDefined(d.idp.id)?this._currentIDP=d.idp:esri.isDefined(d.federationIdp)&&esri.isDefined(d.federationIdp.id)?this._currentIDP=d.federationIdp:this._currentIDP=null;a.resolve()}.bind(this),function(){this._currentIDP=null;a.resolve()}.bind(this));return a},hasIDP:function(){return esri.isDefined(this._currentIDP)&&esri.isDefined(this._currentIDP.id)},configure:function(){this.overrideProperties();this.checkAccess();
this.localization();this.initialize();this._createUsersBtn.set("disabled",!1);this._inviteUsersBtn.set("disabled",!1);this._account.getAccountUsers(this._settings.id,{start:1,num:1},c.hitch(this,function(a){this._userCount=a.total;this._isPortal?this._util.request({url:this._util.getPortalAdminBaseUrl()+"/system/licenses",content:{ts:(new Date).getTime()}}).then(c.hitch(this,function(e){this._portalLicenseInfo=e;this._userCount=this._portalLicenseInfo.currentRegisteredMembers||a.total;if(esriGeowConfig.userLicenseLevelsEnabled){this._maxUsersPerLevel=
{};this._currentUsersPerLevel={};var f=0,d=0,b=0,g=0;c.forEach(e.features,c.hitch(this,function(a){"esriPortalLvl1"===a.name?(b=a.maximumRegisteredMembers,f=a.currentRegisteredMembers):"esriPortalLvl2"===a.name&&(g=a.maximumRegisteredMembers,d=a.currentRegisteredMembers)}));this._maxUsersPerLevel={};this._maxUsersPerLevel[this.LICENSE_LEVELS.ONE]=b;this._maxUsersPerLevel[this.LICENSE_LEVELS.TWO]=g;this._currentUsersPerLevel={};this._currentUsersPerLevel[this.LICENSE_LEVELS.ONE]=f;this._currentUsersPerLevel[this.LICENSE_LEVELS.TWO]=
d}this.setUserLimitReachedFlag()})):(c.promise.all({levelCountResult:this._util.request({url:esriGeowConfig.restBaseUrl+"portals/self/users/counts?type\x3dlevel"})}).then(c.hitch(this,function(a){var e=a.levelCountResult.results;a=this._pageUtil.find(e,function(a){return a.key===this.LICENSE_LEVELS.ONE}.bind(this));e=this._pageUtil.find(e,function(a){return a.key===this.LICENSE_LEVELS.TWO}.bind(this));a=a?a.count:0;e=e?e.count:0;this._maxUsersPerLevel=c.clone(this._settings.subscriptionInfo.maxUsersPerLevel);
this._currentUsersPerLevel={};this._currentUsersPerLevel[this.LICENSE_LEVELS.ONE]=a;this._currentUsersPerLevel[this.LICENSE_LEVELS.TWO]=e})),this._account.getPendingAccountUsers(this._settings.id,{start:1,num:1,type:"email"},c.hitch(this,function(a){this._userCount+=a.total;this.setUserLimitReachedFlag()}),c.hitch(this,function(a){this.setUserLimitReachedFlag()})))}))},setUserLimitReachedFlag:function(){this._userLimitReached=this._isPortal?-1<this._portalLicenseInfo.maximumRegisteredMembers&&this._portalLicenseInfo.currentRegisteredMembers>=
this._portalLicenseInfo.maximumRegisteredMembers:-1<this._settings.subscriptionInfo.maxUsers&&this._userCount>=this._settings.subscriptionInfo.maxUsers},overrideProperties:function(){this._settings.portalName&&(esriGeowConfig.portalName=this._settings.portalName)},checkAccess:function(){this._util.isLoggedIn()?(this._user=this._util.getUser(),this._user.accountId&&this._user.accountId===this._settings.id&&(this._isAdmin||this._roleCanInviteUsers)||(window.location=esriGeowConfig.baseUrl+"error.html?c\x3dAccessDenied")):
this._util.requireAuthentication()},localization:function(){var a=(this._settings.thumbnail?"\x26nbsp;":"")+esri.substitute({organization:this._settings.name},this._isPortal?this.i18n.pagePortalTitle:this.i18n.pageTitle);c.attr(c.byId("item-title"),"innerHTML",a);this._settings.thumbnail&&c.create("img",{src:esriGeowConfig.restBaseUrl+"portals/self/resources/"+this._settings.thumbnail+"?token\x3d"+this._user.token+"\x26ts\x3d"+(new Date).getTime(),style:{verticalAlign:"middle"},className:"groupThumbnail",
alt:this._settings.name},c.byId("item-title"),"first")},initialize:function(){this._mode=null;this.hide();this.hasIDP()?this._idpUsersBtn.set("checked",!0):c.style(this._idpOptionDiv,"display","none");c.attr(this._createOptionLabel,"innerHTML","\x26nbsp;"+esri.substitute({name:this._isPortal?this._settings.name:this.i18n.arcgis},this.i18n.step1.createUsersLabel));c.attr(this._inviteOptionLabel,"innerHTML","\x26nbsp;"+esri.substitute({name:this._isPortal?this._settings.name:this.i18n.arcgis},this.i18n.step1.inviteUsersLabel));
c.attr(this._addOptionLabel,"innerHTML","\x26nbsp;"+(this._isPortal?this.i18n.step1.addPortalUsersLabel:this.i18n.step1.addUsersLabel));this._isPortal?this.advanceToStep1Add():c.style(this._step1,"display","block");this._createProgressBars()},advanceToStep1Add:function(){this._addUsersBtn.set("checked",!0);this.onNext()},buildChooseType:function(){this.hide();c.style(this._step1Create,"display","block");this._checkEnterpriseGroupStore().then(c.hitch(this,function(){var a=c.create,e=this._createTable(this._createTypeContainer);
this._radioSAMLLabel.innerHTML=esri.substitute({name:this._currentIDP?this._currentIDP.name:""},this.i18n.step1Create.addSAML);this._supportsSAML||(this._radioSAML.set("disabled",!0),c.addClass(this._radioSAMLLabel,"notSupport"));this._radioEnterprise.set("value",this._supportsLDAP?"ldap":"windows");this._radioBuiltin.set("checked",!0);this._supportsLDAP||this._supportsWindows||(this._radioEnterprise.set("disabled",!0),c.addClass(this._radioEnterpriseLabel,"notSupport"));this._createSpacerRow(e);
e=a("tr",null,e);e=a("td",{colspan:2},e);this._nextBtn=new l.form.Button({label:this.i18n.step1Create.nextBtn},a("div",null,e));c.addClass(this._nextBtn.domNode,"calcite blue small");c.connect(this._nextBtn,"onClick",this,this.onTypeNextClicked)}))},hide:function(){c.style(this._topCancelBtn.domNode,"display","");c.style(this._step1,"display","none");this.hasIDP()&&(c.style(this._step2IDP,"display","none"),c.attr(this._step2IDPMsgLabel,"innerHTML",this.i18n.step2IDP.message),this._supportsSAML=!0);
c.style(this._step1Create,"display","none");c.style(this._step2Create,"display","none");var a,e;this._addMode?("saml"===this._userType?(a=this.i18n.step2Create.messageAddPortalSAML,e=this.i18n.step2Create.subMessageAddPortalSAML):"ldap"===this._userType||"windows"===this._userType?(a=this.i18n.step2Create.messageAddPortalAD,e=this.i18n.step2Create.subMessageAddPortalAD):(a=this.i18n.step2Create.messageAddPortal,e=this.i18n.step2Create.subMessageAddPortal),a=c.isIos||c.isAndroid?this._isPortal?this.i18n.step2Create.messageAddPortalMobile:
this.i18n.step2Create.messageAdd:this._isPortal?a:this.i18n.step2Create.messageAdd,e=c.isIos||c.isAndroid?this._isPortal?this.i18n.step2Create.subMessageAddPortalMobile:this.i18n.step2Create.subMessageAdd:this._isPortal?e:this.i18n.step2Create.subMessageAdd):(a=this.i18n.step2Create.message,e=this.i18n.step2Create.subMessage);c.attr(this._step2CreateMsgLabel,"innerHTML",esri.substitute({name:this._isPortal?this._settings.name:this.i18n.arcgis},a));c.attr(this._step2CreateSubMsgLabel,"innerHTML",e);
this._createBatchUploadBtn&&this._createBatchUploadBtn.set("disabled",!1);c.style(this._fixErrors,"display","none");this._addMode?(c.attr(this._fixErrorsMsgLabel,"innerHTML",esri.substitute({name:this._isPortal?this._settings.name:this.i18n.arcgis},this.i18n.fixErrors.messageAdd)),c.attr(this._fixErrorsMsgSubLabel,"innerHTML",this._isPortal?this.i18n.selectNonAdmin:this.i18n.fixErrors.subMessageAdd)):(c.attr(this._fixErrorsMsgLabel,"innerHTML",esri.substitute({name:this._isPortal?this._settings.name:
this.i18n.arcgis},this.i18n.fixErrors.message)),c.attr(this._fixErrorsMsgSubLabel,"innerHTML",this._isPortal?this.i18n.selectNonAdmin:this.i18n.fixErrors.subMessage));this._fixAlertDiv&&c.style(this._fixAlertDiv,"display","block");this._fixEditDiv&&c.style(this._fixEditDiv,"innerHTML","");c.style(this._step2Invite,"display","none");a=this.i18n.step2Invite.message;e=esri.substitute({name:this._isPortal?this._settings.name:this.i18n.arcgis},this.i18n.step2Invite.subMessage);this._isPortal&&!esriGeowConfig.useDefaultIdentityStore&&
(a=c.isIos||c.isAndroid?this.i18n.step2Invite.messageNonDefaultIdentityStoreMobile:this.i18n.step2Invite.messageNonDefaultIdentityStore,e="");c.attr(this._step2InviteLabel,"innerHTML",a);c.attr(this._step2InviteSubLabel,"innerHTML",e);this._inviteBatchUploadBtn&&this._inviteBatchUploadBtn.set("disabled",!1);c.style(this._step3,"display","none");this._sendInvitations&&(this._sendInvitations.set("disabled",!1),c.attr(this._sendInvitations,"label",this.i18n.step3.sendInvitations),c.attr(this._sendGroupInvitations,
"label",this.i18n.step3.sendInvitations));this._isPortal&&c.style(this._validateEmailContainer,"display","none");this._addMode&&(c.attr(this._sendInvitations,"label",this.i18n.step3.addMembers),c.attr(this._sendGroupInvitations,"label",this.i18n.step3.addMembers));c.style(this._step4,"display","none");c.style(this._completed,"display","none");c.style(this._completedMessageSpan,"display","block");c.style(this._uninvitedMessageSpan,"display","none")},setFixErrorMessage:function(a){c.attr(this._fixErrorsErrorContainer,
"innerHTML",a);c.style(this._fixErrorsErrorContainer,"display","block");c.removeClass(this._fixErrorsErrorContainer,"successMsg");c.addClass(this._fixErrorsErrorContainer,"errorMsg")},setFixSuccessMessage:function(a){c.attr(this._fixErrorsErrorContainer,"innerHTML",a);c.style(this._fixErrorsErrorContainer,"display","block");c.removeClass(this._fixErrorsErrorContainer,"errorMsg");c.addClass(this._fixErrorsErrorContainer,"successMsg")},resetFixErrorMessage:function(){c.attr(this._fixErrorsErrorContainer,
"innerHTML","");c.style(this._fixErrorsErrorContainer,"display","none");c.removeClass(this._fixErrorsErrorContainer,"errorMsg");c.removeClass(this._fixErrorsErrorContainer,"successMsg")},setCreateErrorMessage:function(a){c.attr(this._createErrorContainer,"innerHTML",a);c.style(this._createErrorContainer,"display","block");c.removeClass(this._createErrorContainer,"successMsg");c.addClass(this._createErrorContainer,"errorMsg");this._createBatchUploadBtn&&this._createBatchUploadBtn.set("disabled",!1)},
setCreateSuccessMessage:function(a){c.attr(this._createErrorContainer,"innerHTML",a);c.style(this._createErrorContainer,"display","block");c.removeClass(this._createErrorContainer,"errorMsg");c.addClass(this._createErrorContainer,"successMsg")},setInviteErrorMessage:function(a){c.attr(this._inviteErrorContainer,"innerHTML",a);c.style(this._inviteErrorContainer,"display","block");c.removeClass(this._inviteErrorContainer,"successMsg");c.addClass(this._inviteErrorContainer,"errorMsg");this._inviteBatchUploadBtn&&
this._inviteBatchUploadBtn.set("disabled",!1)},setInviteSuccessMessage:function(a){c.attr(this._inviteErrorContainer,"innerHTML",a);c.style(this._inviteErrorContainer,"display","block");c.removeClass(this._inviteErrorContainer,"errorMsg");c.addClass(this._inviteErrorContainer,"successMsg")},setIDPSuccessMessage:function(a){c.attr(this._idpErrorContainer,"innerHTML",a);c.style(this._idpErrorContainer,"display","block");c.removeClass(this._idpErrorContainer,"errorMsg");c.addClass(this._idpErrorContainer,
"successMsg")},setIDPErrorMessage:function(a){c.attr(this._idpErrorContainer,"innerHTML",a);c.style(this._idpErrorContainer,"display","block");c.removeClass(this._idpErrorContainer,"successMsg");c.addClass(this._idpErrorContainer,"errorMsg");this._idpBatchUploadBtn&&this._idpBatchUploadBtn.set("disabled",!1)},resetCreateErrorMessage:function(){c.attr(this._createErrorContainer,"innerHTML","");c.style(this._createErrorContainer,"display","none");c.removeClass(this._createErrorContainer,"errorMsg");
c.removeClass(this._createErrorContainer,"successMsg")},resetInviteErrorMessage:function(){c.attr(this._inviteErrorContainer,"innerHTML","");c.style(this._inviteErrorContainer,"display","none");c.removeClass(this._inviteErrorContainer,"errorMsg");c.removeClass(this._inviteErrorContainer,"successMsg")},resetIDPErrorMessage:function(){c.attr(this._idpErrorContainer,"innerHTML","");c.style(this._idpErrorContainer,"display","none");c.removeClass(this._idpErrorContainer,"errorMsg");c.removeClass(this._idpErrorContainer,
"successMsg")},setReviewWarningMessage:function(a){c.attr(this._ReviewErrorContainer,"innerHTML",a);c.style(this._ReviewErrorContainer,"display","block");c.addClass(this._ReviewErrorContainer,"errorMsg")},resetReviewWarningMessage:function(){c.attr(this._ReviewErrorContainer,"innerHTML","");c.style(this._ReviewErrorContainer,"display","none");c.removeClass(this._ReviewErrorContainer,"errorMsg")},validIDPUsers:function(a){var e=!0,f=!1,d=null,b=[],g;for(g=0;g<a.length;g++){-1<c.indexOf(b,a[g].email)?
(f=!0,d=a[g].email):b.push(a[g].email);if(f){this._idpSingleEmail.focus();a=esri.substitute({email:d},this.i18n.step2IDP.invalid.emailDuplicate);this.setIDPErrorMessage(a);e=!1;break}e=this.isValidIDPUser(a[g]);if(!e)break}return e},validInviteUsers:function(a){var e=!0,f=!1,d=null,b=[],g;for(g=0;g<a.length;g++){-1<c.indexOf(b,a[g].email)?(f=!0,d=a[g].email):b.push(a[g].email);if(f){this._inviteSingleEmail.focus();a=esri.substitute({email:d},this.i18n.step2Invite.invalid.emailDuplicate);this.setInviteErrorMessage(a);
e=!1;break}e=this.isValidInviteUser(a[g]);if(!e)break}return e},usernameContainsAlphaNumeric:function(a){var c=/^[a-zA-Z0-9@_\.]+$/g;return a&&!!c.test(a)},usernameContainsAlphaNumericPortal:function(a){var c=/^[a-zA-Z0-9@_\.\-]+$/g;return a&&!!c.test(a)},isValidFixedUser:function(a){var c=null,f=!1,d="";this.notSet(a.email)?(f=!0,d+=this.i18n.fixErrors.invalid.emailNotSet+"\x3cbr\x3e",c||(c=this._fixEmail)):this._util.isValidEmailAddress(a.email)||(f=!0,d+=esri.substitute({email:this._util.stripHTML(a.email)},
this.i18n.fixErrors.invalid.emailAddress)+"\x3cbr\x3e",c||(c=this._fixEmail));var b=this._isPortal&&"saml"===this._userType,g=b?this._minSAMLUsernameLength:this._minUsernameLength,k=b?this._maxSAMLUsernameLength:this._maxUsernameLength;this.notSet(a.username)?(f=!0,d+=this.i18n.fixErrors.invalid.usernameIsBlank+"\x3cbr\x3e",c||(c=this._fixUsername)):a.username.length<g?(f=!0,d+=(b?this.i18n.fixErrors.invalid.samlUsernameTooShort:this.i18n.fixErrors.invalid.usernameTooShort)+"\x3cbr\x3e",c||(c=this._fixUsername)):
a.username.length>k?(f=!0,d+=(b?this.i18n.fixErrors.invalid.samlUsernameTooLong:this.i18n.fixErrors.invalid.usernameTooLong)+"\x3cbr\x3e",c||(c=this._fixUsername)):(this._isPortal?this.usernameContainsAlphaNumericPortal(a.username):this.usernameContainsAlphaNumeric(a.username))||(f=!0,d+=this.i18n.fixErrors.invalid.usernameInvalidChars+"\x3cbr\x3e",c||(c=this._fixUsername));this._addMode&&this._fixPassword&&!b&&(this._passwordPolicy?(b=this._util.meetsPasswordPolicyStrength(this._passwordPolicy,a.password),
b.meetsRequirements())?a.username.toLowerCase()===a.password.toLowerCase()&&(f=!0,d+=this.i18n.passwordNotToPolicy+"\x3cbr\x3e",c||(c=this._createSinglePassword)):(f=!0,b.minLength||(d+=esri.substitute({num:this._passwordPolicy.minLength},this.i18n.step2Create.invalid.passwordLength)+"\x3cbr\x3e"),b.minLetter||(d+=esri.substitute({num:this._passwordPolicy.minLetter},this.i18n.step2Create.invalid.passwordLetter)+"\x3cbr\x3e"),b.minUpper||(d+=esri.substitute({num:this._passwordPolicy.minUpper},this.i18n.step2Create.invalid.passwordUpper)+
"\x3cbr\x3e"),b.minLower||(d+=esri.substitute({num:this._passwordPolicy.minLower},this.i18n.step2Create.invalid.passwordLower)+"\x3cbr\x3e"),b.minDigit||(d+=esri.substitute({num:this._passwordPolicy.minDigit},this.i18n.step2Create.invalid.passwordDigit)+"\x3cbr\x3e"),b.minOther||(d+=esri.substitute({num:this._passwordPolicy.minOther},this.i18n.step2Create.invalid.passwordOther)+"\x3cbr\x3e"),c||(c=this._createSinglePassword)):this.notSet(a.password)||this.isSet(a.password)&&!this._util.meetsPasswordStrength(a.password)?
(f=!0,d+=this.i18n.passwordHintText+"\x3cbr\x3e",c||(c=this._fixPassword)):a.username.toLowerCase()===a.password.toLowerCase()&&(f=!0,d+=this.i18n.passwordNotToPolicy+"\x3cbr\x3e",c||(c=this._createSinglePassword)));this.notSet(a.firstname)&&(f=!0,d+=this.i18n.fixErrors.invalid.firstNameIsBlank+"\x3cbr\x3e",c||(c=this._fixFirstName));this.notSet(a.lastname)&&(f=!0,d+=this.i18n.fixErrors.invalid.lastNameIsBlank+"\x3cbr\x3e",c||(c=this._fixLastName));f&&(c&&c.focus(),this.setFixErrorMessage(d));return!f},
isValidFixedUserAD:function(a){var c=null,f=!1,d="";this.notSet(a.username)?(f=!0,d+=this.i18n.fixErrors.invalid.usernameIsBlank+"\x3cbr\x3e",c||(c=this._fixUsername)):a.username.length<this._minUsernameLength?(f=!0,d+=this.i18n.fixErrors.invalid.usernameTooShort+"\x3cbr\x3e",c||(c=this._fixUsername)):a.username.length>this._maxUsernameLength?(f=!0,d+=this.i18n.fixErrors.invalid.usernameTooLong+"\x3cbr\x3e",c||(c=this._fixUsername)):(this._isPortal?this.usernameContainsAlphaNumericPortal(a.username):
this.usernameContainsAlphaNumeric(a.username))||(f=!0,d+=this.i18n.fixErrors.invalid.usernameInvalidChars+"\x3cbr\x3e",c||(c=this._fixUsername));f&&(c&&c.focus(),this.setFixErrorMessage(d));return!f},isValidCreateUser:function(a){var e=null,f=!1,d="",b;this.notSet(a.email)?(f=!0,d+=this.i18n.step2Create.invalid.emailNotSet+"\x3cbr\x3e",e||(e=this._createSingleEmail)):this._util.isValidEmailAddress(a.email)||(f=!0,d+=esri.substitute({email:this._util.stripHTML(a.email)},this.i18n.step2Create.invalid.emailAddress)+
"\x3cbr\x3e",e||(e=this._createSingleEmail));b=this._isPortal&&"saml"===this._userType?this._maxSAMLUsernameLength:this._maxUsernameLength;var g=this._isPortal&&"saml"===this._userType?this._minSAMLUsernameLength:this._minUsernameLength;if(this.notSet(a.username))f=!0,d+=this.i18n.step2Create.invalid.usernameIsBlank+"\x3cbr\x3e",e||(e=this._createSingleUsername);else if(a.username.length<g)f=!0,d+=this.i18n.step2Create.invalid.usernameTooShort+"\x3cbr\x3e",e||(e=this._createSingleUsername);else if(a.username.length>
b)f=!0,d+=this._isPortal&&"saml"===this._userType?this.i18n.step2Create.invalid.samlUsernameTooLong+"\x3cbr\x3e":this.i18n.step2Create.invalid.usernameTooLong+"\x3cbr\x3e",e||(e=this._createSingleUsername);else if(this._isPortal?!this.usernameContainsAlphaNumericPortal(a.username):!this.usernameContainsAlphaNumeric(a.username))f=!0,d+=this.i18n.step2Create.invalid.usernameInvalidChars+"\x3cbr\x3e",e||(e=this._createSingleUsername);else if(!this._editingCreate)for(b=0;b<this._userStore._arrayOfAllItems.length;b++){if(this._userStore._arrayOfAllItems[b]&&
a.username===this._userStore._arrayOfAllItems[b].username[0]){f=!0;d+=esri.substitute({username:a.username},this.i18n.step2Create.invalid.usernameExists)+"\x3cbr\x3e";e||(e=this._createSingleEmail);break}}else if(this._editingCreate&&a.id)for(b=0;b<this._userStore._arrayOfAllItems.length;b++)if(this._userStore._arrayOfAllItems[b]&&a.username===this._userStore._arrayOfAllItems[b].username[0]&&a.id!==this._userStore._arrayOfAllItems[b].id[0]){f=!0;d+=esri.substitute({username:a.username},this.i18n.step2Create.invalid.usernameExists)+
"\x3cbr\x3e";e||(e=this._createSingleEmail);break}this._addMode&&this._createSinglePassword&&"saml"!==this._userType&&(this._passwordPolicy?(b=this._util.meetsPasswordPolicyStrength(this._passwordPolicy,a.password),b.meetsRequirements())?a.username.toLowerCase()===a.password.toLowerCase()&&(f=!0,d+=this.i18n.passwordNotToPolicy+"\x3cbr\x3e",e||(e=this._createSinglePassword)):(f=!0,b.minLength||(d+=esri.substitute({num:this._passwordPolicy.minLength},this.i18n.step2Create.invalid.passwordLength)+"\x3cbr\x3e"),
b.minLetter||(d+=esri.substitute({num:this._passwordPolicy.minLetter},this.i18n.step2Create.invalid.passwordLetter)+"\x3cbr\x3e"),b.minUpper||(d+=esri.substitute({num:this._passwordPolicy.minUpper},this.i18n.step2Create.invalid.passwordUpper)+"\x3cbr\x3e"),b.minLower||(d+=esri.substitute({num:this._passwordPolicy.minLower},this.i18n.step2Create.invalid.passwordLower)+"\x3cbr\x3e"),b.minDigit||(d+=esri.substitute({num:this._passwordPolicy.minDigit},this.i18n.step2Create.invalid.passwordDigit)+"\x3cbr\x3e"),
b.minOther||(d+=esri.substitute({num:this._passwordPolicy.minOther},this.i18n.step2Create.invalid.passwordOther)+"\x3cbr\x3e"),e||(e=this._createSinglePassword)):this.notSet(a.password)||this.isSet(a.password)&&!this._util.meetsPasswordStrength(a.password)?(f=!0,d+=this.i18n.passwordHintText+"\x3cbr\x3e",e||(e=this._createSinglePassword)):a.username.toLowerCase()===a.password.toLowerCase()&&(f=!0,d+=this.i18n.passwordNotToPolicy+"\x3cbr\x3e",e||(e=this._createSinglePassword)));this.notSet(a.firstname)&&
(f=!0,d+=this.i18n.step2Create.invalid.firstNameIsBlank+"\x3cbr\x3e",e||(e=this._createSingleFirstName));this.notSet(a.lastname)&&(f=!0,d+=this.i18n.step2Create.invalid.lastNameIsBlank+"\x3cbr\x3e",e||(e=this._createSingleLastName));(a=this._createSingleMessage.get("value"))&&(a=c.trim(a));this.notSet(a)&&(f=!0,d+=this.i18n.step2Create.invalid.messageIsBlank+"\x3cbr\x3e",e||(e=this._createSingleMessage));f&&(e&&e.focus(),this.setCreateErrorMessage(d));return!f},isValidInviteUser:function(a){var e=
null,f=!1,d="",b;if(this.notSet(a.email))f=!0,d+=this.i18n.step2Invite.invalid.emailNotSet+"\x3cbr\x3e",e||(e=this._inviteSingleEmail);else if(!this._util.isValidEmailAddress(a.email))f=!0,d+=esri.substitute({email:this._util.stripHTML(a.email)},this.i18n.step2Invite.invalid.emailAddress),e||(e=this._inviteSingleEmail);else if(!this._editingInvite)for(b=0;b<this._userStore._arrayOfAllItems.length;b++)this._userStore._arrayOfAllItems[b]&&a.email===this._userStore._arrayOfAllItems[b].email[0]&&(f=!0,
d+=esri.substitute({email:this._util.stripHTML(a.email)},this.i18n.step2Invite.invalid.emailExists),e||(e=this._inviteSingleEmail));(a=this._inviteSingleMessage.get("value"))&&(a=c.trim(a));this.notSet(a)&&(f=!0,d+=this.i18n.step2Invite.invalid.messageIsBlank+"\x3cbr\x3e",e||(e=this._inviteSingleMessage));f&&(e&&e.focus(),this.setInviteErrorMessage(d));return!f},isValidIDPUser:function(a){var e=null,f=!1,d="",b;if(this.notSet(a.email))f=!0,d+=this.i18n.step2IDP.invalid.emailNotSet+"\x3cbr\x3e",e||
(e=this._idpSingleEmail);else if(!this._util.isValidEmailAddress(a.email))f=!0,d+=esri.substitute({email:this._util.stripHTML(a.email)},this.i18n.step2IDP.invalid.emailAddress),e||(e=this._idpSingleEmail);else if(!this._editingIDP)for(b=0;b<this._userStore._arrayOfAllItems.length;b++)this._userStore._arrayOfAllItems[b]&&a.email===this._userStore._arrayOfAllItems[b].email[0]&&(f=!0,d+=esri.substitute({email:this._util.stripHTML(a.email)},this.i18n.step2IDP.invalid.emailExists),e||(e=this._idpSingleEmail));
(a=this._idpSingleMessage.get("value"))&&(a=c.trim(a));this.notSet(a)&&(f=!0,d+=this.i18n.step2IDP.invalid.messageIsBlank+"\x3cbr\x3e",e||(e=this._idpSingleMessage));f&&(e&&e.focus(),this.setIDPErrorMessage(d));return!f},editInvite:function(a){this._userStore.fetch({onComplete:c.hitch(this,function(e){var f;this._mode===this.modeInvite?(c.forEach(e,c.hitch(this,function(d){this._userStore.getValue(d,"email")===a&&(this._editingInvite=!0,this._editingInviteUser=d)})),this._editingInvite&&(this.resetInviteSingleForm(!0),
esriGeowConfig.userLicenseLevelsEnabled&&(this._userStore.getValue(this._editingInviteUser,"level")==this.LICENSE_LEVELS.ONE?(this._inviteLevel1Radio.set("checked",!0),this.onInviteLevel1RadioClick()):(this._inviteLevel2Radio.set("checked",!0),this.onInviteLevel2RadioClick())),e=this._userStore.getValue(this._editingInviteUser,"role"),this._inviteSingleEmail.set("value",this._userStore.getValue(this._editingInviteUser,"email")),this._isPortal&&e===this.accountAdminRole?(this._inviteSingleRole.set("value",
this.i18n.userRoles.admin),this._currentSelectedInviteRole=this.accountAdminRole):e===this.accountPublisherRole?(this._inviteSingleRole.set("value",this.i18n.userRoles.publisher),this._currentSelectedInviteRole=this.accountPublisherRole):e===this.accountUserRole?(this._inviteSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedInviteRole=this.accountUserRole):esriGeowConfig.userLicenseLevelsEnabled&&e===this.SYSTEM_ROLES.VIEWER?(this._inviteSingleRole.set("value",this.i18n.userRoles.viewer),
this._currentSelectedInviteRole=this.SYSTEM_ROLES.VIEWER):(f=this.getCustomRoleName(e))?(this._inviteSingleRole.set("value",f),this._currentSelectedInviteRole=e):this._isPortal?(this._inviteSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._currentSelectedInviteRole=this._portalDefaultUser):(this._inviteSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedInviteRole=this.accountUserRole),!this._isPortal&&this._isAdmin&&this._inviteEsriAccessCheckBox.set("checked",
"both"===this._userStore.getValue(this._editingInviteUser,"userType")),this._inviteSingleMessage.set("value",this._currentInviteMessage),this._inviteSingleEmail.focus(),this.hide(),c.style(this._step2Invite,"display","block"),this._userGrid.set("store",null))):this._mode===this.modeIDP?(c.forEach(e,c.hitch(this,function(d){this._userStore.getValue(d,"email")===a&&(this._editingIDP=!0,this._editingIDPUser=d)})),this._editingIDP&&(this.resetIDPSingleForm(!0),esriGeowConfig.userLicenseLevelsEnabled&&
(this._userStore.getValue(this._editingIDPUser,"level")==this.LICENSE_LEVELS.ONE?(this._idpLevel1Radio.set("checked",!0),this.onIDPLevel1RadioClick()):(this._idpLevel2Radio.set("checked",!0),this.onIDPLevel2RadioClick())),e=this._userStore.getValue(this._editingIDPUser,"role"),this._idpSingleEmail.set("value",this._userStore.getValue(this._editingIDPUser,"email")),this._isPortal&&e===this.accountAdminRole?(this._idpSingleRole.set("value",this.i18n.userRoles.admin),this._currentSelectedIDPRole=this.accountAdminRole):
e===this.accountPublisherRole?(this._idpSingleRole.set("value",this.i18n.userRoles.publisher),this._currentSelectedIDPRole=this.accountPublisherRole):e===this.accountUserRole?(this._idpSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedIDPRole=this.accountUserRole):esriGeowConfig.userLicenseLevelsEnabled&&e===this.SYSTEM_ROLES.VIEWER?(this._idpSingleRole.set("value",this.i18n.userRoles.viewer),this._currentSelectedIDPRole=this.SYSTEM_ROLES.VIEWER):(f=this.getCustomRoleName(e))?
(this._idpSingleRole.set("value",f),this._currentSelectedIDPRole=e):this._isPortal?(this._idpSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._currentSelectedIDPRole=this._portalDefaultUser):(this._idpSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedIDPRole=this.accountUserRole),!this._isPortal&&this._isAdmin&&this._idpEsriAccessCheckBox.set("checked","both"===this._userStore.getValue(this._editingIDPUser,"userType")),this._idpSingleMessage.set("value",
this._currentIDPMessage),this._idpSingleEmail.focus(),this.hide(),c.style(this._step2IDP,"display","block"),this._userGrid.set("store",null))):this._mode===this.modeCreate&&(c.forEach(e,c.hitch(this,function(d){this._userStore.getValue(d,"username")===a&&(this._editingCreate=!0,this._editingCreateUser=d)})),this._editingCreate&&(this.resetCreateSingleForm(!0),this._settingCreateSingleUser=this._settingCreateSingleEmail=!0,this._addMode&&(this._settingCreateSinglePassword=!0),this._createSingleEmail.set("value",
this._userStore.getValue(this._editingCreateUser,"email")),this._createSingleFirstName.set("value",this._userStore.getValue(this._editingCreateUser,"firstname")),this._createSingleLastName.set("value",this._userStore.getValue(this._editingCreateUser,"lastname")),this._createSingleUsername.set("value",this._userStore.getValue(this._editingCreateUser,"username")),this._addMode&&this._createSinglePassword&&"saml"!==this._userType&&this._createSinglePassword.set("value",this._userStore.getValue(this._editingCreateUser,
"password")),esriGeowConfig.userLicenseLevelsEnabled&&(this._userStore.getValue(this._editingCreateUser,"level")==this.LICENSE_LEVELS.ONE?(this._createSingleLevel1Radio.set("checked",!0),this.onCreateSingleLevel1RadioClick()):(this._createSingleLevel2Radio.set("checked",!0),this.onCreateSingleLevel2RadioClick())),e=this._userStore.getValue(this._editingCreateUser,"role"),this._isPortal&&e===this.accountAdminRole?(this._createSingleRole.set("value",this.i18n.userRoles.admin),this._currentSelectedCreateRole=
this.accountAdminRole):e===this.accountPublisherRole?(this._createSingleRole.set("value",this.i18n.userRoles.publisher),this._currentSelectedCreateRole=this.accountPublisherRole):e===this.accountUserRole?(this._createSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedCreateRole=this.accountUserRole):esriGeowConfig.userLicenseLevelsEnabled&&e===this.SYSTEM_ROLES.VIEWER?(this._createSingleRole.set("value",this.i18n.userRoles.viewer),this._currentSelectedCreateRole=this.SYSTEM_ROLES.VIEWER):
(f=this.getCustomRoleName(e))?(this._createSingleRole.set("value",f),this._currentSelectedCreateRole=e):this._isPortal?(this._createSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._currentSelectedCreateRole=this._portalDefaultUser):(this._createSingleRole.set("value",this.i18n.userRoles.user),this._currentSelectedCreateRole=this.accountUserRole),!this._isPortal&&this._isAdmin&&this._createSingleEsriAccessCheckBox.set("checked","both"===this._userStore.getValue(this._editingCreateUser,
"userType")),this._createSingleMessage.set("value",this._currentCreateMessage),this._createSingleEmail.focus(),this.hide(),c.style(this._step2Create,"display","block"),this._userGrid.set("store",null)))})})},removeInvite:function(a){this._userStore.fetch({onComplete:c.hitch(this,function(e){var f=!1,d=e.length;c.forEach(e,c.hitch(this,function(b){this._mode===this.modeInvite||this._mode===this.modeIDP?this._userStore.getValue(b,"email")===a&&(this._userStore.deleteItem(b),f=!0):this._mode===this.modeCreate&&
this._userStore.getValue(b,"username")===a&&(this._userStore.deleteItem(b),f=!0)}));f&&this._userStore.save({onComplete:c.hitch(this,function(){this._userGrid.set("store",this._userStore);this._userGrid.sort();1===d?this._mode===this.modeInvite?(this.resetInviteErrorMessage(),this.hide(),c.style(this._step2Invite,"display","block"),this.resetUserStore()):this._mode===this.modeIDP?(this.resetIDPErrorMessage(),this.hide(),c.style(this._step2IDP,"display","block"),this.resetUserStore()):this._mode===
this.modeCreate&&(this.resetCreateErrorMessage(),this.hide(),c.style(this._step2Create,"display","block"),this.resetUserStore()):this.checkUserLimit()})})})})},createFullName:function(a){var e=a.fullName;esri.isDefined(a.firstName)&&esri.isDefined(a.lastName)&&(e="ja"===c.locale?a.lastName+" "+a.firstName:a.firstName+" "+a.lastName);return e},buildEmailMessage:function(a){return this.createHTMLLineBreaks(a)},handleCheckFixedUsername:function(a){a&&!a.code&&!a.message&&a.usernames&&a.usernames[0]&&
(a=a.usernames[0],this._settingFixUsername=!0,a.requested===a.suggested?this._fixUsername.set("value",a.requested):this._fixUsername.set("value",a.suggested))},handleCheckUsername:function(a){a&&!a.code&&!a.message&&a.usernames&&a.usernames[0]&&(a=a.usernames[0],this._settingCreateSingleUser=!0,a.requested===a.suggested?this._createSingleUsername.set("value",a.requested):this._createSingleUsername.set("value",a.suggested))},handleCreateFileSelection:function(a){0===c.trim(this._createBatchFile.get("value")).length?
this.setCreateErrorMessage(this.i18n.step2Create.invalid.noFile):(this._createBatchUploadBtn.set("disabled",!0),a&&1===a.length&&"undefined"!==typeof FileReader?this.handleCreateFile(a[0]):(this._createBatchFile.domNode.name="data",esri.request({url:esriGeowConfig.reflectorUrl,form:this._createBatchForm,content:{f:"json"},callbackParamName:"callback.html",handleAs:"json",load:c.hitch(this,function(a){a.error?this.uploadError(a.error):this.handleCreateFile(a)}),error:c.hitch(this,this.uploadError)})))},
handleInviteFileSelection:function(a){0===c.trim(this._inviteBatchFile.get("value")).length?this.setInviteErrorMessage(this.i18n.step2Invite.invalid.noFile):(this._inviteBatchUploadBtn.set("disabled",!0),a&&1===a.length&&"undefined"!==typeof FileReader?this.handleInviteFile(a[0]):(this._inviteBatchFile.domNode.name="data",esri.request({url:esriGeowConfig.reflectorUrl,form:this._inviteBatchForm,content:{f:"json"},callbackParamName:"callback.html",handleAs:"json",load:c.hitch(this,function(a){a.error?
this.uploadError(a.error):this.handleInviteFile(a)}),error:c.hitch(this,this.uploadError)})))},handleIDPFileSelection:function(a){0===c.trim(this._idpBatchFile.get("value")).length?this.setIDPErrorMessage(this.i18n.step2IDP.invalid.noFile):(this._idpBatchUploadBtn.set("disabled",!0),a&&1===a.length&&"undefined"!==typeof FileReader?this.handleIDPFile(a[0]):(this._idpBatchFile.domNode.name="data",esri.request({url:esriGeowConfig.reflectorUrl,form:this._idpBatchForm,content:{f:"json"},callbackParamName:"callback.html",
handleAs:"json",load:c.hitch(this,function(a){a.error?this.uploadError(a.error):this.handleIDPFile(a)}),error:c.hitch(this,this.uploadError)})))},handleCreateFile:function(a){var e=(a.type||a.contentType||" ").toLowerCase(),f=a.name||a.fileName;if(c.isIE)var d=f.split("\\"),f=d[d.length-1];f=f.toLowerCase();if(-1!==e.indexOf("text/")||-1!==f.indexOf(".txt")||-1!==f.indexOf(".csv"))if(a.data)a=this.bytesToString(h.encoding.base64.decode(a.data)),!this._isPortal||"ldap"!==this._userType&&"windows"!==
this._userType?this.processCreateCsvData(a,f):this.processCreateCsvDataAD(a,f);else{var b=new FileReader;b.onload=c.hitch(this,function(){!this._isPortal||"ldap"!==this._userType&&"windows"!==this._userType?this.processCreateCsvData(b.result,f):this.processCreateCsvDataAD(b.result,f)});b.readAsText(a)}else this.setCreateErrorMessage(this.i18n.step2Create.invalid.fileType)},handleInviteFile:function(a){var e=(a.type||a.contentType||" ").toLowerCase(),f=a.name||a.fileName;if(c.isIE)var d=f.split("\\"),
f=d[d.length-1];f=f.toLowerCase();if(-1!==e.indexOf("text/")||-1!==f.indexOf(".txt")||-1!==f.indexOf(".csv"))if(a.data)a=this.bytesToString(h.encoding.base64.decode(a.data)),this.processInviteCsvData(a,f);else{var b=new FileReader;b.onload=c.hitch(this,function(){this.processInviteCsvData(b.result,f)});b.readAsText(a)}else this.setInviteErrorMessage(this.i18n.step2Invite.invalid.fileType)},handleIDPFile:function(a){var e=(a.type||a.contentType||" ").toLowerCase(),f=a.name||a.fileName;if(c.isIE)var d=
f.split("\\"),f=d[d.length-1];f=f.toLowerCase();if(-1!==e.indexOf("text/")||-1!==f.indexOf(".txt")||-1!==f.indexOf(".csv"))if(a.data)a=this.bytesToString(h.encoding.base64.decode(a.data)),this.processIDPCsvData(a,f);else{var b=new FileReader;b.onload=c.hitch(this,function(){this.processIDPCsvData(b.result,f)});b.readAsText(a)}else this.setIDPErrorMessage(this.i18n.step2IDP.invalid.fileType)},generateUsername:function(a,c){var e="",d=0<c?""+c:"",b=this._settings.urlKey?"_"+this._settings.urlKey:"",
e=this._util.isValidEmailAddress(a)?a.split("@")[0]:""+c;a=e.length+d.length+b.length;return e=e.substring(0,e.length-(a>this._maxUsernameLength?a%this._maxUsernameLength:0))+d+b},_lookupFullRoleName:function(a){if(a===this.accountAdminRole||a===this.orgAdminRole)return this.i18n.userRoles.admin;if(a===this.accountPublisherRole||a===this.orgPublisherRole)return this.i18n.userRoles.publisher;if(a===this.accountUserRole||a===this.orgUserRole)return this.i18n.userRoles.user;if(esriGeowConfig.userLicenseLevelsEnabled&&
a===this.SYSTEM_ROLES.VIEWER)return this.i18n.userRoles.viewer;var e=c.filter(this._customRoles,function(c){return c.id===a});return e&&e[0]?e[0].name:""},_lookupRoleName:function(a){if(a===this.accountAdminRole||a===this.orgAdminRole)return this.i18n.userRoles.admin.toLowerCase();if(a===this.accountPublisherRole||a===this.orgPublisherRole)return this.i18n.userRoles.publisher.toLowerCase();if(a===this.accountUserRole||a===this.orgUserRole)return this.i18n.userRoles.user.toLowerCase();if(esriGeowConfig.userLicenseLevelsEnabled&&
a===this.SYSTEM_ROLES.VIEWER)return this.i18n.userRoles.viewer.toLowerCase();var e=c.filter(this._customRoles,function(c){return c.id===a});return(e&&e[0]?e[0].name:"").toLowerCase()},_toggleGroupSelection:function(){if(!this._isAdmin&&!this._roleCanAddUsers||this._mode!==this.modeCreate&&(this._isPortal||this._mode!==this.modeInvite&&this._mode!==this.modeIDP))c.style(this._groupSelection.domNode,"display","none"),c.attr(this._step3SubMessage,"innerHTML","");else{c.style(this._groupSelection.domNode,
"display","");var a=esri.substitute({groupsButtonName:this.i18n.step3.specifyGroups,addButtonName:this._addMode||this._isPortal?this.i18n.step3.addMembers:this.i18n.step3.sendInvitations},this._isPortal?this.i18n.step3.subMessageAddPortal:this.i18n.step3.subMessageAdd);c.attr(this._step3SubMessage,"innerHTML",a)}},onGroupSelection:function(){c.attr(this._step4Message,"innerHTML",this._isPortal?this.i18n.step4.messagePortal:this.i18n.step4.message);this.hide();c.style(this._step4,"display","block");
this._groupSelector._initialize();this.checkUserLimit()},onBackGroups:function(){this._groupSelector.set("selectedGroups",[]);this._selectedGroups=[];this.goToStep3();this.checkUserLimit()},_toggleManageCredits:function(){!this._canManageCredits||this._mode!==this.modeCreate&&(this._isPortal||this._mode!==this.modeInvite&&this._mode!==this.modeIDP)?(c.style(this._manageCredits.domNode,"display","none"),c.style(this._manageCredits2.domNode,"display","none")):(c.style(this._manageCredits.domNode,"display",
""),c.style(this._manageCredits2.domNode,"display",""))},onManageCredits:function(){!this._creditsToAssign&&esriGeowConfig.self.defaultUserCreditAssignment&&(this._creditsToAssign=esriGeowConfig.self.defaultUserCreditAssignment);this._assignCreditsDlg.show(this._creditsToAssign)},goToStep3:function(){this.hide();c.style(this._step3,"display","block");c.style(this._validateEmailContainer,"display",this._isPortal||this._mode!==this.modeInvite?"none":"");this._toggleGroupSelection();this._toggleManageCredits()},
hasDuplicateUsername:function(a,e,f){var d=[],b=!1,g,k,m;for(m=0;m<e.length;m++)if(k=a.getValue(e[m],f),-1<c.indexOf(d,k)){b=!0;g=k;break}else d.push(k);return b?g:null},processCreateCsvData:function(a,e,f){e=a.indexOf("\n");e=c.trim(a.substr(0,e));e=this.getSeparator(e);var d=new h.data.CsvStore({data:a,separator:e});d.fetch({onComplete:c.hitch(this,function(a){var b=this.hasDuplicateUsername(d,a,this.i18n.csv.username);if(b)this.setCreateErrorMessage(esri.substitute({username:b},this.i18n.multipleUsernameCollision));
else{this.initializeUserStore();var e=this._userStore?this._userStore._arrayOfAllItems.length:0,f=[],p=[],q=!1,n=0,r;c.forEach(a,c.hitch(this,function(a){var b=d.getValue(a,this.i18n.csv.firstName),g=d.getValue(a,this.i18n.csv.lastName),k=d.getValue(a,this.i18n.csv.email),m=d.getValue(a,this.i18n.csv.role),q=d.getValue(a,this.i18n.csv.username),r=0,h,v,l;if(!esri.isDefined(q)||1>q.length)q=this.generateUsername(esri.isDefined(k)?k:"",r),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&
(q=this._addSAMLSuffix(q));for(this._addMode&&(h=d.getValue(a,this.i18n.csv.password));-1<c.indexOf(p,q);)r++,q=this.generateUsername(k,r),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(q=this._addSAMLSuffix(q));this._isPortal&&m&&m.toLowerCase()===this.i18n.userRoles.admin.toLowerCase()?m=this.accountAdminRole:m&&m.toLowerCase()===this.i18n.csv.publisherRole.toLowerCase()?m=this.accountPublisherRole:m&&m.toLowerCase()===this.i18n.csv.userRole.toLowerCase()?m=this.accountUserRole:
esriGeowConfig.userLicenseLevelsEnabled&&m&&m.toLowerCase()===this.i18n.csv.viewerRole.toLowerCase()?m=this.SYSTEM_ROLES.VIEWER:(m=this.getCustomRoleId(m))||(m=this._isPortal?this._portalDefaultUser:this.accountUserRole);esriGeowConfig.userLicenseLevelsEnabled&&(v=d.getValue(a,this.i18n.csv.level)||this.LICENSE_LEVELS.TWO,v!==this.LICENSE_LEVELS.ONE||this._isValidLevelOneRole(m)||(m=this.SYSTEM_ROLES.VIEWER));!this._isPortal&&this._isAdmin&&(l="true"===(d.getValue(a,this.i18n.csv.allowEsriAccess)||
"").toLowerCase()?"both":"");a="ja"===c.locale?g+" "+b:b+" "+g;r=this._lookupRoleName(m);b={id:f.length+e,firstname:b,lastname:g,fullname:a,username:this._isPortal?this.cleanUsernamePortal(q):this.cleanUsername(q),email:k,role:m,rolename:r};esriGeowConfig.userLicenseLevelsEnabled&&(b.level=v);this._addMode&&(b.password=h?c.trim(h):"");this._isPortal&&"saml"===this._userType&&(b.provider=this.enterpriseProvider,this._addMode&&this._samlSuffix&&(b.idpUsername=this._removeSAMLSuffix(q),b.username=this._addSAMLSuffix(q)));
!this._isPortal&&this._isAdmin&&(b.userType=l);if(!this._isPortal||"ldap"!==this._userType&&"windows"!==this._userType?this._isPortal&&"saml"===this._userType?this.containsInvalidFieldsSAML(b):this.containsInvalidFields(b):this.containsInvalidFieldsAD(b))b.invalid=!0,n++;f.push(b);p.push(b.username)}));0<p.length?this._account.checkUsernames(p,c.hitch(this,function(a){if(a.usernames&&a.usernames.length===p.length){var b=[];for(r=0;r<a.usernames.length;r++){var d=-1,e;for(e=0;e<f.length;e++)if(f[e].username===
a.usernames[r].requested){d=e;break}var g=new c.Deferred;if(-1<d)if(this._isPortal&&"saml"===this._userType){var k=!1;f[d].username!=a.usernames[r].suggested&&(this.setReviewWarningMessage(this.i18n.step2Create.invalid.usernameExistsFile),k=!0);this._userStore.fetchItemByIdentity({identity:f[d].username,onItem:c.hitch(this,function(a){esri.isDefined(a)||k?f[d].invalid&&(f[d].invalid=!1,n--):this._userStore.newItem(f[d]);q=!0;g.resolve()})})}else f[d].username=a.usernames[r].suggested,this._userStore.fetchItemByIdentity({identity:f[d].username,
onItem:c.hitch(this,function(a){esri.isDefined(a)?f[d].invalid&&(f[d].invalid=!1,n--):this._userStore.newItem(f[d]);q=!0;g.resolve()})});else g.resolve();b.push(g)}(new c.DeferredList(b)).then(c.hitch(this,function(){q?this._userStore.save({onComplete:c.hitch(this,function(){this._currentCreateMessage=this._createBatchMessage.get("value");this._editingCreate=!1;this._editingCreateUser=null;this.resetCreateSingleForm(!0);n?(this.initializeFixErrors(),this.hide(),c.style(this._fixErrors,"display","block")):
(this.goToStep3(),this.initializeCreateUserGrid())})}):this.setCreateErrorMessage(this.i18n.step2Create.invalid.uploadNoUsers)}))}else this.setCreateErrorMessage(this.i18n.step2Create.invalid.upload)})):this.setCreateErrorMessage(this.i18n.step2Create.invalid.uploadNoUsers)}}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(this.i18n.step2Create.invalid.upload)})})},processCreateCsvDataAD:function(a,e,f){this.resetReviewWarningMessage();e=a.indexOf("\n");e=c.trim(a.substr(0,e));e=this.getSeparator(e);
var d=new h.data.CsvStore({data:a,separator:e});d.fetch({onComplete:c.hitch(this,function(a){var b=this.hasDuplicateUsername(d,a,this.i18n.csv.username);if(b)this.setCreateErrorMessage(esri.substitute({username:b},this.i18n.multipleUsernameCollision));else{this.initializeUserStore();var e=[],f=[],p=[],q=!1,n=0,r;c.forEach(a,c.hitch(this,function(a){a=d.getValue(a,this.i18n.csv.username);var b=this._util.getPortalAdminBaseUrl()+"/security/users/getEnterpriseUser/";this.notSet(a)||(a=this._util.request({url:b,
content:{username:a}},{usePost:!0}),p.push(a))}));(new c.DeferredList(p)).then(c.hitch(this,function(b){c.forEach(b,c.hitch(this,function(b){if(b[0]&&b[1]){var g="",k=this.LICENSE_LEVELS.TWO;c.forEach(a,c.hitch(this,function(a){var c=d.getValue(a,this.i18n.csv.username);-1<b[1].username.toLowerCase().indexOf(c.toLowerCase())&&(g=d.getValue(a,this.i18n.csv.role),this._isPortal&&g&&g.toLowerCase()===this.i18n.userRoles.admin.toLowerCase()?g=this.accountAdminRole:g&&g.toLowerCase()===this.i18n.csv.publisherRole.toLowerCase()?
g=this.accountPublisherRole:g&&g.toLowerCase()===this.i18n.csv.userRole.toLowerCase()?g=this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&g&&g.toLowerCase()===this.i18n.csv.viewerRole.toLowerCase()?g=this.SYSTEM_ROLES.VIEWER:(g=this.getCustomRoleId(g))||(g=this._isPortal?this._portalDefaultUser:this.accountUserRole),esriGeowConfig.userLicenseLevelsEnabled&&(k=d.getValue(a,this.i18n.csv.level),k!==this.LICENSE_LEVELS.ONE||this._isValidLevelOneRole(g)||(g=this.SYSTEM_ROLES.VIEWER)))}));
""===g&&(g=this._isPortal?this._portalDefaultUser:this.accountUserRole);var m=this._lookupRoleName(g),n=b[1].email,p=this._cleanUsernameDomain(b[1].username),q=b[1].fullname,r=this._splitFullName(q),m={username:p,fullname:q,firstname:r.first,lastname:r.last,email:n,role:g,rolename:m,provider:this.enterpriseProvider};esriGeowConfig.userLicenseLevelsEnabled&&(m.level=k||this.LICENSE_LEVELS.TWO);m.id=(new Date).getTime();e.push(m);f.push(m.username)}}));0<f.length?this._account.checkUsernames(f,c.hitch(this,
function(a){if(a.usernames&&a.usernames.length===f.length){var b=[];for(r=0;r<a.usernames.length;r++){var d=-1,g;for(g=0;g<e.length;g++)if(e[g].username===a.usernames[r].requested){d=g;break}var k=new c.Deferred;if(-1<d){var m=!1;e[d].username!=a.usernames[r].suggested&&(this.setReviewWarningMessage(this.i18n.step2Create.invalid.usernameExistsFile),m=!0);this._userStore.fetchItemByIdentity({identity:e[d].username,onItem:c.hitch(this,function(a){esri.isDefined(a)||m?e[d].invalid&&(e[d].invalid=!1,
n--):this._userStore.newItem(e[d]);q=!0;k.resolve()})})}else k.resolve();b.push(k)}(new c.DeferredList(b)).then(c.hitch(this,function(){q?this._userStore.save({onComplete:c.hitch(this,function(){this._currentCreateMessage=this._createBatchMessage.get("value");this._editingCreate=!1;this._editingCreateUser=null;this.resetCreateSingleForm(!0);n?(this.initializeFixErrors(),this.hide(),c.style(this._fixErrors,"display","block")):(this.goToStep3(),this.initializeInviteGroupUserGrid())})}):this.setCreateErrorMessage(this.i18n.step2Create.invalid.uploadNoUsers)}))}else this.setCreateErrorMessage(this.i18n.step2Create.invalid.upload)})):
this.setCreateErrorMessage(this.i18n.step2Create.invalid.uploadNoUsers)}))}}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(this.i18n.step2Create.invalid.upload)})})},goToNextInvalidUser:function(){this._userStore.fetch({onComplete:c.hitch(this,function(a){this._currentlyFixing=null;var e=!1,f;for(f=0;f<a.length;f++){var d=this._userStore.getValue(a[f],"invalid");if(esri.isDefined(d)&&!0===d){this._currentlyFixing=a[f];this._fixingNumber++;e=!0;break}}e?(a=esri.substitute({x:this._fixingNumber,
n:this._numToFix},this.i18n.fixErrors.usersNeedAttention),c.attr(this._fixCurrent,"innerHTML",a),this.populateFixErrorsForm(),this.onFixNextClicked()):(this.resetFixErrorsForm(!0),this.goToStep3(),this.initializeCreateUserGrid())})})},initializeFixErrors:function(){this._userStore.fetch({onComplete:c.hitch(this,function(a){c.forEach(a,c.hitch(this,function(a){this._totalUsers++;var c=this._userStore.getValue(a,"invalid");esri.isDefined(c)&&!0===c&&(this._numToFix++,this._currentlyFixing||(this._currentlyFixing=
a,this._fixingNumber=1))}));this._fixErrorsContentPane?(a=esri.substitute({x:this._numToFix,n:this._totalUsers,name:this._isPortal?this._settings.name:this.i18n.arcgis},this._addMode?this.i18n.fixErrors.needAttentionAdd:this.i18n.fixErrors.needAttention),c.attr(this._fixAlert,"innerHTML"," "+a),a=esri.substitute({x:this._fixingNumber,n:this._numToFix,name:this._isPortal?this._settings.name:this.i18n.arcgis},this._addMode?this.i18n.fixErrors.usersNeedAttentionAdd:this.i18n.fixErrors.usersNeedAttention),
c.attr(this._fixCurrent,"innerHTML",a)):this.buildFixErrors();this._addMode?(this._fixPasswordRow&&c.style(this._fixPasswordRow,"display",""),this._fixPasswordSpacer&&c.style(this._fixPasswordSpacer,"display","")):(this._fixPasswordRow&&c.style(this._fixPasswordRow,"display","none"),this._fixPasswordSpacer&&c.style(this._fixPasswordSpacer,"display","none"))})})},processInviteCsvData:function(a){var e=a.indexOf("\n"),e=c.trim(a.substr(0,e)),e=this.getSeparator(e),f=new h.data.CsvStore({data:a,separator:e});
f.fetch({onComplete:c.hitch(this,function(a){this.initializeUserStore();var b=[],d=!1;c.forEach(a,c.hitch(this,function(a){var d=f.getValue(a,this.i18n.csv.email),c=f.getValue(a,this.i18n.csv.role),e;esriGeowConfig.userLicenseLevelsEnabled&&(e=f.getValue(a,this.i18n.csv.level)||this.LICENSE_LEVELS.TWO);d&&(this._isPortal&&c&&c.toLowerCase()===this.i18n.userRoles.admin.toLowerCase()?c=this.accountAdminRole:c&&c.toLowerCase()===this.i18n.csv.publisherRole.toLowerCase()?c=this.accountPublisherRole:c&&
c.toLowerCase()===this.i18n.csv.userRole.toLowerCase()?c=this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&c&&c.toLowerCase()===this.i18n.csv.viewerRole.toLowerCase()?c=this.SYSTEM_ROLES.VIEWER:(c=this.getCustomRoleId(c))||(c=this._isPortal?this._portalDefaultUser:this.accountUserRole),d={email:d,role:c,rolename:this._lookupRoleName(c)},esriGeowConfig.userLicenseLevelsEnabled&&(d.level=e,d.level!==this.LICENSE_LEVELS.ONE||this._isValidLevelOneRole(c)||(d.role=this.SYSTEM_ROLES.VIEWER)),
!this._isPortal&&this._isAdmin&&(d.userType="true"===(f.getValue(a,this.i18n.csv.allowEsriAccess)||"").toLowerCase()?"both":""),b.push(d))}));a=[];var e;for(e=0;e<b.length;e++){var m=new c.Deferred;this._userStore.fetchItemByIdentity({identity:b[e].email,onItem:c.hitch(this,function(a){esri.isDefined(a)||this._userStore.newItem(b[e]);d=!0;m.resolve()}),onError:c.hitch(this,function(a){this._userStore.newItem(b[e]);d=!0;m.resolve()})});a.push(m)}(new c.DeferredList(a)).then(c.hitch(this,function(){d?
this._userStore.save({onComplete:c.hitch(this,function(){this._currentInviteMessage=this._inviteBatchMessage.get("value");this._editingInvite=!1;this._editingInviteUser=null;this.resetInviteSingleForm(!0);this.goToStep3();this.initializeInviteUserGrid()})}):this.setInviteErrorMessage(this.i18n.step2Invite.invalid.uploadNoUsers)}))}),onError:c.hitch(this,function(a){this.setInviteErrorMessage(this.i18n.step2Invite.invalid.upload)})})},processIDPCsvData:function(a){var e=a.indexOf("\n"),e=c.trim(a.substr(0,
e)),e=this.getSeparator(e),f=new h.data.CsvStore({data:a,separator:e});f.fetch({onComplete:c.hitch(this,function(a){this.initializeUserStore();var b=[],d=!1;c.forEach(a,c.hitch(this,function(a){var d=f.getValue(a,this.i18n.csv.email),c=f.getValue(a,this.i18n.csv.role),e;esriGeowConfig.userLicenseLevelsEnabled&&(e=f.getValue(a,this.i18n.csv.level)||this.LICENSE_LEVELS.TWO);d&&(this._isPortal&&c&&c.toLowerCase()===this.i18n.userRoles.admin.toLowerCase()?c=this.accountAdminRole:c&&c.toLowerCase()===
this.i18n.csv.publisherRole.toLowerCase()?c=this.accountPublisherRole:c&&c.toLowerCase()===this.i18n.csv.userRole.toLowerCase()?c=this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&c&&c.toLowerCase()===this.i18n.csv.viewerRole.toLowerCase()?c=this.SYSTEM_ROLES.VIEWER:(c=this.getCustomRoleId(c))||(c=this._isPortal?this._portalDefaultUser:this.accountUserRole),d={email:d,role:c,rolename:this._lookupRoleName(c)},esriGeowConfig.userLicenseLevelsEnabled&&(d.level=e,d.level!==this.LICENSE_LEVELS.ONE||
this._isValidLevelOneRole(c)||(d.role=this.SYSTEM_ROLES.VIEWER)),!this._isPortal&&this._isAdmin&&(d.userType="true"===(f.getValue(a,this.i18n.csv.allowEsriAccess)||"").toLowerCase()?"both":""),b.push(d))}));a=[];var e;for(e=0;e<b.length;e++){var m=new c.Deferred;this._userStore.fetchItemByIdentity({identity:b[e].email,onItem:c.hitch(this,function(a){esri.isDefined(a)||this._userStore.newItem(b[e]);d=!0;m.resolve()}),onError:c.hitch(this,function(a){this._userStore.newItem(b[e]);d=!0;m.resolve()})});
a.push(m)}(new c.DeferredList(a)).then(c.hitch(this,function(){d?this._userStore.save({onComplete:c.hitch(this,function(){this._currentIDPMessage=this._idpBatchMessage.get("value");this._editingIDP=!1;this._editingIDPUser=null;this.resetIDPSingleForm(!0);this.goToStep3();this.initializeIDPUserGrid()})}):this.setIDPErrorMessage(this.i18n.step2IDP.invalid.uploadNoUsers)}))}),onError:c.hitch(this,function(a){this.setIDPErrorMessage(this.i18n.step2IDP.invalid.upload)})})},containsInvalidFields:function(a){return a.firstname&&
a.lastname&&a.username&&a.email&&a.role&&(!this._addMode||this._addMode&&a.password)?!this._util.isValidEmailAddress(a.email)||a.username.length<this._minUsernameLength||a.username.length>this._maxUsernameLength||!(this._isPortal?this.usernameContainsAlphaNumericPortal(a.username):this.usernameContainsAlphaNumeric(a.username))||this._addMode&&!this._util.meetsPasswordStrength(a.password):!0},containsInvalidFieldsSAML:function(a){return a.firstname&&a.lastname&&a.username&&a.email&&a.role?!this._util.isValidEmailAddress(a.email)||
a.username.length<this._minSAMLUsernameLength||a.username.length>this._maxSAMLUsernameLength||!(this._isPortal?this.usernameContainsAlphaNumericPortal(a.username):this.usernameContainsAlphaNumeric(a.username)):!0},containsInvalidFieldsAD:function(a){return a.username&&a.role?!(this._isPortal?this.usernameContainsAlphaNumericPortal(a.username):this.usernameContainsAlphaNumeric(a.username)):!0},uploadError:function(a){this._mode===this.modeInvite?this.setInviteErrorMessage(this.i18n.step2Invite.invalid.upload):
this._mode===this.modeCreate&&this.setCreateErrorMessage(this.i18n.step2Create.invalid.upload)},populateFixErrorsForm:function(){if(this._currentlyFixing){this._settingFixUsername=this._settingFixEmail=!0;this._addMode&&(this._settingFixPassword=!0);if(this._fixEmail){var a=this._userStore.getValue(this._currentlyFixing,"email");a?this._fixEmail.set("value",a):""===this._fixEmail.get("value")?this._settingFixEmail=!1:this._fixEmail.set("value","")}this._fixFirstName&&((a=this._userStore.getValue(this._currentlyFixing,
"firstname"))?this._fixFirstName.set("value",a):this._fixFirstName.set("value",""));this._fixLastName&&((a=this._userStore.getValue(this._currentlyFixing,"lastname"))?this._fixLastName.set("value",a):this._fixLastName.set("value",""));this._fixUsername&&((a=this._userStore.getValue(this._currentlyFixing,"username"))?(this._fixUsername.set("value",a),this._settingFixUsername=!1):""===this._fixUsername.get("value")?this._settingFixUsername=!1:this._fixUsername.set("value",""));this._addMode&&this._fixPassword&&
"saml"!==this._userType&&((a=this._userStore.getValue(this._currentlyFixing,"password"))?this._fixPassword.set("value",a):""===this._fixPassword.get("value")?this._settingFixPassword=!1:this._fixPassword.set("value",""));a=this._userStore.getValue(this._currentlyFixing,"role");this._isPortal&&this.accountAdminRole?this._fixRole.set("value",this.i18n.userRoles.admin):a===this.accountPublisherRole?this._fixRole.set("value",this.i18n.userRoles.publisher):a===this.accountUserRole?this._fixRole.set("value",
this.i18n.userRoles.user):esriGeowConfig.userLicenseLevelsEnabled&&a===this.SYSTEM_ROLES.VIEWER?this._fixRole.set("value",this.i18n.userRoles.viewer):(a=this.getCustomRoleName(a))?this._fixRole.set("value",a):this._isPortal?this._fixRole.set("value",this._portalDefaultUser):this._fixRole.set("value",this.i18n.userRoles.user);!this._isPortal&&this._isAdmin&&this._fixEsriAccessCheckBox.set("checked","both"===this._userStore.getValue(this._currentlyFixing,"userType"))}},getSeparator:function(a){var e=
0,f="";c.forEach([","," ",";","|","\t"],function(d){var b=a.split(d).length;b>e&&(e=b,f=d)});return f},bytesToString:function(a){var c=0,f=[],d=a.length,b,g,k,m;for("239,187,191"==a.slice(0,3)&&(c=3);c<d;c++)b=a[c],128>b?f.push(String.fromCharCode(b)):194<=b&&224>b?(g=a[++c],f.push(String.fromCharCode(((b&31)<<6)+(g&63)))):224<=b&&240>b?(g=a[++c],k=a[++c],f.push(String.fromCharCode(((b&255)<<12)+((g&63)<<6)+(k&63)))):240<=b&&245>b&&(g=a[++c],k=a[++c],m=a[++c],b=((b&7)<<18)+((g&63)<<12)+((k&63)<<6)+
(m&63),b-=65536,f.push(String.fromCharCode((b>>10)+55296,(b&1023)+56320)));return f.join("")},isSet:function(a){return esri.isDefined(a)&&0<a.length},notSet:function(a){return!esri.isDefined(a)||""===a},cleanUsername:function(a){a&&0<a.length&&(a=a.replace(/[^[a-zA-Z0-9@_\.]]*/g,"_"));return a},cleanUsernamePortal:function(a){a&&0<a.length&&(a=a.replace(/[^[a-zA-Z0-9@_\.\-]]*/g,"_"));return a},createHTMLLineBreaks:function(a){if(a)for(var c=-1;-1<(c=a.indexOf("\n"));)a=0===c?"\x3cbr\x3e"+a.substring(c+
1):a.substring(0,c)+"\x3cbr\x3e"+a.substring(c+1);return a},firstNameFormatter:function(a,c){return c?c.firstname[0]?c.firstname[0]:"":this.defaultValue},lastNameFormatter:function(a,c){return c?c.lastname[0]?c.lastname[0]:"":this.defaultValue},fullNameFormatter:function(a,c){return c?(c.firstname[0]?c.firstname[0]:"")+" "+(c.lastname[0]?c.lastname[0]:""):this.defaultValue},emailFormatter:function(a,c){return c?c.email[0]?c.email[0]:"":this.defaultValue},usernameFormatter:function(a,c){return c?c.username[0]?
c.username[0]:"":this.defaultValue},levelFormatter:function(a,c){if(!c)return this.defaultValue;a="";c=c.level&&c.level[0];var e=l.byId("inviteWidget");c&&(a='\x3cdiv class\x3d"talignCenter"\x3e'+arcgisonline.sharing.util.getLevelSpan(e.i18n.levelLabel,c)+"\x3c/div\x3e");return a},roleFormatter:function(a,c){if(!c)return this.defaultValue;var e,d;c=c.role[0];var b=l.byId("inviteWidget");esriGeowConfig.userLicenseLevelsEnabled&&c===b.SYSTEM_ROLES.VIEWER?(e=b.i18n.userRoles.viewer,d=b._getViewerRoleTooltip()):
c===b.accountUserRole?(e=b.i18n.userRoles.user,d=b._getUserRoleTooltip()):c===b.accountPublisherRole?(e=b.i18n.userRoles.publisher,d=b._getPublisherRoleTooltip()):b._isPortal&&c===b.accountAdminRole?(e=b.i18n.userRoles.admin,d=b._getAdminRoleTooltip()):(a=b.getCustomRoleName(c),c=b.getCustomRoleDesc(c),a&&(e=a,c&&(d=c)));return'\x3cspan title\x3d"'+d+'"\x3e'+e+"\x3c/span\x3e"},editFormatter:function(a,c){if(!c)return this.defaultValue;a=l.byId("inviteWidget");var e=a.i18n.formatters.editLabel,d=a.i18n.formatters.removeLabel,
b="",g=a._mode;g===a.modeInvite||g===a.modeIDP?b=c.email[0]:g===a.modeCreate&&(b=c.username[0]);return"\x3ca class\x3d'esriContentItemTitle' style\x3d'text-decoration:underline;' href\x3d'#' onclick\x3d'dijit.byId(\"inviteWidget\").editInvite(\""+b+"\");'\x3e"+e+"\x3c/a\x3e"+(" \x3ca class\x3d'esriContentItemTitle' style\x3d'text-decoration:underline;' href\x3d'#' onclick\x3d'dijit.byId(\"inviteWidget\").removeInvite(\""+b+"\");'\x3e"+d+"\x3c/a\x3e")},editFormatterGroup:function(a,c){if(!c)return this.defaultValue;
a=l.byId("inviteWidget");var e=a.i18n.formatters.removeLabel,d="",b=a._mode;b===a.modeInvite||b===a.modeIDP?d=c.email[0]:b===a.modeCreate&&(d=c.username[0]);return" \x3ca class\x3d'esriContentItemTitle' style\x3d'text-decoration:underline;' href\x3d'#' onclick\x3d'dijit.byId(\"inviteWidget\").removeInvite(\""+d+"\");'\x3e"+e+"\x3c/a\x3e"},canSortGroupColumns:function(a){var c=5;esriGeowConfig.userLicenseLevelsEnabled&&(c+=1);return a!==c},canSortColumns:function(a){var c=l.byId("inviteWidget"),f=
!!esriGeowConfig.userLicenseLevelsEnabled,c=c._mode===c.modeCreate?6:3;f&&(c+=1);return a!==c},onTypeNextClicked:function(){c.forEach(c.query("[name\x3d'memberType']"),c.hitch(this,function(a){a.checked&&(this._userType=a.value)}));this._addMode=!0;this.onCreateUsers()},onFixBackClicked:function(){this.resetCreateSingleForm(!0);this.hide();c.style(this._step2Create,"display","block");this.resetUserStore()},onFixClicked:function(){this.populateFixErrorsForm();this.onFixNextClicked();c.style(this._fixAlertDiv,
"display","none");c.style(this._fixEditDiv,"display","block")},onFixReviewClicked:function(){this.resetFixErrorsForm(!0);this.goToStep3();this.initializeCreateUserGrid()},onFixEmailChanged:function(){if(this._settingFixEmail)this._settingFixEmail=!1;else{var a=this._fixEmail.get("value");if(this._util.isValidEmailAddress(a)){this.resetFixErrorMessage();var a=a.split("@")[0],e=this._settings.urlKey?"_"+this._settings.urlKey:"",f=a.length+e.length,a=a.substring(0,a.length-(f>this._maxUsernameLength?
f%this._maxUsernameLength:0))+e,a=this._isPortal?this.cleanUsernamePortal(a):this.cleanUsername(a);this._isPortal&&this._addMode&&"saml"===this._userType&&(a=this._addSAMLSuffix(a));this._account.checkUsernames([a],c.hitch(this,this.handleCheckFixedUsername),c.hitch(this,this.handleCheckFixedUsername))}else this.setCreateErrorMessage(esri.substitute({email:a},this.i18n.fixErrors.invalid.emailAddress))}},onFixUsernameChanged:function(){if(this._settingFixUsername)this._settingFixUsername=!1;else{var a=
this._fixUsername.get("value");this.notSet(a)?this.setFixErrorMessage(this.i18n.fixErrors.invalid.usernameIsBlank):this.usernameContainsAlphaNumeric(a)?(this.resetFixErrorMessage(),a=this._isPortal?this.cleanUsernamePortal(a):this.cleanUsername(a),this._isPortal&&this._addMode&&"saml"===this._userType&&(a=this._addSAMLSuffix(a)),this._account.checkUsernames([a],c.hitch(this,this.handleCheckFixedUsername),c.hitch(this,this.handleCheckFixedUsername))):this.setFixErrorMessage(this.i18n.fixErrors.invalid.usernameInvalidChars)}},
onFixPasswordChanged:function(){if(this._settingFixPassword)this._settingFixPassword=!1;else{var a=this._fixPassword.get("value");this.notSet(a)||this.isSet(a)&&this._util.meetsPasswordStrength(a)?this.setFixErrorMessage(this.i18n.passwordHintText):this.resetFixErrorMessage()}},onFixNextClicked:function(){var a="",e="",f="";this._fixEmail&&this._fixFirstName&&this._fixLastName&&(a=this._util.stripHTML(this._fixEmail.get("value")),e=this._util.stripHTML(this._fixFirstName.get("value")),f=this._util.stripHTML(this._fixLastName.get("value")));
var d=this._util.stripHTML(this._fixUsername.get("value")),b=this._util.stripHTML(this._fixRole.get("value")),g=this.accountUserRole,g=this._isPortal&&b===this.i18n.userRoles.admin?this.accountAdminRole:b===this.i18n.userRoles.publisher?this.accountPublisherRole:this._isPortal&&b===this.i18n.userRoles.user?this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&b===this.i18n.userRoles.viewer?this.SYSTEM_ROLES.VIEWER:this.getCustomRoleId(b)||this.getDefaultUserRole(),e=this._util.stripHTML(c.trim(e)),
f=this._util.stripHTML(c.trim(f)),a=this._util.stripHTML(c.trim(a)),k="ja"===c.locale?f+" "+e:e+" "+f,m={username:this._isPortal?this.cleanUsernamePortal(d):this.cleanUsername(d),fullname:k,firstname:e,lastname:f,email:a,role:g,rolename:b};esriGeowConfig.userLicenseLevelsEnabled&&(m.level=this._fixLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);!this._isPortal&&this._isAdmin&&(m.userType=this._fixEsriAccessCheckBox.get("checked")?"both":void 0);this._addMode&&this._fixPassword&&
"saml"!==this._userType&&(m.password=c.trim(this._fixPassword.get("value")));this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(m.idpUsername=this._removeSAMLSuffix(d),m.username=this._addSAMLSuffix(m.username));(!this._isPortal||"ldap"!==this._userType&&"windows"!==this._userType?this.isValidFixedUser(m):this.isValidFixedUserAD(m))&&this._userStore.fetch({onComplete:c.hitch(this,function(a){var b,d,e;c.forEach(a,c.hitch(this,function(a){b=this._currentlyFixing.username[0];
d=this._userStore.getValue(a,"username");e=b===d;this._currentlyFixing&&e&&(b!==m.username?(this._userStore.deleteItem(a),this._userStore.newItem(m)):(this._userStore.setValue(a,"email",m.email),this._userStore.setValue(a,"fullname",m.fullname),this._userStore.setValue(a,"firstname",m.firstname),this._userStore.setValue(a,"lastname",m.lastname),this._addMode&&"builtin"===this._userType&&this._userStore.setValue(a,"password",m.password),this._userStore.setValue(a,"role",m.role),this._userStore.setValue(a,
"rolename",m.rolename),this._userStore.setValue(a,"invalid",null),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",m.level),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&this._userStore.setValue(a,"idpUsername",m.idpUsername),this._isPortal||this._userStore.setValue(a,"userType",m.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,function(){var a=esri.substitute({username:m.username},this.i18n.fixErrors.success.userFixed);this.setFixSuccessMessage(a);
this._fixingNumber===this._numToFix?(this.resetFixErrorsForm(!0),this.goToStep3(),this.initializeCreateUserGrid()):this.goToNextInvalidUser()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})})})},onCreateUsernameChanged:function(){if(this._settingCreateSingleUser)this._settingCreateSingleUser=!1;else{var a=this._createSingleUsername.get("value");this.notSet(a)?this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameIsBlank):(this._isPortal?this.usernameContainsAlphaNumericPortal(a):
this.usernameContainsAlphaNumeric(a))?(this.resetCreateErrorMessage(),a=this._isPortal?this.cleanUsernamePortal(a):this.cleanUsername(a),this._account.checkUsernames([a],c.hitch(this,this.handleCheckUsername),c.hitch(this,this.handleCheckUsername))):this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameInvalidChars)}},onCreatePasswordChanged:function(){if(this._settingCreateSinglePassword)this._settingCreateSinglePassword=!1;else{var a=this._createSinglePassword.get("value");this.notSet(a)||
a.length<this._minPasswordLength?this.setCreateErrorMessage(this.i18n.step2Create.invalid.passwordTooShort):a.length>this._maxPasswordLength?this.setCreateErrorMessage(this.i18n.step2Create.invalid.passwordTooLong):this.resetCreateErrorMessage()}},onCreateEmailChanged:function(){if(this._settingCreateSingleEmail)this._settingCreateSingleEmail=!1;else{var a=this._util.stripHTML(this._createSingleEmail.get("value"));if(this._util.isValidEmailAddress(a)){this.resetCreateErrorMessage();var a=a.split("@")[0],
e=this._settings.urlKey?"_"+this._settings.urlKey:"",f=a.length+e.length,a=a.substring(0,a.length-(f>this._maxUsernameLength?f%this._maxUsernameLength:0))+e;a.length<this._minUsernameLength&&(a=this._lengthenUsername(a,this._minUsernameLength-a.length));a=this._isPortal?this.cleanUsernamePortal(a):this.cleanUsername(a);this._account.checkUsernames([a],c.hitch(this,this.handleCheckUsername),c.hitch(this,this.handleCheckUsername))}else this.setCreateErrorMessage(esri.substitute({email:a},this.i18n.step2Create.invalid.emailAddress))}},
_lengthenUsername:function(a,c){if(a&&0<c){var e=""+(new Date).getTime();return a+e.substring(e.length-c)}return a},_cleanUsernameDomain:function(a){if(a&&(this._supportsLDAP||this._supportsWindows)){var c=a.indexOf("\\");if(-1<c&&c<=a.length-2)return a.substring(c+1)+"@"+a.substring(0,c).toUpperCase()}return a},onCreateAnotherUserClicked:function(){this.resetCreateErrorMessage();this.initializeUserStore();var a=this._util.getPortalAdminBaseUrl()+"/security/users/getEnterpriseUser",e=this._createEnterpriseUser.get("value"),
f=this._createUserRole.get("value");this._currentSelectedCreateRole=this.accountUserRole;this._currentSelectedCreateRole=this._isPortal&&f===this.i18n.userRoles.admin?this.accountAdminRole:f===this.i18n.userRoles.publisher?this.accountPublisherRole:this._isPortal&&f===this.i18n.userRoles.user?this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&f===this.i18n.userRoles.viewer?this.SYSTEM_ROLES.VIEWER:this.getCustomRoleId(f)||this.getDefaultUserRole();var d=!1;this.notSet(e)&&(d=!0,this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameIsBlank));
d||this._util.request({url:a,content:{username:e}},{usePost:!0}).then(c.hitch(this,function(a){c.style(c.byId("reviewSpinnerUser"),"display","none");this._createUserReviewBtn.setDisabled(!1);if(a){var b=a.email,d=this._cleanUsernameDomain(a.username);a=a.fullname;var m=this._splitFullName(a),p={username:d,fullname:a,firstname:m.first,lastname:m.last,email:b,role:this._currentSelectedCreateRole,rolename:f,provider:this.enterpriseProvider};esriGeowConfig.userLicenseLevelsEnabled&&(p.level=this._createEnterpriseLevel1Radio.get("checked")?
this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);this._editingCreate&&this._editingCreateUser&&(p.id=this._editingCreateUser.id[0]);p.id=(new Date).getTime();this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&-1<e.indexOf(this._samlSuffix)&&(p.idpUsername=this._removeSAMLSuffix(e),p.username=this._addSAMLSuffix(p.username));this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(a,"username")===p.username&&
(b=!0)}));b?(a=esri.substitute({username:p.username},this.i18n.step2Create.invalid.usernameExists),this.setCreateErrorMessage(a)):(this._userStore.newItem(p),this._userStore.save({onComplete:c.hitch(this,function(){this._editingCreate=!1;this._editingCreateUser=null;var a=esri.substitute({email:p.email},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateUserForm()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})}))})})}else arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.userNameDoesntExist)})}),c.hitch(this,function(a){c.style(c.byId("reviewSpinnerUser"),"display","none");this._createUserReviewBtn.setDisabled(!1);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.userNameDoesntExist)})}))},onCreateUserReviewClicked:function(){this.resetCreateErrorMessage();
this.resetReviewWarningMessage();this.initializeUserStore();var a=this._util.getPortalAdminBaseUrl()+"/security/users/getEnterpriseUser",e=this._createEnterpriseUser.get("value"),f=this._createUserRole.get("value");this._currentSelectedCreateRole=this.accountUserRole;this._currentSelectedCreateRole=this._isPortal&&f===this.i18n.userRoles.admin?this.accountAdminRole:f===this.i18n.userRoles.publisher?this.accountPublisherRole:this._isPortal&&f===this.i18n.userRoles.user?this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&
f===this.i18n.userRoles.viewer?this.SYSTEM_ROLES.VIEWER:this.getCustomRoleId(f)||this.getDefaultUserRole();this.notSet(e)&&this._userStore&&this._userStore._arrayOfAllItems&&0===this._userStore._arrayOfAllItems.length?(this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameIsBlank),c.style(c.byId("reviewSpinnerUser"),"display","none"),this._createUserReviewBtn.setDisabled(!1)):(c.style(c.byId("reviewSpinnerUser"),"display",""),this._createUserReviewBtn.setDisabled(!0),this.notSet(e)?(this.goToStep3(),
this.initializeInviteGroupUserGrid(),c.style(c.byId("reviewSpinnerUser"),"display","none"),this._createUserReviewBtn.setDisabled(!1)):this._util.request({url:a,content:{username:e}},{usePost:!0}).then(c.hitch(this,function(a){c.style(c.byId("reviewSpinnerUser"),"display","none");this._createUserReviewBtn.setDisabled(!1);if(a){var b=a.email,d=this._cleanUsernameDomain(a.username);a=a.fullname;var k=this._splitFullName(a),m={username:d,fullname:a,firstname:k.first,lastname:k.last,email:b,role:this._currentSelectedCreateRole,
rolename:f,provider:this.enterpriseProvider};esriGeowConfig.userLicenseLevelsEnabled&&(m.level=this._createEnterpriseLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);this._editingCreate&&this._editingCreateUser&&(m.id=this._editingCreateUser.id[0]);m.id=(new Date).getTime();this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(a,"username")===m.username&&(b=!0)}));b||this._userStore.newItem(m);this._userStore.save({onComplete:c.hitch(this,
function(){this._editingCreate=!1;this._editingCreateUser=null;var a=esri.substitute({email:m.email},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateUserForm();this.goToStep3();this.initializeInviteGroupUserGrid()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})})})}else arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.userNameDoesntExist)})}),c.hitch(this,function(a){c.style(c.byId("reviewSpinnerUser"),"display","none");this._createUserReviewBtn.setDisabled(!1);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.userNameDoesntExist)})})))},onCreateGroupReviewClicked:function(){this.resetCreateErrorMessage();
this.resetUserStore();this.initializeUserStore();var a=this._util.getPortalAdminBaseUrl()+"/security/groups/getUsersWithinEnterpriseGroup",e=this._createEnterpriseGroup.get("value"),f=this._createGroupRole.get("value"),d=this._currentSelectedCreateRole=this.accountUserRole,b=this._createGroupLevel1Radio.get("checked"),d=this._isPortal&&f===this.i18n.userRoles.admin?this._currentSelectedCreateRole=this.accountAdminRole:f===this.i18n.userRoles.publisher?this._currentSelectedCreateRole=this.accountPublisherRole:
this._isPortal&&f===this.i18n.userRoles.user?this._currentSelectedCreateRole=this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&f===this.i18n.userRoles.viewer?this._currentSelectedCreateRole=this.SYSTEM_ROLES.VIEWER:this._currentSelectedCreateRole=this.getCustomRoleId(f)||this.getDefaultUserRole(),g=!1;this.notSet(e)&&(g=!0,this.setCreateErrorMessage(this.i18n.step2Create.invalid.groupNameIsBlank));g||(c.style(c.byId("reviewSpinner"),"display",""),this._createGroupReviewBtn.setDisabled(!0),
this._util.request({url:a,content:{groupName:e}},{usePost:!0}).then(c.hitch(this,function(a){c.style(c.byId("reviewSpinner"),"display","none");this._createGroupReviewBtn.setDisabled(!1);a&&!a.code?c.forEach(a.users,c.hitch(this,function(a,e){e=a.email;var g=this._cleanUsernameDomain(a.username);a=a.fullname;var k=this._splitFullName(a),m={username:g,fullname:a,firstname:k.first,lastname:k.last,email:e,role:d,rolename:f,provider:this.enterpriseProvider};esriGeowConfig.userLicenseLevelsEnabled&&(m.level=
b?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);this._editingCreate&&this._editingCreateUser&&(m.id=this._editingCreateUser.id[0]);this._editingCreate?this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,function(a){b||this._userStore.getValue(this._editingCreateUser,"id")!==this._userStore.getValue(a,"id")||(b=!0,this._userStore.getValue(this._editingCreateUser,"username")!==m.username?(this._userStore.deleteItem(a),this._userStore.newItem(m)):(this._userStore.setValue(a,
"email",m.email),this._userStore.setValue(a,"fullname",m.fullname),this._userStore.setValue(a,"firstname",m.firstname),this._userStore.setValue(a,"lastname",m.lastname),this._addMode&&this._userStore.setValue(a,"password",m.password),this._userStore.setValue(a,"role",m.role),this._userStore.setValue(a,"rolename",m.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",m.level)))}));this._userStore.save({onComplete:c.hitch(this,function(){this._editingCreate=!1;this._editingCreateUser=
null;var a=esri.substitute({email:m.email},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded);this.setCreateSuccessMessage(a);this.goToStep3();this.initializeInviteGroupUserGrid()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})})}):(m.id=(new Date).getTime(),this._userStore.newItem(m),this._userStore.save({onComplete:c.hitch(this,function(){var a=esri.substitute({username:m.username},this._isPortal?this.i18n.step2Create.success.userAddedPortal:
this.i18n.step2Create.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateSingleForm(!0);this.resetCreateUserForm(!0);this.resetCreateGroupForm(!0);this.goToStep3();this.initializeInviteGroupUserGrid()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})}))})):arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.groupNameDoesntExist)})}),
c.hitch(this,function(a){c.style(c.byId("reviewSpinner"),"display","none");this._createGroupReviewBtn.setDisabled(!1);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:esri.substitute({name:this._util.stripHTML(e)},this.i18n.step2Create.invalid.groupNameDoesntExist)})})))},onCreateAnotherClicked:function(){this.resetCreateErrorMessage();this.initializeUserStore();var a=this._util.stripHTML(this._createSingleEmail.get("value")),e=
this._util.stripHTML(this._createSingleFirstName.get("value")),f=this._util.stripHTML(this._createSingleLastName.get("value")),d=this._util.stripHTML(this._createSingleUsername.get("value")),b=this._util.stripHTML(this._createSingleRole.get("value"));this._currentSelectedCreateRole=this.accountUserRole;this._currentSelectedCreateRole=this._isPortal&&b===this.i18n.userRoles.admin?this.accountAdminRole:b===this.i18n.userRoles.publisher?this.accountPublisherRole:this._isPortal&&b===this.i18n.userRoles.user?
this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&b===this.i18n.userRoles.viewer?this.SYSTEM_ROLES.VIEWER:this.getCustomRoleId(b)||this.getDefaultUserRole();var g={username:d,fullname:"ja"===c.locale?f+" "+e:e+" "+f,firstname:e,lastname:f,email:c.trim(a),role:this._currentSelectedCreateRole,rolename:b};esriGeowConfig.userLicenseLevelsEnabled&&(g.level=this._createSingleLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);this._addMode&&this._createSinglePassword&&
"saml"!==this._userType&&(g.password=this._createSinglePassword.get("value"));this._editingCreate&&this._editingCreateUser&&(g.id=this._editingCreateUser.id[0]);this._isPortal&&"saml"===this._userType&&(g.provider=this.enterpriseProvider);this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),g.username=this._addSAMLSuffix(g.username));!this._isPortal&&this._isAdmin&&(g.userType=this._createSingleEsriAccessCheckBox.get("checked")?
"both":void 0);a=function(a){a&&a.usernames&&a.usernames[0]&&a.usernames[0].suggested&&(d=a.usernames[0].suggested);this.isValidCreateUser(g)&&(g.username=this._isPortal?this.cleanUsernamePortal(d):this.cleanUsername(d),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),g.username=this._addSAMLSuffix(g.username)),this._currentCreateMessage=this._createSingleMessage.get("value"),this._editingCreate?this._userStore.fetch({onComplete:c.hitch(this,
function(a){c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(this._editingCreateUser,"id")===this._userStore.getValue(a,"id")&&(this._userStore.getValue(this._editingCreateUser,"username")!==g.username?(this._userStore.deleteItem(a),this._userStore.newItem(g)):(this._userStore.setValue(a,"email",g.email),this._userStore.setValue(a,"fullname",g.fullname),this._userStore.setValue(a,"firstname",g.firstname),this._userStore.setValue(a,"lastname",g.lastname),this._addMode&&this._userStore.setValue(a,
"password",g.password),this._userStore.setValue(a,"role",g.role),this._userStore.setValue(a,"rolename",g.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",g.level),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&this._userStore.setValue(a,"idpUsername",g.idpUsername),this._isPortal||this._userStore.setValue(a,"userType",g.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,function(){this._editingCreate=!1;this._editingCreateUser=
null;var a=esri.substitute({email:g.email},this._isPortal?this.i18n.step2Create.success.userAddedPortal:this.i18n.step2Create.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateSingleForm()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})})}):(g.username=this._isPortal?this.cleanUsernamePortal(d):this.cleanUsername(d),g.id=(new Date).getTime(),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),
g.username=this._addSAMLSuffix(g.username)),!this._isPortal&&this._isAdmin&&(g.userType=this._createSingleEsriAccessCheckBox.get("checked")?"both":void 0),this._userStore.newItem(g),this._userStore.save({onComplete:c.hitch(this,function(){var a=esri.substitute({username:g.username},this._isPortal?this.i18n.step2Create.success.userAddedPortal:this.i18n.step2Create.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateSingleForm()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})))};
this.notSet(d)?this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameIsBlank):(this._isPortal?this.usernameContainsAlphaNumericPortal(g.username):this.usernameContainsAlphaNumeric(g.username))?(g.username=this._isPortal?this.cleanUsernamePortal(d):this.cleanUsername(d),this._account.checkUsernames([d],c.hitch(this,a),c.hitch(this,a))):this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameInvalidChars)},_removeSAMLSuffix:function(a){var c="_"+this._samlSuffix;return a.lastIndexOf(c)===
a.length-c.length?a.substring(0,a.lastIndexOf(c)):a},_addSAMLSuffix:function(a){var c=a&&this._samlSuffix,f="_"+this._samlSuffix,d=c&&-1===a.indexOf(f),c=c&&a.lastIndexOf(f)===a.length-f.length;return d||c?a+f:a},onCreateReviewClicked:function(a){this.resetCreateErrorMessage();this.initializeUserStore();a=this._util.stripHTML(this._createSingleEmail.get("value"));var e=this._util.stripHTML(this._createSingleFirstName.get("value")),f=this._util.stripHTML(this._createSingleLastName.get("value")),d=
this._util.stripHTML(this._createSingleUsername.get("value")),b=this._util.stripHTML(this._createSingleRole.get("value"));this._currentSelectedCreateRole=this.accountUserRole;this._currentSelectedCreateRole=this._isPortal&&b===this.i18n.userRoles.admin?this.accountAdminRole:b===this.i18n.userRoles.publisher?this.accountPublisherRole:this._isPortal&&b===this.i18n.userRoles.user?this.accountUserRole:esriGeowConfig.userLicenseLevelsEnabled&&b===this.i18n.userRoles.viewer?this.SYSTEM_ROLES.VIEWER:this.getCustomRoleId(b)||
this.getDefaultUserRole();var g={username:d,fullname:"ja"===c.locale?f+" "+e:e+" "+f,firstname:e,lastname:f,email:c.trim(a),role:this._currentSelectedCreateRole,rolename:b};esriGeowConfig.userLicenseLevelsEnabled&&(g.level=this._createSingleLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);this._isPortal&&"saml"===this._userType&&(g.provider=this.enterpriseProvider);this._addMode&&this._createSinglePassword&&"saml"!==this._userType&&(g.password=c.trim(this._createSinglePassword.get("value")));
this._editingCreate&&this._editingCreateUser&&(g.id=this._editingCreateUser.id[0]);this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),g.username=this._addSAMLSuffix(g.username));!this._isPortal&&this._isAdmin&&(g.userType=this._createSingleEsriAccessCheckBox.get("checked")?"both":void 0);a=function(a){a&&a.usernames&&a.usernames[0]&&a.usernames[0].suggested&&(d=a.usernames[0].suggested);this.isValidCreateUser(g)&&(g.username=
this.cleanUsername(d),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),g.username=this._addSAMLSuffix(g.username)),this._currentCreateMessage=this._createSingleMessage.get("value"),this._editingCreate?this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,function(a){b||this._userStore.getValue(this._editingCreateUser,"id")!==this._userStore.getValue(a,"id")||(b=!0,this._userStore.getValue(this._editingCreateUser,
"username")!==g.username?(this._userStore.deleteItem(a),this._userStore.newItem(g)):(this._userStore.setValue(a,"email",g.email),this._userStore.setValue(a,"fullname",g.fullname),this._userStore.setValue(a,"firstname",g.firstname),this._userStore.setValue(a,"lastname",g.lastname),this._addMode&&this._createSinglePassword&&"saml"!==this._userType&&this._userStore.setValue(a,"password",g.password),this._userStore.setValue(a,"role",g.role),this._userStore.setValue(a,"rolename",g.rolename),esriGeowConfig.userLicenseLevelsEnabled&&
this._userStore.setValue(a,"level",g.level),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&this._userStore.setValue(a,"idpUsername",g.idpUsername),this._isPortal||this._userStore.setValue(a,"userType",g.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,function(){this._editingCreate=!1;this._editingCreateUser=null;var a=esri.substitute({email:g.email},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded);this.setCreateSuccessMessage(a);
this.resetCreateSingleForm(!0);this.goToStep3();this.initializeCreateUserGrid()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})})}):(g.username=this._isPortal?this.cleanUsernamePortal(d):this.cleanUsername(d),g.id=(new Date).getTime(),this._isPortal&&this._addMode&&"saml"===this._userType&&this._samlSuffix&&(g.idpUsername=this._removeSAMLSuffix(g.username),g.username=this._addSAMLSuffix(g.username)),!this._isPortal&&this._isAdmin&&(g.userType=this._createSingleEsriAccessCheckBox.get("checked")?
"both":void 0),this._userStore.newItem(g),this._userStore.save({onComplete:c.hitch(this,function(){var a=esri.substitute({username:g.username},this._isPortal?this.i18n.step2Create.success.userAddedPortal:this.i18n.step2Create.success.userAdded);this.setCreateSuccessMessage(a);this.resetCreateSingleForm(!0);this.goToStep3();this.initializeCreateUserGrid()}),onError:c.hitch(this,function(a){this.setCreateErrorMessage(a)})})))};this.notSet(g.firstname)&&this.notSet(g.lastname)&&this.notSet(g.email)&&
this.notSet(g.username)&&(!this._addMode||this._addMode&&this.notSet(g.password))&&this._userStore&&this._userStore._arrayOfAllItems&&0<this._userStore._arrayOfAllItems.length?(this.resetCreateSingleForm(!0),this.goToStep3(),this.initializeCreateUserGrid()):this.notSet(d)?this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameIsBlank):(this._isPortal?this.usernameContainsAlphaNumericPortal(g.username):this.usernameContainsAlphaNumeric(g.username))?(g.username=this._isPortal?this.cleanUsernamePortal(d):
this.cleanUsername(d),this._account.checkUsernames([d],c.hitch(this,a),c.hitch(this,a))):this.setCreateErrorMessage(this.i18n.step2Create.invalid.usernameInvalidChars)},onCreateUserRoleChanged:function(a){this._isPortal&&this.i18n.userRoles.admin===a?(this._currentSelectedCreateRole=this.accountAdminRole,this._createUserRole.set("title",this._getAdminRoleTooltip())):this.i18n.userRoles.publisher===a?(this._currentSelectedCreateRole=this.accountPublisherRole,this._createUserRole.set("title",this._getPublisherRoleTooltip())):
this.i18n.userRoles.user===a?(this._currentSelectedCreateRole=this.accountUserRole,this._createUserRole.set("title",this._getUserRoleTooltip())):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===a?(this._currentSelectedCreateRole=this.SYSTEM_ROLES.VIEWER,this._createUserRole.set("title",this._getViewerRoleTooltip())):(a=this.getCustomRoleId(a))?(this._currentSelectedCreateRole=a,this._createUserRole.set("title",this.getCustomRoleDesc(a))):this._isPortal?(this._currentSelectedCreateRole=
this._portalDefaultUser,this._createUserRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._currentSelectedCreateRole=this.accountUserRole,this._createUserRole.set("title",this._getUserRoleTooltip()))},onCreateGroupRoleChanged:function(a){this._isPortal&&this.i18n.userRoles.admin===a?(this._currentSelectedCreateRole=this.accountAdminRole,this._createGroupRole.set("title",this._getAdminRoleTooltip())):this.i18n.userRoles.publisher===a?(this._currentSelectedCreateRole=this.accountPublisherRole,
this._createGroupRole.set("title",this._getPublisherRoleTooltip())):this.i18n.userRoles.user===a?(this._currentSelectedCreateRole=this.accountUserRole,this._createGroupRole.set("title",this._getUserRoleTooltip())):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===a?(this._currentSelectedCreateRole=this.SYSTEM_ROLES.VIEWER,this._createGroupRole.set("title",this._getViewerRoleTooltip())):(a=this.getCustomRoleId(a))?(this._currentSelectedCreateRole=a,this._createGroupRole.set("title",
this.getCustomRoleDesc(a))):this._isPortal?(this._currentSelectedCreateRole=this._portalDefaultUser,this._createGroupRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._currentSelectedCreateRole=this.accountUserRole,this._createGroupRole.set("title",this._getUserRoleTooltip()))},onCreateSingleRoleChanged:function(a){this._isPortal&&this.i18n.userRoles.admin===a?(this._currentSelectedCreateRole=this.accountAdminRole,this._createSingleRole.set("title",this._getAdminRoleTooltip())):this.i18n.userRoles.publisher===
a?(this._currentSelectedCreateRole=this.accountPublisherRole,this._createSingleRole.set("title",this._getPublisherRoleTooltip())):this.i18n.userRoles.user===a?(this._currentSelectedCreateRole=this.accountUserRole,this._createSingleRole.set("title",this._getUserRoleTooltip())):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===a?(this._currentSelectedCreateRole=this.SYSTEM_ROLES.VIEWER,this._createSingleRole.set("title",this._getViewerRoleTooltip())):(a=this.getCustomRoleId(a))?
(this._currentSelectedCreateRole=a,this._createSingleRole.set("title",this.getCustomRoleDesc(a))):this._isPortal?(this._currentSelectedCreateRole=this._portalDefaultUser,this._createSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._currentSelectedCreateRole=this.accountUserRole,this._createSingleRole.set("title",this._getUserRoleTooltip()))},onInviteSingleRoleChanged:function(a){this._isPortal&&this.i18n.userRoles.admin===a?(this._currentSelectedInviteRole=this.accountAdminRole,
this._inviteSingleRole.set("title",this._getAdminRoleTooltip())):this.i18n.userRoles.publisher===a?(this._currentSelectedInviteRole=this.accountPublisherRole,this._inviteSingleRole.set("title",this._getPublisherRoleTooltip())):this.i18n.userRoles.user===a?(this._currentSelectedInviteRole=this.accountUserRole,this._inviteSingleRole.set("title",this._getUserRoleTooltip())):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===a?(this._currentSelectedInviteRole=this.SYSTEM_ROLES.VIEWER,
this._inviteSingleRole.set("title",this._getViewerRoleTooltip())):(a=this.getCustomRoleId(a))?(this._currentSelectedInviteRole=a,this._inviteSingleRole.set("title",this.getCustomRoleDesc(a))):this._isPortal?(this._currentSelectedInviteRole=this._portalDefaultUser,this._inviteSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._currentSelectedInviteRole=this.accountUserRole,this._inviteSingleRole.set("title",this._getUserRoleTooltip()))},onIDPSingleRoleChanged:function(a){this._isPortal&&
this.i18n.userRoles.admin===a?(this._currentSelectedIDPRole=this.accountAdminRole,this._idpSingleRole.set("title",this._getAdminRoleTooltip())):this.i18n.userRoles.publisher===a?(this._currentSelectedIDPRole=this.accountPublisherRole,this._idpSingleRole.set("title",this._getPublisherRoleTooltip())):this.i18n.userRoles.user===a?(this._currentSelectedIDPRole=this.accountUserRole,this._idpSingleRole.set("title",this._getUserRoleTooltip())):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===
a?(this._currentSelectedIDPRole=this.SYSTEM_ROLES.VIEWER,this._idpSingleRole.set("title",this._getViewerRoleTooltip())):(a=this.getCustomRoleId(a))?(this._currentSelectedIDPRole=a,this._idpSingleRole.set("title",this.getCustomRoleDesc(a))):this._isPortal?(this._currentSelectedIDPRole=this._portalDefaultUser,this._idpSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser))):(this._currentSelectedIDPRole=this.accountUserRole,this._idpSingleRole.set("title",this._getUserRoleTooltip()))},onIDPLevel1RadioClick:function(){this.filterRoles(!0);
this._resetRoleStore(this._idpSingleRole,this._idpSingleRoleStore);this._coreRoleSelected(this._idpSingleRole)&&(this._idpSingleRole.set("value",this.i18n.userRoles.viewer),this._idpSingleRole.set("title",this._getViewerRoleTooltip()))},onIDPLevel2RadioClick:function(){this.filterRoles();this._resetRoleStore(this._idpSingleRole,this._idpSingleRoleStore)},onInviteLevel1RadioClick:function(){this.filterRoles(!0);this._resetRoleStore(this._inviteSingleRole,this._inviteSingleRoleStore);this._coreRoleSelected(this._inviteSingleRole)&&
(this._inviteSingleRole.set("value",this.i18n.userRoles.viewer),this._inviteSingleRole.set("title",this._getViewerRoleTooltip()))},onInviteLevel2RadioClick:function(){this.filterRoles();this._resetRoleStore(this._inviteSingleRole,this._inviteSingleRoleStore)},onCreateSingleLevel1RadioClick:function(){this.filterRoles(!0);this._resetRoleStore(this._createSingleRole,this._createSingleRoleStore);this._coreRoleSelected(this._createSingleRole)&&(this._createSingleRole.set("value",this.i18n.userRoles.viewer),
this._createSingleRole.set("title",this._getViewerRoleTooltip()))},onCreateSingleLevel2RadioClick:function(){this.filterRoles();this._resetRoleStore(this._createSingleRole,this._createSingleRoleStore)},onCreateEnterpriseLevel1RadioClick:function(){this.filterRoles(!0);this._resetRoleStore(this._createUserRole,this._createUserRoleStore);this._coreRoleSelected(this._createUserRole)&&(this._createUserRole.set("value",this.i18n.userRoles.viewer),this._createUserRole.set("title",this._getViewerRoleTooltip()))},
onCreateEnterpriseLevel2RadioClick:function(){this.filterRoles();this._resetRoleStore(this._createUserRole,this._createUserRoleStore)},onCreateGroupLevel1RadioClick:function(){this.filterRoles(!0);this._resetRoleStore(this._createGroupRole,this._createGroupRoleStore);this._coreRoleSelected(this._createGroupRole)&&(this._createGroupRole.set("value",this.i18n.userRoles.viewer),this._createGroupRole.set("title",this._getViewerRoleTooltip()))},onCreateGroupLevel2RadioClick:function(){this.filterRoles();
this._resetRoleStore(this._createGroupRole,this._createGroupRoleStore)},onFixLevel1RadioClick:function(){this.filterRoles();this._resetRoleStore(this._fixRole,this._fixRoleStore);this._coreRoleSelected(this._fixRole)&&(this._fixRole.set("value",this.i18n.userRoles.viewer),this._fixRole.set("title",this._getViewerRoleTooltip()))},onFixLevel2RadioClick:function(){this.filterRoles(!0);this._resetRoleStore(this._fixRole,this._fixRoleStore)},onFixSingleRoleChanged:function(a){this._isPortal&&this.i18n.userRoles.admin===
a?this._fixRole.set("title",this._getAdminRoleTooltip()):this.i18n.userRoles.publisher===a?this._fixRole.set("title",this._getPublisherRoleTooltip()):this.i18n.userRoles.user===a?this._fixRole.set("title",this._getUserRoleTooltip()):esriGeowConfig.userLicenseLevelsEnabled&&this.i18n.userRoles.viewer===a?this._fixRole.set("title",this._getViewerRoleTooltip()):(a=this.getCustomRoleId(a))?this._fixRole.set("title",this.getCustomRoleDesc(a)):this._isPortal?this._fixRole.set("title",this.getRoleDesc(this._portalDefaultUser)):
this._fixRole.set("title",this._getUserRoleTooltip())},onCreateEnterpriseGroupKeyDown:function(a){a&&a.keyCode==c.keys.ENTER&&(a.preventDefault(),a.stopPropagation(),this.onSelectEnterpriseGroup())},onCreateEnterpriseUserKeyDown:function(a){a&&a.keyCode==c.keys.ENTER&&(a.preventDefault(),a.stopPropagation(),this.onSelectEnterpriseUser())},onSelectEnterpriseGroup:function(){var a=this._createEnterpriseGroup.get("value");arcgisonline.sharing.dijit.dialog.SelectEnterpriseGroupDlg.prototype.statics.getInstance().show(a)},
onSelectEnterpriseUser:function(){var a=this._createEnterpriseUser.get("value");arcgisonline.sharing.dijit.dialog.SelectEnterpriseUserDlg.prototype.statics.getInstance().show(a)},getDefaultUserRole:function(){return this._isPortal?this._portalDefaultUser:this.accountUserRole},resetUserStore:function(){this._userStore=null;this._userGrid&&this._userGrid.set("store",this._userStore)},resetFixErrorsForm:function(a){this._settingFixUsername=this._settingFixEmail=!0;this._addMode&&(this._settingFixPassword=
!0);this._numToFix=this._totalUsers=0;this._currentlyFixing=null;this._fixingNumber=0;a&&this.resetFixErrorMessage();this._fixEmail.setValue("");this._fixFirstName.setValue("");this._fixLastName.setValue("");this._fixUsername.setValue("");this._addMode&&this._fixPassword&&"saml"!==this._userType&&this._fixPassword.setValue("");esriGeowConfig.userLicenseLevelsEnabled&&(this._fixLevel2Radio.set("checked",!0),this.onFixLevel2RadioClick());this._isPortal?(this._fixRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),
this._fixRole.set("title",this.getRoleDesc(this._portalDefaultUser)),this._currentSelectedCreateRole=this._portalDefaultUser):(this._fixRole.set("value",this.i18n.userRoles.user),this._fixRole.set("title",this._getUserRoleTooltip()),this._currentSelectedCreateRole=this.accountUserRole);!this._isPortal&&this._isAdmin&&this._fixEsriAccessCheckBox.set("checked",!1)},resetCreateUserForm:function(){this._createEnterpriseUser.setValue("");esriGeowConfig.userLicenseLevelsEnabled&&(this._createEnterpriseLevel2Radio.set("checked",
!0),this.onCreateEnterpriseLevel2RadioClick());this._isPortal?(this._createUserRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._createUserRole.set("title",this.getRoleDesc(this._portalDefaultUser)),this._currentSelectedCreateRole=this._portalDefaultUser):(this._createUserRole.set("value",this.i18n.userRoles.user),this._createUserRole.set("title",this._getUserRoleTooltip()),this._currentSelectedCreateRole=this.accountUserRole)},resetCreateGroupForm:function(){this._createEnterpriseGroup.setValue("");
esriGeowConfig.userLicenseLevelsEnabled&&(this._createGroupLevel2Radio.set("checked",!0),this.onCreateGroupLevel2RadioClick());this._isPortal?(this._createGroupRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._createGroupRole.set("title",this.getRoleDesc(this._portalDefaultUser)),this._currentSelectedCreateRole=this._portalDefaultUser):(this._createGroupRole.set("value",this.i18n.userRoles.user),this._createGroupRole.set("title",this._getUserRoleTooltip()),this._currentSelectedCreateRole=
this.accountUserRole)},resetCreateSingleForm:function(a){this._settingCreateSingleUser=this._settingCreateSingleEmail=!0;this._addMode&&(this._settingCreateSinglePassword=!0);this._editingCreate?(c.attr(this._createSingleInviteBtn,"label",this.i18n.step2Create.saveAddAnother),c.attr(this._createSingleReviewBtn,"label",this.i18n.step2Create.saveReviewAdd)):(c.attr(this._createSingleInviteBtn,"label",this.i18n.step2Create.addAnother),c.attr(this._createSingleReviewBtn,"label",this.i18n.next));this._createSingleEmail.setValue("");
this._createSingleFirstName.setValue("");this._createSingleLastName.setValue("");this._createSingleUsername.setValue("");this._addMode&&this._createSinglePassword&&"saml"!==this._userType&&this._createSinglePassword.setValue("");esriGeowConfig.userLicenseLevelsEnabled&&(this._createSingleLevel2Radio.set("checked",!0),this.onCreateSingleLevel2RadioClick());this._isPortal?(this._createSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._createSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser)),
this._currentSelectedCreateRole=this._portalDefaultUser):(this._createSingleRole.set("value",this.i18n.userRoles.user),this._createSingleRole.set("title",this._getUserRoleTooltip()),this._currentSelectedCreateRole=this.accountUserRole);!this._isPortal&&this._isAdmin&&this._createSingleEsriAccessCheckBox.set("checked",!1);a&&this.resetCreateErrorMessage();this._createBatchFile.setValue("");this._createBatchUploadBtn.set("disabled",!1);this._createTabs.selectChild(this._createSingleTab);this._createSingleEmail.focus()},
resetInviteSingleForm:function(a){this._editingInvite?(c.attr(this._inviteSingleInviteBtn,"label",this.i18n.step2Invite.saveInviteAnother),c.attr(this._inviteSingleReviewBtn,"label",this.i18n.step2Invite.saveReviewInvitation)):(c.attr(this._inviteSingleInviteBtn,"label",this.i18n.step2Invite.inviteAnother),c.attr(this._inviteSingleReviewBtn,"label",this.i18n.step2Invite.reviewInvitation));this._inviteSingleEmail.setValue("");esriGeowConfig.userLicenseLevelsEnabled&&(this._inviteLevel2Radio.set("checked",
!0),this.onInviteLevel2RadioClick());this._isPortal?(this._inviteSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._inviteSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser)),this._currentSelectedInviteRole=this._portalDefaultUser):(this._inviteSingleRole.set("value",this.i18n.userRoles.user),this._inviteSingleRole.set("title",this._getUserRoleTooltip()),this._currentSelectedInviteRole=this.accountUserRole);!this._isPortal&&this._isAdmin&&this._inviteEsriAccessCheckBox.set("checked",
!1);a&&this.resetInviteErrorMessage();this._inviteBatchFile.setValue("");this._inviteBatchUploadBtn.set("disabled",!1);this._inviteTabs.selectChild(this._inviteSingleTab);this._inviteSingleEmail.focus()},resetIDPSingleForm:function(a){this._editingIDP?(c.attr(this._idpSingleInviteBtn,"label",this.i18n.step2IDP.saveInviteAnother),c.attr(this._idpSingleReviewBtn,"label",this.i18n.step2IDP.saveReviewInvitation)):(c.attr(this._idpSingleInviteBtn,"label",this.i18n.step2IDP.inviteAnother),c.attr(this._idpSingleReviewBtn,
"label",this.i18n.step2IDP.reviewInvitation));this._idpSingleEmail.setValue("");esriGeowConfig.userLicenseLevelsEnabled&&(this._idpLevel2Radio.set("checked",!0),this.onIDPLevel2RadioClick());this._isPortal?(this._idpSingleRole.set("value",this._lookupFullRoleName(this._portalDefaultUser)),this._idpSingleRole.set("title",this.getRoleDesc(this._portalDefaultUser)),this._currentSelectedIDPRole=this._portalDefaultUser):(this._idpSingleRole.set("value",this.i18n.userRoles.user),this._idpSingleRole.set("title",
this._getUserRoleTooltip()),this._currentSelectedIDPRole=this.accountUserRole);!this._isPortal&&this._isAdmin&&this._idpEsriAccessCheckBox.set("checked",!1);a&&this.resetIDPErrorMessage();this._idpBatchFile.setValue("");this._idpBatchUploadBtn.set("disabled",!1);this._idpTabs.selectChild(this._idpSingleTab);this._idpSingleEmail.focus()},onIDPAnotherClicked:function(){this.resetIDPErrorMessage();this.initializeUserStore();if(this._editingIDP){var a=this._idpSingleEmail.get("value"),e={email:c.trim(a),
role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)};esriGeowConfig.userLicenseLevelsEnabled&&(e.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);!this._isPortal&&this._isAdmin&&(e.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0);this.isValidIDPUser(e)&&(this._currentIDPMessage=this._idpSingleMessage.get("value"),this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,
function(a){b||this._userStore.getValue(this._editingIDPUser,"email")!==this._userStore.getValue(a,"email")||(b=!0,this._userStore.getValue(this._editingIDPUser,"email")!==e.email?(this._userStore.deleteItem(a),this._userStore.newItem(e)):(this._userStore.setValue(a,"role",e.role),this._userStore.setValue(a,"rolename",e.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",e.level),this._isPortal||this._userStore.setValue(a,"userType",e.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,
function(){this._editingIDP=!1;this._editingIDPUser=null;var a=esri.substitute({email:e.email},this._isPortal?this.i18n.step2IDP.success.userAddedPortal:this.i18n.step2IDP.success.userAdded);this.setIDPSuccessMessage(a);this.resetIDPSingleForm()}),onError:c.hitch(this,function(a){this.setIDPErrorMessage(a)})})})}))}else{var f=this._idpSingleEmail.get("value");f&&(f=f.split(","));var d=[],b;if(f&&0<f.length)for(a=0;a<f.length;a++)b={email:c.trim(f[a]),role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)},
esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);else b={email:"",role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&
this._isAdmin&&(b.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);if(this.validIDPUsers(d)){this._currentIDPMessage=this._idpSingleMessage.get("value");for(a=0;a<d.length;a++)this._userStore.newItem(d[a]);this._userStore.save({onComplete:c.hitch(this,function(){var a;1<f.length?(a=f.join(", "),a=esri.substitute({emailList:a},this._isPortal?this.i18n.step2IDP.success.usersAddedPortal:this.i18n.step2IDP.success.usersAdded)):1===f.length&&(a=esri.substitute({email:f[0]},
this._isPortal?this.i18n.step2IDP.success.userAddedPortal:this.i18n.step2IDP.success.userAdded));this.setIDPSuccessMessage(a);this.resetIDPSingleForm()}),onError:c.hitch(this,function(a){this.setIDPErrorMessage(a)})})}}},onIDPReviewClicked:function(){this.resetIDPErrorMessage();this.initializeUserStore();if(this._editingIDP){var a=c.trim(this._idpSingleEmail.get("value")),e={email:this._util.stripHTML(a),role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)};
esriGeowConfig.userLicenseLevelsEnabled&&(e.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);!this._isPortal&&this._isAdmin&&(e.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0);this.isValidIDPUser(e)&&(this._currentIDPMessage=this._idpSingleMessage.get("value"),this._userStore.fetch({onComplete:c.hitch(this,function(a){c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(this._editingIDPUser,"email")===this._userStore.getValue(a,
"email")&&(this._userStore.getValue(this._editingIDPUser,"email")!==e.email?(this._userStore.deleteItem(a),this._userStore.newItem(e)):(this._userStore.setValue(a,"role",e.role),this._userStore.setValue(a,"rolename",e.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",e.level),this._isPortal||this._userStore.setValue(a,"userType",e.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,function(){this._editingIDP=!1;this._editingIDPUser=null;this.resetIDPSingleForm(!0);
this.goToStep3();this.initializeIDPUserGrid()}),onError:c.hitch(this,function(a){this.setIDPErrorMessage(a)})})})}))}else{var f=this._idpSingleEmail.get("value");f&&(f=f.split(","));var d=[],b;if(f&&0<f.length)for(a=0;a<f.length;a++)b={email:this._util.stripHTML(c.trim(f[a])),role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),
!this._isPortal&&this._isAdmin&&(b.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);else b={email:"",role:this._currentSelectedIDPRole,rolename:this._lookupRoleName(this._currentSelectedIDPRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._idpLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=this._idpEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);if(this.validIDPUsers(d)){this._currentIDPMessage=
this._idpSingleMessage.get("value");for(a=0;a<d.length;a++)this._userStore.newItem(d[a]);this._userStore.save({onComplete:c.hitch(this,function(){var a;1<f.length?(a=f.join(", "),a=esri.substitute({emailList:a},this._isPortal?this.i18n.step2IDP.success.usersAddedPortal:this.i18n.step2IDP.success.usersAdded)):1===f.length&&(a=esri.substitute({email:f[0]},this._isPortal?this.i18n.step2IDP.success.userAddedPortal:this.i18n.step2IDP.success.userAdded));this.setIDPSuccessMessage(a);this.resetIDPSingleForm(!0);
this.goToStep3();this.initializeIDPUserGrid()}),onError:c.hitch(this,function(a){this.setIDPErrorMessage(a)})})}else this._userStore.fetch({onComplete:c.hitch(this,function(a){a&&0<a.length&&(this.resetIDPSingleForm(!0),this.goToStep3(),this.initializeIDPUserGrid())})})}},onInviteAnotherClicked:function(){this.resetInviteErrorMessage();this.initializeUserStore();if(this._editingInvite){var a=c.trim(this._inviteSingleEmail.get("value")),e={email:this._util.stripHTML(a),role:this._currentSelectedInviteRole,
rolename:this._lookupRoleName(this._currentSelectedInviteRole)};esriGeowConfig.userLicenseLevelsEnabled&&(e.level=this._inviteLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);!this._isPortal&&this._isAdmin&&(e.userType=this._inviteEsriAccessCheckBox.get("checked")?"both":void 0);this.isValidInviteUser(e)&&(this._currentInviteMessage=this._inviteSingleMessage.get("value"),this._userStore.fetch({onComplete:c.hitch(this,function(a){c.forEach(a,c.hitch(this,function(a){this._userStore.getValue(this._editingInviteUser,
"email")===this._userStore.getValue(a,"email")&&(this._userStore.getValue(this._editingInviteUser,"email")!==e.email?(this._userStore.deleteItem(a),this._userStore.newItem(e)):(this._userStore.setValue(a,"role",e.role),this._userStore.setValue(a,"rolename",e.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",e.level),this._isPortal||this._userStore.setValue(a,"userType",e.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,function(){this._editingInvite=
!1;this._editingInviteUser=null;var a=esri.substitute({email:e.email},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded);this.setInviteSuccessMessage(a);this.resetInviteSingleForm()}),onError:c.hitch(this,function(a){this.setInviteErrorMessage(a)})})})}))}else{var f=this._inviteSingleEmail.get("value");f&&(f=f.split(","));var d=[],b;if(f&&0<f.length)for(a=0;a<f.length;a++)b={email:this._util.stripHTML(c.trim(f[a])),role:this._currentSelectedInviteRole,
rolename:this._lookupRoleName(this._currentSelectedInviteRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._inviteLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=this._inviteEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);else b={email:"",role:this._currentSelectedInviteRole,rolename:this._lookupRoleName(this._currentSelectedInviteRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._inviteLevel1Radio.get("checked")?
this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=this._inviteEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);if(this.validInviteUsers(d)){this._currentInviteMessage=this._inviteSingleMessage.get("value");for(a=0;a<d.length;a++)this._userStore.newItem(d[a]);this._userStore.save({onComplete:c.hitch(this,function(){var a;1<f.length?(a=f.join(", "),a=esri.substitute({emailList:a},this._isPortal?this.i18n.step2Invite.success.usersAddedPortal:this.i18n.step2Invite.success.usersAdded)):
1===f.length&&(a=esri.substitute({email:f[0]},this._isPortal?this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded));this.setInviteSuccessMessage(a);this.resetInviteSingleForm()}),onError:c.hitch(this,function(a){this.setInviteErrorMessage(a)})})}}},onInviteReviewClicked:function(){this.resetInviteErrorMessage();this.initializeUserStore();if(this._editingInvite){var a=c.trim(this._inviteSingleEmail.get("value")),e={email:this._util.stripHTML(a),role:this._currentSelectedInviteRole,
rolename:this._lookupRoleName(this._currentSelectedInviteRole)};esriGeowConfig.userLicenseLevelsEnabled&&(e.level=this._inviteLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);!this._isPortal&&this._isAdmin&&(e.userType=this._inviteEsriAccessCheckBox.get("checked")?"both":void 0);this.isValidInviteUser(e)&&(this._currentInviteMessage=this._inviteSingleMessage.get("value"),this._userStore.fetch({onComplete:c.hitch(this,function(a){var b=!1;c.forEach(a,c.hitch(this,function(a){b||
this._userStore.getValue(this._editingInviteUser,"email")!==this._userStore.getValue(a,"email")||(b=!0,this._userStore.getValue(this._editingInviteUser,"email")!==e.email?(this._userStore.deleteItem(a),this._userStore.newItem(e)):(this._userStore.setValue(a,"role",e.role),this._userStore.setValue(a,"rolename",e.rolename),esriGeowConfig.userLicenseLevelsEnabled&&this._userStore.setValue(a,"level",e.level),this._isPortal||this._userStore.setValue(a,"userType",e.userType||"")))}));this._userStore.save({onComplete:c.hitch(this,
function(){this._editingInvite=!1;this._editingInviteUser=null;this.resetInviteSingleForm(!0);this.goToStep3();this.initializeInviteUserGrid()}),onError:c.hitch(this,function(a){this.setInviteErrorMessage(a)})})})}))}else{var f=this._inviteSingleEmail.get("value");f&&(f=f.split(","));var d=[],b;if(f&&0<f.length)for(a=0;a<f.length;a++)b={email:this._util.stripHTML(c.trim(f[a])),role:this._currentSelectedInviteRole,rolename:this._lookupRoleName(this._currentSelectedInviteRole)},esriGeowConfig.userLicenseLevelsEnabled&&
(b.level=this._inviteLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=this._inviteEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);else b={email:"",role:this._currentSelectedInviteRole,rolename:this._lookupRoleName(this._currentSelectedInviteRole)},esriGeowConfig.userLicenseLevelsEnabled&&(b.level=this._inviteLevel1Radio.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO),!this._isPortal&&this._isAdmin&&(b.userType=
this._inviteEsriAccessCheckBox.get("checked")?"both":void 0),d.push(b);if(this.validInviteUsers(d)){this._currentInviteMessage=this._inviteSingleMessage.get("value");for(a=0;a<d.length;a++)this._userStore.newItem(d[a]);this._userStore.save({onComplete:c.hitch(this,function(){var a;1<f.length?(a=f.join(", "),a=esri.substitute({emailList:a},this._isPortal?this.i18n.step2Invite.success.usersAddedPortal:this.i18n.step2Invite.success.usersAdded)):1===f.length&&(a=esri.substitute({email:f[0]},this._isPortal?
this.i18n.step2Invite.success.userAddedPortal:this.i18n.step2Invite.success.userAdded));this.setInviteSuccessMessage(a);this.resetInviteSingleForm(!0);this.goToStep3();this.initializeInviteUserGrid()}),onError:c.hitch(this,function(a){this.setInviteErrorMessage(a)})})}else this._userStore.fetch({onComplete:c.hitch(this,function(a){a&&0<a.length&&(this.resetInviteSingleForm(!0),this.goToStep3(),this.initializeInviteUserGrid())})})}},onCreateBatchSubmit:function(a){a.preventDefault();a.target.data?
this.handleCreateFileSelection(a.target.data.files):this.handleCreateFileSelection(a.target.file.files)},onInviteBatchSubmit:function(a){a.preventDefault();a.target.data?this.handleInviteFileSelection(a.target.data.files):this.handleInviteFileSelection(a.target.file.files)},onIDPBatchSubmit:function(a){a.preventDefault();a.target.data?this.handleIDPFileSelection(a.target.data.files):this.handleIDPFileSelection(a.target.file.files)},onNext:function(){this._addMode=this._addUsersBtn.get("checked");
if(this.hasIDP()&&this._idpUsersBtn.get("checked"))this.onIDPUsers();else if(!this._addMode&&!this._createUsersBtn.get("checked")||this._isPortal)if((this._addMode||this._createUsersBtn.get("checked"))&&this._isPortal)this.buildChooseType();else this.onInviteUsers();else this.onCreateUsers()},onIDPUsers:function(){this._mode=this.modeIDP;this.hide();c.style(this._step2IDP,"display","block");c.attr(this._step3Message,"innerHTML",this.i18n.step3.message);if(this._idpTabs){if(this.resetIDPSingleForm(!0),
esriGeowConfig.userLicenseLevelsEnabled){var a=this._idpLevel1Radio.get("checked"),e=this._idpLevel2Radio.get("checked");a||e||(this._idpLevel2Radio.set("checked",!0),this.onIDPLevel2RadioClick())}}else this.buildIDPTabs()},onCreateUsers:function(){this._mode=this.modeCreate;this.hide();c.style(this._step2Create,"display","block");if(this._createTabs){this.resetCreateSingleForm(!0);if(this._createUploadMsg){var a={firstNameHeader:this.i18n.csv.firstName,lastNameHeader:this.i18n.csv.lastName,emailHeader:this.i18n.csv.email,
roleHeader:this.i18n.csv.role,usernameHeader:this.i18n.csv.username,passwordHeader:this.i18n.csv.password};a.levelHeader=esriGeowConfig.userLicenseLevelsEnabled?this.i18n.csv.level:"";a.allowEsriAccessHeader=this._isPortal?"":this.i18n.csv.allowEsriAccess;a=esri.substitute(a,this._addMode?this.i18n.step2Create.uploadCSVAdd:this.i18n.step2Create.uploadCSV);esriGeowConfig.userLicenseLevelsEnabled||(a=a.substring(0,a.length-2));c.attr(this._createUploadMsg,"innerHTML",a)}if(esriGeowConfig.userLicenseLevelsEnabled){var e;
this._createSingleLevel1Radio&&this._createSingleLevel2Radio&&(a=this._createSingleLevel1Radio.get("checked"),e=this._createSingleLevel2Radio.get("checked"),a||e||(this._createSingleLevel2Radio.set("checked",!0),this.onCreateSingleLevel2RadioClick()));this._createEnterpriseLevel1Radio&&this._createEnterpriseLevel2Radio&&(a=this._createEnterpriseLevel1Radio.get("checked"),e=this._createEnterpriseLevel2Radio.get("checked"),a||e||(this._createEnterpriseLevel2Radio.set("checked",!0),this.onCreateEnterpriseLevel2RadioClick()));
this._createGroupLevel1Radio&&this._createGroupLevel2Radio&&(a=this._createGroupLevel1Radio.get("checked"),e=this._createGroupLevel2Radio.get("checked"),a||e||(this._createGroupLevel2Radio.set("checked",!0),this.onCreateGroupLevel2RadioClick()))}}else this._isPortal?this._checkEnterpriseGroupStore().then(c.hitch(this,function(){this.buildCreateTabs()})):this.buildCreateTabs();this._addMode?(c.attr(this._step3Message,"innerHTML",this._isPortal?this.i18n.step3.messageAddPortal:this.i18n.step3.messageAdd),
this._createBatchMsgRow&&c.style(this._createBatchMsgRow,"display","none"),this._createSingleMsgRow&&c.style(this._createSingleMsgRow,"display","none"),this._createSinglePasswordRow&&c.style(this._createSinglePasswordRow,"display",""),this._createSinglePasswordSpacer&&c.style(this._createSinglePasswordSpacer,"display",""),this._createSingleInviteBtn&&this._createSingleInviteBtn.set("label",this.i18n.step2Create.addAnother),this._createSingleReviewBtn&&this._createSingleReviewBtn.set("label",this.i18n.next),
this._samlSuffixRow&&c.style(this._samlSuffixRow,"display","saml"===this._userType?"":"none")):(c.attr(this._step3Message,"innerHTML",this.i18n.step3.message),this._createBatchMsgRow&&!this.isTrialOrg&&c.style(this._createBatchMsgRow,"display",""),!this._createSingleMsgRow||this._isPortal||this.isTrialOrg||c.style(this._createSingleMsgRow,"display",""),this._createSinglePasswordRow&&c.style(this._createSinglePasswordRow,"display","none"),this._createSinglePasswordSpacer&&c.style(this._createSinglePasswordSpacer,
"display","none"),this._createSingleInviteBtn&&this._createSingleInviteBtn.set("label",this.i18n.step2Create.addAnother),this._createSingleReviewBtn&&this._createSingleReviewBtn.set("label",this.i18n.next),this._samlSuffixRow&&c.style(this._samlSuffixRow,"display","none"))},onInviteUsers:function(){this._mode=this.modeInvite;this.hide();c.style(this._step2Invite,"display","block");c.attr(this._step3Message,"innerHTML",this.i18n.step3.message);if(this._inviteTabs){if(this.resetInviteSingleForm(!0),
esriGeowConfig.userLicenseLevelsEnabled){var a=this._inviteLevel1Radio.get("checked"),e=this._inviteLevel2Radio.get("checked");a||e||(this._inviteLevel2Radio.set("checked",!0),this.onInviteLevel2RadioClick())}}else this.buildInviteTabs()},onBackToStart:function(){this.hide();c.style(this._step1,"display","block");this._mode===this.modeCreate?this.setCreateErrorMessage(""):this._mode===this.modeInvite?this.resetInviteErrorMessage():this._mode===this.modeIDP&&this.resetIDPErrorMessage();this._resetTrackedModeInfo();
this.resetUserStore();this._validateEmail.set("checked",!0);this._creditsToAssign=null},_destroyWidget:function(a){a&&(a.destroyRecursive(),a.destroy())},_destroyCreateTabs:function(){this._createSingleEmail=this._destroyWidget(this._createSingleEmail);this._createSingleLastName=this._destroyWidget(this._createSingleLastName);this._createSingleFirstName=this._destroyWidget(this._createSingleFirstName);this._createSingleLastName=this._destroyWidget(this._createSingleLastName);this._createSingleUsername=
this._destroyWidget(this._createSingleUsername);this._createSinglePassword=this._destroyWidget(this._createSinglePassword);this._createSingleLevel1Radio=this._destroyWidget(this._createSingleLevel1Radio);this._createSingleLevel2Radio=this._destroyWidget(this._createSingleLevel2Radio);this._createSingleRole=this._destroyWidget(this._createSingleRole);this._createSingleEsriAccessCheckBox=this._destroyWidget(this._createSingleEsriAccessCheckBox);this._createSingleMessage=this._destroyWidget(this._createSingleMessage);
this._createSingleBackBtn=this._destroyWidget(this._createSingleBackBtn);this._createSingleInviteBtn=this._destroyWidget(this._createSingleInviteBtn);this._createSingleReviewBtn=this._destroyWidget(this._createSingleReviewBtn);this._createBatchFile=this._destroyWidget(this._createBatchFile);this._createBatchMessage=this._destroyWidget(this._createBatchMessage);this._createBatchUploadBtn=this._destroyWidget(this._createBatchUploadBtn);this._createEnterpriseUser=this._destroyWidget(this._createEnterpriseUser);
this._createEnterpriseUserSearchBtn=this._destroyWidget(this._createEnterpriseUserSearchBtn);this._createEnterpriseLevel1Radio=this._destroyWidget(this._createEnterpriseLevel1Radio);this._createEnterpriseLevel2Radio=this._destroyWidget(this._createEnterpriseLevel2Radio);this._createUserRole=this._destroyWidget(this._createUserRole);this._createUserBackBtn=this._destroyWidget(this._createUserBackBtn);this._createUserInviteBtn=this._destroyWidget(this._createUserInviteBtn);this._createUserReviewBtn=
this._destroyWidget(this._createUserReviewBtn);this._createEnterpriseGroup=this._destroyWidget(this._createEnterpriseGroup);this._createEnterpriseSearchBtn=this._destroyWidget(this._createEnterpriseSearchBtn);this._createGroupLevel1Radio=this._destroyWidget(this._createGroupLevel1Radio);this._createGroupLevel2Radio=this._destroyWidget(this._createGroupLevel2Radio);this._createGroupRole=this._destroyWidget(this._createGroupRole);this._createGroupReviewBtn=this._destroyWidget(this._createGroupReviewBtn);
c.destroy(c.byId("createSingleLevel1RadioBadge"));c.destroy(c.byId("createSingleLevel2RadioBadge"));c.destroy(c.byId("createEnterpriseLevel1Radio"));c.destroy(c.byId("createEnterpriseLevel2Radio"));c.destroy(c.byId("createGroupLevel1Radio"));c.destroy(c.byId("createGroupLevel2Radio"));c.destroy(c.byId("reviewSpinnerUser"));c.destroy(c.byId("reviewSpinner"));c.destroy(c.byId("createBatchForm"));this._createSingleTab=this._destroyWidget(this._createSingleTab);this._createBatchTab=this._destroyWidget(this._createBatchTab);
this._createEnterpriseTab=this._destroyWidget(this._createEnterpriseTab);this._createTabs=this._destroyWidget(this._createTabs)},_destroyFixErrorsTab:function(){this._fixBackBtn=this._destroyWidget(this._fixBackBtn);this._fixBtn=this._destroyWidget(this._fixBtn);this._fixEmail=this._destroyWidget(this._fixEmail);this._fixFirstName=this._destroyWidget(this._fixFirstName);this._fixLastName=this._destroyWidget(this._fixLastName);this._fixUsername=this._destroyWidget(this._fixUsername);this._fixPassword=
this._destroyWidget(this._fixPassword);this._fixLevel1Radio=this._destroyWidget(this._fixLevel1Radio);this._fixLevel2Radio=this._destroyWidget(this._fixLevel2Radio);this._fixRole=this._destroyWidget(this._fixRole);this._fixEsriAccessCheckBox=this._destroyWidget(this._fixEsriAccessCheckBox);this._fixNextBtn=this._destroyWidget(this._fixNextBtn);c.destroy(c.byId("fixLevel1RadioBadge"));c.destroy(c.byId("fixLevel2RadioBadge"));this._fixErrorsContentPane=this._destroyWidget(this._fixErrorsContentPane)},
onBackToStartPortal:function(){this.hide();c.style(this._step1Create,"display","block");this._mode===this.modeCreate?this.setCreateErrorMessage(""):this._mode===this.modeInvite?this.resetInviteErrorMessage():this._mode===this.modeIDP&&this.resetIDPErrorMessage();this._userType="";this._destroyCreateTabs();this._destroyFixErrorsTab();c.empty(this._step2Create);this._step2Create.innerHTML='\x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2Create"\x3e\x3cdiv class\x3d"stepMessageContainer"\x3e\x3cdiv class\x3d"stepMessage"\x3e\x3clabel data-dojo-attach-point\x3d"_step2CreateMsgLabel"\x3e\x3c/label\x3e\x3c/div\x3e\x3clabel data-dojo-attach-point\x3d"_step2CreateSubMsgLabel" class\x3d"stepSubMessage"\x3e${i18n.selectNonAdmin}\x3c/label\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_createErrorContainer"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"_createTabContainer"\x3e\x3c/div\x3e';
this._stepHeader2Create=c.query("[data-dojo-attach-point\x3d_stepHeader2Create]",this._step2Create).shift();this._step2CreateMsgLabel=c.query("[data-dojo-attach-point\x3d_step2CreateMsgLabel]",this._step2Create).shift();this._step2CreateSubMsgLabel=c.query("[data-dojo-attach-point\x3d_step2CreateSubMsgLabel]",this._step2Create).shift();this._createErrorContainer=c.query("[data-dojo-attach-point\x3d_createErrorContainer]",this._step2Create).shift();this._createTabContainer=c.query("[data-dojo-attach-point\x3d_createTabContainer]",
this._step2Create).shift();c.empty(this._fixErrors);this._fixErrors.innerHTML='\x3cdiv class\x3d"stepHeader" data-dojo-attach-point\x3d"_stepHeader2FixErrors"\x3e\x3cdiv class\x3d"stepMessageContainer"\x3e\x3cdiv class\x3d"stepMessage"\x3e\x3cstrong\x3e\x3clabel data-dojo-attach-point\x3d"_fixErrorsMsgLabel"\x3e\x3c/label\x3e\x3c/strong\x3e\x3c/div\x3e\x3clabel data-dojo-attach-point\x3d"_fixErrorsMsgSubLabel"\x3e${i18n.selectNonAdmin}\x3c/label\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv style\x3d"display:none;" data-dojo-attach-point\x3d"_fixErrorsErrorContainer"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"_fixErrorsContainer"\x3e\x3c/div\x3e';
this._stepHeader2FixErrors=c.query("[data-dojo-attach-point\x3d_stepHeader2FixErrors]",this._fixErrors).shift();this._fixErrorsMsgLabel=c.query("[data-dojo-attach-point\x3d_fixErrorsMsgLabel]",this._fixErrors).shift();this._fixErrorsMsgSubLabel=c.query("[data-dojo-attach-point\x3d_fixErrorsMsgSubLabel]",this._fixErrors).shift();this._fixErrorsErrorContainer=c.query("[data-dojo-attach-point\x3d_fixErrorsErrorContainer]",this._fixErrors).shift();this._fixErrorsContainer=c.query("[data-dojo-attach-point\x3d_fixErrorsContainer]",
this._fixErrors).shift();this._util.createStepProgressIndicatorAndPlace(2,4,this._stepHeader2Create,"first");this._util.createStepProgressIndicatorAndPlace(2,4,this._stepHeader2FixErrors,"first");this._resetTrackedModeInfo();this.resetUserStore()},_resetTrackedModeInfo:function(){this._mode=null;this._addMode=!1;this._currentIDPMessage=this._currentSelectedIDPRole=null;this._editingIDP=!1;this._currentCreateMessage=this._currentSelectedCreateRole=this._editingIDPUser=null;this._editingCreate=!1;this._editingCreateUser=
null;this._settingCreateSingleUser=this._settingCreateSingleEmail=!1;this._fixingNumber=this._numToFix=0;this._currentInviteMessage=this._currentSelectedInviteRole=this._settingFixUsername=this._settingFixEmail=this._currentlyFixing=null;this._editingInvite=!1;this._editingInviteUser=null},onBackInvitations:function(){c.style(this._groupSelection.domNode,"display","none");this.hide();this._mode===this.modeInvite?(this.resetInviteSingleForm(!0),c.style(this._step2Invite,"display","block")):this._mode===
this.modeIDP?(this.resetIDPSingleForm(!0),c.style(this._step2IDP,"display","block")):this._mode===this.modeCreate&&(this.resetCreateSingleForm(!0),c.style(this._step2Create,"display","block"))},_memberLevelsAreValid:function(){var a=new c.Deferred,e={},f;e[this.LICENSE_LEVELS.ONE]=0;e[this.LICENSE_LEVELS.TWO]=0;this._userStore.fetch({onComplete:c.hitch(this,function(d){c.forEach(d,c.hitch(this,function(a){f=this._userStore.getValue(a,"level");f===this.LICENSE_LEVELS.ONE?e[this.LICENSE_LEVELS.ONE]+=
1:f===this.LICENSE_LEVELS.TWO&&(e[this.LICENSE_LEVELS.TWO]+=1)}));d=e[this.LICENSE_LEVELS.TWO];var b=this._currentUsersPerLevel[this.LICENSE_LEVELS.TWO],g=this._maxUsersPerLevel[this.LICENSE_LEVELS.TWO],k,m,p;if(e[this.LICENSE_LEVELS.ONE]+this._currentUsersPerLevel[this.LICENSE_LEVELS.ONE]>this._maxUsersPerLevel[this.LICENSE_LEVELS.ONE]||d+b>g)if(this._isPortal){var q=esriGeowConfig.self.helpBase.replace("/website/","/admin/");arcgisonline.sharing.util.retrievePortalAdminGuideHelpMap().then(c.hitch(this,
function(b){k=b.m["120000836"];m=q+k;p="\x3cp\x3e"+esri.substitute({linkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"'+m+'" target\x3d"_blank"\x3e',linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.levelExceedsLimit)+"\x3c/p\x3e\x3cp\x3e"+this.i18n.levelsAvailable+"\x3c/p\x3e"+this._createLevelsAvailableTable(e,this._currentUsersPerLevel,this._maxUsersPerLevel);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:p});a.resolve(!1)}),
c.hitch(this,function(){p="\x3cp\x3e"+esri.substitute({linkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca href\x3d"'+q+'" target\x3d"_blank"\x3e',linkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.levelExceedsLimit)+"\x3c/p\x3e\x3cp\x3e"+this.i18n.levelsAvailable+"\x3c/p\x3e"+this._createLevelsAvailableTable(e,this._currentUsersPerLevel,this._maxUsersPerLevel);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:p});a.resolve(!1)}))}else k=
esriGeowConfig.self.helpMap.m[""],m=esriGeowConfig.self.helpBase+(k?k:""),p="\x3cp\x3e"+this.i18n.levelExceedsLimitOnline+"\x3c/p\x3e\x3cp\x3e"+this.i18n.levelsAvailable+"\x3c/p\x3e"+this._createLevelsAvailableTable(e,this._currentUsersPerLevel,this._maxUsersPerLevel),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:p}),a.resolve(!1);else a.resolve(!0)})});return a},_createLevelsAvailableTable:function(a,c,f){var d=a[this.LICENSE_LEVELS.ONE];
a=a[this.LICENSE_LEVELS.TWO];var b=f[this.LICENSE_LEVELS.ONE]-c[this.LICENSE_LEVELS.ONE];c=f[this.LICENSE_LEVELS.TWO]-c[this.LICENSE_LEVELS.TWO];f=arcgisonline.sharing.util.getLevelSpan(this.i18n.levelLabel,this.LICENSE_LEVELS.ONE);var e=arcgisonline.sharing.util.getLevelSpan(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO);return"\x3cbr\x3e\x3cdiv\x3e"+this._createLevelsAvailable(f,d,b)+"\x3c/div\x3e\x3cbr\x3e\x3cdiv\x3e"+this._createLevelsAvailable(e,a,c)+"\x3c/div\x3e"},_createLevelsAvailable:function(a,
c,f){return a+"\x26nbsp;"+esri.substitute({numInviting:c,numAvailable:f},this.i18n.levelInvitingAvailable)},onSendInvitations:function(){esriGeowConfig.userLicenseLevelsEnabled?this._memberLevelsAreValid().then(c.hitch(this,function(a){a&&this.doSendInvitations()})):this.doSendInvitations()},doSendInvitations:function(){var a=[],e,f,d,b,g;if(this._groupSelector&&(this._mode===this.modeCreate||!this._isPortal&&(this._mode===this.modeInvite||this._mode===this.modeIDP))&&(this._selectedGroups=this._groupSelector.get("value"),
b=[],c.forEach(this._selectedGroups,function(a){b.push(a.id)}),this._selectedGroups.length>this.maxGroups)){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.notice,message:esri.substitute({groups:this._selectedGroups.length,maxGroups:this.maxGroups},this.i18n.step4.tooManyGroups)});return}this._canManageCredits&&this._creditsToAssign&&this._creditsToAssign!==esriGeowConfig.self.defaultUserCreditAssignment&&(g=this._creditsToAssign);this._sendInvitations.set("disabled",
!0);this._sendGroupInvitations.set("disabled",!0);this._sendInvitations.set("label",this._addMode?this.i18n.step3.addingMembers:this.i18n.step3.sendingInvitations);this._sendGroupInvitations.set("label",this._addMode?this.i18n.step3.addingMembers:this.i18n.step3.sendingInvitations);this._mode===this.modeInvite?(d=this.buildEmailMessage(this._currentInviteMessage),e=this.allProviders,f=this._validateEmail.get("checked")):this._mode===this.modeIDP?(d=this.buildEmailMessage(this._currentIDPMessage),
e=this.enterpriseProvider):this._mode===this.modeCreate&&(d=this.buildEmailMessage(this._currentCreateMessage));this._userStore.fetch({onComplete:c.hitch(this,function(k,m){m=k.length;var p;c.forEach(k,c.hitch(this,function(d){if(d)if(this._mode===this.modeInvite||this._mode===this.modeIDP)p={email:this._userStore.getValue(d,"email"),role:this._userStore.getValue(d,"role"),targetUserProvider:e},esriGeowConfig.userLicenseLevelsEnabled&&(p.level=this._userStore.getValue(d,"level")),this._isPortal||
this._mode!==this.modeInvite||(p.validateEmail=f),!this._isPortal&&b&&0<b.length&&(p.groups=b.join(",")),!this._isPortal&&esri.isDefined(g)&&(p.userCreditAssignment=g),this._isPortal||(p.userType="both"===this._userStore.getValue(d,"userType")?"both":"arcgisonly"),a.push(p);else if(this._mode===this.modeCreate&&!this._addMode)p={username:this._userStore.getValue(d,"username"),firstname:this._userStore.getValue(d,"firstname"),lastname:this._userStore.getValue(d,"lastname"),fullname:this._userStore.getValue(d,
"fullname"),email:this._userStore.getValue(d,"email"),role:this._userStore.getValue(d,"role")},esriGeowConfig.userLicenseLevelsEnabled&&(p.level=this._userStore.getValue(d,"level")),this._isPortal||(p.userType="both"===this._userStore.getValue(d,"userType")?"both":"arcgisonly"),a.push(p);else if(this._mode===this.modeCreate&&this._addMode){var c=this._userStore.getValue(d,"username"),k=this._userStore.getValue(d,"role"),m=this._userStore.getValue(d,"provider");p={username:c,password:this._userStore.getValue(d,
"password"),firstname:this._userStore.getValue(d,"firstname"),lastname:this._userStore.getValue(d,"lastname"),fullname:this._userStore.getValue(d,"fullname"),email:this._userStore.getValue(d,"email"),role:k};esriGeowConfig.userLicenseLevelsEnabled&&(p.level=this._userStore.getValue(d,"level"));this._isPortal&&(p.provider=m||this.arcgisProvider);this._isPortal&&"saml"===this._userType&&this._samlSuffix&&(p.idpUsername=this._userStore.getValue(d,"idpUsername"));this._isPortal||(p.userType="both"===
this._userStore.getValue(d,"userType")?"both":"arcgisonly");a.push(p)}}));if(this._mode===this.modeCreate&&this._addMode&&this._isPortal)this._createBatchPortalUsers(a);else if(k=(this._mode===this.modeCreate&&this._addMode?this._util.getSecureUrl(esriGeowConfig.restBaseUrl):esriGeowConfig.restBaseUrl)+"portals/self/invite",a.length<=this.userInviteLimitBeforeSplit){var q={invitationList:c.json.stringify({invitations:a})};this.isTrialOrg||(q.message=d);this._util.request({url:k,content:q},{usePost:!0}).then(c.hitch(this,
this.onUsersInvited,a,m),c.hitch(this,this.onUsersInvited,a,m))}else{for(var q=[],n=0;n<Math.ceil(a.length/this.maxUsersPerInvite);n++){var r=0===n?0:n*this.maxUsersPerInvite,h=0===n?this.maxUsersPerInvite:this.maxUsersPerInvite+n*this.maxUsersPerInvite;0>r&&(r=0);h>a.length&&(h=a.length);r={invitationList:c.json.stringify({invitations:a.slice(r,h)})};this.isTrialOrg||(r.message=d);r=this._util.request({url:k,content:r},{usePost:!0});q.push(r)}0<q.length&&(new c.DeferredList(q)).then(c.hitch(this,
this.onBatchUsersInvited,a,m),c.hitch(this,this.onBatchUsersInvited,a,m))}})})},_createBatchPortalUsers:function(a){var e=this._util.getPortalAdminBaseUrl()+"/security/users/createUser",f=[],d;for(d=0;d<a.length;d++)delete a[d].fullname,f.push(this._util.request({url:e,content:a[d]},{usePost:!0}));(new c.DeferredList(f)).then(c.hitch(this,function(b){var d=a.length,e=0,f=[],p=[],q,n;for(q=0;q<b.length;q++)!(n=b[q][1])||n.status&&"success"===n.status||(e++,-1<n.message.indexOf("user already exists")?
p.push(a[q].username):f.push(a[q].username));d-=e;esri.isDefined(this._selectedGroups)&&0<this._selectedGroups.length?this._addUsersToGroups(a,f.concat(p),this._selectedGroups).then(c.hitch(this,function(a){this.completeBatchPortalUsers(d,f,p)}),c.hitch(this,function(a){this.completeBatchPortalUsers(d,f,p)})):this.completeBatchPortalUsers(d,f,p)}))},_addUsersToGroups:function(a,e,f){a=this._getInvitedUserList(a,e);e=[];var d=esriGeowConfig.restBaseUrl+"community/groups/${groupId}/addUsers",b,g;for(g=
0;g<f.length;g++)b=f[g],b=esri.substitute({groupId:b.id},d),e.push(this._pageUtil.sendAllResources(b,100,a,function(a){return{users:a.join(",")}}));return new c.DeferredList(e)},_getInvitedUserList:function(a,e){var f=[],d;for(i=0;i<a.length;i++)d=a[i],-1===c.indexOf(e,d.username)&&f.push(d.username);return f},completeBatchPortalUsers:function(a,e,f){this.hide();c.style(this._completed,"display","block");1===a?c.attr(this._completedMessage,"innerHTML",this.i18n.completed.successSingleAdd):1<a&&c.attr(this._completedMessage,
"innerHTML",esri.substitute({n:a},this.i18n.completed.successBatchAdd));e&&0<e.length&&(a=e.join(", "),c.attr(this._uninvitedMessage,"innerHTML",esri.substitute({userList:a},this.i18n.completed.unaddedUsers)),c.style(this._uninvitedMessageSpan,"display","block"));f&&0<f.length&&(f=f.join(", "),c.attr(this._existedUserMessage,"innerHTML",esri.substitute({userList:f},this.i18n.completed.existedUsers)),c.style(this._existedUserMessageSpan,"display","block"))},onBatchUsersInvited:function(a,e,f){if(f){var d=
e;e=0;for(var b=[],g=0;g<f.length;g++){var k=f[g][1];k.notInvited&&(e=k.notInvited.length,b=b.concat(k.notInvited));d-=e}esri.isDefined(this._selectedGroups)&&0<this._selectedGroups.length?this._addUsersToGroups(a,b,this._selectedGroups).then(c.hitch(this,function(e){this._allocateCredits(a).then(c.hitch(this,function(){this.completeBatchUserInvite(d,b)}),c.hitch(this,function(a){this.completeBatchUserInvite(d,b)}))}),c.hitch(this,function(e){this._allocateCredits(a).then(c.hitch(this,function(){this.completeBatchUserInvite(d,
b)}),c.hitch(this,function(a){this.completeBatchUserInvite(d,b)}))})):this._allocateCredits(a).then(c.hitch(this,function(){this.completeBatchUserInvite(d,b)}),c.hitch(this,function(a){this.completeBatchUserInvite(d,b)}))}else this.inviteError(f)},completeBatchUserInvite:function(a,e){this.hide();c.style(this._completed,"display","block");1===a?c.attr(this._completedMessage,"innerHTML",this._addMode?this.i18n.completed.successSingleAdd:this.i18n.completed.successSingle):1<a&&c.attr(this._completedMessage,
"innerHTML",esri.substitute({n:a},this._addMode?this.i18n.completed.successBatchAdd:this.i18n.completed.successBatch));if(e&&0<e.length){a=e.join(", ");var f;this._mode===this.modeInvite||this._mode===this.modeIDP?f=esri.substitute({emailList:a},this.i18n.completed.uninvitedEmails):this._mode===this.modeCreate&&(f=esri.substitute({userList:a},this._addMode?this.i18n.completed.unaddedUsers:this.i18n.completed.uninvitedUsers));c.attr(this._uninvitedMessage,"innerHTML",f);c.style(this._uninvitedMessageSpan,
"display","block")}},onUsersInvited:function(a,e,f){if(f&&!0===f.success){var d=e;e=0;var b=f.notInvited||[];f.notInvited&&(e=f.notInvited.length);d-=e;esri.isDefined(this._selectedGroups)&&0<this._selectedGroups.length?this._addUsersToGroups(a,b,this._selectedGroups).then(c.hitch(this,function(b){this._allocateCredits(a).then(c.hitch(this,function(){this.completeUserInvite(d,f)}),c.hitch(this,function(a){this.completeUserInvite(d,f)}))}),c.hitch(this,function(b){this._allocateCredits(a).then(c.hitch(this,
function(){this.completeUserInvite(d,f)}),c.hitch(this,function(a){this.completeUserInvite(d,f)}))})):this._allocateCredits(a).then(c.hitch(this,function(){this.completeUserInvite(d,f)}),c.hitch(this,function(a){this.completeUserInvite(d,f)}))}else this.inviteError(f)},_allocateCredits:function(a){var e=this,f=new c.Deferred,d=esriGeowConfig.restBaseUrl+"portals/self/assignUserCredits",b=esriGeowConfig.restBaseUrl+"portals/self/unassignUserCredits",g="assign",k=[],m=[],p=[],q,n;if(e._canManageCredits&&
esri.isDefined(e._creditsToAssign)&&e._creditsToAssign!==esriGeowConfig.self.defaultUserCreditAssignment)if(d=-1<e._creditsToAssign?d:b,g=-1<e._creditsToAssign?"assign":"unassign",c.forEach(a,function(a){k.push({username:a.username,credits:e._creditsToAssign});m.push(a.username)}),500<k.length){b=Math.ceil(k.length/500);for(n=0;n<b;n++)q=k.splice(0,500),a={},"assign"===g?(q=k.splice(0,500),a.userAssignments=c.json.stringify(q)):"unassign"===g&&(q=m.splice(0,500),a.usernames=c.json.stringify(q)),p.push(e._util.request({url:d,
content:a},{usePost:!0}));c.promise.all(p).then(function(){f.resolve()},function(a){f.resolve()})}else a={},"assign"===g?a.userAssignments=c.json.stringify(k):"unassign"===g&&(a.usernames=c.json.stringify(m)),e._util.request({url:d,content:a},{usePost:!0}).then(function(){f.resolve()},function(a){f.resolve()});else f.resolve();return f},completeUserInvite:function(a,e){this.hide();c.style(this._topCancelBtn.domNode,"display","none");c.style(this._completed,"display","block");1===a?c.attr(this._completedMessage,
"innerHTML",this._addMode?this.i18n.completed.successSingleAdd:this.i18n.completed.successSingle):1<a&&c.attr(this._completedMessage,"innerHTML",esri.substitute({n:a},this._addMode?this.i18n.completed.successBatchAdd:this.i18n.completed.successBatch));if(e.notInvited&&0<e.notInvited.length){a=e.notInvited.join(", ");var f;this._mode===this.modeInvite||this._mode===this.modeIDP?f=esri.substitute({emailList:a},this.i18n.completed.uninvitedEmails):this._mode===this.modeCreate&&(f=esri.substitute({userList:a},
this._addMode?this.i18n.completed.unaddedUsers:this.i18n.completed.uninvitedUsers));c.attr(this._uninvitedMessage,"innerHTML",f);c.style(this._uninvitedMessageSpan,"display","block")}},inviteError:function(a){this.hide();c.style(this._completedMessageSpan,"display","none");c.style(this._completed,"display","block");c.attr(this._uninvitedMessage,"innerHTML",this._addMode?this.i18n.completed.errorAdding:this.i18n.completed.errorSendingInvitations);c.style(this._uninvitedMessageSpan,"display","block")},
onInviteMoreClicked:function(){window.location.reload()},onReturnToOrgClicked:function(){window.location=esriGeowConfig.baseUrl+"organization.html"},onCancel:function(){this._userStore?this._userStore.fetch({onComplete:c.hitch(this,function(a){0<a.length?(a={title:this.i18n.noticeLabel,message:this._addMode?this.i18n.notFinishedAdding:this.i18n.notFinishedInviting,choiceOneTitle:this.i18n.stopInviting,choiceTwoTitle:this.i18n.finishInviting},a.choiceOneHandler=c.hitch(this,function(a){window.location=
(this._settings.allSSL?this._util.getSecureUrl(esriGeowConfig.baseUrl):this._util.getHttpUrl(esriGeowConfig.baseUrl))+"organization.html"}),a.choiceTwoHandler=function(a){},dlg=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(),dlg.show(a)):window.location=(this._settings.allSSL?this._util.getSecureUrl(esriGeowConfig.baseUrl):this._util.getHttpUrl(esriGeowConfig.baseUrl))+"organization.html"})}):window.location=(this._settings.allSSL?this._util.getSecureUrl(esriGeowConfig.baseUrl):
this._util.getHttpUrl(esriGeowConfig.baseUrl))+"organization.html"},_splitFullName:function(a){var c={first:void 0,last:void 0};a&&(a=a.split(" "),1===a.length?(c.first=a[0],c.last=""):1<a.length&&(c.last=a.splice(a.length-1,1)[0],c.first=a.join(" ")));return c},_getAdminRoleTooltip:function(){return this._isPortal?this.i18n.adminRoleTooltipPortal:this.i18n.adminRoleTooltip},_getPublisherRoleTooltip:function(){return this.i18n.publisherRoleTooltip},_getUserRoleTooltip:function(){return this.i18n.userRoleTooltip},
_getViewerRoleTooltip:function(){return this._isPortal?this.i18n.viewerRoleTooltipPortal:this.i18n.viewerRoleTooltip}})})},"arcgisonline/sharing/geow/Roles":function(){define("require exports tslib ../../esriGeowConfig ../util dojo/Deferred dojo/promise/all".split(" "),function(c,l,h,a,e,f,d){a=h.__importDefault(a);e=h.__importDefault(e);f=h.__importDefault(f);d=h.__importDefault(d);return function(){function b(){this.declaredClass="arcgisonline.sharing.geow.Roles"}b.exceedsRolePrivileges=function(a,
b){b=b||[];var d,c;for(c=0;c<b.length;c++)if(d=b[c],-1===a.indexOf(d))return!0;return!1};b.prototype.createRole=function(b,d){return e.default.request({url:a.default.restBaseUrl+"portals/self/createRole",content:{name:b,description:d}},{usePost:!0})};b.prototype.updateRole=function(b,d,c){return e.default.request({url:a.default.restBaseUrl+"portals/self/roles/"+b+"/update",content:{name:d,description:c}},{usePost:!0})};b.prototype.deleteRole=function(b){return e.default.request({url:a.default.restBaseUrl+
"portals/self/roles/"+b+"/delete"},{usePost:!0})};b.prototype.setPrivileges=function(b,d){return e.default.request({url:a.default.restBaseUrl+"portals/self/roles/"+b+"/setPrivileges",content:{id:b,privileges:d}},{usePost:!0})};b.prototype.getPrivileges=function(b){return e.default.request({url:a.default.restBaseUrl+"portals/self/roles/"+b+"/privileges"})};b.prototype.getAllUsersForRole=function(a){var b=this,c=new f.default,e=[],g=[],n=1,r,h,l;b.getUsersForRole(1,100,a).then(function(f){if(f&&f.users){g=
g.concat(f.users);n=f.nextStart;r=f.total-g.length;h=Math.ceil(r/100);for(l=0;l<h;l++)e.push(b.getUsersForRole(n+100*l,100,a));d.default(e).then(function(a){a.forEach(function(a){g=g.concat(a.users)});c.resolve(g)},function(){c.resolve(g)})}},function(){c.resolve(g)});return c};b.prototype.getUsersForRole=function(b,d,c){return e.default.request({url:a.default.restBaseUrl+"portals/self/users",content:{start:b,num:d,role:c}})};b.prototype.getAllRoles=function(a){var b=this,c=new f.default,e=[],g=1,
n=[],r,h,l;b.getRoles(g,100,a).then(function(f){if(f&&f.roles){n=n.concat(f.roles);g=f.nextStart;r=f.total-n.length;h=Math.ceil(r/100);for(l=0;l<h;l++)e.push(b.getRoles(g+100*l,100,a));d.default(e).then(function(a){a.forEach(function(a){n=n.concat(a.roles)});c.resolve(n)},function(){c.resolve(n)})}},function(){c.resolve(n)});return c};b.prototype.getRoles=function(b,d,c){var f=a.default.restBaseUrl+"portals/self/roles";b={start:b,num:d,returnPrivileges:null};c&&(b.returnPrivileges=c);return e.default.request({url:f,
content:b})};b.prototype.getRole=function(b){return e.default.request({url:a.default.restBaseUrl+"portals/self/roles/"+b})};b.prototype.containsPrivilegesOutsideRole=function(a,c,e){var g=new f.default;a={roleResult:this.getPrivileges(a),compareResult:this.getPrivileges(c)};var k=!1,m,r;d.default(a).then(function(a){m=a.roleResult&&a.roleResult.privileges||[];r=a.compareResult&&a.compareResult.privileges||[];e&&e instanceof Array?m=m.concat(e):e&&e instanceof String&&m.push(e);k=b.exceedsRolePrivileges(m,
r);g.resolve(k)},function(){g.resolve(k)});return g};return b}()})},"arcgisonline/sharing/dijit/GroupSelector":function(){define("require exports tslib ../../esriGeowConfig ../util ../geow/Account ../../tsutils/declareDecorator esri/lang dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/a11yclick dojo/Deferred dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/i18n!../../nls/arcgisonline dojo/keys dojo/on dojo/sniff dojo/text!./templates/GroupSelector.html dojo/_base/lang dojo/promise/all".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B){a=h.__importDefault(a);e=h.__importDefault(e);f=h.__importDefault(f);d=h.__importDefault(d);b=h.__importDefault(b);g=h.__importDefault(g);k=h.__importDefault(k);m=h.__importDefault(m);p=h.__importDefault(p);q=h.__importDefault(q);n=h.__importDefault(n);r=h.__importDefault(r);v=h.__importDefault(v);u=h.__importDefault(u);w=h.__importDefault(w);t=h.__importDefault(t);y=h.__importDefault(y);C=h.__importDefault(C);x=h.__importDefault(x);B=h.__importDefault(B);
return function(){function c(a){this.declaredClass="arcgisonline.sharing.dijit.GroupSelector";this.baseClass="esriGroupSelector";this.templateString=C.default;this.widgetsInTemplate=!0;this._setConstructorProperties(a)}c.prototype.postMixInProperties=function(){this.inherited(arguments);this._mixinI18N()};c.prototype.postCreate=function(){this.inherited(arguments);this._createConnections();this._setIntializationProperties()};c.prototype.startup=function(){this.inherited(arguments);this._initialize()};
c.prototype._mixinI18N=function(){var a={};x.default.mixin(a,u.default.common);x.default.mixin(a,u.default.groupSelector);this.i18n=a};c.prototype._setConstructorProperties=function(a){a.groups&&(this.groups=a.groups);a.selectedGroups&&(this.selectedGroups=a.selectedGroups);b.default.isDefined(a.autoLoad)?this.autoLoad=a.autoLoad:this.autoLoad=!0;b.default.isDefined(a.restrictSearch)?this.restrictSearch=a.restrictSearch:this.restrictSearch=!0;b.default.isDefined(a.enableRestrict)?this.enableRestrict=
a.enableRestrict:this.enableRestrict=!1;b.default.isDefined(a.enableSearch)?this.enableSearch=a.enableSearch:this.enableSearch=!0;b.default.isDefined(a.enableListActions)&&(this.enableListActions=a.enableListActions);b.default.isDefined(a.excludeEnterpriseGroups)?this.excludeEnterpriseGroups=a.excludeEnterpriseGroups:this.excludeEnterpriseGroups=!1;b.default.isDefined(a.excludeSharedUpdateGroups)?this.excludeSharedUpdateGroups=a.excludeSharedUpdateGroups:this.excludeSharedUpdateGroups=!1;b.default.isDefined(a.capResults)&&
0<a.capResults&&(this.capResults=a.capResults)};c.prototype._createConnections=function(){this.own(p.default(this._searchBtn,x.default.hitch(this,this._searchClick)),p.default(this._clearSearchBtn,x.default.hitch(this,this._clearSearch)),t.default(this._searchBox,"blur",x.default.hitch(this,function(a){a&&a.preventDefault()})),t.default(this._restrictSearch,"change",x.default.hitch(this,this._restrictSearchChange)),t.default(this._groupsPane,"click",x.default.hitch(this,this._selectGroup)),t.default(this._selectedGroupsPane,
"click",x.default.hitch(this,this._removeGroup)),p.default(this._addAll,x.default.hitch(this,this._addAllClick)),p.default(this._clearAll,x.default.hitch(this,this._clearAllClick)));10>=y.default("ie")||7>y.default("trident")?this.own(t.default(this._searchBox,"keydown",x.default.hitch(this,this._searchKeyup))):this.own(t.default(this._searchBox,"keyup",x.default.hitch(this,this._searchKeyup)))};c.prototype._setIntializationProperties=function(){this.user=e.default.getUser();this._searchBox.set("value",
"")};c.prototype._initializeUI=function(){this._toggleClearSearchButton();this._toggleRestrictSearch();this._toggleEnableSearch();this._toggleEnableRestrict();this._toggleEnableListActions()};c.prototype._setSelfDependentProperties=function(a){n.default.set(this._restrictSearchLabel,"innerHTML",b.default.substitute({name:a.name},this.i18n.onlySearch))};c.prototype._initialize=function(){var a=this;this._initializeUI();f.default.getSelf(function(b){a._setSelfDependentProperties(b);b=a.groups;!a.autoLoad||
b&&0!==b.length?a._refreshGroups():a._doSearch(null).then(function(){a._refreshGroups()});a._refreshSelectedGroups()})};c.prototype._searchKeyup=function(a){a.keyCode===w.default.ENTER&&this._searchClick(a);this._toggleClearSearchButton()};c.prototype._toggleClearSearchButton=function(){var a=x.default.trim(this._searchBox.get("value"));a&&0<a.length?v.default.set(this._clearSearchBtn,"display",""):v.default.set(this._clearSearchBtn,"display","none")};c.prototype._toggleEnableSearch=function(){this.enableSearch?
v.default.set(this._searchControls,"display",""):v.default.set(this._searchControls,"display","none")};c.prototype._toggleEnableRestrict=function(){this.enableRestrict?v.default.set(this._restrictSearchControl,"display",""):v.default.set(this._restrictSearchControl,"display","none")};c.prototype._toggleRestrictSearch=function(){this._restrictSearch.set("checked",this.restrictSearch)};c.prototype._toggleEnableListActions=function(){this.enableListActions?(v.default.set(this._addAllContainer,"display",
""),v.default.set(this._clearAllContainer,"display","")):(v.default.set(this._addAllContainer,"display","none"),v.default.set(this._clearAllContainer,"display","none"))};c.prototype._searchClick=function(a){a&&a.preventDefault();var d=this;a=x.default.trim(d._searchBox.get("value"));b.default.isDefined(a)&&0<a.length?d._doSearch(a).then(function(){d._refreshGroups()}):(d.groupResults=null,d._refreshGroups())};c.prototype._searchGroups=function(b){return e.default.request({url:a.default.restBaseUrl+
"community/groups",content:b})};c.prototype._configureSearchParams=function(a,d,c){var f=this.user,g=this.restrictSearch,k=this.excludeSharedUpdateGroups,f=f&&f.accountId&&g?"orgid:"+f.accountId:"",g=b.default.isDefined(c)&&0<c.length,m=e.default.isPortal()?" -owner:esri_nav -owner:esri_boundaries -owner:esri_demographics -owner:esri_livingatlas":"";k&&(m+=" -capabilities:updateitemcontrol");return{start:a,num:d,sortField:"title",sortOrder:"asc",q:g?"("+c+m+" "+f+")":f+m}};c.prototype._doSearch=function(a){var d=
this,c=new q.default,f=[],g=b.default.isDefined(a)&&0<a.length,k=d._configureSearchParams(1,100,a),m=d.excludeEnterpriseGroups,n=d.capResults,p=0,r=-1,h=0,t=0,l=[],v,u,w;b.default.isDefined(k.q)&&0===k.q.length?d._processGroups(g,[]).then(function(){c.resolve()}):d._searchGroups(k).then(function(a){if(a.code&&a.message)c.reject(a);else{if(e.default.isPortal()&&m)for(w=0;w<a.results.length;w++)u=a.results[w],b.default.isDefined(u.provider)||b.default.isDefined(u.providerGroupName)||l.push(u);else l=
l.concat(a.results);n&&0<n&&(a.total>n&&(a.total=n),a.nextStart>n&&(a.nextStart=-1));if(0<a.nextStart){h=a.total-a.results.length;t=Math.ceil(h/100);for(r=a.nextStart;p<t;p++)k.start=r+100*p,f.push(d._searchGroups(k));B.default(f).then(function(a){for(p=0;p<a.length;p++)if(v=a[p],!v.code&&!v.message)if(e.default.isPortal()&&m)for(w=0;w<v.results.length;w++)u=v.results[w],b.default.isDefined(u.provider)||u.providerGroupName||l.push(u);else l=l.concat(v.results);d._processGroups(g,l).then(function(){c.resolve()})},
function(a){c.resolve()})}else d._processGroups(g,l).then(function(){c.resolve()})}},function(a){c.reject(a)});return c};c.prototype._clearSearch=function(){var a=this;a._searchBox.set("value","");a._toggleClearSearchButton();a._doSearch(null).then(function(){a._refreshGroups()})};c.prototype._restrictSearchChange=function(){this.restrictSearch=this._restrictSearch.get("checked");this._searchClick(null)};c.prototype._processGroups=function(a,b){var d=new q.default;this._distinguishGroupTitles(b);
a?this.groupResults=b:(this.groups=b,this.groupResults=null);this._emitResult(b);d.resolve();return d};c.prototype._distinguishGroupTitles=function(d){if(b.default.isDefined(d)){for(var c=a.default.isRightToLeft?" \x26#8207;":" ",e={},f=0,g,k;f<d.length;f++)g=d[f],k=e[g.title],e[g.title]=k?k+1:1;for(f=0;f<d.length;f++)g=d[f],k=e[g.title],1<k&&(g.altTitle=g.title+c+"("+g.owner+")")}};c.prototype._retrieveCurrentGroups=function(){var a=this.groupResults;return b.default.isDefined(a)?a:this.groups};
c.prototype._retrieveSelectedGroups=function(){return this.selectedGroups||[]};c.prototype._emitSelect=function(a){this.emit("select",{selectedGroup:a})};c.prototype._emitRemove=function(a){this.emit("remove",{removedGroup:a})};c.prototype._emitSelectionChange=function(){this.emit("selection-change",{selectedGroups:this._retrieveSelectedGroups()})};c.prototype._emitResult=function(a){this.emit("result",{groups:a})};c.prototype._selectGroup=function(a){if(a&&a.target&&a.target.id){a.preventDefault();
var b=a.target.id.indexOf("group-"),d=!1,c,e;if(-1<b&&(a=parseInt(a.target.id.substring(b+6),10),b=this._retrieveCurrentGroups())&&(c=b[a])){a=this._retrieveSelectedGroups();for(b=0;b<a.length;b++)if(e=a[b],e.id===c.id||e.title===c.title&&e.owner===c.owner){d=!0;break}d||(d=x.default.clone(c),a.push(d),this.selectedGroups=a,this._emitSelect(d),this._emitSelectionChange(),this._refreshSelectedGroups())}}};c.prototype._removeGroup=function(a){if(a&&a.target&&a.target.id){a.preventDefault();var b;-1<
a.target.id.indexOf("selected-group-")&&(b=parseInt(a.target.id.substring(15),10),a=this._retrieveSelectedGroups(),a.length>b&&(b=a.splice(b,1)[0],this.selectedGroups=a,this._emitRemove(b),this._emitSelectionChange(),this._refreshSelectedGroups()))}};c.prototype._refreshSelectedGroups=function(){n.default.set(this._selectedGroupsPane,"innerHTML","");var a=this._retrieveSelectedGroups(),b,d;if(a)for(b=0;b<a.length;b++)d=a[b],r.default.create("a",{href:"#",id:"selected-group-"+b,innerHTML:d.altTitle||
d.title,className:"linkNoHref","data-id":d.id,"data-title":d.title,"data-owner":d.owner},this._selectedGroupsPane),r.default.create("br",null,this._selectedGroupsPane)};c.prototype._refreshGroups=function(){n.default.set(this._groupsPane,"innerHTML","");var a=this._retrieveCurrentGroups(),b,d;if(a&&0<a.length)for(d=0;d<a.length;d++)b=a[d],r.default.create("a",{id:"group-"+d,innerHTML:b.altTitle||b.title,className:"linkNoHref","data-id":b.id,"data-title":b.title,"data-owner":b.owner},this._groupsPane),
r.default.create("br",null,this._groupsPane);else a&&0===a.length&&r.default.create("span",{innerHTML:this.i18n.noSearchResults},this._groupsPane)};c.prototype._addAllClick=function(){var a=this._retrieveCurrentGroups(),b=this._retrieveSelectedGroups(),b=b?b.length:0;this.selectedGroups=x.default.clone(a);this._refreshSelectedGroups();a.length!==b&&this._emitSelectionChange()};c.prototype._clearAllClick=function(){var a=this._retrieveSelectedGroups();this.selectedGroups=[];this._refreshSelectedGroups();
0<a.length&&this._emitSelectionChange()};c.prototype.enableSearchUI=function(a){this.enableSearch=a;this._toggleEnableSearch()};c.prototype.enableRestrictSearchUI=function(a){this.enableRestrict=a;this._toggleEnableRestrict()};c.prototype.restrictSearchToOrg=function(a){this.restrictSearch=a;this._toggleRestrictSearch();this._searchClick(null)};c.prototype.enableListActionsUI=function(a){this.enableListActions=a;this._toggleEnableListActions()};c.prototype.reset=function(){this._clearSearch();this._clearAllClick()};
c.prototype.focusSearch=function(){this._searchBox&&this._searchBox.focus()};c.prototype._setSearchLabelAttr=function(a){this._searchLabel&&n.default.set(this._searchLabel,"innerHTML",a)};c.prototype._setGroupsLabelAttr=function(a){this._groupListLabel&&n.default.set(this._groupListLabel,"innerHTML",a)};c.prototype._setGroupsClickLabelAttr=function(a){this._groupsClickLabel&&n.default.set(this._groupsClickLabel,"innerHTML",a)};c.prototype._setSelectedGroupsLabelAttr=function(a){this._selectedGroupListLabel&&
n.default.set(this._selectedGroupListLabel,"innerHTML",a)};c.prototype._setSelectedGroupsClickLabelAttr=function(a){this._selectedGroupsClickLabel&&n.default.set(this._selectedGroupsClickLabel,"innerHTML",a)};c.prototype._setGroupsAttr=function(a){this.groups=a;this.groupResults=null;this._refreshGroups()};c.prototype._getGroupsAttr=function(){return this._retrieveCurrentGroups()};c.prototype._setSelectedGroupsAttr=function(a){this.selectedGroups=a;this._emitSelectionChange();this._refreshSelectedGroups()};
c.prototype._getSelectedGroupsAttr=function(){return this._retrieveSelectedGroups()};c.prototype._setValueAttr=function(a){this.selectedGroups=a;this._emitSelectionChange();this._refreshSelectedGroups()};c.prototype._getValueAttr=function(){return this._retrieveSelectedGroups()};return c=h.__decorate([d.default(k.default,g.default,m.default)],c)}()})},"arcgisonline/sharing/dijit/dialog/AssignCreditsDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/dom-attr dojo/on dojo/json dojo/number dijit/a11yclick dojo/topic dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dijit/form/Button dijit/form/RadioButton dijit/form/TextBox dijit/form/NumberTextBox dijit/Tooltip esri/lang arcgisonline/pages/pageUtil arcgisonline/pages/utils/tooltips arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/GeneralDlg dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/AssignCreditsDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A){var E=l("arcgisonline.sharing.dijit.dialog.AssignCreditsDlg",[m,p,q],{declaredClass:"arcgisonline.sharing.dijit.dialog.AssignCreditsDlg",baseClass:"esriAssignCreditsDlg orgDlg",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:A,widgetsInTemplate:!0,_username:null,_tooltips:[],postMixInProperties:function(){this.inherited(arguments);this.i18n=h.mixin({},F.common);h.mixin(this.i18n,F);h.mixin(this.i18n,F.assignCreditsDlg)},
postCreate:function(){this.inherited(arguments);this._setupConnections()},_setupConnections:function(){this.own(this._okBtn.on("click",this._assignCredits.bind(this)),b(this._cancelBtn,this.hide.bind(this)),C.registerKeystrokeHandler(this._credits,this._creditsKeyHandler.bind(this)))},_creditsKeyHandler:function(a){this._setAllocationRadioBtn.get("checked")||this._setAllocationRadioBtn.set("checked",!0)},_setupTooltips:function(){this._tooltips&&0===this._tooltips.length&&this._tooltips.push(x.createTooltip(this.id+
"-noLimitTooltip-"+this.baseClass,this.i18n.orgLimit,200,300))},_setAssigning:function(a){this._okBtn.set("disabled",a);this._okBtn.set("label",a?this.i18n.assigning:this.i18n.assign)},_clear:function(){var b=esriGeowConfig.self&&esriGeowConfig.self.defaultUserCreditAssignment,b=b&&-1<b?b:"";this._setAllocationRadioBtn.set("checked",!0);this._credits.set("disabled",!1);this._credits.set("value",b);this._credits.set("displayedValue",b);this._credits.set("constraints",{min:-1});a.set(this._dialog,"title",
this.i18n.manageCredits);a.set(this._currentCreditsLabel,"innerHTML",y.substitute({num:d.format(parseInt(esriGeowConfig.self.subscriptionInfo.availableCredits,10))},this.i18n.currentCredits));a.set(this._setAllocationLabel,"innerHTML",y.substitute({name:this._username},this.i18n.setAllocation));this._setupTooltips();this._setAssigning(!1)},_assignCredits:function(){var a=this,b=a._setAllocationRadioBtn.get("checked"),c=a._credits.get("value"),e;if(a._validates())if(a._setAssigning(!0),b){try{e=isNaN(e)?
parseFloat(c):e,e=isNaN(e)?e:parseFloat(e.toFixed(2))}catch(J){a._createOneTimeTooltip(a.i18n.creditsNumberRequired,a._okBtn.domNode),a._setAssigning(!1)}a._assignCreditLimit(e).then(function(b){b&&b.code&&b.message?C.createSpecifiedDialog(z).show({title:a.i18n.errorTitle,message:y.substitute({name:a._username,num:d.format(e)},a.i18n.cantAllocateCredits)}):(C.createSpecifiedDialog(z).show({title:a.i18n.noticeLabel,message:y.substitute({name:a._username,num:d.format(e)},a.i18n.allocateCredits)}),a.hide());
a._setAssigning(!1);a._publishCreditsChanged()},function(b){C.createSpecifiedDialog(z).show({title:a.i18n.errorTitle,message:y.substitute({name:a._username,num:d.format(e)},a.i18n.cantAllocateCredits)});a._setAssigning(!1)})}else a._assignNoLimit().then(function(b){b&&b.code&&b.message?C.createSpecifiedDialog(z).show({title:a.i18n.errorTitle,message:y.substitute({name:a._username},a.i18n.cantAllocateNoLimit)}):(C.createSpecifiedDialog(z).show({title:a.i18n.noticeLabel,message:y.substitute({name:a._username},
a.i18n.allocatedNoLimit)}),a.hide());a._setAssigning(!1);a._publishCreditsChanged()},function(b){C.createSpecifiedDialog(z).show({title:a.i18n.errorTitle,message:y.substitute({name:a._username},a.i18n.cantAllocateNoLimit)});a._setAssigning(!1)})},_assignCreditLimit:function(a){return B.request({url:esriGeowConfig.restBaseUrl+"portals/self/assignUserCredits",content:{userAssignments:f.stringify([{username:this._username,credits:a}])}},{usePost:!0}).promise},_assignNoLimit:function(){return B.request({url:esriGeowConfig.restBaseUrl+
"portals/self/unassignUserCredits",content:{usernames:f.stringify([this._username])}},{usePost:!0}).promise},_publishCreditsChanged:function(){g.publish("credits-change")},_validates:function(){var a=this._setAllocationRadioBtn.get("checked"),b=esriGeowConfig.self.subscriptionInfo.availableCredits,d=this._credits.get("value"),c=this._okBtn.domNode,e;if(a)if(y.isDefined(d)&&0!==d.length)try{e=isNaN(d)?parseFloat(d):d;e=isNaN(e)?e:parseFloat(e.toFixed(2));if(isNaN(e))return this._createOneTimeTooltip(this.i18n.creditsNumberRequired,
c),!1;if(0>e)return this._createOneTimeTooltip(this.i18n.creditsZeroGreater,c),!1;if(e>b)return this._createOneTimeTooltip(this.i18n.creditLimitOrg,c),!1}catch(L){return this._createOneTimeTooltip(this.i18n.creditsNumberRequired,c),!1}else return this._createOneTimeTooltip(this.i18n.mustSetCredits,c),!1;return!0},_createOneTimeTooltip:function(a,b){x.oneTimeError(a,b)},show:function(a){this._username=a;this._clear();this._dialog.show()},hide:function(){this._dialog.hide()}});E.prototype.statics={_instance:null,
getInstance:function(){null==this._instance&&(this._instance=new E);return this._instance}};return E})},"arcgisonline/sharing/dijit/dialog/SelectEnterpriseGroupDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/on dojo/dom-class dojo/dom-construct dojo/dom-style dojo/keys dojo/topic dojo/store/Memory esri/lang esri/request arcgisonline/sharing/util arcgisonline/sharing/dijit/Grid dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Button dijit/form/TextBox dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/SelectEnterpriseGroupDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B){var z=l("arcgisonline.sharing.dijit.dialog.SelectEnterpriseGroupDlg",[u,w,t],{declaredClass:"arcgisonline.sharing.dijit.dialog.SelectEnterpriseGroupDlg",basePath:c.toUrl("esri/arcgisonline/sharing/dijit/dialog"),baseClass:"esriSelectEnterpriseGroupDlg",widgetsInTemplate:!0,templateString:B,rowsPerPage:10,_maxGroups:1E3,_searchEnterpriseGroupsAPI:"security/groups/searchEnterpriseGroups",postMixInProperties:function(){this.inherited(arguments);
this.i18n={};h.mixin(this.i18n,x.common);h.mixin(this.i18n,x.selectEnterpriseGroupDlg)},postCreate:function(){this.inherited(arguments);this._portalAdminUrl=r.getPortalAdminBaseUrl()+"/"},startup:function(){this.inherited(arguments)},show:function(a){this._clear();this._initSearch(a);this._dialog.show();this._groupsGrid&&this._groupsGrid._started&&(this._groupsGrid._grid.resize(),this._groupsGrid._grid.refresh());this.onSearch()},onSearchKeyDown:function(a){a.keyCode==k.ENTER&&(e.stop(a),this.onSearch())},
onSearch:function(a){a&&a.preventDefault();this._clearGroupsGrid();(a=this._search.get("value"))&&""!==a?this._searchEnterpriseGroups(a).then(h.hitch(this,function(a){if(a&&a.groups&&0<a.groups.length){var b=this._groupsGrid.get("store"),d;for(d=0;d<a.groups.length;d++)b.put(a.groups[d])}this._groupsGrid.refresh()}),h.hitch(this,function(a){this._groupsGrid.refresh()})):this._defaultGroupsQuery()},onGoToPageKeyDown:function(a){a.keyCode==k.ENTER&&(e.stop(a),this.onGoToPage())},onGoToPage:function(){var a=
this._goTo.get("value"),b=Math.ceil(this._groupsGrid._grid._total/this._groupsGrid._grid._rowsOnPage);try{a=parseInt(a),a<=b?this._groupsGrid._grid.gotoPage(a).then(h.hitch(this,function(){this._goTo.set("value","")})):this._goTo.set("value","")}catch(E){this._goTo.set("value","")}},onCancel:function(){this._dialog.hide()},onOk:function(){m.publish("enterprise-group-selected",this._selectedGroup);this._dialog.hide()},_searchEnterpriseGroups:function(a,b){var d=this._portalAdminUrl+this._searchEnterpriseGroupsAPI;
b={max:q.isDefined(b)?b:this._maxGroups};q.isDefined(a)&&0<a.length&&(b.filter=a);return r.request({url:d,content:b})},_defaultGroupsQuery:function(){this._clearGroupsGrid();this._searchEnterpriseGroups().then(h.hitch(this,function(a){if(a&&a.groups&&0<a.groups.length){var b=this._groupsGrid.get("store"),d;for(d=0;d<a.groups.length;d++)b.put(a.groups[d])}this._groupsGrid.refresh()}),h.hitch(this,function(a){this._groupsGrid.refresh()}))},_groupsGridColumns:function(){return{rolename:{label:" "+this.i18n.groupNameCol,
sortable:!1,formatter:h.hitch(this,function(a){return'\x3cspan class\x3d"esriContentTypeName"\x3e'+a+"\x3c/span\x3e"})},description:{label:" "+this.i18n.descCol,sortable:!1,formatter:h.hitch(this,function(a){a=q.isDefined(a)?a:"";return'\x3cspan class\x3d"esriContentTypeName"\x3e'+a+"\x3c/span\x3e"})}}},_createGroupsGrid:function(){this._groupsGrid=new v({columns:this._groupsGridColumns(),id:"groupsGrid",region:"center",noDataMessage:this.i18n.noGroupsFound,showLoadingMessage:!0,showHeader:!0,rowsPerPage:this.rowsPerPage,
pagingLinks:!0,selectionMode:"single",store:new p({identifier:"rolename",label:"rolename",data:[]})},b.create("div",null,this._gridContainer));this._groupsGrid.startup();this._groupsGrid.on("dgrid-select",h.hitch(this,this._selectedGridRow));this._groupsGrid.on("dgrid-deselect",h.hitch(this,this._deselectedGridRow));this._groupsGrid.on("dgrid-refresh-complete",h.hitch(this,function(){1<Math.ceil(this._groupsGrid._grid._total/this._groupsGrid._grid._rowsOnPage)?g.set(this._goToPageContainer,"display",
""):g.set(this._goToPageContainer,"display","none")}))},_selectedGridRow:function(a){d.add(a.rows[0].element,"selectedGroup");this._selectedGroup=a.rows[0].data;this._okBtn.set("disabled",!1)},_deselectedGridRow:function(a){d.remove(a.rows[0].element,"selectedGroup");this._selectedGroup&&this._selectedGroup.name===a.rows[0].data.name&&(this._selectedGroup=null,this._okBtn.set("disabled",!0))},_initGrid:function(){this._groupsGrid?this._clearGroupsGrid():this._createGroupsGrid();this._groupsGrid.refresh()},
_clearGroupsGrid:function(){var a=this._groupsGrid.get("store"),b=a.query(),d;for(d=0;d<b.length;d++)b[d]&&b[d].id&&a.remove(b[d].id)},_clear:function(){this._search.set("value","");this._selectedGroup=null;this._okBtn.set("disabled",!0);this._initGrid()},_initSearch:function(a){q.isDefined(a)&&this._search.set("value",a)}});z.prototype.statics={_instance:null,getInstance:function(){null==this._instance&&(this._instance=new z);return this._instance}};return z})},"arcgisonline/sharing/dijit/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/string dojo/_base/array dojo/date/locale dojo/on dojo/dom esri/lang dojo/aspect dijit/_WidgetBase dojo/_base/window dijit/TooltipDialog dijit/popup dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem dgrid/Grid dgrid/extensions/Pagination dgrid/extensions/DijitRegistry dgrid/OnDemandGrid dgrid/extensions/ColumnResizer dgrid/Keyboard ./_RefreshMixin ./Rating dojo/query dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/dom-construct dojo/when dojo/store/Memory dgrid/Selection dgrid/selector dojo/store/Observable put-selector/put dgrid/util/mouse dgrid/util/touch arcgisonline/sharing/util arcgisonline/sharing/geow/Content dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D){esri.i18nBundle=D;return c("arcgisonline.sharing.dijit.Grid",[k],{postMixInProperties:function(){this.inherited(arguments);this._util=T;this._content=I;this._supportedViews=["gallery","details","table"];this._favorites={};this._portalUser=this._util.getUser();this._galleryTemplate=this._galleryTemplate||"\x3cdiv style\x3d'opacity:0;' class\x3d'grid-item gallery-view'\x3e${item:_formatThumbnail}\x3ch5\x3e${item:_formatItemTitle}\x3c/h5\x3e${item:_formatItemTypeIcon}\x3c/div\x3e";
this._detailsTemplate=this._detailsTemplate||'\x3cdiv style\x3d\'opacity:0;\' class\x3d\'grid-item detail-view\'\x3e${item:_formatThumbnail}\x3ch5\x3e${item:_formatItemTitle}\x3c/h5\x3e\x3cdiv class\x3d"rating-system"\x3e\x3cdiv data-dojo-type\x3d\'arcgisonline/sharing/dijit/Rating\' data-dojo-props\x3d\'numStars:5,value:${item.avgRating},disabled:true\'\x3e\x3c/div\x3e\x26nbsp;\x3cspan\x3e(${item.numRatings})\x3c/span\x3e\x3c/div\x3e${item:_formatItemTypeIcon}\x3cp class\x3d"grid-item-type"\x3e${item:_formatType}\x3c/p\x3e\x3cp class\x3d"grid-item-desc"\x3e${item.snippet}\x3c/p\x3e${item:_formatPremiumContentIcon}\x3cspan class\x3d"openItem" id\x3d"openItem"\x3e\x3c/span\x3e\x3ca href\x3d"item.html?id\x3d${item.id}" class\x3d"calcite btn small primary details-button"\x3e${i18n.gallery.details}\x3c/a\x3e\x3c/div\x3e';
this._itemPopupTemplate=this._itemPopupTemplate||'\x3cdiv class\x3d"grid-item-hover"\x3e\x3ch5\x3e${item:_formatItemTitle}\x3c/h5\x3e\x3cspan id\x3d\'openItem\'\x3e\x3c/span\x3e\x3ca href\x3d"item.html?id\x3d${item.id}" class\x3d"calcite btn small primary details-button"\x3e${i18n.details}\x3c/a\x3e\x3cp class\x3d"item-hover-type"\x3e${item:_formatItemTypeIcon}${item:_formatType} by\x26nbsp;${item.owner:_formatOwnerLink}\x3c/p\x3e\x3cp class\x3d"item-hover-desc"\x3e${item.snippet}\x3c/p\x3e${item:_formatPremiumContentIcon}\x3cdiv class\x3d"rating-system"\x3e\x3cdiv data-dojo-type\x3d\'arcgisonline/sharing/dijit/Rating\' data-dojo-props\x3d\'numStars:5,value:${item.avgRating},disabled:true\'\x3e\x3c/div\x3e\x26nbsp;\x3cspan\x3e(${item.numRatings})\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e';
this._renderers=l.mixin(this._renderers||{},{gallery:l.hitch(this,function(a){a.snippet=a.snippet||"";var b=U("div"),d=new (c([k,n,r],{templateString:h.substitute(this._galleryTemplate,{item:a,i18n:D.gallery},null,this)}));a.widget=d;b.appendChild(d.domNode);return b}),details:l.hitch(this,function(a){a.snippet=a.snippet||"";var b=U("div"),d=new (c([k,n,r],{templateString:h.substitute(this._detailsTemplate,{item:a,i18n:D},null,this)})),e=new v({label:D.gallery.open,className:"btn calcite primary",
dropDown:this._getOpenInMenu(a)},E(".openItem",b)[0]);a.widget=d;b.appendChild(d.domNode);E(".openItem",b).replaceWith(e.domNode);0===e.dropDown.getChildren().length&&e.set("disabled",!0);return b}),table:function(){return U("div",t.prototype.renderRow.apply(this,arguments))}})},buildRendering:function(){this.inherited(arguments);var a=c([t,C,y,B,R,F]),b=this.columns||{title:{label:"title"},type:{label:"type"},modified:{label:"last modified"},access:{label:"sharing"}};this._view=this.view||"table";
this._query=this.query;this._sort=this.sort||[{attribute:"title",descending:!1}];this._queryOptions=this.queryOptions||{sort:this.sort};this._store=this.store||new L({data:[]});this._rowsPerPage=this.rowsPerPage||9;this._pagingLinks=this.pagingLinks?this.pagingLinks:3;this._showHeader=this.showHeader||!1;this._selectionMode=this.selectionMode||"extended";this._useTouchScroll=this.useTouchScroll||!1;this._grid=new a({columns:b,renderRow:this._renderers[this._view],noDataMessage:this.noDataMessage||
"",showHeader:this._showHeader,store:this._store,query:this._query,showLoadingMessage:!1,firstLastArrows:this._pagingLinks,previousNextArrows:this._pagingLinks,rowsPerPage:this._rowsPerPage,pagingLinks:this._pagingLinks,allowSelectAll:!0,selectionMode:this._selectionMode,sort:this._sort},this.domNode);this._grid.startup()},postCreate:function(){this.inherited(arguments);this.own(this._grid.on("refresh",l.hitch(this,function(){this._grid.showFooter=this._grid._total>this._grid.rowsPerPage;this._onGridRefresh()})),
g.before(this._grid,"removeRow",l.hitch(this,function(a){a&&(a=this._grid.row(a),(a=(a.data||a).widget)&&a.destroyRecursive())})),this._grid.on(".fav-icon a:click",l.hitch(this,function(a){a.preventDefault();var b=this._grid.row(a),d=a.target.parentNode.parentNode.parentNode,c=N.contains(a.target.parentNode,"fav-off");a=this._content[c?"addToFavorites":"removeFromFavorites"](b.data).then(l.hitch(this,function(){this._favorites[b.data.id].id=c?b.data.id:!1}));E(".fav-on",d).style({display:c?"":"none"});
E(".fav-off",d).style({display:c?"none":""});setTimeout(l.hitch(this,function(){E(".fav-on",d).style({width:c?"200px":"24px"});E(".fav-off",d).style({width:c?"24px":"200px"});setTimeout(l.hitch(this,function(){E(".fav-on, .fav-off").style({width:"24px"})}),2500)}),50);a.then(l.hitch(this,function(){}))})),this._grid.on(".fav-icon a:mouseout",l.hitch(this,function(a){O.set(a.target.parentNode,{width:"24px"})})));!esri.isTouchEnabled||"gallery"!==this._view&&"details"!==this._view?"gallery"!==this._view&&
"details"!==this._view||this.own(this._grid.on(S.enterRow,l.hitch(this,function(a){if(a.relatedTarget&&!1===N.contains(a.relatedTarget,"dijitMenu")&&!1===N.contains(a.relatedTarget,"dijitReset")){var b=this._grid.row(a),d=E("img",b.element)[0];clearTimeout(this._showPopupTimeout);d&&(this._showPopupTimeout=setTimeout(l.hitch(this,function(){this._portalUser?this._isFavorite(b.data.id).then(l.hitch(this,function(a){this._showPopup(b.data,d.parentNode)})):this._showPopup(b.data,d)}),400))}})),this._grid.on(S.leaveRow,
l.hitch(this,function(a){a.relatedTarget&&!1===N.contains(a.relatedTarget,"dijitTooltipDialog")&&!1===N.contains(a.relatedTarget,"dijitTooltipConnector")&&(clearTimeout(this._showPopupTimeout),clearTimeout(this._closePopupTimeout),this._closePopupTimeout=setTimeout(l.hitch(this,function(){E(".fav-on, .fav-off",this.domNode).style("display","none").style("width","24px");this._closePopup()}),10))}))):this.own(this._grid.on(G.selector(".dgrid-content .dgrid-row",G.tap),l.hitch(this,function(a){a.preventDefault();
var b=this._grid.row(a);this._portalUser?this._isFavorite(b.data.id).then(l.hitch(this,function(a){this._showPopup(b.data,E("img",b.element)[0].parentNode)})):this._showPopup(b.data,E("img",b.element)[0])})),this._grid.on(".dgrid-row:click",l.hitch(this,function(a){a.preventDefault();var b=this._grid.row(a);this._portalUser?this._isFavorite(b.data.id).then(l.hitch(this,function(a){this._showPopup(b.data,E("img",b.element)[0].parentNode)})):this._showPopup(b.data,E("img",b.element)[0])})))},_onGridRefresh:function(a){this.emit("onRefresh",
{currentPage:this._grid._currentPage});this._pagingLinks&&(E(".dgrid-navigation",this._grid.domNode)[this._grid._total<=this._grid.rowsPerPage?"addClass":"removeClass"]("hide"),E(".dgrid-pagination",this._grid.domNode)[0===this._grid._total?"addClass":"removeClass"]("hide"))},_getGridAttr:function(){return this._grid},_showPopup:function(a,b){"details"===this._view?this._portalUser&&this._isFavorite(a.id).then(l.hitch(this,function(a){E(".fav-on",b.parentNode).style("display",a.id?"":"none");E(".fav-off",
b.parentNode).style("display",a.id?"none":"")})):"gallery"===this._view&&a.id&&a.id!==this._popupId&&(this._portalUser&&this._isFavorite(a.id).then(l.hitch(this,function(a){E(".fav-on",b.parentNode).style("display",a.id?"":"none");E(".fav-off",b.parentNode).style("display",a.id?"none":"")})),this._closePopup(),this._popupId=a.id,this._tooltip=new p({onMouseLeave:l.hitch(this,"_closePopup"),content:new (c([k,n,r],{templateString:h.substitute(this._itemPopupTemplate,{item:a,i18n:D.gallery},null,this)}))}),
q.open({popup:this._tooltip,around:b,orient:["after-centered","before-centered"]}),this._popupButton=new v({label:D.gallery.open,className:"calcite btn small primary",dropDown:this._getOpenInMenu(a)}),E("#openItem").replaceWith(this._popupButton.domNode),0===this._popupButton.dropDown.getChildren().length&&this._popupButton.set("disabled",!0))},_closePopup:function(a){a&&a.relatedTarget&&(!0===N.contains(a.relatedTarget,"dijitBackgroundIframe")||!0===N.contains(a.relatedTarget,"dijitMenu")||!0===
N.contains(a.relatedTarget,"dijitReset"))||!this._tooltip||(q.close(this._tooltip),this._popupConnect&&this._popupConnect.remove(),this._popupButton&&this._popupButton.destroyRecursive(),this._tooltip.destroyRecursive(),this._popupId=this._tooltip=null)},_isFavorite:function(a){return J(this._favorites[a]||this._searchItems('(group:"'+this._portalUser.favGroupId+'" AND id:"'+a+'")').then(l.hitch(this,function(b){this._favorites[a]=b.results[0]||{id:!1};return this._favorites[a]})))},_searchItems:function(a){return this._util.request({url:esriGeowConfig.restBaseUrl+
"search",content:{q:a,f:"json"}})},refresh:function(){this._grid&&this._grid.set("query",this._query,this._queryOptions)},gotoPage:function(a){this._grid.query=this._query;this._grid.queryOptions=this._queryOptions;this._grid._sort=this._queryOptions.sort;this._grid.gotoPage(a)},_formatItemTitle:function(a){return a.title||a.name||""},_formatType:function(a){return this._content.changeTypename({type:a.type,typeKeywords:a.typeKeywords},!1)||a.type},_formatLargeThumbnail:function(a){return a?"\x3cimg class\x3d'grid-item-thumb' alt\x3d'' src\x3d'"+
a+"'\x3e":"\x3cimg class\x3d'grid-item-thumb' alt\x3d'' src\x3d'"+this._util.getStaticImagesUrl()+"/desktopapp.png'\x3e"},_getDefaultThumbnail:function(a){var b=this._util.getStaticImagesUrl();return"web mapping application"==a?b+"/webapp.png":"mobile application"==a?b+"/mobileapp.png":"workforce project"===a?b+"/workforceproject.png":"hub initiative"===a?b+"/hubinitiative.png":"hub page"===a?b+"/hubpage.png":"hub site application"===a?b+"/hubsite.png":"dashboard"===a?b+"/opsdashboard.png":"geoprocessing service"===
a&&esriGeowConfig.self&&esriGeowConfig.self.isPortal?b+"/webtool.png":"web scene"===a||"scene service"===a?b+"/scene.png":"ortho mapping project"===a?b+"/orthomappingproject.png":"ortho mapping template"===a?b+"/orthomappingtemplate.png":b+"/desktopapp.png"},_formatThumbnail:function(a){var b=a.thumbnailUrl||this._getDefaultThumbnail(a.type&&a.type.toLowerCase()),d=this._util.getHomePageGalleryLinkInfo(a),c=-1<dojo.indexOf(a.typeKeywords,"Web AppBuilder for ArcGIS"),c=esriGeowConfig.self&&esriGeowConfig.self.isPortal&&
c||"Application"===a.type||"Web Mapping Application"===a.type&&!c||"Mobile Application"===a.type||"Document Link"===a.type,e="Application"===a.type||"Web Mapping Application"===a.type||"Mobile Application"===a.type||"Document Link"===a.type||"CityEngine Web Scene"===a.type||"Dashboard"===a.type;a='\x3ca href\x3d"'+(esri.isTouchEnabled?"#":c?a.url||"item.html?id\x3d"+a.id:d&&d.href&&d.href.replace(/"/g,"'")||"item.html?id\x3d"+a.id)+'" target\x3d"'+(e?"_blank":"")+'"\x3e\x3cimg class\x3d"grid-item-thumb" alt\x3d"" src\x3d"'+
b+'" /\x3e\x3c/a\x3e';b=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom();b=!b||b&&esriGeowConfig.userRole.canShareItemToGroup();d='\x3cdiv class\x3d"gallery-img"\x3e\x3cdiv class\x3d"fav-icon"\x3e\x3ca href\x3d"#"\x3e\x3cdiv class\x3d"fav-on" style\x3d"display:none;"\x3e\x3cdiv class\x3d"star-on"\x3e\x3c/div\x3e\x3cp id\x3d"addString"\x3e'+D.gallery.addFavorite+'\x3c/p\x3e\x3c/div\x3e\x3c/a\x3e\x3ca href\x3d"#"\x3e\x3cdiv class\x3d"fav-off" style\x3d"display:none;"\x3e\x3cdiv class\x3d"star-off"\x3e\x3c/div\x3e\x3cp id\x3d"remString"\x3e'+
D.gallery.removeFavorite+"\x3c/p\x3e\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e"+a+"\x3c/div\x3e";return b&&this._portalUser?d:a},_formatItemTypeIcon:function(a){return"\x3cimg class\x3d'grid-item-icon' alt\x3d'' src\x3d'"+this._content._getItemIconUrl(a)+"'\x3e"},_formatPremiumContentIcon:function(b){var d=b.isPremiumContent,c=b.getTypeInfo(),e=esriGeowConfig.self&&esriGeowConfig.self.isPortal?"portal":"";b=-1<a.indexOf(b.typeKeywords,"Requires Credits");return d?'\x3cp class\x3d"grid-item-type" title\x3d"'+
(b?D.common["premiumcontentcreditstitle"+e]:D.common["premiumcontenttitle"+e])+"\"\x3e\x3cimg class\x3d'grid-premium-icon' alt\x3d'' src\x3d'"+c.premiumIconUrl+"'\x3e"+(b?D.common.premiumcontent:D.common.subscriptioncontent)+"\x3c/p\x3e":""},_formatDate:function(a){!1===a instanceof Date&&(a=new Date(a));return a?e.format(a,{selector:"date",datePattern:"MMMM yyy"}):""},_formatOwnerLink:function(a){return'\x3ca href\x3d"user.html?user\x3d'+a+'"\x3e'+a+"\x3c/a\x3e"},_getOpenInMenu:function(b){b=this._util.getItemOpenLinkObjects(b);
var d,c;d=new u({autoFocus:!0,_destroyOnRemove:!0,showTitle:!1});a.forEach(b,function(a){c=new w({label:a.label,onClick:function(){a.onClick()}});d.addChild(c)});d.startup();return d},_setViewAttr:function(b){this._view=b=-1===a.indexOf(this._supportedViews,b)?this._view:b;this._grid&&(this._grid.renderRow=this._renderers[b],U(this._grid.domNode,"!table!gallery!details."+b),this._grid.set("showHeader","table"===this._view))},_setStoreAttr:function(a){this._store=a},_setQueryAttr:function(a,b){this._query=
a||this._query;this._queryOptions=b||this._queryOptions},_setItemsAttr:function(a){(this._store=this._store||new Q(new L({data:a,identifier:"id",label:"id"})),this._store.setData)?this._store.setData(a):this._store=new Q(new L({data:a}));this.set("store",this._store);this.set("view",this._view)}})})},"arcgisonline/sharing/dijit/Rating":function(){define(["dojo/_base/declare","dojox/form/Rating","dojo/dom-attr","dojo/string","dojo/i18n!../../nls/arcgisonline"],function(c,l,h,a,e){return c([l],{constructor:function(a){c.safeMixin(this,
a)},postCreate:function(){this.inherited(arguments);var c=a.substitute(e.common.ratingMsg2,{stars:this.params.value});h.set(this.domNode,"aria-label",c);h.set(this.domNode,"tabindex",0)},_onMouse:function(){this.get("disabled")||this.inherited(arguments)},onStarClick:function(){this.get("disabled")||this.inherited(arguments)},_setValueAttr:function(a){a=Math.round(a);this.inherited(arguments)}})})},"dojox/form/Rating":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/mouse dojo/on dojo/string dojo/query dijit/form/_FormWidget".split(" "),
function(c,l,h,a,e,f,d,b,g){return c("dojox.form.Rating",g,{templateString:null,numStars:3,value:0,buildRendering:function(a){for(var b='\x3clabel class\x3d"dojoxRatingStar dijitInline ${hidden}"\x3e\x3cspan class\x3d"dojoxRatingLabel"\x3e${value} stars\x3c/span\x3e\x3cinput type\x3d"radio" name\x3d"rating-'+Math.random().toString(36).substring(2)+'" value\x3d"${value}" dojoAttachPoint\x3d"focusNode" class\x3d"dojoxRatingInput"\x3e\x3c/label\x3e',c='\x3cdiv dojoAttachPoint\x3d"domNode" class\x3d"dojoxRating dijitInline"\x3e\x3cdiv data-dojo-attach-point\x3d"list"\x3e'+
d.substitute(b,{value:0,hidden:"dojoxRatingHidden"})+"${stars}\x3c/div\x3e\x3c/div\x3e",e="",f=0;f<this.numStars;f++)e+=d.substitute(b,{value:f+1,hidden:""});this.templateString=d.substitute(c,{stars:e});this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._renderStars(this.value);this.own(f(this.list,f.selector(".dojoxRatingStar","mouseover"),l.hitch(this,"_onMouse")),f(this.list,f.selector(".dojoxRatingStar","click"),l.hitch(this,"_onClick")),f(this.list,f.selector(".dojoxRatingInput",
"change"),l.hitch(this,"onStarChange")),f(this.list,e.leave,l.hitch(this,function(){this._renderStars(this.value)})))},_onMouse:function(a){var b=+h.get(a.target.querySelector("input"),"value");this._renderStars(b,!0);this.onMouseOver(a,b)},_onClick:function(a){if("LABEL"===a.target.tagName){var b=+h.get(a.target.querySelector("input"),"value");a.target.value=b;this.onStarClick(a,b);b==this.value&&(a.preventDefault(),this.onStarChange(a))}},_renderStars:function(d,c){b(".dojoxRatingStar",this.domNode).forEach(function(b,
e){e>d?(a.remove(b,"dojoxRatingStarHover"),a.remove(b,"dojoxRatingStarChecked")):(a.remove(b,"dojoxRatingStar"+(c?"Checked":"Hover")),a.add(b,"dojoxRatingStar"+(c?"Hover":"Checked")))})},onStarChange:function(a){a=+h.get(a.target,"value");this.setAttribute("value",a==this.value?0:a);this._renderStars(this.value);this.onChange(this.value)},onStarClick:function(a,b){},onMouseOver:function(){},setAttribute:function(a,b){this.set(a,b)},_setValueAttr:function(a){this._set("value",a);this._renderStars(a);
var d=b("input[type\x3dradio]",this.domNode)[a];d&&(d.checked=!0);this.onChange(a)}})})},"arcgisonline/sharing/dijit/dialog/SelectEnterpriseUserDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/on dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/i18n dojo/keys dojo/topic dojo/store/Memory esri/lang esri/request arcgisonline/sharing/util arcgisonline/sharing/dijit/Grid dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Button dijit/form/TextBox dojo/text!arcgisonline/sharing/dijit/dialog/templates/SelectEnterpriseUserDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F){return l([y,C,x],{declaredClass:"arcgisonline.sharing.dijit.dialog.SelectEnterpriseUserDlg",basePath:c.toUrl("esri/arcgisonline/sharing/dijit/dialog"),baseClass:"esriSelectEnterpriseUserDlg",widgetsInTemplate:!0,templateString:F,_maxUsers:1E3,_searchEnterpriseUsersAPI:"security/users/searchEnterpriseUsers",statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SelectEnterpriseUserDlg);
return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n={};h.mixin(this.i18n,dojo.i18n.getLocalization("arcgisonline","arcgisonline").common);h.mixin(this.i18n,dojo.i18n.getLocalization("arcgisonline","arcgisonline").selectEnterpriseUserDlg)},postCreate:function(){this.inherited(arguments);this._portalAdminUrl=w.getPortalAdminBaseUrl()+"/"},startup:function(){this.inherited(arguments)},show:function(a){this._clear();this._initSearch(a);this._dialog.show();this._usersGrid&&
this._usersGrid._started&&(this._usersGrid._grid.resize(),this._usersGrid._grid.refresh());this.onSearch()},onSearchKeyDown:function(a){a.keyCode==q.ENTER&&(e.stop(a),this.onSearch())},onSearch:function(a){a&&a.preventDefault();this._clearUsersGrid();(a=this._search.get("value"))&&""!==a?this._searchEnterpriseUsers(a).then(h.hitch(this,function(a){if(a&&a.users&&0<a.users.length){var b=this._usersGrid.get("store"),d;for(d=0;d<a.users.length;d++)b.put(a.users[d])}this._usersGrid.refresh()}),h.hitch(this,
function(a){this._usersGrid.refresh()})):this._defaultUsersQuery()},onGoToPageKeyDown:function(a){a.keyCode==q.ENTER&&(e.stop(a),this.onGoToPage())},onGoToPage:function(){var a=this._goTo.get("value"),b=Math.ceil(this._usersGrid._grid._total/this._usersGrid._grid._rowsOnPage);try{a=parseInt(a),a<=b?this._usersGrid._grid.gotoPage(a).then(h.hitch(this,function(){this._goTo.set("value","")})):this._goTo.set("value","")}catch(N){this._goTo.set("value","")}},onCancel:function(){this._dialog.hide()},onOk:function(){n.publish("enterprise-user-selected",
this._selectedUser);this._dialog.hide()},_searchEnterpriseUsers:function(a,b){var d=this._portalAdminUrl+this._searchEnterpriseUsersAPI;b={max:v.isDefined(b)?b:this._maxUsers};v.isDefined(a)&&0<a.length&&(b.filter=a);return w.request({url:d,content:b})},_defaultUsersQuery:function(){this._clearUsersGrid();this._searchEnterpriseUsers().then(h.hitch(this,function(a){if(a&&a.users&&0<a.users.length){var b=this._usersGrid.get("store"),d;for(d=0;d<a.users.length;d++)b.put(a.users[d])}this._usersGrid.refresh()}),
h.hitch(this,function(a){this._usersGrid.refresh()}))},_usersGridColumns:function(){return{username:{label:" "+this.i18n.userNameCol,sortable:!1,formatter:h.hitch(this,function(a){return'\x3cspan class\x3d"esriContentTypeName"\x3e'+a+"\x3c/span\x3e"})},fullname:{label:" "+this.i18n.fullNameCol,sortable:!1,formatter:h.hitch(this,function(a){a=v.isDefined(a)?a:"";return'\x3cspan class\x3d"esriContentTypeName"\x3e'+a+"\x3c/span\x3e"})}}},_createUsersGrid:function(){this._usersGrid=new t({columns:this._usersGridColumns(),
id:"usersGrid",region:"center",noDataMessage:this.i18n.noUsersFound,showLoadingMessage:!0,showHeader:!0,rowsPerPage:10,pagingLinks:!0,selectionMode:"single",store:new r({identifier:"username",label:"fullname",data:[]})},k.create("div",null,this._gridContainer));this._usersGrid.startup();this._usersGrid.on("dgrid-select",h.hitch(this,this._selectedGridRow));this._usersGrid.on("dgrid-deselect",h.hitch(this,this._deselectedGridRow));this._usersGrid.on("dgrid-refresh-complete",h.hitch(this,function(){1<
Math.ceil(this._usersGrid._grid._total/this._usersGrid._grid._rowsOnPage)?m.set(this._goToPageContainer,"display",""):m.set(this._goToPageContainer,"display","none")}))},_selectedGridRow:function(a){g.add(a.rows[0].element,"selectedUser");this._selectedUser=a.rows[0].data;this._okBtn.set("disabled",!1)},_deselectedGridRow:function(a){g.remove(a.rows[0].element,"selectedUser");this._selectedUser&&this._selectedUser.username===a.rows[0].data.username&&(this._selectedUser=null,this._okBtn.set("disabled",
!0))},_initGrid:function(){this._usersGrid?this._clearUsersGrid():this._createUsersGrid();this._usersGrid.refresh()},_clearUsersGrid:function(){var a=this._usersGrid.get("store"),b=a.query(),d;for(d=0;d<b.length;d++)b[d]&&b[d].id&&a.remove(b[d].id)},_clear:function(){this._search.set("value","");this._selectedUser=null;this._okBtn.set("disabled",!0);this._initGrid()},_initSearch:function(a){v.isDefined(a)&&this._search.set("value",a)}})})},"arcgisonline/sharing/dijit/OrganizationSetup":function(){define("dojo/_base/declare dojo/_base/lang dojo/cookie dojo/debounce dojo/dom-attr dojo/dom-class dojo/dom-style dojo/on dijit/a11yclick dojo/string dojo/when dojox/html/entities dojo/data/ItemFileReadStore dojo/store/Memory dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Button dijit/form/CheckBox dijit/form/FilteringSelect dijit/form/TextBox dijit/layout/ContentPane dijit/Tooltip esri/lang ../../esriGeowConfig ../util ../../pages/pageUtil ../../pages/utils/culture ../../pages/utils/tooltips ../geow/Account ../geow/Geow ./dialog/GeneralDlg dojo/i18n!../../nls/arcgisonline dojo/text!./templates/OrganizationSetup.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R){return c("arcgisonline.sharing.dijit.OrganizationSetup",[r,v,u],{declaredClass:"arcgisonline.sharing.dijit.OrganizationSetup",templateString:R,widgetsInTemplate:!0,DEFAULT_ACCOUNT_NAME:"My Account",ACCOUNT_ADMIN_ROLE:"account_admin",BROWSER_DEFAULT:"browser",ACCESS_DENIED_ERROR_PATH:"error.html?c\x3dAccessDenied",_user:null,_settings:null,_validUrlKey:!1,_urlKeyAlreadySet:!1,_tooltips:[],postMixInProperties:function(){this.inherited(arguments);
this.i18n=l.mixin(L.common,L.organizationSetup);l.mixin(this.i18n,{usageTrackingDesc:L.myOrganization.generalTab.usageTrackingDesc,usageTrackingSetting:L.myOrganization.generalTab.usageTrackingSetting,allowArcgisOnlineToCollectInfo:L.usageTracking.allowArcgisOnlineToCollectInfo})},destroy:function(){this.inherited(arguments);this._tooltips.forEach(function(a){a&&a.destroyRecursive&&a.destroyRecursive()})},postCreate:function(){this.inherited(arguments);this._checkAccess();this._initHandlers();this._initImages();
this._initRedirects();this._initLocalization();this._initTooltips();m(K.getSupportedLanguagesAndRegions(),function(a){a&&(this._initLanguage(a.languages),this._initRegion(a.regions),this._loadOrganization())}.bind(this),this._handleError.bind(this))},_handleError:function(a){},_showAlert:function(a,d){var c=new J;b.once(c._dialog,"hide",function(){c._dialog.destroyRecursive();c.destroyRecursive()});c.show({title:a,message:d})},_urlContainsInvalidChars:function(a){return!a.match(/^[a-zA-Z0-9\-]*$/)},
_handleUrlKeyCheck:function(a){!a||a.code||a.message?this._validUrlKey=!1:a.available?(this._validUrlKey=!0,this._urlKeyStatusLabel.innerHTML=this.i18n.available,f.remove(this._urlKeyStatusLabel,"statusBad"),f.add(this._urlKeyStatusLabel,"statusGood")):(this._validUrlKey=!1,this._urlKeyStatusLabel.innerHTML=this.i18n.unavailable,f.remove(this._urlKeyStatusLabel,"statusGood"),f.add(this._urlKeyStatusLabel,"statusBad"))},_initHandlers:function(){var d=this.checkUrlKey.bind(this);this.own(g(this._sslCheckBox,
this.onSSLCheck.bind(this)),g(this._saveBtn,this.onSave.bind(this)),g(this._signOutBtn,this.onSignOut.bind(this)),b(this._urlKeyTextBox,"change",d),E.registerKeystrokeHandler(this._urlKeyTextBox,a(d,500)),b(this._languageSelect,"change",this.onLanguageChange.bind(this)))},_initImages:function(){this._orgNameImg&&e.set(this._orgNameImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-general-logo-name.png"));this._orgAbbrImg&&e.set(this._orgAbbrImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-general-logo-name.png"));
this._languageImg&&e.set(this._languageImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-language.png"));this._languageFormatImg&&e.set(this._languageFormatImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/helpIcon.png"));this._regionImg&&e.set(this._regionImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-region.png"));this._securityImg&&e.set(this._securityImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-security-https.png"));
this._linkImg&&e.set(this._linkImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb-links.png"));this._usageTrackingImg&&e.set(this._usageTrackingImg,"src",A.relativeToExplicitUrl("js/arcgisonline/sharing/dijit/css/images/thumb_euei.png"))},_checkAccess:function(){A.isLoggedIn()?(this._user=A.getUser(),this._user.accountId||this._user.role===this.ACCOUNT_ADMIN_ROLE||(window.location=F.baseUrl+this.ACCESS_DENIED_ERROR_PATH)):this._showUser||A.requireAuthentication()},_initRedirects:function(){this.redirectUrl=
F.baseUrl+"index.html";this.orgRedirectUrl=F.baseUrl+"organization.html"},_initLocalization:function(){e.set(dojo.byId("item-title"),"innerHTML",this.i18n.setupYourOrg);this._sslCheckBoxLabel.innerHTML=k.substitute(this.i18n.securityDesc,{span:'\x3cspan id\x3d"sslTooltip" style\x3d"border-bottom: 1px dotted #487696;"\x3e',spanEnd:"\x3c/span\x3e"});e.set(this._linkTooltip,"innerHTML",k.substitute(this.i18n.contactUs,{startSpan:'\x3cspan class\x3d"orgSettingTooltip"\x3e',endSpan:"\x3c/span\x3e"}));
this._link.set("placeholder",this.i18n.contactUsExample)},_initTooltips:function(){this._tooltips.push(O.createTooltip("linkTooltip",this.i18n.contactUsTooltip));this._tooltips.push(O.createTooltip("sslTooltip",this.i18n.sslTooltip));this._tooltips.push(O.createTooltip("languageFormatTooltip",this.i18n.learnNumDateFormat))},_initLanguage:function(a){if(a){var b=[{culture:this.BROWSER_DEFAULT,displayName:this.i18n.browserDefaultSelection,language:this.i18n.browserDefaultSelection,localizedName:this.i18n.browserDefaultSelection}];
a.forEach(function(a){a=l.mixin({displayName:p.decode(a.language+(a.localizedName?" - "+a.localizedName:"")+"\x26lrm;")},a);a.cultureFormats&&a.cultureFormats.length&&a.cultureFormats.forEach(function(a){a.displayName=p.decode(a.name+(a.localizedName?" - "+a.localizedName:"")+"\x26lrm;")});b.push(a)});a=new n({idProperty:"culture",label:"displayName",data:b});this._languageSelect.set("store",a);this._languageSelect.set("searchAttr","displayName")}},_initLanguageFormat:function(a,b){if(a&&a!==this.BROWSER_DEFAULT&&
b&&b.length){a=N.getSelectedFormat(this._settings.cultureFormat,b||[]);var d=new n({idProperty:"format",label:"displayName",data:b});this._languageFormatSelect.set("store",d);this._languageFormatSelect.set("searchAttr","displayName");a?this._languageFormatSelect.set("displayedValue",a.displayName):this._languageFormatSelect.set("displayedValue",b[0].displayName);E.showNode(this._languageFormatContainer)}else E.hideNode(this._languageFormatContainer)},_initRegion:function(a){a&&(a=new n({idProperty:"region",
label:"localizedName",data:a}),this._regionSelect.set("store",a),this._regionSelect.set("searchAttr","localizedName"))},_loadOrganization:function(){K.getSelf(function(a){if(!a||a.code||a.message)this._handleError(a);else{this._settings=a;this._sslCheckBox.set("checked",!0);this._settings.name&&this.DEFAULT_ACCOUNT_NAME!==this._settings.name&&this._nameTextBox.set("value",this._settings.name);this._settings.urlKey?(this._urlKeyAlreadySet=this._validUrlKey=!0,this._settings.customBaseUrl?e.set(this._sampleUrlTextBox,
"innerHTML","https://"+this._settings.urlKey+"."+this._settings.customBaseUrl):e.set(this._sampleUrlTextBox,"innerHTML",A.getSecureUrl(F.baseUrl)),this._urlKeyTextBox.set("disabled",!0),this._urlKeyTextBox.set("value",this._settings.urlKey)):(this._validUrlKey=!1,e.set(this._sampleUrlTextBox,"innerHTML",""));var b=this._languageSelect.get("store");this._settings.culture=N.getActualCulture(a.culture,b.query());b=(b=b.query({culture:a.culture||this.BROWSER_DEFAULT}).shift())?b.displayName:this.i18n.browserDefaultSelection;
this._languageSelect.set("displayedValue",b);e.set(this._languageFormatHelpLink,"href",F.self.helpBase+(F.self.helpMap.m["120001487"]||""));(a=this._regionSelect.get("store").query({region:a.region}).shift())&&a.localizedName&&this._regionSelect.set("displayedValue",a.localizedName);this._settings.portalProperties&&this._settings.portalProperties.links&&this._settings.portalProperties.links.contactUs&&(this._linkCheckBox.set("checked",!!this._settings.portalProperties.links.contactUs.visible),this._link.set("value",
this._settings.portalProperties.links.contactUs.url));a=F.restBaseUrl.replace("http:","https:").replace("/rest/","/geoip.jsp");A.getJson(a,this._setUsageTrackingCheckbox.bind(this),this._setUsageTrackingCheckbox.bind(this))}}.bind(this))},_setUsageTrackingCheckbox:function(a){this._usageTrackingCheckBox.set("checked",F.urlKey?!!this._settings.eueiEnabled:"US"===a.country)},_handleUpdateAccount:function(a){if(!a||a.code||a.message)this._handleError(a),this._showAlert(this.i18n.errorTitle,this.i18n.errors.unableToSave),
this._saveBtn.set("disabled",!1),this._saveBtn.set("label",this.i18n.saveContinue);else if(this._settings.urlKey&&this._settings.customBaseUrl){a=null;-1===window.location.host.indexOf(this._settings.urlKey+"."+this._settings.customBaseUrl)&&(a=A.getCookie("esri_auth"));var b=(this._settings.allSSL?"https:":"http:")+"//"+this._settings.urlKey+"."+this._settings.customBaseUrl,d=F.baseUrl.indexOf(location.host),b=-1<d?b+(F.baseUrl.substring(d+location.host.length)+"organization.html"):this._settings.allSSL?
this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:");a&&(b=A.getBridgeUrl(b,a));window.location=b}else window.location="account_admin"!==user.role||this._settings.urlKey?this._settings.allSSL?this.redirectUrl.replace("http:","https:"):this.redirectUrl.replace("https:","http:"):this._settings.allSSL?this.orgRedirectUrl.replace("http:","https:"):this.orgRedirectUrl.replace("https:","http:")},_validates:function(){var a=this._nameTextBox.getValue(),b=this._link.get("value"),
d=this._linkCheckBox.get("checked"),c=this.i18n.errors.pleaseCorrect,e=!1;a?(a=k.trim(a),0<a.length?-1<a.indexOf("\x3c")||-1<a.indexOf("\x3e")||-1<a.indexOf("%")?(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.orgNameInvalidChars):55<a.length&&(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.orgNameTooLong):(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.orgNameRequired)):(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.orgNameRequired);this._validUrlKey||(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.urlKeyRequired);!d||esri.isDefined(b)&&0!==
b.length||(e=!0,c+="\x3cbr\x3e"+this.i18n.errors.finishContactUsSetup);e&&this._showAlert(this.i18n.errorTitle,c);return!e},checkUrlKey:function(){if(!this._urlKeyAlreadySet){var a=this._urlKeyTextBox.getValue(),b=this._handleUrlKeyCheck.bind(this);a&&(a=k.trim(a));a&&0<a.length&&17>a.length?this._urlContainsInvalidChars(a)?(this._validUrlKey=!1,this._urlKeyStatusLabel.innerHTML=this.i18n.errors.urlKeyInvalidChars,f.remove(this._urlKeyStatusLabel,"statusGood"),f.add(this._urlKeyStatusLabel,"statusBad")):
(e.set(this._sampleUrlTextBox,"innerHTML","https://"+a+"."+this._settings.customBaseUrl),A.getJson(F.restBaseUrl+"portals/isUrlKeyAvailable?urlKey\x3d"+a,b,b)):(this._validUrlKey=!1,e.set(this._sampleUrlTextBox,"innerHTML",""),a&&16<a.length?(this._urlKeyStatusLabel.innerHTML=this.i18n.urlKeyTooLong,f.remove(this._urlKeyStatusLabel,"statusGood"),f.add(this._urlKeyStatusLabel,"statusBad")):(this._urlKeyStatusLabel.innerHTML="",f.remove(this._urlKeyStatusLabel,"statusGood"),f.remove(this._urlKeyStatusLabel,
"statusBad")))}},onLanguageChange:function(){var a=this._languageSelect.get("store").query({displayName:this._languageSelect.get("displayedValue")}).shift();a&&this._initLanguageFormat(a.culture,a.cultureFormats)},onSSLCheck:function(){var a=this._sslCheckBox.attr("checked");this._showAlert(this.i18n.warning,a?this.i18n.sslOnWarning:this.i18n.sslOffWarning)},onSave:function(){this._saveBtn.set("disabled",!0);this._saveBtn.set("label",this.i18n.saving);if(this._validates()){var a=this._handleUpdateAccount.bind(this),
b=this._nameTextBox.getValue(),d=this._urlKeyTextBox.getValue(),c=this._sslCheckBox.attr("checked");this._settings.name=k.trim(b);this._settings.urlKey=k.trim(d);this._settings.allSSL=c;b=(d=this._languageSelect.get("store").query({displayName:this._languageSelect.get("displayedValue")}).shift())&&d.culture?d.culture:this.BROWSER_DEFAULT;this._settings.culture=b===this.BROWSER_DEFAULT?"":b;d&&d.cultureFormats?(d=(d=this._languageFormatSelect.get("store").query({displayName:this._languageFormatSelect.get("displayedValue")}).shift())&&
d.format?d.format:void 0)?(this._settings.culture=b+"-"+d,this._settings.cultureFormat=d):this._settings.cultureFormat="":this._settings.cultureFormat="";b=this._regionSelect.get("store").query({localizedName:this._regionSelect.get("displayedValue")}).shift();this._settings.region=b&&b.region||"";this._settings.portalProperties=this._settings.portalProperties||{};this._settings.portalProperties.mustWelcome=!0;this._settings.portalProperties.links=this._settings.portalProperties.links||{};b=this._link.get("value");
z.isDefined(b)&&0<b.length?(0!==b.indexOf("http")&&0!==b.indexOf("mailto:")&&0<b.indexOf("@")?b="mailto:"+b:0!==b.indexOf("http")&&0>b.indexOf("mailto:")&&0>b.indexOf("@")&&(b="http://"+b),this._settings.portalProperties.links.contactUs={url:b,visible:!!this._linkCheckBox.get("checked")}):delete this._settings.portalProperties.links.contactUs;this._settings.eueiEnabled=this._usageTrackingCheckBox.checked;this._settings.basemapGalleryGroupQuery=null;this._settings.colorSetsGroupQuery=null;this._settings.defaultBasemap=
null;this._settings.defaultExtent=null;this._settings.featuredGroups=null;this._settings.featuredGroupsId=null;this._settings.featuredItemsGroupQuery=null;this._settings.homePageFeaturedContent=null;this._settings.layerTemplatesGroupQuery=null;this._settings.rotatorPanels=null;this._settings.symbolSetsGroupQuery=null;this._settings.templatesGroupQuery=null;this._settings.contacts=this._settings.contacts||[];K.updateAccount(this._settings,a,a)}else this._saveBtn.set("disabled",!1),this._saveBtn.set("label",
this.i18n.saveContinue)},onSignOut:function(){h("esri_webmap","",{expires:-1,path:"/"});var a=this.allSSL?A.getSecureUrl():A.getHttpUrl();H.signout(a+"index.html")}})})},"arcgisonline/sharing/dijit/OrganizationStatus":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/ContentPane,dojo/DeferredList,dojox/lang/functional,dojo/store/Observable,dojo/store/Memory,dojox/charting/StoreSeries,dijit/form/DateTextBox,dgrid/OnDemandGrid,dgrid/Keyboard,dgrid/extensions/ColumnResizer,dgrid/editor,dojo/on,arcgisonline/sharing/util,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/_UsageDlgMixin"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.OrganizationStatus");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.layout.ContentPane");c.require("dojo.DeferredList");c.require("dojox.lang.functional");c.require("dojo.store.Observable");c.require("dojo.store.Memory");c.require("dojox.charting.StoreSeries");c.require("dijit.form.DateTextBox");c.require("dgrid.OnDemandGrid");c.require("dgrid.Keyboard");c.require("dgrid.extensions.ColumnResizer");c.require("dgrid.editor");
c.require("dojo.on");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.geow.Account");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit.dialog._UsageDlgMixin");c.requireLocalization("arcgisonline","arcgisonline");c.declare("arcgisonline.sharing.dijit.OrganizationStatus",[l._Widget,l._Templated,arcgisonline.sharing.dijit.dialog._UsageDlgMixin],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"esriItemLinks" style\x3d"width:100%;height:100%;min-height:600px;"\x3e\r\n  \x3cdiv class\x3d"organizationInfo esriFloatLeading"\x3e\r\n      \x3c!--\x3cspan class\x3d"thumbnail esriFloatLeading"\x3e\x3cimg dojoAttachPoint\x3d"_thumbnail" class\x3d"groupThumbnail" /\x3e\x3c/span\x3e--\x3e\r\n      \x3c!--\x3ch1 style\x3d"line-height: 2.9em;" dojoAttachPoint\x3d"_title"\x3e\x3c/h1\x3e\x3cspan class\x3d"state esriLeadingMargin05" dojoAttachPoint\x3d"_state"\x3e${i18n.usage.trial}\x3c/span\x3e--\x3e\r\n      \x3ca class\x3d"helpLink" target\x3d"_blank"\x3e${i18n.learnMore}\x3c/a\x3e\r\n      \x3cul dojoAttachPoint\x3d"_creditsSummary" class\x3d"container_creditsSummary"\x3e\x3c/ul\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"organizationStatus esriFloatLeading esriLeadingMargin0" dojoAttachPoint\x3d"_status"\x3e\r\n    \x3c!--\x3cbutton dojoAttachPoint\x3d\'_showStatistics\' style\x3d"display:\'\';" class\x3d"showStatisticsBtn" dojoType\x3d"dijit.form.Button" type\x3d"button"\x3e${i18n.showStatisticsBtn}\x3c/button\x3e--\x3e\r\n    \x3c!--\x3clabel class\x3d"showStatisticsBtn" style\x3d"display:\'\';"\x3e${i18n.forLbl}\x3c/label\x3e--\x3e\r\n    \x3clabel for\x3d"selectDateRange" class\x3d"showStatisticsLbl"\x3e${i18n.showStatistics}\x3c/label\x3e\r\n    \x3cspan dojoAttachPoint\x3d\'_selectDate\'\x3e\x3c/span\x3e\r\n    \x3cdiv class\x3d\'customdate esriLeadingMargin2\' style\x3d"display:none;"\x3e\r\n      \x3clabel class\x3d"esriLeadingMargin1" for\x3d"customStart"\x3e${i18n.customStart}\x3c/label\x3e\r\n      \x3cspan style\x3d"width:150px;" dojoType\x3d"dijit.form.DateTextBox" dojoAttachPoint\x3d\'_customStart\'\x3e\x3c/span\x3e\r\n      \x3clabel class\x3d"esriLeadingMargin1" for\x3d"customEnd"\x3e${i18n.customEnd}\x3c/label\x3e\r\n      \x3cspan style\x3d"width:150px;" dojoType\x3d"dijit.form.DateTextBox" dojoAttachPoint\x3d\'_customEnd\'\x3e\x3c/span\x3e\r\n      \x3c!--\x3cbutton dojoAttachPoint\x3d\'_customDate\' dojoType\x3d"dijit.form.Button" type\x3d"button" style\x3d"display:none;"\x3e${i18n.showReport}\x3c/button\x3e--\x3e\r\n    \x3c/div\x3e\r\n    \x3cspan dojoAttachPoint\x3d"spinnerNode" class\x3d"pleaseWaitImg"\x3e\x3c/span\x3e\r\n    \x3cdiv class\x3d"organizationGraphs" style\x3d"display:none;"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3clegend class\x3d"esriLeadingMargin1 esriTrailingMargin1" dojoAttachPoint\x3d\'_creditUsage\'\x3e\x3c/legend\x3e\r\n        \x3cdiv class\x3d"organizationCredits"\x3e\r\n          \x3cdiv class\x3d"piechart esriFloatLeading"\x3e\r\n            \x3cdiv class\x3d"nodata nodatapie esriFloatLeading esriLeadingMargin7"\x3e${i18n.nodata}\x3c/div\x3e\r\n            \x3cdiv class\x3d"graph creditGraph" dojoAttachPoint\x3d"_creditsGraph"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"creditGraph instruction esriFloatLeading esriLeadingMargin4"\x3e${i18n.instruction}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"table esriTrailingMargin4" dojoAttachPoint\x3d"_creditsTable"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n      \x3cfieldset class\x3d"organizationDetails" style\x3d"display:none;"\x3e\r\n        \x3clegend class\x3d"esriLeadingMargin1 esriTrailingMargin1" dojoAttachPoint\x3d\'_creditDetailsLbl\'\x3e\x3c/legend\x3e\r\n        \x3cdiv style\x3d"margin:10px;"\x3e\r\n          \x3cdiv class\x3d"filter" style\x3d"display:none;"\x3e\r\n\t        \x3cdiv dojoAttachPoint\x3d"_creditSelect"\x3e\r\n              \x3clabel for\x3d"selectCredit"\x3e${i18n.showLbl}\x3c/label\x3e\r\n              \x3cspan dojoAttachPoint\x3d\'_selectCredit\'\x3e\x3c/span\x3e\r\n\t        \x3c/div\x3e\r\n\t        \x3cdiv dojoAttachPoint\x3d"_deomgmapsTaskSelect"\x3e\r\n              \x3clabel id\x3d"forTaskLbl" for\x3d"selectTask"\x3e${i18n.forLbl}\x3c/label\x3e\r\n              \x3cspan dojoAttachPoint\x3d\'_selectTask\'\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"_storageTaskSelect"\x3e\r\n            \x3clabel id\x3d"forTaskLbl" for\x3d"selectTask"\x3e${i18n.forLbl}\x3c/label\x3e\r\n            \x3cspan dojoAttachPoint\x3d\'_storageTask\'\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n\t      \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"organizationCredits"\x3e\r\n          \x3cdiv class\x3d"esriFloatLeading" style\x3d"width:50%;"\x3e\r\n            \x3cdiv dir\x3d\'ltr\' class\x3d"graph esriFloatLeading" dojoAttachPoint\x3d"_detailsGraph"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading" dojoAttachPoint\x3d"_lineLegend"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"esriFloatTrailing details"\x3e\r\n            \x3cdiv class\x3d"grid esriLeadingMargin0 esriTrailingMargin4"  dojoAttachPoint\x3d"_detailsTable"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"detailssum esriLeadingMargin0 esriLeadingMargin05"\x3e\r\n              \x3cinput name\x3d"check" type\x3d"checkbox" style\x3d"vertical-align:bottom" checked disabled\x3d\'true\'/\x3e\r\n              \x3clabel id\x3d"_sum" dojoAttachPoint\x3d"_detailsSum" for\x3d"check"\x3e${i18n.totalcredits}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
baseClass:"esriOrganizationStatus",noThumbnail:"images/group-no-image.png",_util:arcgisonline.sharing.util,_acct:arcgisonline.sharing.geow.Account,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").usageDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").organizationStatus);this.noThumbnail=this._util.relativeToExplicitUrl(this.noThumbnail)},
startup:function(){this._util.requireAuthentication()&&((this._user=this._util.getUser())&&this._user.accountId?(this._errorDlg=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/"),this._accountsUri=this._svcUrl+"portals/",this._searchUrl=this._svcUrl+"search/",this._requestParams={f:"json",token:this._user.token},this._usageParams={vars:"credits,bw,num,stg",
groupBy:"stype,etype,task"},this._prepareStores(),this._initHelpMgr(),this._loadData()):window.location="error.html?c\x3d"+(this._user?"InvalidOrganization":"AccessDeniedOrganization"))},destroy:function(){c.forEach(this._connects,c.disconnect);this._selectDate.destroy();this._selectCredit.destroy();this._selectTask.destroy();this._storageTask.destroy();this._lineChart.destroy();this._selectDate=this._selectCredit=this._selectTask=this._storageTask=this._lineChart=void 0},_prepareStores:function(){this.inherited(arguments);
this._creditCategories=[{id:"stg_tiles",value:{id:"stg_tiles",f:"stg_gbyte",fill:"#5B7F00",categ:this.i18n.stg_tiles,y:0,units:0}},{id:"stg_features",value:{id:"stg_features",f:"stg_gbyte",fill:"#4CFF00",categ:this.i18n.stg_features,y:0,units:0}},{id:"stg_portal",value:{id:"stg_portal",f:"stg_mbyte",fill:"#B6FF00",categ:this.i18n.stg_portal,y:0,units:0}},{id:"svcusg_elevanalysis",value:{id:"svcusg_elevanalysis",f:"num_analysis",fill:"#800080",categ:this.i18n.svcusg_elevanalysis,y:0,units:0}},{id:"tilegencnt_tiles",
value:{id:"tilegencnt_tiles",f:"num_tiles",fill:"#FFD800",categ:this.i18n.tilegencnt_tiles,y:0,units:0}},{id:"svcusg_routing",value:{id:"svcusg_routing",f:"num_routes",fill:"#90D1E9",categ:this.i18n.svcusg_routing,y:0,units:0}},{id:"svcusg_demogmaps",value:{id:"svcusg_demogmaps",f:"num_maps",fill:"#FF6A00",categ:this.i18n.svcusg_demogmaps,y:0,units:0}},{id:"svcusg_geotrigger",value:{id:"svcusg_geotrigger",f:"num_events",fill:"#73ABD4",categ:this.i18n.svcusg_geotrigger,y:0,units:0}},{id:"svcusg_geoenrich",
value:{id:"svcusg_geoenrich",f:"num_cost",fill:"#395FA9",categ:this.i18n.svcusg_geoenrich,y:0,units:0}},{id:"svcusg_spanalysis",value:{id:"svcusg_spanalysis",f:"num_analysis",fill:"#ADF8FF",categ:this.i18n.svcusg_spanalysis,y:0,units:0}},{id:"geocodecnt_geocode",value:{id:"geocodecnt_geocode",f:"num_locations",fill:"#00137F",categ:this.i18n.geocodecnt_geocode,y:0,units:0}},{id:"svcusg_tiles",value:{id:"svcusg_tiles",f:"bw_bwgbyte",fill:"red",categ:this.i18n.svcusg_tiles,y:0,units:0}},{id:"svcusg_features",
value:{id:"svcusg_features",f:"bw_bwgbyte",fill:"#FFA700",categ:this.i18n.svcusg_features,y:0,units:0}}];this._creditStore=new c.store.Observable(new c.store.Memory({data:{identifier:"id",items:this._creditCategories}}));this._observeHandle=this._creditStore.query().observe(c.hitch(this,function(a){c.query("."+a.id).attr("innerHTML",a.value.y);c.query("."+a.id+"_u").attr("innerHTML",esri.substitute(a.value,this.i18n[a.value.f.split("_")[1]]))}),!0);this._aggregateCategories={nasimpleroute:{stype:"routing",
filters:"num,credits",label:this.i18n.rtsimple},natsproute:{stype:"routing",filters:"num,credits",label:this.i18n.rtoptimized},nacfroute:{stype:"routing",filters:"num,credits",label:this.i18n.rtclosestfacility},naservicearea:{stype:"routing",filters:"num,credits",label:this.i18n.rtsvcareas},navrproute:{stype:"routing",filters:"num,credits",label:this.i18n.rtmultivehicle}};this._detailCategories="svcusg_features svcusg_tiles tilegencnt_tiles svcusg_routing svcusg_geoenrich svcusg_spanalysis svcusg_elevanalysis svcusg_demogmaps svcusg_geotrigger".split(" ");
var a=this.i18n.spatialAnalysisTasks;this._spanalysisTasks={AggregatePoints:a.aggregatePoints,FindHotSpots:a.findHotSpots,CreateBuffers:a.createBuffers,CreateDriveTimeAreas:a.createDriveTimeAreas,DissolveBoundaries:a.dissolveBoundaries,MergeLayers:a.mergeLayers,SummarizeWithin:a.summarizeWithin,SummarizeNearby:a.summarizeNearby,EnrichLayer:a.enrichLayer,OverlayLayers:a.overlayLayers,ExtractData:a.extractData,FindNearest:a.findNearest,FindExistingLocations:a.findExistingLocations,DeriveNewLocations:a.deriveNewLocations,
FindSimilarLocations:a.findSimilarLocations,CalculateDensity:a.calculateDensity,InterpolatePoints:a.interpolatePoints,PlanRoutes:a.planRoutes};a=this.i18n.elevAnalysisTasks;this._elevanalysisTasks={Profile:a.profile,SummarizeElevation:a.summarizeElevation,Viewshed:a.viewShed,Watershed:a.waterShed,TraceDownstream:a.traceDownStream};this._geoenrichTasks={display:"Infographic",report:"Report",geoenrich:"Data Enrichment"};this._demomapsTasks={infographic:"Map Queries","export":"Map Draws"};this._creditDetailsStore.put({id:this.i18n.all,
visible:!0,all:!0});this._observeHandle1=this._creditDetailsStore.query().observe(c.hitch(this,function(){this._updateLineChart(this._lineChart,this._lineLegend)}),!0)},onDateRangeChange:function(a,e){var f;"custom"!==a?(this._dateQuery=this._getDateQuery(a),e||this._query(this._dateQuery)):(f=new Date(this._dateQuery.startTime+6E4*(new Date).getTimezoneOffset()),0!=f.getMinutes()&&0!=f.getHours()&&0!=f.getSeconds()?(f=Date.UTC(f.getFullYear(),f.getMonth(),f.getDate()+2),this._customStart.set("value",
new Date(f),!e)):this._customStart.set("value",f,!e),this._customEnd.set("value",new Date(this._dateQuery.endTime+6E4*(new Date).getTimezoneOffset()-1),!e));c.query(".customdate").style("display","custom"===a?"inline-block":"none")},onCustomDateClick:function(a){var c=new Date(this._customStart.get("value")),f=new Date(this._customEnd.get("value")),c=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()),f=Date.UTC(f.getFullYear(),f.getMonth(),f.getDate()),f=f+864E5;5184E6<f-c&&("s"===a?(f=c+5184E6,this._customEnd.set("value",
new Date(f),!0)):"e"===a&&(c=f-5184E6,this._customStart.set("value",new Date(c),!0)));this._dateQuery={startTime:c,endTime:f,period:"1d"};this._dateQuery.startTime>this._dateQuery.endTime?this._showError({message:this.i18n.invalidDateRange}):this._dateQuery.endTime<=this._dateQuery.startTime?this._showError({message:this.i18n.invalidDateRange}):this._query(this._dateQuery)},onCreditFilterChange:function(a){var e=this._selectCredit.options,f=this._selectCredit.get("displayedValue"),d=this._creditDetailsStore.get(this.i18n.all)||
{},d="bw"===a?this._formatBytes("mbyte",d[a+"_total"]):d[a+"_total"];"num"===a?c.attr(this._detailsSum,"innerHTML",esri.substitute({type:f,totalCredits:c.number.format(d,{places:2})},"${type}: ${totalCredits}")):c.attr(this._detailsSum,"innerHTML",esri.substitute({totalCredits:c.number.format(d,{places:2})},this.i18n["total"+a]));this._updateLineChart(this._lineChart,this._lineLegend);c.forEach(e,c.hitch(this,function(b){this._grid.styleColumn(b.value+"_total","display: none;");b.value===a&&this._grid.sort(a+
"_total","desc")}));this._grid.styleColumn(a+"_total","display:table-cell;");this._grid.refresh()},onTaskFilterChange:function(){var a;"demogmaps"===this.stype?"export"===this._selectTask.get("value")?a=this._drawItems:"infographic"===this._selectTask.get("value")&&(a=this._queryItems):"features"===this.stype&&(a="file"===this._storageTask.get("value")?this._fileItems:this._dbItems);this._convertResultToDataStore(a);this.onCreditFilterChange(this._selectCredit.get("value"))},onCreditCategoryClick:function(a){var e=
"none",f="900",d=this._detailCategories,b=a.split("_")[1];c.style(this.spinnerNode,"display","inline-block");c.query(".hide").forEach(esri.hide);this._selectedCategory=a;this._resetLineChart(this._lineChart);c.attr(this._creditDetailsLbl,"innerHTML",this.i18n[a]);-1!==c.indexOf(d,a)&&(e="block",f="400");return this._queryDetails(a,this._dateQuery).then(c.hitch(this,function(){c.query("."+b).style("display","inline-block");c.query(".organizationDetails").forEach(esri.show);c.query(".details").style("display",
e);c.style(this.spinnerNode,"display","none");9>c.isIE?this._lineChart.resize({w:f,h:"375"}):this._lineChart.resize({w:f});this._setFilterOptions(a);this.onCreditFilterChange(this._selectCredit.get("value"))}))},onShowStatistics:function(){this._dateQuery.startTime>this._dateQuery.endTime?this._showError({message:this.i18n.invalidDateRange}):this._dateQuery.endTime<this._dateQuery.startTime?this._showError({message:this.i18n.invalidDateRange}):(c.style(this.spinnerNode,"display","inline-block"),this._queryDate(this._dateQuery).then(c.hitch(this,
function(){c.query(".organizationGraphs").style("display","block");this._createPieChart();var a=this._getTotalCredits();c.attr(this._creditUsage,"innerHTML",esri.substitute({org:this._organization.name,totalCredits:a},this.i18n.creditUsage));c.query(".creditssum").attr("innerHTML",esri.substitute({total:a},this.i18n.total));this._selectedFilter=this._selectedServices=null;c.style(this.spinnerNode,"display","none")})))},_query:function(a){var e=0;c.style(this.spinnerNode,"display","inline-block");
c.query(".organizationDetails").forEach(esri.hide);return this._queryDate(a).then(c.hitch(this,function(){c.style(this.spinnerNode,"display","none");e=this._getTotalCredits();c.attr(this._creditUsage,"innerHTML",esri.substitute({org:this._organization.name,totalCredits:e},this.i18n.creditUsage));c.query(".creditssum").attr("innerHTML",esri.substitute({total:e},this.i18n.total))}))},_queryDetails:function(a,e){var f=-1<e.period.indexOf("d")?"1d":"1h",d=c.mixin([],this._creditFilters),b={etype:a.split("_")[0],
stype:this._aggregateCategories[a.split("_")[1]]&&this._aggregateCategories[a.split("_")[1]].stype||a.split("_")[1],vars:d.join(","),period:f},g;this.stype=b.stype;switch(this.stype){case "demogmaps":b.groupby="stype,etype,name,task";break;case "spanalysis":case "elevanalysis":case "geoenrich":b.groupby="stype,etype,task";break;case "geotrigger":b.groupby="stype,etype,name,deviceid"}"svcusg"!==b.etype||"tiles"!==b.stype&&"features"!==b.stype||(b.groupby="stype,etype,name");return this._fetchCredits(e,
b).then(c.hitch(this,function(a){var d=-1,e=-1,f,k;this._drawItems=[];this._queryItems=[];this._dbItems=[];this._fileItems=[];for(f=a.length-1;0<=f;f--)k=a[f],"routing"===this.stype&&((g=this._aggregateCategories[k.stype])?c.mixin(k,{name:g.label,stype:"routing"}):a.splice(f,1)),"geoenrich"===this.stype&&("geoenrich"===k.task?d=f:k.task||(e=f,k.task="geoenrich"),k.name=this._geoenrichTasks[k.task]),"spanalysis"===this.stype&&(k.name=this._spanalysisTasks[k.task]),"elevanalysis"===this.stype&&(k.name=
this._elevanalysisTasks[k.task]),"demogmaps"===this.stype&&("export"===k.task?this._drawItems.push(k):"infographic"===k.task&&this._queryItems.push(k)),"stg_features"===this._selectedCategory&&(c.forEach(k.stg,c.hitch(this,function(a){a[1]=this._toFormat("gbyte",Number(a[1]))})),k.task&&"db"!==k.task?"file"===k.task&&this._fileItems.push(k):this._dbItems.push(k)),"geotrigger"===this.stype&&(k.name=this.i18n.deviceId+": "+k.deviceId);"geoenrich"===this.stype&&-1!==d&&-1!==e&&(a.push(this._combineItems([a[d],
a[e]])),f=d>=e?e:d,a.splice(d>=e?d:e,1),a.splice(f,1));"demogmaps"===this.stype?a="export"===this._selectTask.get("value")?this._drawItems:"infographic"===this._selectTask.get("value")?this._queryItems:this._drawItems:"stg_features"===this._selectedCategory&&(a="file"===this._selectTask.get("value")?this._fileItems:this._dbItems);this._selectedFilter=null;"svcusg"!==b.etype||"tiles"!==b.stype&&"features"!==b.stype||(this._selectedFilter="num");this._convertResultToDataStore(a);return!0}))},_convertResultToDataStore:function(a){a=
c.clone(a);var e=c.mixin([],this._creditFilters),f;this._creditDetailsStore.setData([{id:this.i18n.all,visible:!0,all:!0}]);var d=this._creditDetailsStore.get(this.i18n.all);this._creditDetails=c.mixin({},a&&a.length?a[0]:{});a&&0!==a.length?!a||1!==a.length||a[0].name||a[0].task?(this._creditDetailsStore.setData([{id:this.i18n.all,visible:!0,all:!0}]),c.forEach(e,function(a){d[a]=[]}),c.forEach(a,c.hitch(this,function(a){f=this._postProcessItem(a,this._creditFilters);c.forEach(e,c.hitch(this,function(a){c.forEach(f[a],
c.hitch(this,function(b,c){d[a][c]=(d[a][c]||0)+f[a][c]}));d[a+"_total"]=h.lang.functional.reduce(d[a],"+")}))})),this._creditDetailsStore.put(d)):(this._item=a[0],this._postProcessItem(this._item,e)):this._postProcessItem(d,this._creditFilters)},_combineItems:function(a){if(a&&0!==a.length){var e,f=a[0],d;c.forEach(a,function(a,g){if(0<g)for(d in a)if(a.hasOwnProperty(d)&&c.isArray(a[d]))for(e=0;e<a[d].length;e++)f[d][e][1]=(parseFloat(f[d][e][1])+parseFloat(a[d][e][1])).toString()});return f}},
_queryDate:function(a){var e,f,d,b,g,k,m;return this._fetchCredits(a,this._usageParams).then(c.hitch(this,function(a){this._creditStore.query({}).forEach(c.hitch(this,function(a){c.mixin(a.value,{y:0,units:0,unitNum:0});this._creditStore.put(a)}));c.forEach(a,c.hitch(this,function(a){m=a.stype;this._aggregateCategories[a.stype]&&(m=this._aggregateCategories[a.stype].stype,a.name=this._aggregateCategories[a.stype].label,this._aggregateCategories[m]&&this._aggregateCategories[m].length?this._aggregateCategories[m].push(a):
this._aggregateCategories[m]=[a],c.forEach(this._aggregateCategories[a.stype].filters.split(","),c.hitch(this,function(b){this._aggregateCategories[a.stype][b]=this._sumCredits(a[b])})));if(e=this._creditStore.get(a.etype+"_"+m))g=e.value.f.split("_")[0],b=e.value.f.split("_")[1],b=-1===b.indexOf("byte")?"num":b,d=this._sumCredits(a[g]),d=("stg"===g&&1<a[g].length?d/(a[g].length-1):d)+Number(e.value.unitNum||0),f=this._toFormat(b,d),k=this._sumCredits(a.credits)+(e.value.y||0),c.mixin(e.value,{y:parseInt(k,
10)}),c.mixin(e.value,{units:f,unitNum:d}),this._creditStore.put(e)}));return!0}))},_findMostConsumed:function(){var a=null;this._creditStore.query(function(c){a=a&&a.value&&a.value.y&&a.value.y>c.value.y?a:c});return a},_sumCredits:function(a){a=c.map(a||[],c.hitch(this,function(a){return Number(a[1]||0)}));return parseInt(c.number.round(h.lang.functional.reduce(a,"+")||0,0),10)},_loadData:function(){this._acct.getSelf(c.hitch(this,function(a){this._organization=a;esriGeowConfig.userRole&&!esriGeowConfig.userRole.isAdmin()&&
(window.location="error.html?c\x3dAccessDeniedResource");return new c.DeferredList([this._fetchActiveUserCount().then(c.hitch(this,function(a){this._organization.activeUsers=a;this._buildPage()})),this._fetchUrls().then(c.hitch(this,function(a){this._accountUrls=c.mixin(this._getDefaultAccountUrls(),a&&a.urls||{});c.forEach(["http","https"],c.hitch(this,function(a){c.forEach(this._accountUrls.tiles[a],c.hitch(this,function(d,b){-1<d.indexOf("tiles")&&(this._accountUrls.tiles[a][b]+="/tiles")}))}));
return this._accountUrls}))])}),c.hitch(this,function(a){this._showError(a);throw a;}))},_fetchItem:function(a,c){a={q:this._getServiceUrls(a,c).join(" OR ")};return this._request(this._searchUrl,a)},_getServiceUrls:function(a,e){var f=[],d=-1!==e.indexOf("Feature")?"features":"tiles",b={accountid:this._organization.id,name:a,type:e};c.forEach(["http","https"],c.hitch(this,function(a){c.forEach(this._accountUrls[d][a],c.hitch(this,function(d){f.push(esri.substitute(c.mixin(b,{protocol:a,server:d}),
'url:"${protocol}://${server}/${accountid}/arcgis/rest/services/${name}/${type}"'))}))}));return f},_fetchActiveUserCount:function(){return this._request(this._accountsUri+this._organization.id+"/users",{num:1}).then(c.hitch(this,function(a){return a&&a.total||0}))},_fetchCredits:function(a,e){var f=!1;e&&e.stype&&this._aggregateCategories[e.stype]&&this._aggregateCategories[e.stype].length&&(delete e.stype,e.groupBy="stype, etype",f=!0);a=c.mixin(c.mixin({},a),e);return this._request(this._usageUrl,
a).then(c.hitch(this,function(a){return f?c.filter(a&&a.data,c.hitch(this,function(a){return this._aggregateCategories[a.stype]})):a&&a.data||[]}))},_fetchUrls:function(){return this._request(this._accountsUri+this._organization.id+"/urls")},_buildPage:function(){this._readCookie();this._createOrgDetails(this._organization);this._createTopDiv();this._createBottomDiv();this._dateQuery=this._dateQuery||this._getDateQuery(this._dateQueryIdx);this.onShowStatistics()},_createOrgDetails:function(a){if(a){this._usageUrl=
this._accountsUri+a.id+"/usage";this._thumbnailURL=a.thumbnail?this._accountsUri+"/self/resources/"+a.thumbnail+"?token\x3d"+this._user.token:this.noThumbnail;this._subscriptionInfo=this._organization.subscriptionInfo;this._organization=c.mixin(a,{maxUsers:-1===this._subscriptionInfo.maxUsers?this.i18n.unlimited:this._subscriptionInfo.maxUsers});this._organization.availableCredits=this._formatNumber(this._subscriptionInfo.availableCredits);this._organization.created=c.date.locale.format(new Date(this._organization.created),
{selector:"date",formatLength:"medium"});this._organization.expDate=c.date.locale.format(new Date(this._subscriptionInfo.expDate),{selector:"date",formatLength:"medium"});var e='\x3cli class\x3d"first esriBorderRight1"\x3e\x3cspan class\x3d"label"\x3e${createdLbl}\x3c/span\x3e\x3cspan class\x3d"value"\x3e${created}\x3c/span\x3e\x3c/li\x3e'+(this._subscriptionInfo.state&&"active"===this._subscriptionInfo.state.toLowerCase()&&this._subscriptionInfo.type&&"trial developer"===this._subscriptionInfo.type.toLowerCase()?
"":'\x3cli class\x3d"esriBorderRight1"\x3e\x3cspan class\x3d"label"\x3e${expiresLbl}\x3c/span\x3e\x3cspan class\x3d"value"\x3e${expDate}\x3c/span\x3e\x3c/li\x3e')+'\x3cli class\x3d"esriBorderRight1"\x3e\x3cspan class\x3d"label"\x3e${membersLbl}\x3c/span\x3e\x3cspan class\x3d"value"\x3e${activeUsers}${ofLbl}${maxUsers}\x3c/span\x3e\x3c/li\x3e\x3cli class\x3d"last"\x3e\x3cspan class\x3d"label"\x3e${availableCreditsLbl}\x3c/span\x3e\x3cspan class\x3d"value"\x3e${availableCredits}\x3c/span\x3e\x3c/li\x3e',
f='\x3cimg src\x3d"'+(esriGeowConfig.allSSL?this._thumbnailURL.replace("http:/","https:/"):this._thumbnailURL)+'" align\x3d"center" class\x3d"groupThumbnail"/\x3e ',f=f+a.name;c.place(f,"orgTitle","first");c.attr(this._creditsSummary,"innerHTML",esri.substitute(c.mixin(c.mixin({},this.i18n.usage),this._organization),e));c.attr(c.byId("_state"),"innerHTML",this.i18n.usage.trial);c.style(c.byId("_state"),"display",!this._subscriptionInfo.type||"trial"!==this._subscriptionInfo.type.toLowerCase()&&"trial press"!==
this._subscriptionInfo.type.toLowerCase()?"none":"inline-block")}},_createTopDiv:function(){this._createCreditsTable();this._prepareDateQueries(this._organization.created);this._selectDate=new l.form.Select({style:"width:150px;",options:this._dateQueriesStore.data},this._selectDate);this._selectDate._onChangeActive=!1;this._selectDate.set("value",this._dateQueryIdx||"last24hours",!0);this._selectDate._onChangeActive=!0;this._creditFilters=c.map(this._creditFilterOptions,"return item.value");this._connects.push(c.connect(this._selectDate,
"onChange",this,"onDateRangeChange"));this._connects.push(c.connect(this._customStart,"onChange",c.hitch(this,this.onCustomDateClick,"s")));this._connects.push(c.connect(this._customEnd,"onChange",c.hitch(this,this.onCustomDateClick,"e")));this._connects.push(c.connect(window,"onbeforeunload",this,"_writeCookie"))},_createBottomDiv:function(){this._selectCredit=new l.form.Select({style:"width:150px;",options:this._creditFilterOptions},this._selectCredit);this._selectTask=new l.form.Select({style:"width:150px;",
options:[{label:"Map Draws",value:"export"},{label:"Map Queries",value:"infographic"}]},this._selectTask);this._storageTask=new l.form.Select({style:"width:150px;",options:[{label:this.i18n.task_db,value:"db"},{label:this.i18n.task_file,value:"file"}]},this._storageTask);this._createLineChart(this._detailsGraph);this._createDetailsTable();c.attr(this._creditDetailsLbl,"innerHTML",this.i18n.stg_tiles);c.query(".details").style("display","none");this._lineChart.resize({w:"900"});this._connects.push(c.on(this._selectCredit,
"change",c.hitch(this,"onCreditFilterChange")));this._connects.push(c.on(this._selectTask,"change",c.hitch(this,"onTaskFilterChange")));this._connects.push(c.on(this._storageTask,"change",c.hitch(this,"onTaskFilterChange")))},_createPieChart:function(){this._creditChart||(this._creditChart=new h.charting.Chart2D(this._creditsGraph),this._creditChart.addPlot("default",{type:"Pie",radius:160,font:"normal 10pt Verdana",fontColor:"#fff",labelOffset:45}),this._creditChart.addSeries("Categories",new h.charting.StoreSeries(this._creditStore,
{},"value")),new h.charting.action2d.Tooltip(this._creditChart,"default",{text:c.hitch(this,function(a){a=a.run&&a.run.data&&a.run.data[a.index];return a.categ+": \x3ci\x3e"+a.y+" "+this.i18n.credits+"\x3c/i\x3e"})}),new h.charting.action2d.MoveSlice(this._creditChart,"default"),this._creditChart.render(),this._creditChart.connectToPlot("default",c.hitch(this,function(a){var e=a.type;"onclick"===e?(a=a.run.data[a.index]&&a.run.data[a.index].id,this.onCreditCategoryClick(a)):"onmouseover"===e?c.style(this.domNode,
"cursor","pointer"):"onmouseout"===e&&c.style(this.domNode,"cursor","default")})))},_createCreditsTable:function(){var a;a="\x3ctable class\x3d'creditsTable esriFloatTrailing' cellspacing\x3d3 cellpadding\x3d3 border\x3d0\x3e"+('\x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3c/td\x3e\x3ctd class\x3d"colhead esriAlignTrailing"\x3e'+this.i18n.units+'\x3c/td\x3e\x3ctd class\x3d"colhead esriAlignTrailing"\x3e'+this.i18n.credits+"\x3c/td\x3e\x3c/tr\x3e");a+=this._createCategory(this.i18n.storage,["stg_tiles","stg_features",
"stg_portal"]);a+=this._createCategory(this.i18n.analytics,"geocodecnt_geocode svcusg_geoenrich svcusg_geotrigger svcusg_routing svcusg_spanalysis svcusg_elevanalysis".split(" "));a+=this._createCategory(this.i18n.premium,["svcusg_demogmaps"]);a+=this._createCategory(this.i18n.published,["svcusg_tiles","svcusg_features","tilegencnt_tiles"]);a+="\x3ctr\x3e\x3ctd class\x3d'creditssum esriAlignTrailing' colspan\x3d4 height\x3d50\x3e"+esri.substitute({total:0},this.i18n.total)+"\x3c/tr\x3e";c.attr(this._creditsTable,
"innerHTML",a+"\x3c/table\x3e");c.query(".catlink").connect("onclick",this,c.hitch(this,function(a){a.preventDefault();this._selectedCategory=a.currentTarget.hash.substring(1);this.onCreditCategoryClick(this._selectedCategory)}))},_createCategory:function(a,e){var f="\x3ctr\x3e\x3ctd class\x3d'categ' colspan\x3d3 height\x3d40\x3e"+a+"\x3c/td\x3e\x3c/tr\x3e";c.forEach(e,c.hitch(this,function(a){f+=esri.substitute(c.mixin({id:a},this._creditStore.get(a).value),"\x3ctr class\x3d'categRow'\x3e\x3ctd class\x3d'chip' style\x3d'background-color:${fill}'\x3e\x26nbsp;\x3c/td\x3e\x3ctd\x3e\x3ca class\x3d'catlink' href\x3d'#${id}'\x3e${categ}\x3c/a\x3e\x3c/td\x3e\x3ctd class\x3d'esriAlignTrailing ${id}_u'\x3e${units}\x3c/td\x3e\x3ctd class\x3d'${id} esriAlignTrailing'\x3e${y}\x3c/td\x3e\x3c/tr\x3e")}));
return f},_createDetailsTable:function(){var a={visible:dgrid.editor({label:" ",autoSave:!0,sortable:!1},"checkbox"),name:{label:this.i18n.itemName,formatter:c.hitch(this,"_toLink")},num_total:{label:this.i18n.num},credits_total:{label:this.i18n.credits},bw_total:{label:this.i18n.bw,formatter:c.hitch(this,"_toFormat","mbyte")}};this._grid=new (c.declare([dgrid.OnDemandGrid,dgrid.extensions.ColumnResizer,dgrid.Keyboard]))({store:this._creditDetailsStore,columns:a,sort:"num_total",query:function(a){return!!a.name}},
c.create("div",{},this._detailsTable));this._grid.styleColumn("num_total","display: none;");this._grid.styleColumn("bw_total","display: none;");this._grid.on(".dgrid-cell:click",c.hitch(this,function(a){a=this._grid.cell(a);if("name"===a.column.field&&a.row&&a.row.data){var e=a.row.data,d;e.stype&&!this._aggregateCategories[e.stype]&&"geoenrich"!==this.stype&&"spanalysis"!==this.stype&&"elevanalysis"!==this.stype&&"demogmaps"!==this.stype&&"geotrigger"!==this.stype&&this._fetchItem(e.name,-1!==this._selectedCategory.indexOf("_features")?
"FeatureServer":"MapServer").then(c.hitch(this,function(a){a&&a.results&&a.results.length&&(d=c.filter(a.results,c.hitch(this,function(a){if(a&&(a.title===e.name||a.title===this._convertUnderscores(e.name))||a.name===e.name||a.name===this._convertUnderscores(e.name))return a})));d&&d.length?window.location="item.html?id\x3d"+d[0].id:this._showError({message:this.i18n.serviceNotFound})}))}}))},_convertUnderscores:function(a){return a?a.replace(/_/g," "):a},_setFilterOptions:function(a){var e=this._getCreditLabel(a);
this._selectCredit.set("options",this._creditFilterOptions);this._selectCredit.removeOption("stg");this._selectCredit.removeOption("bw");"stg_features"===a?(this._selectCredit.removeOption("num"),this._selectCredit.addOption(this._creditFilterOptions[3])):"svcusg_tiles"!==a&&"svcusg_features"!==a||this._selectCredit.addOption(this._creditFilterOptions[2]);this._creditFilterOptions[1].label=e;this._grid.column("num_total").label=e;this._grid.setColumns(this._grid.columns);this._selectCredit.set("value",
this._selectedFilter||"credits");c.query(".filter").style("display",-1!==this._selectedCategory.indexOf("stg")?"none":"block");"demogmaps"===this.stype?(c.style(this._creditSelect,"display",""),c.style(this._creditSelect,"float","left"),c.style(this._deomgmapsTaskSelect,"display","block"),c.style(this._storageTaskSelect,"display","none")):"stg_features"===a?(c.query(".filter").style("display","block"),c.style(this._deomgmapsTaskSelect,"display","none"),c.style(this._creditSelect,"display",""),c.style(this._creditSelect,
"float","left"),c.style(this._storageTaskSelect,"display","block")):(c.style(this._deomgmapsTaskSelect,"display","none"),c.style(this._storageTaskSelect,"display","none"),c.style(this._creditSelect,"display",""),c.style(this._creditSelect,"float","none"))},_getCreditLabel:function(a){a=this._creditStore.get(a);return this.i18n["num_"+a.value.f.split("_")[1]]||this.i18n.num},_updateLineChart:function(a,c){this._updateLineChartY(a);this._updateLineChartX(a);this._lineChart.setSeriesOrder(this._seriesOrder);
c.series=a.series;a.render();c.refresh()},_updateLineChartY:function(a){var e,f=this._selectCredit.get("value");this._creditDetailsStore.query(c.hitch(this,function(d){d.visible?(e=this._getYAxis(d.id,f),d.id===this.i18n.all&&a.addAxis("y",{min:e.min,max:e.max,vertical:!0}),a.getSeries(d.id)?a.updateSeries(d.id,e.data):(a.addSeries(d.id,e.data,d.id===this.i18n.all?{stroke:{color:"black"},fill:"black"}:{}),this._seriesOrder.unshift(d.id))):(a.removeSeries(d.id),d=c.indexOf(this._seriesOrder,d.id),
-1!==d&&this._seriesOrder.splice(d,1))}))},_updateLineChartX:function(a){var c=this._getXAxis(this._dateQuery);a.addAxis("x",{min:c.min,max:c.max,labels:c.data||[]})},_getTotalCredits:function(){var a=0;this._creditStore.query().forEach(function(c){a+=c.value.y||0});c.query(".nodatapie").style("display",a?"none":"block");c.query(".creditGraph").style("display",a?"block":"none");return this._formatNumber(a)},_readCookie:function(){this._dateQueryIdx=(this._cookie=(this._cookie=this._util.getCookie("ESRI_Content"))&&
this._cookie.organizationStatus)&&this._cookie.dateQuery||"last24hours";"custom"===this._dateQueryIdx&&(this._cookie.startTime&&this._cookie.endTime&&this._cookie.period?(this._dateQuery={startTime:this._cookie.startTime,endTime:this._cookie.endTime,period:this._cookie.period},this.onDateRangeChange(this._dateQueryIdx,!0)):this._dateQueryIdx="last24hours");this._selectedCategory=this._cookie&&this._cookie.category||this._findMostConsumed().value.id;this._selectedFilter=this._cookie&&this._cookie.filter||
"credits";this._selectedServices=this._cookie&&this._cookie.services&&this._cookie.services.split(",")||null},_writeCookie:function(){var a=this._creditDetailsStore.query({visible:!0}).map(function(a){return a.id}),e=this._selectDate.get("value");this._cookie=(this._cookie=this._util.getCookie("ESRI_Content"))||{};this._cookie.organizationStatus={dateQuery:e,category:this._selectedCategory,filter:this._selectCredit.get("value"),services:a.join(",")};"custom"===e&&(this._cookie.organizationStatus=
c.mixin(this._cookie.organizationStatus,this._dateQuery));c.cookie("ESRI_Content",c.json.stringify(this._cookie),{path:"/"})},_toLink:function(a){var c=this._selectedCategory&&this._selectedCategory.split("_")[1]||"";return this._aggregateCategories[c]||"geoenrich"===this.stype||"spanalysis"===this.stype||"elevanalysis"===this.stype||"demogmaps"===this.stype||"geotrigger"===this.stype?a:"\x3ca onclick\x3d'return false;' href\x3d'#'\x3e"+a+"\x3c/a\x3e"},_initHelpMgr:function(){var a=arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance(),
e=setInterval(c.hitch(this,function(){if(a.isLoaded()){clearInterval(e);var f=a.getHelpUrl("120000503");c.query(".helpLink").attr("href",f)}}),200)},_getDefaultAccountUrls:function(){var a=esriGeowConfig.portalHostname,c="",f={features:{http:[],https:[]},tiles:{http:[],https:[]}};-1!==a.indexOf("dev")?c="dev":-1!==a.indexOf("qa")&&(c="qa");f.features.http.push("services"+c+".arcgis.com");f.features.https.push("services"+c+".arcgis.com");f.tiles.http.push("tiles"+c+".arcgis.com");f.tiles.https.push("tiles"+
c+".arcgis.com");return f},_request:function(a,e){e=c.mixin(e||{},this._requestParams);return this._util.request({url:a,content:e}).then(c.hitch(this,function(a){return a.error?this._showError(a.error):a}),c.hitch(this,function(a){this._showError(a);throw Error();}))},_showError:function(a){a=a.error||a||{};a.code=a.code||0;a=c.mixin(c.mixin({},this.i18n.errors.error),a);this._errorDlg.show(a)}})})},"dojox/charting/StoreSeries":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred"],
function(c,l,h){return l("dojox.charting.StoreSeries",null,{constructor:function(a,c,f){this.store=a;this.kwArgs=c;this.value=f?"function"==typeof f?f:"object"==typeof f?function(a){var b={},d;for(d in f)b[d]=a[f[d]];return b}:function(a){return a[f]}:function(a){return a.value};this.data=[];this._initialRendering=!0;this.fetch()},destroy:function(){this.observeHandle&&this.observeHandle.remove()},setSeriesObject:function(a){this.series=a},fetch:function(a,e){function f(){d.data=c.map(d.objects,function(a){return d.value(a,
d.store)});d._pushDataChanges()}var d=this;this.observeHandle&&this.observeHandle.remove();a=this.store.query(a||this.kwArgs.query,e||this.kwArgs);h.when(a,function(a){d.objects=a;f()});a.observe&&(this.observeHandle=a.observe(f,!0))},_pushDataChanges:function(){this.series&&(this.series.chart.updateSeries(this.series.name,this,this._initialRendering),this._initialRendering=!1,this.series.chart.delayedRender())}})})},"arcgisonline/sharing/dijit/dialog/_UsageDlgMixin":function(){define(["dojo","dijit",
"dojox","dojo/require!dojox/lang/functional,dojo/store/Observable,dojo/store/Memory,dojox/charting/StoreSeries,dojox/charting/widget/Chart2D,dojox/charting/themes/ThreeD,dojox/charting/action2d/MouseZoomAndPan,dojox/charting/action2d/TouchZoomAndPan,dojox/charting/action2d/MouseIndicator,dojo/on,dojo/mouse"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog._UsageDlgMixin");c.require("dojox.lang.functional");c.require("dojo.store.Observable");c.require("dojo.store.Memory");c.require("dojox.charting.StoreSeries");
c.require("dojox.charting.widget.Chart2D");c.require("dojox.charting.themes.ThreeD");c.require("dojox.charting.action2d.MouseZoomAndPan");c.require("dojox.charting.action2d.TouchZoomAndPan");c.require("dojox.charting.action2d.MouseIndicator");c.require("dojo.on");c.require("dojo.mouse");c.declare("arcgisonline.sharing.dijit.dialog._UsageDlgMixin",null,{_prepareStores:function(){this._dateQueries=[{id:"last24hours",selected:!0,label:this.i18n.last24Hours,value:"last24hours"},{id:"last7days",label:this.i18n.last7Days,
value:"last7days"},{id:"last30days",label:this.i18n.last30Days,value:"last30days"},{id:"curmo",label:this.i18n.currentMonth,value:"curmo",param:{startTime:this._getFirstDay(),endTime:this._getToday(),period:(new Date).getDate()-1+"d"}}];this._creditFilterOptions="views"===this.stype?[{label:this.i18n.views,value:"num"}]:[{label:this.i18n.num,value:"num"},{label:this.i18n.stg,value:"stg"}];this._startQueryDate=new Date((new Date).setDate((new Date(this._getToday())).getDate()-60));this._dataCollectionStartDate=
new Date(this._startQueryDate);this._dateQueriesStore=new c.store.Memory({data:{identifier:"id",items:this._dateQueries}});this._creditDetailsStore=new c.store.Observable(new c.store.Memory({data:{label:"alias",identifier:"id",items:[]}}));this._seriesOrder=[];this._isAdmin=(this._currentUser=this._util.getUser())&&this._currentUser.accountId&&"account_admin"===this._currentUser.role},_prepareDateQueries:function(a){a=new Date(this._getFirstDay(new Date(a)));a=a>=this._dataCollectionStartDate?a:this._dataCollectionStartDate;
var e=new Date,f;f={};for(e.setMonth(e.getMonth()-1);a<e;)"ja"===c.locale?(f=c.date.locale.format(e,{selector:"date",formatLength:"long"}),f=f.substr(0,8<e.getMonth()?8:7)):f=c.date.locale.format(e,{selector:"date",formatLength:"short",datePattern:"MMMM_yyy"}),f={id:f,label:f.replace("_"," "),value:f,param:{startTime:this._getFirstDay(e),endTime:this._getLastDay(e),period:"1d"}},this._dateQueriesStore.put(f),e.setMonth(e.getMonth()-1);this._dateQueriesStore.put({id:"custom",label:this.i18n.customDates,
value:"custom"})},_getDateQuery:function(a){var e=null;switch(a){case "last24hours":e=c.mixin(this._getTime(24,"h"),{period:"1h"});break;case "last7days":e=c.mixin(this._getTime(7,"d"),{period:"1d"});break;case "last30days":e=c.mixin(this._getTime(30,"d"),{period:"1d"});break;case "curmo":e={startTime:this._getFirstDay(),endTime:this._getGMTEndToday(),period:"1d"};break;default:e=this._dateQueriesStore.get(a).param}return e},_getGMTEndToday:function(){var a=new Date((new Date).getTime()+6E4*(new Date).getTimezoneOffset()),
a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));a.setTime(a.getTime()+864E5);return a.getTime()},_getTime:function(a,c,f){var d=f||new Date;f=new Date(d);d=new Date(d);"d"===c?(d=this._getGMTEndToday(),f=new Date(d-864E5*a)):"h"===c&&f.setHours(d.getHours()-a+1);return{startTime:(new Date(f)).getTime(),endTime:(new Date(d)).getTime()}},_getFirstDay:function(a){a=a||new Date;return Date.UTC(a.getFullYear(),a.getMonth(),1)},_getLastDay:function(a){a=a||new Date;return Date.UTC(a.getFullYear(),
a.getMonth()+1,1)},_getToday:function(a){a=a||new Date;return(new Date(a.getFullYear(),a.getMonth(),a.getDate()+1,0,0,0,-1)).getTime()},_getXAxisLabel:function(a,e){var f=a=new Date(a+6E4*(new Date).getTimezoneOffset());-1<e.indexOf("m")?f=c.date.locale.format(a,{selector:"date",formatLength:"short",datePattern:"MMMM"}):-1<e.indexOf("d")?f=this._formatDayLabel(a):-1<e.indexOf("h")&&(f=c.date.locale.format(a,{selector:"date",formatLength:"short",datePattern:"k"}));return f},_getXAxis:function(a){var e=
new Date(a.startTime+6E4*(new Date).getTimezoneOffset()),f=new Date(a.endTime+6E4*(new Date).getTimezoneOffset());a=a.period;var d=1,b=[];if(!(-1<a.indexOf("y")))if(-1<a.indexOf("m"))for(;e<=f;)b.push({value:c.date.locale.format(e,{selector:"date",formatLength:"short",datePattern:"MMMM"})}),e.setMonth(e.getMonth()+1);else if(-1<a.indexOf("d"))for(f=f.setDate(f.getDate()+1);e<=f;)b.push({value:d++,text:this._formatDayLabel(e)}),e.setDate(e.getDate()+1);else if(-1<a.indexOf("h"))for(f=f.setHours(f.getHours()+
1);e<=f;)b.push({value:d++,text:c.date.locale.format(e,{selector:"date",formatLength:"short",datePattern:"k"})}),e.setHours(e.getHours()+1);return{data:b,max:b.length,min:1}},_formatDayLabel:function(a){var e=c.date.locale.format(a,{selector:"date",formatLength:"short",datePattern:"d"});a=c.date.locale.format(a,{selector:"date",formatLength:"short",datePattern:"EEE"});return e+(c.isIE||7<=c.has("trident")&&void 0===c.isIE?" - ":"\x3cbr/\x3e")+a},_getYAxis:function(a,e){a=this._creditDetailsStore.get(a);
var f;a=a&&a[e]||[];"bw"===e&&(a=c.map(a,function(a){return a?c.number.round(a/1048576,3):0}));f=1.1*h.lang.functional.reduce(a,"Math.max(a,b)")||1;e=h.lang.functional.reduce(a,"Math.min(a,b)")||0;return{data:a,max:1>f?1:f,min:1>e?0:e}},_postProcessItem:function(a,e){a.id=a.name||this.i18n.all;c.forEach(e,c.hitch(this,function(e){a[e]=c.map(a[e],"return dojo.number.round(Number(item[1] || 0), 2);");a[e+"_total"]=c.number.round(h.lang.functional.reduce(a[e],"+")||0,2)}));e=this._creditDetailsStore.get(a.id);
a=c.mixin(e,a);a.visible=a.visible||this._selectedServices&&-1!==c.indexOf(this._selectedServices,a.id)||!1;this._creditDetailsStore.put(a);return a},_clearUsageChart:function(){this._uChart&&(this._onMouseIndicatorChange.remove(),this._mouseIndicatorTooltip.close(),this._mouseIndicatorTooltip.destroy(),this._mouseIndicator.destroy(),this._uChart.destroy(),this._uChart=null)},_createUsageChart:function(a,e,f,d){this._uChart&&(this._onMouseOut.remove(),this._onMouseIndicatorChange.remove(),this._mouseIndicatorTooltip.close(),
this._mouseIndicatorTooltip.destroy(),this._mouseIndicator.destroy(),this._uChart.destroy(),this._uChart=null);var b=[],g=[],k=0;c.forEach(a[0][e],c.hitch(this,function(a){b.push(this._getXAxisLabel(Number(a[0]),f.period));g.push(Number(a[1]));Number(a[1])>k&&(k=Number(a[1]))}));var m=this._uChart=new h.charting.Chart2D(d);m.addPlot("default",{type:h.charting.plot2d.Lines,markers:!0});m.addAxis("x",{includeZero:!1,labels:b,minorTicks:!1,fontColor:"#A6A6A6",font:"normal normal normal 1.0em 'Lucida Grande', 'Segoe UI', 'Arial', sans-serif",
majorTickStep:1,stroke:{color:"#D5D5D5",width:1},max:b.length+.5,labelFunc:c.hitch(this,function(a,d){return b[d-1]||" "})});m.addAxis("y",{vertical:!0,leftBottom:!0,includeZero:!0,majorLabels:!0,minorTicks:!1,minorLabels:!1,natural:!0,font:"normal normal normal 1.0em 'Lucida Grande', 'Segoe UI', 'Arial', sans-serif",fontColor:"#A6A6A6",max:Number(k+2)});m.addSeries("Series A",g,{stroke:{color:"#D4D4D4",width:2},fill:"#56A5DB"});this._mouseIndicator=new h.charting.action2d.MouseIndicator(m,"default",
{series:"Series A",lines:!1,labels:!1,markers:!1,start:!1,stroke:{type:"stroke",color:"#56A5DB",width:2},fill:"#56A5DB",fontColor:"#FFFFFF",markerFill:"#A6A6A6",markerOutline:{type:"stroke",color:"#56A5DB",width:2},mouseOver:!0});this._mouseIndicatorTooltip=new l.Tooltip;this._onMouseIndicatorChange=c.on(this._mouseIndicator,"Change",c.hitch(this,function(b){if(b.label){var d=m.getPlot("default").toPage({x:b.start.x,y:p});d.w=1;d.h=1;this._mouseIndicatorTooltip.label=this._formatValue(b.start.y,a[0][e][b.start.x-
1][0]);this._mouseIndicatorTooltip.position=["above-centered"];q?(l.Tooltip._masterTT.containerNode.innerHTML=this._mouseIndicatorTooltip.label,l.place.around(l.Tooltip._masterTT.domNode,d,["above-centered"])):(q=!0,this._mouseIndicatorTooltip.open(d))}else this._mouseIndicatorTooltip.close(),q=!1}));m.render();var p=m.getAxis("y").getScaler().bounds.to,q=!1;this._onMouseOut=c.on(d,c.mouse.leave,c.hitch(this,function(a){this._mouseIndicatorTooltip.close();q=!1}))},_createLineChart:function(a){this._lineChart=
(new h.charting.Chart2D(a)).setTheme(h.charting.themes.ThreeD).addAxis("y",{min:0,max:1,vertical:!0}).addPlot("default",{type:"Lines",markers:!0,tension:"S"});new h.charting.action2d.Tooltip(this._lineChart,"default",{text:c.hitch(this,function(a){var e,d=a.run&&a.run.data&&a.run.data[a.index],b=this._selectCredit?this._selectCredit.get("value"):"",g=this._creditDetails;g[b]&&g[b][a.index]&&g[b][a.index].length&&(e=new Date(parseInt(g[b][a.index][0],10)+6E4*(new Date).getTimezoneOffset()),e.setDate(e.getDate()));
g.stype=g.stype||this.stype;a=-1!==g.stype.indexOf("routing")?"routes":-1!==g.stype.indexOf("geocode")?"locations":-1!==g.stype.indexOf("tiles")?"tiles":-1!==g.stype.indexOf("features")?"features":-1!==g.stype.indexOf("demogmaps")?"maps":-1!==g.stype.indexOf("geoenrich")?"queries":-1!==g.stype.indexOf("views")?"viewstooltip":"";return this._formatCreditTooltip(b,c.number.format(d,{pattern:"#,###,###,###.##"}),e,a)})});new h.charting.action2d.Magnify(this._lineChart,"default");esri.isTouchEnabled?
new h.charting.action2d.TouchZoomAndPan(this._lineChart,"default"):new h.charting.action2d.MouseZoomAndPan(this._lineChart,"default");this._lineChart.render();this._lineLegend=new h.charting.widget.Legend({"class":"legend details esriFloatLeading",chart:this._lineChart,horizontal:2,outline:!1},this._lineLegend);return this._lineChart},_formatValue:function(a,e){var f=this._selectCredit?this._selectCredit.get("value"):"",d=this._creditDetails;e&&(e=new Date(Number(e)+6E4*(new Date).getTimezoneOffset()),
e.setDate(e.getDate()));d.stype=d.stype||this.stype;d=-1!==d.stype.indexOf("routing")?"routes":-1!==d.stype.indexOf("geocode")?"locations":-1!==d.stype.indexOf("tiles")?"tiles":-1!==d.stype.indexOf("features")?"features":-1!==d.stype.indexOf("demogmaps")?"maps":-1!==d.stype.indexOf("geoenrich")?"queries":-1!==d.stype.indexOf("views")?"viewstooltip":"";return this._formatCreditTooltip(f,c.number.format(a,{pattern:"#,###,###,###.##"}),e,d)},_formatCreditTooltip:function(a,e,f,d){var b;f&&(b=c.date.locale.format(f,
{datePattern:"yyyy-MM-dd",selector:"date"})+" GMT");"bw"===a?e=esri.substitute({units:e},this.i18n.mbyte):"num"===a?e=esri.substitute({units:e},this.i18n[d]||this.i18n.requeststooltip):"credits"===a?e=esri.substitute({units:e},this.i18n.creditstooltip):"views"===a&&(e=esri.substitute({units:e},this.i18n.viewstooltip));return'\x3cdiv style\x3d"text-align: center"\x3e'+e+(b?"\x3cbr /\x3e"+b:"")+"\x3c/div\x3e"},_formatNumber:function(a){return c.number.format(parseInt(a,10),{pattern:"#,###,###,##0"})},
_formatBytes:function(a,e){return c.number.format(e/("mbyte"===a?1048576:1073741824),{pattern:"#,###,###,###.##"})},_toFormat:function(a,c){if(c)return"num"===a?this._formatNumber(c):this._formatBytes(a,c)},_resetLineChart:function(){for(var a in this._lineChart.runs)this._lineChart.removeSeries(a)}})})},"dojox/charting/widget/Chart2D":function(){define("dojo/_base/kernel dojo/_base/lang ./Chart ../Chart2D ../action2d/Highlight ../action2d/Magnify ../action2d/MoveSlice ../action2d/Shake ../action2d/Tooltip".split(" "),
function(c,l,h){c.deprecated("dojox.charting.widget.Chart2D","Use dojo.charting.widget.Chart instead and require all other components explicitly","2.0");return l.setObject("dojox.charting.widget.Chart2D",h)})},"dojox/charting/widget/Chart":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/_base/declare dojo/query dijit/_WidgetBase ../Chart dojo/has dojo/has!dojo-bidi?../bidi/widget/Chart dojox/lang/utils dojox/lang/functional dojox/lang/functional/lambda".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q){var n,r,v,u,w,t=function(a){return a},y=l.getObject("dojox.charting");n=function(a,b,d){var c=eval("("+b+".prototype.defaultParams)"),e,f;for(e in c)e in d||(f=a.getAttribute(e),d[e]=m.coerceType(c[e],null==f||"undefined"==typeof f?c[e]:f));b=eval("("+b+".prototype.optionalParams)");for(e in b)e in d||(f=a.getAttribute(e),null!=f&&(d[e]=m.coerceType(b[e],f)))};r=function(a){var b=a.getAttribute("name"),d=a.getAttribute("type");if(!b)return null;var b={name:b,kwArgs:{}},
e=b.kwArgs;if(d){y.axis2d[d]&&(d=c._scopeName+"x.charting.axis2d."+d);var f=eval("("+d+")");f&&(e.type=f)}else d=c._scopeName+"x.charting.axis2d.Default";n(a,d,e);if(e.font||e.fontColor)e.tick||(e.tick={}),e.font&&(e.tick.font=e.font),e.fontColor&&(e.tick.fontColor=e.fontColor);return b};v=function(a){var b=a.getAttribute("name"),d=a.getAttribute("type");if(!b)return null;var b={name:b,kwArgs:{}},e=b.kwArgs;if(d){y.plot2d&&y.plot2d[d]&&(d=c._scopeName+"x.charting.plot2d."+d);var f=eval("("+d+")");
f&&(e.type=f)}else d=c._scopeName+"x.charting.plot2d.Default";n(a,d,e);var d=eval("("+d+".prototype.baseParams)"),g;for(g in d)g in e||(f=a.getAttribute(g),e[g]=m.coerceType(d[g],null==f||"undefined"==typeof f?d[g]:f));return b};u=function(a){var b=a.getAttribute("plot"),d=a.getAttribute("type");b||(b="default");var b={plot:b,kwArgs:{}},e=b.kwArgs;if(d){y.action2d[d]&&(d=c._scopeName+"x.charting.action2d."+d);var f=eval("("+d+")");if(!f)return null;b.action=f}else return null;n(a,d,e);return b};w=
function(b){b=l.partial(a.get,b);var d=b("name");if(!d)return null;var d={name:d,kwArgs:{}},c=d.kwArgs,e;e=b("plot");null!=e&&(c.plot=e);e=b("marker");null!=e&&(c.marker=e);e=b("stroke");null!=e&&(c.stroke=eval("("+e+")"));e=b("outline");null!=e&&(c.outline=eval("("+e+")"));e=b("shadow");null!=e&&(c.shadow=eval("("+e+")"));e=b("fill");null!=e&&(c.fill=eval("("+e+")"));e=b("font");null!=e&&(c.font=e);e=b("fontColor");null!=e&&(c.fontColor=eval("("+e+")"));e=b("legend");null!=e&&(c.legend=e);e=b("data");
if(null!=e)return d.type="data",d.data=e?h.map(String(e).split(","),Number):[],d;e=b("array");if(null!=e)return d.type="data",d.data=eval("("+e+")"),d;e=b("store");if(null!=e){d.type="store";d.data=eval("("+e+")");e=b("field");d.field=null!=e?e:"value";if(e=b("query"))c.query=e;if(e=b("queryOptions"))c.queryOptions=eval("("+e+")");if(e=b("start"))c.start=Number(e);if(e=b("count"))c.count=Number(e);if(e=b("sort"))c.sort=eval("("+e+")");if(e=b("valueFn"))c.valueFn=q.lambda(e);return d}return null};
d=e(g("dojo-bidi")?"dojox.charting.widget.NonBidiChart":"dojox.charting.widget.Chart",d,{theme:null,margins:null,stroke:void 0,fill:void 0,buildRendering:function(){this.inherited(arguments);var a=this.domNode,d=f("\x3e .axis",a).map(r).filter(t),c=f("\x3e .plot",a).map(v).filter(t),e=f("\x3e .action",a).map(u).filter(t),g=f("\x3e .series",a).map(w).filter(t);a.innerHTML="";var k=this.chart=new b(a,{margins:this.margins,stroke:this.stroke,fill:this.fill,textDir:this.textDir});this.theme&&k.setTheme(this.theme);
d.forEach(function(a){k.addAxis(a.name,a.kwArgs)});c.forEach(function(a){k.addPlot(a.name,a.kwArgs)});this.actions=e.map(function(a){return new a.action(k,a.plot,a.kwArgs)});p.foldl(g,function(a,b){if("data"==b.type)k.addSeries(b.name,b.data,b.kwArgs),a=!0;else{k.addSeries(b.name,[0],b.kwArgs);var d={};m.updateWithPattern(d,b.kwArgs,{query:"",queryOptions:null,start:0,count:1},!0);b.kwArgs.sort&&(d.sort=l.clone(b.kwArgs.sort));l.mixin(d,{onComplete:function(a){if("valueFn"in b.kwArgs){var d=b.kwArgs.valueFn;
a=h.map(a,function(a){return d(b.data.getValue(a,b.field,0))})}else a=h.map(a,function(a){return b.data.getValue(a,b.field,0)});k.addSeries(b.name,a,b.kwArgs).render()}});b.data.fetch(d)}return a},!1)&&k.render()},destroy:function(){this.chart.destroy();this.inherited(arguments)},resize:function(a){this.chart.resize.apply(this.chart,arguments)}});return g("dojo-bidi")?e("dojox.charting.widget.Chart",[d,k]):d})},"dojox/charting/action2d/Magnify":function(){define("dojo/_base/connect dojo/_base/declare ./PlotAction dojox/gfx/matrix dojox/gfx/fx dojo/fx dojo/fx/easing".split(" "),
function(c,l,h,a,e,f,d){return l("dojox.charting.action2d.Magnify",h,{defaultParams:{duration:400,easing:d.backOut,scale:2},optionalParams:{},constructor:function(a,d,c){this.scale=c&&"number"==typeof c.scale?c.scale:2;this.connect()},process:function(b){if(b.shape&&b.type in this.overOutEvents&&"cx"in b&&"cy"in b&&"spider_plot"!=b.element&&"spider_poly"!=b.element){var d=b.run.name,k=b.index,m=[],p,q,n;d in this.anim?p=this.anim[d][k]:this.anim[d]={};p?p.action.stop(!0):this.anim[d][k]=p={};"onmouseover"==
b.type?(q=a.identity,n=this.scale):(q=a.scaleAt(this.scale,b.cx,b.cy),n=1/this.scale);q={shape:b.shape,duration:this.duration,easing:this.easing,transform:[{name:"scaleAt",start:[1,b.cx,b.cy],end:[n,b.cx,b.cy]},q]};b.shape&&m.push(e.animateTransform(q));b.outline&&(q.shape=b.outline,m.push(e.animateTransform(q)));b.shadow&&(q.shape=b.shadow,m.push(e.animateTransform(q)));m.length?(p.action=f.combine(m),"onmouseout"==b.type&&c.connect(p.action,"onEnd",this,function(){this.anim[d]&&delete this.anim[d][k]}),
p.action.play()):delete this.anim[d][k]}}})})},"dojox/charting/action2d/MoveSlice":function(){define("dojo/_base/connect dojo/_base/declare dojo/_base/array ./PlotAction dojo/fx/easing dojox/gfx/matrix dojox/gfx/fx dojox/lang/functional dojox/lang/functional/scan dojox/lang/functional/fold".split(" "),function(c,l,h,a,e,f,d,b){return l("dojox.charting.action2d.MoveSlice",a,{defaultParams:{duration:400,easing:e.backOut,scale:1.05,shift:7},optionalParams:{},constructor:function(a,b,d){d||(d={});this.scale=
"number"==typeof d.scale?d.scale:1.05;this.shift="number"==typeof d.shift?d.shift:7;this.connect()},process:function(a){if(a.shape&&"slice"==a.element&&a.type in this.overOutEvents){if(!this.angles){var e=f._degToRad(a.plot.opt.startAngle);this.angles="number"==typeof a.run.data[0]?b.map(b.scanl(a.run.data,"+",0),"* 2 * Math.PI / this",b.foldl(a.run.data,"+",0)):b.map(b.scanl(a.run.data,"a + b.y",0),"* 2 * Math.PI / this",b.foldl(a.run.data,"a + b.y",0));this.angles=h.map(this.angles,function(a){return a+
e})}var g=a.index,p,q,n,r,l;p=(this.angles[g]+this.angles[g+1])/2;var u=f.rotateAt(-p,a.cx,a.cy),w=f.rotateAt(p,a.cx,a.cy);(p=this.anim[g])?p.action.stop(!0):this.anim[g]=p={};"onmouseover"==a.type?(r=0,l=this.shift,q=1,n=this.scale):(r=this.shift,l=0,q=this.scale,n=1);p.action=d.animateTransform({shape:a.shape,duration:this.duration,easing:this.easing,transform:[w,{name:"translate",start:[r,0],end:[l,0]},{name:"scaleAt",start:[q,a.cx,a.cy],end:[n,a.cx,a.cy]},u]});"onmouseout"==a.type&&c.connect(p.action,
"onEnd",this,function(){delete this.anim[g]});p.action.play()}},reset:function(){delete this.angles}})})},"dojox/charting/action2d/Shake":function(){define("dojo/_base/connect dojo/_base/declare ./PlotAction dojo/fx dojo/fx/easing dojox/gfx/matrix dojox/gfx/fx".split(" "),function(c,l,h,a,e,f,d){return l("dojox.charting.action2d.Shake",h,{defaultParams:{duration:400,easing:e.backOut,shiftX:3,shiftY:3},optionalParams:{},constructor:function(a,d,c){c||(c={});this.shiftX="number"==typeof c.shiftX?c.shiftX:
3;this.shiftY="number"==typeof c.shiftY?c.shiftY:3;this.connect()},process:function(b){if(b.shape&&b.type in this.overOutEvents){var e=b.run.name,k=b.index,m=[],p;e in this.anim?p=this.anim[e][k]:this.anim[e]={};p?p.action.stop(!0):this.anim[e][k]=p={};var q={shape:b.shape,duration:this.duration,easing:this.easing,transform:[{name:"translate",start:[this.shiftX,this.shiftY],end:[0,0]},f.identity]};b.shape&&m.push(d.animateTransform(q));b.oultine&&(q.shape=b.outline,m.push(d.animateTransform(q)));
b.shadow&&(q.shape=b.shadow,m.push(d.animateTransform(q)));m.length?(p.action=a.combine(m),"onmouseout"==b.type&&c.connect(p.action,"onEnd",this,function(){this.anim[e]&&delete this.anim[e][k]}),p.action.play()):delete this.anim[e][k]}}})})},"dojox/charting/themes/ThreeD":function(){define("dojo/_base/lang dojo/_base/array ../Theme ./gradientGenerator ./PrimaryColors dojo/colors ./common".split(" "),function(c,l,h,a,e,f){var d={type:"linear",space:"shape",x1:0,y1:0,x2:100,y2:0},b=[{o:0,i:174},{o:.08,
i:231},{o:.18,i:237},{o:.3,i:231},{o:.39,i:221},{o:.49,i:206},{o:.58,i:187},{o:.68,i:165},{o:.8,i:128},{o:.9,i:102},{o:1,i:174}],g=l.map("#f00 #0f0 #00f #ff0 #0ff #f0f ./common".split(" "),function(e){var f=c.delegate(d);e=(f.colors=a.generateGradientByIntensity(e,b))[2].color;e.r+=100;e.g+=100;e.b+=100;e.sanitize();return f});f.ThreeD=e.clone();f.ThreeD.series.shadow={dx:1,dy:1,width:3,color:[0,0,0,.15]};f.ThreeD.next=function(a,b,d){if("bar"==a||"column"==a){var c=this._current%this.seriesThemes.length,
e=this.seriesThemes[c],f=e.fill;e.fill=g[c];c=h.prototype.next.apply(this,arguments);e.fill=f;return c}return h.prototype.next.apply(this,arguments)};return f.ThreeD})},"dojox/charting/themes/gradientGenerator":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Color ../Theme dojox/color/_base ./common".split(" "),function(c,l,h,a,e,f){c=c.getObject("gradientGenerator",!0,f);c.generateFills=function(d,b,c,e){return l.map(d,function(d){return a.generateHslGradient(d,b,c,e)})};c.updateFills=
function(d,b,c,e){l.forEach(d,function(d){d.fill&&!d.fill.type&&(d.fill=a.generateHslGradient(d.fill,b,c,e))})};c.generateMiniTheme=function(d,b,c,f,m){return l.map(d,function(d){d=new e.Color(d);return{fill:a.generateHslGradient(d,b,c,f),stroke:{color:a.generateHslColor(d,m)}}})};c.generateGradientByIntensity=function(a,b){a=new h(a);return l.map(b,function(b){var d=b.i/255;return{offset:b.o,color:new h([a.r*d,a.g*d,a.b*d,a.a])}})};return c})},"dojox/charting/themes/PrimaryColors":function(){define(["../Theme",
"./gradientGenerator","./common"],function(c,l,h){h.PrimaryColors=new c({seriesThemes:l.generateMiniTheme("#f00 #0f0 #00f #ff0 #0ff #f0f ./common".split(" "),{type:"linear",space:"plot",x1:0,y1:0,x2:0,y2:100},90,40,25)});return h.PrimaryColors})},"dojox/charting/action2d/MouseZoomAndPan":function(){define("dojo/_base/declare dojo/_base/window dojo/_base/array dojo/_base/event dojo/_base/connect dojo/mouse ./ChartAction dojo/sniff dojo/dom-prop dojo/keys dojo/has!dojo-bidi?../bidi/action2d/ZoomAndPan".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m){var p=b("mozilla")?3:120,q={none:function(a){return!a.ctrlKey&&!a.altKey&&!a.shiftKey},ctrl:function(a){return a.ctrlKey&&!a.altKey&&!a.shiftKey},alt:function(a){return!a.ctrlKey&&a.altKey&&!a.shiftKey},shift:function(a){return!a.ctrlKey&&!a.altKey&&a.shiftKey}};d=c(b("dojo-bidi")?"dojox.charting.action2d.NonBidiMouseZoomAndPan":"dojox.charting.action2d.MouseZoomAndPan",d,{defaultParams:{axis:"x",scaleFactor:1.2,maxScale:100,enableScroll:!0,enableDoubleClickZoom:!0,
enableKeyZoom:!0,keyZoomModifier:"ctrl"},optionalParams:{},constructor:function(a,b,d){this._listeners=[{eventName:f.wheel,methodName:"onMouseWheel"}];d||(d={});this.axis=d.axis?d.axis:"x";this.scaleFactor=d.scaleFactor?d.scaleFactor:1.2;this.maxScale=d.maxScale?d.maxScale:100;this.enableScroll=void 0!=d.enableScroll?d.enableScroll:!0;this.enableDoubleClickZoom=void 0!=d.enableDoubleClickZoom?d.enableDoubleClickZoom:!0;this.enableKeyZoom=void 0!=d.enableKeyZoom?d.enableKeyZoom:!0;this.keyZoomModifier=
d.keyZoomModifier?d.keyZoomModifier:"ctrl";this.enableScroll&&this._listeners.push({eventName:"onmousedown",methodName:"onMouseDown"});this.enableDoubleClickZoom&&this._listeners.push({eventName:"ondblclick",methodName:"onDoubleClick"});this.enableKeyZoom&&this._listeners.push({eventName:"keypress",methodName:"onKeyPress"});this._handles=[];this.connect()},_disconnectHandles:function(){b("ie")&&this.chart.node.releaseCapture();h.forEach(this._handles,e.disconnect);this._handles=[]},connect:function(){this.inherited(arguments);
this.enableKeyZoom&&g.set(this.chart.node,"tabindex","0")},disconnect:function(){this.inherited(arguments);this.enableKeyZoom&&g.set(this.chart.node,"tabindex","-1");this._disconnectHandles()},onMouseDown:function(d){var c=this.chart,f=c.getAxis(this.axis);this._startCoord=f.vertical?d.pageY:d.pageX;this._startOffset=f.getWindowOffset();this._isPanning=!0;b("ie")?(this._handles.push(e.connect(this.chart.node,"onmousemove",this,"onMouseMove")),this._handles.push(e.connect(this.chart.node,"onmouseup",
this,"onMouseUp")),this.chart.node.setCapture()):(this._handles.push(e.connect(l.doc,"onmousemove",this,"onMouseMove")),this._handles.push(e.connect(l.doc,"onmouseup",this,"onMouseUp")));c.node.focus();a.stop(d)},onMouseMove:function(a){if(this._isPanning){var b=this.chart,d=b.getAxis(this.axis);a=this._getDelta(a);var c=d.getScaler().bounds,c=c.span/(c.upper-c.lower),d=d.getWindowScale();b.setAxisWindow(this.axis,d,this._startOffset-a/c/d);b.render()}},onMouseUp:function(a){this._isPanning=!1;this._disconnectHandles()},
onMouseWheel:function(a){var b=a.wheelDelta/p;-1<b&&0>b?b=-1:0<b&&1>b&&(b=1);this._onZoom(b,a)},onKeyPress:function(a){q[this.keyZoomModifier](a)&&("+"==a.keyChar||a.keyCode==k.NUMPAD_PLUS?this._onZoom(1,a):"-"!=a.keyChar&&a.keyCode!=k.NUMPAD_MINUS||this._onZoom(-1,a))},onDoubleClick:function(b){var d=this.chart,c=d.getAxis(this.axis),e=1/this.scaleFactor;if(1==c.getWindowScale()){var f=c.getScaler(),c=f.bounds.from,f=f.bounds.to,g=(c+f)/2,k=this.plot.toData({x:b.pageX,y:b.pageY})[this.axis];d.zoomIn(this.axis,
[e*(c-g)+k,e*(f-g)+k])}else d.setAxisWindow(this.axis,1,0),d.render();a.stop(b)},_onZoom:function(b,d){b=0>b?Math.abs(b)*this.scaleFactor:1/(Math.abs(b)*this.scaleFactor);var c=this.chart,e=c.getAxis(this.axis);if(!(e.getWindowScale()/b>this.maxScale)){var f=e.getScaler(),e=f.bounds.from,f=f.bounds.to,g="keypress"==d.type?(e+f)/2:this.plot.toData({x:d.pageX,y:d.pageY})[this.axis];c.zoomIn(this.axis,[b*(e-g)+g,b*(f-g)+g]);a.stop(d)}},_getDelta:function(a){return this.chart.getAxis(this.axis).vertical?
this._startCoord-a.pageY:a.pageX-this._startCoord}});return b("dojo-bidi")?c("dojox.charting.action2d.MouseZoomAndPan",[d,m]):d})},"dojox/charting/action2d/ChartAction":function(){define(["dojo/_base/connect","dojo/_base/declare","./Base"],function(c,l,h){return l("dojox.charting.action2d.ChartAction",h,{constructor:function(a,c){},connect:function(){for(var a=0;a<this._listeners.length;++a)this._listeners[a].handle=c.connect(this.chart.node,this._listeners[a].eventName,this,this._listeners[a].methodName)},
disconnect:function(){for(var a=0;a<this._listeners.length;++a)c.disconnect(this._listeners[a].handle),delete this._listeners[a].handle}})})},"dojox/charting/action2d/TouchZoomAndPan":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/event dojo/sniff ./ChartAction ../Element dojo/touch ../plot2d/common dojo/has!dojo-bidi?../bidi/action2d/ZoomAndPan".split(" "),function(c,l,h,a,e,f,d,b,g){var k=l(f,{constructor:function(a){},render:function(){this.isDirty()&&(this.cleanGroup(),this.group.createRect({width:this.chart.dim.width,
height:this.chart.dim.height}).setFill("rgba(0,0,0,0)"))},clear:function(){this.dirty=!0;this.chart.stack[0]!=this&&this.chart.movePlotToFront(this.name);return this},getSeriesStats:function(){return c.delegate(b.defaultStats)},initializeScalers:function(){return this},isDirty:function(){return this.dirty}});e=l(a("dojo-bidi")?"dojox.charting.action2d.NonBidiTouchZoomAndPan":"dojox.charting.action2d.TouchZoomAndPan",e,{defaultParams:{axis:"x",scaleFactor:1.2,maxScale:100,enableScroll:!0,enableZoom:!0},
optionalParams:{},constructor:function(a,b,c){this._listeners=[{eventName:d.press,methodName:"onTouchStart"},{eventName:d.move,methodName:"onTouchMove"},{eventName:d.release,methodName:"onTouchEnd"}];c||(c={});this.axis=c.axis?c.axis:"x";this.scaleFactor=c.scaleFactor?c.scaleFactor:1.2;this.maxScale=c.maxScale?c.maxScale:100;this.enableScroll=void 0!=c.enableScroll?c.enableScroll:!0;this.enableZoom=void 0!=c.enableScroll?c.enableZoom:!0;this._uName="touchZoomPan"+this.axis;this.connect()},connect:function(){this.inherited(arguments);
-1!=this.chart.surface.declaredClass.indexOf("svg")&&this.chart.addPlot(this._uName,{type:k})},disconnect:function(){-1!=this.chart.surface.declaredClass.indexOf("svg")&&this.chart.removePlot(this._uName);this.inherited(arguments)},onTouchStart:function(a){var b=this.chart,d=b.getAxis(this.axis),c=a.touches?a.touches.length:1,e=a.touches?a.touches[0]:a,f=this._startPageCoord;this._startPageCoord={x:e.pageX,y:e.pageY};(this.enableZoom||this.enableScroll)&&b._delayedRenderHandle&&b.render();this.enableZoom&&
2<=c?(this._startTime=0,this._endPageCoord={x:a.touches[1].pageX,y:a.touches[1].pageY},a={x:(this._startPageCoord.x+this._endPageCoord.x)/2,y:(this._startPageCoord.y+this._endPageCoord.y)/2},b=d.getScaler(),this._initScale=d.getWindowScale(),this._middleCoord=(this._initData=this.plot.toData())(a)[this.axis],this._startCoord=b.bounds.from,this._endCoord=b.bounds.to):(a.touches&&1!=a.touches.length?this._startTime=0:this._startTime?250>(new Date).getTime()-this._startTime&&30>Math.abs(this._startPageCoord.x-
f.x)&&30>Math.abs(this._startPageCoord.y-f.y)?(this._startTime=0,this.onDoubleTap(a)):this._startTime=0:this._startTime=(new Date).getTime(),this.enableScroll&&(this._startScroll(d),h.stop(a)))},onTouchMove:function(a){var b=this.chart,d=b.getAxis(this.axis),c=a.touches?a.touches.length:1,e=d.vertical?"pageY":"pageX",d=d.vertical?"y":"x";this._startTime=0;this.enableZoom&&2<=c?(c=(this._endPageCoord[d]-this._startPageCoord[d])/(a.touches[1][e]-a.touches[0][e]),this._initScale/c>this.maxScale||(e=
this._initData({x:(a.touches[1].pageX+a.touches[0].pageX)/2,y:(a.touches[1].pageY+a.touches[0].pageY)/2})[this.axis],b.zoomIn(this.axis,[c*(this._startCoord-e)+this._middleCoord,c*(this._endCoord-e)+this._middleCoord]),h.stop(a))):this.enableScroll&&(c=this._getDelta(a),b.setAxisWindow(this.axis,this._lastScale,this._initOffset-c/this._lastFactor/this._lastScale),b.delayedRender(),h.stop(a))},onTouchEnd:function(a){var b=this.chart.getAxis(this.axis);a.touches&&1!=a.touches.length||!this.enableScroll||
(a=a.touches?a.touches[0]:a,this._startPageCoord={x:a.pageX,y:a.pageY},this._startScroll(b))},_startScroll:function(a){var b=a.getScaler().bounds;this._initOffset=a.getWindowOffset();this._lastScale=a.getWindowScale();this._lastFactor=b.span/(b.upper-b.lower)},onDoubleTap:function(a){var b=this.chart,d=b.getAxis(this.axis),c=1/this.scaleFactor;if(1==d.getWindowScale()){var e=d.getScaler(),d=e.bounds.from,e=e.bounds.to,f=(d+e)/2,g=this.plot.toData(this._startPageCoord)[this.axis];b.zoomIn(this.axis,
[c*(d-f)+g,c*(e-f)+g])}else b.setAxisWindow(this.axis,1,0),b.render();h.stop(a)},_getDelta:function(a){var b=this.chart.getAxis(this.axis),d=b.vertical?"pageY":"pageX",c=b.vertical?"y":"x";a=a.touches?a.touches[0]:a;return b.vertical?this._startPageCoord[c]-a[d]:a[d]-this._startPageCoord[c]}});return a("dojo-bidi")?l("dojox.charting.action2d.TouchZoomAndPan",[e,g]):e})},"dojox/charting/action2d/MouseIndicator":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/_base/window dojo/sniff ./ChartAction ./_IndicatorElement dojox/lang/utils dojo/_base/event dojo/_base/array".split(" "),
function(c,l,h,a,e,f,d,b,g,k){return l("dojox.charting.action2d.MouseIndicator",f,{defaultParams:{series:"",vertical:!0,autoScroll:!0,fixed:!0,precision:0,lines:!0,labels:!0,markers:!0},optionalParams:{lineStroke:{},outlineStroke:{},shadowStroke:{},lineFill:{},stroke:{},outline:{},shadow:{},fill:{},fillFunc:null,labelFunc:null,font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerSymbol:"",offset:{},start:!1,mouseOver:!1},constructor:function(a,d,e){this.opt=c.clone(this.defaultParams);
b.updateWithObject(this.opt,e);b.updateWithPattern(this.opt,e,this.optionalParams);this._listeners=this.opt.mouseOver?[{eventName:"onmousemove",methodName:"onMouseMove"}]:[{eventName:"onmousedown",methodName:"onMouseDown"}];this._uName="mouseIndicator"+this.opt.series;this._handles=[];this.connect()},_disconnectHandles:function(){e("ie")&&this.chart.node.releaseCapture();k.forEach(this._handles,h.disconnect);this._handles=[]},connect:function(){this.inherited(arguments);this.chart.addPlot(this._uName,
{type:d,inter:this})},disconnect:function(){if(this._isMouseDown)this.onMouseUp();this.chart.removePlot(this._uName);this.inherited(arguments);this._disconnectHandles()},onChange:function(a){},onMouseDown:function(b){this._isMouseDown=!0;e("ie")?(this._handles.push(h.connect(this.chart.node,"onmousemove",this,"onMouseMove")),this._handles.push(h.connect(this.chart.node,"onmouseup",this,"onMouseUp")),this.chart.node.setCapture()):(this._handles.push(h.connect(a.doc,"onmousemove",this,"onMouseMove")),
this._handles.push(h.connect(a.doc,"onmouseup",this,"onMouseUp")));this._onMouseSingle(b)},onMouseMove:function(a){(this._isMouseDown||this.opt.mouseOver)&&this._onMouseSingle(a)},_onMouseSingle:function(a){var b=this.chart.getPlot(this._uName);b.pageCoord={x:a.pageX,y:a.pageY};b.dirty=!0;this.chart.render();g.stop(a)},onMouseUp:function(a){a=this.chart.getPlot(this._uName);a.stopTrack();this._isMouseDown=!1;this._disconnectHandles();a.pageCoord=null;a.dirty=!0;this.chart.render()}})})},"dojox/charting/action2d/_IndicatorElement":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ../plot2d/Indicator dojo/has ../plot2d/common ../axis2d/common dojox/gfx".split(" "),
function(c,l,h,a,e){var f=function(a,b,c){var d,e=a?{x:b[0],y:c[0][0]}:{x:c[0][0],y:b[0]};1<b.length&&(d=a?{x:b[1],y:c[1][0]}:{x:c[1][0],y:b[1]});return[e,d]};h=h("dojox.charting.action2d._IndicatorElement",a,{constructor:function(a,b){b||(b={});this.inter=b.inter},_updateVisibility:function(a,b,c){var d="x"==c?this._hAxis:this._vAxis,e=d.getWindowScale();this.chart.setAxisWindow(d.name,e,d.getWindowOffset()+(a[c]-b[c])/e);this._noDirty=!0;this.chart.render();this._noDirty=!1;this._initTrack()},_trackMove:function(){this._updateIndicator(this.pageCoord);
this._tracker=setTimeout(c.hitch(this,this._trackMove),100)},_initTrack:function(){this._tracker||(this._tracker=setTimeout(c.hitch(this,this._trackMove),500))},stopTrack:function(){this._tracker&&(clearTimeout(this._tracker),this._tracker=null)},render:function(){if(this.isDirty()){var a=this.inter,b=a.plot,e=a.opt.vertical;this.opt.offset=a.opt.offset||(e?{x:0,y:5}:{x:5,y:0});a.opt.labelFunc&&(this.opt.labelFunc=function(b,d,c,g,n){b=f(e,d,c);return a.opt.labelFunc(b[0],b[1],g,n)});a.opt.fillFunc&&
(this.opt.fillFunc=function(b,d,c){b=f(e,d,c);return a.opt.fillFunc(b[0],b[1])});this.opt=c.delegate(a.opt,this.opt);this.pageCoord?(this.opt.values=[],this.opt.labels=this.secondCoord?"trend":"markers"):(this.opt.values=null,this.inter.onChange({}));this.hAxis=b.hAxis;this.vAxis=b.vAxis;this.inherited(arguments)}},_updateIndicator:function(){var a=this._updateCoordinates(this.pageCoord,this.secondCoord);if(1<a.length){var b=this.opt.vertical;this._data=[];this.opt.values=[];l.forEach(a,function(a){a&&
(this.opt.values.push(b?a.x:a.y),this._data.push([b?a.y:a.x]))},this);this.inherited(arguments)}else this.inter.onChange({})},_renderText:function(a,b,c,e,m,p,h,n){this.inter.opt.labels&&this.inherited(arguments);var d=f(this.opt.vertical,h,n);this.inter.onChange({start:d[0],end:d[1],label:b})},_updateCoordinates:function(a,b){e("dojo-bidi")&&this._checkXCoords(a,b);var d=this.inter,c=d.plot,f=d.opt.vertical,p=this.chart.getAxis(c.hAxis),h=this.chart.getAxis(c.vAxis),n=p.name,r=h.name,l=p.getScaler().bounds,
u=h.getScaler().bounds,h=f?"x":"y",p=f?n:r,w=f?l:u;if(b){var t;f?a.x>b.x&&(t=b,b=a,a=t):a.y>b.y&&(t=b,b=a,a=t)}var y=c.toData(a),C;b&&(C=c.toData(b));var x={};x[n]=l.from;x[r]=u.from;t=c.toPage(x);x[n]=l.to;x[r]=u.to;n=c.toPage(x);if(y[p]<w.from){if(C||!d.opt.autoScroll||d.opt.mouseOver){if(d.opt.mouseOver)return[];a[h]=t[h]}else return this._updateVisibility(a,t,h),[];y=c.toData(a)}else if(y[p]>w.to){if(C||!d.opt.autoScroll||d.opt.mouseOver){if(d.opt.mouseOver)return[];a[h]=n[h]}else return this._updateVisibility(a,
n,h),[];y=c.toData(a)}a=this._snapData(y,h,f);var B;if(null==a.y)return[];b&&(C[p]<w.from?(b[h]=t[h],C=c.toData(b)):C[p]>w.to&&(b[h]=n[h],C=c.toData(b)),B=this._snapData(C,h,f),null==B.y&&(B=null));return[a,B]},_snapData:function(a,b,c){var d=this.chart.getSeries(this.inter.opt.series).data,e,f,g=d.length;for(e=0;e<g;++e)if(f=d[e],null!=f)if("number"==typeof f){if(e+1>a[b])break}else if(f[b]>a[b])break;var n,h;"number"==typeof f?(g=e+1,0<e&&(n=e,h=d[e-1])):(g=f.x,f=f.y,0<e&&(n=d[e-1].x,h=d[e-1].y));
0<e&&a[b]<=(c?(g+n)/2:(f+h)/2)&&(g=n,f=h);return{x:g,y:f}},cleanGroup:function(a){this.inherited(arguments);this.group.moveToFront();return this},isDirty:function(){return!this._noDirty&&(this.dirty||this.inter.plot.isDirty())}});e("dojo-bidi")&&h.extend({_checkXCoords:function(a,b){if(this.chart.isRightToLeft()&&this.isDirty()){var d=function(a,b){return a.chart.dim.width+(a.chart.offsets.l-a.chart.offsets.r)-(b.x-c)+c},c=this.chart.node.offsetLeft;a&&(a.x=d(this,a));b&&(b.x=d(this,b))}}});return h})},
"dojox/charting/plot2d/Indicator":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./CartesianBase ./_PlotEvents ./common ../axis2d/common dojox/gfx dojox/lang/utils dojox/gfx/fx dojo/has dojo/sniff".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p){var q=function(a,d){var e=a.declaredClass,f;if(-1!=e.indexOf("svg"))try{var g=a.rawNode.getBBox();if(m("dojo-bidi")&&p("ff")){for(f=a.rawNode.cloneNode();f.lastChild;)f.removeChild(f.lastChild);f.appendChild(document.createTextNode(d.replace(/[\u200E\u202A\u202C\u200f\u202B]/g,
"")));f.setAttribute("style","visibility: hidden");a.rawNode.parentNode.appendChild(f);g=f.getBBox();f.parentNode.removeChild(f)}else g=a.rawNode.getBBox();return c.mixin({},g)}catch(y){}else{if(-1!=e.indexOf("vml"))return e=a.rawNode,g=e.style.display,e.style.display="inline",d=b.pt2px(parseFloat(e.currentStyle.width)),f=b.pt2px(parseFloat(e.currentStyle.height)),d={x:0,y:0,width:d,height:f},n(a,d),e.style.display=g,d;if(-1!=e.indexOf("silverlight"))return n(a,{width:a.rawNode.actualWidth,height:a.rawNode.actualHeight},
.75);if(a.getTextWidth)return d=a.getTextWidth(),e=a.getFont(),f=b.normalizedLength(e?e.size:b.defaultFont.size),d={width:d,height:f},n(a,d,.75),d}return null},n=function(a,b,d){var c=b.width,e=b.height;a=a.getShape();switch(a.align){case "end":b.x=a.x-c;break;case "middle":b.x=a.x-c/2;break;default:b.x=a.x}b.y=a.y-e*(d||1);return b};h=h("dojox.charting.plot2d.Indicator",[a,e],{defaultParams:{vertical:!0,fixed:!0,precision:0,lines:!0,labels:"line",markers:!0},optionalParams:{lineStroke:{},outlineStroke:{},
shadowStroke:{},lineFill:{},stroke:{},outline:{},shadow:{},fill:{},fillFunc:null,labelFunc:null,font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerSymbol:"",values:[],offset:{},start:!1,animate:!1},constructor:function(a,b){this.opt=c.clone(this.defaultParams);g.updateWithObject(this.opt,b);"number"==typeof b.values&&(b.values=[b.values]);g.updateWithPattern(this.opt,b,this.optionalParams);this.animate=this.opt.animate},render:function(a,b){if(this.zoom)return this.performZoom(a,
b);if(!this.isDirty())return this;this.cleanGroup(null,!0);if(!this.opt.values)return this;this._updateIndicator();return this},_updateIndicator:function(){var a=this.chart.theme,b=this._hAxis.name,d=this._vAxis.name,c=this._hAxis.getScaler().bounds,e=this._vAxis.getScaler().bounds,g={};g[b]=c.from;g[d]=e.from;var k=this.toPage(g);g[b]=c.to;g[d]=e.to;var m=this.toPage(g),n=this.events(),c=l.map(this.opt.values,function(a,c){return this._renderIndicator(a,c,b,d,k,m,n,this.animate)},this),e=c.length;
if("trend"==this.opt.labels){var g=this.opt.vertical,p=this._data[0][0],h=this._data[e-1][0]-p,p=this.opt.labelFunc?this.opt.labelFunc(-1,this.values,this._data,this.opt.fixed,this.opt.precision):f.getLabel(h,this.opt.fixed,this.opt.precision)+" ("+f.getLabel(100*h/p,!0,2)+"%)";this._renderText(this.getGroup(),p,this.chart.theme,g?(c[0].x+c[e-1].x)/2:c[1].x,g?c[0].y:(c[1].y+c[e-1].y)/2,-1,this.opt.values,this._data)}(a=void 0!=this.opt.lineFill?this.opt.lineFill:a.indicator.lineFill)&&1<e&&(g=Math.min(c[0].x1,
c[e-1].x1),p=Math.min(c[0].y1,c[e-1].y1),this.getGroup().createRect({x:g,y:p,width:Math.max(c[0].x2,c[e-1].x2)-g,height:Math.max(c[0].y2,c[e-1].y2)-p}).setFill(a).moveToBack())},_renderIndicator:function(a,b,d,e,g,k,n,p){var h=this.chart.theme,r=this.chart.getCoords(),q=this.opt.vertical,t=this.getGroup().createGroup(),v={};v[d]=q?a:0;v[e]=q?0:a;m("dojo-bidi")&&(v.x=this._getMarkX(v.x));var v=this.toPage(v),u=q?v.x>=g.x&&v.x<=k.x:v.y>=k.y&&v.y<=g.y,w=v.x-r.x,y=v.y-r.y,x=q?w:g.x-r.x,C=q?g.y-r.y:y,
L=q?x:k.x-r.x,R=q?k.y-r.y:C;if(this.opt.lines&&u){var M=this.opt.hasOwnProperty("lineShadow")?this.opt.lineShadow:h.indicator.lineShadow,Q=this.opt.hasOwnProperty("lineStroke")?this.opt.lineStroke:h.indicator.lineStroke,U=this.opt.hasOwnProperty("lineOutline")?this.opt.lineOutline:h.indicator.lineOutline;M&&t.createLine({x1:x+M.dx,y1:C+M.dy,x2:L+M.dx,y2:R+M.dy}).setStroke(M);U&&(U=f.makeStroke(U),U.width=2*U.width+(Q?Q.width:0),t.createLine({x1:x,y1:C,x2:L,y2:R}).setStroke(U));t.createLine({x1:x,
y1:C,x2:L,y2:R}).setStroke(Q)}var S;if(this.opt.markers&&u){var G=this._data[b],T=this;G&&(S=l.map(G,function(b,c){v[d]=q?a:b;v[e]=q?b:a;m("dojo-bidi")&&(v.x=T._getMarkX(v.x));v=this.toPage(v);if(q?v.y<=g.y&&v.y>=k.y:v.x>=g.x&&v.x<=k.x){w=v.x-r.x;y=v.y-r.y;c=this.opt.markerSymbol?this.opt.markerSymbol:h.indicator.markerSymbol;var n="M"+w+" "+y+" "+c;M=void 0!=this.opt.markerShadow?this.opt.markerShadow:h.indicator.markerShadow;Q=void 0!=this.opt.markerStroke?this.opt.markerStroke:h.indicator.markerStroke;
U=void 0!=this.opt.markerOutline?this.opt.markerOutline:h.indicator.markerOutline;M&&t.createPath("M"+(w+M.dx)+" "+(y+M.dy)+" "+c).setFill(M.color).setStroke(M);U&&(U=f.makeStroke(U),U.width=2*U.width+(Q?Q.width:0),t.createPath(n).setStroke(U));c=t.createPath(n);n=this._shapeFill(void 0!=this.opt.markerFill?this.opt.markerFill:h.indicator.markerFill,c.getBoundingBox());c.setFill(n).setStroke(Q)}return b},this))}G=this.opt.start?{x:x,y:q?C:R}:{x:q?x:L,y:q?R:C};this.opt.labels&&"trend"!=this.opt.labels&&
u&&(this.opt.labelFunc?u=this.opt.labelFunc(b,this.opt.values,this._data,this.opt.fixed,this.opt.precision,this.opt.labels):"markers"==this.opt.labels?(u=l.map(S,function(a){return f.getLabel(a,this.opt.fixed,this.opt.precision)},this),u=1!=u.length?"[ "+u.join(", ")+" ]":u[0]):u=f.getLabel(a,this.opt.fixed,this.opt.precision),this._renderText(t,u,h,G.x,G.y,b,this.opt.values,this._data));n&&this._connectEvents({element:"indicator",run:this.run?this.run[b]:void 0,shape:t,value:a});p&&this._animateIndicator(t,
q,q?C:x,q?C+R:x+L,p);return c.mixin(G,{x1:x,y1:C,x2:L,y2:R})},_animateIndicator:function(a,b,d,e,f){k.animateTransform(c.delegate({shape:a,duration:1200,transform:[{name:"translate",start:b?[0,d]:[d,0],end:[0,0]},{name:"scale",start:b?[1,1/e]:[1/e,1],end:[1,1]},{name:"original"}]},f)).play()},clear:function(){this.inherited(arguments);this._data=[]},addSeries:function(a){this.inherited(arguments);this._data.push(a.data)},_renderText:function(a,b,c,e,g,k,m,n){this.opt.offset&&(e+=this.opt.offset.x,
g+=this.opt.offset.y);b=d.createText.gfx(this.chart,a,e,g,this.opt.vertical?"middle":this.opt.start?"start":"end",b,this.opt.font?this.opt.font:c.indicator.font,this.opt.fontColor?this.opt.fontColor:c.indicator.fontColor);e=q(b,b.getShape().text);this.opt.vertical&&!this.opt.start&&(e.y+=e.height/2,b.setShape({y:g+e.height/2}));e.x-=2;--e.y;e.width+=4;e.height+=2;e.r=this.opt.radius?this.opt.radius:c.indicator.radius;var p=void 0!=this.opt.shadow?this.opt.shadow:c.indicator.shadow;g=void 0!=this.opt.stroke?
this.opt.stroke:c.indicator.stroke;var h=void 0!=this.opt.outline?this.opt.outline:c.indicator.outline;p&&a.createRect(e).setFill(p.color).setStroke(p);h&&(h=f.makeStroke(h),h.width=2*h.width+(g?g.width:0),a.createRect(e).setStroke(h));c=this.opt.fillFunc?this.opt.fillFunc(k,m,n):void 0!=this.opt.fill?this.opt.fill:c.indicator.fill;a.createRect(e).setFill(this._shapeFill(c,e)).setStroke(g);b.moveToFront()},getSeriesStats:function(){return c.delegate(f.defaultStats)}});m("dojo-bidi")&&h.extend({_getMarkX:function(a){return this.chart.isRightToLeft()?
this.chart.axes.x.scaler.bounds.to+this.chart.axes.x.scaler.bounds.from-a:a}});return h})},"arcgisonline/sharing/dijit/Troubleshoot":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/ContentPane,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.Troubleshoot");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.layout.ContentPane");
c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.requireLocalization("arcgisonline","arcgisonline");c.declare("arcgisonline.sharing.dijit.Troubleshoot",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"esriItemLinks troubleshoot"\x3e\r\n        \x3cdiv class\x3d"sub-nav"\x3e\r\n          \x3cdiv class\x3d"container"\x3e\r\n            \x3ch1 class\x3d"sub-nav-title"\x3e${i18n.troubleshootTitle}\x3c/h1\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"respond"\x3e\r\n        \x3cp id\x3d"instructions"\x3e${i18n.instructions}\x3c/p\x3e\r\n         \x3cdiv data-dojo-attach-point\x3d"_stackContainer" class\x3d"newStyles"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"forgotUsername" class\x3d"contentPane"\x3e\r\n              \x3ch2\x3e${i18n.forgotUsername}\x3c/h2\x3e\r\n              \x3cp\x3e${!i18n.forgotUsernameInstructions}\x3c/p\x3e\r\n              \x3clabel class\x3d"esriFloatLeading" for\x3d"email"\x3e${i18n.emailLabel}\x26nbsp;\x3c/label\x3e\r\n              \x3cinput id\x3d"email" data-dojo-attach-point\x3d"_email" name\x3d"email" data-dojo-type\x3d"dijit/form/ValidationTextBox" trim\x3d"true"/\x3e\r\n              \x3cbr /\x3e\r\n              \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_submitEmail" class\x3d"esriFloatLeading calcite blue"\x3e${i18n.send}\x3c/button\x3e\r\n              \x3cbr/\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"forgotPassword" class\x3d"contentPane"\x3e\r\n              \x3ch2\x3e${i18n.forgotPassword}\x3c/h2\x3e\r\n              \x3cp\x3e${!i18n.forgotPasswordInstructions}\x3c/p\x3e\r\n              \x3clabel class\x3d"esriFloatLeading" for\x3d"username"\x3e${i18n.usernameLabel}\x26nbsp;\x3c/label\x3e\r\n              \x3cinput id\x3d"username" name\x3d"userName" data-dojo-attach-point\x3d"_userName" data-dojo-type\x3d"dijit/form/ValidationTextBox" trim\x3d"true"/\x3e\r\n              \x3cbr /\x3e\r\n              \x3cbutton data-dojo-attach-event\x3d"onClick:_submitUsername" data-dojo-type\x3d"dijit/form/Button" class\x3d"esriFloatLeading calcite blue"\x3e${i18n.customRoles.continueLabel}\x3c/button\x3e\r\n              \x3cbr /\x3e\r\n          \x3c/div\x3e\r\n         \x3cdiv class\x3d"contentPane newStyles" dojoAttachPoint\x3d"changePassword" style\x3d"display:none;"\x3e\r\n             \x3ch2\x3e${i18n.resetPassword}\x3c/h2\x3e\r\n             \x3cp dojoAttachPoint\x3d"_securityQuestionInstructions" class\x3d"securityQuestion"\x3e${i18n.securityQuestionInstructions}\x3c/p\x3e\r\n             \x3clabel class\x3d"securityQuestion esriFloatLeading" dojoAttachPoint\x3d"_securityQuestion"\x3e\x3c/label\x3e\r\n             \x3cinput dojoAttachPoint\x3d"_securityAnswer" name\x3d"answer" dojoType\x3d"dijit.form.ValidationTextBox" trim\x3d"true" class\x3d"ieFix securityQuestion" /\x3e\r\n             \x3cdiv class\x3d"prompt securityQuestion"\x3e${i18n.securityQuestionPrompt}\x3c/div\x3e\r\n             \x3cdiv class\x3d"portal-only" style\x3d"display:none;"\x3e\r\n                 \x3cbr/\x3e\r\n                 \x3cp\x3e${i18n.enterNewPassword}\x3c/p\x3e\r\n                 \x3cdiv class\x3d"password-1"\x3e\r\n                     \x3clabel class\x3d"left"\x3e${i18n.newPasswordLabel}\x3c/label\x3e\r\n                     \x3cinput name\x3d"password" dojoAttachPoint\x3d"_newPassword" type\x3d"password" dojotype\x3d"dijit.form.ValidationTextBox" trim\x3d"true" class\x3d"ieFix" /\x3e\r\n                 \x3c/div\x3e\r\n                 \x3cbr /\x3e\r\n                 \x3cdiv class\x3d"password-2"\x3e\r\n                     \x3clabel class\x3d"left"\x3e${i18n.reenterPasswordLabel}\x3c/label\x3e\r\n                     \x3cinput name\x3d"verify" dojoAttachPoint\x3d"_verifyPassword" type\x3d"password" dojotype\x3d"dijit.form.ValidationTextBox" trim\x3d"true"/\x3e\r\n                 \x3c/div\x3e\r\n             \x3c/div\x3e\r\n             \x3cbutton dojoAttachEvent\x3d"onClick:_submitReset" dojoType\x3d"dijit.form.Button" class\x3d"calcite blue esriFloatLeading indentBtn" style\x3d"margin-left: 205px;"\x3e${i18n.mosaicRulePanel.resetLabel}\x3c/button\x3e\r\n         \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"mfaHelp" class\x3d"contentPane"\x3e\r\n             \x3cbr /\x3e\r\n             \x3ch2\x3e${i18n.mfaHelpMsg}\x3c/h2\x3e\r\n             \x3cp\x3e${!i18n.mfaHelpInstructions}\x3c/p\x3e\r\n             \x3clabel class\x3d"esriFloatLeading" for\x3d"username"\x3e${i18n.usernameLabel}\x26nbsp;\x3c/label\x3e\r\n             \x3cinput id\x3d"mfa_username" name\x3d"userName" data-dojo-attach-point\x3d"_mfaUserName" data-dojo-type\x3d"dijit/form/ValidationTextBox" trim\x3d"true"/\x3e\r\n             \x3cbr /\x3e\r\n             \x3cbutton data-dojo-attach-event\x3d"onClick:_submitMfaUsername" data-dojo-type\x3d"dijit/form/Button" class\x3d"esriFloatLeading calcite blue"\x3e${i18n.customRoles.continueLabel}\x3c/button\x3e\r\n             \x3cbr /\x3e\r\n          \x3c/div\x3e\r\n         \x3cdiv class\x3d"contentPane newStyles" dojoAttachPoint\x3d"disableMfa" style\x3d"display:none;clear:both;"\x3e\r\n             \x3cbr /\x3e\r\n             \x3ch2\x3e${i18n.mfaSecurityQuestionTitle}\x3c/h2\x3e\r\n             \x3cp class\x3d"securityQuestion"\x3e${i18n.mfaSecurityQuestionMsg}\x3c/p\x3e\r\n             \x3clabel class\x3d"mfaSecurityQuestion esriFloatLeading" dojoAttachPoint\x3d"_mfaSecurityQuestion"\x3e\x3c/label\x3e\r\n             \x3cinput dojoAttachPoint\x3d"_mfaSecurityAnswer" name\x3d"answer" dojoType\x3d"dijit.form.ValidationTextBox" trim\x3d"true" class\x3d"ieFix securityQuestion" /\x3e\r\n             \x3cdiv class\x3d"prompt mfaSecurityQuestion"\x3e${i18n.securityQuestionPrompt}\x3c/div\x3e\r\n             \x3cbutton dojoAttachEvent\x3d"onClick:_submitMfaReset" dojoType\x3d"dijit.form.Button" class\x3d"calcite blue esriFloatLeading indentBtn" style\x3d"margin-left: 205px;"\x3e${i18n.send}\x3c/button\x3e\r\n         \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"register" title\x3d"${i18n.links.register}" style\x3d"display:none;"\x3e\r\n            \x3cp class\x3d"marginless"\x3e\x3cb\x3e${i18n.signInWidget.agsTrial}\x3c/b\x3e\x3c/p\x3e\r\n            \x3cp\x3e${i18n.signInWidget.agsSubscriptionInfo}\x3c/p\x3e\r\n            \x3ca class\x3d"calcite btn small blue" href\x3d"/about/free-trial.html?origin\x3darcgis"\x3e${i18n.signInWidget.ags30DayTrial}\x3c/a\x3e\x3cbr/\x3e\r\n            \x3cp\x3e\x3cb\x3e${i18n.signInWidget.agsNoTrial}\x3c/b\x3e\x3c/p\x3e\r\n            \x3cp\x3e${i18n.signInWidget.agsCreatePersonalMsg}.\x3c/p\x3e\r\n            \x3cp\x3e${i18n.signInWidget.agsHavePersonal}\x3c/p\x3e\r\n            \x3ca id\x3d"registerBtn" class\x3d"calcite btn small light"\x3e${i18n.signInWidget.agsRegisterPersonalBtn}\x3c/a\x3e\x3cbr/\x3e\r\n            \x3cp\x3e${i18n.signInWidget.agsCreatePersonal}\x3c/p\x3e\r\n            \x3ca id\x3d"createBtn" class\x3d"calcite btn small light"\x3e${i18n.signInWidget.agsCreatePersonalBtn}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n          \x3cbr /\x3e\r\n          \x3cp data-dojo-attach-point\x3d"gotoStart" class\x3d"indent notstart" style\x3d"display:none;"\x3e${i18n.otherQuestions}\x26nbsp;\x26nbsp;\x3ca target\x3d"_blank" data-dojo-attach-event\x3d"onclick:_troubleshoot"\x3e${i18n.seeTroubleshooting}\x3c/a\x3e\x3c/p\x3e\r\n      \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr /\x3e\r\n      \x3cbr /\x3e\r\n\x3c/div\x3e',
baseClass:"esriTroubleshoot",_util:arcgisonline.sharing.util,_account:arcgisonline.sharing.geow.Account,postMixInProperties:function(){this.inherited(arguments);c.mixin(this,c.queryToObject(window.location.search.slice(1)));if(this.returnUrl){var a=window.location.host.split(".").slice(-2).join(".")+"/";-1===this.returnUrl.indexOf(a)&&-1===this.returnUrl.indexOf("arcgis.com/")&&-1===this.returnUrl.indexOf("esri.com/")&&(this.returnUrl=null)}this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline",
"arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot);c.mixin(this.i18n,{customRoles:c.i18n.getLocalization("arcgisonline","arcgisonline").customRoles});c.mixin(this.i18n,{mosaicRulePanel:c.i18n.getLocalization("arcgisonline","arcgisonline").mosaicRulePanel});c.mixin(this.i18n,{signInWidget:c.i18n.getLocalization("arcgisonline","arcgisonline").signInWidget});this.i18n.errors=c.mixin(c.i18n.getLocalization("arcgisonline","arcgisonline").common.errors,
c.i18n.getLocalization("arcgisonline","arcgisonline").troubleshoot.errors,c.i18n.getLocalization("arcgisonline","arcgisonline").newUser.errors);this.i18n.questions=c.mixin(c.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions,{0:this.i18n.questions.question0})},startup:function(){this.inherited(arguments);this._connects=[];esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._errorDlg=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();this._svcUrl=
esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUrl=this._svcUrl+"community/";this._userUrl=this._communityUrl+"users/";this._requestParams={f:"json"};this.connect(c.byId("registerBtn"),"onclick",c.hitch(this,function(){window.location=esriGeowConfig.signup}));this.connect(c.byId("createBtn"),"onclick",c.hitch(this,function(){window.location=esriGeowConfig.createAccount}));this.connect(this._stackContainer,"onClick",
c.hitch(this,function(){c.style(this.changePassword,"display","none")}));this._initHelpMgr();this._troubleshoot()},destroy:function(){this.inherited(arguments);c.forEach(this._connects,c.disconnect)},_initHelpMgr:function(){var a=arcgisonline.sharing.dijit.HelpManager.prototype.statics.getInstance(),e=setInterval(c.hitch(this,function(){if(a.isLoaded())if(clearInterval(e),esriGeowConfig&&esriGeowConfig.self&&esriGeowConfig.self.isPortal)c.query(".helpLink").forEach(esri.hide),c.query("#instructions").forEach(function(a){c.style(a,
"visibility","hidden")});else{var f=a.getHelpUrl("120000466");c.query(".helpLink").attr("href",f)}}),200)},_switchPane:function(a){},_forgotPassword:function(){c.attr(this._forgotPasswordTitle,"innerHTML",this.i18n.forgotPassword);this._switchPane(this.forgotPassword);this._userName.focus()},_changePassword:function(){c.attr(this._forgotPasswordTitle,"innerHTML",this.i18n.resetPassword);this._switchPane(this.forgotPassword);this._userName.focus()},_forgotUsername:function(){this._switchPane(this.forgotUsername);
this._email.focus()},_troubleshoot:function(){this._account.getSelf(c.hitch(this,function(a){!1===esriGeowConfig.showForgotUsername&&this._stackContainer.removeChild(this.forgotUsername);this.isPortal=a&&a.isPortal;a&&(a.isPortal||a.urlKey)&&(this._stackContainer.removeChild(this.register),this.isPortal&&(c.query(".portal-only").forEach(esri.show),c.attr(this._securityQuestionInstructions,"innerHTML",this.i18n.securityQuestionInstructionsNoEmail),this._stackContainer.removeChild(this.mfaHelp)));this._clear();
this._securityQuestionIdx=-1;this._switchPane(this._start)}))},_redirectToSignin:function(){window.location=this.returnUrl||"signin.html"},_submitEmail:function(a){a.preventDefault();if(!this._checkRequired([this._email]))return a=this._communityUrl+"forgotUsername",this._disable(!0),this._request(a,{email:this._email.get("value")}).then(c.hitch(this,function(){this._redirectToSignin()}))},_submitUsername:function(a){a.preventDefault();this._newPassword.set("value","");this._verifyPassword.set("value",
"");if(!this._checkRequired([this._userName]))return a=this._userUrl+this._userName.get("value")+"/forgotPassword",this._disable(!0),this._request(a,{}).then(c.hitch(this,function(a){a=a||{};"arcgis"===a.provider?(this._securityQuestionIdx=(-1===a.securityQuestionIdx?0:a.securityQuestionIdx)||0,c.attr(this._securityQuestion,"innerHTML",this.i18n.questions[a.securityQuestionIdx]),this._securityQuestionIdx||this._showError(this.i18n.errors[this.isPortal?"noSecurityPortal":"noSecurity"]),c.query(".securityQuestion",
this.domNode).style("display",""),c.style(this.changePassword,"display",this._securityQuestionIdx?"":"none"),this._securityAnswer.focus()):"enterprise"===a.provider?this._showError(this.i18n.errors.administrator):(this._isEcas=!0,c.query(".securityQuestion",this.domNode).style("display","none"),c.style(this.changePassword,"display",""))}))},_submitMfaUsername:function(a){a.preventDefault();if(!this._checkRequired([this._mfaUserName]))return a=this._userUrl+this._mfaUserName.get("value")+"/forgotPassword",
this._disable(!0),this._mfaUserNameCheck=!0,this._request(a,{}).then(c.hitch(this,function(a){a=a||{};this._securityQuestionIdx=(-1===a.securityQuestionIdx?0:a.securityQuestionIdx)||0;c.attr(this._mfaSecurityQuestion,"innerHTML",this.i18n.questions[a.securityQuestionIdx]);this._securityQuestionIdx||this._showError(this.i18n.errors.noSecurity);c.query(".disableMfa",this.domNode).style("display","");c.style(this.disableMfa,"display",this._securityQuestionIdx?"":"none");this._mfaSecurityAnswer.focus()}))},
_submitMfaReset:function(a){a.preventDefault();a={securityAnswer:this._mfaSecurityAnswer.get("value"),securityQuestionIdx:this._securityQuestionIdx};if(!this._checkRequired([this._mfaSecurityAnswer])){var e=this._util.getSecureUrl(this._userUrl)+this._mfaUserName.get("value")+"/disableMfaRequest";this._disable(!0);return this._request(e,a).then(c.hitch(this,function(a){var d=c.connect(this._errorDlg,"onHide",c.hitch(this,function(){d.remove();this._redirectToSignin()}));this._showError(this.i18n.errors.mfaEmailSent)}))}},
_submitReset:function(a){a.preventDefault();a={securityAnswer:this._securityAnswer.get("value"),securityQuestionIdx:this._securityQuestionIdx};if(this.isPortal){var e=[this._newPassword,this._verifyPassword];this._isEcas||e.unshift(this._securityAnswer);if(this._checkRequired(e))return;if(this._newPassword.get("value")!==this._verifyPassword.get("value"))return this._verifyPassword.focus(),this._showError(this.i18n.errors.passwordsNotMatch);a.newPassword=this._newPassword.get("value")}else{e=[this._securityAnswer];
if(this._checkRequired(e))return;a.email=!0}e=this._util.getSecureUrl(this._userUrl)+this._userName.get("value")+"/reset";this._disable(!0);return this._request(e,a).then(c.hitch(this,function(a){if(this.isPortal)this._redirectToSignin();else{var d=c.connect(this._errorDlg,"onHide",c.hitch(this,function(){d.remove();this._redirectToSignin()}));this._showError(this.i18n.errors.emailSent)}}))},_disable:function(a){c.query(".esriTroubleshoot .dijitTextBox, .esriTroubleshoot .dijitButton").map(l.byNode).forEach(function(c){c.set("disabled",
a)})},_clear:function(){c.query(".esriTroubleshoot .dijitTextBox").map(l.byNode).forEach(function(a){a.set("value","")})},_checkRequired:function(a){return(a=c.filter(a,c.hitch(this,function(a){return this._isEmpty(a)})))&&a.length?(a[0].focus(),this._showError(this.i18n.errors.required[a[0].name])):!1},_isEmpty:function(a){a=a.get("value");return(this.trim?/^\s*$/:/^$/).test(a)},_request:function(a,e){return this._util.request({url:a,content:e},{usePost:!0}).then(c.hitch(this,function(a){this._mfaUserNameCheck=
!1;this._disable(!1);return a.error?this._showError(a.error):a}),c.hitch(this,function(a){this._disable(!1);a&&"COM_0018"===a.messageCode&&this._userName?(a=this._mfaUserNameCheck?this._mfaUserName.get("value"):this._userName.get("value"),a={message:esri.substitute({username:this._util.stripHTML(a)},this.i18n.errors.COM_0018)}):a&&"COM_0049"===a.messageCode?a={message:this.i18n.errors.COM_0049.message}:a&&"COM_1037"===a.messageCode?a={message:this.i18n.errors.COM_1037}:a&&"COM_1059"===a.messageCode?
a={message:this.i18n.errors.COM_1059}:a&&"COM_1055"===a.messageCode?a={message:this.i18n.errors.COM_1055}:a&&"DB_0003"===a.messageCode?a={message:this.i18n.errors.DB_0003}:a&&"DB_0002"===a.messageCode&&(a={message:this.i18n.errors.DB_0002});this._showError(a);this._mfaUserNameCheck=!1;throw a;}))},_showError:function(a){a.message=a.message&&a.message.replace(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,"")||"";a.message=this._util.stripHTML(a.message);a=a.error||
a||{};a.code=a.code||0;a=c.mixin(c.mixin({},this.i18n.errors.error),a);this._errorDlg.show(a);return!0}})})},"arcgisonline/sharing/dijit/NewUser":function(){define(["dojo","dijit","dojox","dojo/i18n!arcgisonline/nls/arcgisonline","dojo/require!dijit/_Widget,dijit/_Templated,dijit/layout/ContentPane,arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/Account"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.NewUser");
c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.layout.ContentPane");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");c.require("arcgisonline.sharing.geow.Geow");c.require("arcgisonline.sharing.geow.Account");c.requireLocalization("arcgisonline","arcgisonline");c.declare("arcgisonline.sharing.dijit.NewUser",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoType\x3d"dijit.layout.ContentPane" dojoAttachPoint\x3d"containerNode" style\x3d"min-height:300px;"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"newUserNode" style\x3d"display:none;"\x3e\r\n    \x3ch1 dojoAttachPoint\x3d"_welcomeHeader"\x3e\x3c/h1\x3e\r\n    \x3cdiv class\x3d"userInfo" dojoAttachPoint\x3d"_userInfo"\x3e\r\n        \x3clabel\x3e${i18n.usernameLabel}\x3c/label\x3e\x3cspan dojoAttachPoint\x3d"_username"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3clabel\x3e${i18n.emailLabel}\x3c/label\x3e\x3cspan dojoAttachPoint\x3d"_email"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3clabel\x3e${i18n.firstNameLabel}\x3c/label\x3e\x3cspan dojoAttachPoint\x3d"_firstName"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3clabel\x3e${i18n.lastNameLabel}\x3c/label\x3e\x3cspan dojoAttachPoint\x3d"_lastName"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cspan class\x3d"indent section"\x3e${i18n.formInstructions}\x3c/span\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv class\x3d"formNode" dojoAttachPoint\x3d"_formNode"\x3e\r\n        \x3c!--\x3cdiv dojoAttachPoint\x3d"_passwordHintText" class\x3d"indent prompt hidden"\x3e${i18n.passwordHintText}\x3c/div\x3e--\x3e\r\n        \x3cspan\x3e\x3clabel for\x3d"password"\x3e${i18n.setPasswordLabel}\x3c/label\x3e \x3cinput id\x3d"password" dojoAttachPoint\x3d"_password" name\x3d"password" class\x3d"required" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan\x3e\x3clabel for\x3d"verify"\x3e${i18n.verifyPasswordLabel}\x3c/label\x3e \x3cinput id\x3d"verify" dojoAttachPoint\x3d"_verify" name\x3d"verify" class\x3d"required" dojoType\x3d"dijit.form.TextBox" type\x3d"password" trim\x3d"true"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan\x3e\x3clabel for\x3d"question"\x3e${i18n.questionLabel}\x3c/label\x3e \x3cinput id\x3d"question" name\x3d"question" class\x3d"required" style\x3d"width:300px;" dojoAttachPoint\x3d"_select" class\x3d"select required" dojoType\x3d"dijit.form.Select"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan\x3e\x3clabel for\x3d"answer"\x3e${i18n.answerLabel}\x3c/label\x3e \x3cinput id\x3d"answer" dojoAttachPoint\x3d"_answer" name\x3d"answer" class\x3d"required" dojoType\x3d"dijit.form.TextBox" trim\x3d"true"\x3e\x3c/span\x3e\r\n        \x3cbr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"_terms"\x3e\x3clabel\x3e${i18n.termsOfUseLabel}\x3c/label\x3e\x3cbutton dojoAttachEvent\x3d"onClick:onTermsClick" class\x3d"calcite transparent" dojoType\x3d"dijit.form.Button" type\x3d"button"\x3e${i18n.reviewTermsOfUse}\x3c/button\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttons indent" dojoAttachPoint\x3d"_buttons"\x3e\r\n        \x3cbutton dojoAttachPoint\x3d"_signInBtn" class\x3d"calcite blue" dojoAttachEvent\x3d"onClick:onSignInClick" dojoType\x3d"dijit.form.Button" type\x3d"button" disabled\x3d"true"\x3e${i18n.signIn}\x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" class\x3d"calcite transparent" dojoAttachEvent\x3d"onClick:onCancelClick" type\x3d"button"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
baseClass:"esriNewUser",_util:arcgisonline.sharing.util,_geow:arcgisonline.sharing.geow.Geow,_account:arcgisonline.sharing.geow.Account,_isSingleTenant:!1,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline","arcgisonline").common);this.i18n=c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").newUser);this.i18n.signUpWidget=c.i18n.getLocalization("arcgisonline","arcgisonline").signUpWidget;this.i18n.questions=c.mixin(this.i18n.questions,
c.i18n.getLocalization("arcgisonline","arcgisonline").securityQuestions);this._util.getCookie("esri_auth")&&this._geow.signout(window.location.href)},startup:function(){esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;this._errorDlg=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();this._svcUrl=esriGeowConfig.restBaseUrl+(esriGeowConfig.restBaseUrl.lastIndexOf("/")===esriGeowConfig.restBaseUrl.length-1?"":"/");this._communityUri=this._svcUrl+"community/";this._usersUri=
this._communityUri+"users/";this._accountsUri=this._svcUrl+"portals/";this._requestParams={f:"json"};c.mixin(this,c.queryToObject(window.location.search.slice(1)));this._isSingleTenant=void 0!==esriGeowConfig.isMultiTenant&&null!==esriGeowConfig.isMultiTenant&&!1===esriGeowConfig.isMultiTenant;this._loadQuestions();this._loadData()},isValid:function(){return this._checkRequired()?!1:this._password.get("value")!==this._verify.get("value")?(this._password.focus(),!this._showError(this.i18n.errors.passwordsNotMatch)):
!0},_containsAlphaNumeric:function(a){var c=/^[a-zA-Z0-9@_\.\-\s]+$/g;return a&&!!c.test(a)},_loadQuestions:function(){var a=c.map([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],'return {"label":this.i18n.questions[item], "value":item};',this);this._select.set("options",a);this._select.reset()},_loadData:function(){return this._fetchInvitation().then(c.hitch(this,function(a){c.mixin(this,{user:a.username,org:a.account&&a.account.name});return this._signin().then(c.hitch(this,function(a){this._user=c.mixin(this._util.getUser(),
a);this._requestParams.token=this._user.token;this._signOut();return this._user})).then(c.hitch(this,"_loadUserInfo"))}))},_loadUserInfo:function(){var a=this._user.firstName;this.fullName=this._user.fullName;this._user.firstName=a?this._user.firstName:this.fullName.split(" ")[0];this._user.lastName=a?this._user.lastName:this.fullName.split(" ")[1];c.attr(this._welcomeHeader,"innerHTML",esri.substitute(this,this.i18n.welcomeHeader));c.attr(this._username,"innerHTML",this._user.username);c.attr(this._email,
"innerHTML",this._user.email);c.attr(this._firstName,"innerHTML",this._user.firstName);c.attr(this._lastName,"innerHTML",this._user.lastName);this._termsAccepted=!0;c.style(this._terms,"display","none");this._signInBtn.set("disabled",!1);esri.show(this.newUserNode)},onTermsClick:function(a){this.isValid()&&(c.subscribe("registerUser",c.hitch(this,function(){this._termsAccepted=!0;this._signInBtn.set("disabled",!1)})),arcgisonline.sharing.dijit.dialog.TermsOfUseDlg.prototype.statics.getInstance().show())},
onSignInClick:function(a){this._disable(!0);if(!this._isSingleTenant&&this.isValid())this._showJoinDlg().then(c.hitch(this,function(){return this._resetUser().then(c.hitch(this,"_signin")).then(c.hitch(this,"_acceptInvitation")).then(c.hitch(this,"_redirectToProfile"))}));else if(this._isSingleTenant&&this.isValid())return this._resetUser().then(c.hitch(this,"_signin")).then(c.hitch(this,"_acceptInvitation")).then(c.hitch(this,"_redirectToProfile"))},onCancelClick:function(){this._geow.signout(esriGeowConfig.baseUrl+
"index.html")},_resetUser:function(){var a=this._usersUri+this._user.username+"/reset",c={password:this.invitation,newPassword:this._password.get("value"),newSecurityQuestionIdx:this._select.get("value"),newSecurityAnswer:this._answer.get("value")};this._user.password=c.newPassword;return this._request(a.replace("http:","https:"),c,{usePost:!0})},_redirectToProfile:function(){var a=this._invitation&&this._invitation.account&&this._invitation.account.customUrl||null,c=window.location.protocol+"//"+
(a||window.location.host)+"/home/user.html",f=this._util.getCookie("esri_auth");a&&(c=this._util.getBridgeUrl(c,f));window.location=this._allSSL?c.replace("http:","https:"):c.replace("https:","http:")},_fetchInvitation:function(){return this._request(this._communityUri+"invitations/"+this.invitation,{}).then(c.hitch(this,function(a){return this._invitation=a}))},_signin:function(){var a=new c.Deferred,e={username:this.user,password:this._user&&this._user.password||this.invitation};esriGeowConfig.userInfo&&
esriGeowConfig.userInfo.token&&this._signOut();this._geow.signin(e,c.hitch(this,function(c){this._allSSL=c.ssl||!1;this._requestParams.token=c.token;a.resolve(c)}),c.hitch(this,function(a){this._showError(a)}));return a},_signOut:function(){esriGeowConfig.userInfo=null;esriGeowConfig.userPreferences=null;c.cookie("esri_auth",null,{expires:-1,path:"/",domain:document.domain});esriGeowConfig.isDebug||c.cookie("esri_auth",null,{expires:-1,path:"/",domain:".arcgis.com"});delete this._util._cookies.esri_auth;
c.cookie("esri_prefs",null,{expires:-1,path:"/"});c.publish("onSignOut",[])},_acceptInvitation:function(){var a=new c.Deferred;this._account.acceptInvitation(this.invitation,c.hitch(this,function(c){a.resolve(c)}),c.hitch(this,function(a){this._showError(a)}));return a.then(c.hitch(this,"_fixCookie"))},_fixCookie:function(){var a=new c.Deferred;this._geow.signInHandler(this._user.username,c.hitch(this,function(){a.resolve({success:!0})}),c.hitch(this,function(a){this._showError(a)}),esriGeowConfig.userInfo);
return a},_showJoinDlg:function(){var a=new c.Deferred,e="\x3cp\x3e\x3cstrong\x3e"+this.i18n.invite.joiningOrg+"\x3c/strong\x3e\x3c/p\x3e\x3cul\x3e",e=e+("\x3cli\x3e"+this.i18n.invite.createdContent+"\x3c/li\x3e"),e=e+("\x3cli\x3e"+this.i18n.signUpWidget.accountManagedMsg+"\x3c/li\x3e"),e=e+("\x3cli\x3e"+this.i18n.signUpWidget.leaveOrganization+"\x3c/li\x3e\x3c/ul\x3e"),e=esri.substitute(this,e),f=esri.substitute(this,this.i18n.invite.title),f=this._util.ellipse(f,50),d=this._errorDlg.onOkClick;this._errorDlg.onOkClick=
c.hitch(this,function(){this._errorDlg.onOkClick=d;this._errorDlg.hide();a.resolve()});var b=c.connect(this._errorDlg,"onCancel",c.hitch(this,function(){c.disconnect(b);this._disable(!1)}));this._errorDlg.show({title:f,message:e});return a},_disable:function(a){c.query(".esriNewUser .dijitTextBox, .esriNewUser .dijitButton, .esriNewUser .dijitSelect").map(l.byNode).forEach(function(c){c.set("disabled",a)})},_clear:function(){c.query(".esriNewUser .dijitTextBox").map(l.byNode).forEach(function(a){a.set("value",
"")})},_checkRequired:function(){var a=c.query(".required").map(l.byNode).filter(c.hitch(this,function(a){return this._isEmpty(a)}));return a&&a.length?(a[0].focus(),this._showError(this.i18n.errors.required[a[0].name])):!1},_isEmpty:function(a){var c=a.get("value");return a.declaredClass.indexOf("Select")&&0===c?!0:(this.trim?/^\s*$/:/^$/).test(c)},_request:function(a,e,f){e=c.mixin(e||{},this._requestParams);return this._util.request({url:a,content:e},f||{}).then(c.hitch(this,function(a){return a.error?
this._showError(a.error):a}),c.hitch(this,function(a){this._showError(a);this._disable(!1);throw a;}))},_showError:function(a){a=a.error||a||{};var e=a.code=a.messageCode||a.code||0;a=this.i18n.errors[a.code]||a;a.details=a.details&&a.details.length?c.filter(a.details,"return item !\x3d\x3d null"):null;a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details);a=c.mixin(c.mixin({},this.i18n.errors.error),a);this._isSingleTenant&&
a.portalMessage&&(a.message=a.portalMessage);"COM_0005"===e&&(this._errorDlg.onOkClick=c.hitch(this,function(){this._errorDlg.hide()}),this._errorDlg.onHide=c.hitch(this,function(){window.location=esriGeowConfig.baseUrl.replace("http:","https:")+esriGeowConfig.signin}));this._errorDlg.show(a);this._disable(!1);return!0}})})},"arcgisonline/sharing/dijit/SearchFilters":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/_Search,arcgisonline/sharing/util"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.SearchFilters");
c.require("arcgisonline.sharing._Search");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.SearchFilters",[l._Widget,l._Templated,arcgisonline.sharing._Search],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode" class\x3d"filters"\x3e\r\n  \r\n  \x3cdiv\x3e\r\n  \x3cdiv class\x3d"set" root\x3d"true"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"all"\x3e${i18n.allResults}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"maps"\x3e${i18n.filters.maps}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers"\x3e${i18n.filters.layers}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"webScene item dijitInline" name\x3d"scenes"\x3e${i18n.filters.scenes}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications"\x3e${i18n.filters.apps}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools"\x3e${i18n.filters.tools}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"files"\x3e${i18n.filters.files}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"set" parent\x3d"maps" root\x3d"true" style\x3d"display:none;"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"GIS item dijitInline" name\x3d"maps"\x3e${i18n.allMaps}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"GIS item dijitInline" name\x3d"maps-webmaps"\x3e${i18n.webMaps}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"GIS item dijitInline" name\x3d"maps-mapfiles"\x3e${i18n.mapFiles}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"maps-packages" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv style\x3d"margin-top:0.7em;"\x3e\x3ca class\x3d"item dijitInline" name\x3d"maps-packages"\x3e${i18n.allPackages}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"maps-packages-layer"\x3e${i18n.layerPackages}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"maps-packages-map"\x3e${i18n.mapPackages}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n  \x3cdiv class\x3d"set" parent\x3d"layers" root\x3d"true" style\x3d"display:none;"\x3e\r\n    \x3cdiv style\x3d"margin-top:0.7em;"\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers"\x3e${i18n.layers.all_layers}\x3c/a\x3e\x3c/div\x3e\r\n     \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers"\x3e${i18n.layers.weblayers}\x3c/a\x3e\x3c/div\x3e\r\n     \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-layerfiles"\x3e${i18n.layers.layerFiles}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \r\n  \x3cdiv class\x3d"set" parent\x3d"applications" root\x3d"true" style\x3d"display:none;"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications"\x3e${i18n.allApplications}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web"\x3e${i18n.webApplications}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile"\x3e${i18n.mobileApplications}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop"\x3e${i18n.desktopApplications}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-web" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web"\x3e${i18n.allWebApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-flex"\x3e${i18n.Flex}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-javascript"\x3e${i18n.JavaScript}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-silverlight"\x3e${i18n.Silverlight}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv style\x3d"margin-top:0.7em;"\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile"\x3e${i18n.mobileApplications}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-javascript"\x3e${i18n.JavaScript}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-flex"\x3e${i18n.Flex}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-iphone"\x3e${i18n.ios}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsmobile"\x3e${i18n.mobile}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsphone"\x3e${i18n.windowsPhone}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-android"\x3e${i18n.Android}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n    \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-desktop" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n      \x3c!--\x3cdiv style\x3d"margin-top:0.7em;"\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop"\x3e${i18n.desktopApplications}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n      \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop-java"\x3eJava\x3c/a\x3e\x3c/div\x3e--\x3e\r\n      \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop-dotnet"\x3e.NET\u2013Windows Desktop\x3c/a\x3e\x3c/div\x3e--\x3e\r\n      \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop-osx"\x3eOS X\x3c/a\x3e\x3c/div\x3e--\x3e\r\n      \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop-qt"\x3eQt\x3c/a\x3e\x3c/div\x3e--\x3e\r\n      \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-desktop-wpf"\x3eWPF\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3c/div\x3e--\x3e\r\n  \r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-web-flex" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-flex"\x3e${i18n.allFlexApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-flex-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-flex-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-flex-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-web-javascript" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-javascript"\x3e${i18n.allJsApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-javascript-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-javascript-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-javascript-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-web-silverlight" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-silverlight"\x3e${i18n.allSilverApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-silverlight-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-silverlight-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-web-silverlight-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-iphone" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-iphone"\x3e${i18n.allIosApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-iphone-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-iphone-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-iphone-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-windowsmobile" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsmobile"\x3e${i18n.allMobApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsmobile-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsmobile-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsmobile-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-windowsphone" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsphone"\x3e${i18n.allWPhoneApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsphone-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsphone-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-windowsphone-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c!----\x3e\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-android" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-android"\x3e${i18n.allAndroidApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-android-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-android-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-android-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-javascript" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-javascript"\x3e${i18n.allJsApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-javascript-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-javascript-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-javascript-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n  \x3c!--\x3cdiv class\x3d"set" parent\x3d"applications-mobile-flex" root\x3d"true" style\x3d"display:none;"\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-flex"\x3e${i18n.allFlexApps}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-flex-codesample"\x3e${i18n.codeSample}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-flex-configurable"\x3e${i18n.configurable}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n    \x3c!--\x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"applications-mobile-flex-readytouse"\x3e${i18n.readyUse}\x3c/a\x3e\x3c/div\x3e--\x3e\r\n  \x3c!--\x3c/div\x3e--\x3e\r\n\r\n  \x3cdiv class\x3d"set" parent\x3d"layers-weblayers" root\x3d"true" style\x3d"display:none;"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers"\x3e${i18n.weblayers.all_weblayers}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers-features"\x3e${i18n.weblayers.features}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers-tiles"\x3e${i18n.weblayers.tiles}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers-mapimage"\x3e${i18n.weblayers.mapservice}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers-imagery"\x3e${i18n.weblayers.imagery}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"webScene item dijitInline" name\x3d"layers-weblayers-scenelayers"\x3e${i18n.weblayers.scenelayers}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"layers-weblayers-tables"\x3e${i18n.weblayers.tables}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n    \r\n  \x3cdiv class\x3d"set" parent\x3d"tools" style\x3d"display:none;"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools"\x3e${i18n.allTools}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools-locators"\x3e${i18n.addressLocators}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools-geodatabase"\x3e${i18n.geodatabaseAccess}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools-geometric"\x3e${i18n.geoOperations}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools-geoprocessing"\x3e${i18n.geoTasks}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"tools-network"\x3e${i18n.netAnalysis}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"set" parent\x3d"files" style\x3d"display:none;"\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"files"\x3e${i18n.files.all_files}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"files-document"\x3e${i18n.files.document}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"files-image"\x3e${i18n.files.image}\x3c/a\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\x3ca class\x3d"item dijitInline" name\x3d"files-pdf"\x3e${i18n.files.pdf}\x3c/a\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"related" id\x3d"contentSearchSection" style\x3d"margin-top:1em;"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_contentSearchChk" dojoType\x3d"dijit.form.CheckBox" type\x3d"checkbox" checked\x3d"false"\x3e\x3c/div\x3e\r\n    \x3cspan id\x3d"contentSearchLabel"\x3e${i18n.webOnly}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
widgetsInTemplate:!0,_filterQueries:esriGeowConfig.filterQueries,restrict:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").searchFilters);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").folders);c.mixin(this.i18n,{webOnly:c.i18n.getLocalization("arcgisonline","arcgisonline").siteHeader.webOnly});this.util=
arcgisonline.sharing.util;this.account=arcgisonline.sharing.geow.Account},postCreate:function(){esriGeowConfig.sceneViewerEnabled||c.query(".webScene",this.domNode).forEach(esri.hide);this.account.getSelf(c.hitch(this,function(){var a=arcgisonline.sharing.util.userPreferences(null,"contentModePrefs"),e="Web",e=a&&a.contentMode?a.contentMode:esriGeowConfig.userInfo&&esriGeowConfig.userInfo.preferredView||"Web";c.connect(this._contentSearchChk,"onChange",c.hitch(this,"_changeContentSearch"));a=c.queryToObject(window.location.search.slice(1));
if(a.t&&"groups"===a.t)c.style(this.domNode,"display","none");else{c.query(".set a.item",this.domNode).forEach(function(a){c.attr(a,"href",this.getSearchUrl({focus:c.attr(a,"name"),start:null},{useCurrentPageLocation:!0}))},this);var f=!0,a=null!=a.focus?c.clone(a.focus):"all";do c.query(".set a.item[name\x3d"+a+"]",this.domNode).forEach(function(a){var b=a.parentNode.parentNode,d=c.attr(a,"name")===c.attr(b,"parent");!f&&d||c.addClass(a,"selected");c.style(b,"display","")},this),"Web"===e&&c.query(".GIS",
this.domNode).forEach(function(a){c.style(a,"display","none")},this),a=a.substr(0,a.lastIndexOf("-")),f=!1;while(0<a.length);this.loadFilterMode()}}))},setRestrict:function(a){this.restrict=a;c.query(".set a.item",this.domNode).forEach(function(a){var e=this.getSearchUrl({focus:c.attr(a,"name"),start:null,restrict:this.restrict},{useCurrentPageLocation:!0});c.attr(a,"href",e)},this)},loadFilterMode:function(){var a=c.queryToObject(window.location.search.slice(1)),e=this.util.userPreferences(null,
"contentModePrefs"),f="Web";a.content&&"all"===a.content.toLowerCase()?(f="GIS",this.util.userPreferences({contentMode:f},"contentModePrefs",!0)):a.content&&"web"===a.content.toLowerCase()?this.util.userPreferences({contentMode:f},"contentModePrefs",!0):e&&e.contentMode&&(f=e.contentMode);this.contentMode=f;this._contentSearchChk.set("checked","GIS"===f,!1)},_changeContentSearch:function(a){c.subscribe("esri/userPreferencescontentModePrefs",c.hitch(this,function(){var a=window.location.search&&c.queryToObject(window.location.search.slice(1));
a&&a.start&&(a.start=null);a&&"maps-mapfiles"===a.focus&&(a.focus="maps");l.byId("restrictSearch")&&(a.restrict=l.byId("restrictSearch").get("checked"));var f=window.location.href.substring(0,window.location.href.indexOf(window.location.search));window.location.href=f+(a?"?"+c.objectToQuery(a):"")}));this.contentMode=a?"GIS":"Web";arcgisonline.sharing.util.userPreferences({contentMode:this.contentMode},"contentModePrefs",!0)}})})},"arcgisonline/sharing/dijit/SearchResultsSimple":function(){define(["dojo",
"dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/grid/DataGrid,dijit/Toolbar,arcgisonline/sharing/_Search,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Content,arcgisonline/sharing/dijit/views,arcgisonline/sharing/util"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.SearchResultsSimple");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dojox.grid.DataGrid");c.require("dijit.Toolbar");c.require("arcgisonline.sharing._Search");c.require("arcgisonline.sharing.geow.Account");
c.require("arcgisonline.sharing.geow.Content");c.require("arcgisonline.sharing.dijit.views");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.SearchResultsSimple",[l._Widget,l._Templated,arcgisonline.sharing._Search],{widgetsInTemplate:!0,templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\r\n\r\n  \x3cdiv style\x3d"width: 100%; background-color: light-blue;" dojoAttachPoint\x3d"_resultsNode"\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3c!-- \r\n  \x3cdiv style\x3d"width: 100%; display:none; margin: 2em;" class\x3d"dim" dojoAttachPoint\x3d"_noResultsNode"\x3e\r\n\r\n  \x3c/div\x3e\r\n  --\x3e\r\n\r\n\x3c/div\x3e',
resultCount:0,start:0,nextStart:0,pageCount:0,queryFocus:null,_views:arcgisonline.sharing.dijit.views,doAjax:!1,noResultsMessage:"",simpleList:!1,_resultsNode:null,_noResultsNode:null,_user:null,_organization:null,_unshareHandler:null,pageQuery:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").searchResults);this.resultsPerPage=this.MAX_RESULTS_PER_PAGE;
this.maxSearchResults=this.MAX_PAGE_COUNT*this.MAX_RESULTS_PER_PAGE},postCreate:function(){var a=window.location.pathname.toLowerCase();this.isGroupsPage=-1!==a.indexOf("groups.html");if(-1!=a.indexOf("group.html")||null!==window.location.search&&""!==window.location.search||null!==this.pageQuery)this.inherited(arguments),c.connect(this,"onQueryResult",this,this._handleSearchResult),(this._queryStringParams=null===window.location.search||""===window.location.search||"?"===window.location.search?this.pageQuery:
c.queryToObject(window.location.search.slice(1)))&&this._queryStringParams.start&&this._queryStringParams.start>this.maxSearchResults-this.resultsPerPage+1&&(this._queryStringParams.start=this._queryStringParams.start>this.maxSearchResults?-1:this._queryStringParams.start,this.resultsPerPage=this.maxSearchResults+1-this._queryStringParams.start),c.connect(this,"onDisplayResults",this,this._updateNoResultsMessage)},startup:function(){this.inherited(arguments);arcgisonline.sharing.geow.Account.getSelf(c.hitch(this,
this.handleGetSelf))},handleGetSelf:function(a){var e=arcgisonline.sharing.util.isPortal();if((this._user=arcgisonline.sharing.util.getUser())&&this._user.accountId)if(a&&a.id&&a.id===this._user.accountId){this._organization=a;if(this._organization.thumbnail&&0<this._organization.thumbnail.length){var f=this.getOrganizationThumbnailUrl(this._organization),d=c.create("span",{innerHTML:" "+this.i18n.searchResults},c.byId("searchResultsPageTitle"),"only"),f=c.create("img",{src:f,alt:this._organization.name,
align:"center"},d,"first");c.addClass(f,"groupThumbnail")}if(e)esri.isDefined(this._queryStringParams.t)&&"groups"===this._queryStringParams.t&&(this._queryStringParams.q+=" orgid:"+a.id,esriGeowConfig.portalLivingAtlasConfigEnabled&&(this._queryStringParams.q+=" -owner:esri_livingatlas -owner:esri_boundaries -owner:esri_demographics"));else{this._queryStringParams.q_orig||(this._queryStringParams.q_orig=this._queryStringParams.q);if(a.canSearchPublic||this._user.accountId===a.id&&esriGeowConfig.userRole.isAdmin())e=
c.string.substitute(this.i18n.restrictSearch,{name:a.name}),c.attr(c.byId("restrictSearchLabel"),"innerHTML",e),c.style(c.byId("restrictSearchSection"),"display","block"),void 0===this._queryStringParams.restrict||null===this._queryStringParams.restrict||"true"!==this._queryStringParams.restrict&&"false"!==this._queryStringParams.restrict||(this._queryStringParams.restrict="false"!==this._queryStringParams.restrict,l.byId("filtersWidget")&&l.byId("filtersWidget").setRestrict(this._queryStringParams.restrict),
l.byId("sorters")&&l.byId("sorters").setRestrict(this._queryStringParams.restrict),l.byId("restrictSearch").set("checked",this._queryStringParams.restrict));c.connect(l.byId("restrictSearch"),"onClick",this,this.onRestrictSearchChange);e=l.byId("restrictSearch").get("checked");this._queryStringParams.q=e?this._queryStringParams.q_orig+" orgid:"+a.id:this._queryStringParams.q_orig}}else this._organization=null;else a&&a.id&&!e&&a.urlKey&&a.customBaseUrl?(this._organization=a,this._queryStringParams.q_orig||
(this._queryStringParams.q_orig=this._queryStringParams.q),this.isGroupsPage||(e=c.string.substitute(this.i18n.restrictSearch,{name:a.name}),c.attr(c.byId("restrictSearchLabel"),"innerHTML",e),c.style(c.byId("restrictSearchSection"),"display","block"),this._queryStringParams=c.mixin(this._queryStringParams,{restrict:"false"!==this._queryStringParams.restrict}),l.byId("filtersWidget")&&l.byId("filtersWidget").setRestrict(this._queryStringParams.restrict),l.byId("sorters")&&l.byId("sorters").setRestrict(this._queryStringParams.restrict),
l.byId("restrictSearch").set("checked",this._queryStringParams.restrict),c.connect(l.byId("restrictSearch"),"onClick",this,this.onRestrictSearchChange),e=l.byId("restrictSearch").get("checked"),this._queryStringParams.q=e?this._queryStringParams.q_orig+" orgid:"+a.id:this._queryStringParams.q_orig),this.simpleList||(l.byId("filtersWidget")&&l.byId("filtersWidget").setRestrict(this._queryStringParams.restrict),l.byId("sorters")&&l.byId("sorters").setRestrict(this._queryStringParams.restrict)),this._queryStringParams.restrict&&
(this._queryStringParams.q=this._queryStringParams.q+" orgid:"+a.id)):a&&a.id&&e&&esri.isDefined(this._queryStringParams.t)&&"groups"===this._queryStringParams.t&&(this._queryStringParams.q+=" orgid:"+a.id);this.doQuery(this._queryStringParams)},onRestrictSearchChange:function(a){a=l.byId("restrictSearch").get("checked");c.publish("onRestrictSearchChange",[{restrictSearch:a}]);this._queryStringParams.restrict=a;l.byId("filtersWidget")&&l.byId("filtersWidget").setRestrict(this._queryStringParams.restrict);
l.byId("sorters")&&l.byId("sorters").setRestrict(this._queryStringParams.restrict);this._queryStringParams.q=a?this._queryStringParams.q_orig+" AND orgid:"+this._organization.id:this._queryStringParams.q_orig;var e=c.mixin({},this._queryStringParams);a&&delete e.start;this.doQuery(e)},getOrganizationThumbnailUrl:function(a){var c=arcgisonline.sharing.util.getToken();return esriGeowConfig.restBaseUrl+"portals/self/resources/"+a.thumbnail+(c?"?token\x3d"+c:"")},_updateNoResultsMessage:function(){var a=
"\x3cp\x3e"+this.i18n.noResults+"\x3c/p\x3e\x3cp\x3e"+this.i18n.suggestionsLabel+"\x3cul\x3e",a=a+("\x3cli\x3e"+this.i18n.spellingCheck+"\x3c/li\x3e\x3cli\x3e"+this.i18n.tryDiffWords+"\x3c/li\x3e\x3cli\x3e"+this.i18n.tryGeneralWords+"\x3c/li\x3e\x3c/ul\x3e\x3c/p\x3e");this.noResultsMessage="\x3cp class\x3d'esriItemLinks'\x3e"+a+"\x3c/p\x3e"},_setDefaultSortFieldAttr:function(a){this.defaultSortField=a},_handleSearchResult:function(a,e){this.start=a.start;this.nextStart=a.nextStart;this.resultCount=
a.total;this.pageCount=Math.ceil(this.resultCount/this.resultsPerPage);this.pageCount=this.pageCount>this.MAX_PAGE_COUNT?this.MAX_PAGE_COUNT:this.pageCount;this.start=a.start>this.maxSearchResults?this.maxSearchResults:a.start;this.nextStart=a.nextStart>this.maxSearchResults?-1:a.nextStart;var f="groups"==this._queryStringParams.t?c.hitch(this._views.group,this._views.group.medium):c.hitch(this._views.item,this._views.item.medium);this.onDisplayResults(this.resultCount);c.empty(this._resultsNode);
a.total&&0<a.total?c.forEach(a.results,function(a){var b={showThumb:!0,align:"left",showProfilePopup:!0};this._unshareHandler&&(b.unshareHandler=this._unshareHandler);c.place(c.partial(f,a,b)(),this._resultsNode)},this):(a="",esri.isDefined(this._queryStringParams.q)&&0<this._queryStringParams.q.length&&(a="- '"+this._queryStringParams.q+"' - "),a=c.replace(this.noResultsMessage,{query:a}),c.attr(this._resultsNode,"innerHTML",a));this.afterDisplayResults()},onDisplayResults:function(a){},afterDisplayResults:function(){},
nextPage:function(){if(0<this.nextStart){var a=c.clone(this._queryStringParams);a.start=this.nextStart;this._page(a)}},previousPage:function(){if(1<this.start){var a=c.clone(this._queryStringParams);a.start=1>a.start-this.resultsPerPage?1:a.start-this.resultsPerPage;this._page(a)}},goToPage:function(a){if(0<a){var e=c.clone(this._queryStringParams);e.start=1+this.resultsPerPage*(a-1);this._page(e)}},_page:function(a){this.doAjax?this.doQuery(a):(a=c.mixin(a,{q:l.byId("search-box").get("value")}),
this.goToSearch(a,{useCurrentPageLocation:!0}))},sort:function(a,e){if("groups"!==this._queryStringParams.t){var f=c.clone(this._queryStringParams);a&&(f.sortField=a);f.sortOrder=e?"desc":"asc";this.doAjax?this.doQuery(f):this.goToSearch(f,{useCurrentPageLocation:!0})}},_setNoResultsMessageAttr:function(a){this.noResultsMessage=a}});c.declare("arcgisonline.sharing.dijit.RelatedSearchResults",[l._Widget,l._Templated],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\r\n\r\n  \x3cdiv dojoAttachPoint\x3d"_groupsNode"\x3e\x3c/div\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"_esriNode"\x3e\x3c/div\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"_otherNode"\x3e\x3c/div\x3e\r\n\r\n\x3c/div\x3e',
searchResults:null,_content:arcgisonline.sharing.geow.Content,_util:arcgisonline.sharing.util,_views:arcgisonline.sharing.dijit.views,_query:null,_keywords:null,_groupsNode:null,_esriNode:null,_otherNode:null,maxRecords:4,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").relatedSearch)},constructor:function(a){null!==a.searchResults&&c.connect(a.searchResults,
"onQueryExecute",this,this._search)},_search:function(a,e){this._query=a;this._keywords=e;null!==this._groupsNode&&e&&0<e.length&&this._content.search(esriGeowConfig.restBaseUrl+"community/groups",{q:this._keywords,num:this.maxRecords},c.hitch(this,this._handleGroupSearch));null!==this._esriNode&&this._content.search(esriGeowConfig.restBaseUrl+"search",{q:this._query.q+" "+esriGeowConfig.publisherESRI,num:this.maxRecords},c.hitch(this,this._handleSearchB))},_handleGroupSearch:function(a,e){a.results&&
0<a.results.length&&(c.create("span",{"class":"section",innerHTML:c.string.substitute(this.i18n.groupResults,[this._keywords])},this._groupsNode,"only"),c.forEach(a.results,function(a){c.place(this._views.group.small(a,!0,"left"),this._groupsNode)},this))},_handleSearchB:function(a,e){a.results&&0<a.results.length&&(c.create("span",{"class":"section",innerHTML:c.string.substitute(this.i18n.esriContent,[this._keywords])},this._esriNode,"only"),c.forEach(a.results,function(a){c.place(this._views.item.small(a,
!0,"left"),this._esriNode)},this))},_handleSearchC:function(a,e){a.results&&0<a.results.length&&c.forEach(a.results,function(a){c.place(this._views,this._otherNode)},this)}});c.declare("arcgisonline.sharing.dijit.SearchResultsPaging",[l._Widget,l._Templated],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cspan dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite light" dojoAttachPoint\x3d"_prev" dojoAttachEvent\x3d"onClick:previous" alt\x3d"${i18n.prevPage}" title\x3d"${i18n.prevPage}"\x3e${i18n.previous}\x3c/span\x3e\r\n  \x3cspan dojoAttachPoint\x3d"_pages" dojoAttachEvent\x3d"onClick:page" class\x3d"esriItemLinks esriPagingLinks" style\x3d"vertical-align: middle;"\x3e\x3c/span\x3e\r\n  \x3cspan dojoType\x3d"dijit.form.Button" type\x3d"button" class\x3d"calcite light" dojoAttachPoint\x3d"_next" dojoAttachEvent\x3d"onClick:next" alt\x3d"${i18n.nextPage}" title\x3d"${i18n.nextPage}"\x3e${i18n.next}\x3c/span\x3e\r\n\x3c/div\x3e',
widgetsInTemplate:!0,_prev:null,_next:null,_pages:null,searchResults:null,pageBuffer:3,_queryParams:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").searchResultsPaging)},postCreate:function(){null!==this.searchResults&&c.connect(this.searchResults,"onQueryResult",this,this._layout);this._queryParams=c.queryToObject(window.location.search.slice(1));
c.connect(this._prev,"onClick",this,this._disable);c.connect(this._next,"onClick",this,this._disable);this.searchResults.doAjax&&(c.connect(this,"first",this,this._disable),c.connect(this,"last",this,this._disable),c.connect(this,"page",this,this._disable));this._disable()},_disable:function(){this._prev.set("disabled","true");this._next.set("disabled","true")},_layout:function(){c.empty(this._pages);var a=1;this.searchResults.start&&(a=Math.ceil(this.searchResults.start/this.searchResults.resultsPerPage));
a>this.searchResults.pageCount&&(a=this.searchResults.pageCount);if(0===this.searchResults.resultCount)esri.hide(this._prev),esri.hide(this._next);else if(1<this.searchResults.pageCount){var e=Math.max(1,a-this.pageBuffer),f=Math.min(this.searchResults.pageCount,a+this.pageBuffer);1<e&&(c.create("span",{innerHTML:"1"},c.create("a",{onclick:c.hitch(this,this.page,1)},this._pages)),2<e&&c.create("span",{innerHTML:"...","class":"dim"},this._pages));for(;e<=f;e++){var d=c.create("span",{innerHTML:e},
c.create("a",{onclick:c.hitch(this,this.page,e)},this._pages));e==a&&c.addClass(d,"currentPage")}f<this.searchResults.pageCount&&(f<this.searchResults.pageCount-1&&c.create("span",{innerHTML:"...","class":"dim"},this._pages),c.create("span",{innerHTML:this.searchResults.pageCount},c.create("a",{onclick:c.hitch(this,this.page,this.searchResults.pageCount)},this._pages)))}this._prev.set("disabled",1!==this.searchResults.start?!1:!0);this._next.set("disabled",-1!==this.searchResults.nextStart?!1:!0)},
previous:function(){this.searchResults.previousPage()},next:function(){this.searchResults.nextPage()},first:function(){this.page(1)},last:function(){this.page(this.searchResults.pageCount)},page:function(a){this.searchResults.goToPage(a)}})})},"arcgisonline/sharing/dijit/UserProfile":function(){define("require dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/cookie dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/io-query dojo/json dojo/number dojo/on dojo/query dojo/string dojo/sniff dojo/when dojo/promise/all dojo/Deferred dojo/data/ItemFileReadStore dojo/store/Memory dojo/io/iframe dojox/html/entities dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Dialog dijit/form/Button dijit/form/FilteringSelect dijit/form/Form dijit/form/RadioButton dijit/layout/ContentPane dijit/Tooltip esri/lang ../../esriGeowConfig ../util ../../pages/pageUtil ../../pages/utils/culture ../../pages/utils/tooltips ../geow/Account ../geow/Community ../geow/Geow ../geow/Roles ./ComboBox ./Role ./_LevelAwareMixin ./dialog/ChoiceDlg ./dialog/DeleteWarningDlg ./dialog/GeneralDlg ./dialog/SubscriptionStatusDlg dojo/i18n!../../nls/arcgisonline dojo/text!./templates/UserProfile.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca,V,aa,ba,ea,Y,ha,Z,ga,W,ia,da,ma){return l("arcgisonline.sharing.dijit.UserProfile",[E,N,O,ha],{declaredClass:"arcgisonline.sharing.dijit.UserProfile",basePath:c.toUrl("arcgisonline/sharing/dijit"),baseClass:"esriUserProfile",templateString:ma,widgetsInTemplate:!0,LANDING_PAGES:{HOME:"index.html",GALLERY:"gallery.html",MAP:"webmap/viewer.html",SCENE:"webscene/viewer.html",GROUPS:"groups.html",CONTENT:"content.html",
ORGANIZATION:"organization.html"},_user:null,_showUser:null,_isOwner:!1,_profile:null,_isSingleTenant:!1,_userProviderRetrieved:!1,_proListing:null,noDescriptionText:"",thumbnailPath:null,thumbnailImage:null,label_fullName:null,label_description:null,label_privacy:null,label_username:null,label_defaultGroup:null,editForm:null,organization_link:null,coreRoleIds:"org_admin org_publisher org_user account_admin account_publisher account_user".split(" "),accountAdminRole:"account_admin",accountPublisherRole:"account_publisher",
accountUserRole:"account_user",accountViewerRole:"account_viewer",arcgisProvider:"arcgis",bothProvider:"both",enterpriseProvider:"enterprise",socialProviders:["google","facebook"],descriptionTextArea:null,descriptionEditorContainer:null,descriptionEditor:null,defaultGroupSelect:null,relatedLinks:null,questionSelect:null,questionAnswer:null,questionStore:null,newPassword:null,verifyNewPassword:null,newEmail:null,verifyNewEmail:null,languageSelect:null,regionSelect:null,reloadOnUpdate:!1,editConnects:[],
licenseKeywords:{proBasic:"desktopBasicN",proStandard:"desktopStdN",proAdvanced:"desktopAdvN",spatialAnalyst:"spatialAnalystN",threeDAnalyst:"3DAnalystN",networkAnalyst:"networkAnalystN",geostatAnalyst:"geostatAnalystN",dataReviewer:"dataReviewerN",workflowManager:"workflowMgrN",dataInterop:"dataInteropN",defenseMapping:"defenseN",fmv:"FMVN",businessBasic:"businessBasicN",businessStandard:"businessStdN",roadsHighways:"roadsHighwaysN",publisher:"publisherN",productionMap:"productionMapN",schematics:"schematicsN",
tracking:"trackingN",aviation:"aviationN",airports:"airportsN",maritime:"maritimeN",bathymetry:"bathymetryN",streetMapNA:"smpNAmericaN",streetMapEU:"smpEuropeN",streetMapAPAC:"smpAsiaPacificN",streetMapMEA:"smpMidEAfricaN",streetMapLA:"smpLAmericaN",streetMapJA:"smpJapanN"},landingPageToName:{},nameToLandingPage:{},postMixInProperties:function(){this.inherited(arguments);this.i18n=a.mixin(da.common,da.userProfile);this.i18n=a.mixin(this.i18n,da.siteHeader);this.i18n=a.mixin(this.i18n,{securityQuestions:da.securityQuestions,
licenseTypes:da.manageLicenses.licenseTypes,customRoles:da.customRoles,noDescriptionText:this.i18n.noDescriptionText})},postCreate:function(){this.inherited(arguments);this._readQueryParameters();this._isSingleTenant=void 0!==G.isMultiTenant&&null!==G.isMultiTenant&&!1===G.isMultiTenant;this.thumbnailImage.src=T.relativeToExplicitUrl("js/arcgisonline/css/images/transparent.gif");this._languageFormatHelpImg.src=T.relativeToExplicitUrl("js/arcgisonline/css/images/helpIcon.png");this._tooltipDialog=
new H({id:"roleSummaryDialog",style:{width:"315px",maxWidth:"315px",outline:"none"},content:""});this._languageFormatTooltip=X.createTooltip("languageFormatTooltip",this.i18n.learnNumDateFormat);G.userLicenseLevelsEnabled&&this.coreRoleIds.push(this.SYSTEM_ROLES.VIEWER);this._rolesAPI=new ba;this.own(v(this.languageSelect,"change",this.onLanguageChange.bind(this)))},destroy:function(){this.inherited(arguments);this._tooltipDialog.destroyRecursive();this._languageFormatTooltip.destroyRecursive()},
startup:function(){this.inherited(arguments);this._requireSecurity&&(this._requireSecurityHandler=v(this,"onProfileLoad",function(){this._requireSecurityHandler&&this._requireSecurityHandler.remove();if(this._requireSecurity)var a=setInterval(function(){this._userProviderRetrieved&&(clearInterval(a),this._startEdit(),I.createSpecifiedDialog(W).show({title:this.i18n.notice,message:this.i18n.noQuestionSetText}))}.bind(this),100)}.bind(this)));this._verifyEmail&&I.createSpecifiedDialog(W).show({title:this.i18n.confirmEmailTitle,
message:w.substitute(this.i18n.confirmEmailMsg,{email:this._verifyEmail})});ca.getSelf(this._initUI.bind(this))},_readQueryParameters:function(){var a=q.queryToObject(window.location.search.slice(1));a.user&&0<a.user.length&&(this._showUser=a.user);a.requireSecurity&&(this._requireSecurity=!0);a.verifyEmail&&(this._verifyEmail=T.stripHTML(a.verifyEmail));a.validateEmail&&(this._validateEmail=T.stripHTML(a.validateEmail),T.requireAuthentication())},_isDevSubscription:function(a){return a&&a.type&&
"trial developer"===a.type.toLowerCase()},_initUI:function(a){this._self=a;this._isDeveloperSubscription=this._isDevSubscription(this._self.subscriptionInfo);q.queryToObject(window.location.search.slice(1)).passwordReset&&I.createSpecifiedDialog(W).show({title:this.i18n.passwordChanged,message:this.i18n.passwordChangedMsg});this._oAuthInfo={url:T.getSecureUrl(G.restBaseUrl)+"oauth2/authorize",clientId:"arcgisonline",redirectUri:G.baseUrl+"postresetpassword.html",parent:window.location.protocol+"//"+
window.location.host,expiration:20160,locale:h.locale};if(T.isLoggedIn()){if((this._user=T.getUser())&&this._user.accountId&&this._user.role){this._isAdmin=G.userRole.isAdmin();if(this._isCustomRole=G.userRole.isCustom())this._roleCanView=this._isCustomRole&&G.userRole.canViewUsers(),this._roleCanUpdate=this._isCustomRole&&G.userRole.canUpdateUsers(),this._roleCanManageLicenses=this._isCustomRole&&G.userRole.canManageLicenses();this._isWebTierAuth=!1;if(T.isPortal()){var b=T.getCookie("esri_auth");
b.auth_tier&&"web"===b.auth_tier&&(this._isWebTierAuth=!0,b=d.byId("landing_page_edit"),p.set(b,"display","none"),g.remove(b,"ownerOnly"))}}this._personalInfoEditable=this._user&&this._user.accountId&&!this._isAdmin?a.updateUserProfileDisabled?!a.updateUserProfileDisabled:!0:!0;this._isOwner=this._showUser?this._user.email===this._showUser:!0}else this._showUser||T.requireAuthentication();a=k.create;this.noDescriptionText=a("span");b=a("span");if(this._isOwner){a("span",{innerHTML:this.i18n.writeSomething},
b);var c=a("ul",null,b);a("li",{innerHTML:this.i18n.yourOrg},c);a("li",{innerHTML:this.i18n.contactInfo},c);a("li",{innerHTML:this.i18n.areaOfExpertise},c);a("li",{innerHTML:this.i18n.interests},c);a("li",{innerHTML:this.i18n.anyOtherInfo},c)}else a("span",{id:"noDescriptionSpan",innerHTML:this.i18n.userNoInfo},b);this.noDescriptionText=a("span").appendChild(b).innerHTML;d.byId("user_profile_edit_title").innerHTML="\x3cb\x3e"+this.i18n.userNameLabel+"\x3c/b\x3e";G.useDefaultIdentityStore?p.set(d.byId("user_profile_edit_link"),
"display","none"):G.account_edit||p.set(d.byId("user_profile_edit_link"),"display","none");this._user&&this._user.accountId&&this._user.role&&this._user.role?(a("a",{href:"organization.html",innerHTML:this.i18n.myOrg},this.organization_link,"only"),10>=t("ie")?p.set(d.byId("organization_link_div"),"display",""):p.set(d.byId("organization_link_div"),"display","block")):p.set(d.byId("organization_link_div"),"display","none");this._isOwner||(a("a",{id:"viewItemsLink",href:G.baseUrl+"search.html?q\x3downer:"+
this._showUser+"#content",innerHTML:this.i18n.viewItems},a("div",null,this.relatedLinks)),a("a",{id:"viewGroupsLink",href:G.baseUrl+"search.html?q\x3downer:"+this._showUser+"#groups",innerHTML:this.i18n.viewGroups},a("div",null,this.relatedLinks)));this._isOwner&&u(".ownerOnly",this.domNode).style("display","block");this._user&&!this._user.accountId&&u(".readOrgOnly",this.domNode).style("display","none");u(".editOrgOnly",this.domNode).style("display","none");this._isSingleTenant?p.set(d.byId("region_edit"),
"display","none"):p.set(this.region_setting,"display","");G.showAccountSwitcher&&!this._showUser&&g.remove(this._manageLinkedAccounts,"hide");"ja"===h.locale&&k.place(d.byId("lastNameProperty"),d.byId("firstNameProperty"),"before");y(ca.getSupportedLanguagesAndRegions(),function(a){a&&(this._initLanguage(a.languages),this._initRegion(a.regions),a=this._username=this._isOwner?this._user.email:this._showUser,V.getProfile(a,this._handle_getProfile.bind(this)))}.bind(this),this._handleError.bind(this));
this._initUnits()},_getUserProperties:function(){return T.request({url:G.restBaseUrl+"community/users/"+this._username+"/properties"})},_updateUserProperties:function(a){return T.request({url:G.restBaseUrl+"community/users/"+this._username+"/setProperties",content:{properties:n.stringify(a)}},{usePost:!0})},_getUserProvider:function(){var a=new x;return T.request({url:G.restBaseUrl+"community/users/"+this._username+"/forgotPassword"},{}).then(function(b){this._userProviderRetrieved=!0;this._user&&
this._isOwner?(this._user.provider=b.provider,"ecas"===this._user.provider&&p.set(this.editUsernameLink,"display","inline-block"),this._checkSocialProvider(this._user.provider,!1),-1<b.securityQuestionIdx&&(this._securityIdx=b.securityQuestionIdx)):this._profile&&(this._profile.provider=b.provider,this._checkSocialProvider(this._profile.provider,!0),-1<b.securityQuestionIdx&&(this._securityIdx=b.securityQuestionIdx));a.resolve()}.bind(this),function(){a.resolve()}.bind(this))},_checkSocialProvider:function(a,
d){var c,e;I.includes(["google","facebook"],a)?("google"===a?(c=d?this.i18n.providerGoogle:this.i18n.signedInGoogle,e="./pages/Account/images/small_circle_google.png"):"facebook"===a&&(c=d?this.i18n.providerFacebook:this.i18n.signedInFacebook,e="./pages/Account/images/small_circle_facebook.png"),b.set(this._socialIcon,"src",e),b.set(this._socialIcon,"alt",c),b.set(this._socialIcon,"title",c),p.set(this._socialIcon,"display","")):p.set(this._socialIcon,"display","none")},_initLanguage:function(a){if(a){b.set("languageFormatHelpLink",
"href",this._self.helpBase+(this._self.helpMap.m["120001488"]||""));var d=[];e.forEach(a,function(a){a.displayName=A.decode(a.language+(a.localizedName?" - "+a.localizedName:"")+"\x26lrm;");a.cultureFormats&&a.cultureFormats.length&&a.cultureFormats.forEach(function(a){a.displayName=A.decode(a.name+(a.localizedName?" - "+a.localizedName:"")+"\x26lrm;")});d.push(a)},this);a=new z({idProperty:"culture",label:"displayName",data:d});this.languageSelect.set("store",a);this.languageSelect.set("searchAttr",
"displayName")}},_initRegion:function(a){a&&(a=new B({data:{identifier:"region",label:"localizedName",items:a}}),this.regionSelect.set("store",a),this.regionSelect.set("searchAttr","localizedName"))},_initUnits:function(){if(!S.isDefined(this.unitsStore)){var a=new B({data:{identifier:"id",label:"name",items:[{id:"english",name:this.i18n.unitsEnglish},{id:"metric",name:this.i18n.unitsMetric}]}});this.unitsSelect.set("store",a)}},_initLandingPage:function(){this._initLandingPageMappings();var a=this._getAvailableLandingPages(),
d=this._getCurrentLandingPage(),d=this.landingPageToName[d],a=new B({data:{identifier:"page",label:"name",items:a}});this.landingPageSelect.set("store",a);b.set(this.landing_page_setting,"innerHTML",d);this.landingPageSelect.set("displayedValue",d)},_initLandingPageMappings:function(){Object.keys(this.LANDING_PAGES).forEach(function(a){a=this.LANDING_PAGES[a];var b;switch(a){case this.LANDING_PAGES.HOME:b=this.i18n.simpleHome;break;case this.LANDING_PAGES.GALLERY:b=this.i18n.gallery;break;case this.LANDING_PAGES.MAP:b=
this.i18n.map;break;case this.LANDING_PAGES.SCENE:b=this.i18n.scene;break;case this.LANDING_PAGES.GROUPS:b=this.i18n.groups;break;case this.LANDING_PAGES.CONTENT:b=this.i18n.myContent;break;case this.LANDING_PAGES.ORGANIZATION:b=this.i18n.myAccount}b&&this._createLandingPageMapping(a,b)},this)},_createLandingPageMapping:function(a,b){this.landingPageToName[a]=b;this.nameToLandingPage[b]=a},_getAvailableLandingPages:function(){var a=[{page:this.LANDING_PAGES.HOME,name:this.landingPageToName[this.LANDING_PAGES.HOME]},
{page:this.LANDING_PAGES.GALLERY,name:this.landingPageToName[this.LANDING_PAGES.GALLERY]},{page:this.LANDING_PAGES.MAP,name:this.landingPageToName[this.LANDING_PAGES.MAP]},{page:this.LANDING_PAGES.SCENE,name:this.landingPageToName[this.LANDING_PAGES.SCENE]}],b=this._profile.userRole;b&&b.canCreateGroup()&&a.push({page:this.LANDING_PAGES.GROUPS,name:this.landingPageToName[this.LANDING_PAGES.GROUPS]});b&&b.canCreateItem()&&a.push({page:this.LANDING_PAGES.CONTENT,name:this.landingPageToName[this.LANDING_PAGES.CONTENT]});
b&&b.canViewOrgUsers()&&a.push({page:this.LANDING_PAGES.ORGANIZATION,name:this.landingPageToName[this.LANDING_PAGES.ORGANIZATION]});return a},_getCurrentLandingPage:function(){var a=T.isPortal(),b=this._profile.properties&&this._profile.properties.landingPage?this._profile.properties.landingPage.url:void 0,d=this._profile.userRole;return b?b:d&&(!a||a&&!G.restrictOrganizationPageToAdmin)&&d.isBasedOnAdmin()||a&&G.restrictOrganizationPageToAdmin&&d.isAdmin()?this.LANDING_PAGES.ORGANIZATION:this.LANDING_PAGES.HOME},
_loadProfile:function(a){var c=q.queryToObject(window.location.search.substring(1));if(a.culture&&h.locale!==a.culture.toLowerCase()&&!c.locale&&(c=T.getCookie("esri_auth"))&&(c.username=c.username||c.email,c&&c.username===a.username)){if(9>t("ie")&&c.auth_tier&&"web"===c.auth_tier){var e=new Date;c.expires=new Date(e.setSeconds(e.getSeconds()+Number(7200)))}if(!c.culture||c.culture&&c.culture.toLowerCase()!==a.culture.toLowerCase())c.culture=a.culture.toLowerCase(),aa.setAuthCookie(c),f("arcgisLocale",
c.culture);window.location.reload()}this.thumbnailImage.src=a.thumbnail&&0<a.thumbnail.length?V.getProfileThumbnailUrl(a):T.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");a.firstName&&a.lastName?(b.set(this._profileTitle,"innerHTML",w.substitute(this.i18n.profileTitleLabel,{name:a.firstName})),b.set(this._firstNameLabel,"innerHTML",a.firstName),b.set(this._lastNameLabel,"innerHTML",a.lastName)):(b.set(this._profileTitle,"innerHTML",w.substitute(this.i18n.profileTitleLabel,{name:w.trim(a.fullName)})),
this._isEnterpriseUser(),c=a.fullName.indexOf(" "),0<c?a.culture&&"ja"===a.culture?(b.set(this._lastNameLabel,"innerHTML",a.fullName.substring(0,c)),b.set(this._firstNameLabel,"innerHTML",a.fullName.substring(c+1))):(b.set(this._firstNameLabel,"innerHTML",a.fullName.substring(0,c)),b.set(this._lastNameLabel,"innerHTML",a.fullName.substring(c+1))):b.set(this._firstNameLabel,"innerHTML",a.fullName));c=k.create;T.htmlHasText(a.description)?(e=T.linkifyText(a.description),8>t("ie")&&(e="\x3cpre class\x3d'esriProfileDesc'\x3e"+
e+"\x3c/pre\x3e"),c("span",{innerHTML:e,style:"white-space:pre-wrap"},this.label_description,"only")):(c("span",{innerHTML:this._personalInfoEditable?this.noDescriptionText:"","class":"dim"},this.label_description,"only"),!this._isOwner&&this._user&&this._user.accountId&&a.accountId&&this._user.accountId===a.accountId&&b.set("noDescriptionSpan","innerHTML",this.i18n.memberNoDescriptionText));c("span",{innerHTML:"public"===a.access?this.i18n.everyone:"org"===a.access?this.i18n.organization:this.i18n.noonePrivate},
this.label_privacy,"only");c("span",{innerHTML:a.username},this.label_username,"only");a.culture=D.getActualCulture(a.culture,this.languageSelect.get("store").query());this.set("culture",a.culture);this.set("cultureFormat",a.cultureFormat);this.set("region",a.region);this.set("units",a.units);a.role&&this._createRoleInfo(a.role,a.roleId,a.privileges);"enabled"!==this._self.creditAssignments&&"validated"!==this._self.creditAssignments||!this._self.portalProperties||!0!==this._self.portalProperties.showCreditsOnProfile||
!this._isAdmin&&!this._isOwner?p.set(d.byId("credits_div"),"display","none"):(b.set(this.available_credits,"innerHTML",r.format(-1===a.availableCredits?a.assignedCredits:a.availableCredits)),p.set(d.byId("credits_div"),"display",""));this._self.mfaEnabled&&G.multiFactorEnabled&&!T.isPortal()&&!this._isDeveloperSubscription&&this._isArcGISUser()&&(this._isAdmin||this._isOwner)&&this._user.accountId&&this._profile.accountId&&this._user.accountId===this._profile.accountId?(p.set(d.byId("mfa_edit"),"display",
""),a.mfaEnabled?(b.set(this.mfa_setting,"innerHTML",this.i18n.enabledLabel),p.set(this._enableMFA.domNode,"display","none"),p.set(this._disableMFA.domNode,"display","")):(b.set(this.mfa_setting,"innerHTML",this.i18n.disabledLabel),p.set(this._disableMFA.domNode,"display","none"),p.set(this._enableMFA.domNode,"display",""))):p.set(d.byId("mfa_edit"),"display","none");(this._isArcGISUser()||this._isSocialUser())&&(this._user&&!this._user.accountId&&this._isOwner||G.userRole&&G.userRole.isAdmin())?
(this.newEmail.set("value",a.email),this.verifyNewEmail.set("value",""),b.set(this._displayEmail,"innerHTML",a.email)):this._isEnterpriseUser()?b.set(this._displayEmail,"innerHTML",a.email):p.set(d.byId("user_email_edit"),"display","none");(this._isOwner||this._isAdmin||this._roleCanView&&this._roleCanManageLicenses)&&this._user.accountId&&this._profile.accountId&&V.getProvisionedListings(this._profile.username,1,100).then(function(a){a&&a.provisionedListings?(this._writeListingEntitlements(a.provisionedListings),
p.set(d.byId("licensed_for_div"),"display","")):p.set(d.byId("licensed_for_div"),"display","none")}.bind(this),function(){p.set(d.byId("licensed_for_div"),"display","none")}.bind(this));this._toggleEsriPreferences();this._initLandingPage()},_createRoleInfo:function(a,c,e){var f=this.organization_role,g="",m=T.relativeToExplicitUrl("js/arcgisonline/css/images/info.png"),n=this.i18n.customRoles.roleInfo,D=k.create("img",{src:m,alt:n,title:n,"class":"role-info"});S.isDefined(c)?this._rolesAPI.getRole(c).then(function(a){a&&
a.name&&(G.userRole.name=g=a.name,G.userRole.description=a.description,b.set(f,"innerHTML",g+"\x26nbsp;"),this.own(v(D,"click",this._openRoleSummary.bind(this,c,g,a.description,e))),k.place(D,f,"last"))}.bind(this)):(this.accountAdminRole!==a||S.isDefined(c)?this.accountPublisherRole!==a||S.isDefined(c)?this.accountUserRole!==a||S.isDefined(c)?c===this.SYSTEM_ROLES.VIEWER&&(g=this.i18n.viewerRole):g=this.i18n.userRole:g=this.i18n.publisherRole:g=this.i18n.adminRole,b.set(f,"innerHTML",g+"\x26nbsp;"),
this.own(v(D,"click",this._openRoleSummary.bind(this,a,g,null,null))),k.place(D,f,"last"));t("ie")?p.set(d.byId("organization_role_div"),"display",""):p.set(d.byId("organization_role_div"),"display","block")},_openRoleSummary:function(a,b,d,c){var f='\x3cdiv class\x3d"roleSummary"\x3e\x3cstrong\x3e'+this.i18n.customRoles.descriptionLabel+'\x3c/strong\x3e\x3cp class\x3d"word-wrap"\x3e'+d+"\x3c/p\x3e",k=d=!1;I.includes(this.coreRoleIds,a)?(f='\x3cdiv class\x3d"roleSummary"\x3e\x3cstrong\x3e'+this.i18n.customRoles.descriptionLabel+
"\x3c/strong\x3e\x3cbr/\x3e",f="org_admin"===a||"account_admin"===a?f+("\x3cp\x3e"+(this._isPortal?this.i18n.customRoles.adminDescriptionPortal:this.i18n.customRoles.adminDescription)+"\x3c/p\x3e"):"org_publisher"===a||"account_publisher"===a?f+("\x3cp\x3e"+this.i18n.customRoles.publisherDescription+"\x3c/p\x3e"):G.userLicenseLevelsEnabled&&a===this.SYSTEM_ROLES.VIEWER?f+("\x3cp\x3e"+(this._isPortal?this.i18n.customRoles.viewerDescriptionPortal:this.i18n.customRoles.viewerDescription)+"\x3c/p\x3e"):
f+("\x3cp\x3e"+this.i18n.customRoles.userDescription+"\x3c/p\x3e"),f+="\x3cp\x3e"+this.i18n.customRoles.coreRole+"\x3c/p\x3e\x3c/div\x3e"):(a=new Y({id:a}),a.setPrivileges(c),f+="\x3cstrong\x3e"+this.i18n.customRoles.rolePrivilegesLabel+"\x3c/strong\x3e",c&&0<c.length?(f+='\x3cdiv class\x3d"roleSummaryList"\x3e\x3cul class\x3d"privlist"\x3e',a.summarize().forEach(function(a){f+="\x3cli\x3e"+a+"\x3c/li\x3e"},this),f+="\x3c/ul\x3e\x3c/div\x3e"):f+="\x3cp\x3e\x3cem\x3e"+this.i18n.customRoles.noneGranted+
"\x3c/em\x3e\x3c/p\x3e",d=e.some(c,function(a){return-1<a.indexOf(":admin:")},this),k=e.some(c,function(a){return-1<a.indexOf(":publisher:")},this),d?f+="\x3cp\x3e\x3cem\x3e"+this.i18n.customRoles.containsAdmin+"\x3c/em\x3e\x3c/p\x3e":k&&(f+="\x3cp\x3e\x3cem\x3e"+this.i18n.customRoles.containsPublisher+"\x3c/em\x3e\x3c/p\x3e"),f+="\x3c/div\x3e");g.add(this._tooltipDialog.titleNode,"force-word-wrap");this._tooltipDialog.set("title",b);this._tooltipDialog.set("content",f);this._tooltipDialog.show();
this._tooltipDialog.focus()},_summarizeRole:function(a,b){a=new Y({id:a});a.setPrivileges(b);return a.summarize()},_openEsriPreferences:function(){window.location=w.substitute(G.esriPreferencesPostLink,{email:this._profile.email})},_toggleEsriPreferences:function(){this._isOwner&&"both"===this._profile.userType?p.set(d.byId("preferences_div"),"display",""):p.set(d.byId("preferences_div"),"display","none")},_openManageAccounts:function(){window.open(G.baseUrl+"pages/Account/manage_accounts.html#client_id\x3darcgisonline\x26window_title\x3dmanageAccounts",
"_blank").focus()},_writeListingEntitlements:function(a){var c=d.byId("licensed_products_list"),e=[],f;b.set(c,"innerHTML","");for(var g=0;g<a.length;g++)c=a[g],T.isProApp(c)?f=c:e.push(c);f?this._writeProLicenseEntitlements(f,this._profile.username).then(function(){this._writeAdditionalProductEntitlements(e)}.bind(this),function(){this._writeAdditionalProductEntitlements(e)}.bind(this)):this._writeAdditionalProductEntitlements(e)},_writeAdditionalProductEntitlements:function(a){var c=d.byId("licensed_products_list"),
e=b.get(c,"innerHTML");a.forEach(function(a){"licenseByUser"===a.licenseBy&&(e+=a.title+"\x3cbr\x3e")},this);b.set(c,"innerHTML",e)},_writeProLicenseEntitlements:function(a,b){var d=new x;T.request({url:G.restBaseUrl+"content/listings/"+a.itemId+"/userEntitlements/"+b}).then(function(b){b&&b.userEntitlements&&b.userEntitlements.entitlements&&this._writeProLicenseEntitlement(a,b.userEntitlements.entitlements);d.resolve()}.bind(this),function(){d.resolve()}.bind(this));return d},_writeProLicenseEntitlement:function(a,
c){var e=d.byId("licensed_products_list"),f="";a=a.title+" ";I.includes(c,this.licenseKeywords.proBasic)?a+=this.i18n.licenseTypes.basicLabel:I.includes(c,this.licenseKeywords.proStandard)?a+=this.i18n.licenseTypes.standardLabel:I.includes(c,this.licenseKeywords.proAdvanced)&&(a+=this.i18n.licenseTypes.advancedLabel);f+=a+"\x3cbr\x3e";c.forEach(function(a){a===this.licenseKeywords.spatialAnalyst?f+=this.i18n.licenseTypes.spatialAnalyst+"\x3cbr\x3e":a===this.licenseKeywords.threeDAnalyst?f+=this.i18n.licenseTypes.threeDAnalyst+
"\x3cbr\x3e":a===this.licenseKeywords.networkAnalyst?f+=this.i18n.licenseTypes.networkAnalyst+"\x3cbr\x3e":a===this.licenseKeywords.geostatAnalyst?f+=this.i18n.licenseTypes.geostatisticalAnalyst+"\x3cbr\x3e":a===this.licenseKeywords.dataReviewer?f+=this.i18n.licenseTypes.dataReviewer+"\x3cbr\x3e":a===this.licenseKeywords.workflowManager?f+=this.i18n.licenseTypes.workflowManager+"\x3cbr\x3e":a===this.licenseKeywords.dataInterop?f+=this.i18n.licenseTypes.dataInterop+"\x3cbr\x3e":a===this.licenseKeywords.defenseMapping?
f+=this.i18n.licenseTypes.defenseMapping+"\x3cbr\x3e":a===this.licenseKeywords.fmv?f+=this.i18n.licenseTypes.fullMotionVideo+"\x3cbr\x3e":a===this.licenseKeywords.businessBasic?f+=this.i18n.licenseTypes.businessBasic+"\x3cbr\x3e":a===this.licenseKeywords.businessStandard?f+=this.i18n.licenseTypes.businessStd+"\x3cbr\x3e":a===this.licenseKeywords.roadsHighways?f+=this.i18n.licenseTypes.roadsHighways+"\x3cbr\x3e":a===this.licenseKeywords.publisher?f+=this.i18n.licenseTypes.publisher+"\x3cbr\x3e":a===
this.licenseKeywords.productionMap?f+=this.i18n.licenseTypes.productionMapping+"\x3cbr\x3e":a===this.licenseKeywords.schematics?f+=this.i18n.licenseTypes.schematics+"\x3cbr\x3e":a===this.licenseKeywords.tracking?f+=this.i18n.licenseTypes.tracking+"\x3cbr\x3e":a===this.licenseKeywords.aviation?f+=this.i18n.licenseTypes.aviation+"\x3cbr\x3e":a===this.licenseKeywords.airports?f+=this.i18n.licenseTypes.airports+"\x3cbr\x3e":a===this.licenseKeywords.maritime?f+=this.i18n.licenseTypes.maritime+"\x3cbr\x3e":
a===this.licenseKeywords.bathymetry&&(f+=this.i18n.licenseTypes.bathymetry+"\x3cbr\x3e")}.bind(this));b.set(e,"innerHTML",f)},_loadProfileEdit:function(a){this.descriptionTextArea.value=a.description||"";"public"===a.access?K.byId("privacy_public").set("checked",!0):"org"===a.access?K.byId("privacy_account").set("checked",!0):K.byId("privacy_private").set("checked",!0);this._profile.accountId&&(this._self.canSharePublic||this._isAdmin?p.set(d.byId("privacy_public_span"),"display",""):(p.set(d.byId("privacy_public_span"),
"display","none"),"public"===this._profile.access&&K.byId("privacy_account").set("checked",!0)))},_startEdit:function(){this._loadProfileEdit(this._profile);if(this._isArcGISUser()&&this._isOwner){p.set(d.byId("new_password_edit"),"display","");p.set(d.byId("question_edit"),"display","");p.set(d.byId("answer_edit"),"display","");this.questionSelect.set("displayedValue",this.i18n.questionPrompt);this.questionAnswer.set("value","");S.isDefined(this.questionStore)||(this.securityQuestionsArr=[{id:1,
name:this.i18n.securityQuestions[1]},{id:2,name:this.i18n.securityQuestions[2]},{id:3,name:this.i18n.securityQuestions[3]},{id:4,name:this.i18n.securityQuestions[4]},{id:5,name:this.i18n.securityQuestions[5]},{id:6,name:this.i18n.securityQuestions[6]},{id:7,name:this.i18n.securityQuestions[7]},{id:8,name:this.i18n.securityQuestions[8]},{id:9,name:this.i18n.securityQuestions[9]},{id:10,name:this.i18n.securityQuestions[10]},{id:11,name:this.i18n.securityQuestions[11]},{id:12,name:this.i18n.securityQuestions[12]},
{id:13,name:this.i18n.securityQuestions[13]},{id:14,name:this.i18n.securityQuestions[14]}],this.questionStore=new B({data:{identifier:"id",label:"name",items:this.securityQuestionsArr}}),this.questionSelect.set("store",this.questionStore));this.questionSelect.set("displayedValue",-1<this._securityIdx?this.i18n.securityQuestions[this._securityIdx]:this.i18n.questionPrompt);var a=!S.isDefined(this._securityIdx)||S.isDefined(this._securityIdx)&&0>this._securityIdx,c=d.byId("security-question"),e=d.byId("security-answer");
dojo[a?"removeClass":"addClass"](this._securityQuestionRequired,"hide");dojo[a?"removeClass":"addClass"](this._securityAnswerRequired,"hide");a?(this.questionSelect.set("required",!0),this.questionAnswer.set("required",!0),c.setAttribute("required",""),c.setAttribute("aria-required",!0),e.setAttribute("required",""),e.setAttribute("aria-required",!0)):(this.questionSelect.set("required",!1),this.questionAnswer.set("required",!1),c.removeAttribute("required"),c.removeAttribute("aria-required"),e.removeAttribute("required"),
e.removeAttribute("aria-required"))}u(".readOnly",this.domNode).style("display","none");u(".readOrgOnly",this.domNode).style("display","none");u(".editOnlyBtn",this.domNode).style("display","");u(".editOnly",this.domNode).style("display","block");this._profile.accountId?(u(".editOrgOnly",this.domNode).style("display",""),u(".editNonOrgOnly",this.domNode).style("display","none")):(u(".editOrgOnly",this.domNode).style("display","none"),u(".editNonOrgOnly",this.domNode).style("display","block"));this._isEnterpriseUser()&&
(p.set(this._emailEditContainer,"display","none"),p.set(this._emailDisplayContainer,"display",""));this._isArcGISUser()&&this._profile&&this._user.username!==this._profile.username&&!this._profile.mfaEnabled&&(p.set(this.mfa_setting.parentNode,"display",""),p.set(this._enableMFA.domNode.parentNode,"display","none"));(!this._profile.accountId||""===this._profile.accountId||void 0!==G.isMultiTenant&&!1===G.isMultiTenant)&&p.set(d.byId("privacy_organization_span"),"display","none");this._profile.firstName&&
b.set("first_name","value",this._profile.firstName);this._profile.lastName&&b.set("last_name","value",this._profile.lastName);this._isEnterpriseUser()&&this._isNotSet(this._profile.firstName)&&this._isNotSet(this._profile.lastName)?(a=this._profile.fullName.indexOf(" "),0<a?this._profile.culture&&"ja"===this._profile.culture?(b.set("last_name","value",this._profile.fullName.substring(0,a)),b.set("name_name","value",this._profile.fullName.substring(a+1))):(b.set("first_name","value",this._profile.fullName.substring(0,
a)),b.set("last_name","value",this._profile.fullName.substring(a+1))):b.set("first_name","value",this._profile.fullName)):this._isNotSet(this._profile.firstName)&&this._isNotSet(this._profile.lastName)&&(a=this._profile.fullName.indexOf(" "),0<a?this._profile.culture&&"ja"===this._profile.culture?(b.set("last_name","value",this._profile.fullName.substring(0,a)),b.set("name_name","value",this._profile.fullName.substring(a+1))):(b.set("first_name","value",this._profile.fullName.substring(0,a)),b.set("last_name",
"value",this._profile.fullName.substring(a+1))):b.set("first_name","value",this._profile.fullName));G.useDefaultIdentityStore||this._isArcGISUser()||this._isEnterpriseUser()||this._isSocialUser()||(p.set(this._firstNameInput,"display","none"),p.set(this._lastNameInput,"display","none"),p.set(this._firstNameLabel,"display",""),p.set(this._lastNameLabel,"display",""));this._personalInfoEditable||(p.set(this.descriptionTextArea,"display","none"),p.set(this.label_description,"display",""),p.set(this.edit_privacy,
"display","none"),p.set(this.label_privacy,"display",""));this.editConnects.push(v(this.thumbnailImage,"click",this._showThumbnailDialog.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-close"),"click",this._thumbnailCancel.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-ok"),"click",this._thumbnailOk.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-cancel"),"click",this._thumbnailCancel.bind(this)))},_isNotSet:function(a){return!a||0===a.length},_isArcGISUser:function(){return this._isOwner&&
S.isDefined(this._user.provider)&&this._user.provider===this.arcgisProvider||!this._isOwner&&S.isDefined(this._profile.provider)&&this._profile.provider===this.arcgisProvider},_isEnterpriseUser:function(){return this._isOwner&&S.isDefined(this._user.provider)&&this._user.provider===this.enterpriseProvider||!this._isOwner&&S.isDefined(this._profile.provider)&&this._profile.provider===this.enterpriseProvider},_isSocialUser:function(){return this._isOwner&&S.isDefined(this._user.provider)&&I.includes(this.socialProviders,
this._user.provider)||!this._isOwner&&S.isDefined(this._profile.provider)&&I.includes(this.socialProviders,this._profile.provider)},_hasNewIdentityQuestion:function(){var a=this.questionAnswer.get("value"),b=this.questionSelect.get("item");return S.isDefined(b)&&this.questionStore.getValue(b,"id")!==this._securityIdx&&a&&a.length},_hasNewIdentityQuestionInfo:function(){var a=this.questionAnswer.get("value"),b=this.questionSelect.get("item");return S.isDefined(b)&&this.questionStore.getValue(b,"id")!==
this._securityIdx||a&&0<a.length},_validateNewIdentityQuestionInfo:function(){var a=this.questionAnswer.get("value");if(S.isDefined(a)&&0<a.length)return 60<a.length?(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.answerTooLong}),this.questionAnswer.focus(),!1):!0;I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.answerIsBlank});this.questionAnswer.focus();return!1},_containsAlphaNumeric:function(a){var b=/^[a-zA-Z0-9@_\.\-\s]+$/g;
return a&&b.test(a)},_hasNewEmail:function(){var a=this.newEmail.get("value"),b=this.verifyNewEmail.get("value");return S.isDefined(a)&&0<a.length&&a!==this._profile.email||S.isDefined(b)&&0<b.length},_validateNewEmail:function(){var a=this.newEmail.get("value"),b=this.verifyNewEmail.get("value");if(S.isDefined(a)&&0<a.length)return this._isValidEmail(a)?a!==b?(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.emailVerifyNoMatch}),this.verifyNewEmail.focus(),!1):
!0:(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.emailInvalid}),this.verifyNewEmail.focus(),!1);S.isDefined(b)&&0<b.length&&(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.emailVerifyNoMatch}),this.newEmail.focus());return!1},_isValidEmail:function(a){var b=/^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,20}|[0-9]{1,3})(\]?)$/;return!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(a)&&b.test(a)?!0:!1},_hasNewPassword:function(){var a=this.newPassword.get("value"),
b=this.verifyNewPassword.get("value");return S.isDefined(a)&&0<a.length||S.isDefined(b)&&0<b.length},_validateNewPassword:function(){var a=this.newPassword.get("value"),b=this.verifyNewPassword.get("value");if(S.isDefined(a)&&0<a.length)return T.meetsPasswordStrength(a)?a!==b?(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.passwordVerifyNoMatch}),this.verifyNewPassword.focus(),!1):!0:(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.passwordHintText}),
this.newPassword.focus(),!1);S.isDefined(b)&&0<b.length&&(I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.passwordVerifyNoMatch}),this.newPassword.focus());return!1},_validateFirstName:function(){var a=this.firstName.get("value");if(S.isDefined(a)&&0<a.length)return!0;I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.firstNameIsBlank});this.firstName.focus();return!1},_validateLastName:function(){var a=this.lastName.get("value");if(S.isDefined(a)&&
0<a.length)return!0;I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.lastNameIsBlank});this.lastName.focus();return!1},_validates:function(){return this._validateFirstName()&&this._validateLastName()?T.isPortal()&&!G.self.supportsOAuth&&this._hasNewPassword()&&!this._validateNewPassword()?(this.newPassword&&this.newPassword.focus(),!1):this._hasNewIdentityQuestionInfo()&&!this._validateNewIdentityQuestionInfo()?(this.questionAnswer&&this.questionAnswer.focus(),!1):!0:
!1},_createField:function(a,b,d){return k.create("input",{type:"hidden",name:b,value:d},a)},_saveEdit:function(){if(this._validates()){var a=this.editForm,d=[],c=this._profile.properties||{},e,f,g,k,m,D;d.push(this._createField(a,"username",this._profile.username));G.useDefaultIdentityStore||this._isArcGISUser()||this._isEnterpriseUser()||this._isSocialUser()?(e=b.get("first_name","value"),f=b.get("last_name","value"),d.push(this._createField(a,"firstName",e)),d.push(this._createField(a,"lastName",
f)),this._isEnterpriseUser()&&(g="ja"===h.locale?f+" "+e:e+" "+f,d.push(this._createField(a,"fullName",g))),this.reloadOnUpdate=this._isEnterpriseUser()?g!==this._profile.fullName:e!==this._profile.firstName||f!==this._profile.lastName):(d.push(this._createField(a,"firstName",this._profile.firstName)),d.push(this._createField(a,"lastName",this._profile.lastName)));this._personalInfoEditable&&(d.push(this._createField(a,"tags",this._profile.tags?this._profile.tags.toString():"")),e=T.stripHTML(this.descriptionTextArea.value),
d.push(this._createField(a,"description",e)),""===e&&d.push(this._createField(a,"clearEmptyFields",!0)),e=!0===K.byId("privacy_public").get("checked")?"public":!0===K.byId("privacy_account").get("checked")?"org":"private",d.push(this._createField(a,"access",e)));this._profile.accountId&&(c.landingPage={url:this.landingPageSelect.get("value")},d.push(this._createField(a,"properties",n.stringify(c))));if(k=(e=this.languageSelect.get("store").query({displayName:this.languageSelect.get("displayedValue")}).shift())&&
e.culture?e.culture:void 0)e&&e.cultureFormats?(e=(e=this.languageFormatSelect.get("store").query({format:this.languageFormatSelect.get("value")}).shift())&&e.format||void 0,d.push(this._createField(a,"culture",k+(e?"-"+e:""))),d.push(this._createField(a,"cultureFormat",e?e:"")),e||d.push(this._createField(a,"clearEmptyFields",!0))):(d.push(this._createField(a,"culture",k)),d.push(this._createField(a,"cultureFormat","")),d.push(this._createField(a,"clearEmptyFields",!0)));this.regionSelect.get("store").fetch({query:{localizedName:this.regionSelect.get("displayedValue")},
onItem:function(b){b&&(m=this.regionSelect.get("store").getValue(b,"region"),d.push(this._createField(a,"region",m)))}.bind(this)});this.unitsSelect.get("store").fetch({query:{name:this.unitsSelect.get("displayedValue")},onItem:function(b){b&&(D=this.unitsSelect.get("store").getValue(b,"id"),d.push(this._createField(a,"units",D)))}.bind(this)});var p=!1;e=!1;f=this._requireSecurity&&!this._hasNewIdentityQuestion();if(this._isArcGISUser()||this._isSocialUser())if(this._hasNewEmail()&&(this._validateNewEmail()?
(d.push(this._createField(a,"email",this.newEmail.get("value"))),this._isOwner&&!this._profile.orgId&&(this._emailMustBeVerified=this.newEmail.get("value"))):e=!0),T.isPortal()&&!G.self.supportsOAuth&&this._hasNewPassword()&&this._validateNewPassword()&&(p=!0,d.push(this._createField(a,"password",this.newPassword.get("value")))),this._hasNewIdentityQuestionInfo()&&this._validateNewIdentityQuestionInfo()){var q=this.questionSelect.get("store"),r=this.questionSelect.get("displayedValue"),t=this.questionSelect.get("item"),
l;if(t)l=q.getValue(t,"id");else for(q=0;q<this.securityQuestionsArr.length;q++)if(r===this.securityQuestionsArr[q].name){l=this.securityQuestionsArr[q].id;break}this._securityIdx=l;d.push(this._createField(a,"securityQuestionIdx",l));d.push(this._createField(a,"securityAnswer",this.questionAnswer.get("value")))}var v=function(a){if(a&&!0===a.success)if(this._cleanupForm(d),this._isOwner){var b=T.getCookie("esri_auth");g!==this._profile.fullName&&(b.fullName=g);k&&b.culture!==k&&(b.culture=k.toLowerCase(),
this.reloadOnUpdate=!0);b.region!==m&&(b.region=m);aa.setAuthCookie(b);this._requireSecurity&&(this.reloadOnUpdate=!0);T.isPortal()&&!G.self.supportsOAuth&&p?(a=T.getSecureUrl(G.baseUrl)+G.signin,aa.signout(a)):this._handle_updateProfile(a)}else this._handle_updateProfile(a);else this._handle_updateProfile(a)}.bind(this);e?this._cleanupForm(d):f?(I.createSpecifiedDialog(W).show({title:this.i18n.notice,message:this.i18n.questionRequired}),this._cleanupForm(d)):T.isPortal()&&!G.self.supportsOAuth?(l=
{title:this.i18n.newPwdLabel,message:this.i18n.changePwdWarning,choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel},l.choiceOneHandler=function(){C({updateProfile:this._updateProfile(a),updateProperties:this._updateUserProperties(c)}).then(function(a){v(a.updateProfile)}.bind(this),function(a){this._handle_updateProfile(a.updateProfile)}.bind(this))}.bind(this),Z.prototype.statics.getInstance().show(l)):C({updateProfile:this._updateProfile(a),updateProperties:this._profile.accountId?
this._updateUserProperties(c):null}).then(function(a){v(a.updateProfile)}.bind(this),function(a){this._handle_updateProfile(a.updateProfile)}.bind(this))}},_cleanupForm:function(a){a.forEach(function(a){k.destroy(a)},this)},_updateProfile:function(a){var b;b=T.getUser();b=this._isAdmin||this._roleCanUpdate?a.username.value||this._profile.username:b.email;b=T.getSecureUrl(G.restBaseUrl)+"community/users/"+b+"/update";return T.postForm(a,b)},_cancelEdit:function(){this._stopEdit();this.editForm.reset()},
_stopEdit:function(){p.set(d.byId("new_password_edit"),"display","none");p.set(d.byId("question_edit"),"display","none");p.set(d.byId("answer_edit"),"display","none");u(".editOrgOnly",this.domNode).style("display","none");u(".editNonOrgOnly",this.domNode).style("display","none");u(".editOnly",this.domNode).style("display","none");u(".editOnlyBtn",this.domNode).style("display","none");u(".readOnly",this.domNode).style("display","");u(".readOrgOnly",this.domNode).style("display",this._profile.accountId?
"":"none");p.set(K.byId("profileEditButton").domNode,"display",t("ie")?"inline-block":"");this.thumbnailPath.value="";e.forEach(this.editConnects,function(a){a.remove()},this);this.editConnects=[];this.regionSelect.reset();this.languageSelect.reset();this.set("culture",this._profile.culture);this.set("region",this._profile.region);this._toggleEsriPreferences()},_showThumbnailDialog:function(a){a.stopPropagation();a=m.position(this._thumbnailDiv);p.set(d.byId("profile-thumbnail-dialog"),"top",Math.round(a.y)+
"px");p.set(d.byId("profile-thumbnail-dialog"),"left",(G.isRightToLeft?Math.round(a.x)+a.w-p.get("profile-thumbnail-dialog","width"):Math.round(a.x))+"px");p.set(d.byId("profile-thumbnail-dialog"),"display","block")},_thumbnailOk:function(){var a=d.byId("profile-thumbnail-file").value,b=a.lastIndexOf("."),a=a.substring(b+1,a.length).toLowerCase();"png"!==a&&"gif"!==a&&"jpg"!==a&&"jpeg"!==a?I.createSpecifiedDialog(W).show({title:this.i18n.errorLabel,message:this.i18n.error.imageTypeError}):(""!==d.byId("profile-thumbnail-file").value&&
(this.thumbnailImage.src=T.relativeToExplicitUrl("images/item-thumbnail-update.png")),p.set(d.byId("profile-thumbnail-dialog"),"display","none"))},_thumbnailCancel:function(){p.set(d.byId("profile-thumbnail-dialog"),"display","none");e.forEach(this.editConnects,function(a){a.remove()},this);this.editConnects=[];d.byId("profile-thumbnail-dialog").innerHTML=d.byId("profile-thumbnail-dialog").innerHTML;this.editConnects.push(v(this.thumbnailImage,"click",this._showThumbnailDialog.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-close"),
"click",this._thumbnailCancel.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-ok"),"click",this._thumbnailOk.bind(this)));this.editConnects.push(v(d.byId("profile-thumbnail-cancel"),"click",this._thumbnailCancel.bind(this)))},_isInvalidSubscription:function(a){a=a&&a.error?a.error:a;var b=["SB_0001","SB_0002","SB_0003","SB_0004"];return a&&a.messageCode&&I.includes(b,a.messageCode)},_isOtherInvalidSubscription:function(a){a=a&&a.error?a.error:a;var b=["SB_0005","SB_0006","SB_0007"];
return a&&a.messageCode&&I.includes(b,a.messageCode)},_handleError:function(a){},_setCultureAttr:function(a){(a=this.languageSelect.get("store").query({culture:a||"en"}).shift())&&a.culture&&(this.languageSelect.set("value",a.culture),b.set(this.language_setting,"innerHTML",a.displayName))},_setCultureFormatAttr:function(a){var d=this.languageSelect.get("store").query({culture:this._profile.culture||"en"}).shift();(a=D.getSelectedFormat(a,d.cultureFormats||[]))&&a.format?(this.languageFormatSelect.set("value",
a.format),b.set(this.language_format_setting,"innerHTML",this.languageFormatSelect.get("displayedValue"))):(d=d&&d.cultureFormats?d.cultureFormats:null)&&d.length&&(this.languageFormatSelect.set("value",d[0].format),b.set(this.language_format_setting,"innerHTML",this.languageFormatSelect.get("displayedValue")))},_setRegionAttr:function(a){var d=this.regionSelect.get("store");d.fetchItemByIdentity({identity:a||"WO",onItem:function(c){c&&(a&&this.regionSelect.set("value",d.getValue(c,"region")),b.set(this.region_setting,
"innerHTML",c.localizedName))}.bind(this)})},_setUnitsAttr:function(a){var d=this.unitsSelect.get("store");d.fetchItemByIdentity({identity:a||"english",onItem:function(c){c&&(a&&this.unitsSelect.set("value",d.getValue(c,"id")),b.set(this.units_setting,"innerHTML",c.name))}.bind(this)})},_handle_getAccount:function(a){if(a&&!a.code&&!a.message){if(this._user.username===this._profile.username||this._user.accountId===this._profile.accountId){var c="";a.thumbnail&&0<a.thumbnail.length&&(c+='\x3cimg src\x3d"'+
this._buildOrganizationThumbnail(a)+'" align\x3d"center" class\x3d"groupThumbnail"/\x3e ');if(this._profile.firstName&&this._profile.lastName){var e="ja"===h.locale?this._profile.lastName+" "+this._profile.firstName:this._profile.firstName+" "+this._profile.lastName;b.set(d.byId("myProfile"),"innerHTML",c+e)}else b.set(d.byId("myProfile"),"innerHTML",c+this._profile.fullName+"");p.set(d.byId("myProfile"),"display","inline-block");!this._isOwner&&this._user.accountId&&this._user.accountId===this._profile.accountId&&
(b.set(d.byId("viewItemsLink"),"innerHTML",this.i18n.viewMembersItems),b.set(d.byId("viewGroupsLink"),"innerHTML",this.i18n.viewMembersGroups))}T.isPortal()&&G.restrictOrganizationPageToAdmin&&this._user.role!==this.accountAdminRole?k.create("span",{innerHTML:a.name},this.organization_link,"only"):k.create("a",{href:"organization.html",innerHTML:a.name},this.organization_link,"only");a.urlKey&&a.customBaseUrl&&(10>=t("ie")?p.set(d.byId("organization_url_div"),"display",""):p.set(d.byId("organization_url_div"),
"display","block"),this.organization_url_link.innerHTML=location.protocol+"//"+a.urlKey+"."+a.customBaseUrl)}},_buildOrganizationThumbnail:function(a){var b=T.getToken();return G.restBaseUrl+"portals/self/resources/"+a.thumbnail+(b?"?token\x3d"+b:"")},_handle_getProfile:function(a){this._profile=a;S.isDefined(a.orgId)&&(this._profile.accountId=a.orgId);S.isDefined(a.role)&&(this._profile.role=T.normalizeOrgRole(a.role),this._profile.userRole=new Y({id:a.roleId?a.roleId:a.role,role:a.role}),a.privileges&&
this._profile.userRole.setPrivileges(a.privileges));if(this._isAdmin||this._roleCanView)if(this._profile.accountId&&this._profile.accountId===this._user.accountId||(this._isAdmin=!1),this._isAdmin||this._roleCanView&&this._profile.accountId&&this._profile.accountId===this._user.accountId)u(".ownerOnly",this.domNode).style("display","block"),this._isOwner||this._isAdmin||this._roleCanUpdate||p.set(d.byId("editMenu"),"display","none"),(G.useDefaultIdentityStore||this._isOwner)&&this._roleCanUpdate||
p.set(d.byId("user_profile_edit_link"),"display","none"),this._profile.username!==this._user.email&&K.byId("profileEditButton").set("label",this.i18n.editProfile);G.userLicenseLevelsEnabled&&(this._isAdmin&&(a=this.LICENSE_LEVELS.TWO,this._profile.level===this.LICENSE_LEVELS.ONE&&(a=this.LICENSE_LEVELS.ONE),k.empty(this.organization_level),T.createLevelSpan(this.i18n.levelLabel,a,this.organization_level)),p.set(d.byId("organization_level_div"),"display",this._isAdmin?"":"none"),this._profile.accountId?
this._handle_getAccount(this._self):b.set(d.byId("myProfile"),"innerHTML",this._profile.fullName));a=this._isOwner||this._isAdmin||this._roleCanView&&this._profile.accountId&&this._profile.accountId===this._user.accountId;C({userProvider:this._getUserProvider(),userProperties:a?this._getUserProperties():null}).then(function(a){this._profile.properties=a.userProperties&&a.userProperties.properties||{};this._loadProfile(this._profile);this.onProfileLoad(this._profile)}.bind(this))},onProfileLoad:function(a){if(this._validateEmail){a=
T.getUser();var b=k.create("form",{method:"post",enctype:"multipart/form-data"});k.create("input",{type:"hidden",name:"validateEmail",value:this._validateEmail},b);k.create("input",{type:"hidden",name:"token",value:a.token},b);k.create("input",{type:"hidden",name:"f",value:"json"},b);this._updateProfile(b).then(function(){this._validateEmail=void 0;I.createSpecifiedDialog(W).show({title:this.i18n.notice,message:this.i18n.verifiedEmailMsg});V.getProfile(this._username,this._handle_getProfile.bind(this))}.bind(this))}},
_handle_updateProfile:function(a){var b=this._isOwner?this._user.email:this._showUser;a.success?this.reloadOnUpdate?(a=this._emailMustBeVerified?"verifyEmail\x3d"+this._emailMustBeVerified:"",this._requireSecurity?(this._requireSecurity=!1,window.location=window.location.href.split("?")[0]+(a?"?"+a:"")):window.location=this._showUser?G.baseUrl+"user.html?user\x3d"+this._showUser+(a?"\x26"+a:""):G.baseUrl+"user.html"+(a?"?"+a:"")):(V.getProfile(b,this._handle_getProfile.bind(this)),this._stopEdit(),
this._emailMustBeVerified&&(I.createSpecifiedDialog(W).show({title:this.i18n.confirmEmailTitle,message:w.substitute(this.i18n.confirmEmailMsg,{email:this._emailMustBeVerified})}),this._emailMustBeVerified=void 0)):(this._isInvalidSubscription(a)?(V.getProfile(b,this._handle_getProfile.bind(this)),ia.prototype.statics.getInstance().show(G.self.subscriptionInfo)):this._isOtherInvalidSubscription(a)?(V.getProfile(b,this._handle_getProfile.bind(this)),a=a&&a.error?a.error:a,ia.prototype.statics.getInstance().showOther(a.messageCode)):
a.error&&a.error.message&&-1<a.error.message.indexOf("file exceeds the max size")?I.createSpecifiedDialog(W).show({title:this.i18n.cannotAddThumbnail,message:a.error.message}):a&&a.messageCode&&"COM_1035"===a.messageCode?I.createSpecifiedDialog(W).show({title:this.i18n.errorUpdatingProfile,message:this.i18n.errorUpdatingProfileMsg}):(a=a&&a.error?a.error:a,b=a.message?a.message:a,b+=a.details?" "+a.details:"",I.createSpecifiedDialog(W).show({title:this.i18n.errorUpdatingProfile,message:b})),this._stopEdit(),
this._profile.thumbnail&&0<this._profile.thumbnail.length&&(this.thumbnailImage.src=V.getProfileThumbnailUrl(this._profile)))},onLanguageChange:function(){var a=this.languageSelect.get("store").query({displayName:this.languageSelect.get("displayedValue")}).shift();a&&this._initLanguageFormat(a.culture,a.cultureFormats)},_initLanguageFormat:function(a,d){if(a&&d&&d.length){a=D.getSelectedFormat(this._profile.cultureFormat,d||[]);var c=new z({idProperty:"format",label:"displayName",data:d});this.languageFormatSelect.set("store",
c);this.languageFormatSelect.set("searchAttr","displayName");a?(b.set(this.language_format_setting,"innerHTML",a.displayName),this.languageFormatSelect.set("displayedValue",a.displayName)):(b.set(this.language_format_setting,"innerHTML",d[0].displayName),this.languageFormatSelect.set("displayedValue",d[0].displayName));p.set(this.languageFormatContainer,"display","")}else p.set(this.languageFormatContainer,"display","none")},onChangePassword:function(){this._oAuthInfo.redirectUri=encodeURIComponent(this._oAuthInfo.redirectUri+
"?isPortal\x3d"+G.self.isPortal);window.location=w.substitute("${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26expiration\x3d${expiration}\x26locale\x3d${locale}\x26resetPassword\x3dtrue",this._oAuthInfo)},onEnableMFA:function(){this._oAuthInfo.redirectUri=encodeURIComponent(G.baseUrl+"postmfa.html");window.location=w.substitute("${url}?client_id\x3d${clientId}\x26redirect_uri\x3d${redirectUri}\x26response_type\x3dtoken\x26expiration\x3d${expiration}\x26locale\x3d${locale}\x26enableMfa\x3dtrue",
this._oAuthInfo)},onDisableMFA:function(){I.createSpecifiedDialog(ga).showMsgTitleButton(this.i18n.disableMultiFactorMsg,this.i18n.disable+" "+this.i18n.multiFactorAuth,this.i18n.disable,this.reallyDisableMFA.bind(this,this._profile.username));g.remove(K.byId("button_delete-warning-submit").domNode,"orange");g.add(K.byId("button_delete-warning-submit").domNode,"caution")},reallyDisableMFA:function(a){var d=T.getSecureUrl(G.restBaseUrl)+"community/users/"+a+"/disableMfa";T.request({url:d},{usePost:!0}).then(function(){I.createSpecifiedDialog(W).show({title:this.i18n.notice,
message:this.i18n.disableMultiFactorSuccess});this._profile.mfaEnabled=!1;b.set(this.mfa_setting,"innerHTML",this.i18n.disabledLabel);p.set(this._disableMFA.domNode,"display","none");p.set(this._enableMFA.domNode,"display","");this._profile&&this._user.username!==this._profile.username&&(p.set(this.mfa_setting.parentNode,"display",""),p.set(this._enableMFA.domNode.parentNode,"display","none"));g.remove(K.byId("button_delete-warning-submit").domNode,"caution");g.add(K.byId("button_delete-warning-submit").domNode,
"orange")}.bind(this),function(b){b=w.substitute(this.i18n.error.disableMultiFactor,{user:a});I.createSpecifiedDialog(W).show({title:this.i18n.noticeLabel,message:b})}.bind(this))}})})},"arcgisonline/sharing/dijit/dialog/ExportDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_WidgetBase,dijit/_TemplatedMixin,dijit/_WidgetsInTemplateMixin,dijit/form/Button,dijit/form/TextBox,dijit/layout/BorderContainer,dijit/layout/ContentPane,dijit/form/RadioButton,dojo/data/ItemFileWriteStore,arcgisonline/pages/utils/categories,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/SaveItem,arcgisonline/sharing/geow/Folder,arcgisonline/sharing/util,esri/Evented"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.ExportDlg");c.require("dijit.Dialog");c.require("dijit._WidgetBase");c.require("dijit._TemplatedMixin");c.require("dijit._WidgetsInTemplateMixin");c.require("dijit.form.Button");c.require("dijit.form.TextBox");c.require("dijit.layout.BorderContainer");c.require("dijit.layout.ContentPane");c.require("dijit.form.RadioButton");c.require("dojo.data.ItemFileWriteStore");c.require("arcgisonline.pages.utils.categories");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");
c.require("arcgisonline.sharing.dijit.ComboBox");c.require("arcgisonline.sharing.dijit.SaveItem");c.require("arcgisonline.sharing.geow.Folder");c.require("arcgisonline.sharing.util");c.require("esri.Evented");c.declare("arcgisonline.sharing.dijit.dialog.ExportDlg",[l._WidgetBase,l._TemplatedMixin,l._WidgetsInTemplateMixin,esri.Evented],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"exportDialog" id\x3d"export-dialog" title\x3d"${i18n.exportDialogTitle}" execute\x3d""\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemForm" data-dojo-type\x3d"arcgisonline/sharing/dijit/SaveItem"\x3e\x3c/div\x3e\r\n    \x3cfieldset data-dojo-attach-point\x3d"_featureCollectionDiv" class\x3d"featureCollectionOnly hide"\x3e\r\n        \x3clabel\x3e\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"generalizeChk" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:false" name\x3d"generalize"/\x3e${i18n.generalize}\x3c/label\x3e\r\n        \x3clabel\x3e\x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton"  name\x3d"generalize"/\x3e${i18n.keepOrig}\x3c/label\x3e\r\n    \x3c/fieldset\x3e\r\n\r\n  \x3cdiv class\x3d"esriFloatTrailing right"\x3e\r\n    \x3cspan dojoAttachPoint\x3d"exportingLabel" style\x3d"visibility:hidden;"\x3e${i18n.exportingLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"cancel" data-dojo-attach-point\x3d"cancelBtn" data-dojo-attach-event\x3d"onClick:onCancel"\r\n         data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"type:\'button\'"\x3e${i18n.cancel}\x3c/div\x3e\r\n    \x3cdiv class\x3d"primary" data-dojo-attach-point\x3d"exportBtn" data-dojo-attach-event\x3d"onClick:onExport"\r\n         data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"type:\'button\'"\x3e${i18n.exportLabel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
util:arcgisonline.sharing.util,folder:arcgisonline.sharing.geow.Folder,item:null,layerId:-1,init:!1,exportType:null,exportResponse:null,checkStatusInterval:null,checkingStatus:!1,statusCheckIntervalTime:4E3,saveItemForm:null,exportDialog:null,exportBtn:null,cancelBtn:null,i18n:null,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ExportDlg);return this._instance}},onDone:function(){},postMixInProperties:function(){this.inherited(arguments);
this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").exportDlg);c.mixin(this.i18n,{generalize:c.i18n.getLocalization("arcgisonline","arcgisonline").addLayerFromFileDlg.generalize});c.mixin(this.i18n,{keepOrig:c.i18n.getLocalization("arcgisonline","arcgisonline").addLayerFromFileDlg.keepOrig});this._webMercatorValues={3857:1,102113:1,102100:1,900913:1}},postCreate:function(){this.inherited(arguments);this.init||
(this.init=!0)},startup:function(){this.inherited(arguments);esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;esriGeowConfig.proxyUrl&&(esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyUrl)},destroy:function(){this._onSaveItemValidateHandle&&(this._onSaveItemValidateHandle.remove(),this._onSaveItemValidateHandle=null);this.exportDialog.destroyRecursive();this.exportDialog=null;this.inherited(arguments)},show:function(a,c,f){this._showDlg(a,c,f)},showShapefile:function(a,c){this._showDlg(a,
c,arcgisonline.sharing.dijit.dialog.ExportDlg.util.shapefileType)},showCSV:function(a,c){this._showDlg(a,c,arcgisonline.sharing.dijit.dialog.ExportDlg.util.csvType)},showFileGDB:function(a,c){this._showDlg(a,c,arcgisonline.sharing.dijit.dialog.ExportDlg.util.fileGDB)},showGeoJson:function(a,c){this._showDlg(a,c,arcgisonline.sharing.dijit.dialog.ExportDlg.util.geoJson)},showFeatureCollection:function(a,c){this._showDlg(a,c,arcgisonline.sharing.dijit.dialog.ExportDlg.util.featureCollection)},_showDlg:function(a,
e,f){this.clear();this.item=a;this._setDialogTitle(f);this._setLayerDetails(e);this._initTags();this._initCategories();this.exportDialog.show();this.own(c.connect(this.exportDialog,"onHide",c.hitch(this,function(){this.destroy()})))},_initTags:function(){this.saveItemForm.loadTags().then(c.hitch(this,function(){this.saveItemForm.set("tags","")}))},_initCategories:function(){this.saveItemForm.loadCategories(this.item.categories)},_setDialogTitle:function(a){this.exportType=a;arcgisonline.sharing.dijit.dialog.ExportDlg.util.shapefileType===
this.exportType?this.exportDialog.set("title",this.i18n.exportDialogTitle+" "+this.i18n.toShapefile):arcgisonline.sharing.dijit.dialog.ExportDlg.util.csvType===this.exportType?this.exportDialog.set("title",this.i18n.exportDialogTitle+" "+this.i18n.toCSV):arcgisonline.sharing.dijit.dialog.ExportDlg.util.fileGDB===this.exportType?this.exportDialog.set("title",this.i18n.exportDialogTitle+" "+this.i18n.toFileGDB):arcgisonline.sharing.dijit.dialog.ExportDlg.util.geoJson===this.exportType?this.exportDialog.set("title",
this.i18n.exportDialogTitle+" "+this.i18n.toGeoJson):arcgisonline.sharing.dijit.dialog.ExportDlg.util.featureCollection===this.exportType?this.exportDialog.set("title",this.i18n.exportDialogTitle+" "+this.i18n.toFeatureCollection):arcgisonline.sharing.dijit.dialog.ExportDlg.util.kmlType===this.exportType?this.exportDialog.set("title",this.i18n.exportDialogTitle+" "+this.i18n.toKML):arcgisonline.sharing.dijit.dialog.ExportDlg.util.excelType===this.exportType&&this.exportDialog.set("title",this.i18n.exportDialogTitle+
" "+this.i18n.toExcel)},_setLayerDetails:function(a){this._isTableLayer=this._isWebMercator=!1;a&&esri._isDefined(a.id)?(this.layerId=a.id,this._layers=[a],this.saveItemForm.set("title",a.name),this._isWebMercator=a.extent&&a.extent.spatialReference&&a.extent.spatialReference.wkid in this._webMercatorValues,this._extent=a.extent):a&&a.length&&(this._layers=a,this._isWebMercator=a[0].extent&&a[0].extent.spatialReference&&a[0].extent.spatialReference.wkid in this._webMercatorValues,this._isTableLayer=
c.every(a,function(a){return"Table"===a.type}),this._extent=a[0].extent,this.saveItemForm.set("title",1===a.length?a[0].name:this.item.title));this._isWebMercator&&!this._isTableLayer&&this.exportType===arcgisonline.sharing.dijit.dialog.ExportDlg.util.featureCollection&&(c.removeClass(this._featureCollectionDiv,"hide"),this.generalizeChk.set("checked",!0))},clear:function(){this.exportDialog.set("title",this.i18n.exportDialogTitle);this.item=null;this.layerId=-1;this.checkStatusInterval=this.exportResponse=
this.exportType=null;this.checkingStatus=!1;this.saveItemForm.set("title","");this.saveItemForm.set("tags","");this.saveItemForm.set("summary","");this.saveItemForm.set("requires",["title","tags"]);c.style(this.exportingLabel,"visibility","hidden");this.exportBtn.set("disabled",!0);this._onSaveItemValidateHandle=c.subscribe("onSaveItemValidate",c.hitch(this,this.validate));this.saveItemForm.hideRow("folder");c.query(".select2-container.select2-container-multi",this.saveItemForm.domNode).style({minWidth:"334px"});
c.addClass(this._featureCollectionDiv,"hide");this.generalizeChk.set("checked",!1)},hide:function(){return this.exportDialog.hide()},validate:function(a){a=this.saveItemForm.get("title");var c=this.saveItemForm.get("tags");this.exportBtn.set("disabled",!a||!c)},validates:function(){var a=this.saveItemForm.get("title"),c=this.saveItemForm.get("tags");return a&&c},setWait:function(){c.query("#export-dialog").style("cursor","wait");c.style(this.exportingLabel,"visibility","visible");this.exportBtn.set("disabled",
!0)},unsetWait:function(){c.query("#export-dialog").style("cursor","default");c.style(this.exportingLabel,"visibility","hidden");this.exportBtn.set("disabled",!1)},exportItem:function(){if(this._moveFailed)this.updateItem(this._moveFailed.itemId,"/").then(c.hitch(this,function(a){this.unsetWait();this.onDone(a)}));else{this.setWait();var a=this.saveItemForm.get("title"),e=this.generalizeChk.get("checked"),f={maxAllowableOffset:1,quantizationParameters:{tolerance:1}},d=arcgisonline.sharing.dijit.dialog.ExportDlg.util.shapefileType;
arcgisonline.sharing.dijit.dialog.ExportDlg.util.csvType==this.exportType?d=arcgisonline.sharing.dijit.dialog.ExportDlg.util.csvType:arcgisonline.sharing.dijit.dialog.ExportDlg.util.fileGDB==this.exportType?d=arcgisonline.sharing.dijit.dialog.ExportDlg.util.fileGDB:arcgisonline.sharing.dijit.dialog.ExportDlg.util.geoJson==this.exportType?d=arcgisonline.sharing.dijit.dialog.ExportDlg.util.geoJson:arcgisonline.sharing.dijit.dialog.ExportDlg.util.featureCollection==this.exportType?d=arcgisonline.sharing.dijit.dialog.ExportDlg.util.featureCollection:
arcgisonline.sharing.dijit.dialog.ExportDlg.util.kmlType==this.exportType?d="kml":arcgisonline.sharing.dijit.dialog.ExportDlg.util.excelType==this.exportType&&(d="excel");var b=c.map(this._layers,c.hitch(this,function(a){return e?c.mixin({id:a.id},f):{id:a.id}})),a={itemId:this.item.id,title:a,exportFormat:d,exportParameters:-1<this.layerId?{layers:b}:e?f:null};this.item.isOwner&&this.item.isDataView&&(a.exportParameters=c.mixin(a.exportParameters||{},{enforceFieldVisibility:!0}));a.exportParameters&&
(a.exportParameters=JSON.stringify(a.exportParameters));d=this.util.getUser();this.util.request({url:esriGeowConfig.restBaseUrl+"content/users/"+d.email+"/export",content:a},{usePost:!0}).then(c.hitch(this,this.handleExport),c.hitch(this,this.displayError))}},handleExport:function(a){!a||a.code||a.message?this.displayError(a):(this.exportResponse=a,this.checkStatusInterval=setInterval(c.hitch(this,this.checkStatus),this.statusCheckIntervalTime))},checkStatus:function(){if(this.exportResponse&&!this.checkingStatus){var a=
{jobId:this.exportResponse.jobId,jobType:"export"},e=this.util.getUser(),e=esriGeowConfig.restBaseUrl+"content/users/"+e.email+"/items/"+this.exportResponse.exportItemId+"/status";this.checkingStatus=!0;this.util.request({url:e,content:a}).then(c.hitch(this,function(a){this.handleStatusCheck(a);this.checkingStatus=!1}),c.hitch(this,function(a){this.displayError(a);this.checkingStatus=!1}))}},handleStatusCheck:function(a){a.status&&("completed"===a.status?(clearInterval(this.checkStatusInterval),this.updateExportedItemDetails(a)):
"failed"===a.status&&(clearInterval(this.checkStatusInterval),this.updateExportedItemDetailsAndFail(a)))},updateExportedItemDetailsAndFail:function(a){this.getItemDetails(this.exportResponse.exportItemId).then(c.hitch(this,function(e){var f=[],d=esriGeowConfig.self.hasCategorySchema&&this.saveItemForm.get("categories")||[];0<d.length&&f.push(arcgisonline.pages.utils.categories.setItemCategories([e.id],d));f.push(this.updateItem(e.id,e.ownerFolder));c.promise.all(f).then(c.hitch(this,function(){this.unsetWait();
this.displayFailure(a.statusMessage)}))}))},updateExportedItemDetails:function(a){this.getItemDetails(a.itemId).then(c.hitch(this,function(e){var f=[],d=esriGeowConfig.self.hasCategorySchema&&this.saveItemForm.get("categories")||[];0<d.length&&f.push(arcgisonline.pages.utils.categories.setItemCategories([e.id],d));f.push(this.updateItem(e.id,e.ownerFolder));c.promise.all(f).then(c.hitch(this,function(){this.unsetWait();this.onDone(a)}))}))},moveItem:function(a,e){var f=new c.Deferred,d=this.util.getUser(),
d=esriGeowConfig.restBaseUrl+"content/users/"+d.email+"/items/"+a+"/move",b={folder:e||"/"};this._moveFailed=null;e&&"/"!==e&&""!==e?this.util.request({url:d,content:b},{usePost:!0}).then(c.hitch(this,function(a){f.resolve(a)}),c.hitch(this,function(b){if(b&&"CONT_0011"===b.messageCode){var d=this.saveItemForm.get("title"),d=c.string.substitute(this.i18n.duplicateFound,{type:this.exportType,title:d});arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,
message:d});this._moveFailed=c.mixin(b,{itemId:a,folderId:e});this.unsetWait()}})):f.resolve({itemId:a});return f},updateItem:function(a,e){var f=this.saveItemForm.get("title"),d=this.saveItemForm.get("tags"),b=this.saveItemForm.get("summary"),g=this.saveItemForm.get("folderId"),k=esriGeowConfig.restBaseUrl+"content/items/"+this.exportResponse.exportItemId+"/data",m=this.util.getUser(),m=esriGeowConfig.restBaseUrl+"content/users/"+m.email;e&&0<e.length&&(m+="/"+e);m+="/items/"+this.exportResponse.exportItemId+
"/update";e={title:f,tags:d,snippet:b};this._moveFailed||(e=c.mixin(e,{folderId:g}));arcgisonline.sharing.dijit.dialog.ExportDlg.util.kmlType==this.exportType&&(e.url=k);return this.util.request({url:m,content:e},{usePost:!0}).then(c.hitch(this,"moveItem",a,g))},getItemDetails:function(a){return this.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a})},goToItem:function(a){this.hide().then(c.hitch(this,function(){this.unsetWait();window.location=esriGeowConfig.baseUrl+"item.html?id\x3d"+
a}))},checkTitle:function(){var a=this.saveItemForm.get("title"),c=this.saveItemForm.get("folderId"),f=arcgisonline.sharing.dijit.dialog.ExportDlg.util[this.exportType]||this.exportType,d=this.util.getUser().username;return this.util.request({url:esriGeowConfig.restBaseUrl+"search",content:{q:'title:"'+a+'" AND type:"'+f+'" AND owner:"'+d+'" AND ownerfolder:"'+(c&&"/"!==c?c:"root")+'"'}})},displayFailure:function(a){var e;if(a)try{e=c.json.parse(a)}catch(d){e=a}var f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
f.onOkClick=c.hitch(this,function(a){a.hide();this.onCancel()},f);e.message&&(a=e.message);f.show({title:this.i18n.errorTitle,message:a})},displayError:function(a){if(a){var e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();e.onOkClick=c.hitch(this,function(a){a.hide();this.onCancel()},e);a.code&&a.message?e.show({title:this.i18n.errorTitle,message:a.message}):e.show({title:this.i18n.errorTitle,message:a})}},onChooseTags:function(){arcgisonline.sharing.dijit.dialog.TagsDlg.prototype.statics.getInstance().show()},
onExport:function(){this.validates()&&this.checkTitle().then(c.hitch(this,function(a){0<a.total?(a=this.saveItemForm.get("title"),a=c.string.substitute(this.i18n.duplicateFound,{type:arcgisonline.sharing.dijit.dialog.ExportDlg.util[this.exportType]||this.exportType,title:a}),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:a})):this.exportItem()}))},onCancel:function(a){a&&a.preventDefault();this.hide();this.destroy()}});arcgisonline.sharing.dijit.dialog.ExportDlg.util=
{shapefileType:"Shapefile",csvType:"CSV",fileGDB:"File Geodatabase",geoJson:"GeoJson",featureCollection:"Feature Collection",kmlType:"KML",excelType:"Excel",CSV:"CSV Collection",KML:"KML Collection",Excel:"Microsoft Excel",requiredBorder:"1px dotted orangered",normalBorder:"1px solid #bbb"}})},"arcgisonline/sharing/dijit/SaveItem":function(){define("require exports tslib ../../esriGeowConfig ../../pages/pageUtil ../../pages/dijit/CategoryPicker ../util ../geow/Folder ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dojo/aspect dojo/cookie dojo/Deferred dojo/i18n!../../nls/arcgisonline dojo/on dojo/query dojo/topic dojo/_base/lang dojo/data/ItemFileWriteStore dojo/text!./templates/SaveItem.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x){a=h.__importDefault(a);e=h.__importDefault(e);f=h.__importDefault(f);d=h.__importDefault(d);b=h.__importDefault(b);g=h.__importDefault(g);k=h.__importDefault(k);m=h.__importDefault(m);p=h.__importDefault(p);q=h.__importDefault(q);n=h.__importDefault(n);r=h.__importDefault(r);v=h.__importDefault(v);u=h.__importDefault(u);w=h.__importDefault(w);t=h.__importDefault(t);y=h.__importDefault(y);C=h.__importDefault(C);return function(){function c(){this.declaredClass=
"arcgisonline.sharing.dijit.SaveItem";this.widgetsInTemplate=!0;this.templateString=x;this.baseClass="esriAGOSaveItemForm";this.init=!1;this.folders={}}c.prototype.postMixInProperties=function(){this.i18n=y.default.mixin(v.default.common,v.default.saveItem)};c.prototype.postCreate=function(){this.inherited(arguments);this.init||(this._getFolders(),this.init=!0)};c.prototype.startup=function(){this.inherited(arguments);this._loadConnections()};c.prototype.hideRow=function(a){w.default(".save-item-"+
a+"-row").forEach(function(a){e.default.hideNode(a)})};c.prototype.loadTags=function(a){var b=this,c=d.default.getUser();a&&(c=a);return d.default.loadUserTags(c.username).then(function(a){var d=b.saveItemTags.domNode,c=b._validate.bind(b);b.saveItemTags.set("knownTags",a);b.own(u.default(d,"blur",c),e.default.registerKeystrokeHandler(d,c),q.default.after(b.saveItemTags,"validate",c))})};c.prototype.loadCategories=function(b){var c=this,g=new r.default,k=w.default(".categories-container",this.domNode);
a.default.self.hasCategorySchema?d.default.request({url:a.default.restBaseUrl+"portals/self/categorySchema"}).then(function(a){c._categories=new f.default({categories:b||[],schema:a.categorySchema},c.saveItemCategories);c._categories.startup();e.default.showNodes(k);g.resolve()},function(){e.default.hideNodes(k);g.resolve()}):(e.default.hideNodes(k),g.resolve());return g};c.prototype._loadConnections=function(){var a=this._validate.bind(this);this.own(u.default(this.saveItemTitle,"change",a),u.default(this.saveItemSummary,
"change",a),e.default.registerKeystrokeHandler(this.saveItemTitle,a),e.default.registerKeystrokeHandler(this.saveItemSummary,a))};c.prototype._validate=function(){if(!this._beingDestroyed){var a=!0,b=this.saveItemTitle.get("value"),d=this.saveItemTags.get("tags"),c=this.saveItemSummary.get("value");null===this.requires?a=!!(b&&d&&c):(e.default.includes(this.requires,"title")&&(a=a&&!!b),e.default.includes(this.requires,"tags")&&(a=a&&0!==d.length),e.default.includes(this.requires,"summary")&&(a=a&&
!!c));t.default.publish("onSaveItemValidate",[a])}};c.prototype._getFolders=function(){var a=this,c=d.default.getUser();if(null!==c){var e=new C.default({url:null,data:{identifier:"name",items:[]}});e.newItem({name:c.email,id:""});this.saveItemFolder.set("store",e);this.saveItemFolder.set("value",c.email);b.default.getFolders(function(b){var c=null;if(n.default("ESRI_Content")){var f=d.default.getCookie("ESRI_Content");f.folderId&&(c=f.folderId)}a.foldersJson=b.folders;b.folders.forEach(function(b,
d){e.newItem({name:b.title,id:b.id});a.folders["id"+b.id]=b.title.replace(/\"/g,'\\"');c===b.id&&(a.saveItemFolder.set("value",b.title),a.folderId=c,a.folderName=b.title)});e.save({})},function(a){})}};c.prototype._onFolderChange=function(a){var b=this;this.saveItemFolder.get("store").fetch({onComplete:function(d){d.forEach(function(d){d.name[0]===a&&(b.folderId=d.id[0],b.folderName=d.name[0])})}})};c.prototype._setTitleAttr=function(a){this.saveItemTitle.set("value",a)};c.prototype._getTitleAttr=
function(){return this.saveItemTitle.get("value")};c.prototype._setTagsAttr=function(a){this.saveItemTags.set("tags",a)};c.prototype._getTagsAttr=function(){return this.saveItemTags.get("tags")};c.prototype._setCategoriesAttr=function(a){var b=this;a&&a.forEach(function(a){b._categories.addCategory(a)})};c.prototype._getCategoriesAttr=function(){return this._categories.getCategories(!0)};c.prototype._setSummaryAttr=function(a){this.saveItemSummary.set("value",a)};c.prototype._getSummaryAttr=function(){return this.saveItemSummary.get("value")};
c.prototype._setFolderAttr=function(a){var b=this;this.saveItemFolder.get("store").fetch({onComplete:function(d){d.forEach(function(d){d.name[0]===a&&(b.folderId=d.id[0],b.folderName=d.name[0],b.saveItemFolder.set("value",b.folderName))})}})};c.prototype._getFolderAttr=function(){return this.folderName};c.prototype._setFolderIdAttr=function(a){var b=this;this.saveItemFolder.get("store").fetch({onComplete:function(d){d.forEach(function(d){d.id[0]===a&&(b.folderId=d.id[0],b.folderName=d.name[0],b.saveItemFolder.set("value",
d.name[0]))})}})};c.prototype._getFolderIdAttr=function(){return this.folderId};c.prototype._setRequiresAttr=function(a){this.requires=a?a:null};c.prototype._setTitlePlaceHolderAttr=function(a){this.saveItemTitle.set("placeHolder",a)};c.prototype._setTagsPlaceHolderAttr=function(a){this.saveItemTitle.set("placeHolder",a)};c.prototype._setSummaryPlaceHolderAttr=function(a){this.saveItemSummary.set("placeHolder",a)};return c=h.__decorate([g.default(m.default,k.default,p.default)],c)}()})},"arcgisonline/sharing/dijit/dialog/FolderDlg":function(){define(["dojo",
"dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/util,dijit/Dialog,arcgisonline/sharing/geow/Folder"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.FolderDlg");c.require("dijit._Widget");c.require("dijit._Templated");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.util");c.require("dijit.Dialog");c.require("arcgisonline.sharing.geow.Folder");c.declare("arcgisonline.sharing.dijit.dialog.FolderDlg",
[l._Widget,l._Templated],{util:arcgisonline.sharing.util,folder:arcgisonline.sharing.geow.Folder,widgetsInTemplate:!0,templateString:'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_folderDialog" title\x3d"${i18n.folderDlgTitle}" style\x3d"width:460px;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_folderErrorDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_folderForm" data-dojo-attach-event\x3d"onSubmit:createFolder,onkeydown:onKeyDown"\x3e\r\n      \x3cdiv style\x3d"margin:2px;"\x3e\r\n        \x3clabel class\x3d"long trailer-0"\x3e\r\n          ${i18n.folderName}\r\n          \x3cinput data-dojo-attach-point\x3d"_folderTitleInput" name\x3d"fldr_title" data-dojo-type\x3d"dijit/form/TextBox"\r\n                 data-dojo-props\x3d"trim:true,required:true" maxlength\x3d"125" style\x3d"padding:2px;"\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr/\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing right"\x3e\r\n        \x3cbutton type\x3d"button" data-dojo-type\x3d"dijit/form/Button" class\x3d"primary " data-dojo-attach-event\x3d"onClick:createFolder"\x3e${i18n.create}\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" class\x3d"cancel " data-dojo-attach-event\x3d"onClick:_handleCancelBtn"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr/\x3e\r\n      \x3cbr/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.FolderDlg({}));return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n={};this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").generalDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").folderDlg);this.allFolderNames=
""},show:function(a,e){var f=this.util.getUser();e&&(this.overrideUser=e);this.allFolderNames=this.overrideUser?"||"+this.overrideUser.username+"||":"||"+f.email+"||";c.forEach(a,c.hitch(this,function(a){this.allFolderNames+=(a.title instanceof Array?a.title[0].toLowerCase():a.title.toLowerCase())+"||"}));this.clear();this.newFolder=null;this._folderDialog.show()},clear:function(){this._folderTitleInput.set("value","");this._folderErrorDiv.innerHTML="";c.removeClass(this._folderErrorDiv,"error")},
_handleCancelBtn:function(a){this._folderDialog.hide();a.preventDefault()},hide:function(){this._folderDialog.hide()},createFolder:function(a){a.preventDefault();var e=c.trim(this._folderTitleInput.get("value")),f;if(0===e.length)f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),f.show({title:this.i18n.errorDlgTitle,message:this.i18n.invalid.provideName});else if(-1<e.indexOf("\x3c")||-1<e.indexOf("\x3e"))f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),
f.show({title:this.i18n.errorDlgTitle,message:this.i18n.invalid.invalidCharacters});else if(-1<this.allFolderNames.indexOf("||"+e.toLowerCase()+"||"))f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),f.show({title:this.i18n.errorDlgTitle,message:c.string.substitute(this.i18n.invalid.sameFolderName,[e])});else{var d=e.replace(/ /g,"_");a={folderName:d,title:e};var b=function(a){this.newFolder=a&&a.folder;this._folderDialog.hide();c.publish("refreshFolders",[d])},g=function(a){a=
a&&"GWM_0003"===a.messageCode?"GWM_0003":"sameFolderName";f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();f.show({title:this.i18n.errorDlgTitle,message:c.string.substitute(this.i18n.invalid[a],[e])})};this.overrideUser?this.folder.createFolderByUser(this.overrideUser.username,a,c.hitch(this,b),c.hitch(this,g)):this.folder.createFolder(a,c.hitch(this,b),c.hitch(this,g))}},onKeyDown:function(a){var c;window.event?c=a.keyCode:a.which&&(c=a.which);13===c&&this.createFolder(a)}})})},
"arcgisonline/sharing/dijit/dialog/InvitationsDlg":function(){define("require esri/declare esri/Evented esri/lang dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/query dojo/string dojo/topic dojo/mouse dijit/a11yclick dojo/promise/all dojo/date/locale dojo/store/Memory dijit/Tooltip dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../../util ../../../pages/utils/formatters ../Grid ./GeneralDlg dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/InvitationsDlg.html dojo/text!./templates/InvitationsDlgGroup.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O){var K=l("arcgisonline.sharing.dijit.dialog.InvitationsDlg",[y,C,x,h],{basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),baseClass:"esriInvitationsDlg",widgetsInTemplate:!0,templateString:N,invitations:null,groupsUser:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=e.mixin({},E.common);e.mixin(this.i18n,E.invitationsDlg);e.mixin(this.i18n,E.invitationsGrid)},postCreate:function(){this.loadConnections()},
show:function(a,b){this.clearStore();b&&(b.username||b.email)&&(this.groupsUser=b);this.invitations=a;this.getGroupInfos();this._dialog.show()},update:function(a){this.clearStore();this.invitations=a;this.getGroupInfos();this._dialog.show()},getGroupInfos:function(){var a=B.getUser(),b=[],d;if(null!==a){d=this.groupsUser&&this.groupsUser.username?this.groupsUser.username:this.groupsUser&&this.groupsUser.email?this.groupsUser.email:a.email;for(a=0;a<this.invitations.length;a++)b.push(B.request({url:esriGeowConfig.restBaseUrl+
"community/users/"+d+"/invitations/"+this.invitations[a].groupId}));n(b).then(function(a){f.forEach(a,function(a,b){this.invitations[b].fromUsername=a.fromUsername.username;this.invitations[b].fromUserFullname=a.fromUsername.fullname;this.invitations[b].groupTitle=a.group.title;this.invitations[b].groupOwner=a.group.owner;this.invitations[b].groupIsPrivate="private"===a.group.access;this.invitations[b].groupAccess=a.group.access;this.invitations[b].groupDescription=a.group.description;this.invitations[b].groupThumbnail=
a.group.thumbnail;this.groupsUser&&(this.invitations[b].asUser=d)}.bind(this));var b=this._invitationsGrid._grid.store;f.forEach(this.invitations,function(a){b.put(a)}.bind(this));this.refresh()}.bind(this))}},loadConnections:function(){this.own(g(".jevent").on("click",function(a){a&&a instanceof Event&&a.preventDefault()}),b(this._closeBtn,"click",function(){this._dialog.hide()}.bind(this)),m.subscribe("onInvitationAccept",this.onInvitationAccept.bind(this)),m.subscribe("onInvitationDecline",this.onInvitationDecline.bind(this)))},
createGrid:function(){this._invitationsGrid=new F({id:"invitationsGrid",columns:this.getInvitationGridColumns(),noDataMessage:this.i18n.noGroupInvites,showLoadingMessage:!1,showHeader:!1,showFooter:!1,selectionMode:"none",rowsPerPage:5,className:"invitations-grid",store:new v({idProperty:"id",label:"groupTitle",data:[]}),sort:[{attribute:"received",descending:!1}]},this._invitationsGridContainer);this._invitationsGrid.startup()},clearStore:function(){this._invitationsGrid||this.createGrid();var a=
this._invitationsGrid&&this._invitationsGrid._grid&&this._invitationsGrid._grid.store||void 0;a&&f.forEach(e.clone(a.query()),function(b){a.remove(b.id)})},getInvitationGridColumns:function(){return{groupTitle:{label:this.i18n.groupName,sortable:!1,renderCell:function(a){var b=!1;this.groupsUser&&(this.groupsUser.privileges&&-1<this.groupsUser.privileges.indexOf("portal:admin:viewGroups")?b=!0:this.groupsUser.privileges&&-1<this.groupsUser.privileges.indexOf("portal:user:viewOrgGroups")&&"private"!==
a.groupAccess?b=!0:"public"===a.groupAccess&&(b=!0));var c=a.groupThumbnail?esriGeowConfig.restBaseUrl+"community/groups/"+a.groupId+"/info/"+a.groupThumbnail+"?token\x3d"+B.getToken():"",e=r.format(new Date(a.received),{selector:"date",formatLength:"long"}),e=k.substitute(E.GroupWidget.invitedEventDescription,{fullName:a.fromUserFullname,fullDate:e}),b={i18n:E,id:a.groupId,title:a.groupTitle,thumbnail:a.groupThumbnail,thumbnailUrl:c,notificationSummary:e,fillColor:"#"+a.groupId.substr(a.groupId.length-
6),useLetter:a.groupTitle.charAt(0)&&a.groupTitle.charAt(0).match(/^\w+$/),isPrivate:!b},b=d.toDom(k.substitute(O,b,null,{hide:z.hide,show:z.show,firstChar:z.firstChar,stripHTML:z.stripHTML})),c=g(".js-accept-invitation",b).shift(),e=g(".js-decline-invitation",b).shift(),f=a.asUser?a.asUser:null;this.own(q(c,this.acceptInvitation.bind(this,a,f)),q(e,this.declineInvitation.bind(this,a,f)));return b}.bind(this)}}},acceptInvitation:function(a,d){var c=B.getUser(),e=this._invitationsGrid._grid.store,
f=a.groupId;c&&B.request({url:esriGeowConfig.restBaseUrl+"community/users/"+(d?d:c.email)+"/invitations/"+f+"/accept",content:{}},{usePost:!0}).then(function(b){e.remove(a.id);m.publish("onInvitationAccept",{})}.bind(this),function(a){var d=new A;a=B.getUser();b.once(d._dialog,"hide",function(){d._dialog.destroyRecursive();d.destroyRecursive()}.bind(this));d.show({title:this.i18n.errorTitle,message:a&&a.orgId?this.i18n.acceptFailure:this.i18n.acceptFailurePublic})}.bind(this))},declineInvitation:function(a,
b){var d=B.getUser(),c=a.groupId,e=this._invitationsGrid._grid.store;d&&B.request({url:esriGeowConfig.restBaseUrl+"community/users/"+(b?b:d.email)+"/invitations/"+c+"/decline"},{usePost:!0}).then(function(){e.remove(a.id);m.publish("onInvitationDecline",{})}.bind(this))},onInvitationAccept:function(){0===this._invitationsGrid._grid.store.query().length?this.hide():this.refresh()},onInvitationDecline:function(){0===this._invitationsGrid._grid.store.query().length?this.hide():this.refresh()},hide:function(){this._dialog.hide()},
refresh:function(){if(this._invitationsGrid._grid&&this._invitationsGrid._grid._started){var a=this._invitationsGrid._grid._currentPage||1,d=this._invitationsGrid._grid.store?this._invitationsGrid._grid.store.query().length:0;b.once(this._invitationsGrid._grid,"dgrid-refresh-complete",function(b){b.grid._currentPage!==a&&0<d&&b.grid.gotoPage(a)});this._invitationsGrid._grid.resize();this._invitationsGrid._grid.refresh()}}});K.prototype.statics={getInstance:function(){this._instance||(this._instance=
new K);return this._instance}};return K})},"arcgisonline/sharing/dijit/dialog/InviteAccountUsersDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/Tooltip,dijit/form/CheckBox,dijit/form/SimpleTextarea,dijit/form/TextBox,arcgisonline/sharing/geow/Account,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/util"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.InviteAccountUsersDlg");c.require("dijit.Dialog");c.require("dijit._Widget");
c.require("dijit._Templated");c.require("dijit.Tooltip");c.require("dijit.form.CheckBox");c.require("dijit.form.SimpleTextarea");c.require("dijit.form.TextBox");c.require("arcgisonline.sharing.geow.Account");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.dialog.InviteAccountUsersDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n    \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"invite-account-users-dialog" title\x3d"Invite Users" execute\x3d""\x3e\r\n      \x3cdiv id\x3d"invite-account-users-search"\x3e\r\n        \x3cspan id\x3d"invite-account-users-search-label"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr /\x3e\r\n      \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\x3clabel\x3eTo:\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3cdiv id\x3d"invite-account-users-email" dojoType\x3d"dijit.form.TextBox" type\x3d"textbox" dojoAttachPoint\x3d"_email" dojoAttachEvent\x3d"onFocus:onEmailFocus,onBlur:onEmailBlur" style\x3d"width:400px;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cbr/\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top"\x3e\x3clabel\x3eMessage:\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd valign\x3d"top"\x3e\r\n            \x3cdiv id\x3d"invite-account-users-message" dojoType\x3d"dijit.form.SimpleTextarea" type\x3d"textarea" dojoAttachPoint\x3d"_message" style\x3d"width:400px; min-height:150px; resize:none;"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cbr/\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top" colspan\x3d"2"\x3e\r\n            \x3cdiv id\x3d"invite-account-users-must-approve" dojoType\x3d"dijit.form.CheckBox" dojoAttachPoint\x3d"_mustApprove" type\x3d"checkbox"\x3e\x3c/div\x3e\r\n            \x3cspan id\x3d"invite-account-users-must-approve-label"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n      \x3cbr /\x3e\r\n      \x3cdiv style\x3d"float: right; padding-top:0px; padding-bottom:5px;"\x3e\r\n        \x3cbutton id\x3d"button_send-invite" class\x3d"jevent primary" dojoType\x3d"dijit.form.Button" type\x3d"button"\x3eSend\x3c/button\x3e\r\n        \x3cbutton id\x3d"button_invite-account-users-close" class\x3d"jevent cancel" dojoType\x3d"dijit.form.Button" type\x3d"button"\x3eCancel\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
_organization:null,_admin:null,_handler:null,_email:null,_subject:null,_message:null,_mustApprove:null,defaultEmailMsg:"Enter a comma-delimited list of email addresses.",defaultMessage:"",statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.InviteAccountUsersDlg);return this._instance}},postCreate:function(){this.loadConnections()},show:function(a,e,f){this._organization=a;this._admin=e;this._handler=f;this.createLabels();this.createSubject();
this.createDefaultMessage();l.byId("invite-account-users-dialog").show();this._email.setValue(this.defaultEmailMsg);setTimeout(c.hitch(this,function(){this._mustApprove.focus()}),350)},clear:function(){this._email.value=""},loadConnections:function(){c.query(".jevent").connect("onclick",function(a){a.preventDefault()});c.query("#button_invite-account-users-close").connect("onclick",function(){l.byId("invite-account-users-dialog").hide()});c.connect(c.byId("button_send-invite"),"onclick",this,"sendInvite");
c.connect(l.byId("invite-account-users-dialog"),"hide",this,"clear")},sendInvite:function(a){if(this.validates()){a=this.createTextMessage();var e=this.createHTMLMessage();arcgisonline.sharing.geow.Account.inviteAccountUsersByEmail(this._organization.id,{emails:this._email.value,subject:this._subject,text:a,html:e,mustApprove:this._mustApprove.checked,role:"account_user",expiration:20160},c.hitch(this,this._handler),c.hitch(this,this._handler));this.hide()}},validates:function(){var a=!0,c="",f=this._email.value;
if(f===this.defaultEmailMsg)c="Please enter at least one email address.",a=!1;else for(var f=f.split(","),d=0;d<f.length;d++)if(!this.containsRequiredEmailChars(f[d])){c="Email address '"+f[d]+"' does not appear to be a valid email address.";a=!1;break}a||arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:"Notice",message:c});return a},hide:function(){l.byId("invite-account-users-dialog").hide()},createHTMLLineBreaks:function(a){if(a)for(var c=-1;-1<(c=a.indexOf("\n"));)a=
0===c?"\x3cbr/\x3e"+a.substring(c+1):a.substring(0,c)+"\x3cbr/\x3e"+a.substring(c+1);return a},createLabels:function(){var a;a="Invite people to join your "+(esriGeowConfig.useDefaultIdentityStore?"portal":"organization");a+=" by sending them an email.";c.byId("invite-account-users-search-label").innerHTML=a;a="Invited users must be approved before they are accepted to the "+(esriGeowConfig.useDefaultIdentityStore?"portal.":"organization.");c.byId("invite-account-users-must-approve-label").innerHTML=
a},createSubject:function(){this._subject="Invitation to join "+this._organization.name+" on "+(esriGeowConfig.useDefaultIdentityStore?esriGeowConfig.portalName||"ArcGIS":"ArcGIS Online")},createHTMLMessage:function(){var a=esriGeowConfig.useDefaultIdentityStore?esriGeowConfig.portalName||"ArcGIS":"ArcGIS Online",c=esriGeowConfig.baseUrl.replace("http:","https:"),f=this.createHTMLLineBreaks(this._message.value),c="\x3cp\x3e@@user.fullname@@ has invited you to join @@org.name@@ at "+a+". "+('\x3ca href\x3d"'+
c+esriGeowConfig.signin+'?invitation\x3d@@invitation.id@@\x26org\x3d@@org.name@@"\x3eClick here to join\x3c/a\x3e.\x3c/p\x3e'),c=c+("\x3cp\x3e"+f+"\x3c/p\x3e")+'\x3cp style\x3d"color:gray;"\x3eThis is an automated email, please do not reply. Contact the ',c=c+'\x3ca href\x3d"mailto:arcgisonline_feedback@esri.com?subject\x3dA comment about ArcGIS Online accounts."\x3e';return c+(a+"\x3c/a\x3e team if you have questions.\x3c/p\x3e")},createTextMessage:function(){var a=esriGeowConfig.useDefaultIdentityStore?
esriGeowConfig.portalName||"ArcGIS":"ArcGIS Online",c=esriGeowConfig.baseUrl.replace("http:","https:"),c="@@user.fullname@@ has invited you to join @@org.name@@ at "+a+". "+("Visit the following link to join:\n\r"+c+esriGeowConfig.signin+"?invitation\x3d@@invitation.id@@\x26org\x3d@@org.name@@\n\r"),c=c+(this._message.value+"\n\r");return c+("This is an automated email, please do not reply. Contact the "+a+" team at ")+"arcgisonline_feedback@esri.com if you have questions."},createDefaultMessage:function(){this.defaultMessage=
"To join, you'll need an "+(esriGeowConfig.useDefaultIdentityStore?"account":"Esri Global Account")+" that references the same email address this invitation was sent to. "+("You can create a new account or use an existing account that is registered with "+(esriGeowConfig.useDefaultIdentityStore?esriGeowConfig.portalName||"ArcGIS":"ArcGIS Online")+".");this._message.setValue(this.defaultMessage)},onEmailFocus:function(a){this._email.value===this.defaultEmailMsg&&this._email.setValue("")},onEmailBlur:function(a){this._email.value&&
""!==this._email.value||this._email.setValue(this.defaultEmailMsg)},containsRequiredEmailChars:function(a){var c=/^.+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,20}|[0-9]{1,3})(\]?)$/;return!/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)/.test(a)&&c.test(a)?!0:!1}})})},"arcgisonline/sharing/dijit/dialog/InviteUsersDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom dojo/dom-attr dojo/dom-style dojo/query dojo/topic dijit/a11yclick dojo/Deferred dojo/promise/all dijit/Dialog dijit/form/Button dijit/form/CheckBox dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/lang esri/domUtils ../../util ../../../pages/pageUtil ../../geow/Account ../../geow/Group ../UserSelector ./GeneralDlg dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/InviteUsersDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O){var K=l("arcgisonline.sharing.dijit.dialog.InviteUsersDlg",[u,w,t],{declaredClass:"arcgisonline.sharing.dijit.dialog.InviteUsersDlg",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:O,widgetsInTemplate:!0,groupUsers:null,selectedUsers:[],profiles:[],userBatchSize:100,postMixInProperties:function(){this.inherited(arguments);this.i18n={};h.mixin(this.i18n,N.common);h.mixin(this.i18n,N.inviteUsersDlg)},postCreate:function(){this.inherited(arguments);
this._firstLoad=!0;this._generalDlg=E.prototype.statics.getInstance();this._loadConnections()},hide:function(){!x.isPortal()&&this._user&&this._user.accountId&&this._userSelector._restrictSearch.set("checked",!0);this._dialog.hide()},show:function(a,b,d){var c=this;c.clear();c.group=b;c.groupId=a;c._user=x.getUser();c.restrictToOrgMembers=d;c._dialog.show();document.documentElement.scrollTop=document.body.scrollTop=(document.documentElement.scrollTop||document.body.scrollTop)+1;c._user&&c._user.accountId?
z.getSelf(function(a){c._setFlags();c._toggleRestrictUI(a);c._getGroupUsers()}):c._getGroupUsers()},clear:function(){this.groupUsers=null;this.selectedUsers=[];this.profiles=[];this._userSelector.set("searchLabel",this.i18n.searchByNameOrgBoth);this._userSelector.set("usersClickLabel",this.i18n.clickName);this._userSelector.set("selectedUsersLabel",this.i18n.invitationList);this._firstLoad||this._userSelector.reset();this._addNowChk.set("value",!1);this._setSending(!1);x.isPortal()&&this._userSelector.enableRestrictSearchUI(!1)},
onAddNow:function(){},_loadConnections:function(){this.own(m(this._dialog.closeButtonNode,h.hitch(this,"hide")),m(this._submit,h.hitch(this,"_sendInvite")),m(this._cancel,h.hitch(this,"hide")),e(this._addNowChk,"change",h.hitch(this,"_onAddNow")),e(this._dialog,"hide",h.hitch(this,"clear")),this._userSelector.on("selection-change",h.hitch(this,this._selectUsers)),this._userSelector.on("profile-load",h.hitch(this,this._profileLoaded)),e(this._userSelector._restrictSearch,"change",h.hitch(this,this._restrictSearchChanged)))},
_setFlags:function(){this._isPortal=x.isPortal();this._isAdmin=esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin();this._roleCanAssignToGroups=(this._isCustomRole=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom())&&esriGeowConfig.userRole.canAssignUsersToOrgGroups()},_toggleRestrictUI:function(a){if(this._isPortal)this._userSelector.enableRestrictSearchUI(!1);else if(this.restrictToOrgMembers)this._userSelector.enableRestrictSearchUI(!0),this._userSelector._restrictSearch.set("checked",
!0),this._userSelector._restrictSearch.set("disabled",!0);else if(this.orgMembersOnly||a.canSearchPublic||this._user.accountId===a.id&&this._isAdmin)this._isPortal||this._userSelector.enableRestrictSearchUI(!0),this._roleCanAssignToGroups&&this.group.owner!==this._user.username?this._userSelector._restrictSearch.set("disabled",!0):this._userSelector._restrictSearch.set("disabled",!1)},_restrictSearchChanged:function(){var a;x.isPortal()||(a=this._userSelector._restrictSearch.get("checked"),this._addNowChk.set("disabled",
!a),!a&&this._addNowChk.get("checked")&&this._addNowChk.set("checked",!1))},_setSending:function(a){var b=this._addNowChk.get("checked");this._submit.set("disabled",a);a?this._submit.set("label",b?this.i18n.addingToGroup:this.i18n.sendingInvitation):this._submit.set("label",b?this.i18n.addToGroup:this.i18n.sendInvitation)},_getGroupUsers:function(){var a=this;null===a.groupUsers&&(F.getGroupUsers(a.groupId,function(b){b&&b.owner&&(a.groupUsers=b)},null),a._user.orgId&&(a._user&&a._isAdmin||a.group&&
a.group.userMembership&&B.includes(["owner","admin"],a.group.userMembership.memberType)||a._roleCanAssignToGroups)&&(g(".admin").forEach(C.show),a._roleCanAssignToGroups&&a.group.owner!==a._user.username&&(a._addNowChk.set("checked",!0),a._addNowChk.set("disabled",!0))))},_selectUsers:function(b){var d=this,c=!1;b&&b.selectedUsers&&(d.selectedUsers=b.selectedUsers||[],d._user&&d._isAdmin&&d._retrieveProfiles().then(function(b){b&&0<b.length?(c=a.some(b,function(a){return!y.isDefined(a.isInOrg)||!1===
a.isInOrg}),d._addNowChk.set("checked",c?!1:d._addNowChk.get("checked")),d._addNowChk.set("disabled",c)):d._addNowChk.set("disabled",!1)}))},_profileLoaded:function(b){var d;b&&b.profile&&(d=a.some(this.profiles,function(a){return a.username===b.profile.username}),d||(b.profile.isInOrg=!!b.profile.orgId||b.profile.orgId===this._user.accountId,this.profiles.push(h.clone(b.profile))))},_retrieveProfiles:function(){var b=this,d=new p,c=h.clone(b.selectedUsers)||[],e=[],f=[],g,k,m,n;for(n=0;n<c.length;n++)k=
c[n],g=a.filter(b.profiles,function(a){return a.username===k.username}),!g||1>g.length?e.push(x.request({url:esriGeowConfig.restBaseUrl+"community/users/"+k.username})):a.forEach(g,function(a){f.push(a)});q(e).then(function(a){for(n=0;n<a.length;n++)m=a[n],m.isInOrg=!!m.orgId||m.orgId===b._user.accountId,b.profiles.push(m),f.push(m);d.resolve(f)},function(a){d.resolve(f)});return d},_onAddNow:function(a){this._submit.set("label",a?this.i18n.addToGroup:this.i18n.sendInvitation)},_sendInvite:function(){var b=
this._addNowChk.get("checked"),d=!1,c=[],e,f;if(0===this.selectedUsers.length)this._generalDlg.show({title:this.i18n.errorlabel,message:this.i18n.error.addUsers});else{for(f=0;f<this.selectedUsers.length;f++)e=this.selectedUsers[f],this.groupUsers.owner!==e.username&&-1===a.indexOf(this.groupUsers.admins,e.username)&&-1===a.indexOf(this.groupUsers.users,e.username)?c.push(e.username):d=!0;0<c.length?(this._setSending(!0),e=esriGeowConfig.restBaseUrl+"community/groups/"+this.groupId+(b?"/addUsers":
"/invite"),b?B.sendAllResources(e,this.userBatchSize,c,function(a){return{users:a.join(",")}}).then(h.hitch(this,this._handleInvite,d),h.hitch(this,this._handleInviteError)):x.request({url:e,content:{users:c.join(",")}},{usePost:!0}).then(h.hitch(this,this._handleInvite,d),h.hitch(this,this._handleInviteError))):this.hide()}},_handleInvite:function(a,b){var d=this._addNowChk.get("checked"),c={notAdded:[]};b&&b.length?b.forEach(function(a){c.notAdded=c.notAdded.concat(a.notAdded||[])},this):c=b;this._setSending(!1);
c&&c.notAdded&&0<c.notAdded.length&&(b=1===c.notAdded.length?esri.substitute({user:c.notAdded[0]},this.i18n.error.unableToAddPrivs):esri.substitute({userList:c.notAdded.join(", ")},this.i18n.error.unableToAddMultiplePrivs),this._generalDlg.show({title:this.i18n.errorLabel,message:b}));a&&this._generalDlg.show({title:this.i18n.infoLabel,message:this.i18n.alreadyInGroup+" "+(d?this.i18n.notAdded:this.i18n.sentInvitation)});d&&(k.publish("memberlist/refresh"),this.onAddNow());this.hide()},_handleInviteError:function(a){var b=
this.i18n.error.genericMsg;this._setSending(!1);a&&a.code&&a.messageCode&&("COM_1049"===a.messageCode||"COM_1082"===a.messageCode?b=this.i18n.error.unableToInvitePrivs:"COM_1043"===a.messageCode&&(b=this.i18n.error.unableToAddPublicUser));this._generalDlg.show({title:this.i18n.errorlabel,message:b})}});K.prototype.statics={_instance:null,getInstance:function(){null==this._instance&&(this._instance=new K);return this._instance}};return K})},"arcgisonline/sharing/geow/Group":function(){define(["dojo",
"dijit","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/DeleteWarningDlg"],function(c,l,h){c.provide("arcgisonline.sharing.geow.Group");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.dijit.dialog.DeleteWarningDlg");arcgisonline.sharing.geow.Group={util:arcgisonline.sharing.util,i18n:function(){if(this._i18n)return this._i18n;this._i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this._i18n,c.i18n.getLocalization("arcgisonline",
"arcgisonline").groupGeow);return this._i18n},getGroupContent:function(a,c,f){this.util.getJson(esriGeowConfig.restBaseUrl+"content/groups/"+a,c,f)},getGroupUsers:function(a,c,f){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups/"+a+"/users",c,f)},usersToStore:function(a){var e=0,f=[];c.forEach(a.users,function(a,b){f[e]={fullname:a,id:e};e++});c.forEach(a.admins,function(a,b){f[e]={fullname:a,id:e};e++});return store=new c.data.ItemFileReadStore({data:{identifier:"id",items:f}})},groupsToStore:function(a){var e=
[];c.forEach(a,function(a,d){this[d]=a;a.userMembership?(this[d].userMembership_username=a.userMembership.username,this[d].userMembership_memberType=a.userMembership.memberType,this[d].userMembership_applications=a.userMembership.applications,this[d].userMembership=null):this[d].userMembership_memberType=""},e);return new c.data.ItemFileReadStore({data:{identifier:"id",label:"title",items:e}})},getUrl:function(a){if(window.location.search)var e=c.queryToObject(window.location.search.slice(1)).n;window.location=
a+"?n\x3d"+e},getApplications:function(a,c,f){this.util.getJson(esriGeowConfig.restBaseUrl+"community/groups/"+a+"/applications",c,f)},acceptApplication:function(a,e){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a+"/applications/"+e+"/accept",c.hitch(this,function(a,d){c.publish("onApplicationAccept",[""])}))},declineApplication:function(a,e){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a+"/applications/"+e+"/decline",c.hitch(this,function(a,d){c.publish("onApplicationDecline",
[""])}))},acceptInvitation:function(a){var e=this.util.getUser();null!=e&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+(e.username||e.email)+"/invitations/"+a+"/accept",c.hitch(this,function(a,d){c.publish("onInvitationAccept",[""])}))},declineInvitation:function(a){var e=this.util.getUser();null!=e&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+(e.username||e.email)+"/invitations/"+a+"/decline",c.hitch(this,function(a,d){c.publish("onInvitationDecline",
[""])}))},acceptInvitationByUser:function(a,e){null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+e+"/invitations/"+a+"/accept",c.hitch(this,function(a,d){c.publish("onInvitationAccept",[""])}))},declineInvitationByUser:function(a,e){null!=this.util.getUser()&&this.util.postJson("",esriGeowConfig.restBaseUrl+"community/users/"+e+"/invitations/"+a+"/decline",c.hitch(this,function(a,d){c.publish("onInvitationDecline",[""])}))},removeFromGroup:function(a,e){arcgisonline.sharing.dijit.dialog.DeleteWarningDlg.prototype.statics.getInstance().showMsgTitleButton(c.string.substitute(this.i18n().removeUserMsg,
{username:e}),this.i18n().removeAccess,this.i18n().remove,c.hitch(arcgisonline.sharing.geow.Group,"reallyRemoveFromGroup",a,e))},reallyRemoveFromGroup:function(a,e){this.util.postJson("",esriGeowConfig.restBaseUrl+"community/groups/"+a+"/removeUsers?users\x3d"+e,c.hitch(this,function(a,d){c.publish("onGroupLeave",[""])}))}}})},"arcgisonline/sharing/dijit/UserSelector":function(){define("require exports tslib ../../esriGeowConfig ../util ./GroupSelector ../geow/Community ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/registry dijit/Tooltip dojo/i18n!../../nls/arcgisonline dojo/Deferred dojo/dom-attr dojo/dom-construct dojo/on dojo/string dojo/_base/lang esri/lang esri/request".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x){a=h.__importDefault(a);e=h.__importDefault(e);f=h.__importDefault(f);d=h.__importDefault(d);b=h.__importDefault(b);g=h.__importDefault(g);k=h.__importDefault(k);m=h.__importDefault(m);p=h.__importDefault(p);q=h.__importDefault(q);n=h.__importDefault(n);r=h.__importDefault(r);v=h.__importDefault(v);u=h.__importDefault(u);w=h.__importDefault(w);t=h.__importDefault(t);y=h.__importDefault(y);C=h.__importDefault(C);x=h.__importDefault(x);return function(){function c(a){this.declaredClass=
"arcgisonline.sharing.dijit.UserSelector";this.profiles=[];this._setConstructorProperties(a)}c.prototype.postMixInProperties=function(){this._mixinI18N()};c.prototype.postCreate=function(){this.inherited(arguments);this.ts=(new Date).getTime()};c.prototype.destroy=function(){this.inherited(arguments);this._clearProfilePopups()};c.prototype._mixinI18N=function(){var a={};y.default.mixin(a,n.default.common);y.default.mixin(a,n.default.groupSelector);y.default.mixin(a,n.default.userSelector);this.i18n=
a};c.prototype._setConstructorProperties=function(a){a.users&&(this.groups=a.users);a.selectedUsers&&(this.selectedGroups=a.selectedUsers);C.default.isDefined(a.autoLoad)?this.autoLoad=a.autoLoad:this.autoLoad=!0;C.default.isDefined(a.restrictSearch)?this.restrictSearch=a.restrictSearch:this.restrictSearch=!0;C.default.isDefined(a.enableRestrict)?this.enableRestrict=a.enableRestrict:this.enableRestrict=!1;C.default.isDefined(a.enableSearch)?this.enableSearch=a.enableSearch:this.enableSearch=!0;C.default.isDefined(a.enableListActions)&&
(this.enableListActions=a.enableListActions);C.default.isDefined(a.enableProfilePopup)?this.enableProfilePopup=a.enableProfilePopup:this.enableProfilePopup=!0;C.default.isDefined(a.excludeCurrentUser)&&(this.excludeCurrentUser=a.excludeCurrentUser)};c.prototype._searchGroups=function(b){return e.default.request({url:a.default.restBaseUrl+"community/users",content:b})};c.prototype._configureSearchParams=function(b,d,c){var f=this.user,g=e.default.isPortal(),k=this.restrictSearch,m=this.excludeCurrentUser,
n=f&&f.accountId&&k?"orgid:"+f.accountId:"",p=C.default.isDefined(c)&&0<c.length,h;h=g?p?"("+c+")":"":f&&f.accountId?k?p?"("+c+") AND "+n:n:p?"(("+c+") +(orgid:[0 TO \\{]))":"+(orgid:[0 TO \\{])":p?"(("+c+") -(orgid:[0 TO \\{]))":"-(orgid:[0 TO \\{])";m&&f&&f.username&&(g&&f.accountId&&""===h&&(h+="orgid:"+f.accountId),h+=' -username:"'+f.username+'"');g&&a.default.systemUsers&&0<a.default.systemUsers.length&&(f.accountId&&""===h&&(h+="orgid:"+f.accountId),a.default.systemUsers.forEach(function(a){h+=
" -username:"+a}));g||!f||f.accountId||p||(h="");return{start:b,num:d,sortField:"fullname",sortOrder:"asc",q:h}};c.prototype._processGroups=function(b,d){var c=this,f=new r.default,g=a.default.isRightToLeft?" \x26#8207;":" ",k=c._searchBox?c._searchBox.get("value"):"",m=c.restrictSearch,n=c.user,p=c.excludeCurrentUser,h=[],q;c._distinguishGroupTitles(d);b?!(0===d.length&&k&&2<k.length)||p&&p&&t.default.trim(k)===n.username?(c.groupResults=d,c._emitResult(d),f.resolve()):m?e.default.request({url:a.default.restBaseUrl+
"portals/self/users",content:{username:k,fullname:k,start:1,num:100}}).then(function(a){a&&a.users&&0<a.users.length?a.users.forEach(function(a){q=y.default.mixin({},a);q.id=q.username;q.owner=q.username;q.title=q.fullName;q.altTitle=q.fullName+g+"("+q.username+")";h.push(q);c.groupResults=h;c._emitResult(h);f.resolve()}):(c.groupResults=d,c._emitResult(d),f.resolve())},function(){c.groupResults=d;c._emitResult(d);f.resolve()}):x.default({url:a.default.restBaseUrl+"community/users/"+k,content:{f:"json"}}).then(function(a){c.profiles.push(a);
q=y.default.mixin({},a);q.id=q.username;q.owner=q.username;q.title=q.fullName;q.altTitle=q.fullName+g+"("+q.username+")";h.push(q);c.groupResults=h;c._emitResult(h);f.resolve()},function(){c.groupResults=d;c._emitResult(d);f.resolve()}):(c.groups=d,c.groupResults=null,c._emitResult(d),f.resolve());return f};c.prototype._distinguishGroupTitles=function(b){if(C.default.isDefined(b)){var d=a.default.isRightToLeft?" \x26#8207;":" ",c,e;for(e=0;e<b.length;e++)c=b[e],c.id=c.username,c.owner=c.username,
c.title=c.fullName,c.altTitle=c.fullName+d+"("+c.username+")"}};c.prototype._emitSelect=function(a){this.emit("select",{selectedUser:a})};c.prototype._emitRemove=function(a){this.emit("remove",{removedUser:a})};c.prototype._emitSelectionChange=function(){this.emit("selection-change",{selectedUsers:this._retrieveSelectedGroups()})};c.prototype._emitResult=function(a){this.emit("result",{users:a})};c.prototype._emitProfileLoad=function(a){this.emit("profile-load",{profile:a})};c.prototype._clearProfilePopups=
function(){for(var a=this.profileConnections,b=this.profileTooltips;a&&a.length;)a.shift().remove();for(;b&&b.length;)b.shift().destroyRecursive();this.profileTooltips=this.profileConnections=void 0};c.prototype._showProfilePopup=function(a){if(a.currentTarget){var b=this,c=p.default.byId("tooltip_"+a.currentTarget.id+"-"+b.ts),e;c&&0===c.get("label").length&&(e=v.default.get(a.currentTarget,"data-id"),(a=b.profiles.filter(function(a){return a.username===e}))&&0<a.length?b._populateTooltip(c,a[0]):
d.default.getProfile(e,function(a){b.profiles.push(a);b._populateTooltip(c,a)}))}};c.prototype._populateTooltip=function(a,b){var d;this._emitProfileLoad(b);d='\x3cdiv class\x3d"user-selector-profile-popup"\x3e\x3cspan class\x3d"esriItemTitle" style\x3d"line-height:20px;"\x3e'+b.fullName+"\x3c/span\x3e";b.thumbnail&&(d+='\x3cbr\x3e\x3cbr\x3e\x3cimg src\x3d"'+this._getThumbnailUrl(b)+'" width\x3d"65" height\x3d"65"\x3e');if(b=e.default.removeHTMLTags(b.description))b=0<b.length?b:"",d=150<b.length?
d+("\x3cbr\x3e\x3cbr\x3e"+b.substring(0,150)+this.i18n.continueLabel):d+("\x3cbr\x3e\x3cbr\x3e"+b);a.set("label",d+"\x3cbr\x3e\x26nbsp;\x3c/div\x3e")};c.prototype._getThumbnailUrl=function(b){var d=e.default.getToken();return a.default.restBaseUrl+"community/users/"+b.username+"/info/"+b.thumbnail+(d?"?token\x3d"+d:"")};c.prototype._refreshGroups=function(){var a=this,b=a._retrieveCurrentGroups(),d=this.enableProfilePopup,c=[],e=[],f,g;a._clearProfilePopups();a._groupsPane&&v.default.set(a._groupsPane,
"innerHTML","");if(b)for(g=0;g<b.length;g++)f=b[g],f=u.default.create("a",{id:"group-"+g,innerHTML:f.altTitle||f.title,href:"#",className:"linkNoHref","data-id":f.id,"data-title":f.title,"data-owner":f.owner},a._groupsPane),u.default.create("br",null,a._groupsPane),d&&(f=w.default(f,"mouseover",function(b){a._showProfilePopup(b)}),c.push(f),f=new q.default({label:"",connectId:["group-"+g],id:"tooltip_group-"+g+"-"+a.ts,class:"profile-tooltip"}),e.push(f),a.profileConnections=c,a.profileTooltips=e)};
c.prototype.enableProfilePopups=function(a){this.enableProfilePopup=a};c.prototype._setUsersLabelAttr=function(a){this.set("groupsLabel",a)};c.prototype._setUsersClickLabelAttr=function(a){this.set("groupsClickLabel",a)};c.prototype._setSelectedUsersLabelAttr=function(a){this.set("selectedGroupsLabel",a)};c.prototype._setSelectedUsersClickLabelAttr=function(a){this.set("selectedGroupsClickLabel",a)};c.prototype._setUsersAttr=function(a){this._distinguishGroupTitles(a);this.groups=a;this.groupResults=
null;this._refreshGroups()};c.prototype._getUsersAttr=function(){return this._retrieveCurrentGroups()};c.prototype._setSelectedUsersAttr=function(a){this._distinguishGroupTitles(a);this.selectedGroups=a;this._emitSelectionChange();this._refreshSelectedGroups()};c.prototype._getSelectedUsersAttr=function(){return this._retrieveSelectedGroups()};c.prototype._setValueAttr=function(a){this._distinguishGroupTitles(a);this.selectedGroups=a;this._emitSelectionChange();this._refreshSelectedGroups()};c.prototype._getValueAttr=
function(){return this._retrieveSelectedGroups()};return c=h.__decorate([b.default(k.default,g.default,m.default,f.default)],c)}()})},"arcgisonline/sharing/dijit/dialog/JoinGroupDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dijit/a11yclick dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../../util dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/JoinGroupDlg.html".split(" "),function(c,l,h,
a,e,f,d,b,g,k,m,p,q,n){var r=l("arcgisonline.sharing.dijit.dialog.JoinGroupDlg",[g,k,m],{declaredClass:"arcgisonline.sharing.dijit.dialog.JoinGroupDlg",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:n,widgetsInTemplate:!0,postMixInProperties:function(){this.inherited(arguments);this.i18n=h.mixin(q.common,q.joinGroupDlg)},postCreate:function(){this.inherited(arguments);this._loadConnections()},show:function(a,b){this.groupId=a;b&&(this.successHandler=b);this._dialog.show()},hide:function(a){a&&
a.preventDefault();this._dialog.hide()},_loadConnections:function(){this.own(f(this._okBtn,h.hitch(this,"_submitRequest")),f(this._cancelBtn,h.hitch(this,"hide")))},_submitRequest:function(a){a&&a.preventDefault();var b;b=p.request({url:esriGeowConfig.restBaseUrl+"community/groups/"+this.groupId+"/join"},{usePost:!0}).then(dojo.hitch(this,function(a,b){this.hide();this.successHandler&&this.successHandler(a,b)}),dojo.hitch(this,function(a){if(!b.canceled){var d=a.message;a.messageCode&&"COM_1082"===
a.messageCode?d=this.i18n.levelOneSharedUpdateCapabilities:-1<d.indexOf("You have already applied to join this group.")?d=this.i18n.alreadyRequested+"\x3cbr\x3e"+this.i18n.applicationConsidered:-1<d.indexOf("Unable to apply to join group:")?d=this.i18n.cannotAccept:-1<d.indexOf(" is by invitation only.")&&(d=this.i18n.byInviteOnly);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.joinGroupError,message:d})}this.hide()}))}});r.prototype.statics={_instance:null,
getInstance:function(){null==this._instance&&(this._instance=new r);return this._instance}};return r})},"arcgisonline/sharing/dijit/dialog/ManageSubscriptionDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/Button,dijit/form/RadioButton,arcgisonline/sharing/util,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/dijit/dialog/ChoiceDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.ManageSubscriptionDlg");
c.require("dijit.Dialog");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.form.Button");c.require("dijit.form.RadioButton");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.geow.Geow");c.require("arcgisonline.sharing.dijit.dialog.ChoiceDlg");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.declare("arcgisonline.sharing.dijit.dialog.ManageSubscriptionDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit.Dialog" id\x3d"manage-subscription-dialog" data-dojo-attach-point\x3d"_manageSubscriptionDlg" title\x3d"${i18n.manageSubscriptionTitle}" execute\x3d"" style\x3d"width:400px;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_upgradeSubscriptionDiv" style\x3d"display:none;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_inUSDiv"\x3e\x3c/div\x3e\x3cbr/\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_outsideUSDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_manageSubscriptionDiv" style\x3d"display:none;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_manageSubscriptionContainer"\x3e\r\n        \x3cp\x3e${i18n.manageSubscriptionDesc}\x3c/p\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit.form.RadioButton" type\x3d"radio" name\x3d"manageOption" data-dojo-attach-point\x3d"_upgradeRadioBtn" id\x3d"upgrade-radio-button" value\x3d"upgrade" checked\x3d"true"\x3e\r\n        \x3cspan\x3e\x3clabel for\x3d"upgrade-radio-button"\x3e\x3cb\x3e${i18n.upgradeOption}\x3c/b\x3e\x3c/label\x3e\x3c/span\x3e\x3cbr/\x3e\r\n        \x3cdiv class\x3d"esriLeadingMargin15"\x3e${i18n.upgradeDesc}\x3c/div\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_convertOptionDiv"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit.form.RadioButton" type\x3d"radio" name\x3d"manageOption" data-dojo-attach-point\x3d"_convertRadioBtn" id\x3d"convert-radio-button" value\x3d"convert"\x3e\r\n          \x3cspan\x3e\x3clabel for\x3d"convert-radio-button"\x3e\x3cb\x3e${i18n.convertOption}\x3c/b\x3e\x3c/label\x3e\x3c/span\x3e\x3cbr/\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin15"\x3e${i18n.convertDesc}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_evalSubscriptionContainer" style\x3d"display: none;"\x3e\r\n        \x3cp\x3e${i18n.upgradeOption} ${i18n.upgradeDesc}\x3c/p\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_purchaseInUSDiv"\x3e\x3c/div\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_purchaseOutsideUSDiv"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_convertSubscriptionDiv" style\x3d"display:none;"\x3e\r\n      \x3cp\x3e${i18n.convertSubscriptionDesc}\x3c/p\x3e\r\n      \x3cp\x3e\x3cb\x3e${i18n.deleteHostedMsg}\x3c/b\x3e\x3cbr/\x3e${i18n.notAvailableMsg}\x3c/p\x3e\r\n      \x3cdiv\x3e\x3cb\x3e${i18n.importantMsg}\x3c/b\x3e\x3cdiv data-dojo-attach-point\x3d"_importantMsgDiv"\x3e\x3c/div\x3e\x3c/div\x3e\r\n      \x3cp\x3e\x3cb\x3e${i18n.intendToUpgradeMsg}\x3c/b\x3e\x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_buttonDiv" class\x3d"esriFloatTrailing"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_okBtn" data-dojo-attach-event\x3d"onClick:onCancel" class\x3d"jevent cancel" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.ok}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_nextBtn" data-dojo-attach-event\x3d"onClick:onNext" class\x3d"jevent primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.next}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_convertBtn" data-dojo-attach-event\x3d"onClick:onConvert" class\x3d"jevent primary" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.convertLabel}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" data-dojo-attach-event\x3d"onClick:onCancel" class\x3d"jevent cancel" type\x3d"button" data-dojo-type\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
util:arcgisonline.sharing.util,geow:arcgisonline.sharing.geow.Geow,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ManageSubscriptionDlg);return this._instance}},_converting:!1,_choiceDlg:null,_selfResource:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").manageSubscriptionDlg)},
postCreate:function(){this.inherited(arguments);this._dialog=this._manageSubscriptionDlg;this.loadConnections()},show:function(a){this.selfResource=a;this._showManageView()},showManage:function(a){this.selfResource=a;this.clear();this._showManageView();this._manageSubscriptionDlg.show()},showUpgrade:function(a){this.selfResource=a;this.clear();this._showUpgradeView();this._manageSubscriptionDlg.show()},_showUpgradeView:function(){this._manageSubscriptionDlg.set("title",this.i18n.upgradeSubscriptionTitle);
"Trial"!==this.selfResource.subscriptionInfo.type&&"Trial Press"!==this.selfResource.subscriptionInfo.type&&"Evaluation"!==this.selfResource.subscriptionInfo.type||this._manageSubscriptionDlg.set("title",this.i18n.manageSubscriptionTitle);c.attr(this._inUSDiv,"innerHTML",esri.substitute({officeLinkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca target\x3d"_blank" href\x3d"http://www.esri.com/about-esri/offices/"\x3e',officeLinkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.upgradeInsideUS));c.attr(this._outsideUSDiv,
"innerHTML",esri.substitute({officeLinkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca target\x3d"_blank" href\x3d"http://www.esri.com/about-esri/offices/"\x3e',officeLinkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.upgradeOutsideUS));c.style(this._manageSubscriptionDiv,"display","none");c.style(this._convertSubscriptionDiv,"display","none");c.style(this._nextBtn.domNode,"display","none");c.style(this._convertBtn.domNode,"display","none");c.style(this._cancelBtn.domNode,"display","none");"active"!==
this.selfResource.subscriptionInfo.state||"Trial"!==this.selfResource.subscriptionInfo.type&&"Trial Press"!==this.selfResource.subscriptionInfo.type&&"Evaluation"!==this.selfResource.subscriptionInfo.type||this._manageSubscriptionDlg.set("title",this.i18n.manageSubscriptionTitle);c.style(this._upgradeSubscriptionDiv,"display","");c.style(this._okBtn.domNode,"display","")},_showManageView:function(){this._manageSubscriptionDlg.set("title",this.i18n.manageSubscriptionTitle);c.style(this._upgradeSubscriptionDiv,
"display","none");c.style(this._convertSubscriptionDiv,"display","none");c.style(this._okBtn.domNode,"display","none");c.style(this._convertBtn.domNode,"display","none");this.selfResource.subscriptionInfo&&"Evaluation"===this.selfResource.subscriptionInfo.type?(c.style(this._convertOptionDiv,"display","none"),c.style(this._manageSubscriptionContainer,"display","none"),c.style(this._evalSubscriptionContainer,"display",""),c.attr(this._purchaseInUSDiv,"innerHTML",esri.substitute({officeLinkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca target\x3d"_blank" href\x3d"http://www.esri.com/about-esri/offices/"\x3e',
officeLinkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.upgradeInsideUS)),c.attr(this._purchaseOutsideUSDiv,"innerHTML",esri.substitute({officeLinkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca target\x3d"_blank" href\x3d"http://www.esri.com/about-esri/offices/"\x3e',officeLinkEnd:"\x3c/a\x3e\x3c/span\x3e"},this.i18n.upgradeOutsideUS)),c.style(this._okBtn.domNode,"display",""),c.style(this._nextBtn.domNode,"display","none"),c.style(this._cancelBtn.domNode,"display","none")):(c.style(this._nextBtn.domNode,
"display",""),c.style(this._cancelBtn.domNode,"display",""));c.style(this._manageSubscriptionDiv,"display","")},_showConvertView:function(){this._manageSubscriptionDlg.set("title",this.i18n.convertToPersonalTitle);c.attr(this._importantMsgDiv,"innerHTML",esri.substitute({helpLinkStart:'\x3cspan class\x3d"esriItemLinks"\x3e\x3ca target\x3d"_blank" href\x3d"'+(this.selfResource.helpBase+this.selfResource.helpMap.m["120000592"])+'"\x3e',helpLinkEnd:"\x3c/a\x3e"},this.i18n.completeDetailsWithLinkMsg));
c.style(this._upgradeSubscriptionDiv,"display","none");c.style(this._manageSubscriptionDiv,"display","none");c.style(this._okBtn.domNode,"display","none");c.style(this._nextBtn.domNode,"display","none");c.style(this._convertSubscriptionDiv,"display","");c.style(this._convertBtn.domNode,"display","");c.style(this._cancelBtn.domNode,"display","")},loadConnections:function(){c.query(".jevent").connect("onclick",function(a){a.preventDefault()})},clear:function(){this._converting=!1;this._choiceDlg=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();
this._manageSubscriptionDlg.set("title","");c.style(this._upgradeSubscriptionDiv,"display","none");c.style(this._manageSubscriptionDiv,"display","none");c.style(this._convertSubscriptionDiv,"display","none");c.style(this._convertOptionDiv,"display","");c.style(this._manageSubscriptionContainer,"display","");c.style(this._evalSubscriptionContainer,"display","none");this._upgradeRadioBtn.set("checked",!0)},hide:function(){this._manageSubscriptionDlg.hide()},onNext:function(a){this._convertRadioBtn.get("checked")?
this._showConvertView():this._showUpgradeView()},onConvert:function(a){this._converting||(a={title:this.i18n.convertToPersonalTitle,message:this.i18n.noReturnMsg,choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel,choiceOneHandler:c.hitch(this,this.doConvert)},this._choiceDlg.show(a))},doConvert:function(){if(!this._converting&&esriGeowConfig.self&&esriGeowConfig.self.id){this._converting=!0;this._convertBtn.set("disabled",!0);var a=esriGeowConfig.baseUrl.replace(location.host,esriGeowConfig.self.portalHostname)+
esriGeowConfig.signin,a=a.replace("http:","https:");this.util.request({url:esriGeowConfig.restBaseUrl+"portals/self/convert",content:{target:"personal",timeout:12E4}},{usePost:!0}).then(c.hitch(this,function(c){this.geow.signout(a)}),c.hitch(this,function(a){this._converting=!1;this._convertBtn.set("disabled",!1);var e=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();e.onOkClick=c.hitch(this,function(){e.hide();this._manageSubscriptionDlg.hide()});e.show({title:this.i18n.errorTitle,
message:this.i18n.unableToConvert})}))}},onCancel:function(a){l.byId("manage-subscription-dialog").hide()},onHide:function(){}})})},"arcgisonline/sharing/dijit/dialog/ManageTilesDlg":function(){define("require esri/declare esri/Evented esri/config esri/lang esri/request dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/sniff dojo/topic dojo/json dijit/a11yclick dojo/number dojo/string dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dojo/store/Memory dojo/store/Observable dgrid/OnDemandGrid dgrid/selector dgrid/Selection dgrid/extensions/DijitRegistry esri/geometry/Extent esri/geometry/webMercatorUtils ../../../map/core/projectExtent ../../../map/utils/clipOnHorizon ../DefineExtent ./GeneralDlg ./ChoiceDlg ../../../pages/pageUtil ../../../pages/serviceUtil ../../util calcite-web/js/calcite-web dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/ManageTilesDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca){var V=l(null,{showFooter:!0,buildRendering:function(){this.inherited(arguments);var a=this.summaryAreaNode=y.create("div",{className:"summary-row",role:"row",style:{overflow:"hidden"}},this.footerNode);this.on("scroll",d.hitch(this,function(){a.scrollLeft=this.getScrollPosition().x}));this.summary&&this._setSummary(this.summary)},_updateColumns:function(){this.inherited(arguments);this.summary&&this._setSummary(this.summary)},
_renderSummaryCell:function(a,b,d){b.appendChild(document.createTextNode(a[d.field]||""))},_setSummary:function(a){var b=this.summaryTableNode;this.summary=a;b&&y.destroy(b);b=this.summaryTableNode=this.createRowCells("td",d.hitch(this,"_renderSummaryCell",a));this.summaryAreaNode.appendChild(b);this._started&&this.resize()}}),aa=l("arcgisonline.sharing.dijit.dialog.ManageTilesDlg",[x,B,z],{declaredClass:"arcgisonline.sharing.dijit.dialog.ManageTilesDlg",templateString:ca,widgetsInTemplate:!0,basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),
baseClass:"esriManageTiles",PROCESSING:"PROCESSING",SUBMITTED:"SUBMITTED",DEFAULT_TILE_WIDTH:256,DEFAULT_TILE_HEIGHT:256,TIME_TO_NEXT_UPDATE:1E4,TABS:{LEVELS:"levels",EXTENT:"extent"},_noSourceData:!1,_isSourceTilePackage:!1,_isVisible:!1,_isProcessing:!1,_wasProcessing:!1,_allTilesComplete:!1,_createClicked:!1,_tab:"levels",postMixInProperties:function(){this.inherited(arguments);this.i18n=d.mixin({},X.common);this.i18n=d.mixin(this.i18n,X.manageTilesDlg)},postCreate:function(){this.inherited(arguments);
a.defaults.io.proxyUrl=esriGeowConfig.proxyServer;esriGeowConfig.proxyUrl&&(a.defaults.io.proxyUrl=esriGeowConfig.proxyUrl);var b=d.hitch(this,"hide");this.own(n(this._buildButton,d.hitch(this,"_createClick")),n(this._cancelButton,d.hitch(this,"_cancelClick")),n(this._closeButton,b),n(this.dialog.closeButtonNode,b),n(this._levelsTab,d.hitch(this,"_levelsTabClick")),n(this._extentTab,d.hitch(this,"_extentTabClick")))},destroy:function(){this.inherited(arguments);this._defineExtent&&this._defineExtent.destroy()},
setServerTokens:function(a,b,d){this._hostedServer=a;this._serverToken=b;this._adminServerToken=d},displayTabs:function(a){this._mustDisplayTabs=a},show:function(a,b,c,e){b=d.hitch(this,"_handleServiceInfo",b);D.tabs();this._setFlags();this.item=a;(this._isSourceTilePackage=c)?(w.set(this._buildButton,"innerHTML",this.i18n.publishButton),w.set(this.dialog,"title",this.i18n.publishButton),this._canShowTabs=!1):this._isPortal?this._canShowTabs=!1:(w.set(this.dialog,"title",this.i18n.buildTitle),this._canShowTabs=
!(!esriGeowConfig.tilesOnDemandEnabled||!this._mustDisplayTabs));this._showTabs(this._canShowTabs);e?b(e):(a=this._isPortal?f({url:this.item.url,content:{f:"json",token:this._serverToken}}):I.request({url:this.item.url}),a.then(b,b))},showNoSource:function(a,b){this._noSourceData=!0;this.show(a,b,!1)},hide:function(){this._noSourceData=!1;this.dialog.hide();(this._createClicked||this._wasProcessing)&&p.publish("manage-tiles/update",{tileInfoChanged:!0});this._isVisible=this._wasProcessing=this._createClicked=
!1},_showTabs:function(a){G[a?"showNode":"hideNode"](this._tabNav);k(".tab-contents").forEach(function(b){t[a?"remove":"add"](b,"no-border")})},_setFlags:function(){this._isPortal=I.isPortal();this._roleCanPublishTiles=(this._roleCanCreateItem=esriGeowConfig.userRole.canCreateItem())&&esriGeowConfig.userRole.canPublishTiles();this._createClicked=this._allTilesComplete=this._wasProcessing=this._isProcessing=this._isVisible=this._isSourceTilePackage=this._noSourceData=!1;this._refreshTilesEnabled=!this._isPortal&&
esriGeowConfig.tilesOnDemandEnabled},_handleServiceInfo:function(a,b){!b||b.code||b.message||(this._serviceFullExtent=b.fullExtent,this._serviceTileInfo=b.tileInfo,this._serviceTileInfo.width=this._serviceTileInfo.width||this.DEFAULT_TILE_WIDTH,this._serviceTileInfo.height=this._serviceTileInfo.height||this.DEFAULT_TILE_HEIGHT,this.serviceMinScale=b.minScale?b.minScale:this._serviceTileInfo.lods[0].scale,this.serviceMaxScale=b.maxScale?b.maxScale:this._serviceTileInfo.lods[this._serviceTileInfo.lods.length-
1].scale,this.dialog.show(),this._isVisible=!0,this._updateStatus(a))},_handleReportCacheStatus:function(a){a&&a.results&&!a.message&&(a=a.results[0],a.serviceName=this._lastTileStatus.serviceName,a.type=this._lastTileStatus.type,a.lodInfos=a.value.lodInfos,a.cacheExecutionStatus=a.value.cacheExecutionStatus,a.minScale=this._lastTileStatus.minScale,a.maxScale=this._lastTileStatus.maxScale);this._updateStatus(a)},_getStatus:function(){var a=this;if(this._isVisible)if(a._isPortal){var b=d.hitch(a,"_handleReportCacheStatus"),
c=a.item.url.indexOf("/services/")+10,e=a.item.url.indexOf("/"+a._lastTileStatus.serviceName+"/")+1,c=a.item.url.substring(c,e)+a._lastTileStatus.serviceName+":"+a._lastTileStatus.type,g=T.adjustHostedServerForProtocol(a._hostedServer.url)+"/rest/services/System/ReportingTools/GPServer/ReportCacheStatus/execute",k={service_url:c,report_mode:"esriCacheStatus",f:"json",token:a._serverToken,job_id:a._jobId,ts:(new Date).getTime()};a._jobId?f({url:g,content:k}).then(b,b):(c={service_url:c,report_mode:"esriJobSummary",
f:"json",token:a._serverToken,ts:(new Date).getTime()},f({url:g,content:c}).then(function(d){d&&d.results&&d.results[0]&&d.results[0].value.esriJobStatus&&d.results[0].value.esriJobStatus[0]&&(a._jobId=d.results[0].value.esriJobStatus[0].cancelJobID,k.job_id=a._jobId);f({url:g,content:k}).then(b,b)}))}else c=a.item.url.replace("/rest/","/rest/admin/"),e=d.hitch(a,"_updateStatus"),I.request({url:c,content:{ts:(new Date).getTime()}}).then(e,e)},_updateStatus:function(a){if(this._isVisible&&(!a||"Error"!==
a.name||"Unknown runtime error"!==a.message)){this._lastTileStatus=a;this._lastTileStatus.minScale=this._lastTileStatus.minScale||this.serviceMinScale;this._lastTileStatus.maxScale=this._lastTileStatus.maxScale||this.serviceMaxScale;if(this._isProcessing=a.cacheExecutionStatus===this.PROCESSING||a.cacheExecutionStatus===this.SUBMITTED)this._wasProcessing=!0,setTimeout(d.hitch(this,"_getStatus"),this.TIME_TO_NEXT_UPDATE);this._refreshUI()}},_refreshUI:function(){this._updateData();this._grid?this._updateGrid():
this._createGrid();this._updateTotals();this._updateExtent();this._updateDescription();this._updateButtons();this._updateMessage();this._updateTabs()},_updateExtent:function(){if(this._defineExtent&&this._defineExtent._started&&!this._updatedExtent){var a=[[],[]],b;4326!==this._serviceFullExtent.spatialReference.wkid&&(b=L.webMercatorToGeographic(new J(this._serviceFullExtent)));a[1][1]=parseFloat(b.ymax);a[0][0]=parseFloat(b.xmin);a[1][0]=parseFloat(b.xmax);a[0][1]=parseFloat(b.ymin);this._defineExtent.set("extent",
a)}},_updateTabs:function(){this._isProcessing?(this._canShowTabs&&(t.remove(this._extentTab,"is-active"),t.remove(this._extentSection,"is-active"),t.add(this._levelsTab,"is-active"),t.add(this._levelsSection,"is-active")),this._showTabs(!1)):this._showTabs(this._canShowTabs)},_updateButtons:function(){this._roleCanPublishTiles?this._isProcessing||this._allTilesComplete&&!this._refreshTilesEnabled?(this._hideButtons(),this._isProcessing&&this._isPortal&&this._jobId?this._showCancel():this._hideCancel()):
(this._showButtons(),this._hideCancel()):this._hideButtons()},_updateMessage:function(){this._isProcessing||this._allTilesComplete&&!this._refreshTilesEnabled||(this._noSourceData?w.set(this._messageDiv,"innerHTML",this.i18n._noSourceData):w.set(this._messageDiv,"innerHTML",this._isSourceTilePackage?this.i18n.selectTilesPublish:this.i18n.selectTiles+"\x3cbr\x3e"+this.i18n.adjustVisibleRange))},_updateData:function(){var a=this.i18n.totals,d=this._lastTileStatus;this._gridStore=new E(new A({data:this._getTileStatusData(),
identifier:"id"}));this._gridStore.getTotals||(this._gridStore.getTotals=function(){var c={},e=0,f=0,g=0,k;b.forEach(this.data,function(a){e+=parseInt(a.created,10);f+=parseInt(a.expected,10);g+=a.storageSize?parseInt(a.storageSize,10):0});k=r.round(e/f*100,2)||0;k=100<k?100:k;c.selected="";c.scaleLevel=a;c.created=r.format(e);c.expected=r.format(f);c.pctComplete=String(k);c.storageSize=G.sizeInMB(d&&d.size||g);return c});if(this._noSourceData)G.hideNode(this._scalesSelectedSpan);else{var c=v.substitute(this.i18n.scalesSelected,
{scales:0});w.set(this._scalesSelectedSpan,"innerHTML",c)}},_getTileStatusData:function(){var a=this,d=[],c=0,e=0,f,g,k,m;b.forEach(a._serviceTileInfo.lods,function(b){Math.floor(b.scale)<=a._lastTileStatus.minScale&&Math.ceil(b.scale)>=a._lastTileStatus.maxScale&&(f=G.calculateExpectedTiles(a._serviceTileInfo,a._serviceFullExtent,b),d.push({id:b.level,selected:!1,scaleLevel:"1:"+r.format(Math.round(b.scale),{pattern:"#,###,###,##0"}),scale:b.scale,created:0,expected:f,pctComplete:0,storageSize:0}))});
a._lastTileStatus&&a._lastTileStatus.lodInfos&&0<a._lastTileStatus.lodInfos.length&&b.forEach(a._lastTileStatus.lodInfos,function(b){for(m=0;m<d.length;m++)if(d[m]&&d[m].id===b.levelID){g=Math.round(b.tileCount/b.expectedTileCount*100);100<g&&(g=100);a._isPortal&&b.pct&&(g=b.pct);k=d[m];k.created=b.tileCount;k.expected=b.expectedTileCount;k.pctComplete=g;k.storageSize=b.tilesSize?b.tilesSize:0;break}});b.forEach(d,function(a){c+=a.created;e+=a.expected});a._allTilesComplete=c===e;a._disableButtons();
return d},_updateTotals:function(){var a=this,b=a._grid.on("dgrid-refresh-complete",function(){a._scrollNode&&a._currentScrollPos&&(a._scrollNode.scrollTop=a._currentScrollPos);b.remove()});a._scrollPos&&(a._currentScrollPos=a._scrollPos);a._grid.set("summary",a._gridStore.getTotals());a._grid.resize();a._grid.refresh()},_updateDescription:function(){w.set(this._dialogDescription,"innerHTML","\x3cstrong\x3e"+(this._isProcessing?this._isSourceTilePackage?this.i18n.jobStatusPublishing:this.i18n.jobStatus:
this.i18n.noJobStatus)+"\x3c/strong\x3e\x3cbr/\x3e")},_hideButtons:function(){G.hideNodes(k("div.messageContainer"));G.hideNodes(k("div.selected-scales-container"));G.hideNode(this._buildButton)},_showButtons:function(){G.showNode(this._buildButton);G.showNodes(k("div.selected-scales-container"));G.showNodes(k("div.messageContainer"))},_hideCancel:function(){G.hideNode(this._cancelButton)},_showCancel:function(){G.showNode(this._cancelButton)},_updateGrid:function(){this._grid.set("columns",this._getGridLayout());
this._grid.set("store",this._gridStore)},_createGrid:function(){this._grid=new (l([N,H,K,V]))({id:"scaleGrid",columns:this._getGridLayout(),showLoadingMessage:!1,showFooter:!0,noDataMessage:"",selectionMode:"none",gridScope:this,allowSelectAll:!0,store:this._gridStore,sort:[{attribute:"id",descending:!1}]},this._gridContainer);this._grid.startup();this.own(this._grid.on(".dgrid-header-row .field-selected:click",d.hitch(this,function(a){this._toggleAll("INPUT"===a.target.tagName?a.target:a.target.childNodes[0])})));
this.own(this._grid.on(".dgrid-row .field-selected:click",d.hitch(this,function(a){a="INPUT"===a.target.tagName?a.target:a.target.childNodes[0];var b=a.parentNode.parentNode.parentNode.parentNode.id,b=b.substring(b.indexOf("scaleGrid-row-")+14);this._toggleScale(a,b)})));this.own(this._grid.on("scroll",d.hitch(this,function(a){this._scrollPos=(this._scrollNode=a&&a.scrollTarget||null)&&this._scrollNode.scrollTop||0})))},_getGridLayout:function(){var a=[];this._isProcessing||this._allTilesComplete&&
!this._refreshTilesEnabled||this._noSourceData||!this._roleCanPublishTiles||a.push(O({field:"selected",sortable:!1,selectorType:"checkbox"}));a.push({field:"scaleLevel",label:this.i18n.grid.scaleLevel,sortable:!1,formatter:this._contentFormatter});a.push({field:"created",label:this._isSourceTilePackage?this.i18n.grid.tilesPublished:this.i18n.grid.tilesCreated,sortable:!1,formatter:this._tilesFormatter});a.push({field:"expected",label:this.i18n.grid.totalTiles,sortable:!1,formatter:this._tilesFormatter});
a.push({field:"pctComplete",label:this.i18n.grid.percentComplete,sortable:!1,formatter:this._contentFormatter});a.push({field:"storageSize",label:this.i18n.grid.storageSize,sortable:!1,formatter:this._sizeFormatter});return a},_levelsTabClick:function(){this._tab=this.TABS.LEVELS;this._updateMessage();this._checkToggled()},_extentTabClick:function(){var a=[[],[]],b;this._tab=this.TABS.EXTENT;this._defineExtent||(this._defineExtent=new Q({id:"defineExtent"},this._extentContainer),this._defineExtent.startup(),
4326!==this._serviceFullExtent.spatialReference.wkid&&(b=L.webMercatorToGeographic(new J(this._serviceFullExtent))),a[1][1]=parseFloat(b.ymax),a[0][0]=parseFloat(b.xmin),a[1][0]=parseFloat(b.xmax),a[0][1]=parseFloat(b.ymin),this._defineExtent.set("extent",a),this.own(p.subscribe("define-extent/change",d.hitch(this,"_onExtentChange"))));w.set(this._messageDiv,"innerHTML",this.i18n.defineExtent);this._checkToggled()},_onExtentChange:function(a){this._serviceFullExtent.spatialReference.wkid===a.spatialReference.wkid?
this._updatedExtent=a:R(a,this._serviceFullExtent.spatialReference,d.hitch(this,function(a){a&&a.length&&(a=a.shift());this._updatedExtent=M(a)}),null,this._defineExtent.map);this._checkToggled()},_calculateIntersection:function(a,b){a=new J(a);b=new J(b);return(b=a.intersects(b))?b.toJson():null},_cancelClick:function(){var a=this;G.disableNode(a._cancelButton,!0);var b=function(b){e.isDefined(b.error)&&(G.createSpecifiedDialog(U).show({title:a.i18n.errorTitle,message:a.i18n.cantCancelJob}),a._cancelButton.set("disabled",
!1))};f({url:a._hostedServer.adminUrl+"/rest/services/System/CachingControllers/GPServer/Manage%20Map%20Cache%20Tiles/jobs/"+a._jobId+"/cancel",content:{f:"json",token:a._adminServerToken}},{usePost:!0}).then(b,b)},_checkCredits:function(a){var b=new C,d=esriGeowConfig.restBaseUrl+"portals/self/cost";a={generatedTileCount:a};this._isPortal||this._isSourceTilePackage?b.resolve():I.request({url:d,content:a}).then(function(a){b.resolve(a)},function(){b.resolve()});return b},_createClick:function(){var a=
this._getAvgTileSize(this._serviceTileInfo),c=0,g=0,k=0,n=[],D,p,h,t,l,u=0,w=0,y;b.forEach(this._grid.store.query(),d.hitch(this,function(a){h=parseInt(a.created,10);t=parseInt(a.expected,10);l=parseInt(a.storageSize,10);!0===a.selected&&(D=parseInt(a.expected,10)-parseInt(a.created,10),0<D&&(this._isPortal?n.push(""+a.scale):n.push(a.id)),esriGeowConfig.tilesOnDemandEnabled&&!this._isPortal&&this._updatedExtent?u=(y=this._calculateIntersection(this._updatedExtent,this._serviceFullExtent))?u+G.calculateExpectedTiles(this._serviceTileInfo,
y,this._serviceTileInfo.lods[a.id]):u+0:u+=h<=t?h:t,w+=t);g+=h;k+=l}));p=esriGeowConfig.tilesOnDemandEnabled&&!this._isPortal&&this._updatedExtent?q.stringify(this._updatedExtent):this._serviceFullExtent.xmin+","+this._serviceFullExtent.ymin+","+this._serviceFullExtent.xmax+","+this._serviceFullExtent.ymax;if(0<n.length){var c=esriGeowConfig.tilesOnDemandEnabled&&!this._isPortal&&this._updatedExtent?u:w-u,x=this._formatSizeWithUnits((0<k&&0<g?k/g:a)*c),T=this._isPortal?n.join(";"):n.join(",");this._checkCredits(c).then(d.hitch(this,
function(a){var b="\x3cp\x3e"+v.substitute(this._isSourceTilePackage?this.i18n.aboutToPublish:this.i18n.aboutToCreate,{tiles:c,storage:x})+"\x3c/p\x3e",g=!1;!this._isPortal&&!this._isSourceTilePackage&&e.isDefined(a.transactionCreditCost)&&e.isDefined(a.availableCredits)&&(a.transactionCreditCost>a.availableCredits?g=!0:b+="\x3cp\x3e"+v.substitute(this.i18n.aboutToCreateCost,{credits:r.format(a.transactionCreditCost),creditsLeft:r.format(a.availableCredits)})+"\x3c/p\x3e");b+="\x3cp\x3e"+(this._isSourceTilePackage?
this.i18n.reallyPublishTiles:this.i18n.reallyCreateTiles)+"\x3c/p\x3e";!this._isPortal&&g?G.createSpecifiedDialog(U).show({title:this.i18n.notice,message:this.i18n.notEnoughCredits}):(a={title:this._isSourceTilePackage?this.i18n.publishTiles:this.i18n.createTiles,message:b,choiceOneTitle:this._isSourceTilePackage?this.i18n.yesPublishTiles:this.i18n.yesCreateTiles,choiceTwoTitle:this._isSourceTilePackage?this.i18n.noPublishTiles:this.i18n.noCreateTiles},a.choiceOneHandler=d.hitch(this,function(){this._createClicked=
!0;if(this._isPortal){G.disableNode(this._cancelButton,!1);var a=this.item.url.indexOf("/services/")+10,b=this.item.url.indexOf(this._lastTileStatus.serviceName),b=this.item.url.substring(a,b),a=this._hostedServer.adminUrl+"/rest/services/System/CachingControllers/GPServer/Manage%20Map%20Cache%20Tiles/submitJob",b={f:"json",token:this._adminServerToken,service_url:b+this._lastTileStatus.serviceName+":"+this._lastTileStatus.type,constraining_extent:p,levels:T,update_mode:"RECREATE_ALL_TILES",thread_count:-1},
c=d.hitch(this,function(a){a.code&&a.message?G.createSpecifiedDialog(U).show({title:this.i18n.errorTitle,message:a.message}):(this._jobId=a._jobId,this._isProcessing=!0,this._isVisible&&(this._updatedExtent=void 0,this._refreshUI(),setTimeout(d.hitch(this,"_getStatus"),this.TIME_TO_NEXT_UPDATE)))});f({url:a,content:b},{usePost:!0}).then(c,c)}else a=this.item.url.replace("/rest/","/rest/admin/")+"/updateTiles",9>=m("ie")&&(b=a.indexOf("admin/services/"),c=a.indexOf("/MapServer"),a=a.substring(0,b+
15)+encodeURIComponent(a.substring(b+15,c))+a.substring(c)),b={levels:T,extent:p},c=d.hitch(this,function(a){if(a.code&&a.message){var b=a.message;a.message&&-1<a.message.toLowerCase().indexOf("credit")?b=this.i18n.notEnoughCredits:a.message&&-1<a.message.toLowerCase().indexOf("invalid extent")&&(b=this.i18n.invalidExtent);G.createSpecifiedDialog(U).show({title:this.i18n.errorTitle,message:b})}else this._isProcessing=!0,this._isVisible&&(this._updatedExtent=void 0,this._refreshUI(),setTimeout(d.hitch(this,
"_getStatus"),this.TIME_TO_NEXT_UPDATE))}),I.request({url:a,content:b},{usePost:!0}).then(c,c)}),a.choiceTwoHandler=d.hitch(this,function(){}),this._createChoiceDlg().show(a))}))}},_createChoiceDlg:function(){var a;u.byId("choice-dialog")?a=S.prototype.statics.getInstance():(a=new S,g.once(a._dialog,"hide",function(){a._dialog.destroyRecursive();a.destroyRecursive()}));return a},_contentFormatter:function(a){return'\x3cspan class\x3d"esriContentTypeName"\x3e'+a+"\x3c/span\x3e"},_tilesFormatter:function(a){var b=
"esriContentTypeName";a&&1E10<=a&&(b="esriContentTypeNameSmall");return'\x3cspan class\x3d"'+b+'"\x3e'+r.format(a)+"\x3c/span\x3e"},_sizeFormatter:function(a){return'\x3cspan class\x3d"esriContentTypeName"\x3e'+G.sizeInMB(a)+"\x3c/span\x3e"},_getAvgTileSize:function(a){return 1E3*(a.rows?a.rows/10:25.6)},_formatSizeWithUnits:function(a){var b=a,d=" "+this.i18n.megabytes;1048567E3<a?(b=a/1048567E3,d=" "+this.i18n.gigabytes):0<a&&(b=a/1048567);b=Math.round(100*b)/100;return r.format(b)+d},_enableButtons:function(a,
b,d){var c=this._tab===this.TABS.LEVELS?this.i18n.tilesToCreate:this.i18n.tilesToCreateInExtent,e=this.i18n.tilesToPublish,f=this.i18n.noTilesToCreate,g=this.i18n.noTilesToPublish,k="";a!==b?(a=b-a,d=this._formatSizeWithUnits(d*a),k=v.substitute(this._isSourceTilePackage?e:c,{tiles:a,storage:d}),G.disableNode(this._buildButton,!1)):(k=v.substitute(this._isSourceTilePackage?g:f,{tiles:0}),G.disableNode(this._buildButton,!0));w.set(this._messageDiv,"innerHTML",k)},_disableButtons:function(){w.set(this._messageDiv,
"innerHTML",this._isSourceTilePackage?this.i18n.selectTilesPublish:this.i18n.selectTiles+"\x3cbr\x3e"+this.i18n.adjustVisibleRange);G.disableNode(this._buildButton,!0)},_setScalesSelected:function(a){a=v.substitute(this.i18n.scalesSelected,{scales:a});this._scalesSelectedSpan&&w.set(this._scalesSelectedSpan,"innerHTML",a)},_toggleAll:function(a){var d;a&&(d=w.get(a,"checked"),this._grid&&this._grid.store&&(b.forEach(this._grid.store.query(),function(a){a.selected=d}),this._checkToggled()))},_toggleScale:function(a,
b){if(this._grid.store){if(b=this._grid.store.query({id:b}).shift())b.selected=w.get(a,"checked");this._checkToggled()}},_checkToggled:function(){var a=this,d=0,c=0,e=0,f=0,g=0,k,m;a._grid.store?(b.forEach(a._grid.store.query(),function(b){var m=parseInt(b.created,10),n=parseInt(b.expected,10),D=parseInt(b.storageSize,10);b.selected&&(d++,esriGeowConfig.tilesOnDemandEnabled&&!a._isPortal&&a._updatedExtent?c=(k=a._calculateIntersection(a._updatedExtent,a._serviceFullExtent))?c+G.calculateExpectedTiles(a._serviceTileInfo,
k,a._serviceTileInfo.lods[b.id]):c+0:c+=m<=n?m:n,e+=n);f+=m;g+=D}),d?(m=0<g?g/f:a._getAvgTileSize(a._serviceTileInfo),esriGeowConfig.tilesOnDemandEnabled&&!a._isPortal&&a._updatedExtent?a._enableButtons(e-c,e,m):a._enableButtons(c,e,m)):a._disableButtons()):a._disableButtons();a._setScalesSelected(d)}});aa.prototype.statics={getInstance:function(){this._instance||(this._instance=new aa);return this._instance}};return aa})},"arcgisonline/pages/serviceUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/json dojo/on dojo/promise/all dojo/sniff esri/lang esri/layers/FeatureLayer esri/request ./pageUtil esri/arcgis/Portal arcgisonline/sharing/dijit/Role ../sharing/dijit/dialog/_CreateItemUtilMixin ../sharing/util ../esriGeowConfig".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w){return{getDateFields:function(a){return h.filter(a&&a.fields||[],function(a){return a&&"esriFieldTypeDate"===a.type})},fetchServerToken:function(a,b){var d=a.portal;return(a=b||a.url)?u.request({url:u.getSecureUrl(d.portalUrl+"generateToken"),content:{serverUrl:a}},{usePost:!0}).then(l.hitch(this,function(a){return a.token})):null},fetchItemAdminUrl:function(a,b){return a.portal.isPortal?b&&b.adminUrl&&b.url?this.getAdminUrl(a,b):a.url:a.url&&a.url.replace("/rest/",
"/rest/admin/")||null},getAdminUrl:function(a,b){var d=a.url;b=d.replace(d.split("/rest/")[0],b.adminUrl);return a.isSDS?b.replace("/rest/","/rest/admin/"):b.replace("/rest/","/admin/").replace("/FeatureServer",".MapServer").replace("/MapServer",".MapServer").replace("/VectorTileServer",".VectorTileServer").replace("/SceneServer",".SceneServer")},fetchServiceLayers:function(a){return u.request({url:a+"/layers"}).then(l.hitch(this,function(a){return a&&a.layers||[]}))},renameServiceLayers:function(b,
d){var c=new a,e=d.adminUrl+"/"+b.layerId;b={name:b.layerRename};"Map Service"===d.type?(e+="/edit",updateDefinition={layerDefinition:JSON.stringify(b)}):(e+="/updateDefinition",updateDefinition={updateDefinition:JSON.stringify(b),async:!1});u.request({url:e,content:updateDefinition},{usePost:!0}).then(l.hitch(this,function(){c.resolve()},l.hitch(this,function(a){c.reject(a)})));return c},queryGeocodeCounts:function(d){var c;c=[];var e=d.url,f={where:"1\x3d1",returnCountOnly:!0},g=d.reviewTable,k=
e+"/"+(d.layers||[])[0].id+"/query";if(d.canUpdate&&d.isHostedService&&d.hasGeocodeReviewTable)return c.push(u.request({url:k,content:f})),g&&(d=e+"/"+g.id+"/query",c.push(u.request({url:d,content:f}))),b(c).then(l.hitch(this,function(a){var b=a&&a.length&&a[0].count||0;return{successful:b,total:b+(a&&a.length&&1<a.length&&a[1].count||0)}}));c=new a;c.resolve(null);return c},adjustHostedServerForProtocol:function(a){return"https:"===location.protocol?a.replace("http:","https:").replace(":6080",":6443"):
a.replace("https:","http:").replace(":6443",":6080")},checkForResources:function(b){var d=b.itemUrl+"/resources/styles/root.json";"Vector Tile Service"!==b.type||k.isDefined(b.hasResources)?(d=new a,d.resolve(!!b.hasResources)):d=u.request({url:d}).then(function(){return!0},function(){return!1});return d},setFeatureServiceScaleRanges:function(d){var c=new a,e=d.url,f=d.sourceData||{},g=d.featureLayers||[];!d.numViews&&d.isHostedService&&"Feature Service"===d.type&&"Service Definition"!==f.type?b(h.map(g,
l.hitch(this,function(a){return this.setScaleRange(e+"/"+a.id,d,a.id)}))).then(l.hitch(this,function(){c.resolve(!0)})):c.resolve(!0);return c},setScaleRange:function(b,d,c){var e=new a,g=new m(b),n=d.adminUrl+(k.isDefined(c)?"/"+c:"")+"/updateDefinition",p;g.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){g.statisticsPlugin.getSuggestedScaleRange().then(function(a){p={updateDefinition:f.stringify({maxScale:a.maxScale||0,minScale:a.relaxedMinScale||0})};u.request({url:n,content:p},
{usePost:!0}).then(l.hitch(this,function(){e.resolve(d)}),l.hitch(this,function(){e.resolve(d)}))},function(a){e.resolve(d)})});return e},getSuggestedScaleRange:function(b){var d=new a,c=new m(b);c.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){c.statisticsPlugin.getSuggestedScaleRange({sampleSize:100,forPublishingTiles:!0}).then(function(a){d.resolve(a)},function(a){d.resolve(null)})},function(a){d.resolve(null)});return d},_encodeServiceName:function(a,b){if(g("ie")||g("trident")||
g("edge")){var d=a.indexOf("admin/services/Hosted/");b=u.isPortal()&&!b?-1<a.indexOf(".MapServer")?a.indexOf(".MapServer"):-1<a.indexOf(".VectorTileServer")?a.indexOf(".VectorTileServer"):a.indexOf("/SceneServer"):a.indexOf("/FeatureServer");0<d&&(a=a.substring(0,d+22)+encodeURIComponent(a.substring(d+22,b))+a.substring(b))}return a},fetchScenePublishingCredits:function(d,c){var e=new a,g=d.adminServiceInfo||{},k=g.layers||[],m=d.url+"/query",n,p={},h={},r={},t={textured:0,untextured:0},v=(d.portal||
{}).portalUrl+"portals/self/usageCost",w={name:g.name,etype:"tilegencnt",stype:"scene"};c.forEach(l.hitch(this,function(a){n=q.find(k,function(b){return b.id===a.id});n.isTextured=!(!n.multiPatchInfo||!n.multiPatchInfo.hasTexture);r[a.id]=n;h[a.id]="1\x3d1"}));p.layerDefs=f.stringify(h);p.returnCountOnly=!0;u.request({url:m,content:p}).then(function(a){a&&a.layers?(a.layers.forEach(function(a){t[r[a.id].isTextured?"textured":"untextured"]+=a.count}),b({textured:0<t.textured?u.request({url:v,content:l.mixin({num:t.textured,
task:"textured"},w)}):null,untextured:0<t.untextured?u.request({url:v,content:l.mixin({num:t.untextured,task:"nontextured"},w)}):null}).then(l.hitch(this,function(a){e.resolve((a&&a.textured&&a.textured.credits||0)+(a&&a.untextured&&a.untextured.credits||0))}),l.hitch(this,function(){e.resolve(0)}))):e.resolve(0)},function(){e.resolve(0)});return e},findManagedDataStoreItems:function(a){return u.request({url:a+"/admin/data/findItems",content:{managed:!0}},{useProxy:!0})},isBackedBySDS:function(b){var d=
new a,c=w.self&&w.self.user||{},e=new r({portalUser:c}),f=!1,g;c&&(e.isBasedOnAdmin()||e.isBasedOnPublisher())&&b&&!q.isEmptyObject(b)?this.findManagedDataStoreItems(b.adminUrl).then(l.hitch(this,function(a){g=(a&&a.items||a||[]).filter(l.hitch(this,function(a){return a&&a.provider&&"arcgis data store"===a.provider.toLowerCase()}));f=!(!g||!g.length);d.resolve(f)}),l.hitch(this,function(){d.resolve(f)})):d.resolve(f);return d},getBackingDataStoreInfo:function(b){var d=new a,c=w.self&&w.self.user||
{},e=new r({portalUser:c}),f=!0,g=!1,k;c&&(e.isBasedOnAdmin()||e.isBasedOnPublisher())&&b&&!q.isEmptyObject(b)?this.findManagedDataStoreItems(b.adminUrl).then(l.hitch(this,function(a){k=(a&&a.items||a||[]).filter(l.hitch(this,function(a){return a&&a.provider&&"arcgis data store"===a.provider.toLowerCase()}));f=0===(a&&a.items||a||[]).length;g=!(!k||!k.length);d.resolve({isSDS:g,none:f})}),l.hitch(this,function(){d.resolve({isSDS:g,none:f})})):d.resolve({isSDS:g,none:f});return d},_cacheMaxAgeCheck:function(a,
b){if(!a.ignoreCache&&a.layers&&"Feature Service"===a.type&&a.isHostedService&&b&&b.adminServiceInfo&&0<b.adminServiceInfo.cacheMaxAge&&(a.ignoreCache=function(){this.ignoreCacheFlagTimestamp=(new Date).getTime();var a=function(a){a.content=a.content||{};a.content._ts=this.ignoreCacheFlagTimestamp;return a}.bind(this);this.ignoreCacheFlag||(p.setRequestPreCallback(a),this.ignoreCacheFlag=!0)},a.layers)){var d=0;a.layers.forEach(function(a){a.editingInfo&&a.editingInfo.lastEditDate&&d<a.editingInfo.lastEditDate&&
(d=a.editingInfo.lastEditDate)});0<d&&((new Date).getTime()-d)/1E3<b.adminServiceInfo.cacheMaxAge&&a.ignoreCache()}}}})},"arcgisonline/sharing/dijit/dialog/MembershipRequestsDlg":function(){define("require esri/declare esri/Evented dojo/_base/lang dojo/_base/array dojo/on dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/query dojo/string dojo/topic dojo/date/locale dojo/store/Memory dijit/a11yclick dijit/Dialog dijit/form/Button dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ../../../esriGeowConfig ../../util ../Grid ./GeneralDlg dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/MembershipRequestsDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E){var N=l("arcgisonline.sharing.dijit.dialog.MembershipRequestsDlg",[t,y,C,h],{baseClass:"esriMembershipRequestsDlg",widgetsInTemplate:!0,templateString:E,groupId:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=a.mixin({},A.common);a.mixin(this.i18n,A.membershipRequestsDlg);a.mixin(this.i18n,A.groupMembershipRequestsGrid);a.mixin(this.i18n,{error:A.inviteUsersDlg.error})},postCreate:function(){this.loadConnections()},
loadConnections:function(){this.own(m(".jevent").on("click",function(a){a.preventDefault()}),v(this._closeBtn,a.hitch(this,function(){this._dialog.hide()})),q.subscribe("onApplicationAccept",a.hitch(this,"onApplicationApprove")),q.subscribe("onApplicationDecline",a.hitch(this,"onApplicationDecline")))},show:function(a){this.groupId=a;this.clearStore();this.requestApplications();this._dialog.show()},approveApplication:function(b,d){var c=B.getUser(),e=this._requestsGrid._grid.store;c&&B.request({url:x.restBaseUrl+
"community/groups/"+this.groupId+"/applications/"+d+"/accept"},{usePost:!0}).then(a.hitch(this,function(){e.remove(b.id);q.publish("onApplicationAccept",{})}),a.hitch(this,function(){var a=new F;f.once(a._dialog,"hide",function(){a._dialog.destroyRecursive();a.destroyRecursive()});a.show({title:this.i18n.errorTitle,message:p.substitute(this.i18n.error.unableToAddPrivs,{user:d})});e.remove(b.id);q.publish("onApplicationAccept",{})}))},declineApplication:function(b,d){var c=B.getUser(),e=this._requestsGrid._grid.store;
c&&B.request({url:x.restBaseUrl+"community/groups/"+this.groupId+"/applications/"+d+"/decline"},{usePost:!0}).then(a.hitch(this,function(){e.remove(b.id);q.publish("onApplicationDecline",{})}))},onApplicationApprove:function(){0===this._requestsGrid._grid.store.query().length?this.hide():this.refresh()},onApplicationDecline:function(){0===this._requestsGrid._grid.store.query().length?this.hide():this.refresh()},requestApplications:function(){var b=this._requestsGrid._grid.store;return B.request({url:x.restBaseUrl+
"community/groups/"+this.groupId+"/applications"}).then(a.hitch(this,function(a){a.applications&&(e.forEach(a.applications,function(a,d){a.id=d;b.put(a)}),this.refresh())}))},clearStore:function(){this._requestsGrid||this.createGrid();var b=this._requestsGrid&&this._requestsGrid._grid&&this._requestsGrid._grid.store||void 0;b&&e.forEach(a.clone(b.query()),function(a){b.remove(a.id)})},createGrid:function(){this._requestsGrid=new z({id:"requestsGrid",columns:this.getRequestGridColumns(),noDataMessage:this.i18n.noMembershipRequests,
showLoadingMessage:!1,showHeader:!1,showFooter:!1,selectionMode:"none",rowsPerPage:5,className:"requests-grid",store:new r({idProperty:"id",label:"fullname",data:[]}),sort:[{attribute:"received",descending:!1}]},this._requestsGridContainer);this._requestsGrid.startup();m(".dgrid-status").forEach(function(a){a.tabIndex=-1;b.add(a,"left")})},getRequestGridColumns:function(){return{fullname:{label:" ",sortable:!1,formatter:a.hitch(this,function(a){return a})},username:{label:" ",sortable:!1,formatter:a.hitch(this,
function(a){return a})},received:{label:" ",sortable:!1,formatter:a.hitch(this,function(a){a=new Date(parseFloat(a));return n.format(a,{selector:"date",formatLength:"long"})})},yourResponse:{label:" ",sortable:!1,renderCell:a.hitch(this,function(b){var d=b.username,c=g.create("div",{className:"esriFloatTrailing"}),e=g.create("button",{innerHTML:this.i18n.approve,className:"btn-link clickable margin-right-1 bg-icon-approve-application"},c),f=g.create("button",{innerHTML:this.i18n.decline,className:"btn-link clickable bg-icon-deny-application"},
c);this.own(v(e,a.hitch(this,"approveApplication",b,d)),v(f,a.hitch(this,"declineApplication",b,d)));return c})}}},hide:function(){this._dialog.hide()},refresh:function(){if(this._requestsGrid._grid&&this._requestsGrid._grid._started){var a=this._requestsGrid._grid._currentPage||1,b=this._requestsGrid._grid.store?this._requestsGrid._grid.store.query().length:0;f.once(this._requestsGrid._grid,"dgrid-refresh-complete",function(d){d.grid._currentPage!==a&&0<b&&d.grid.gotoPage(a)});this._requestsGrid._grid.resize();
this._requestsGrid._grid.refresh()}}});N.prototype.statics={getInstance:function(){this._instance||(this._instance=new N);return this._instance}};return N})},"arcgisonline/sharing/dijit/dialog/RendererDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/Dialog,arcgisonline/sharing/dijit/dialog/SymbolDlg"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.RendererDlg");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.Dialog");
c.require("arcgisonline.sharing.dijit.dialog.SymbolDlg");c.declare("arcgisonline.sharing.dijit.dialog.RendererDlg",[l._Widget,l._Templated],{util:arcgisonline.sharing.util,folder:arcgisonline.sharing.geow.Folder,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"renderer-dialog" title\x3d"${i18n.rendererDlgTitle}" execute\x3d""\x3e\r\n  \t\r\n    \x3cdiv\x3e\r\n      \x3ctable cellspacing\x3d"10" width\x3d"100%"\x3e\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\x3ctd\x3e\r\n        \x3clabel\x3e${i18n.labelLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\x3ctd\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"rendererLabel" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" required\x3d"true" style\x3d"width:100%; padding:2px;"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n      \x3ctr\x3e\x3ctd\x3e\r\n        \x3clabel\x3e${i18n.valueLabel}\x3c/label\x3e\r\n      \x3c/td\x3e\x3ctd\x3e\r\n        \x3clabel id\x3d"renderer-value"\x3e\x3c/label\x3e\r\n      \x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\x3c/table\x3e\r\n      \x3cdiv\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" type\x3d"button" dojoAttachPoint\x3d"_rendererSymbolUpdateButton" class\x3d"default esriFloatLeading" dojoAttachEvent\x3d"onClick:_onRendererSymbolUpdateButtonClick"\x3e\r\n          \x3cspan\x3e${i18n.changeSymbolBtn}\x3c/span\x3e\r\n        \x3c/button\x3e\r\n        \x3cbutton dojoAttachEvent\x3d"onClick:_onCancelClick" dojoAttachPoint\x3d"rendererCancelBtn" class\x3d"jevent cancel esriFloatTrailing" type\x3d"cancel" dojotype\x3d"dijit.form.Button"\x3e\r\n          ${i18n.cancel}\r\n        \x3c/button\x3e\r\n        \x3cbutton dojoAttachEvent\x3d"onClick:_onOkClick" dojoAttachPoint\x3d"rendererOkBtn" class\x3d"jevent primary esriFloatTrailing" dojotype\x3d"dijit.form.Button"\x3e\r\n          ${i18n.ok}\r\n        \x3c/button\x3e\r\n\t\t\t\x3c/div\x3e\r\n      \x3cdiv style\x3d"clear:both;"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\t\t\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
i18n:null,symbol:null,onRendererSymbolChangeHandler:null,onRendererSymbolChangeCancelHandler:null,applyRendererEditsHandler:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.RendererDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.clone(c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").rendererPanel);
c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").rendererDlg)},postCreate:function(){this.loadConnections()},show:function(a){this.symbol=esri.symbol.fromJson(a.symbol.toJson());null===a.value?c.byId("renderer-value").innerHTML=this.i18n.other:c.byId("renderer-value").innerHTML=a.value;this.rendererLabel.set("value",a.label);this.applyRendererEditsHandler=c.subscribe("applyRendererEdits",c.hitch(this,"_onApplyEdits"));l.byId("renderer-dialog").show()},loadConnections:function(){c.query(".jevent").connect("onclick",
function(a){a.preventDefault()})},_onCancelClick:function(){c.publish("onRendererItemChange",[null,null]);l.byId("renderer-dialog").hide()},hide:function(){this.onRendererSymbolChangeHandler&&(c.unsubscribe(this.onRendererSymbolChangeHandler),c.unsubscribe(this.onRendererSymbolChangeCancelHandler));this.applyRendererEditsHandler&&c.unsubscribe(this.applyRendererEditsHandler);this.rendererCancelBtn.set("disabled",!1);this._rendererSymbolUpdateButton.set("disabled",!1);l.byId("renderer-dialog").hide()},
_onRendererSymbolUpdateButtonClick:function(a){this.onRendererSymbolChangeHandler&&(c.unsubscribe(this.onRendererSymbolChangeHandler),c.unsubscribe(this.onRendererSymbolChangeCancelHandler));this.onRendererSymbolChangeHandler=c.subscribe("onSymbolChange",c.hitch(this,"_onRendererSymbolChange"));this.onRendererSymbolChangeCancelHandler=c.subscribe("onSymbolChangeCancel",c.hitch(this,function(){this.onRendererSymbolChangeHandler&&(c.unsubscribe(this.onRendererSymbolChangeHandler),c.unsubscribe(this.onRendererSymbolChangeCancelHandler));
this.rendererCancelBtn.set("disabled",!1);this._rendererSymbolUpdateButton.set("disabled",!1)}));this.rendererCancelBtn.set("disabled",!0);this._rendererSymbolUpdateButton.set("disabled",!0);arcgisonline.sharing.dijit.dialog.SymbolDlg.prototype.statics.getInstance().showSymbol(this.symbol,{applyHandler:c.hitch(this,"_onApplyEdits"),okHandler:c.hitch(this,function(a){this._rendererSymbolUpdateButton.set("disabled",!1);this.symbol=a;c.publish("onRendererItemChange",[a,this.rendererLabel.get("value")]);
c.publish("saveRenderer",[])})})},_onRendererSymbolChange:function(a){this.rendererCancelBtn.set("disabled",!1);this._rendererSymbolUpdateButton.set("disabled",!1);var c=a.toJson();"esriPMS"!=a.type||0!=c.url.length&&"http://"!=c.url||(a=esri.symbol.fromJson(this.markerJson));this.symbol=a},_onOkClick:function(a){a.preventDefault();c.publish("onRendererItemChange",[esri.symbol.fromJson(this.symbol.toJson()),this.rendererLabel.get("value")]);this.hide()},_onApplyEdits:function(a){c.publish("onRendererItemChange",
[a,this.rendererLabel.get("value")]);c.publish("saveRenderer",[])},onKeyDown:function(a){var c;window.event?c=a.keyCode:a.which&&(c=a.which);13==c&&this._onOkClick(a)}})})},"arcgisonline/sharing/dijit/dialog/SymbolDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/SymbolOptions"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.SymbolDlg");c.require("dijit.Dialog");c.require("dijit._Widget");c.require("dijit._Templated");
c.require("arcgisonline.sharing.dijit.SymbolOptions");c.declare("arcgisonline.sharing.dijit.dialog.SymbolDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"symbol-dialog" title\x3d"${i18n.symbolDlgTitle}" execute\x3d""\x3e\r\n\t  \x3cdiv id\x3d"symbol-dialog-symboloptions" dojotype\x3d"arcgisonline.sharing.dijit.SymbolOptions" dojoAttachPoint\x3d"symbolOptions"\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cbutton dojoAttachPoint\x3d"cancelButton" dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3cbutton id\x3d"symbol-dialog-apply" dojoAttachPoint\x3d"applyButton" dojoAttachEvent\x3d"onClick:onApplyClick" class\x3d"jevent cancel esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.apply}\x3c/button\x3e\r\n  \t  \x3cbutton id\x3d"symbol-dialog-done" dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary esriFloatTrailing" dojoType\x3d"dijit.form.Button"\x3e${i18n.done}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
i18n:null,applyHandler:null,okHandler:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SymbolDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.clone(c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").symbolDlg)},show:function(a,c){this.cancelButton.set("disabled",!1);var e=a.getLayer();if(a.symbol)this.symbolOptions.symbol=
esri.symbol.fromJson(a.symbol.toJson());else{var d=e.renderer.getSymbol(a);this.symbolOptions.symbol=esri.symbol.fromJson(d.toJson())}for(d=0;d<e.types.length;d++)if(e.types[d].id==a.attributes.TYPEID&&e.types[d].templates&&0<e.types[d].templates.length){this.symbolOptions.template=e.types[d].templates[0];break}c?(this.symbolOptions.endSize=c.endSize,this.symbolOptions.showEndSize=0<c.endSize?!0:!1,this.symbolOptions.showNoBgColor=c.showNoBgColor,this.applyHandler=c.applyHandler,this.okHandler=c.okHandler):
(this.symbolOptions.endSize=0,this.symbolOptions.showEndSize=!1,this.symbolOptions.showNoBgColor=!1,this.okHandler=this.applyHandler=null);this.symbolOptions.init(c?c.noPreDefSymbols:null);l.byId("symbol-dialog").show()},showSymbol:function(a,e){this.cancelButton.set("disabled",!1);this.symbolOptions.symbol=esri.symbol.fromJson(a.toJson());this.symbolOptions.symbol.color||(this.symbolOptions.symbol.color=new c.Color([255,255,255,0]));e?(this.symbolOptions.endSize=e.endSize,this.symbolOptions.showEndSize=
0<e.endSize?!0:!1,this.symbolOptions.showNoBgColor=e.showNoBgColor,this.applyHandler=e.applyHandler,this.okHandler=e.okHandler):(this.symbolOptions.endSize=0,this.symbolOptions.showEndSize=!1,this.symbolOptions.showNoBgColor=!1,this.okHandler=this.applyHandler=null);this.symbolOptions.init(e?e.noPreDefSymbols:null);l.byId("symbol-dialog").show()},hide:function(){this.symbolOptions.hide();l.byId("symbol-dialog").hide()},onDoneClick:function(a){"picturemarkersymbol"===this.symbolOptions.symbol.type&&
8>this.symbolOptions.symbol.url.length||setTimeout(c.hitch(this,function(){var a=0;this.symbolOptions.urlChangesNotApplied&&(a=6E3);setTimeout(c.hitch(this,function(){if(this.okHandler){var a=this.symbolOptions.symbol.toJson();"esriPMS"!=this.symbolOptions.symbol.type||0!=a.url.length&&"http://"!=a.url||(this.symbolOptions.symbol=this.getMarkerJson());this.okHandler(esri.symbol.fromJson(this.symbolOptions.symbol.toJson()))}else this.symbolOptions.showEndSize?c.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson()),
this.symbolOptions.endSize]):c.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson())]),setTimeout(c.hitch(this,function(){c.publish("applyRendererEdits",[])}),500);this.hide()}),a)}),100)},onApplyClick:function(a){"picturemarkersymbol"===this.symbolOptions.symbol.type&&8>this.symbolOptions.symbol.url.length||setTimeout(c.hitch(this,function(){var a=0;this.symbolOptions.urlChangesNotApplied&&(a=6E3);setTimeout(c.hitch(this,function(){if(this.applyHandler){var a=this.symbolOptions.symbol.toJson();
"esriPMS"!=this.symbolOptions.symbol.type&&"picturemarkersymbol"!=this.symbolOptions.symbol.type||0!=a.url.length&&"http://"!=a.url||(this.symbolOptions.symbol=this.getMarkerJson());this.applyHandler(esri.symbol.fromJson(this.symbolOptions.symbol.toJson()));this.cancelButton.set("disabled",!0)}else this.symbolOptions.showEndSize?c.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson()),this.symbolOptions.endSize]):c.publish("onSymbolChange",[esri.symbol.fromJson(this.symbolOptions.symbol.toJson())]),
setTimeout(c.hitch(this,function(){c.publish("applyRendererEdits",[]);this.cancelButton.set("disabled",!0)}),500)}),a)}),100)},onCancelClick:function(a){c.publish("onSymbolChangeCancel",[]);this.hide()}})})},"arcgisonline/sharing/dijit/SymbolOptions":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/ColorPalette,dijit/form/HorizontalSlider,arcgisonline/sharing/dijit/dialog/ImgDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/util"],function(c,
l,h){c.provide("arcgisonline.sharing.dijit.SymbolOptions");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.ColorPalette");c.require("dijit.form.HorizontalSlider");c.require("arcgisonline.sharing.dijit.dialog.ImgDlg");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.SymbolOptions",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv\x3e\r\n  \x3ctable class\x3d"symbolDialogTable"\x3e\r\n   \x3ctbody\x3e\r\n    \x3ctr\x3e \r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv\x3e\x3clabel\x3e${i18n.previewLabel}\x3c/label\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd colspan\x3d"2" valign\x3d"middle" align\x3d"left"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolImage" style\x3d"height:100%; vertical-align:middle;"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e   \r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e \r\n      \x3ctd colspan\x3d"3" valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolSmallTemplatePicker" style\x3d"display:none;"\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolSimpleMarkerTemplatePickerDiv" class\x3d"symbolTemplatePicker" style\x3d"height:50px; width:350px;"\x3e\r\n            \x3cdiv id\x3d"${id}_symbolSimpleMarkerTemplatePicker"\x3e\x3c/div\x3e  \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolFullTemplatePicker" style\x3d"display:none;"\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolClassesDiv" style\x3d"width:355px;line-height:normal;"\x3e\r\n            \x3cselect dojoAttachPoint\x3d"symbolColorClasses" style\x3d"width:355px;margin:0;" dojoType\x3d"arcgisonline.sharing.dijit.ComboBox"\x3e\r\n            \x3c/select\x3e       \r\n          \x3c/div\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolClassesTemplatePickerDiv" class\x3d"symbolTemplatePicker" style\x3d"height:130px; width:350px;"\x3e\r\n            \x3cdiv id\x3d"${id}_symbolClassesTemplatePicker" \x3e\x3c/div\x3e  \r\n          \x3c/div\x3e\r\n          \x3cdiv dojoAttachPoint\x3d"symbolAddImageDiv" class\x3d"esriItemLinks" style\x3d"line-height:20px;"\x3e\r\n            \x3cA dojoAttachPoint\x3d"symbolAddImage" href\x3d"JavaScript:void(0);"\x3e${i18n.addImage}\x3c/A\x3e  \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e   \r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolSizeRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel dojoAttachPoint\x3d"symbolSizeLabel"\x3e${i18n.symbolSizeLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolSize" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"120" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolSizeInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolEndSizeRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel\x3e${i18n.symbolEndSizeLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolEndSize" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"120" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolEndSizeInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolBackgroundColorRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.colorLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\x3cdiv dojoAttachPoint\x3d"symbolBackgroundColor" class\x3d"symbolColorBox"\x3e\x3c/div\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolLinePatternRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.patternLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\r\n        \x3cdiv\x3e\r\n          \x3cselect dojoAttachPoint\x3d"symbolLinePatternSelect" id\x3d"symbolLinePatternSelect" dojoType\x3d"dijit.form.Select" class\x3d"symbolLinePatternSelect"\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolTransparencyRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.transparencyLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd width\x3d"125" valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolTransparency" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" style\x3d"line-height:normal;margin-top:7px;" showbuttons\x3d"false" intermediatechanges\x3d"true" minimum\x3d"0" maximum\x3d"1" value\x3d"0" discretevalues\x3d"0.01" \x3e\r\n          \x3cdiv dojoType\x3d"dijit.form.HorizontalRule" container\x3d"bottomDecoration" count\x3d"2" style\x3d"height:5px;"\x3e\x3c/div\x3e\r\n          \x3col dojoType\x3d"dijit.form.HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"font-size:0.8em;"\x3e\r\n            \x3cli\x3e0\x3c/li\x3e\x3cli\x3e100%\x3c/li\x3e\r\n          \x3c/ol\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolTransparencyInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e%\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolOutlineColorRow"\x3e\r\n      \x3ctd\x3e\x3clabel\x3e${i18n.outlineColorLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd colspan\x3d"2"\x3e\x3cdiv dojoAttachPoint\x3d"symbolOutlineColor" class\x3d"symbolColorBox"\x3e\x3c/div\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolWidthRow"\x3e \r\n      \x3ctd\x3e\x3clabel dojoAttachPoint\x3d"symbolWidthLabel" \x3e${i18n.outlineWidthLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolWidth" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"true" minimum\x3d"0" maximum\x3d"18" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolWidthInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr dojoAttachPoint\x3d"symbolEndWidthRow"\x3e \r\n      \x3ctd nowrap\x3e\x3clabel\x3e${i18n.symbolEndWidthLabel}\x3c/label\x3e\x3c/td\x3e\r\n      \x3ctd\x3e\x3cdiv dojoAttachPoint\x3d"symbolEndWidth" dojoType\x3d"dijit.form.HorizontalSlider" class\x3d"symbolSlider" showbuttons\x3d"false" intermediatechanges\x3d"false" minimum\x3d"1" maximum\x3d"18" value\x3d"1" discretevalues\x3d"1" \x3e\x3c/div\x3e\x3c/td\x3e\r\n      \x3ctd valign\x3d"top"\x3e\r\n        \x3cdiv dojoAttachPoint\x3d"symbolEndWidthInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" style\x3d"width:30px;margin-bottom:3px;"\x3e\x3c/div\x3e\r\n        \x3cdiv style\x3d"display:inline;"\x3e${i18n.shortForPixel}\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n   \x3c/tbody\x3e\r\n  \x3c/table\x3e                \r\n\r\n  \x3cimg id\x3d"${id}_testImage" style\x3d"position:absolute;top:0;left:-3000px"/\x3e\r\n\r\n  \x3cdiv dojoAttachPoint\x3d"symbolColorTooltip" dojotype\x3d"dijit.TooltipDialog" title\x3d"" style\x3d"display:none; width:265px;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing"\x3e\x3cA class\x3d"symbolColorPaletteClose" dojoAttachPoint\x3d"symbolColorTooltipClose" href\x3d"JavaScript:void(0);" title\x3d"${i18n.close}"\x3e\x3c/A\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"symbolColorPalette" style\x3d"margin-top: 7px;" dojotype\x3d"dijit.ColorPalette" palette\x3d"7x10" dojoAttachEvent\x3d"onChange:onColorSelection"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e\r\n',
i18n:null,symbol:null,template:null,colorPicker:"",savedSimpleMarkerSymbol:null,savedPictureMarkerSymbol:null,eventHandlers:null,testImageHandler:null,symbolListItems:null,symbolClassesTemplatePicker:null,simpleMarkerTemplatePicker:null,templatePickerOnSelectionChangeHandler:null,simpleMarkerTemplatePickerOnSelectionChangeHandler:null,templatePickerSymbolClass:null,symbolClassStore:null,urlChangesNotApplied:!1,cachedImages:[],onImageChangeHandler:null,showEndSize:!1,showNoBgColor:!1,endSize:0,simpleMarkerSymbols:[{name:"Circle",
type:"esriSMS",style:"esriSMSCircle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Square",type:"esriSMS",style:"esriSMSSquare",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Diamond",type:"esriSMS",style:"esriSMSDiamond",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Cross",type:"esriSMS",style:"esriSMSCross",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"X",type:"esriSMS",style:"esriSMSX",
color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}}],markerJson:{type:"esriPMS",url:"/Symbols/Basic/RedSphere.png",imageData:"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xTuc4+QAAB3VJREFUeF7tmPlTlEcexnve94U5mANQbgQSbgiHXHINlxpRIBpRI6wHorLERUmIisKCQWM8cqigESVQS1Kx1piNi4mW2YpbcZONrilE140RCTcy3DDAcL/zbJP8CYPDL+9Ufau7uqb7eZ7P+/a8PS8hwkcgIBAQCAgEBAICAYGAQEAgIBAQCAgEBAICAYGAQEAgIBAQCDx/AoowKXFMUhD3lQrioZaQRVRS+fxl51eBTZUTdZ41U1Rox13/0JF9csGJ05Qv4jSz/YPWohtvLmSKN5iTGGqTm1+rc6weICOBRbZs1UVnrv87T1PUeovxyNsUP9P6n5cpHtCxu24cbrmwKLdj+osWiqrVKhI0xzbmZ7m1SpJ+1pFpvE2DPvGTomOxAoNLLKGLscZYvB10cbYYjrJCb7A5mrxleOBqim+cWJRakZY0JfnD/LieI9V1MrKtwokbrAtU4Vm0A3TJnphJD4B+RxD0u0LA7w7FTE4oprOCMbklEGNrfdGf4IqnQTb4wc0MFTYibZqM7JgjO8ZdJkpMln/sKu16pHZGb7IfptIWg389DPp9kcChWODoMuDdBOhL1JgpisbUvghM7AqFbtNiaFP80RLnhbuBdqi0N+1dbUpWGde9gWpuhFi95yL7sS7BA93JAb+Fn8mh4QujgPeTgb9kAZf3Apd2A+fXQ38yHjOHozB1IAJjOSEY2RSIwVUv4dd4X9wJccGHNrJ7CYQ4GGjLeNNfM+dyvgpzQstKf3pbB2A6m97uBRE0/Ergcxr8hyqg7hrwn0vAtRIKIRX6Y2pMl0RhIj8co9nBGFrvh55l3ngU7YObng7IVnFvGS+BYUpmHziY/Ls2zgP9SX50by/G9N5w6I+ogYvpwK1SoOlHQNsGfWcd9Peqof88B/rTyzF9hAIopAByQzC0JQB9ST5oVnvhnt+LOGsprvUhxNIwa0aY7cGR6Cp7tr8+whkjawIxkRWC6YJI6N+lAKq3Qf/Tx+B77oGfaQc/8hB8w2Xwtw9Bf3kzZspXY/JIDEbfpAB2BKLvVV90Jvjgoac9vpRxE8kciTVCBMMkNirJ7k/tRHyjtxwjKV4Yp3t/6s+R4E+/DH3N6+BrS8E314Dvvg2+/Sb4hxfBf5sP/up2TF3ZhonK1zD6dhwGdwail26DzqgX8MRKiq9ZBpkSkmeYOyPM3m9Jjl+1Z9D8AgNtlAq6bZ70qsZi+q+bwV/7I/hbB8D/dAr8Axq89iz474p/G5++koHJy1sx/lkGdBc2YjA3HF0rHNHuboomuQj/5DgclIvOGCGCYRKFFuTMV7YUAD3VDQaLMfyqBcZORGPy01QKYSNm/rYV/Nd/Av9NHvgbueBrsjDzRQamKKDxT9Kgq1iLkbIUDOSHoiNcgnYHgnYZi+9ZExSbiSoMc2eE2flKcuJLa4KGRQz6/U0wlGaP0feiMH4uFpMXEjBVlYjp6lWY+SSZtim0kulYMiYuJEJXuhTDJ9UYPByOvoIwdCxfgE4bAo0Jh39xLAoVpMwIEQyTyFCQvGpLon9sJ0K3J4OBDDcMH1dj9FQsxkrjMPFRPCbOx2GyfLal9VEcxstioTulxjAFNfROJPqLl6Bnfyg6V7ugz5yBhuHwrZjBdiU5YJg7I8wOpifAKoVIW7uQ3rpOBH2b3ekVjYT2WCRG3o+mIGKgO0OrlIaebU/HYOQDNbQnojB4NJyGD0NPfjA0bwTRE6Q7hsUcWhkWN8yZqSQlWWGECAZLmJfJmbrvVSI8taK37xpbdB/wQW8xPee/8xIGjvlj8IQ/hk4G0JbWcX8MHPVDX4kveoq8ocn3xLM33NCZRcPHOGJYZIKfpQyq7JjHS6yJjcHujLHADgkpuC7h8F8zEVqXSNC2awE69lqhs8AamkO26HrbDt2H7dBVQov2NcW26CiwQtu+BWjdY4n2nZboTbfCmKcCnRyDO/YmyLPnDlHvjDH8G6zhS9/wlEnYR7X00fWrFYuWdVI0ZpuhcbcczW/R2qdAcz6t/bRov4mONeaaoYl+p22rHF0bVNAmKtBvweIXGxNcfFH8eNlC4m6wMWMusEnKpn5hyo48pj9gLe4SNG9QoGGLAk8z5XiaJUd99u8122/IpBA2K9BGg2vWWKAvRYVeLzEa7E1R422m2+MsSTem97nSYnfKyN6/mzATv7AUgqcMrUnmaFlLX3ysM0fj+t/b5lQLtK22QEfyAmiSLKFZpUJ7kBRPXKW4HqCYynWVHKSG2LkyZex1uO1mZM9lKem9Tx9jjY5iNEYo0bKMhn7ZAu0r6H5PpLXCAq0rKJClSjSGynE/QIkrQYqBPe6S2X+AJsY2Ped6iWZk6RlL0c2r5szofRsO9R5S1IfQLRCpQL1aifoYFerpsbkuTImaUJXuXIDiH6/Ys8vm3Mg8L2i20YqsO7fItKLcSXyn0kXccclVqv3MS6at9JU/Ox+ouns+SF6Z4cSupz7l8+z1ucs7LF1AQjOdxfGZzmx8Iu1TRcfnrioICAQEAgIBgYBAQCAgEBAICAQEAgIBgYBAQCAgEBAICAQEAv8H44b/6ZiGvGAAAAAASUVORK5CYII\x3d",
contentType:"image/png",width:15,height:15},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.clone(c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").generalDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").imgDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").symbolDlg)},postCreate:function(){this.symbolLinePatternSelect._getMenuItemForOption=
function(a){if(a.value||a.label){var e=c.hitch(this,"_setValueAttr",a);a=new l.MenuItem({option:a,label:a.label||this.emptyLabel,onClick:e,ownerDocument:this.ownerDocument,dir:this.dir,disabled:a.disabled||!1,iconClass:a.iconClass});a.focusNode.setAttribute("role","option");return a}return new l.MenuSeparator({ownerDocument:this.ownerDocument})};this.symbolLinePatternSelect.addOption({value:"solid",iconClass:"symbolLinePatternSolid"});this.symbolLinePatternSelect.addOption({value:"dot",iconClass:"symbolLinePatternDot"});
this.symbolLinePatternSelect.addOption({value:"dash",iconClass:"symbolLinePatternDash"});this.symbolLinePatternSelect.addOption({value:"dashdot",iconClass:"symbolLinePatternDashDot"});this.symbolLinePatternSelect.addOption({value:"dashdotdot",iconClass:"symbolLinePatternDashDotDot"});this._symbolCloseIcon&&c.attr(this._symbolCloseIcon,"src",arcgisonline.sharing.util.relativeToExplicitUrl("images/close.gif"));c.connect(this.symbolLinePatternSelect,"onChange",c.hitch(this,"onPatternChange"));this.loadConnections()},
init:function(a){this.savedPictureMarkerSymbol=this.savedSimpleMarkerSymbol=null;if(this.symbol){if(!a||"picturemarkersymbol"!==this.symbol.type&&"simplemarkersymbol"!==this.symbol.type)if(a)c.style(this.symbolFullTemplatePicker,"display","none"),c.style(this.symbolSmallTemplatePicker,"display","none");else if(c.style(this.symbolSmallTemplatePicker,"display","none"),c.style(this.symbolFullTemplatePicker,"display","block"),this.symbolListItems)if(this.templatePickerSymbolClass!==this.symbol.type&&
("simplemarkersymbol"!==this.templatePickerSymbolClass&&"picturemarkersymbol"!==this.templatePickerSymbolClass||"picturemarkersymbol"!==this.symbol.type&&"simplemarkersymbol"!==this.symbol.type)){if("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)for(a=0;a<this.symbolListItems.length;a++){var e=this.symbolListItems[a];if(-1<e.typeKeywordsString.indexOf("marker")&&-1<e.typeKeywordsString.indexOf("default")){this.symbolColorClasses.set("value",e.title);break}}this.getSymbolListData(!0)}else this.getSymbolListData();
else this.getSymbolListGroup();else c.style(this.symbolFullTemplatePicker,"display","none"),c.style(this.symbolSmallTemplatePicker,"display","block"),setTimeout(c.hitch(this,function(){this.createSimpleMarkerTemplatePicker()}),0);this.updateUI();this.enableEvents();this.symbolClassesTemplatePicker&&this.symbolClassesTemplatePicker.clearSelection();this.simpleMarkerTemplatePicker&&this.simpleMarkerTemplatePicker.clearSelection()}},hide:function(){this.disableEvents();l.popup.close(this.symbolColorTooltip);
this.destroySymbolClassesTemplatePicker();this.destroySimpleMarkerTemplatePicker()},loadConnections:function(){c.query(".jevent").connect("onclick",function(a){a.preventDefault()});c.connect(this.symbolColorTooltipClose,"onclick",c.hitch(this,function(a){a.preventDefault();l.popup.close(this.symbolColorTooltip)}));c.connect(this.symbolBackgroundColor,"onclick",this,"onBackgroundColorClick");c.connect(this.symbolOutlineColor,"onclick",this,"onOutlineColorClick");c.connect(this.symbolAddImage,"onclick",
this,"onAddImage")},updateUI:function(){this.symbolImage.innerHTML="";if("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)c.style(this.symbolClassesDiv,"display","block"),c.style(this.symbolClassesTemplatePickerDiv,"display","block"),c.style(this.symbolSizeRow,"display",""),this.symbolSizeLabel.innerHTML=this.i18n.symbolSizeLabel,c.style(this.symbolEndSizeRow,"display","none"),c.style(this.symbolEndWidthRow,"display","none"),c.style(this.symbolAddImageDiv,"display",
""),"simplemarkersymbol"===this.symbol.type?(c.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),c.style(this.symbolLinePatternRow,"display","none"),c.style(this.symbolOutlineColorRow,"display",""),c.style(this.symbolWidthRow,"display",""),this.symbolWidthLabel.innerHTML=this.i18n.outlineWidthLabel,c.style(this.symbolTransparencyRow,"display",""),this.symbolSize.set("value",this.symbol.size,!1),this.symbolSizeInput.set("value",Math.round(this.symbol.size),!1),this.showEndSize&&
(this.symbolSizeLabel.innerHTML=this.i18n.symbolStartSizeLabel,this.symbolEndSize.set("value",this.endSize,!1),this.symbolEndSizeInput.set("value",Math.round(this.endSize),!1),c.style(this.symbolEndSizeRow,"display","")),c.style(this.symbolBackgroundColor,"background",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),c.style(this.symbolOutlineColor,"background",
this.symbol.outline.color.toHex()),this.symbolWidth.set("value",this.symbol.outline.width,!1),this.symbolWidthInput.set("value",Math.round(this.symbol.outline.width),!1)):"picturemarkersymbol"===this.symbol.type&&(c.style(this.symbolBackgroundColorRow,"display","none"),c.style(this.symbolLinePatternRow,"display","none"),c.style(this.symbolOutlineColorRow,"display","none"),c.style(this.symbolWidthRow,"display","none"),c.style(this.symbolTransparencyRow,"display","none"),this.symbolSize.set("value",
this.symbol.width,!1),this.symbolSizeInput.set("value",Math.round(this.symbol.width),!1),this.showEndSize&&(this.symbolSizeLabel.innerHTML=this.i18n.symbolStartSizeLabel,this.symbolEndSize.set("value",this.endSize,!1),this.symbolEndSizeInput.set("value",Math.round(this.endSize),!1),c.style(this.symbolEndSizeRow,"display","")));else if("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type)c.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),c.style(this.symbolAddImageDiv,
"display","none"),c.style(this.symbolClassesDiv,"display","none"),c.style(this.symbolClassesTemplatePickerDiv,"display","block"),c.style(this.symbolSizeRow,"display","none"),c.style(this.symbolTransparencyRow,"display",""),c.style(this.symbolEndSizeRow,"display","none"),this.setLinePattern(),c.style(this.symbolLinePatternRow,"display",""),this.symbolTransparency.set("disabled",!1),this.symbolTransparencyInput.set("disabled",!1),c.style(this.symbolOutlineColorRow,"display","none"),c.style(this.symbolWidthRow,
"display",""),this.symbolWidthLabel.innerHTML=this.i18n.symbolWidthLabel,c.style(this.symbolEndWidthRow,"display","none"),c.style(this.symbolBackgroundColor,"background",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),this.symbolWidth.set("value",this.symbol.width,!1),this.symbolWidthInput.set("value",Math.round(this.symbol.width),!1),this.showEndSize&&
(this.symbolWidthLabel.innerHTML=this.i18n.symbolStartWidthLabel,this.symbolEndWidth.set("value",this.endSize,!1),this.symbolEndWidthInput.set("value",Math.round(this.endSize),!1),c.style(this.symbolEndWidthRow,"display","")),this.onPatternChange();else if("simplefillsymbol"===this.symbol.type||"picturefillsymbol"===this.symbol.type)c.style(this.symbolBackgroundColorRow,"display",this.showNoBgColor?"none":""),c.style(this.symbolAddImageDiv,"display","none"),c.style(this.symbolClassesDiv,"display",
"none"),c.style(this.symbolClassesTemplatePickerDiv,"display","block"),c.style(this.symbolSizeRow,"display","none"),c.style(this.symbolTransparencyRow,"display",""),c.style(this.symbolEndSizeRow,"display","none"),c.style(this.symbolEndWidthRow,"display","none"),c.style(this.symbolLinePatternRow,"display","none"),c.style(this.symbolOutlineColorRow,"display",""),c.style(this.symbolWidthRow,"display",""),c.style(this.symbolEndWidthRow,"display","none"),this.symbolWidthLabel.innerHTML=this.i18n.outlineWidthLabel,
this.symbolTransparency.set("disabled",!1),this.symbolTransparencyInput.set("disabled",!1),c.style(this.symbolBackgroundColor,"backgroundColor",this.symbol.color.toHex()),this.symbolTransparency.set("value",1-this.symbol.color.toRgba()[3],!1),this.symbolTransparencyInput.set("value",Math.round(100*(1-this.symbol.color.toRgba()[3])),!1),c.style(this.symbolOutlineColor,"backgroundColor",this.symbol.outline.color.toHex()),this.symbolWidth.set("value",this.symbol.outline.width,!1),this.symbolWidthInput.set("value",
Math.round(this.symbol.outline.width),!1);this._drawSymbol()},enableEvents:function(){this.eventHandlers=[];this.eventHandlers.push(c.connect(this.symbolSize,"onChange",this,"onSizeChange"));this.eventHandlers.push(c.connect(this.symbolSize._movable,"onMoveStop",this,"onSizeChange"));this.eventHandlers.push(c.connect(this.symbolSizeInput,"onChange",this,"onSizeChangeByInput"));this.eventHandlers.push(c.connect(this.symbolEndSize,"onChange",this,"onEndSizeChange"));this.eventHandlers.push(c.connect(this.symbolEndSize._movable,
"onMoveStop",this,"onEndSizeChange"));this.eventHandlers.push(c.connect(this.symbolEndSizeInput,"onChange",this,"onEndSizeChangeByInput"));this.eventHandlers.push(c.connect(this.symbolTransparency,"onChange",this,"onTransparencyChange"));this.eventHandlers.push(c.connect(this.symbolTransparency._movable,"onMoveStop",this,"onTransparencyChange"));this.eventHandlers.push(c.connect(this.symbolTransparencyInput,"onChange",this,"onTransparencyChangeByInput"));this.eventHandlers.push(c.connect(this.symbolWidth,
"onChange",this,"onWidthChange"));this.eventHandlers.push(c.connect(this.symbolWidth._movable,"onMoveStop",this,"onWidthChange"));this.eventHandlers.push(c.connect(this.symbolWidthInput,"onChange",this,"onWidthChangeByInput"));this.eventHandlers.push(c.connect(this.symbolEndWidth,"onChange",this,"onEndWidthChange"));this.eventHandlers.push(c.connect(this.symbolEndWidth._movable,"onMoveStop",this,"onEndWidthChange"));this.eventHandlers.push(c.connect(this.symbolEndWidthInput,"onChange",this,"onEndWidthChangeByInput"));
this.eventHandlers.push(c.connect(this.symbolLinePatternSelect,"onChange",c.hitch(this,"onSymbolLinePatternChange")));this.eventHandlers.push(c.connect(this.symbolColorClasses,"onChange",this,"onSymbolListChange"))},disableEvents:function(){this.eventHandlers&&(c.forEach(this.eventHandlers,function(a){c.disconnect(a)}),this.eventHandlers=null)},onPatternChange:function(){c.removeClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternSolid symbolLinePatternDot symbolLinePatternDash symbolLinePatternDashDot symbolLinePatternDashDotDot");
"solid"==this.symbolLinePatternSelect.get("value")?c.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternSolid"):"dot"==this.symbolLinePatternSelect.get("value")?c.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDot"):"dash"==this.symbolLinePatternSelect.get("value")?c.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDash"):"dashdot"==this.symbolLinePatternSelect.get("value")?c.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDashDot"):
"dashdotdot"==this.symbolLinePatternSelect.get("value")&&c.addClass(this.symbolLinePatternSelect.containerNode,"symbolLinePatternDashDotDot")},onBackgroundColorClick:function(a){this.colorPicker="background";l.popup.open({popup:this.symbolColorTooltip,around:a.target})},onOutlineColorClick:function(a){this.colorPicker="outline";l.popup.open({popup:this.symbolColorTooltip,around:a.target})},onColorSelection:function(a){l.popup.close(this.symbolColorTooltip);a=(new c.Color(a)).toRgba();"background"===
this.colorPicker||"simplelinesymbol"===this.symbol.type?(a[3]=this.symbol.color.toRgba()[3],this.symbol.color.setColor(a)):this.symbol.outline.color.setColor(a);this.updateUI()},onTransparencyChange:function(a){a=this.symbol.color.toRgba();var e=this.symbolTransparency.getValue(),e=c.number.round(e,2);a[3]=1-e;this.symbol.color.setColor(a);this.updateUI()},onTransparencyChangeByInput:function(a){isNaN(a)?this.symbolTransparencyInput.set("value",Math.round(100*this.symbolTransparency.getValue()),!1):
(a=Math.round(a),0>a||100<a?this.symbolTransparencyInput.set("value",Math.round(100*this.symbolTransparency.getValue()),!1):this.symbolTransparency.set("value",a/100,!1))},onWidthChange:function(a){if(!isNaN(a)){var c=this.symbolWidth.getValue(),c=Math.round(c);"simplefillsymbol"===this.symbol.type||"simplemarkersymbol"===this.symbol.type?this.symbol.outline.width!=a&&(this.symbol.outline.setWidth(c),this.symbol.outline.setStyle(esri.symbol.SimpleLineSymbol.STYLE_SOLID),a=this.symbol.outline.color.toRgba(),
a[3]=1,this.symbol.outline.color.setColor(a),this.updateUI()):this.symbol.width!=a&&(this.symbol.setWidth(c),this.updateUI())}},onWidthChangeByInput:function(a){isNaN(a)?this.symbolWidthInput.set("value",this.symbolWidth.getValue(),!1):(a=Math.round(a),0>a||18<a?this.symbolWidthInput.set("value",this.symbolWidth.getValue(),!1):this.symbolWidth.set("value",a,!0))},onEndWidthChange:function(a){isNaN(a)||(a=this.symbolEndWidth.getValue(),a=Math.round(a),a<this.symbolWidthInput.getValue()?this.symbolEndWidth.set("value",
this.symbolEndWidthInput.getValue(),!1):(this.symbolEndWidthInput.set("value",a,!1),this.endSize=a))},onEndWidthChangeByInput:function(a){isNaN(a)?this.symbolEndWidthInput.set("value",Math.round(this.symbolEndWidth.getValue()),!1):(a=Math.round(a),1>a||120<a||a<this.symbolWidth.getValue()?this.symbolEndWidthInput.set("value",Math.round(this.symbolEndWidth.getValue()),!1):(this.symbolEndWidth.set("value",a,!1),this.endSize=a))},onSizeChange:function(a){if(!isNaN(a)){a=this.symbol.width;var c=this.symbolSize.getValue(),
c=Math.round(c);if(a!=c)if(this.showEndSize&&c>this.symbolEndSizeInput.getValue())this.symbolSize.set("value",this.symbolSizeInput.getValue(),!1);else{if("picturemarkersymbol"===this.symbol.type){this.symbol.setHeight(this.symbol.height/this.symbol.width*c);this.symbol.setWidth(c);if(!this.symbol.url||"http://"===this.symbol.url||-1==this.symbol.url.indexOf("http://")&&-1==this.symbol.url.indexOf("data:"))return;if(this.symbol.xoffset||this.symbol.yoffset)c=this.symbol.width,a=c/a,this.symbol.setOffset(Math.round(this.symbol.xoffset*
a),Math.round(this.symbol.yoffset*a))}else this.symbol.setSize(c);this.updateUI()}}},onSizeChangeByInput:function(a){isNaN(a)?this.symbolSizeInput.set("value",Math.round(this.symbolSize.getValue()),!1):(a=Math.round(a),1>a||120<a||this.showEndSize&&a>this.symbolEndSize.getValue()?this.symbolSizeInput.set("value",Math.round(this.symbolSize.getValue()),!1):this.symbolSize.set("value",a,!0))},onEndSizeChange:function(a){isNaN(a)||(a=this.symbolEndSize.getValue(),a=Math.round(a),a<this.symbolSizeInput.getValue()?
this.symbolEndSize.set("value",this.symbolEndSizeInput.getValue(),!1):(this.symbolEndSizeInput.set("value",a,!1),this.endSize=a))},onEndSizeChangeByInput:function(a){isNaN(a)?this.symbolEndSizeInput.set("value",Math.round(this.symbolEndSize.getValue()),!1):(a=Math.round(a),1>a||120<a||a<this.symbolSize.getValue()?this.symbolEndSizeInput.set("value",Math.round(this.symbolEndSize.getValue()),!1):(this.symbolEndSize.set("value",a,!1),this.endSize=a))},onUrlChange:function(a){if(a&&!(10>a.length)&&0===
a.indexOf("http")){this.urlChangesNotApplied=!0;for(var e=function(d){clearTimeout(b);b=null;var e=c.style(c.byId(this.id+"_testImage"),"width"),f=c.style(c.byId(this.id+"_testImage"),"height");d.w&&d.h&&(e=d.w,f=d.h);1==e&&1==f?(this.urlChangesNotApplied=!1,this.updateUI(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorDlgTitle,message:this.i18n.error.invalidUrl})):(0===e&&(e=40),0===f&&(f=e),d.w&&d.h||this.cachedImages.push({url:a,w:e,h:f}),
this.symbol=new esri.symbol.PictureMarkerSymbol,this.symbol.setWidth(Math.min(120,e)),this.symbolSize.set("value",this.symbol.width,!1),this.symbol.setHeight(f/e*this.symbol.width),this.symbol.setUrl(a),this.updateUI(),this.urlChangesNotApplied=!1)},f=0;f<this.cachedImages.length;f++){var d=this.cachedImages[f];if(d.url==a){c.hitch(this,e)(d);return}}this.testImageHandler&&c.disconnect(this.testImageHandler);this.testImageHandler=c.connect(c.byId(this.id+"_testImage"),"onload",this,e,{});var b=setTimeout(c.hitch(this,
function(){clearTimeout(b);b=null;this.urlChangesNotApplied=!1;arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorDlgTitle,message:this.i18n.error.invalidUrl})}),5E3);c.byId(this.id+"_testImage").src=a}},onAddImage:function(a){this.onImageChangeHandler&&c.unsubscribe(this.onImageChangeHandler);this.onImageChangeHandler=c.subscribe("onUrlChange",c.hitch(this,"onUrlChange"));arcgisonline.sharing.dijit.dialog.ImgDlg.prototype.statics.getInstance().show()},
onSymbolLinePatternChange:function(){if("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type){switch(this.symbolLinePatternSelect.getValue()){case "dot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DOT);break;case "dash":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASH);break;case "dashdot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASHDOT);break;case "dashdotdot":this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT);
break;default:this.symbol.setStyle(esri.symbol.SimpleLineSymbol.STYLE_SOLID)}this.updateUI()}},getSymbolListGroup:function(){arcgisonline.sharing.geow.Community.searchGroups(esriGeowConfig.symbolSetsGroupQuery,c.hitch(this,function(a,c){a&&a.results&&0<a.results.length&&this.getSymbolListItems(a.results[0].id)}),c.hitch(this,function(a,c){}))},getSymbolListItems:function(a){a=esriGeowConfig.restBaseUrl+"search?num\x3d20\x26q\x3dgroup:"+a+' AND type:"Symbol Set"';a="vml"===h.gfx.renderer?a+' AND -typekeywords:"by value"':
a+' AND ((typekeywords:"by value" AND typekeywords:"marker") OR typekeywords:"fill" OR typekeywords:"line")';arcgisonline.sharing.util.getJson(a,c.hitch(this,function(a,f){a.results&&0<a.results.length&&(this.symbolListItems=a.results,this.symbolListItems.sort(function(a,b){return a.title==b.title?0:a.title<b.title?-1:1}),c.forEach(this.symbolListItems,function(a,b){a.typeKeywordsString=a.typeKeywords.toString();-1<a.typeKeywordsString.indexOf("default")&&-1<a.typeKeywordsString.indexOf("marker")&&
(b=this.symbolListItems.splice(b,1),0<b.length&&(this.symbolListItems.splice(0,0,b[0]),this.symbolColorClasses.set("value",a.title)))},this),this.symbolClassStore=new c.data.ItemFileWriteStore({data:{identifier:"id",items:[]}}),c.forEach(this.symbolListItems,function(a){-1<a.typeKeywordsString.indexOf("marker")&&(this.symbolClassStore.newItem({name:a.title,id:a.id}),this.symbolColorClasses.set("store",this.symbolClassStore))},this),this.getSymbolListData(!0))}),c.hitch(this,function(a,c){}))},getSymbolListData:function(a){this.destroySymbolClassesTemplatePicker();
c.forEach(this.symbolListItems,function(e){if(("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)&&-1<e.typeKeywordsString.indexOf("marker")||("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type)&&-1<e.typeKeywordsString.indexOf("line")||("simplefillsymbol"===this.symbol.type||"picturefillsymbol"===this.symbol.type)&&-1<e.typeKeywordsString.indexOf("fill"))e.data?"simplemarkersymbol"!==this.symbol.type&&"picturemarkersymbol"!==this.symbol.type?
this.processSymbolListData(e):this.symbolColorClasses.get("value")==e.title&&this.processSymbolListData(e):arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"/content/items/"+e.id+"/data",c.hitch(this,function(c,d,b){d&&0<d.length&&(c.data=d,"simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type?(a&&-1<c.typeKeywordsString.indexOf("default")||!a)&&this.processSymbolListData(c):this.processSymbolListData(c))},e),c.hitch(this,function(a,d){}))},this)},processSymbolListData:function(a){setTimeout(c.hitch(this,
function(){this.createSymbolListTemplatePicker(a.data)}),0)},createSymbolListTemplatePicker:function(a){a=c.map(a,function(a){var c={};c.symbol=esri.symbol.fromJson(a);c.description=a.name;return c},this);this.symbolClassesTemplatePicker||(this.symbolClassesTemplatePicker=new esri.dijit.editing.TemplatePicker({items:a,rows:"auto",columns:"auto",_assumedCellWidth:40,grouping:!1,style:"position: relative; width: 100%; height: 120px;"},this.id+"_symbolClassesTemplatePicker"),this.symbolClassesTemplatePicker.startup(),
this.templatePickerSymbolClass=this.symbol.type,this.templatePickerOnSelectionChangeHandler=c.connect(this.symbolClassesTemplatePicker,"onSelectionChange",this,function(){var a=this.symbolClassesTemplatePicker.getSelected();if(a){var c=this.symbol;this.symbol=esri.symbol.fromJson(a.item.symbol.toJson());if("simplemarkersymbol"===this.symbol.type||"picturemarkersymbol"===this.symbol.type)"simplemarkersymbol"===this.symbol.type?this.symbol.size="simplemarkersymbol"===c.type?c.size:c.width:"simplemarkersymbol"===
c.type?(this.symbol.xoffset&&(this.symbol.xoffset=c.size/(this.symbol.width/this.symbol.xoffset)),this.symbol.yoffset&&(this.symbol.yoffset=this.symbol.height/this.symbol.width*c.size/(this.symbol.height/this.symbol.yoffset)),this.symbol.height=this.symbol.height/this.symbol.width*c.size,this.symbol.width=c.size):(this.symbol.xoffset&&(this.symbol.xoffset=c.width/(this.symbol.width/this.symbol.xoffset)),this.symbol.yoffset&&(this.symbol.yoffset=this.symbol.height/this.symbol.width*c.width/(this.symbol.height/
this.symbol.yoffset)),this.symbol.height=this.symbol.height/this.symbol.width*c.width,this.symbol.width=c.width);(this.symbol.width||this.symbol.size)>=this.endSize&&(this.endSize=(this.symbol.width?this.symbol.width:this.symbol.size)+("simplelinesymbol"==this.symbol.type?10:20),this.symbolEndSize.set("value",this.endSize,!1));this.updateUI()}}))},destroySymbolClassesTemplatePicker:function(){this.symbolClassesTemplatePicker&&(c.disconnect(this.templatePickerOnSelectionChangeHandler),this.symbolClassesTemplatePicker.destroy(),
this.symbolClassesTemplatePicker=null,c.byId("symbolClassesTemplatePicker")||c.create("div",{id:this.id+"_symbolClassesTemplatePicker"},this.symbolClassesTemplatePickerDiv))},onSymbolListChange:function(a){if(a){this.destroySymbolClassesTemplatePicker();for(var e=null,f=0;f<this.symbolListItems.length;f++)this.symbolListItems[f].title==a&&(e=this.symbolListItems[f]);e&&e.data&&setTimeout(c.hitch(this,function(){this.createSymbolListTemplatePicker(e.data)}),0)}},createSimpleMarkerTemplatePicker:function(){var a=
c.map(this.simpleMarkerSymbols,function(a){var c={};c.symbol=esri.symbol.fromJson(a);c.description=a.name;return c},this);this.simpleMarkerTemplatePicker||(this.simpleMarkerTemplatePicker=new esri.dijit.editing.TemplatePicker({items:a,rows:"auto",columns:"auto",_assumedCellWidth:40,grouping:!1,style:"position: relative; width: 100%; height: 45px;"},this.id+"_symbolSimpleMarkerTemplatePicker"),this.simpleMarkerTemplatePicker.startup(),this.simpleMarkerTemplatePickerOnSelectionChangeHandler=c.connect(this.simpleMarkerTemplatePicker,
"onSelectionChange",this,function(){var a=this.simpleMarkerTemplatePicker.getSelected();a&&(this.symbol=esri.symbol.fromJson(a.item.symbol.toJson()),this.updateUI())}))},destroySimpleMarkerTemplatePicker:function(){this.simpleMarkerTemplatePicker&&(c.disconnect(this.simpleMarkerTemplatePickerOnSelectionChangeHandler),this.simpleMarkerTemplatePicker.destroy(),this.simpleMarkerTemplatePicker=null,c.byId(this.id+"_symbolSimpleMarkerTemplatePicker")||c.create("div",{id:this.id+"_symbolSimpleMarkerTemplatePicker"},
this.symbolSimpleMarkerTemplatePickerDiv))},getSymbolUrl:function(){var a=this.symbol.url;0!==a.indexOf("http://")&&this.symbol.imageData&&0<this.symbol.imageData.length&&(a=this.symbol.imageData);return a},setLinePattern:function(){switch(this.symbol.style){case esri.symbol.SimpleLineSymbol.STYLE_DOT:this.symbolLinePatternSelect.set("value","dot",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASH:this.symbolLinePatternSelect.set("value","dash",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASHDOT:this.symbolLinePatternSelect.set("value",
"dashdot",!1);break;case esri.symbol.SimpleLineSymbol.STYLE_DASHDOTDOT:this.symbolLinePatternSelect.set("value","dashdotdot",!1);break;default:this.symbolLinePatternSelect.set("value","solid",!1)}},getMarkerJson:function(){var a=this.markerJson;a.url=arcgisonline.sharing.util.getRedSphereUrl();return a},_drawSymbol:function(){var a=this.symbolImage,e=this.symbol,f=this.template,d=80,b=30;if("simplemarkersymbol"===e.type)b=d=Math.min(e.size+12,125);else if("picturemarkersymbol"===e.type){if(!this.symbol.url||
"http://"===e.url||-1==e.url.indexOf("http://")&&-1==e.url.indexOf("https://")&&-1==e.url.indexOf("data:"))return;b=d=Math.min(Math.max(e.width,e.height),125)}else if("simplelinesymbol"===this.symbol.type||"cartographiclinesymbol"===this.symbol.type)d=190,b=20;a=h.gfx.createSurface(a,d,b);if("vml"===h.gfx.renderer){var g=a.getEventSource();c.style(g,"position","relative");c.style(g.parentNode,"position","relative")}var e=this._getDrawingToolShape(e,f)||esri.symbol.getShapeDescriptors(e),k;try{k=a.createShape(e.defaultShape).setFill(e.fill).setStroke(e.stroke)}catch(m){a.clear();
a.destroy();return}e=a.getDimensions();e={dx:e.width/2,dy:e.height/2};g=k.getBoundingBox();f=g.width;g=g.height;if(f>d||g>b)d=((d<b?d:b)-5)/(f>g?f:g),c.mixin(e,{xx:d,yy:d});k.applyTransform(e);return a},_getDrawingToolShape:function(a,c){if("simplelinesymbol"==a.type||"cartographiclinesymbol"==a.type)return c={type:"path",path:"M -90,0 L 90,0 E"},{defaultShape:c,fill:null,stroke:a.getStroke()};switch(c?c.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};
break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){c.forEach(this._surfaceItems,
function(a){this._repaint(a)},this)},_repaint:function(a){a.getStroke&&a.setStroke&&a.setStroke(a.getStroke());a.getFill&&a.setFill&&a.setFill(a.getFill());a.children&&c.isArray(a.children)&&c.forEach(a.children,this._repaint,this)}})})},"arcgisonline/sharing/dijit/dialog/ImgDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/dialog/GeneralDlg"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.ImgDlg");c.require("dijit.Dialog");
c.require("dijit._Widget");c.require("dijit._Templated");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.declare("arcgisonline.sharing.dijit.dialog.ImgDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"image-dialog" title\x3d"${i18n.imgDlgTitle}" execute\x3d""\x3e\r\n    \x3cdiv\x3e\r\n      \x3cdiv style\x3d"line-height:17px;padding-top:10px;padding-right:10px;"\x3e\x3cspan\x3e${i18n.specifyImage}\x3c/span\x3e\x3c/div\x3e\r\n      \x3cbr /\x3e\r\n      \x3clabel style\x3d"line-height:12px;"\x3e${i18n.urlLabel}\x3c/label\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"urlInput" dojotype\x3d"dijit.form.TextBox" trim\x3d"true" value\x3d"http://" style\x3d"width:330px;" dir\x3d"ltr"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv style\x3d"line-height:17px;padding-top:10px;padding-right:10px;"\x3e\x3cspan\x3e${i18n.imgDetailMessage}\x3c/span\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\t  \x3cbr /\x3e\x26nbsp;  \r\n\t  \x3cbutton dojoAttachEvent\x3d"onClick:onCancelClick" class\x3d"jevent cancel" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n\t  \x3cbutton dojoAttachEvent\x3d"onClick:onDoneClick" class\x3d"jevent primary" style\x3d"float:right;" dojoType\x3d"dijit.form.Button"\x3e${i18n.done}\x3c/button\x3e\r\n\t  \x3cbr /\x3e\x26nbsp; \r\n\t\t\x3cbr/\x3e \r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
i18n:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.ImgDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").generalDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").imgDlg)},postCreate:function(){this.loadConnections()},
show:function(a){l.byId("image-dialog").show()},hide:function(){this.urlInput.setValue("http://");l.byId("image-dialog").hide()},loadConnections:function(){c.query(".jevent").connect("onclick",function(a){a.preventDefault()})},onDoneClick:function(a){a=this.urlInput.getValue();10>a.length?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorDlgTitle,message:this.i18n.error.invalidUrl}):(0!==a.indexOf("http")&&(a="http://"+a),c.publish("onUrlChange",
[a]),this.hide())},onCancelClick:function(a){c.publish("onUrlChange",[]);this.hide()}})})},"arcgisonline/sharing/dijit/dialog/SelectAccountUserDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/on dijit/a11yclick dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/ComboBox dojo/store/Memory dojo/promise/all dojo/Deferred ../../util ../../../pages/pageUtil ../../geow/Account ../../geow/Roles dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/SelectAccountUserDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t){var y=l("arcgisonline.sharing.dijit.dialog.SelectAccountUserDlg",[d,b,g],{declaredClass:"arcgisonline.sharing.dijit.dialog.SelectAccountUserDlg",baseClass:"esriAGOChangeOwnerDlg",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:t,widgetsInTemplate:!0,maxUsers:100,enterpriseProvider:"enterprise",postCreate:function(){this.inherited(arguments);this._rolesAPI=new u;this._initHandlers()},postMixInProperties:function(){this.inherited(arguments);
this.i18n=h.mixin({},w.common);this.i18n=h.mixin(this.i18n,w.selectAccountUserDlg)},hide:function(a){a&&a.preventDefault();this._dialog.hide()},show:function(a,b){this._clear();this.accountId=a.id;this.currentUser=a.currentUser;this.filterPrivileges=(this.adminOnly=a.adminOnly)?a.filterPrivileges||[]:[];this.handler=b;var d=this._addUsers.bind(this),c=this._noUsers.bind(this),e=[];if(n.isPortal()&&a.provider&&a.provider===this.enterpriseProvider&&a.groupId)this._fetchGroupUsers(a);else{var g={start:1,
num:this.maxUsers,excludeSystemUsers:n.isPortal()?!0:null};this.adminOnly?(g.role="org_admin",this.filterPrivileges.length&&this._fetchRoles(this.filterPrivileges).then(function(a){e=[];e.push(this._fetchUsers(h.clone(g)));a.forEach(function(a){g.role=a;e.push(this._fetchUsers(h.clone(g)))},this);p(e).then(function(a){var b=[];a.forEach(function(a){b=b.concat(a)},this);this._addUsers(b)}.bind(this),c)}.bind(this),function(a){this._fetchUsers(h.clone(g)).then(d,c)}.bind(this))):(this.filterPrivileges=
[],this._fetchUsers(h.clone(g)).then(d,c))}this._dialog.set("title",a.title);f.set(this._selectUserBtn,"innerHTML",a.title);f.set(this._selectUserContent,"innerHTML",a.message);this._dialog.show()},_initHandlers:function(){this.own(a(this._userList,"change",h.hitch(this,"_userSelectChange")),e(this._selectUserBtn,h.hitch(this,"_selectUser")),e(this._cancelBtn,h.hitch(this,"hide")))},_clear:function(){this.userStore=this.selectedUser=null;this._userList.set("value",this.i18n.selectUserLabel);r.disableNode(this._selectUserBtn,
!0)},_userSelectChange:function(a){(a=this.userStore.query({name:a}))&&0<a.length&&(a=a.shift(),this.selectedUser=a.username);this.selectedUser&&0<this.selectedUser.length&&r.disableNode(this._selectUserBtn,!1)},_selectUser:function(){null!==this.selectedUser&&(this.handler(this.selectedUser),this.hide())},_fetchGroupUsers:function(a){var b=0;n.request({url:esriGeowConfig.restBaseUrl+"community/groups/"+a.groupId+"/users"}).then(h.hitch(this,function(a){a&&!a.code&&!a.message&&a.owner&&a.admins&&
a.users&&(null===this.userStore&&(this.userStore=new m({idProperty:"name",data:[]}),this._userList.set("store",this.userStore)),a.admins.forEach(h.hitch(this,function(a){this.currentUser!==a&&(this.userStore.put({name:a,username:a}),b++)})),a.users.forEach(h.hitch(this,function(a){this.currentUser!==a&&(this.userStore.put({name:a,username:a}),b++)})),0===b&&this._userList.setAttribute("value",this.i18n.noUsers))}))},_fetchRoles:function(a){var b=new q,d=[],c;this._rolesAPI.getAllRoles(!0).then(h.hitch(this,
function(e){e.forEach(h.hitch(this,function(b){for(c=0;c<a.length;c++)if(r.includes(b.privileges,a[c])){d.push(b.id);break}}));b.resolve(d)}),h.hitch(this,function(a){b.reject(a)}));return b},_fetchUsers:function(a){return r.fetchAllResources(esriGeowConfig.restBaseUrl+"portals/self/users",a,"users")},_noUsers:function(a){this._addUsers([])},_addUsers:function(a){var b,d;null===this.userStore&&(this.userStore=new m({idProperty:"name",data:[]}),this._userList.set("store",this.userStore));a.forEach(h.hitch(this,
function(a){b=a.username;d=a.fullName+" ("+a.username+")";this.currentUser!==a.username&&this.userStore.put({name:d,username:b})}));1===a.length&&this._userList.setAttribute("value",this.i18n.noUsers)}});y.prototype.statics={_instance:null,getInstance:function(){null==this._instance&&(this._instance=new y);return this._instance}};return y})},"arcgisonline/sharing/dijit/dialog/SetIdentityProviderDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,dijit/form/TextBox,dijit/form/Button,dijit/form/CheckBox,dijit/form/SimpleTextarea,dijit/form/FilteringSelect,dijit/Tooltip,dojo/Deferred,dojo/DeferredList,dojo/store/Memory,dojo/on,arcgisonline/sharing/dijit/GroupSelector,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/_LevelAwareMixin,arcgisonline/sharing/util,arcgisonline/pages/pageUtil,arcgisonline/pages/utils/tooltips,arcgisonline/sharing/geow/Roles"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.SetIdentityProviderDlg");c.require("dijit.Dialog");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.form.TextBox");c.require("dijit.form.Button");c.require("dijit.form.CheckBox");c.require("dijit.form.SimpleTextarea");c.require("dijit.form.FilteringSelect");c.require("dijit.Tooltip");c.require("dojo.Deferred");c.require("dojo.DeferredList");c.require("dojo.store.Memory");c.require("dojo.on");c.require("arcgisonline.sharing.dijit.GroupSelector");
c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit._LevelAwareMixin");c.require("arcgisonline.sharing.util");c.require("arcgisonline.pages.pageUtil");c.require("arcgisonline.pages.utils.tooltips");c.require("arcgisonline.sharing.geow.Roles");c.declare("arcgisonline.sharing.dijit.dialog.SetIdentityProviderDlg",[l._Widget,l._Templated,arcgisonline.sharing.dijit._LevelAwareMixin],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv class\x3d"${baseClass}" data-dojo-type\x3d"dijit.Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"set-identity-provider-dialog" title\x3d"${i18n.setIdentityProviderTitle}" execute\x3d""\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" enctype\x3d"multipart/form-data" method\x3d"post" onsubmit\x3d"return false;"\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_signUpMode" name\x3d"signUpMode" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_bindingType" name\x3d"bindingType" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_roleSelection" name\x3d"roleId" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_levelSelection" name\x3d"level" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_supportEncryption" name\x3d"encryptionSupported" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_supportSignedRequest" name\x3d"supportSignedRequest" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_useSHA256" name\x3d"useSHA256" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_supportsLogoutRequest" name\x3d"supportsLogoutRequest" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_userCreditAssignment" name\x3d"userCreditAssignment" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_groups" name\x3d"groups" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_updateProfileAtSignIn" name\x3d"updateProfileAtSignin" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_updateGroupsAtSignIn" name\x3d"updateGroupsAtSignin" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_userType" name\x3d"userType" type\x3d"hidden" value\x3d""\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_clearEmptyFields" name\x3d"clearEmptyFields" type\x3d"hidden" value\x3d"false"\x3e\r\n\r\n      \x3cdiv data-dojo-attach-point\x3d"_description"\x3e\x3c/div\x3e\r\n      \x3cbr\x3e\r\n      \x3cspan\x3e${i18n.nameLabel}\x3c/span\x3e\x3cbr\x3e\r\n      \x3cdiv name\x3d"name" data-dojo-attach-point\x3d"_nameInput" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n      \x3cbr\x3e\x3cbr\x3e\r\n\r\n      \x3cspan\x3e${i18n.signUpLabel}\x3c/span\x3e\x3cbr\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_signUpModeOptions"\x3e\r\n        \x3cdiv id\x3d"automatic-option" name\x3d"signUpModeOption" type\x3d"radio"\r\n             data-dojo-attach-point\x3d"_automaticOption" data-dojo-type\x3d"dijit/form/RadioButton"\r\n             data-dojo-attach-event\x3d"onClick:onAutomaticClicked"\x3e\x3c/div\x3e \x3clabel data-dojo-attach-point\x3d"_automaticOptionLabel" for\x3d"automatic-option"\x3e${i18n.automaticOption}\x3c/label\x3e\r\n        \x3cdiv id\x3d"invite-option" name\x3d"signUpModeOption" type\x3d"radio"\r\n             data-dojo-attach-point\x3d"_inviteOption" data-dojo-type\x3d"dijit/form/RadioButton"\r\n             data-dojo-attach-event\x3d"onClick:onInvitationClicked" data-dojo-props\x3d"checked:true"\x3e\x3c/div\x3e \x3clabel data-dojo-attach-point\x3d"_inviteOptionLabel" for\x3d"invite-option"\x3e${i18n.onInviteOption}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_levelOptions"\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan\x3e${i18n.defaultLevel}\x3c/span\x3e\x3cbr\x3e\r\n        \x3clabel\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"levelOptions" data-dojo-attach-point\x3d"_level1Option" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_level1Img"\x3e\x3c/span\x3e\r\n        \x3c/label\x3e\r\n        \x3clabel\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"levelOptions" data-dojo-attach-point\x3d"_level2Option" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_level2Img"\x3e\x3c/span\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_roleOptions"\x3e\r\n        \x3cspan\x3e${i18n.roleAssigned}\x3c/span\x3e\x26nbsp;\r\n        \x3cselect id\x3d"role-option" data-dojo-attach-point\x3d"_roleSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"fetchProperties:{sort:[{attribute:\'name\',descending:false}]}"\x3e\x3c/select\x3e\x3cbr\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_creditOptions"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_currentCreditsLabel"\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cspan\x3e${i18n.setAllocation}\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriLeadingPadding05"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"allocation" data-dojo-attach-point\x3d"_setAllocationRadioBtn"\r\n                   data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n            ${i18n.allocateCreditsSet}\r\n          \x3c/label\x3e\r\n          \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_credits" class\x3d"creditEntry" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                 data-dojo-props\x3d"trim:true"\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriLeadingPadding05"\x3e\r\n          \x3clabel data-dojo-attach-point\x3d"_unlimitedCreditsLabel"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"allocation"\r\n                   data-dojo-attach-point\x3d"_setUnlimitedRadioBtn" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n            \x3cspan id\x3d"${id}-noLimitTooltip-${baseClass}" class\x3d"hasTooltip"\x3e${i18n.allocateCreditsUnlimited}\x3c/span\x3e\r\n          \x3c/label\x3e\r\n        \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_esriAccessOptions"\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan\x3e${i18n.defaultEsriAccess}\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv id\x3d"esri-access-enabled-option" name\x3d"esriAccessOption" type\x3d"radio"\r\n          data-dojo-attach-point\x3d"_esriAccessEnabledOption" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\x3c/div\x3e\r\n        \x3clabel for\x3d"esri-access-enabled-option"\x3e${i18n.enabledLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"esri-access-disabled-option" name\x3d"esriAccessOption" type\x3d"radio"\r\n          data-dojo-attach-point\x3d"_esriAccessDisabledOption" data-dojo-type\x3d"dijit/form/RadioButton"\r\n          data-dojo-props\x3d"checked:true"\x3e\x3c/div\x3e\r\n        \x3clabel for\x3d"esri-access-disabled-option"\x3e${i18n.disabledLabel}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_groupOptions"\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_groupsLabel"\x3e${i18n.noGroupsSelected}\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv class\x3d"inline-block specified-group-list hide" data-dojo-attach-point\x3d"_groupListContainer"\x3e\x3c/div\x3e\r\n        \x3cspan class\x3d"esriItemLinks hide" data-dojo-attach-point\x3d"_otherLinkContainer"\x3e\x3ca id\x3d"${id}-other-link" data-dojo-attach-point\x3d"_otherLink"\x3e${i18n.otherLink}\x3c/a\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cbutton type\x3d"button" class\x3d"calcite secondary" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_specifyGroupsBtn"\x3e\r\n          ${i18n.specifyGroups}\r\n        \x3c/button\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- start federation of identity provider fields --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_federationDiscoveryServiceContainer"\x3e\r\n        \x3cspan\x3e${i18n.federationDiscoveryServiceUrlLabel}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_federationDiscoveryServiceUrl" name\x3d"discoveryServiceUrl" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3cbr\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_metadataAggregateUrlContainer"\x3e\r\n        \x3cspan\x3e${i18n.metadataAggregateUrlLabel}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_metadataAggregateUrl" name\x3d"metadataServiceUrl" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3cbr\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_aggregatedMetadataCertificateContainer"\x3e\r\n        \x3cspan\x3e${i18n.aggregatedMetadataCertificateLabel}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3ctextarea data-dojo-attach-point\x3d"_aggregatedMetadataCertificate" name\x3d"certificate" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d"rows:3"\r\n          title\x3d"${i18n.aggregatedMetadataCertificatePlaceholder}"\x3e\x3c/textarea\x3e\r\n        \x3cbr\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- end federation of identity provider fields --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_metadataSourceContainer"\x3e\r\n        \x3cspan\x3e${i18n.sourceLabel}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_sourceOptions"\x3e\r\n          \x3cdiv id\x3d"metadata-url-option" name\x3d"providerOptions" type\x3d"radio" data-dojo-attach-point\x3d"_metadataUrlOption" data-dojo-type\x3d"dijit/form/RadioButton"\r\n            checked\x3d"true"\x3e\x3c/div\x3e\r\n          \x3clabel for\x3d"metadata-url-option"\x3e${i18n.metadataUrlOption}\x3c/label\x3e\r\n          \x3cdiv id\x3d"metadata-file-option" name\x3d"providerOptions" type\x3d"radio" data-dojo-attach-point\x3d"_metadataFileOption" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\x3c/div\x3e\r\n          \x3clabel for\x3d"metadata-file-option"\x3e${i18n.metadataFileOption}\x3c/label\x3e\r\n          \x3cdiv id\x3d"parameters-option" name\x3d"providerOptions" type\x3d"radio" data-dojo-attach-point\x3d"_parametersOption" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\x3c/div\x3e\r\n          \x3clabel for\x3d"parameters-option"\x3e${i18n.parametersOption}\x3c/label\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_sourceInputs"\x3e\r\n          \x3cbr\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_metadataUrlInputs"\x3e\r\n            \x3cspan\x3e${i18n.metadataUrlLabel}\x3c/span\x3e\r\n            \x3cbr\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_bindingUrlInput" name\x3d"idpMetadataUrl" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_metadataFileInputs"\x3e\r\n            \x3cspan\x3e${i18n.metadataFileLabel}\x3c/span\x3e\r\n            \x3cbr\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"_metadataFileInput" name\x3d"idpMetadataFile" type\x3d"file" title\x3d"${i18n.metadataFilePlaceHolder}"\r\n            /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_parametersInputs"\x3e\r\n            \x3cspan\x3e${i18n.parametersUrlLabel}\x3c/span\x3e\r\n            \x3cbr\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_loginUrlInput" name\x3d"bindingUrl" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n            \x3cbr\x3e\r\n            \x3cbr\x3e\r\n            \x3cspan\x3e${i18n.parametersPostUrlLabel}\x3c/span\x3e\r\n            \x3cbr\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_loginUrlPostInput" name\x3d"postBindingUrl" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n            \x3cbr\x3e\r\n            \x3cbr\x3e\r\n            \x3c!--\x3cspan"\x3e${i18n.parametersBindingTypeLabel}\x3c/span\x3e--\x3e\r\n            \x3c!--\x3cdiv id\x3d"binding-type-redirect-option" name\x3d"bindingTypeOptions" data-dojo-attach-point\x3d"_bindingTypeRedirect" type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_bindingTypeRedirectOption" checked\x3d"true"\x3e\x3c/div\x3e \x3clabel\x3e${i18n.parametersBindingTypeRedirect}\x3c/label\x3e--\x3e\r\n            \x3c!--\x3cdiv id\x3d"binding-type-post-option" name\x3d"bindingTypeOptions" data-dojo-attach-point\x3d"_bindingTypePost" type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_bindingTypePostOption"\x3e\x3c/div\x3e \x3clabel\x3e${i18n.parametersBindingTypePost}\x3c/label\x3e--\x3e\r\n            \x3c!--\x3cbr\x3e\x3cbr\x3e--\x3e\r\n            \x3cspan\x3e${i18n.parametersCertificateLabel}\x3c/span\x3e\r\n            \x3cbr\x3e\r\n            \x3ctextarea data-dojo-attach-point\x3d"_certificateInput" name\x3d"certificate" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d"rows:3"\r\n              title\x3d"${i18n.parametersCertificatePlaceHolder}"\x3e\x3c/textarea\x3e\r\n            \x3cdiv style\x3d"display:none;"\x3e\r\n              \x3cbr\x3e\r\n              \x3cspan\x3e${i18n.orLabel}\x3c/span\x3e\r\n              \x3cbr\x3e\r\n              \x3cbr\x3e\r\n              \x3cspan\x3e${i18n.parametersCertificateFileLabel}\x3c/span\x3e\r\n              \x3cbr\x3e\r\n              \x3cinput type\x3d"file" data-dojo-attach-point\x3d"_certificateFileInput" name\x3d"certificateFile" title\x3d"${i18n.parametersCertificateFilePlaceHolder}"\r\n              /\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cbr\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\x3cdiv\x3e--\x3e\r\n        \x3c!--\x3cbr\x3e--\x3e\r\n        \x3c!--\x3cspan\x3e--\x3e\r\n          \x3c!--\x3cinput type\x3d"checkbox" id\x3d"encryptionSupported" data-dojo-attach-point\x3d"_encryptionSupported" data-dojo-type\x3d"dijit/form/CheckBox"\x3e--\x3e\r\n          \x3c!--\x3clabel for\x3d"encryptionSupported"\x3e${i18n.encryptionSupported}\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/span\x3e--\x3e\r\n        \x3c!--\x3cbr\x3e--\x3e\r\n        \x3c!--\x3cspan\x3e--\x3e\r\n          \x3c!--\x3cinput type\x3d"checkbox" id\x3d"supportSignedRequest" data-dojo-attach-point\x3d"_signedRequestSupported" data-dojo-type\x3d"dijit/form/CheckBox"\x3e--\x3e\r\n          \x3c!--\x3clabel for\x3d"supportSignedRequest"\x3e${i18n.supportSignedRequest}\x3c/label\x3e--\x3e\r\n        \x3c!--\x3c/span\x3e--\x3e\r\n        \x3c!--\x3cbr\x3e--\x3e\r\n      \x3c!--\x3c/div\x3e\x3cbr\x3e--\x3e\r\n\r\n      \x3cspan class\x3d"esriItemLinks"\x3e\x3ca data-dojo-attach-point\x3d"_toggleAdvancedSettings" data-dojo-attach-event\x3d"onclick:onToggleAdvancedSettings"\x3e${i18n.showAdvancedSettings}\x3c/a\x3e\x3c/span\x3e\x3cbr\x3e\r\n      \x3cdiv id\x3d"advancedSettings" data-dojo-attach-point\x3d"_advancedSettings"\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan\x3e\r\n          \x3cinput type\x3d"checkbox" id\x3d"encryptionSupported" data-dojo-attach-point\x3d"_encryptionSupported" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n          \x3clabel for\x3d"encryptionSupported"\x3e${i18n.encryptionSupported}\x3c/label\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cspan\x3e\r\n          \x3cinput type\x3d"checkbox" id\x3d"supportSignedRequest" data-dojo-attach-point\x3d"_signedRequestSupported" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n          \x3clabel for\x3d"supportSignedRequest"\x3e${i18n.supportSignedRequest}\x3c/label\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"esriLeadingMargin15" data-dojo-attach-point\x3d"_sha256Container"\x3e\r\n            \x3cinput type\x3d"checkbox" id\x3d"signUsingSHA256" data-dojo-attach-point\x3d"_signUsingSHA256" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n            \x3clabel for\x3d"signUsingSHA256"\x3e${i18n.signUsingSHA256}\x3c/label\x3e\x3cbr\x3e\r\n          \x3c/span\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan\x3e\r\n          \x3cinput type\x3d"checkbox" id\x3d"supportsLogoutRequest" data-dojo-attach-point\x3d"_logoutRequestSupported" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n          \x3clabel for\x3d"supportsLogoutRequest"\x3e${i18n.propagateLogout}\x3c/label\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cspan\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"_updateProfile" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n            ${i18n.updateProfileAtSignIn}\r\n          \x3c/label\x3e\r\n        \x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_updateGroupsContainer"\x3e\r\n          \x3cspan\x3e\r\n            \x3clabel\x3e\r\n              \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"_updateGroups" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n              ${i18n.updateGroupsAtSignIn}\r\n            \x3c/label\x3e\r\n          \x3c/span\x3e\r\n          \x3cbr\x3e\x3cbr\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_logoutUrlContainer"\x3e\r\n          \x3cspan\x3e${i18n.logoutUrlLabel}\x3c/span\x3e\r\n          \x3cbr\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_logoutUrlInput" name\x3d"logoutUrl" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n          \x3clabel\x3e${i18n.optionalLabel}\x3c/label\x3e\r\n          \x3cbr\x3e\r\n          \x3cbr\x3e\r\n        \x3c/div\x3e\r\n        \x3cspan\x3e${i18n.entityIDLabel}\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_entityIDInput" name\x3d"entityId" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3c!--\x3cspan\x3e${i18n.userIdAttrLabel}\x3c/span\x3e\x3cbr\x3e--\x3e\r\n        \x3c!--\x3cdiv data-dojo-attach-point\x3d"_userIdAttrInput" name\x3d"userIdAttribute" type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true" title\x3d"${i18n.userIdAttrTooltip}"\x3e\x3c/div\x3e \x3clabel\x3e${i18n.optionalLabel}\x3c/label\x3e--\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr\x3e\x3cbr\x3e\r\n      \x3cdiv class\x3d"esriAlignTrailing" data-dojo-attach-point\x3d"_buttons"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_setBtn" class\x3d"primary" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.setIdentityProviderLabel}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" class\x3d"cancel" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
baseClass:"esriAGOSetIdentityProviderDlg orgDlg",util:arcgisonline.sharing.util,pageUtil:arcgisonline.pages.pageUtil,SIGN_UP_MODE_AUTOMATIC:"Automatic",SIGN_UP_MODE_INVITE:"Invitation",BINDING_TYPE_REDIRECT:"HTTP_REDIRECT",BINDING_TYPE_POST:"HTTP_POST",orgAdminRole:"org_admin",orgPublisherRole:"org_publisher",orgUserRole:"org_user",_currentIDP:null,_isEditing:!1,_roles:[],_tooltips:[],statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SetIdentityProviderDlg);
return this._instance}},caseInsensitiveMemoryStore:c.declare(c.store.Memory,{query:function(a,c){var e=c.sort[0];"name"===e.attribute&&(c.sort=function(a,b){a=a[e.attribute];b=b[e.attribute];return a!==b?!!e.descending===(null===a||a.toLowerCase()>(b&&b.toLowerCase()))?-1:1:0});return this.inherited(arguments)}}),postMixInProperties:function(){this.inherited(arguments);this.i18n={};c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").common);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline",
"arcgisonline").setIdentityProviderDlg);this.i18n.adminRoleName=c.i18n.getLocalization("arcgisonline","arcgisonline").organizationInvite.userRoles.admin},postCreate:function(){this.loadConnections();this._setupTooltips();this._rolesAPI=new arcgisonline.sharing.geow.Roles},show:function(a){this._isFederation=esri.isDefined(a)&&a.isFederation;this._isPortal=this.util.isPortal();this.clear();this.getRoles().then(c.hitch(this,function(){l.byId("set-identity-provider-dialog").set("title",this._isFederation?
this.i18n.setFederationOfIdentityProvidersTitle:this.i18n.setIdentityProviderTitle);c.hitch(this,this._configureFormForIdentityProviderType);this._configureFormForIdentityProviderType();var a=/:\d*\//g,a=this._isPortal?esriGeowConfig.self.portalHostname.replace(a,".").replace("/","."):esriGeowConfig.self.urlKey+"."+esriGeowConfig.self.customBaseUrl;esri.isDefined(this._currentIDP)||this._roleSelect.set("value",this.orgUserRole);this._entityIDInput&&this._entityIDInput.set("value",a);l.byId("set-identity-provider-dialog").show()}))},
getRoles:function(){var a=new c.Deferred;this._rolesAPI.getAllRoles(!0).then(c.hitch(this,function(c){this._roles=c;esriGeowConfig.userLicenseLevelsEnabled&&(this._viewerRole=this._localizeViewerRole(this._roles));this._filterRoles();a.resolve()}));return a},_localizeViewerRole:function(a){if(a)for(var c=0;c<a.length;c++)if(a[c]&&a[c].id===this.SYSTEM_ROLES.VIEWER)return a[c].name=this.i18n.viewerRoleName,a[c]},_coreRoleSelected:function(a){return-1<c.indexOf([this.orgUserRole,this.orgPublisherRole,
this.orgAdminRole],a)},_hasAdminPrivileges:function(a){var c;if(a&&a.privileges)for(var f=0;f<a.privileges.length;f++)if(c=a.privileges[f],-1<c.indexOf(":admin"))return!0;return!1},_filterRoles:function(a){var c=a?[]:[{id:this.orgUserRole,name:this.i18n.userRoleName},{id:this.orgPublisherRole,name:this.i18n.publisherRoleName}],f,d=["portal:user:joinNonOrgGroup"].concat(this._viewerRole.privileges);this._isPortal&&!a&&c.push({role:this.orgAdminRole,name:this.i18n.adminRoleName});for(var b=0;b<this._roles.length;b++)f=
esriGeowConfig.userLicenseLevelsEnabled&&!!a&&this._viewerRole&&arcgisonline.sharing.geow.Roles.exceedsRolePrivileges(d,this._roles[b].privileges),(!f&&!this._hasAdminPrivileges(this._roles[b])||this._isPortal)&&c.push({id:this._roles[b].id,name:this._roles[b].name});this._roleSelect&&this._roleSelect.set("store",new this.caseInsensitiveMemoryStore({idProperty:"id",data:c}))},edit:function(a){this.clear();this._isFederation=a.isFederation;this._currentIDP=a;this._isPortal=this.util.isPortal();this._isEditing=
!0;var e=/:\d*\//g,f=this._isPortal?esriGeowConfig.self.portalHostname.replace(e,".").replace("/","."):esriGeowConfig.self.urlKey+"."+esriGeowConfig.self.customBaseUrl,d=esriGeowConfig.self.creditAssignments&&"enabled"===esriGeowConfig.self.creditAssignments;this.getRoles().then(c.hitch(this,function(){esri.isDefined(a)?(c.hitch(this,this._configureFormForIdentityProviderType),this._configureFormForIdentityProviderType(),l.byId("set-identity-provider-dialog").set("title",this._isFederation?this.i18n.editFederationOfIdentityProvidersTitle:
this.i18n.editIdentityProviderTitle),this._nameInput.set("value",esri.isDefined(a.name)?a.name:""),this._encryptionSupported.set("value",esri.isDefined(a.encryptionSupported)?a.encryptionSupported:!1),this._signedRequestSupported.set("value",esri.isDefined(a.supportSignedRequest)?a.supportSignedRequest:!1),this._signUsingSHA256.set("value",esri.isDefined(a.useSHA256)?a.useSHA256:!1),c.style(this._sha256Container,"display",esri.isDefined(a.supportSignedRequest)&&a.supportSignedRequest?"":"none"),this._loginUrlInput.set("value",
esri.isDefined(a.bindingUrl)?a.bindingUrl:""),this._loginUrlPostInput.set("value",esri.isDefined(a.bindingPostUrl)?a.bindingPostUrl:""),this._logoutUrlInput.set("value",esri.isDefined(a.logoutUrl)?a.logoutUrl:""),this._certificateInput.set("value",esri.isDefined(a.certificate)?a.certificate:""),this._logoutRequestSupported.set("value",esri.isDefined(a.supportsLogoutRequest)?a.supportsLogoutRequest:!1),this._updateProfile.set("value",esri.isDefined(a.updateProfileAtSignin)?a.updateProfileAtSignin:
!1),this._updateGroups.set("checked",esri.isDefined(a.updateGroupsAtSignin)?a.updateGroupsAtSignin:!1),this._federationDiscoveryServiceUrl.set("value",esri.isDefined(a.discoveryServiceUrl)?a.discoveryServiceUrl:""),this._metadataAggregateUrl.set("value",esri.isDefined(a.metadataServiceUrl)?a.metadataServiceUrl:""),this._aggregatedMetadataCertificate.set("value",esri.isDefined(a.certificate)?a.certificate:""),f=esri.isDefined(a.entityId)&&""!==a.entityId?a.entityId:f,this._entityIDInput.set("value",
f),esri.isDefined(a.signUpMode)&&(a.signUpMode===this.SIGN_UP_MODE_AUTOMATIC?(this._automaticOption.set("checked",!0),esriGeowConfig.userLicenseLevelsEnabled&&!this._isPortal?(c.style(this._levelOptions,"display",""),a.level&&a.level==this.LICENSE_LEVELS.ONE?(this._level1Option.set("checked",!0),this._filterRoles(!0)):this._level2Option.set("checked",!0)):c.style(this._levelOptions,"display","none"),c.style(this._roleOptions,"display",this._isPortal?"none":""),c.style(this._creditOptions,"display",
this._isPortal||!d?"none":""),c.style(this._groupOptions,"display",this._isPortal?"none":""),c.style(this._esriAccessOptions,"display",this._isPortal?"none":""),a.roleId?this._roleSelect.set("value",a.roleId):this._roleSelect.set("value",this.orgUserRole)):a.signUpMode===this.SIGN_UP_MODE_INVITE&&(this._inviteOption.set("checked",!0),c.style(this._roleOptions,"display","none"),c.style(this._levelOptions,"display","none"),c.style(this._creditOptions,"display","none"),c.style(this._groupOptions,"display",
"none"),c.style(this._esriAccessOptions,"display","none"),this._roleSelect.set("value",this.orgUserRole))),d?esri.isDefined(a.userCreditAssignment)&&(0<a.userCreditAssignment?(this._setAllocationRadioBtn.set("checked",!0),this._credits.set("value",a.userCreditAssignment),this._credits.set("displayedValue",a.userCreditAssignment)):this._setUnlimitedRadioBtn.set("checked",!0)):c.style(this._creditOptions,"display","none"),esri.isDefined(a.groups)&&0<a.groups.length?this._fetchSelectedGroups(a.groups):
(this._selectedGroups=[],this._toggleGroups()),esri.isDefined(a.userType)&&("both"===a.userType?this._esriAccessEnabledOption.set("checked",!0):this._esriAccessDisabledOption.set("checked",!0)),this._parametersOption.set("checked",!0),this.showParametersInputs(),esri.isDefined(a.logoutUrl)&&0<a.logoutUrl.length||esri.isDefined(a.userIdAttribute)&&0<a.userIdAttribute.length?this.showAdvancedSettings():this.hideAdvancedSettings()):(this._entityIDInput.set("value",f),this._encryptionSupported.set("value",
!1),this._signedRequestSupported.set("value",!1),this._signUsingSHA256.set("value",!1),c.style(this._sha256Container,"display","none"),this._logoutRequestSupported.set("value",!1),this._updateGroups.set("checked",!1),esriGeowConfig.userLicenseLevelsEnabled&&!this._isPortal?c.style(this._levelOptions,"display",""):c.style(this._levelOptions,"display","none"));this._setBtn.set("label",this.i18n.updateIdentityProviderLabel);l.byId("set-identity-provider-dialog").show()}))},_configureFormForIdentityProviderType:function(){c.style(this._metadataSourceContainer,
"display",this._isFederation?"none":"");c.style(this._updateGroupsContainer,"display",this._isFederation?"none":"");c.style(this._logoutUrlContainer,"display",this._isFederation?"none":"");this._certificateInput.set("disabled",this._isFederation?!0:!1);c.style(this._federationDiscoveryServiceContainer,"display",this._isFederation?"":"none");c.style(this._metadataAggregateUrlContainer,"display",this._isFederation?"":"none");c.style(this._aggregatedMetadataCertificateContainer,"display",this._isFederation?
"":"none");this._aggregatedMetadataCertificate.set("disabled",this._isFederation?!1:!0)},_fetchSelectedGroups:function(a){var e=this,f=esriGeowConfig.restBaseUrl+"community/groups",d;a&&0<a.length?(c.forEach(a,function(a){d=d?d+(" OR id:"+a):"id:"+a}),d?(a="orgid:"+esriGeowConfig.self.id+" AND ("+d+")",this.pageUtil.fetchAllResources(f,{q:a},"results").then(function(a){e._selectedGroups=e._selectedGroups.concat(a);e._toggleGroups()},function(a){e._selectedGroups=[];e._toggleGroups()})):(e._selectedGroups=
[],e._toggleGroups())):(e._selectedGroups=[],e._toggleGroups())},_toggleGroups:function(){var a=c.clone(this._selectedGroups),e=this._selectedGroups&&0<this._selectedGroups.length,f=e?c.map(a.splice(0,3),function(a){return a.title}):[],d=e?c.map(a,function(a){return a.title}):[];c.attr(this._groupsLabel,"innerHTML",e?this.i18n.groupsSelected:this.i18n.noGroupsSelected);c.attr(this._groupListContainer,"innerHTML",f.join(", "));this.pageUtil[e?"showNode":"hideNode"](this._groupListContainer);this.pageUtil[0<
a.length?"showNode":"hideNode"](this._otherLinkContainer);0<a.length&&(this._otherLinkTooltip&&this._otherLinkTooltip.destroyRecursive(),this._otherLinkTooltip=arcgisonline.pages.utils.tooltips.createTooltip(this.id+"-other-link",d.join(",\x3cbr\x3e"),200,400))},_setupTooltips:function(){this._tooltips&&0===this._tooltips.length&&this._tooltips.push(arcgisonline.pages.utils.tooltips.createTooltip(this.id+"-noLimitTooltip-"+this.baseClass,this.i18n.orgLimit,200,300))},clear:function(){l.byId("set-identity-provider-dialog").set("title",
this.i18n.setIdentityProviderTitle);var a=this.util.isPortal()||!1===esriGeowConfig.isMultiTenant;a?(c.attr(this._description,"innerHTML",this.i18n.setIdentityProviderDescPortal),this._logoutUrlInput.set("title",this.i18n.logoutUrlTooltipPortal),c.attr(this._inviteOptionLabel,"innerHTML",this.i18n.onAddOption)):(c.attr(this._description,"innerHTML",this.i18n.setIdentityProviderDesc),this._logoutUrlInput.set("title",this.i18n.logoutUrlTooltip),c.attr(this._inviteOptionLabel,"innerHTML",this.i18n.onInviteOption));
this._nameInput.set("placeHolder",this._isFederation?this.i18n.federationNamePlaceholder:this.i18n.namePlaceHolder);this._bindingUrlInput.set("placeHolder",this.i18n.metadataUrlPlaceHolder);this._loginUrlInput.set("placeHolder",this.i18n.parametersUrlPlaceHolder);this._loginUrlPostInput.set("placeHolder",this.i18n.parametersUrlPostPlaceHolder);this._logoutUrlInput.set("placeHolder",this.i18n.logoutUrlPlaceHolder);this._entityIDInput.set("placeHolder","");this._federationDiscoveryServiceUrl.set("placeHolder",
this.i18n.federationDiscoveryServiceUrlPlaceholder);this._metadataAggregateUrl.set("placeHolder",this.i18n.metadataAggregateUrlPlaceholder);this._inviteOption.set("checked",!0);c.style(this._roleOptions,"display","none");c.style(this._creditOptions,"display","none");c.style(this._groupOptions,"display","none");c.style(this._esriAccessOptions,"display","none");esriGeowConfig.userLicenseLevelsEnabled&&!a?(c.attr(this._level1Img,"innerHTML",this.util.getLevelSpan(this.i18n.levelLabel,this.LICENSE_LEVELS.ONE)),
c.attr(this._level2Img,"innerHTML",this.util.getLevelSpan(this.i18n.levelLabel,this.LICENSE_LEVELS.TWO)),this._level2Option.set("checked",!0),c.style(this._levelOptions,"display","none")):esriGeowConfig.userLicenseLevelsEnabled&&a&&c.style(this._levelOptions,"display","none");a||(c.attr(this._currentCreditsLabel,"innerHTML",esri.substitute({num:c.number.format(parseInt(esriGeowConfig.self.subscriptionInfo.availableCredits,10))},this.i18n.currentCredits)),this._credits.set("value",""),this._credits.set("displayedValue",
""),this._credits.set("constraints",{pattern:"0.##",min:-1}),this._setUnlimitedRadioBtn.set("checked",!0),this._selectedGroups=[],this._toggleGroups());this._metadataUrlOption.set("checked",!0);this.showMetadataUrlInputs();this.hideAdvancedSettings();this._nameInput.set("value","");this._bindingUrlInput.set("value","");c.attr(this._metadataFileInput,"value","");this._encryptionSupported.set("value",!1);this._signedRequestSupported.set("value",!1);c.style(this._sha256Container,"display","none");this._signUsingSHA256.set("value",
!1);this._logoutRequestSupported.set("value",!1);this._loginUrlInput.set("value","");this._loginUrlPostInput.set("value","");this._certificateInput.set("value","");c.attr(this._certificateFileInput,"value","");this._logoutUrlInput.set("value","");this._updateProfile.set("value","");this._updateGroups.set("checked",!1);this._federationDiscoveryServiceUrl.set("value","");this._metadataAggregateUrl.set("value","");this._aggregatedMetadataCertificate.set("value","");this._esriAccessDisabledOption.set("checked",
!0);c.attr(this._signUpMode,"value","");c.attr(this._bindingType,"value","");c.attr(this._levelSelection,"value","");this._setBtn.set("disabled",!1);this._currentIDP=null;this._isEditing=!1;this._roles=[];this._selectedGroups=[]},loadConnections:function(){c.connect(this._metadataUrlOption,"onClick",c.hitch(this,this.onMetadataUrlOption));c.connect(this._metadataFileOption,"onClick",c.hitch(this,this.onMetadataFileOption));c.connect(this._parametersOption,"onClick",c.hitch(this,this.onParametersOption));
c.connect(this._setBtn,"onClick",c.hitch(this,this.onSetProvider));c.connect(this._cancelBtn,"onClick",c.hitch(this,this.onCancel));c.connect(this._signedRequestSupported,"onClick",c.hitch(this,this.onSignedRequestSupported));esriGeowConfig.userLicenseLevelsEnabled&&(c.connect(this._level1Option,"onClick",c.hitch(this,this.onLevel1Option)),c.connect(this._level2Option,"onClick",c.hitch(this,this.onLevel2Option)));c.connect(this._specifyGroupsBtn,"onClick",c.hitch(this,this.onSpecifyGroups))},hide:function(){l.byId("set-identity-provider-dialog").hide()},
showMetadataUrlInputs:function(){c.style(this._metadataFileInputs,"display","none");c.style(this._parametersInputs,"display","none");c.style(this._metadataUrlInputs,"display","");c.attr(this._bindingType,"value","")},showMetadataFileInputs:function(){c.style(this._metadataUrlInputs,"display","none");c.style(this._parametersInputs,"display","none");c.style(this._metadataFileInputs,"display","");c.attr(this._bindingType,"value","")},showParametersInputs:function(){c.style(this._metadataUrlInputs,"display",
"none");c.style(this._metadataFileInputs,"display","none");c.style(this._parametersInputs,"display","")},showAdvancedSettings:function(){c.attr(this._toggleAdvancedSettings,"innerHTML",this.i18n.hideAdvancedSettings);c.style(this._advancedSettings,"display","");this._showingAdvancedSettings=!0},hideAdvancedSettings:function(){c.attr(this._toggleAdvancedSettings,"innerHTML",this.i18n.showAdvancedSettings);c.style(this._advancedSettings,"display","none");this._showingAdvancedSettings=!1},validParameters:function(){var a=
this.i18n.noticeLabel,e=this._nameInput.get("value");if(!esri.isDefined(e)||0===e.length)return arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:a,message:this.i18n.errors.nameRequired}),!1;if(!this._isFederation){var e=this._metadataUrlOption.get("checked"),f=this._bindingUrlInput.get("value");if(e&&(!esri.isDefined(f)||0===f.length))return arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:a,
message:this.i18n.errors.metadataUrlMustBeSet}),!1;e=this._metadataFileOption.get("checked");f=c.attr(this._metadataFileInput,"value");if(e&&(!esri.isDefined(f)||0===f.length))return dlg.show({title:a,message:this.i18n.errors.metadataFileMustBeSet}),!1;if(this._parametersOption.get("checked")){e=this._loginUrlInput.get("value");if(!esri.isDefined(e)||0===e.length)return arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:a,message:this.i18n.errors.loginUrlMustBeSet}),
!1;e=this._loginUrlPostInput.get("value");if(!esri.isDefined(e)||0===e.length)return arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:a,message:this.i18n.errors.loginUrlPostMustBeSet}),!1;e=this._certificateInput.get("value");if(!esri.isDefined(e)||0===e.length)return arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:a,message:this.i18n.errors.certificateMustBeSet}),!1}}return!0},onAutomaticClicked:function(){var a=
esriGeowConfig.self.creditAssignments&&"enabled"===esriGeowConfig.self.creditAssignments;c.style(this._roleOptions,"display",this._isPortal?"none":"");c.style(this._creditOptions,"display",this._isPortal||!a?"none":"");c.style(this._groupOptions,"display",this._isPortal?"none":"");c.style(this._esriAccessOptions,"display",this._isPortal?"none":"");esriGeowConfig.userLicenseLevelsEnabled&&!this._isPortal&&c.style(this._levelOptions,"display","")},onInvitationClicked:function(){c.style(this._roleOptions,
"display","none");c.style(this._creditOptions,"display","none");c.style(this._groupOptions,"display","none");c.style(this._levelOptions,"display","none");c.style(this._esriAccessOptions,"display","none")},onMetadataUrlOption:function(){this.showMetadataUrlInputs()},onMetadataFileOption:function(){this.showMetadataFileInputs()},onParametersOption:function(){this.showParametersInputs()},onToggleAdvancedSettings:function(){this._showingAdvancedSettings?this.hideAdvancedSettings():this.showAdvancedSettings()},
onLevel1Option:function(){var a=this._level1Option.get("checked"),c=this._roleSelect.get("value");a&&(this._filterRoles(!0),this._coreRoleSelected(c)&&this._roleSelect.set("value",this.SYSTEM_ROLES.VIEWER))},onLevel2Option:function(){var a=this._level2Option.get("checked"),c=this._roleSelect.get("value");a&&(this._filterRoles(),this._roleSelect.set("value",c))},onSpecifyGroups:function(){var a=this,e=document.createDocumentFragment();c.create("div",{innerHTML:a.i18n.selectGroups},e);var f=new arcgisonline.sharing.dijit.GroupSelector({id:"socialLoginsGroupSelector",
selectedGroups:c.clone(a._selectedGroups)},c.create("div",{},e)),d=c.create("div",{style:{"float":"right",margin:"0.5em 0 0.5em 0"}},e),b=new l.form.Button({label:a.i18n.selectLabel,type:"button","class":"primary"},c.create("button",{},d)),d=new l.form.Button({label:a.i18n.cancel,type:"button","class":"calcite transparent"},c.create("button",{},d));a._groupsDialog=(new l.Dialog).placeAt(document.body);a._groupsDialog.set({title:a.i18n.specifyGroups,style:{width:"600px"},content:e});a._groupsDialog.show();
c.on.once(b,"click",function(){var b=f.get("value");a._groupsDialog.hide();a._selectedGroups=b;a._toggleGroups()});c.on.once(d,"click",function(){a._groupsDialog.hide()});c.on.once(a._groupsDialog,"hide",function(){a._groupsDialog.destroyRecursive();a._groupsDialog=null})},onSetProvider:function(a){a.preventDefault();a=esriGeowConfig.self.creditAssignments&&"enabled"===esriGeowConfig.self.creditAssignments;this._setBtn.set("disabled",!0);if(this.validParameters()){9>c.isIE&&(this._form.encoding="multipart/form-data");
if(this._automaticOption.get("checked")){c.attr(this._signUpMode,"value",this.SIGN_UP_MODE_AUTOMATIC);var e=this._roleSelect.get("value");c.attr(this._roleSelection,"value",e)}else c.attr(this._signUpMode,"value",this.SIGN_UP_MODE_INVITE),c.attr(this._roleSelection,"value","");esriGeowConfig.userLicenseLevelsEnabled&&!this._isPortal&&c.attr(this._levelSelection,"value",this._level1Option.get("checked")?this.LICENSE_LEVELS.ONE:this.LICENSE_LEVELS.TWO);c.attr(this._supportEncryption,"value",this._encryptionSupported.get("checked"));
c.attr(this._supportSignedRequest,"value",this._signedRequestSupported.get("checked"));c.attr(this._useSHA256,"value",this._signedRequestSupported.get("checked")&&this._signUsingSHA256.get("checked"));c.attr(this._supportsLogoutRequest,"value",this._logoutRequestSupported.get("checked"));c.attr(this._updateProfileAtSignIn,"value",this._updateProfile.get("checked"));c.attr(this._updateGroupsAtSignIn,"value",this._updateGroups.get("checked"));if(!this._isPortal){if(a)if(this._setUnlimitedRadioBtn.get("checked"))c.attr(this._userCreditAssignment,
"value",-1);else{try{var f=this._credits.get("value"),d=c.number.parse(f),d=isNaN(d)?parseFloat(f):d}catch(b){d=-1}c.attr(this._userCreditAssignment,"value",d)}f=c.map(this._selectedGroups,function(a){return a.id});c.attr(this._groups,"value",f&&0<f.length?f.join(","):"");c.attr(this._userType,"value",this._esriAccessEnabledOption.get("checked")?"both":"arcgisonly")}this._metadataUrlOption.get("checked")?(c.attr(this._metadataFileInput,"value",""),this._loginUrlInput.set("value",""),c.attr(this._bindingType,
"value",""),this._certificateInput.set("value",""),c.attr(this._certificateFileInput,"value","")):this._metadataFileOption.get("checked")?(this._bindingUrlInput.set("value",""),this._loginUrlInput.set("value",""),c.attr(this._bindingType,"value",""),this._certificateInput.set("value",""),c.attr(this._certificateFileInput,"value","")):(this._bindingUrlInput.set("value",""),c.attr(this._metadataFileInput,"value",""),c.attr(this._bindingType,"value",this.BINDING_TYPE_REDIRECT));f=esriGeowConfig.restBaseUrl+
"portals/self/idp/";this._isEditing?(f+=(this._isFederation?"federation/":"")+this._currentIDP.id+"/update",c.attr(this._clearEmptyFields,"value",!0)):(f+=(this._isFederation?"federation/":"")+"register",c.attr(this._clearEmptyFields,"value",!1));this.util.request({url:f,form:this._form},{usePost:!0}).then(c.hitch(this,function(a){esri.isDefined(a)&&!esri.isDefined(a.error)&&(this._setBtn.set("disabled",!1),c.publish("setIdentityProvider",[]),this.hide())}),c.hitch(this,function(a){var b;esri.isDefined(a.messageCode)?
(b=this.i18n.errors[a.messageCode],esri.isDefined(a.details)&&esri.isDefined(a.details[0])&&(b=esri.substitute({details:a.details[0]},b))):b=this._isEditing?this.i18n.errors.unableToUpdateIdentityProvider:this.i18n.errors.unableToSetIdentityProvider;arcgisonline.pages.pageUtil.createSpecifiedDialog(arcgisonline.sharing.dijit.dialog.GeneralDlg).show({title:this.i18n.errorLabel,message:b});this._setBtn.set("disabled",!1)}))}else this._setBtn.set("disabled",!1)},onSignedRequestSupported:function(a){this._signedRequestSupported.get("checked")?
c.style(this._sha256Container,"display",""):(this._signUsingSHA256.set("checked",!1),c.style(this._sha256Container,"display","none"))},onSubmit:function(){return!1},onCancel:function(a){a.preventDefault();this.hide()},onHide:function(){}})})},"arcgisonline/sharing/dijit/dialog/SharingDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/dijit/ShareOptions"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.SharingDlg");
c.require("dijit.Dialog");c.require("dijit._Widget");c.require("dijit._Templated");c.require("arcgisonline.sharing.dijit.ShareOptions");c.declare("arcgisonline.sharing.dijit.dialog.SharingDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_shareDialog" id\x3d"share-dialog" title\x3d"${i18n.sharingDlgTitle}" execute\x3d""\x3e\r\n    \x3clabel class\x3d"trailer-half"\x3e${i18n.shareItemsLabel}\x3c/label\x3e\r\n    \x3cdiv dojotype\x3d"arcgisonline.sharing.dijit.ShareOptions" dojoAttachPoint\x3d"_shareOptions"\x3e\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cp class\x3d"trailer-half font-size--1"\x3e\r\n        ${i18n.settingsMsg}\r\n      \x3c/p\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_shareNoGroupsDiv" style\x3d"display:none;" class\x3d"alert alert-yellow trailer-half is-active"\x3e\r\n        ${i18n.notAMemberMsg}\r\n      \x3c/div\x3e\r\n      \x3cdiv dojoAttachPoint\x3d"_shareOwnerNoneDiv" style\x3d"display:none;" class\x3d"alert alert-yellow trailer-half is-active"\x3e\r\n        ${i18n.notOwnerMsg}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_editableLayerMsg" class\x3d"label-yellow hide js-sharing-help"\x3e\r\n        ${i18n.layerIsEditable} \x3ca href\x3d"${_helpLink}" target\x3d"_blank"\x3e${i18n.learnHow}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_premiumContentMsg" class\x3d"label-yellow hide js-premium-help"\x3e\r\n      ${i18n.premiumLayerMsg} \x3ca href\x3d"${_helpLinkPremium}" target\x3d"_blank"\x3e${i18n.premiumLayerMsgLearnMore}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing right clearfix share-action-bar leader-half" style\x3d"padding-bottom:1em;"\x3e\r\n      \x3cspan class\x3d"disabled padding-right-1" style\x3d"display:none;"\x3e${i18n.sharingItems}\x3c/span\x3e\r\n      \x3cbutton id\x3d"button_share-cancel" class\x3d"jevent cancel" type\x3d"cancel" dojotype\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleCancelClick"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"jevent primary" dojotype\x3d"dijit.form.Button"  dojoAttachEvent\x3d"onClick:_handleOkResponse"\x3e\r\n        ${i18n.ok}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
i18n:null,_shareDialog:null,_shareOptions:null,_shareNoGroupsDiv:null,_shareOwnerNoneDiv:null,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.SharingDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").sharingDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline",
"arcgisonline").shareCheckDlg);c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").shareMapDlg);this._helpLink=esriGeowConfig.helpBase+esriGeowConfig.helpMap["120001067"];this._helpLinkPremium=esriGeowConfig.helpBase+esriGeowConfig.helpMap["120001307"];this._handles=[]},postCreate:function(){this.loadConnections()},destroy:function(){c.forEach(this._handles,"item.remove();");this._shareDialog.destroyRecursive();this._shareDialog=null;this.inherited(arguments)},_setDisabledAttr:function(a){c.forEach(l.registry.findWidgets(this._shareDialog.domNode),
function(c){c.set("disabled",a)});c.query("input").forEach(function(e){c.attr(e,"disabled",a)});c.query(".disabled").forEach(function(e){c.style(e,"display",a?"":"none")})},loadConnections:function(){c.connect(this._shareDialog,"hide",c.hitch(this,function(a){(a=a&&a.target)&&c.hasClass(a,"dijitDialogCloseIcon")&&(this.isCancelled=!0);this.set("disabled",!1);this._shareOptions.clear()}));this._handles.push(c.subscribe("shareOptionsSetup",c.hitch(this,function(){this._shareDialog.show()})));this._handles.push(c.subscribe("onShareUpdate",
c.hitch(this,function(a){this.set("disabled",!1);a&&a.length&&"string"!==typeof a||this._shareDialog.hide()})));this._handles.push(c.subscribe("doesNotOwnGroups",c.hitch(this,function(){c.style(this._shareOwnerNoneDiv,"display","block")})));this._handles.push(c.subscribe("notMemberOfAnyGroups",c.hitch(this,function(){c.style(this._shareNoGroupsDiv,"display","block")})))},_handleOkResponse:function(a){a.preventDefault();this.set("disabled",!0);this._shareOptions.share(a)},_handleCancelClick:function(a){a.preventDefault();
this.isCancelled=!0;this._shareDialog.hide()},hide:function(){this._shareDialog.hide()},show:function(a,c,f,d){this._shareOptions.show(a,c,f,d)},showAdmin:function(a,c,f,d){this._shareOptions.showAdmin(a,c,f,d)},showGroups:function(a,c){this._shareOptions.showGroups(a,c)}})})},"arcgisonline/sharing/dijit/dialog/TagsDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dijit/Dialog,dijit/form/MultiSelect,dijit/form/SimpleTextarea,arcgisonline/sharing/geow/Content"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.TagsDlg");c.require("dijit._Widget");c.require("dijit._Templated");c.require("dijit.Dialog");c.require("dijit.form.MultiSelect");c.require("dijit.form.SimpleTextarea");c.require("arcgisonline.sharing.geow.Content");c.declare("arcgisonline.sharing.dijit.dialog.TagsDlg",[l._Widget,l._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent" \x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_tagsDialog" dojoAttachPoint\x3d"onHide:clear" title\x3d"${i18n.tagDlgTitle}" class\x3d"tagsForm"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_tagsErrorDiv"\x3e\x3c/div\x3e\r\n\t\x3cdiv dojoAttachPoint\x3d"_contentTagsDiv" style\x3d"display:block;"\x3e\r\n\t\t\x3clabel \x3e${i18n.selectTag}\x3c/label\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cbr /\x3e\r\n\t    \x3cselect dojoAttachPoint\x3d"_tagsSelect" dojoType\x3d"dijit.form.MultiSelect" style\x3d"width:100%;height:150px;"\x3e\x3c/select\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cdiv dojoAttachPoint\x3d"_cancelBtn" dojotype\x3d"dijit.form.Button" class\x3d"cancel" dojoAttachEvent\x3d"onClick:_handleCancelClick" style\x3d"float:right;"\x3e${i18n.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv dojoAttachPoint\x3d"_submitBtn" dojotype\x3d"dijit.form.Button" class\x3d"primary" type\x3d"submit" dojoAttachEvent\x3d"onClick:getSelectedTags" style\x3d"float:right;"\x3e${i18n.useSelected}\x3c/div\x3e  \r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv dojoAttachPoint\x3d"_contentNoTagsDiv" style\x3d"display:none;"\x3e\r\n\t\t\x3clabel\x3e${i18n.tagsNotAvailable}\x3c/label\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cbr /\x3e\r\n\t\t\x3cdiv id\x3d"button_tags-ok" dojoAttachPoint\x3d"_okBtn" dojotype\x3d"dijit.form.Button" class\x3d"primary" dojoAttachEvent\x3d"onClick:_handleCancelClick" style\x3d"float:right;"\x3e${i18n.ok}\x3c/div\x3e\r\n\t\t\x3cbr/\x3e\r\n\t\t\x3cbr/\x3e\r\n\t\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
_tagsDialog:null,_contentTagsDiv:null,_contentNoTagsDiv:null,_tagsSelect:null,i18n:null,statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.TagsDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").tagsDlg)},postCreate:function(){},_handleCancelClick:function(a){a.preventDefault();
this._tagsDialog.hide()},clear:function(){this._tagsSelect.reset();c.style(this._contentTagsDiv,"display","none");c.style(this._contentNoTagsDiv,"display","none")},hide:function(){this._tagsDialog.hide()},show:function(a){this.clear();var e=arcgisonline.sharing.util.getUser(),f=esriGeowConfig.restBaseUrl+"community/users/",f=a&&(a.username||a.email)?f+(a.username?a.username:a.email):f+e.email;arcgisonline.sharing.util.getJson(f+"/tags",c.hitch(this,this._handleTagResponse),c.hitch(this,this._handleError));
this._tagsDialog.show()},_handleTagResponse:function(a){0==a.tags.length?c.style(this._contentNoTagsDiv,"display",""):(c.style(this._contentTagsDiv,"display",""),c.empty(this._tagsSelect.domNode),c.forEach(a.tags,function(a){c.create("option",{innerHTML:a.tag,value:a.tag},this._tagsSelect.domNode)},this))},_handleError:function(a){},getSelectedTags:function(a){a.preventDefault();a=[];a=this._tagsSelect.get("value");c.publish("onSelectedTagsUpdate",[a.toString()])}})})},"arcgisonline/sharing/dijit/dialog/UpdateItemDlg":function(){define(["dojo",
"dijit","dojox","dojo/require!dijit/form/SimpleTextarea,dijit/form/TextBox,dijit/form/CheckBox,dijit/form/Button,dijit/InlineEditBox,dijit/Dialog,dijit/_Widget,dijit/_Templated,arcgisonline/sharing/util,arcgisonline/sharing/geow/Community,arcgisonline/sharing/geow/Content,arcgisonline/sharing/geow/Item,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/TagsDlg,dojo/promise/all,dojo/number"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.UpdateItemDlg");c.require("dijit.form.SimpleTextarea");
c.require("dijit.form.TextBox");c.require("dijit.form.CheckBox");c.require("dijit.form.Button");c.require("dijit.InlineEditBox");c.require("dijit.Dialog");c.require("dijit._Widget");c.require("dijit._Templated");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.geow.Community");c.require("arcgisonline.sharing.geow.Content");c.require("arcgisonline.sharing.geow.Item");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit.dialog.TagsDlg");
c.require("dojo.promise.all");c.require("dojo.number");c.declare("arcgisonline.sharing.dijit.dialog.UpdateItemDlg",[l._Widget,l._Templated],{util:arcgisonline.sharing.util,community:arcgisonline.sharing.geow.Community,content:arcgisonline.sharing.geow.Content,itemAPI:arcgisonline.sharing.geow.Item,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"_updateItemDialog" title\x3d"${i18n.updateItem}" dojoAttachEvent\x3d"hide:clear" execute\x3d"" style\x3d"width:520px;"\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"_errorDiv"\x3e\x3c/div\x3e\r\n    \x3cform dojoAttachPoint\x3d"_updateItemForm" enctype\x3d"multipart/form-data"\x3e\r\n      \x3cdiv dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemFolderInput" type\x3d"hidden" value\x3d"0"\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"id" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemIdInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"name" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemNameInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"title" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemTitleInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"tags" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemTagsInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"type" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemTypeInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"typeKeywords" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateItemKeywordsInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"description" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateDescriptionInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"snippet" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateSnippetInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"accessInformation" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateAccessInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"licenseInfo" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateLicenseInfoInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"extent" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateExtentInput" type\x3d"hidden" value\x3d""\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"overwrite" dojotype\x3d"dijit.form.TextBox" dojoAttachPoint\x3d"_updateOverwriteInput" type\x3d"hidden" value\x3d"true"\x3e\x3c/div\x3e\r\n      \x3cdiv name\x3d"async" dojotype\x3d"dijit.form.TextBox" type\x3d"hidden" dojoAttachPoint\x3d"_updateAsyncInput" value\x3d"true"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv\x3e\x3clabel class\x3d"font-size--1" dojoAttachPoint\x3d"_replaceUpdateVerLabel"\x3e${i18n.replaceUpdatedVersionMsg}\x3c/label\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv style\x3d"padding-top:4px;margin-bottom:1.0em;"\x3e\r\n        \x3clabel class\x3d"esriFloatLeading esriTrailingMargin2" style\x3d"margin-top:6px;" for\x3d"update-item-file"\x3e${i18n.itemLabel}\x3c/label\x3e\r\n        \x3cinput type\x3d"file" dojoAttachPoint\x3d"_updateItemFile" id\x3d"update-item-file" name\x3d"file" size\x3d"40" class\x3d"esriFileInput drag-drop"\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv id\x3d"overwrite_section" class\x3d"hide" style\x3d"padding-top:4px;margin-bottom:1.0em;"\x3e\r\n        \x3cinput id\x3d"overwriteService" type\x3d"checkbox" name\x3d"overwriteService" dojotype\x3d"dijit.form.CheckBox" checked\x3d"checked" dojoAttachPoint\x3d"_overwriteService"/\x3e\r\n        \x3clabel id\x3d"overwriteServiceLbl" for\x3d"overwriteService"\x3e${i18n.overwriteService} ${i18n.keepFieldsSame}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv id\x3d"update-item-keepdescription" style\x3d"width:100%;display:none;"\x3e\r\n        \x3cdiv style\x3d"padding-bottom:5px; padding-top:2px;"\x3e\r\n          \x3clabel\x3e${i18n.updateItemDescription}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"line-height:23px"\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"useDescription" dojotype\x3d"dijit.form.RadioButton" checked\x3d"checked" dojoAttachPoint\x3d"_useDescKeepRadio" id\x3d"useDescription:keep"/\x3e\r\n          \x3clabel for\x3d"useDescription:keep"\x3e${i18n.keepExistingProperties}\x3c/label\x3e\r\n          \x3cinput type\x3d"radio" name\x3d"useDescription" dojotype\x3d"dijit.form.RadioButton" dojoAttachPoint\x3d"_useDescUpdateRadio" id\x3d"useDescription:update"/\x3e\r\n          \x3clabel for\x3d"useDescription:update"\x3e${i18n.useUploadedProperties}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"esriFloatTrailing right leader-half clearfix"\x3e\r\n        \x3cspan dojoAttachPoint\x3d"_waitingSpan" style\x3d"display:none;" class\x3d"padding-right-1"\x3e${i18n.uploadingItemMsg}\x3c/span\x3e\r\n        \x3cbutton dojotype\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:_handleCancel" dojoAttachPoint\x3d"_cancelBtn" id\x3d"button_update-item-cancel" class\x3d"jevent cancel" type\x3d"cancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n        \x3cbutton id\x3d"button_update-item" type\x3d"button" dojotype\x3d"dijit.form.Button" dojoAttachEvent\x3d"onClick:uploadItem" class\x3d"primary" dojoAttachPoint\x3d"_updateItemBtn"\x3e${i18n.updateItem}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
item:null,admin:null,i18n:null,_replaceUpdateVerLabel:null,_updateItemDialog:null,_updateItemForm:null,_updateItemBtn:null,_cancelBtn:null,_waitingSpan:null,_useDescUpdateRadio:null,_useDescKeepRadio:null,_updateItemFile:null,_errorDiv:null,_updateItemFolderInput:null,_updateItemIdInput:null,_updateItemNameInput:null,_updateItemTitleInout:null,_updateItemTagsInput:null,_updateItemTypeInput:null,_updateItemKeywordsInput:null,_updateDescriptonInput:null,_updateSnippetInput:null,_updateAccessInput:null,
_updateLicenseInfoInput:null,_updateExtentInput:null,_updateOverwriteInput:null,_updateAsyncInput:null,statics:{_instance:null,getInstance:function(){null===this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.UpdateItemDlg);return this._instance}},postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline","arcgisonline").updateItemDlg);c.mixin(this.i18n,{updating:c.i18n.getLocalization("arcgisonline",
"arcgisonline").addItemFrm.updating})},postCreate:function(){},show:function(a,e){var f={Shapefile:1,"File Geodatabase":1,GeoJson:1,CSV:1,"Microsoft Excel":1},d=a&&a.publishParameters&&"address"===a.publishParameters.locationType;this.item=a;e&&null!==this.adminUser&&(this.admin=e);"Layer Package"==a.type&&c.style(c.byId("update-item-keepdescription"),"display","block");"Vector Tile Service"===a.type?(c.attr(this._replaceUpdateVerLabel,"innerHTML",this.i18n.overwriteStyle),this._updateItemDialog.set("title",
this.i18n.updateStyle),this._updateItemBtn.set("label",this.i18n.updateStyle)):(this.itemName=this.item.sourceData&&this.item.sourceData.name||this.item.name,c.attr(this._replaceUpdateVerLabel,"innerHTML",c.string.substitute(this.i18n.replaceUpdatedVersionMsg,[this.itemName])));a&&a.type in f&&a.relatedService?this._overwriteService.set("checked",!1):a&&a.sourceData?(this._updateItemDialog.set("title",this.i18n.updateFeatures),this._updateItemBtn.set("label",this.i18n.updateFeatures),e=c.string.substitute(d?
this.i18n.overwriteServiceWithCreditsMsg:this.i18n.overwriteServiceMsg,[a.title,a.sourceData.name]),c.attr(this._replaceUpdateVerLabel,"innerHTML",e)):this._overwriteService.set("checked",!1);a&&a.sourceData&&(esri.hide(this._overwriteService.domNode),c.attr("overwriteServiceLbl","innerHTML",this.i18n.keepFieldsSame),c.removeClass("overwrite_section","hide"));this._updateItemDialog.show()},clear:function(){this._updateItemFile.value="";this._useDescKeepRadio.set("checked",!0);this._useDescUpdateRadio.set("checked",
!1);this._overwriteService.set("checked",!0)},_handleCancel:function(a){a.preventDefault();this._updateItemDialog.hide()},hide:function(){this._disable(!1);this._updateItemDialog.hide()},uploadItem:function(a){a.preventDefault();if(0===this._updateItemFile.value.length)return arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorLabel,message:this.i18n.error.providePath}),!1;a=this._fetchItem(this.item).then(c.hitch(this,"loadFile"));if(this.item.sourceData||
this.item.relatedService&&this._overwriteService.get("checked"))c.attr(this._waitingSpan,"innerHTML",this.i18n.updating),a=a.then(c.hitch(this,"_updateServiceData",this.item.sourceData||this.item)).then(c.hitch(this,"_resetServiceTitle",this.item));return a.then(c.hitch(this,function(a){a&&!a.success&&a.error&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.updateItemErrorTitle,message:a.error.message||this.i18n.error.errorWhileUpdate});a&&a.serviceItemId?
(this._disable(!1),this._updateItemDialog.hide(),window.location="item.html?id\x3d"+a.serviceItemId+(a.jobId?"\x26jobid\x3d"+a.jobId:"")):c.publish("itemData/update",[""]);return!0}),c.hitch(this,function(a){c.isObject(a)&&arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.updateItemErrorTitle,message:a.message||this.i18n.error.errorWhileUpdate});this._disable(!1)}))},_updateServiceData:function(a){var e=new c.Deferred;this._checkStatus(a,500,c.hitch(this,
function(a){var d=esriGeowConfig.restBaseUrl+"content/users/"+a.owner+"/publish",b,f,k={itemid:a.id,filetype:{"file geodatabase":"filegeodatabase",shapefile:"shapefile",geojson:"geojson",csv:"CSV","microsoft excel":"excel"}[a.type.toLowerCase()],overwrite:!0,publishParameters:c.json.stringify({name:this.item.title?this.item.title.replace(/ /g,"_"):a.title.replace(/ /g,"_")})};c.attr(this._waitingSpan,"innerHTML",this.i18n.updating);c.promise.all([this._fetchPublishParameters(this.item),this._fetchServiceInfo(this.item.relatedService||
this.item)]).then(c.hitch(this,function(g){b=g[1];(f=g[0])&&"CSV"===a.type?(g=c.mixin(c.mixin({},b.layers&&b.layers[0]),{fields:f.layerInfo.fields}),k.publishParameters=c.mixin(f,{layerInfo:g,name:f.name||a.title.replace(/ /g,"_")})):f&&"Microsoft Excel"===a.type?(k.publishParameters=this._generateExcelOverwritePublishParameters(f,b),b=null):k.publishParameters={name:a.title?a.title.replace(/ /g,"_"):this.item.title.replace(/ /g,"_")};k.publishParameters=b?c.json.stringify(c.mixin(k.publishParameters,
b)):k.publishParameters;return this.util.request({url:d,content:k},{usePost:!0}).then(c.hitch(this,function(b){e.resolve(b&&b.services&&b.services[0]||{serviceItemId:a.id})}),c.hitch(this,function(a){e.reject(a)}))}))}));return e},_generateExcelOverwritePublishParameters:function(a,c){c.name=a.name;c.sourceSR=a.sourceSR;c.targetSR=a.targetSR;for(var e=0;e<c.tables.length;e++)"Review"!=c.tables[e].name&&(c.layers[c.layers.length]=c.tables[e]);for(e=0;e<c.layers.length;e++)c.layers[e].excelSheetId=
a.layers[e].excelSheetId,c.layers[e].locationType=a.layers[e].locationType,c.layers[e].latitudeFieldName=a.layers[e].latitudeFieldName,c.layers[e].longitudeFieldName=a.layers[e].longitudeFieldName,c.layers[e].geocodeServiceUrl=a.layers[e].geocodeServiceUrl,c.layers[e].sourceLocale=a.layers[e].sourceLocale,c.layers[e].sourceCountry=a.layers[e].sourceCountry,c.layers[e].standardizedFieldNames=a.layers[e].standardizedFieldNames,c.layers[e].addressFields=a.layers[e].addressFields;return JSON.stringify(c)},
_resetServiceTitle:function(a,e){var f=new c.Deferred,d=this.util.getUser(),b=a.title||"",g=a.folderId||a.ownerFolder,d=esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||d.email)+"/"+(g?g+"/":"")+"items/"+a.id+"/update";a=-1!==a.typeKeywords.indexOf("Involved Lookup")?{title:b,typeKeywords:a.typeKeywords.toString()+",showUnmatchedAddresses"}:{title:b};this.util.request({url:d,content:a},{usePost:!0}).then(c.hitch(this,function(){f.resolve(e)}),c.hitch(this,function(){f.resolve(e)}));return f},
_fetchServiceInfo:function(a){a=a.url;var e={addToken:(this.util.isHostedService(a)||this.util.isAgolService(a))&&!1!==esriGeowConfig.isMultiTenant},f=new c.Deferred,d;c.promise.all([this.util.request({url:a},e),this.util.request({url:a+"/layers"},e)]).then(c.hitch(this,function(a){var b={},e=a&&1<a.length&&a[1],m=e&&e.layers,e=e&&e.tables;m&&m.length&&(c.forEach(m,function(a){delete a.fields}),b.layers=m);e&&e.length&&(b.tables=e);d=c.mixin(a[0],b);f.resolve(d)}));return f},_fetchPublishParameters:function(a){var e;
e=esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/info/publishParameters.json";a.publishParameters?(e=new c.Deferred,e.resolve(a.publishParameters)):!a.sourceData||"CSV"!==a.sourceData.type&&"Microsoft Excel"!==a.sourceData.type?(e=new c.Deferred,e.resolve(!1)):e=this.util.request({url:e}).then(c.hitch(this,function(a){return a}));return e},_fetchItem:function(a){var e;a.sourceData?e=this.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+a.sourceData.id}).then(c.hitch(this,function(a){a.folderId=
a.ownerFolder;return a})):(e=new c.Deferred,e.resolve(a));return e},loadFile:function(a){var e=new c.Deferred,f=this._updateItemFile.value,d=f.lastIndexOf("\\"),b=a.type;-1<d&&(f=f.substring(d+1,f.length));f=f.replace(/\ /g,"_");if("Vector Tile Service"!==a.type&&this.itemName!=f)return a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.show({title:this.i18n.errorLabel,message:c.string.substitute(this.i18n.error.sameFileName,[this.itemName])}),this._updateItemFile.value=
"",e.reject(!0),e;if("Vector Tile Service"===a.type){var d=/(?:\.([^.]+))?$/,g=f.replace(/^.*(\\|\/|:)/,"");if("json"!==(f?d.exec(g)[1].toLowerCase():""))return a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),a.show({title:this.i18n.errorLabel,message:this.i18n.error.invalidStyleFileExtension}),this._updateItemFile.value="",e.reject(!0),e}this._disable(!0);f=!0;"Layer Package"==b&&(f=c.byId("useDescription:keep").checked);this._updateItemNameInput.set("value",this.itemName);
this._updateItemTitleInput.set("value",a.title);this._updateItemTagsInput.set("value",a.tags);this._updateItemTypeInput.set("value",b);this._updateItemKeywordsInput.set("value",a.typeKeywords);this._updateAccessInput.set("value",a.accessInformation);this._updateLicenseInfoInput.set("value",a.licenseInfo);this._updateItemFolderInput.set("value",a.folderId);f?(this._updateDescriptionInput.set("value",a.description),this._updateSnippetInput.set("value",a.snippet),this._updateExtentInput.set("value",
a.extent)):(this._updateDescriptionInput.set("value",""),this._updateSnippetInput.set("value",""),this._updateExtentInput.set("value",""));b=function(a,b){!a.success||"completed"!==a.status&&a.status?(b=this.i18n.error.errorWhileUpdate,a&&a.error&&a.error.message&&(b=a.error.message),-1<b.indexOf("The request size is greater than the max allowed of 1024MB")&&(b=this.i18n.error.exceedFileSizeLimit),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.updateItemErrorTitle,
message:b}),e.reject(!0)):e.resolve(!0)};f=function(a){this._disable(!1);e.reject(a)};a&&"Vector Tile Service"===a.type?this._updateItemResource(a,this._updateItemForm).then(c.hitch(this,b),c.hitch(this,f)):this.itemAPI.update.call(this.itemAPI,a,this._updateItemForm,this._updateItemFile.files[0]).then(b.bind(this),f.bind(this));return e},_updateItemResource:function(a,e){var f=this.util.getUser(),d=a.folderId||a.ownerFolder;a={url:esriGeowConfig.restBaseUrl+"content/users/"+(a.owner||f.email)+"/"+
(d?d+"/":"")+"/items/"+a.id+"/updateResources",form:e,content:{resourcesPrefix:"styles",filename:"root.json"}};c.query("input",e).forEach(c.hitch(this,function(a){a&&"file"!==a.name&&c.attr(a,"name","")}));return this.util.request(a,{usePost:!0}).then(c.hitch(this,function(a){return a}),c.hitch(this,function(a){throw{message:this.i18n.error.invalidStyleFile};}))},_checkStatus:function(a,e,f){this.util.request({url:esriGeowConfig.restBaseUrl+"content/users/"+a.owner+(a.ownerFolder&&"/"!==a.ownerFolder?
"/"+a.ownerFolder:"")+"/items/"+a.id+"/status"}).then(c.hitch(this,function(d){d=d||{status:"failed"};"completed"===d.status?f(a):(e=(e||500)+250,setTimeout(c.hitch(this,function(){this._checkStatus(a,e,f)}),e))}))},_disable:function(a){this._updateItemBtn.set("disabled",a);this._cancelBtn.set("disabled",a);c.style(this._waitingSpan,"display",a?"inline-block":"none")}})})},"arcgisonline/sharing/geow/Item":function(){define("dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-form arcgisonline/esriGeowConfig arcgisonline/sharing/util".split(" "),
function(c,l,h,a,e,f){return{addItem:function(a,b,c){return this._action(a,b,c,"addItem")},update:function(a,b,c){return this._action(a,b,c,"update")},_action:function(a,b,c,e){if(f.getUser())return e=this._getActionItemUrl(a,e),a=5242880<c.size?this._multiPartAction(e,b,c,a):this._postForm(e,b)},_multiPartAction:function(a,b,c,e){function d(a){h.reject(a)}function f(a){a.isMultipart=!0;h.resolve(a)}function g(a){this._commitItem(e,b).then(f.bind(this),d.bind(this))}function k(a){this._cancelItem(e);
d.call(this,a)}var h=new l;this._startMultipartRequest(a,e.fileName?e.fileName:c.name).then(function(a){a.success?(e.id=a.id,this._addItemParts(e,c).then(g.bind(this),k.bind(this))):d.call(this,a.error)}.bind(this),d);return h},_postForm:function(a,b){return f.request({url:a,form:b,timeout:0},{usePost:!0})},_startMultipartRequest:function(a,b){return f.request({url:a,content:{multipart:!0,filename:b,async:!0}},{usePost:!0})},_addItemParts:function(a,b){var c=b.size,d=5242880,e=0,f=Math.ceil(c/d),
q=new l,n=0,r=a.fileName?a.fileName:b.name;1E4<f&&(d=Math.floor(c/1E4),f=Math.ceil(c/d));for(;e<f;){var c=e*d,c=b.slice(c,c+d),v={partNum:e+1},u=h.create("form",{enctype:"multipart/form-data"}),u=new FormData(u),w=new l;u.append("file",c,r);this._addPartWithRetries(a,v,u,1,w).then(function(){n++;n===f&&q.resolve()},function(a){q.reject(a)});e++}return q},_addPartWithRetries:function(a,b,e,k,m){var d=this._getActionItemUrl(a,"addPart");b.streamData=!0;f.request({url:d,content:c.mixin({},b,this._requestParams),
form:e,timeout:0}).then(function(a){a.success?m.resolve(a):m.reject(a.error)},function(c){k++;7>=k?this._addPartWithRetries(a,b,e,k,m):m.reject(c)}.bind(this));return m},_commitItem:function(d,b){var e=this._getActionItemUrl(d,"commit");d=b instanceof FormData?{title:d.fileName,type:d.fileType}:c.mixin({},a.toObject(b));return f.request({url:e,content:d},{usePost:!0})},_cancelItem:function(a){a=this._getActionItemUrl(a,"cancel");return f.request({url:a},{usePost:!0})},_getUserUrl:function(a){var b=
f.getUser(),b=b.username||b.email;return e.restBaseUrl+"content/users/"+(a.owner||b)},_getActionItemUrl:function(a,b){var c=this._getUserUrl(a);a.folderId&&(c=c+"/"+a.folderId);return c="addItem"===b?c+"/addItem":c+"/items/"+a.id+"/"+b}}})},"arcgisonline/sharing/dijit/_GalleryFiltersMixin":function(){define(["dojo/_base/declare"],function(){return{rootNodes:{organization:{all:{},maps:{},layers:{},scenes:{},applications:{},tools:{},files:{}},maps:{all:{},imagery:{tags:["imagery"]},basemaps:{tags:["basemap"]},
historical:{tags:["historical"]},demographics:{tags:"demographics"},landscape:{tags:"landscape"},oceans:{tags:"oceans"},earth:{tags:["earth observations"]},urban:{tags:["urban"]},transportation:{tags:["transportation"]},boundariesplaces:{tags:["boundaries"]},storymaps:{tags:["story maps","story map"]}},apps:{configurable:{typekeywords:["Configurable"]},readytouse:{typekeywords:["Ready To Use"]},appbuilder:{typekeywords:["Web AppBuilder for ArcGIS"]}}},imagery:{basemapimagery:{parent:"imagery"},multiimagery:{parent:"imagery"},
temporalimagery:{parent:"imagery"},eventimagery:{parent:"imagery"}},basemaps:{esribasemaps:{parent:"basemaps"},partnerbasemaps:{parent:"basemaps"},userbasemaps:{parent:"basemaps"}},demographics:{income:{parent:"demographics"},spending:{parent:"demographics"},population:{parent:"demographics"},business:{parent:"demographics"},atrisk:{parent:"demographics"}},landscape:{agriculture:{parent:"landscape"},climate:{parent:"landscape"},ecology:{parent:"landscape"},biology:{parent:"landscape"},disturbance:{parent:"landscape"},
elevation:{parent:"landscape"},landcover:{parent:"landscape"},hazards:{parent:"landscape"},soils:{parent:"landscape"},subsurface:{parent:"landscape"},water:{parent:"landscape"}},urban:{threed:{parent:"urban"},movement:{parent:"urban"},parcels:{parent:"urban"},people:{parent:"urban"},planning:{parent:"urban"},publicFilter:{parent:"urban"},work:{parent:"urban"}},transportation:{accessibility:{parent:"transportation"},infrastructure:{parent:"transportation"},logistics:{parent:"transportation"},traffic:{parent:"transportation"},
transit:{parent:"transportation"}},boundariesplaces:{boundaries:{parent:"boundariesplaces"},places:{parent:"boundariesplaces"}},maps:{webmaps:{parent:"maps"},mapfiles:{parent:"maps"}},layers:{weblayers:{parent:"layers"},layerfiles:{parent:"layers"}},applications:{web:{parent:"applications"},mobile:{parent:"applications"},desktop:{parent:"applications"}},weblayers:{features:{parent:"weblayers"},tiles:{parent:"weblayers"},mapimage:{parent:"weblayers"},imagery:{parent:"weblayers"},scenelayers:{parent:"weblayers"},
tables:{parent:"weblayers"}},readytouse:{web:{parent:"readytouse"},ios:{parent:"readytouse"},android:{parent:"readytouse"},windows:{parent:"readytouse"},desktop:{parent:"readytouse"}},configurable:{narrate:{parent:"configurable"},collect:{parent:"configurable"},compare:{parent:"configurable"},"3dscene":{parent:"configurable"},analyze:{parent:"configurable"},present:{parent:"configurable"},social:{parent:"configurable"},local:{parent:"configurable"},route:{parent:"configurable"},showcase:{parent:"configurable"}},
files:{document:{parent:"files"},image:{parent:"files"},pdf:{parent:"files"}},tools:{locators:{parent:"tools"},geodatabase:{parent:"tools"},geometric:{parent:"tools"},geoprocessing:{parent:"tools"},network:{parent:"tools"}},"imagery-root":{tags:["imagery"]},"imagery-basemapimagery":{tags:["baseimagery"]},"imagery-multiimagery":{tags:["multispectral"]},"imagery-temporalimagery":{tags:["temporal"]},"imagery-eventimagery":{tags:["event_imagery"]},"basemaps-root":{tags:["basemap"]},"basemaps-esribasemaps":{tags:["esri_basemap"]},
"basemaps-partnerbasemaps":{tags:["partner_basemap"]},"basemaps-userbasemaps":{tags:["user_basemap"]},"historical-root":{tags:["historical"]},"demographics-root":{tags:["demographics"]},"demographics-income":{tags:["income"]},"demographics-spending":{tags:["spending","behaviors"]},"demographics-population":{tags:["population","housing"]},"demographics-segmentation":{tags:["segmentation"]},"demographics-business":{tags:["business","jobs"]},"demographics-atrisk":{tags:["at risk","poverty"]},"landscape-root":{tags:["landscape"]},
"landscape-agriculture":{tags:["agriculture"]},"landscape-climate":{tags:["climate","weather"]},"landscape-ecology":{tags:["ecology"]},"landscape-biology":{tags:["species"]},"landscape-disturbance":{tags:["disturbance"]},"landscape-elevation":{tags:["elevation"]},"landscape-landcover":{tags:["landcover"]},"landscape-hazards":{tags:["hazards"]},"landscape-soils":{tags:["soils","geology"]},"landscape-subsurface":{tags:["subsurface"]},"landscape-water":{tags:["water"]},"oceans-root":{tags:["oceans"]},
"earth-root":{tags:["earth observations"]},"urban-root":{tags:["urban"]},"urban-threed":{tags:["3D"]},"urban-movement":{tags:["movement"]},"urban-parcels":{tags:["parcels"]},"urban-people":{tags:["people"]},"urban-planning":{tags:["planning"]},"urban-publicFilter":{tags:["public"]},"urban-work":{tags:["work"]},"transportation-root":{tags:["transportation"]},"transportation-accessibility":{tags:["accessibility"]},"transportation-infrastructure":{tags:["infrastructure"]},"transportation-logistics":{tags:["logistics"]},
"transportation-traffic":{tags:["traffic"]},"transportation-transit":{tags:["transit"]},"boundariesplaces-root":{tags:["boundaries"]},"boundariesplaces-boundaries":{tags:["boundaries"]},"boundariesplaces-places":{tags:["places"]},"storymaps-root":{tags:["story maps","story map"]},"scenes-root":{tags:["scenes"]},"readytouse-root":{typekeywords:["Ready To Use"]},"configurable-root":{typekeywords:["Configurable"]},"appbuilder-root":{typekeywords:["Web AppBuilder for ArcGIS"]},"readytouse-web":{typekeywords:["Web Mapping Application"]},
"readytouse-ios":{typekeywords:["ArcGIS for iPhone"]},"readytouse-android":{typekeywords:["ArcGIS for Android"]},"readytouse-windows":{typekeywords:["ArcGIS for Windows Phone"]},"readytouse-desktop":{typekeywords:["Application","Desktop Application"]},"configurable-narrate":{typekeywords:["story"]},"configurable-collect":{typekeywords:["collect"]},"configurable-compare":{typekeywords:["compare"]},"configurable-3dscene":{typekeywords:["3Dscene"]},"configurable-analyze":{typekeywords:["summarize"]},
"configurable-present":{typekeywords:["gallery"]},"configurable-social":{typekeywords:["social"]},"configurable-local":{typekeywords:["local"]},"configurable-route":{typekeywords:["route"]},"configurable-showcase":{typekeywords:["showcase"]},mappings:{"demographics-behaviors":{mappedCategory:"demographics-spending"},"demographics-segmentation":{mappedCategory:"demographics"},"landscape-oceans":{mappedCategory:"oceans"}}}})},"arcgisonline/sharing/dijit/ItemGallery":function(){define("dojo/_base/declare arcgisonline/map/mapUtil dojox/widget/Standby dojo/dom-class dojo/hash dojo/dom-style dojo/topic dojo/on dojo/_base/connect dojo/aspect dojo/dom dojo/io-query dojo/dom-attr dojo/_base/window dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/query dgrid/util/mouse dijit/_WidgetBase dijit/focus dojo/string dojo/store/Memory dojo/store/Observable dojo/store/Cache dojo/_base/Deferred dojo/promise/all dojo/when ../dijit/Grid esri/lang esri/arcgis/Portal ../dijit/_GalleryFiltersMixin ../../pages/item/_Actions dojo/i18n!arcgisonline/nls/arcgisonline dojo/NodeList-dom dojo/NodeList-traverse".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R){esri.i18nBundle=R;var M=c(null,{idProperty:"id",constructor:function(a){c.safeMixin(this,a)},get:function(a,b){return H.PortalUtil.request(this.portalUrl+"content/items/"+a,b).then(function(a){return new H.PortalItem(r.mixin(a,{portal:this.portal}))})},getIdentity:function(a){return a[this.idProperty]},query:function(a,b){a=r.isObject(a)?a:{q:a};b&&(a=r.mixin(a,{num:b.count,start:(b.start||0)+1}),b.sort&&b.sort.length&&
(b=b.sort[0],a=r.mixin(a,{sortField:encodeURIComponent("created"===b.attribute?"uploaded":b.attribute),sortOrder:b.descending?"desc":"asc"})));b=this.portal.queryItems(a).then(function(a){a.results.total=a.total;return a.results});return H.PortalResult(b)}});return c([y],{_account:arcgisonline.sharing.geow.Account,_util:arcgisonline.sharing.util,baseClass:"esriGallery",postMixInProperties:function(){this.inherited(arguments);this._template='\x3cdiv class\x3d"sub-nav"\x3e\x3cdiv class\x3d"container clearfix"\x3e\x3ch1 class\x3d"sub-nav-title"\x3e${i18n.gallery.galleryHeader}\x3c/h1\x3e\x3cdiv id\x3d"nav"\x3e${nav}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"gallery-top-bar"\x3e\x3cdiv id\x3d"gallery-title"\x3e\x3ch2 id\x3d"gallery-title-text"\x3e\x3c/h2\x3e\x3c/div\x3e\x3cdiv id\x3d"gallery-sort"\x3e\x3cp\x3e${i18n.gallery.sortBy}\x3c/p\x3e\x3cselect id\x3d"sortField"\x3e\x3coption value\x3d"modified"\x3e${i18n.gallery.mostRecent}\x3c/option\x3e\x3coption value\x3d"numviews"\x3e${i18n.gallery.mostViewed}\x3c/option \x3e\x3coption value\x3d"avgrating"\x3e${i18n.gallery.highestRated}\x3c/option\x3e\x3coption value\x3d"title"\x3e${i18n.myOrganization.sortFields.title}\x3c/option \x3e\x3coption value\x3d"owner"\x3e${i18n.myOrganization.sortFields.owner}\x3c/option\x3e\x3c/select \x3e\x3ca id\x3d"gallery-view" class\x3d"thumbView selected" href\x3d"#"\x3e\x3c/a\x3e\x3ca id\x3d"details-view" class\x3d"detailView" href\x3d"#"\x3e\x3c/a \x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"gallery"\x3e\x3cdiv id\x3d"gallery-left"\x3e\x3cdiv class\x3d"other"\x3e\x3ch4 id\x3d"filter-title"\x3e\x3c/h4\x3e\x3cul id\x3d"filters" class\x3d"filters"\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv class\x3d"accordion"\x3e\x3ca id\x3d"maps" class\x3d"gallery-switch" href\x3d"#"\x3e${i18n.gallery.maps_esri}\x3cspan\x3e\x3c/span\x3e\x3c/a\x3e\x3cdiv class\x3d"maps-section" style\x3d"display:none;"\x3e\x3ch4 id\x3d"filter-title-maps"\x3e\x3c/h4\x3e\x3cul id\x3d"filters-maps" class\x3d"filters"\x3e\x3c/ul\x3e\x3ch4 class\x3d"featured area"\x3e${i18n.gallery.area}\x3c/h4\x3e\x3cul class\x3d"featured area" id\x3d"areas"\x3e\x3cli\x3e\x3ca id\x3d"all-area" href\x3d"#"\x3e${i18n.gallery.filters.all}\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca id\x3d"world-area" href\x3d"#"\x3e${i18n.gallery.filters.world}\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e\x3ca id\x3d"apps" class\x3d"gallery-switch" href\x3d"#"\x3e${i18n.gallery.apps_esri}\x3cspan\x3e\x3c/span\x3e\x3c/a\x3e\x3cdiv class\x3d"apps-section" style\x3d"display:none;"\x3e\x3ch4 id\x3d"filter-title-apps"\x3e\x3c/h4\x3e\x3cul id\x3d"filters-apps" class\x3d"filters"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e\x3ch4 class\x3d"accordionFooter"\x3e\x3ca id\x3d"search-website" href\x3d"#"\x3e${i18n.gallery.searchWebsite}\x3c/a\x3e ${i18n.gallery.orVisit} \x3ca href\x3d"'+
this._util.getSecureUrl(esriGeowConfig.marketplaceUrl)+'"\x3e${i18n.gallery.marketplace}\x3c/a\x3e\x3c/h4\x3e\x3cimg id\x3d"filter-logo" style\x3d"display:none;" /\x3e\x3c/div\x3e\x3cdiv id\x3d"gallery-right" style\x3d"display:none;"\x3e\x3c/div\x3e\x3c/div\x3e'},postCreate:function(){this.inherited(arguments);esriGeowConfig.sceneViewerEnabled||(delete J.rootNodes.organization.scenes,delete J.weblayers.scenelayers);this._account.getSelf(r.hitch(this,function(b){this._canSearchPublic=b.canSearchPublic;
this._livingAtlasGroupQuery=b.livingAtlasGroupQuery;b.canSearchPublic=!0;this._portal=new H.Portal({url:esriGeowConfig.restBaseUrl,self:b});this._portal.on("load",r.hitch(this,function(c){var d=n.doc.createDocumentFragment(),e,g;if(this._user=this._portal.getPortalUser())this._user.role=esriGeowConfig.userRole||{},this._user.isAdmin=this._user.role&&this._user.role.isBasedOnAdmin&&this._user.role.isBasedOnAdmin();this._orgId=c.user&&c.user.orgId||c.id;this._countryCode=this._portal.isPortal?"all":
b&&b.region||c.user&&c.user.region||c.ipCntryCode||"US";E({regions:this._fetchRegions(),galleryEnabled:this._fetchGalleryEnabled(this._user)}).then(r.hitch(this,function(c){this._regions=c.regions;this._livingAtlasGroupQuery=(this._galleryEnabled=c.galleryEnabled)?this._livingAtlasGroupQuery:null;e=r.mixin({nav:x.substitute(this._createNav(),{i18n:R.gallery})},{i18n:R,organization:{orgName:b.name||R.gallery.esri}});u.place(x.substitute(this._template,e),d,"first");this.domNode.appendChild(d);b.isPortal&&
w(".accordionFooter").forEach(r.hitch(this,function(a){f.set(a,"display","none")}));this._getHashParams();this._loadConnections();this._addArea();this._user?(this._favGroupId=this._user.favGroupId,this._selected="esri"===this._selected?this._livingAtlasGroupQuery?this._selected:"organization":this._selected,a.add(m.byId(this._selected),"is-active"),g="esri"!==this._selected?this._selected:this._type):(this._selected=this._orgId||!this._livingAtlasGroupQuery?"organization":"esri",g=this._orgId||!this._livingAtlasGroupQuery?
"organization":this._type);m.byId("sortField").value=this._sortAttribute;this._createFilters(g);w(".accordion").style("display","esri"===this._selected?"":"none");w(".other").style("display","esri"===this._selected?"none":"");w(".apps-section").style("display","apps"===this._type?"":"none");w(".maps-section").style("display","apps"===this._type?"none":"");this._fetchItems(this._selected).then(r.hitch(this,function(){this._showWhatsNew()}))}))}))}))},_loadConnections:function(){this.own(b(this.domNode,
"#nav:click",r.hitch(this,function(a){a.preventDefault();if(a.target.id){if(a.target.id!==this._selected){var b=m.byId("filters"+("apps"===this._selected||"maps"===this._selected?"-"+this._selected:""));u.empty(b);this._selected=a.target.id;this._selectedFilter="all";this._sortDescending="title"!==this._sortAttribute&&"owner"!==this._sortAttribute}this._grid._closePopup();w("a",m.byId("nav")).removeClass("is-active");w(a.target.parentNode,this.domNode).addClass("is-active");w(a.target,this.domNode).addClass("is-active");
w(".accordion").style("display","esri"===this._selected?"":"none");w(".other").style("display","esri"===this._selected?"none":"");this._createFilters("esri"!==this._selected?this._selected:this._type);this._grid._grid.set("noDataMessage","");this._fetchItems(this._selected,1);w(".accordion").style("display","esri"===this._selected?"":"none");w(".other").style("display","esri"===this._selected?"none":"")}})),b(m.byId("gallery-left"),".gallery-switch:click",r.hitch(this,function(a){a.preventDefault();
this._type=a.target.id||a.target.parentNode.id;this._selectedFilter="apps"===this._type?"configurable":"all";this._createFilters(this._type);w(".apps-section").style("display","apps"===this._type?"":"none");w(".maps-section").style("display","apps"===this._type?"none":"");this._fetchItems("esri",1)})),b(m.byId("gallery-left"),".filters:click, .esrifeatured:click",r.hitch(this,function(b){b.preventDefault();var c=b.target;if(!c||"A"===c.tagName){w(".filters a, .esrifeatured a",m.byId("gallery-left")).removeClass("selected");
a.add(c,"selected");w(".filters .expanded",m.byId("gallery-left")).removeClass("expanded").style("display","none");if("by_esri"!==c.id&&"most_recent"!==c.id){var d=b.target.id.split("-");b=v.map(d,function(){var a=".filters #"+d.join("-");d.splice(-1,1);return a});w(b.join(", ")).siblings("ul").forEach(function(b){f.set(b,"display","block");a.add(b,"expanded")})}this._selectedFilter=c.id;this._fetchItems(this._selected,1)}})),b(m.byId("gallery-left"),"#areas:click",r.hitch(this,function(b){b.preventDefault();
w("#areas a",m.byId("gallery-left")).removeClass("selected");a.add(b.target,"selected");this._area=b.target.id.split("-area")[0];this._fetchItems("esri",1)})),b(m.byId("gallery-sort"),"a:click",r.hitch(this,function(b){b.preventDefault();w("a",m.byId("gallery-sort")).removeClass("selected");a.add(b.target,"selected");this._page=1;this._grid.set("view",b.target.id.split("-")[0]);this._grid.refresh()})),b(m.byId("sortField"),"change",r.hitch(this,function(a){this._sortAttribute=a=a.target.options[a.target.selectedIndex].value;
this._sortDescending="title"!==a&&"owner"!==a;this._fetchItems(this._selected,1)})),b(m.byId("search-website"),"click",r.hitch(this,function(a){a.preventDefault();C.focus(m.byId("search-box"))})),b(this.domNode,"touchstart",r.hitch(this,function(){this._grid._closePopup()})))},_showWhatsNew:function(){!this._portal.isPortal&&this._user&&L.whatsNew(r.mixin({},R.whatsNew.galleryPage,{endDate:new Date("July 31, 2017"),key:"galleryPage"}))},_addArea:function(){var a=this._countryCode,b='\x3ca href\x3d"#" id\x3d"'+
a+'-area"\x3e'+this._regions[a]+"\x3c/a\x3e";"WO"!==a&&u.create("li",{innerHTML:b},m.byId("areas"),1)},_createGrid:function(){var a={noDataMessage:"",view:"gallery",portal:this.portal,store:new z(new M({portal:this._portal})),query:this._currentFilter||"",sort:[{attribute:this._sortAttribute,descending:this._sortDescending}],pagingLinks:2,selectionMode:"none",rowsPerPage:12};this._grid=new O(a,u.create("div",{},m.byId("gallery-right")));f.set(m.byId("gallery-right"),"display","");this.own(this._grid.on("refresh",
r.hitch(this,function(a){this._img_connect&&(this._img_connect.remove(),this._img_connect_error.remove(),this._img_connect_error=this._img_connect=null);this._img_connect=w(".grid-item-thumb",this._grid._grid.domNode).on("load",r.hitch(this,function(a){(a=this._grid._grid.row(a))&&a.element&&w(".grid-item",a.element).addClass("fadeIn").style("opacity","1")}));this._img_connect_error=w("img",this._grid._grid.domNode).on("error",r.hitch(this,function(a){q.set(a.target,"src",this._util.getStaticImagesUrl()+
"/desktopapp.png")}))})),k.before(this._grid._grid,"gotoPage",r.hitch(this,function(a){this._isStarting||(this._page=a,this._setHashParams());this._isStarting=!1})))},_createFilters:function(b){var c=J.rootNodes[b],d,e,g,k=R.gallery.filters,n,p,h="apps"===b||"maps"===b?"-"+b:"";esriGeowConfig.webAppBuilderEnabled&&this._user&&(this._user.accountId||this._user.orgId)||delete c.appbuilder;n=m.byId("filters"+h);u.empty(n);for(d in c)for(e in p=u.create("li",{innerHTML:"\x3ca id\x3d'"+d+"'  href\x3d'#'\x3e"+
k[d.split("_")[0]]+"\x3c/a\x3e"},n),c=u.create("ul",{style:{display:"none"}},p),J[d])if(p=u.create("li",{innerHTML:"\x3ca id\x3d'"+d+"-"+e+"' href\x3d'#'\x3e"+k[e]+"\x3c/a\x3e"},c),J[e])for(g in p=u.create("ul",{className:"inner-menu",style:{display:"none"}},p),J[e])u.create("li",{innerHTML:"\x3ca id\x3d'"+d+"-"+e+"-"+g+"' href\x3d'#'\x3e"+k[g]+"\x3c/a\x3e"},p);q.set("filter-title"+h,"innerHTML",R.searchPage.show);d="organization"===this._selected?this._portal.thumbnail&&0<this._portal.thumbnail.length?
this._portal.thumbnailUrl:null:this._util.relativeToExplicitUrl("images/logo-pod.jpg");"de"===dojoConfig.locale.toLowerCase()&&"organization"===this._selected?q.set("gallery-title-text","innerHTML",R.gallery.featuredContent+" "+(this._portal.name||this._portal.portalName)):q.set("gallery-title-text","innerHTML","organization"===this._selected?(this._portal.name||this._portal.portalName)+" "+R.gallery.featuredContent:R.gallery["maps"===b?"featuredMapsEsri":"featuredAppsEsri"]);d&&q.set("filter-logo",
"src",d);w(".filters .expanded",m.byId("gallery-left")).removeClass("expanded").style("display","none");var r=this._selectedFilter.split("-");e=v.map(r,function(){var a=".filters #"+r.join("-");r.splice(-1);return a});w(e.join(", ")).siblings("ul").forEach(function(b){f.set(b,"display","block");a.add(b,"expanded")});w(".featured",m.byId("gallery-left")).style("display","esri"===this._selected?"":"none");w(".area",m.byId("gallery-left")).style("display","maps"!==b||this._portal.isPortal?"none":"");
w(".filters #"+this._selectedFilter).addClass("selected");w("#"+this._selectedFilter).addClass("selected");"esri"===this._selected&&(a.remove(m.byId("maps"===this._type?"apps":"maps"),"active"),a.add(m.byId(this._type),"active"),a.add(m.byId(this._area+"-area"),"selected"),"apps"!==this._type||this._selectedFilter&&"all"!==this._selectedFilter||m.byId("configurable").click());w(".gallery-switch",this.domNode).style("display","organization"!==b?"":"none");w("#filter-logo",this.domNode).style("display",
d?"":"none");w("#gallery-title-text",this.domNode).style("display","")},_createNav:function(){if(this._user){var a='\x3cdiv class\x3d"sub-nav-list"\x3e',b=esriGeowConfig.userRole&&esriGeowConfig.userRole.isCustom();!b||b&&esriGeowConfig.userRole.canShareItemToGroup();this._user&&this._user.orgId&&(a+='\x3ca id\x3d"organization" href\x3d"#" class\x3d"sub-nav-link"\x3e${i18n.featuredOrg}\x3c/a\x3e')}else return"";this._livingAtlasGroupQuery&&(a+='\x3ca id\x3d"esri" href\x3d"#" class\x3d"sub-nav-link"\x3e${i18n.featuredEsri}\x3c/a\x3e');
return a+"\x3c/div\x3e"},_filterContent:function(){var a=this._selectedFilter||"all",b=esriGeowConfig&&esriGeowConfig.filterQueries,c=b&&b[a];c&&(a=b[a]||{},a=a.f||c.f||"all");return"all"===a?"":a},_filterEsriContent:function(){var a=this._type,b=this._selectedFilter,c="apps"!==a?' -type:"Service" AND -type: "Feature Collection" AND -type: "Shapefile" AND -typekeywords: "Package" AND -type: "WMS" AND -type: "Code Attachment" AND -type: "Document Link"':"",d=r.mixin({},J[a+"-"+b]||J[b]||{}),a=[];if(d&&
(d.tags||d.typekeywords))d&&d.tags&&(a=v.map(d.tags,function(a){return'tags:"'+a+'"'})),d&&d.typekeywords&&(a=v.map(d.typekeywords,function(a){return'typekeywords:"'+a+'"'}));else{if("most_recent"===b)return b=new Date,"(uploaded:[000000"+(new Date(b.getTime()-2592E6)).getTime()+"000 TO 000000"+b.getTime()+"000])";if("by_esri"===b)return'(owner:"esri")';d.root={};for(var e in d)(d=J[b+"-"+e])&&d.tags&&(a=a.concat(v.map(d.tags,function(a){return'tags:"'+a+'"'}))),d&&d.typekeywords&&(a=a.concat(v.map(d.typekeywords,
function(a){return'typekeywords:"'+a+'"'})))}a=a&&a.length?"("+a.join(" OR ")+")":"";"readytouse-desktop"===b&&(a+=" -typekeywords:'Web Mapping Application' -typekeywords:'Mobile Application'");!1===this._canSearchPublic&&(a+=' owner:"esri*"');return a+c},_filter:function(a){var b={sort:[{attribute:this._sortAttribute||"modified",descending:this._sortDescending}]},c;c="esri"===this._selected?this._filterEsriContent():this._filterContent();this._setHashParams();this._currentFilter=a&&a.length?a+" "+
c:"";this._grid?this._grid.set("query",this._currentFilter,b):(this._isStarting=!0,this._createGrid());1<this._page?this._grid.gotoPage(parseInt(this._page,10)):this._grid.refresh()},_setHashParams:function(){var a=r.mixin(this._hashParams,{c:this._selected,f:this._selectedFilter,t:this._type,a:this._area,o:this._sortAttribute,page:this._page});"esri"!==this._selected&&(delete a.t,delete a.a);1>=this._page&&delete a.page;for(var b in a)"all"===a[b]&&delete a[b];e(p.objectToQuery(a))},_getHashParams:function(){var a=
this._hashParams=r.mixin({},p.queryToObject(e()));r.mixin(this,{_selected:this._user&&a.c?a.c:this._user&&(this._user.accountId||this._user.orgId)?"organization":"esri",_selectedFilter:a.f&&J.mappings[a.f]?J.mappings[a.f].mappedCategory:a.f||"all",_type:a.t||"maps",_area:"world"!==a.a&&a.a!==this._countryCode?"all":a.a,_sortAttribute:a.o||"modified",_sortDescending:"owner"!==a.o&&"title"!==a.o,_page:a.page||1});"organization"===this._selected&&this._user&&(this._orgId?this._sortAttribute=a.o?this._sortAttribute:
null:(this._selected="esri",this._selectedFilter="all"));"favorites"===this._selected&&(this._selected=this._user&&this._orgId?"organization":"esri",this._selectedFilter="all")},_fetchRegions:function(){var a=new A,b={WORLD:R.countryCodes.WORLD};H.PortalUtil.request(this._portal.portalUrl+"portals/regions",{culture:this._user&&this._user.culture||this._portal&&this._portal.culture||dojoConfig.locale||"en"}).then(function(c){v.forEach(c,function(a){b[a.region]=a.localizedName});a.resolve(b)});return a},
_fetchGalleryEnabled:function(a){var b=new A;!this._portal.isPortal||a&&a.isAdmin?b.resolve(!0):b.resolve(this._livingAtlasGroupQuery?!0:!1);return b},_fetchItems:function(a,b){var c;this._page=b||this._page;switch(a){case "organization":if(this._portal.featuredItemsGroupQuery)return N(this._fetchGroup("orgGroup",{q:this._portal.featuredItemsGroupQuery}),r.hitch(this,function(a){if((c=a?a[0]:null)&&c.id)return this._sortAttribute=this._hashParams.o?this._sortAttribute:c.sortField||"numviews",this._sortDescending=
c&&"asc"!==c.sortOrder||"title"!==this._sortAttribute&&"owner"!==this._sortAttribute,m.byId("sortField").value=this._sortAttribute||"numviews",this._fetchGroupItems('group:"'+c.id+'"',esriGeowConfig.viewQueries.none);this._sortAttribute=this._sortAttribute||"numviews";m.byId("sortField").value=this._sortAttribute;return this._fetchMostRecent(this._orgId)}));this._sortAttribute=this._sortAttribute||"numviews";m.byId("sortField").value=this._sortAttribute;return this._fetchMostRecent(this._orgId);default:return this._fetchEsri(this._type)}},
_fetchEsri:function(a){var b,c=-1<this._selectedFilter.indexOf("configurable");return"maps"===a?this._fetchEsriMaps():"appbuilder"===this._selectedFilter?this._fetchAppBuilder():(c?this._fetchEsriConfigurableApps():this._fetchEsriApps()).then(r.hitch(this,function(a){b=v.map(a||[],function(a){if(a)return'group:"'+a.id+'"'}).join(" OR ");c&&this._user&&(this._user.accountId||this._user.orgId)&&(b+=' OR typekeywords: "appStudioEsri"');return this._fetchGroupItems(b,'-tags:"mature support"')}))},_fetchEsriMaps:function(){var a=
this._area||"all",b=[];return"world"===a||"WO"===a?this._fetchEsriWorldMaps().then(r.hitch(this,function(a){return this._fetchGroupItems('group:"'+a[0].id+'"','-tags:"mature support"')})):"all"===a?E([this._fetchEsriWorldMaps(),this._fetchEsriMapsForArea(this._countryCode)]).then(r.hitch(this,function(a){a=a&&(a[0]||[]).concat(a[1]||[])||[];v.forEach(a,function(a){a&&a.id&&b.push('group:"'+a.id+'"')});return this._fetchGroupItems(b.join(" OR "),'-tags:"mature support"')})):this._fetchEsriMapsForArea(a).then(r.hitch(this,
function(a){v.forEach(a,function(a){a&&a.id&&b.push('group:"'+a.id+'"')});return this._fetchGroupItems(b.join(" OR "),'-tags:"mature support"')}))},_fetchEsriMapsForArea:function(a){var b=new A;if("WO"===a)b.resolve({});else{var c=this._livingAtlasGroupQuery,c="all"===a?c:c.split("OR").pop();N(this._fetchGroup("esriMaps_"+a,c),r.hitch(this,function(a){b.resolve(a)}))}return b},_fetchEsriWorldMaps:function(){var a=new A;N(this._fetchGroup("esriMaps",{q:'title:"Featured Maps And Apps" AND owner:esri'}),
r.hitch(this,function(b){a.resolve(b)}));return a},_fetchEsriConfigurableApps:function(){var a={id:"ind"},b=(this._user&&this._user.culture||this._portal&&this._portal.culture||dojoConfig.locale||"en").split("-")[0].toLowerCase(),c={q:'title:"Gallery Templates" AND owner:"esri_'+(a[b]||b)+'"'};return E([this._fetchGroup("esriGallery_"+b,{q:'title:"Web Application Templates" AND owner:"esri_'+(a[b]||b)+'"'}),this._fetchGroup("esriApps_"+b,c)]).then(r.hitch(this,function(a){return a&&(a[0]||[]).concat(a[1]||
[])||[]}))},_fetchAppBuilder:function(){var a=this._portal.templatesGroupQuery.split("owner:").pop();return this._filter('(owner: "'+a+'")')},_fetchEsriApps:function(){return this._fetchGroup("esriApps",{q:'title:"Featured Apps" AND owner:esri'})},_fetchGroup:function(a,b){this._groups=this._groups||[];return this._groups[a]||this._portal.queryGroups(b).then(r.hitch(this,function(b){b=b&&b.total?b.results:null;return(this._groups[a]=b)||[]}))},_fetchMostRecent:function(a){this._filter("orgid:"+a+
esriGeowConfig.viewQueries.web+esriGeowConfig.viewQueries.none)},_fetchGroupItems:function(a,b){this._filter("("+a+")"+(b?" "+b:""))}})})},"arcgisonline/pages/item/_Actions":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/event dojo/query dojo/on dojo/aspect dojo/dom-attr dojo/io-query dojo/topic dojo/promise/all dojo/Deferred dojo/cookie dojo/json dojo/dom-class dojo/dom-construct dojo/string dijit/registry dijit/Dialog dojo/number dojo/has esri/arcgis/Portal esri/config esri/lang ../pageUtil ../portal/PortalItem ../../esriGeowConfig ../../sharing/util ../../sharing/geow/Content ../../map/utils/getMapCookie ../../sharing/dijit/dialog/SimpleDlg ../../sharing/dijit/dialog/ConfirmDialog ../../sharing/dijit/dialog/AccountMoveToDlg ../../sharing/dijit/dialog/DeleteWarningDlg ../../sharing/dijit/dialog/ExportDlg ../../sharing/dijit/dialog/ExtentDlg ../../sharing/dijit/dialog/GeneralDlg ../../sharing/dijit/dialog/SharingDlg ../../sharing/dijit/dialog/ShareOwnershipDlg ../../sharing/utilShare ../../sharing/dijit/dialog/RateLimiting ../../sharing/dijit/dialog/LayerTimeSettings ../../sharing/dijit/dialog/UpdateItemDlg ../../sharing/dijit/dialog/AddItem ../../sharing/dijit/dialog/PublishTileServiceDlg ../../sharing/dijit/dialog/CreateAppDlg ../../sharing/dijit/ProfilePopup ../../sharing/dijit/dialog/AdvancedOfflineOptionsDlg ../../sharing/dijit/dialog/AttachCodeDlg ../../sharing/dijit/dialog/thumbnailDialogs/ItemThumbnailDlg ../../sharing/dijit/dialog/MoveToFolderDlg ../../sharing/dijit/dialog/OpenMapDlg ../../sharing/dijit/dialog/ManageSceneCache ../../sharing/dijit/AppendData ../../pages/dijit/ReplaceLayer ../../sharing/dijit/dialog/OverwriteFromCloud ../../sharing/dijit/dialog/_CreateItemUtilMixin ./widgets/_metadata ./widgets/typeOptions/mapOptions/httpsUpdate ./widgets/typeOptions/mapOptions/domainUpdate ../utils/setItemUrls ../utils/item ../utils/verified ../serviceUtil dojo/i18n!../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca,V,aa,ba,ea,Y,ha,Z,ga,W,ia,da,ma,ka,ja,pa,la,qa,na,fa,P){return c.mixin(la,{openDefault:function(b){var c=b.evt,e=b.item,f=e.openIn&&e.openIn[0],g="Operation View"===e.type||"Dashboard"===e.type,k="appViewer"===f,m="mapViewer"===f,f=g?null:a(".js-open-"+(k?"url":f)).shift(),n=z.includes(e.types,"is-desktop"),D=z.includes(e.types,"is-download")||z.includes(e.types,"is-pdf")||z.includes(e.types,"is-file");
f?(c=d.get(f,"href"),k?window.open(c):m?this.newMapViewer(b):window.location=c):n?this.openDesktop(b):D?this.download(b):g?(f=a(".js-open-btn").filter(function(a){return a&&0!==a.offsetHeight}).shift(),c=d.get(f,"href"),"Dashboard"===e.type?window.open(c):window.location=c):h.stop(c)},exportData:function(a){var b=a.evt,c=a.item,f=new R;a=a.layerId||d.get(b.currentTarget,"data-layerId");a=B.isDefined(a)?z.findLayer(a,c.layers):c.layers;f.show(c,a,d.get(b.target,"data-type"));e(f,"done",function(a){f.hide().then(dojo.hitch(this,
function(){window.location="item.html?id\x3d"+a.itemId}))})},appendData:function(a){var b=a.evt,c=a.page,f=a.item;a=B.isDefined(a.layerId)?a.layerId:d.get(b.currentTarget,"data-layerId");a=B.isDefined(a)?z.findLayer(a,f.layers):null;var g;g=(new W({item:f,layer:a,layers:a?[a]:f.layers})).show();e(g,"hide",function(a){c._showDataLastUpdated(f);g.destroyRecursive()})},overwriteFromCloud:function(a){var b=a.page.portal;b.getPortalUser();var d=a.item,f=new da;ma.getCloudProviderItemResource(d).then(c.hitch(this,
function(a){f.startup(b,a,d);f.showModal("true")}),c.hitch(this,function(a){this._showError(a)}));e(f,"hide",function(a){f.destroyRecursive()})},download:function(a){a=a.item;E._fetchItemData(a,this._getItemDataUrl(a))},openDesktop:function(a){a=a.item;var b=a.portal||{},c=a.url||"",d="Map Service"===a.type,e="Image Service"===a.type,f=E.onAGOLFederatedServer(c)||E.onFederatedServer(c),g=-1!==c.indexOf(".arcgis.com/")&&-1!==c.indexOf("//landscape"),k=a.openPkg,m=a.openData,c=a.openLyr;b.isPortal||
!d&&!e||a.isHostedService||a.isServiceProxy||f||g||(c=!0);b=k?this._getItemPkgPath(a):m?this._getItemDataUrl(a):c?this._getLyrPath(a):this._getPItemPath(a);c?E.openPageAndCount(a.id,b):E._fetchItemData(a,b)},share:function(a){var b,d=a.items||(a.item?[a.item]:[]),f=a.item||d[0]||{},m=a.user,n=new U,D=m.userRole,p=m.canShare,h=m.canShareOthers,q=f.isAdmin||f.canUpdate&&D.canUpdateOrgItems()&&!D.isCustom()&&(p||h)||1<d.length&&(m.isOrgAdmin||D.canUpdateOrgItems&&h),r=q&&m.canViewOthersOrgItems?f.itemOwner||
m:m,l=f.type,D={userGroups:r.getGroups(),adminGroups:q&&!f.isOwner?m.getGroups():null},t,I,v=g.subscribe("onShareUpdate",function(a){(a=a&&c.isArray(a)?a:null)&&(t=a.filter(function(a){return!a.success}).map(function(a){return c.mixin({},{id:a.itemId},a.error)}));t&&t.length&&(d=d.filter(function(a){return z.find(t,function(b){return a.id!==b.id})}),I=t.shift(),a="item not provisioned"===I.message?P.itemProperties.errors.noShareListedItem:I&&(I.messageCode&&P.common.errors[I.messageCode]||I.message||
P.common.errors.genericError.message),g.publish("view/deselectAll",{}),g.publish("alert/show",{type:"error",text:a}),n.hide())});e.once(n._shareDialog,"hide",c.hitch(this,function(){var e=n.isCancelled;n.destroy();v.remove();!e&&d&&d.length&&k(d.map(c.hitch(z,"getItemSharing"))).then(function(a){d.forEach(function(d,e){b=a[e];c.mixin(d,{access:b&&b.access||d.access,sharing:b});d.contentStatus=qa.getContentStatus(d)});return k(d.map(c.hitch(na,"getVerifiedInfo")))}).then(function(b){b.forEach(function(a,
b){d[b].verified=a});d[0].set("sharing",d[0].sharing);g.publish("view/deselectAll",{});a.item&&("Web Map"===l||"Web Scene"===l?(x.defaults.io.errorHandler=function(){},G.checkWebMapContent({webMapId:f.id,webMapItemCard:f,webMapConfig:f.itemData})):"Web Mapping Application"===l&&(x.defaults.io.errorHandler=function(){},G.checkWebAppContent({webAppId:f.id,webAppItemCard:f})))})}));k(D).then(c.hitch(this,function(a){var b=x.defaults.io.errorHandler;x.defaults.io.errorHandler=function(){};var c=g.subscribe("shareOptionsSetup",
function(){x.defaults.io.errorHandler=b;c.remove()});f.isOwner?n.show(d,a.userGroups,null):q?n.showAdmin(d,a.userGroups,r,a.adminGroups):m&&("public"===f.access||"shared"===f.access||"org"===f.access&&m.isOrgUser)?n.showGroups(d,a.userGroups,null):n.show(d,a.userGroups,null)}),c.hitch(this,function(a){g.publish("alert/show",{type:"error",text:a&&(a.messageCode&&P.common.errors[a.messageCode]||a.message||P.common.errors.genericError.message)})}))},shareOwnership:function(a){a.portal.getPortalUser().getGroups().then(function(b){var d=
a.item||{},e=a.items||[d],f=d.type,m=new H({class:"sharedOwnershipDlg",title:P.sharingDlg.sharedOwnershipTitle,buttonOk:P.common.ok,buttonCancel:P.common.cancel,style:{height:"auto"}}),n=new S({value:{items:e,groups:b}}),D,p,h;m.setContent(n.domNode);n.startup().then(function(){m.show()});D=dojo.topic.subscribe("/dlg/onOk",dojo.hitch(this,function(){n.validate().then(dojo.hitch(this,function(){n.shareWithSelectedGroup().then(dojo.hitch(this,function(){k(e.map(c.hitch(z,"getItemSharing"))).then(function(b){e.forEach(function(a,
d){h=b[d];c.mixin(a,{access:h&&h.access||a.access,sharing:h})});e[0].set("sharing",e[0].sharing);g.publish("view/deselectAll",{});a.item&&("Web Map"===f||"Web Scene"===f?(x.defaults.io.errorHandler=function(){},G.checkWebMapContent({webMapId:d.id,webMapItemCard:d,webMapConfig:d.itemData,confirmItemControl:!0})):"Web Mapping Application"===f&&G.checkWebAppContent({webAppId:d.id,webAppItemCard:d,confirmItemControl:!0}))});m.hide().then(dojo.hitch(this,function(){p.remove();D.remove()}))}))}))}));p=
dojo.topic.subscribe("/dlg/onCancel",dojo.hitch(this,function(){p.remove();D.remove()}))})},rateLimiting:function(a){(new T({item:a.item,user:a.user})).showModal()},timeSettings:function(a){var b=a.item,c=a.evt,c=a.layerId||d.get(c.target,"data-layerId"),c=z.findLayer(c,b.layers);(new I({item:b,layer:c,user:a.user})).showModal()},toggleFavorite:function(a){var b=a.item;a=a.evt;var d=b.isFavorite,e=new m;h.stop(a);N[d?"removeFromFavorites":"addToFavorites"](b).then(c.hitch(this,function(a){a.notSharedWith&&
a.notSharedWith.length||a.notUnsharedFrom&&a.notUnsharedFrom.length?e.reject({message:P.itemProperties.error.cantShareFavorites}):(b.set("isFavorite",!d),e.resolve(b.isFavorite))}),c.hitch(this,function(a){e.reject(a&&"item not provisioned"===a.message?{message:P.itemProperties.error.noShareListedItem}:a)}));return e},updateRating:function(a){var b=a.item;a=a.evt;var e=d.get(a.target,"value"),f=u.findWidgets(a.currentTarget).shift(),g=new m;h.stop(a);!f||f&&!f.get("disabled")?b.addRating(e).then(c.hitch(this,
function(){E.request({url:b.itemUrl}).then(function(a){b.set("avgRating",a&&a.avgRating||b.avgRating);b.set("numRatings",a&&a.numRatings||b.numRatings);g.resolve(b)})})):g.resolve(b);return g},updateData:function(a){var b=a.item,f=d.get(a.evt.target,"data-type"),k=b.thumbnail&&-1===b.thumbnail.indexOf("thumbnail/ago_downloaded.")&&-1===b.thumbnail.indexOf("thumbnail/thumbnail.");if("append"===f)return this.appendData(a);if("overwriteFromCloud"===f)return this.overwriteFromCloud(a);var m=new D;m.show(b);
var n=g.subscribe("itemData/update",c.hitch(this,function(){n.remove();"Vector Tile Service"!==b.type||k?m.hide():(b=c.mixin(b,{thumbnail:"",thumbnailUrl:""}),b.getThumbnail(!0).then(c.hitch(this,function(a){m.hide()}),c.hitch(this,function(){m.hide()})))}));e.once(m._updateItemDialog,"hide",c.hitch(this,function(){m._updateItemDialog.destroyRecursive();m.destroy()}))},publishService:function(a){a=a.item;var b=new X({id:"publish_dlg",item:a,folder:a.folderId,allowPublish:!0,overrideUser:a&&a.itemOwner||
{}});b.showModal();e.once(b.dialog,"hide",c.hitch(this,function(){b.dialog.destroyRecursive()}))},publishTiles:function(a){var b=a.item,e=a.user,f=b&&b.itemOwner&&b.itemOwner.folders,g=d.get(a.evt.target,"data-type"),k=this._getPublishingTypeMessage(b,g),m,n;this._getPublishingCostMessage(b,g).then(c.hitch(this,function(a){k=a&&a.message||k;(n=!a||a.availableCredits>=a.totalCost)?(m=new ca({portal:b.portal,folders:f,portalUser:e,message:k,item:b,showFolders:!0,type:g||"tiles"}),m.showModal().then(c.hitch(this,
function(a){var b=a&&a.id;a=!(!a||!a.cacheOnDemand);b&&(window.location="item.html?id\x3d"+b+("tiles"===g?a?"":"#settings/manageTiles":"scenes"===g?"#settings/buildCache":""))}))):this._showError({title:P.publishTileServiceDlg.notEnoughCreditsTitle,message:k})}))},_getPublishingTypeMessage:function(a,b){switch(b){case "wfs":a="wfsServiceDetailsDesc";break;case "scenes":a="sceneServiceDetailsDesc";break;case "features":a="viewServiceDetailsDesc";break;default:a="serviceDetailsDesc"}return P.publishTileServiceDlg[a]},
_getPublishingCostMessage:function(a,b){var d=new m;if("scenes"!==b)d.resolve(null);else{b=a.portal||{};var e=P.publishTileServiceDlg.sceneServiceDetailsDescCost,f=b.user&&b.user.availableCredits||b.subscriptionInfo&&b.subscriptionInfo.availableCredits||0;fa.fetchScenePublishingCredits(a,a.layers||[]).then(c.hitch(this,function(a){e=v.substitute(P.publishTileServiceDlg.createLayerCost,{credits:t.format(a),availableCredits:t.format(f)});e=f>=a?v.substitute(P.publishTileServiceDlg.sceneServiceDetailsDescCost,
{createLayerCost:e}):e;d.resolve({totalCost:a,availableCredits:f,message:e})}))}return d},moveItem:function(a){var b=a.page.portal,d=a.portalUser||a.item&&a.item.itemOwner||b.getPortalUser(),e=a.currentFolder&&a.currentFolder.id||a.item&&a.item.folderId||d.username,f=(a=a.selectedItems||[a.item],1<a.length),k=new ha({items:a,portal:b,portalUser:d,currentFolder:e}),m;k.startup();k.showModal(f).then(c.hitch(this,function(a){m=a&&1<a.length?"itemsMovedSuccess":"itemMovedSuccess";if(e&&"all"!==e){g.publish("items/refresh",
{removedItems:a});var b=g.subscribe("items/refreshComplete",c.hitch(this,function(){g.publish("view/deselectAll");b.remove();g.publish("alert/show",{type:"success",text:P.itemProperties[m]});g.publish("aggregations/refresh");k.hide()}))}else g.publish("view/deselectAll",{}),g.publish("alert/show",{type:"success",text:P.itemProperties[m]}),g.publish("aggregations/refresh"),k.hide()}),c.hitch(this,function(a){var b=a&&a.movedItems;if(b&&b.length)if(e&&"all"!==e){g.publish("items/refresh",{removedItems:a&&
a.movedItems});var d=g.subscribe("items/refreshComplete",c.hitch(this,function(){d.remove();k.hide();g.publish("aggregations/refresh")}))}else k.hide();else k.hide()}))},openLayerMetadata:function(a){var b=a.item,c=a.page||a.scope&&a.scope.page,e=a.evt.target;a=a.layerId||d.get(e,"data-layerId");var g=!1,k=!1;z.disableNode(e,!0);ka.openLayerEditor(b,a).then(function(a){var b=[],d=function(){z.disableNode(e,!1)};b.push(a.gxeAdaptor.on("metadata-save",function(a){a&&a.response&&!0===a.response.success&&
(g=!0,k=!1)}));b.push(a.gxeAdaptor.on("metadata-delete",function(a){a&&a.response&&!0===a.response.success&&(k=!0,g=!1)}));b.push(f.after(a.dialog,"show",d));b.push(f.after(a.dialog,"hide",d));b.push(f.after(a,"onDialogClose",function(){d();for(var a=0;a<b.length;a++)b[a]&&b[a].remove();(g||k)&&setTimeout(function(){c._item.set("serviceChanged",!0)},500)}))}.bind(this))},viewMetadata:function(a){a=a.item.itemUrl+"/info/metadata/metadata.xml";var b=E.getUser();E.openPage(a+"?format\x3ddefault\x26output\x3dhtml"+
(b&&b.token?"\x26token\x3d"+b.token:""),!1)},editMetadata:function(a){var b=a.item,d=a.page,e=a.evt.target,g=!1;z.disableNode(e,!0);ka.openEditor(b).then(c.hitch(this,function(a){var c=[],k=function(){z.disableNode(e,!1)};c.push(a.gxeAdaptor.on("metadata-save",function(a){a&&a.response&&!0===a.response.success&&(a=z.concatUnique(b.typeKeywords,["Metadata"]),b.set("typeKeywords",a.join(",")),g=!0)}));c.push(a.gxeAdaptor.on("metadata-delete",function(a){a&&a.response&&!0===a.response.success&&(a=z.filterOut(b.typeKeywords,
["Metadata"]),b.set("typeKeywords",a.join(",")),g=!1)}));c.push(f.after(a.dialog,"show",k));c.push(f.after(a.dialog,"hide",k));c.push(f.after(a,"onDialogClose",function(){k();for(var a=0;a<c.length;a++)c[a]&&c[a].remove();g&&setTimeout(function(){E.request({url:d.portal.portalUrl+"content/items/"+b.id,content:{ts:(new Date).getTime()}}).then(function(a){delete a.commentsEnabled;delete a.extent;delete a.owner;d._item.set(a)})},500)}))}))},setExtent:function(a){a=a.item;a=z.stringToArray(a.unsavedExtent||
a.extent,",",!1);var b=new M;a=4===a.length?[[Number(a[0]),Number(a[1])],[Number(a[2]),Number(a[3])]]:null;b.show(a);e.once(b._extentDialog,"hide",c.hitch(this,function(){b._extentDialog.destroyRecursive();b.destroyRecursive()}))},setSearchExtent:function(a){a=a.item;var b=a.proxyFilter||{};a=(a=a.unsavedSearchExtent||b.searchExtent||null)?z.stringToArray(a,",",!1):null;var d=new M;d._publish=function(a){g.publish("searchExtent/update",a)};a=a&&4===a.length?[[Number(a[0]),Number(a[1])],[Number(a[2]),
Number(a[3])]]:null;d.show(a);e.once(d._extentDialog,"hide",c.hitch(this,function(){d._extentDialog.destroyRecursive();d.destroyRecursive()}))},reassignItem:function(a){var b=a.item||{},d=a.items||[b],f=b&&b.itemOwner||a.owner,k=a.folder||(b.folderId?b.folderTitle:null),m=a.dontRemoveFromList||!1,n,D=a.owner&&a.owner.getCurrentFolder()||{},p=b.resultData&&b.resultData.length,h=b.sourceData&&"Feature Service"===b.sourceData.type,q;!b.isHostedService&&p||b.isHostedService&&h&&("WFS"===b.type||b.isDataView||
"Map Service"===b.type||"Scene Service"===b.type)?(q=new H({buttonOkLabel:P.common.ok,showCancel:!1,style:{width:"400px",height:"auto"}}),q.show({title:P.common.notice,message:P.common.errors.reassignSourceItemWithRelated}).then(c.hitch(this,function(){q.hide()}))):(n=new J,n.show(f,d,k,c.hitch(this,function(e,k){m=m||e===f.username&&a.folder&&(a.folder.isAll||D.isHome&&!k||"/"===k||D.id===k);d.forEach(function(a){c.mixin(a,{owner:e})});if(a.noRedirect){g.publish("items/refresh",m?{forcedDelay:1E3}:
{removedItems:d});var p=g.subscribe("items/refreshComplete",c.hitch(this,function(){p.remove();g.publish("view/deselectAll",{});g.publish("alert/show",{type:"success",text:P.itemProperties.ownerChangedSuccess});n.hide();g.publish("aggregations/refresh")}))}else n.hide(),window.location="item.html?id\x3d"+b.id}),c.hitch(this,function(a){var b=a&&a.errors&&a.errors.length?a.errors[0]:null,b=b&&b.messageCode&&P.common.errors[b.messageCode]?{message:P.common.errors[b.messageCode]}:403===b.code?{message:P.errorWidget.accessDeniedResource}:
b;(a.updatedItems||[]).map(function(a){return z.find(d,function(b){return b.id===a.itemId})}).forEach(function(b){c.mixin(b,{owner:a.newOwner})});g.publish("alert/show",{type:"error",text:b.message});g.publish("items/refresh",{forcedDelay:1E3});var e=g.subscribe("items/refreshComplete",c.hitch(this,function(){e.remove();n.hide();g.publish("aggregations/refresh")}))}),!0),e.once(n._dialog,"hide",c.hitch(this,function(){n._dialog.destroyRecursive();n.destroyRecursive()})))},deleteItem:function(a){var b=
a.item,d=b.portal||{},f,m,n,D,p,h,q=c.hitch(this,function(d){if(d&&d.success)if(a.noRedirect){g.publish("items/refresh",{removedItems:[b]});var e=g.subscribe("items/refreshComplete",c.hitch(this,function(){g.publish("view/deselectAll");e.remove();h.hide();g.publish("alert/show",{type:"success",text:P.itemProperties.itemDeleteSuccess});g.publish("aggregations/refresh")}))}else window.location=n&&n.id?"item.html?id\x3d"+n.id:b.isAdmin&&!b.isOwner?"content.html?user\x3d"+b.owner:"content.html";else h.hide(),
a.noRedirect?g.publish("alert/show",{type:"error",text:P.common.errors[d&&d.messageCode||""]||d}):this._showError(d)});k({canBeDeleted:d.isPortal?b.canBeDeleted():null,sourceData:b.getSourceData(),resultData:b.getResultData()}).then(function(a){f=a.canBeDeleted&&a.canBeDeleted.success;m=!f&&a.canBeDeleted&&a.canBeDeleted.offendingItems||[];n=a.sourceData;D=a.resultData;p=!n&&D&&D.length&&!b.isHostedService;var r=P.itemProperties.deleteItemBlocked+'\x3cbr/\x3e\x3cul class\x3d"list-plain"\x3e${layerList}\x3c/ul\x3e',
l=P.itemProperties.deleteSourceItem+'\x3cbr/\x3e\x3cul class\x3d"list-plain"\x3e${layerList}\x3c/ul\x3e\x3cbr/\x3e'+P.itemProperties.deleteSourceItemMsg,t=p?l:r,I="",u=d.helpBase+d.helpMap.m["120001208"],w=D&&D.length?D.length-5:0,y=D&&D.length?D.map(function(a){return"id:"+a.id}).join(" OR "):"";d.isPortal?f?(h=new L,h.showMsg(P.deleteWarningDlg.confirmDeleteSingleItem,function(){z.deleteItem(b).then(q,q)},!0),e.once(h._dialog,"hide",function(){h._dialog.destroyRecursive();h.destroyRecursive()})):
f||m.length?(a=(a.canBeDeleted&&a.canBeDeleted.offendingItems||[]).map(function(a){return E.request({url:d.portalUrl+"content/items/"+a.itemId})}.bind(this)),k(a).then(function(a){m=a;m=m.map(function(a){return new F(c.mixin(a,{portal:d}))}.bind(this));m.forEach(function(a,b){5>b&&(I+=v.substitute('\x3cli\x3e\x3ca href\x3d"item.html?id\x3d${relItem.id}" target\x3d"_blank"\x3e${relItem.title}\x3c/a\x3e, ${relItem.displayName}\x3c/li\x3e',{relItem:a,i18n:P}))});I+=5<m.length?v.substitute('\x3cli\x3e\x3ca target\x3d"_blank" href\x3d"search.html?t\x3dcontent\x26q\x3d(${query})"\x3e${i18n.FilterDlg.and} ${count} ${i18n.itemProperties.more}\x3c/a\x3e\x3c/li\x3e',
{query:encodeURIComponent(y),i18n:P,count:w||0}):"";t=v.substitute(t,{layerList:I,helpTitle:P.itemProperties.learnMoreDeletingSourceItems,helpUrl:u});p?(h=new H({buttonOkLabel:P.common.yesLabel,buttonCancelLabel:P.common.noLabel,style:{width:"400px",height:"auto"}}),h.show({title:P.common.notice,message:t}).then(c.hitch(this,function(a){"onOk"===a&&z.deleteItem(b).then(q,q)}))):(h=new Q,h.show({title:P.common.notice,message:t}));e.once(h._dialog,"hide",function(){h._dialog.destroyRecursive();h.destroyRecursive()})}.bind(this))):
(a=a.canBeDeleted,g.publish("alert/show",{type:"error",text:a&&(a.messageCode&&P.common.errors[a.messageCode]||a.message||P.common.errors.genericError.message)})):(D&&D.length?(D.forEach(function(a,b){5>b&&(I+=v.substitute('\x3cli\x3e\x3ca href\x3d"item.html?id\x3d${relItem.id}" target\x3d"_blank"\x3e${relItem.title}\x3c/a\x3e, ${relItem.displayName}\x3c/li\x3e',{relItem:a,i18n:P}))}),I+=5<D.length?v.substitute('\x3cli\x3e\x3ca target\x3d"_blank" href\x3d"search.html?t\x3dcontent\x26q\x3d(${query})"\x3e${i18n.FilterDlg.and} ${count} ${i18n.itemProperties.more}\x3c/a\x3e\x3c/li\x3e',
{query:encodeURIComponent(y),i18n:P,count:w||0}):"",t=v.substitute(t,{layerList:I,helpTitle:P.itemProperties.learnMoreDeletingSourceItems,helpUrl:u}),p?(h=new H({buttonOkLabel:P.common.yesLabel,buttonCancelLabel:P.common.noLabel,style:{width:"400px",height:"auto"}}),h.show({title:P.common.notice,message:t}).then(c.hitch(this,function(a){"onOk"===a&&z.deleteItem(b).then(q,q)}))):(h=new Q,h.show({title:P.common.notice,message:t}))):(h=new L,h.showMsg(P.deleteWarningDlg.confirmDeleteSingleItem,function(){z.deleteItem(b).then(q,
q)},!0)),e.once(h._dialog,"hide",function(){h._dialog.destroyRecursive();h.destroyRecursive()}))}.bind(this),function(a){g.publish("alert/show",{type:"error",text:a&&(a.messageCode&&P.common.errors[a.messageCode]||a.message||P.common.errors.genericError.message)})}.bind(this))},toggleAttachments:function(a){var b=a.item,e=a.evt,f,k;a=a.layerId||d.get(e.target,"data-layerId");var m=z.findLayer(a,b.layers),n=m.hasAttachments,D=function(a){k=new w({closable:!1,content:v.substitute('\x3cdiv class\x3d"loader is-active padding-leader-3 padding-trailer-3"\x3e\x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\x3cdiv class\x3d"loader-text"\x3e${message}\x3c/div\x3e\x3c/div\x3e',
{message:a}),style:"width: 300px"});k.show();return z.enableAttachments(b,m,n?!1:!0).then(function(){b.set("maxAgeCheck",!0);k.hide();k.destroyRecursive();d.set(e.target,"innerHTML",P.itemProperties[n?"enableAttachments":"disableAttachments"])},function(a){a=a&&(a.messageCode&&P.common.errors[a.messageCode]||a.message||P.common.errors.genericError.message);k.hide();k.destroyRecursive();g.publish("alert/show",{type:"error",text:a})})};n?(f=new H({buttonOkLabel:P.common.yesLabel,buttonCancelLabel:P.common.noLabel,
style:{width:"400px",height:"auto"}}),f.show({title:P.itemProperties.disableAttachments,message:P.itemProperties.disableAttachmentsMessage}).then(c.hitch(this,function(a){"onOk"===a&&(f.hide(),D(P.itemProperties.disablingAttachments))}))):D(P.itemProperties.enablingAttachments)},createApp:function(a){var b=a.item,c=a.evt,e=b.isHostedTemplate;a=d.get(c.target,"data-type");var f="wab"===a||(z.includes(b.typeKeywords,"Web AppBuilder for ArcGIS")?!0:!1),g=d.get(c.target,"data-type")||null,k=d.get(c.target,
"data-title"),c=d.get(c.target,"data-message"),e=e||f,m=new V({item:b}),n={isWab:f},D;"webscene"===g&&portal.isPortal&&(n.typeInfo="webscene_portal");"dashboard"===a?(n={typeInfo:"dashboard_map",title:k,message:c,isWAB:f,portal:b.portal,item:b},m.showCreateDefaultItem(n)):D=e?m.showModal(n):m.showWizard(n);D&&D.then(function(a){a&&a.configureUrl&&(window.location=a&&a.configureUrl)})},profilePopup:function(a){var b=a.item,d=a.evt;if(a=a.profile||b.owner||(a.user?a.user.username||a.user:null))this._popup||
(this._popup=new aa,this._popup.startup(),e.once(this._popup,"hide",c.hitch(this,function(){this._popup.destroyRecursive();this._popup=null}))),this._popup.showProfile(a,d.target)},advancedOfflineOptions:function(a){var b=new ba({data:c.mixin({},a.item)});b.showModal().then(function(a){g.publish("advanced-offline/change",a.applicationProperties?a.applicationProperties.offline:null);b.destroy()})},attachCode:function(a){var b=a.item;a=b.codeAttachment;var d=new ea({item:b,sharing:b.sharing});d.show(a);
f.after(d,"onUpload",c.hitch(this,function(){b.set("codeAttachmentChanged",!0);d.hide()}));e.once(d.dialog,"hide",c.hitch(this,function(){d.dialog.destroyRecursive();d.destroyRecursive()}))},deleteCode:function(a){var b=a.item,d=b.portal,f=b.codeAttachment;a="Web Mapping Application"===b.type&&z.includes(b.typeKeywords,"Web AppBuilder");var g,k;f&&(k=new L,e.once(k._dialog,"hide",c.hitch(this,function(){k._dialog.destroyRecursive();k.destroyRecursive()})),k.showMsgTitleButton(P.itemProperties.removeAttachmentMsg+
(a?"":"\x3cbr\x3e\x3cbr\x3e"+P.itemProperties.removeAttachmentUpdate),P.itemProperties.removeAttachmentTitle,P.itemProperties.removeAttachmentButton,c.hitch(this,function(){g=d.portalUrl+"content/items/"+f.id;E.request({url:g}).then(c.hitch(this,function(a){f=new F(c.mixin(a,{portal:b.portal}));z.deleteItem(f).then(c.hitch(this,function(){b.set("codeAttachment",null)}))}))})))},thumbnail:function(a){a=Y({item:a.item,publishThumbnail:!1});a.startup();a.showModal()},newMapViewer:function(a){var b=a.item,
c=d.get(a.evt.currentTarget,"data-href")||b.mapNewViewerUrl;a=-1<c.indexOf("useExisting\x3d1");"Web Map"!==b.type&&a?window.location=c:O().then(function(a){if(a&&!0===a.c){var b=new Z;b.show(c,a);e.once(b._dialog,"hide",function(){b._dialog.destroyRecursive();b.destroy()})}else window.location=c})},whatsNew:function(a){var b=new m,d=a.key,f=a.endDate,g=a.redirectUrl,k=a.disableDebugBlock,D,h,l=new Date((new Date).getTime()+31556926E3),t={},I=new Date,v={closeable:!1,showCancel:g?!0:!1,buttonOkLabel:g?
P.common.learnMore:P.common.gotIt,buttonCancelLabel:P.common.gotIt,className:"whatsNewDlg"};h=E.getCookie("esri_whatsnew")||{};I<f&&(k||!A.isDebug)?h[d]?b.resolve(!0):(D=new H(v),g?(n.add(D.okButton.domNode,"hide"),f=r.create("a",{className:"btn right learn-more-link icon-ui-link-external",href:g,target:"_blank",innerHTML:P.addItemFrm.learnMore},D.actionBarNode,"last")):f=D.okButton,e.once(f,"click",c.hitch(this,function(){D.hide()})),e.once(D,"hide",c.hitch(this,function(){t[d]=!0;p("esri_whatsnew",
q.stringify(c.mixin(h,t)),{expires:l,path:"/",domain:".arcgis.com"});b.resolve(!0)})),D.show({message:a.message||"",title:a.title||""})):(h[d]&&(delete h[d],p("esri_whatsnew",q.stringify(h),{expires:l,path:"/",domain:".arcgis.com"})),b.resolve(!0));return b},shareSocial:function(a){var b=a.evt.target;a=a.item;a=a.access&&"public"===a.access;var e=new H({buttonOkLabel:P.common.ok,showCancel:!1,style:{width:"400px",height:"auto"}});b&&n.contains(b,"js-action-shareSocial")||(a?window.open(d.get(b,"href")):
e.show({title:P.itemLinks.shareItem,message:B.substitute({appTitle:A.portalName||"ArcGIS.com"},P.itemLinks.shareItemMsg)}).then(c.hitch(this,function(){e.hide().then(function(){window.open(d.get(b,"href"))})})))},manageSceneCache:function(a){var b=a.item;a=a.page;a=b.portal.isPortal?a._hostedFederatedServer:void 0;var c=b.sourceData||{};(new ga).show(c,b,a)},markItemAsAuthoritative:function(a){var b=a.item,c=(b.portal&&b.portal.isVerified&&"public"===b.access?"public":"org")+"_authoritative";b._setContentStatusTo(c).then(function(a){a.success&&
(b.set("protected",!0),g.publish("item/protect",{protect:!0}),b.set("contentStatus",c));return na.getVerifiedInfo(b)}.bind(this)).then(function(a){b.set("verified",a)})},markItemAsDeprecated:function(a){var b=a.item;b._setContentStatusTo("deprecated").then(c.hitch(this,function(a){a.success&&(b.set("contentStatus","deprecated"),b.set("verified",!1))}))},removeContentStatus:function(a){var b=a.item;b._setContentStatusTo("").then(c.hitch(this,function(a){a.success&&(b.set("contentStatus",""),b.set("verified",
!1))}))},httpsUpdate:function(a){var b=document.createDocumentFragment();a=new ja(a,r.create("div",null,b));var c=z.createDialogWrapper({className:"update-to-https-dlg",draggable:!y("touch"),title:P.itemProperties.updateLayersToHTTPS},b),b=function(){c.hide()};a.startup();a.own(g.subscribe("update-to-https/done",b),g.subscribe("update-to-https/cancel",b));c.show()},domainUpdate:function(a){var b=document.createDocumentFragment(),c=new pa(a,r.create("div",null,b)),d=z.createDialogWrapper({className:"update-domains-dlg",
draggable:!y("touch"),title:P.itemProperties.domainsTitle},b);c.startup();c.own(g.subscribe("update-domain/done",function(){d.hide()}));d.show();setTimeout(function(){c._domainReplace.value&&c._domainReplace.focus()},200)},replaceLayer:function(a){(new ia({item:a.item},r.place(r.create("div"),a.evt.target,"after"))).open()},_getItemPkgPath:function(a){var b=a.portal.getPortalUser();return a.itemUrl+"/item.pkinfo"+("public"!==a.access&&b&&b.token?"?token\x3d"+b.token:"")},_getPItemPath:function(a){var b=
a.portal.getPortalUser();return a.itemUrl+"/item.pitem"+("public"!==a.access&&b&&b.token?"?token\x3d"+b.token:"")},_getLyrPath:function(a){var b=a.portal.getPortalUser();return a.url+"?f\x3dlyr\x26v\x3d9.3"+("public"!==a.access&&b&&b.token?"\x26token\x3d"+b.token:"")},_showError:function(a){var b=new H({buttonOkLabel:P.common.ok,showCancel:!1,style:{width:"400px",height:"auto"}});b.show({title:a.title||P.addItemFrm.errors.error.title,message:a.message||P.addItemFrm.errors.error.message}).then(c.hitch(this,
function(){b.hide()}))}})})},"arcgisonline/map/utils/getMapCookie":function(){define(["dojo/Deferred","dojo/json","arcgisonline/persist"],function(c,l,h){return function(){var a=window.sessionStorage&&window.sessionStorage.getItem("Esri_webmap"),e=new c;a&&a.length?e.resolve(l.parse(a)):(this.store=this.store||new h.Store("ESRI_Webmap"),this.store.get("webmap",function(a,c){e.resolve(a&&c?l.parse(c):null)},function(a,c){e.resolve(a&&c?l.parse(c):null)}));return e}})},"arcgisonline/sharing/dijit/dialog/AccountMoveToDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/topic dojo/Deferred dojo/promise/all dojo/store/Memory dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dijit/registry dijit/Dialog dijit/Tree dijit/tree/TreeStoreModel dijit/form/Button dijit/form/ComboBox dijit/layout/BorderContainer dijit/layout/ContentPane ../../../esriGeowConfig ../../util ../../../pages/portal/PortalUser ../../geow/Account ../../geow/Content ../../geow/Folder ./MoveToFolderDlg dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/AccountMoveToDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J){var L=l("arcgisonline.sharing.dijit.dialog.AccountMoveToDlg",[p,q,n],{declaredClass:"arcgisonline.sharing.dijit.dialog.AccountMoveToDlg",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),templateString:J,widgetsInTemplate:!0,adminUser:null,contentUser:null,selectedUser:null,folders:null,items:null,handler:null,selectedFolder:null,selectedFolderId:null,selectedFolderName:null,incomingFolderName:null,maxUsers:100,postMixInProperties:function(){this.inherited(arguments);
this.i18n=h.mixin(H.common,H.accountMoveToDlg);h.mixin(this.i18n,{create:H.items.create,changeOwner:H.GroupWidget.changeOwner,folderName:H.itemProperties.folderName,filterFolders:H.itemProperties.filterFolders,moveToFolder:H.itemProperties.moveToFolder})},postCreate:function(){this.inherited(arguments);this._initUI()},_initUI:function(){this.userList.set("value",this.i18n.selectUserValue);this._initHandlers()},_initHandlers:function(){this.own(r(this._okBtn,this.submitRequest.bind(this)),r(this._cancelBtn,
this.hide.bind(this)),f(this.userList,"change",this.onUserSelect.bind(this)),r(this.userList,this.onUserSelectClick.bind(this)))},show:function(a,b,c,d,f,g){this.clear();this.adminUser=F.getUser();this.contentUser=a;this.portal=a.portal;this.items=b;this.incomingFolderName=c&&""!==c?c:a.username;this.handler=d;this.errorHandler=f;this.manualHide=g;d={start:1,num:this.maxUsers,excludeSystemUsers:F.isPortal()};E.getAccountUsers(this.adminUser.accountId,d,this.handleGetAccountUsers.bind(this));this.moveToFolder=
new K({items:b,portalUser:a,currentFolder:c},e.create("div",null,this._moveToFolderContainer));this.moveToFolder.startup();this._dialog.show()},handleGetAccountUsers:function(a){if(a&&a.users&&a.total&&0<a.total){null===this.userStore&&(this.userStore=new k({idProperty:"name",data:[]}),this.userList.set("store",this.userStore));for(var b=0;b<a.users.length;b++){var c=a.users[b].username,d=new A(h.mixin({name:a.users[b].fullName+" ("+c+")",username:c,portal:this.portal},a.users[b]));this.contentUser.username===
c&&(this.selectedUser=d);this.userStore.put(d)}-1<a.nextStart?(a={start:a.nextStart,num:this.maxUsers,excludeSystemUsers:F.isPortal()},E.getAccountUsers(this.adminUser.accountId,a,this.handleGetAccountUsers.bind(this))):this.selectedUser&&this.selectedUser.name&&this.selectedUser.username&&(this.userList.set("value",this.selectedUser.name),this.selectedFolderName=this.selectedFolderId=this.selectedFolder=null,this.refreshFolders())}},refreshFolders:function(){this.moveToFolder.destroyRecursive();
var a=this.selectedUser&&this.selectedUser.username?this.selectedUser:this.contentUser.username,b=b&&""!==b?this.incomingFolderName:a.username;this.moveToFolder=new K({items:this.items,portalUser:a,currentFolder:b},e.create("div",null,this._moveToFolderContainer));this.moveToFolder.startup()},onUserSelectClick:function(){var a=this.userList.textbox;a.setSelectionRange(0,a.value.length)},onUserSelect:function(a){var b=null;this.selectedUser=null;this.userStore&&((b=this.userStore.query({name:a}))&&
b.length&&(b=b[0],b.orgId===this.adminUser.orgId&&(this.selectedUser=b)),this.selectedUser?(this.selectedUser=new A({username:this.selectedUser.username,portal:this.contentUser.portal}),m(".userNotFound").style("display","none"),m(".userFound").style("display",""),this._okBtn.set("disabled",!1),this.selectedFolderName=this.selectedFolderId=this.selectedFolder=null,this.refreshFolders()):(m(".userNotFound").style("display",""),m(".userFound").style("display","none"),this._okBtn.set("disabled",!0)))},
clear:function(){this.selectedFolderName=this.selectedFolderId=this.selectedFolder=this.userStore=this.selectedUser=null;this._okBtn.set("disabled",!0)},submitRequest:function(){this.disable();var a=z.userRole&&z.userRole.isCustom(),b=this.items.every(function(a){return a.owner===this.contentUser.username},this);this.selectedFolderId=this.moveToFolder.get("selectedFolderId");this.selectedFolderName=this.moveToFolder.get("selectedFolderName");if(this.selectedUser.username===this.contentUser.username&&
b&&!a)N.moveItemsByUser(this.contentUser.username,this.items,{folder:this.selectedFolderId||"/"},this.onMoveDone.bind(this),this.onMoveDone.bind(this));else{var c=[],d=[],e=this.selectedUser.username,f=this.selectedFolderName&&this.selectedFolderName!==e?this.selectedFolderName:"/";this.items.forEach(function(a){var b=!(a.id&&1===a.id.length),g=b?a.folderId:a.folderId[0],g={id:b?a.id:a.id[0],owner:b?a.owner:a.owner[0],folderId:g&&0<g.length&&""!==g?g:null};a=b?a.type:a.type[0];if("Web Mapping Application"===
a||"Mobile Application"===a)g.type=a,d.push(g);a=z.restBaseUrl+"content/users/"+g.owner;g.folderId&&(a=a+"/"+g.folderId);a=a+"/items/"+g.id+"/reassign";g=F.request({url:a,content:{targetUsername:e,targetFolderName:f}},{usePost:!0}).then(function(a){return a}.bind(this),function(a){return a}.bind(this));c.push(g)},this);g(c).then(function(a){a=a||[];var b=a.filter(function(a){return a&&200!==a.httpCode&&a.message},this);a=a.filter(function(a){return a&&a.success},this).map(function(a){return h.mixin(a,
{id:a.itemId})},this);if(b&&b.length&&this.errorHandler)this.errorHandler({updatedItems:a,errors:b,newOwner:e}),this.enable();else if(0<d.length)this.checkForRelatedItems(d);else this.onReassignDone()}.bind(this))}},checkForRelatedItems:function(a){var b=[];a.forEach(function(a){var c="WMA2Code";"Mobile Application"===a.type&&(c="MobileApp2Code");b.push(F.request({url:z.restBaseUrl+"content/items/"+a.id+"/relatedItems",content:{relationshipType:c}}))},this);g(b).then(function(a){var b=[];a.forEach(function(a){a[1]&&
a[1].relatedItems&&a[1].relatedItems.forEach(function(a){b.push(a)},this)},this);this.reassignRelatedItems(b)}.bind(this),function(a){this.onReassignDone()}.bind(this))},reassignRelatedItems:function(a){if(0<a.length){var b=[];a.forEach(a,function(a){var c=z.restBaseUrl+"content/users/"+a.owner;a.folderId&&(c=c+"/"+a.folderId);c=c+"/items/"+a.id+"/reassign";a=F.request({url:c,content:{targetUsername:this.selectedUser.username,targetFolderName:"/"}},{usePost:!0});b.push(a)}.bind(this));g(b).then(function(){this.onReassignDone()}.bind(this),
function(){this.onReassignDone()}.bind(this))}else this.onReassignDone()},onMoveDone:function(){this.handler&&this.handler(this.selectedUser&&this.selectedUser.username,this.selectedFolderId);this.manualHide||this.hide()},onReassignDone:function(){this.handler&&this.handler(this.selectedUser&&this.selectedUser.username,this.selectedFolderId);this.manualHide||this.hide()},hide:function(){this.enable();this.userFolderClickConnect&&this.userFolderClickConnect.remove();this.refreshUserFoldersConnect&&
this.refreshUserFoldersConnect.remove();this._dialog.hide()},enable:function(){this._okBtn.set("disabled",!1);this._okBtn.set("label",this.i18n.changeOwner)},disable:function(){this._okBtn.set("disabled",!0);this._okBtn.set("label",this.i18n.changingOwner)}});L.prototype.statics={_instance:null,getInstance:function(){null===this._instance&&(this._instance=new L);return this._instance}};return L})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M){function Q(a){return v.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var U=a("dijit._TreeNode",[F,A,E,N,O],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);q("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:H,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";k.set(this.domNode,
"backgroundPosition",b+" 0px");k.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);c.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,c,d){var e="_"+c+"Class";c+="Node";var f=this[e];this[e]=this.tree["get"+d+"Class"](a,this.isExpanded);b.replace(this[c],this[e]||"",f||"");k.set(this[c],this.tree["get"+d+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;b.toggle(this.domNode,"dijitTreeIsRoot",a);b.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var c=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;b.replace(this.expandoNode,c[a],c);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return Q(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");b.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=p.wipeIn({node:this.containerNode,duration:z.defaultDuration}),c=this._expandDeferred=new e(function(){a.stop()});l.after(a,"onEnd",function(){c.resolve(!0)},!0);a.play();return Q(c)},collapse:function(){if(this._collapseDeferred)return Q(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");b.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=p.wipeOut({node:this.containerNode,duration:z.defaultDuration}),c=this._collapseDeferred=new e(function(){a.stop()});l.after(a,"onEnd",
function(){c.resolve(!0)},!0);a.play();return Q(c)},indent:0,setChildItems:function(a){var b=this.tree,e=b.model,g=[],k=b.focusedChild,m=this.getChildren();c.forEach(m,function(a){E.prototype.removeChild.call(this,a)},this);this.defer(function(){c.forEach(m,function(a){if(!a._destroyed&&!a.getParent()){var f=function(a){var d=e.getIdentity(a.item),g=b._itemNodesMap[d];1==g.length?delete b._itemNodesMap[d]:(d=c.indexOf(g,a),-1!=d&&g.splice(d,1));c.forEach(a.getChildren(),f)};b.dndController.removeTreeNode(a);
f(a);if(b.persist){var g=c.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),m;for(m in b._openedNodes)m.substr(0,g.length)==g&&delete b._openedNodes[m];b._saveExpandedNodes()}b.lastFocusedChild&&!d.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;k&&!d.isDescendant(k.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,c.forEach(a,function(a){var c=e.getIdentity(a),d=b._itemNodesMap[c],
f;if(d)for(var k=0;k<d.length;k++)if(d[k]&&!d[k].getParent()){f=d[k];f.set("indent",this.indent+1);break}f||(f=this.tree._createTreeNode({item:a,tree:b,isExpandable:e.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),d?d.push(f):b._itemNodesMap[c]=[f]);this.addChild(f);(this.tree.autoExpand||this.tree._state(f))&&g.push(b._expandNode(f))},this),c.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=f(g);this.tree._startPaint(a);return Q(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());c.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");b.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){x.focus(this.focusNode)}});q("dojo-bidi")&&U.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),c.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var S=a("dijit.Tree",[F,K,A,O],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:J,persist:!1,autoExpand:!1,dndController:M,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){w.publish(this.id,v.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new e;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(u(this.containerNode,
u.selector(".dijitTreeNode",t.enter),function(b){a._onNodeMouseEnter(B.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeNode",t.leave),function(b){a._onNodeMouseLeave(B.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",C.press),function(b){a._onNodePress(B.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",C),function(b){a._onClick(B.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(B.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(l.after(this.model,"onChange",v.hitch(this,"_onItemChange"),!0),l.after(this.model,"onChildrenChange",v.hitch(this,"_onItemChildrenChange"),!0),l.after(this.model,"onDelete",v.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){v.isString(this.dndController)&&(this.dndController=v.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=Q(this.pendingCommandsPromise);this.onLoadDeferred.then(v.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;n.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=v.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=v.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new R(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(v.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(v.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),v.hitch(this,function(a){}))},getNodesByItem:function(a){if(!a)return[];a=v.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(v.hitch(this,function(){var d=c.map(a,function(a){return!a||v.isString(a)?
a:b.model.getIdentity(a)}),e=[];c.forEach(d,function(a){e=e.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",e)}))},_setPathAttr:function(a){return a.length?Q(this.set("paths",[a]).then(function(a){return a[0]})):Q(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,e){var f=a.shift(),g=c.filter(e,function(a){return a.getIdentity()==f})[0];if(g)return a.length?d._expandNode(g).then(function(){return b(a,g.getChildren())}):g;throw new S.PathError("Could not expand path at "+
f);}var d=this;return Q(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return f(c.map(a,function(a){a=c.map(a,function(a){return a&&v.isObject(a)?d.model.getIdentity(a):a});if(a.length)return b(a,[d.rootNode]);throw new S.PathError("Empty path");}))}).then(function(a){d.set("selectedNodes",a);return d.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},expandAll:function(){function a(d){return b._expandNode(d).then(function(){var b=
c.filter(d.getChildren()||[],function(a){return a.isExpandable});return f(c.map(b,a))})}var b=this;return Q(a(this.rootNode))},collapseAll:function(){function a(d){var e=c.filter(d.getChildren()||[],function(a){return a.isExpandable}),e=f(c.map(e,a));return!d.isExpanded||d==b.rootNode&&!b.showRoot?e:e.then(function(){return b._collapseNode(d)})}var b=this;return Q(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,
b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),
this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?
this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return d.isDescendant(a,b.expandoNode)||d.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,
b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):
this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){n.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){n.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;
if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new e,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){a._loadDeferred.reject(b)}));b=a._loadDeferred.then(v.hitch(this,function(){var b=a.expand();
this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var d=this.getLabel(a),e=this.getTooltip(a);c.forEach(b,function(b){b.set({item:a,label:d,tooltip:e});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);
(a=this._itemNodesMap[a])&&c.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(c.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!d.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!d.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},
_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=h(this.cookieName);a&&c.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var d=c.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[d];b?this._openedNodes[d]=!0:delete this._openedNodes[d];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=
[],b;for(b in this._openedNodes)a.push(b);h(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!v.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&g.setMarginBox(this.domNode,a);this._nodePixelIndent=g.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(v.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=v.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});
y(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new U(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});q("dojo-bidi")&&S.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",
a),this.rootNode.set("textDir",a))}});S.PathError=m("TreePathError");S._TreeNode=U;return S})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(c,l,h,a){return h("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(c){a.mixin(this,c);this.connects=[];c=this.store;if(!c.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
c.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([l.after(c,"onNew",a.hitch(this,"onNewItem"),!0),l.after(c,"onDelete",a.hitch(this,"onDeleteItem"),!0),l.after(c,"onSet",a.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var a;a=this.connects.pop();)a.remove()},getRoot:function(c,f){this.root?c(this.root):this.store.fetch({query:this.query,onComplete:a.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+a.length+
" items, but must return exactly one");this.root=a[0];c(this.root)}),onError:f})},mayHaveChildren:function(a){return c.some(this.childrenAttrs,function(c){return this.store.hasAttribute(a,c)},this)},getChildren:function(e,f,d){var b=this.store;if(b.isItemLoaded(e)){for(var g=[],k=0;k<this.childrenAttrs.length;k++)var m=b.getValues(e,this.childrenAttrs[k]),g=g.concat(m);var p=0;this.deferItemLoadingUntilExpand||c.forEach(g,function(a){b.isItemLoaded(a)||p++});0==p?f(g):c.forEach(g,function(a,c){b.isItemLoaded(a)||
b.loadItem({item:a,onItem:function(a){g[c]=a;0==--p&&f(g)},onError:d})})}else{var h=a.hitch(this,arguments.callee);b.loadItem({item:e,onItem:function(a){h(a,f,d)},onError:d})}},isItem:function(a){return this.store.isItem(a)},fetchItemByIdentity:function(a){this.store.fetchItemByIdentity(a)},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return this.labelAttr?this.store.getValue(a,this.labelAttr):this.store.getLabel(a)},newItem:function(a,c,d){var b={parent:c,attribute:this.childrenAttrs[0]},
e;this.newItemIdAttr&&a[this.newItemIdAttr]?this.fetchItemByIdentity({identity:a[this.newItemIdAttr],scope:this,onItem:function(f){f?this.pasteItem(f,null,c,!0,d):(e=this.store.newItem(a,b))&&void 0!=d&&this.pasteItem(e,c,c,!1,d)}}):(e=this.store.newItem(a,b))&&void 0!=d&&this.pasteItem(e,c,c,!1,d)},pasteItem:function(a,f,d,b,g){var e=this.store,m=this.childrenAttrs[0];f&&c.forEach(this.childrenAttrs,function(d){if(e.containsValue(f,d,a)){if(!b){var g=c.filter(e.getValues(f,d),function(b){return b!=
a});e.setValues(f,d,g)}m=d}});if(d)if("number"==typeof g){var p=e.getValues(d,m).slice();p.splice(g,0,a);e.setValues(d,m,p)}else e.setValues(d,m,e.getValues(d,m).concat(a))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(c,f){f&&this.getChildren(f.item,a.hitch(this,function(a){this.onChildrenChange(f.item,a)}))},onDeleteItem:function(a){this.onDelete(a)},onSetItem:function(e,f){if(-1!=c.indexOf(this.childrenAttrs,f))this.getChildren(e,a.hitch(this,function(a){this.onChildrenChange(e,
a)}));else this.onChange(e)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(c,l,h,a,e){return l("dijit.tree.ForestStoreModel",e,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(c,d,b){c===
this.root?this.root.children?d(this.root.children):this.store.fetch({query:this.query,onComplete:a.hitch(this,function(a){this.root.children=a;d(a)}),onError:b}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(a){if(a.identity==this.root.id){var c=a.scope||h.global;a.onItem&&a.onItem.call(c,this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===
this.root?this.root.label:this.inherited(arguments)},newItem:function(a,c,b){return c===this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,c,b,e,k){if(c===this.root&&!e)this.onLeaveRoot(a);this.inherited(arguments,[a,c===this.root?null:c,b===this.root?null:b,e,k]);if(b===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){},onLeaveRoot:function(a){},_requeryTop:function(){var e=this.root.children||[];this.store.fetch({query:this.query,
onComplete:a.hitch(this,function(a){this.root.children=a;if(e.length!=a.length||c.some(e,function(b,c){return a[c]!=b}))this.onChildrenChange(this.root,a)})})},onNewItem:function(a,c){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(a){-1!=c.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,c,b,e){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m){return l("dijit.tree._dndSelector",m,{constructor:function(){this.selection={};this.anchor=null;this.events.push(b(this.tree.domNode,g.press,a.hitch(this,"onMouseDown")),b(this.tree.domNode,g.release,a.hitch(this,"onMouseUp")),b(this.tree.domNode,g.move,a.hitch(this,"onMouseMove")),b(this.tree.domNode,k.press,a.hitch(this,"onClickPress")),b(this.tree.domNode,k.release,a.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var b=c.filter(this.getSelectedTreeNodes(),function(b){return!f.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(b){var d=this.getSelectedTreeNodes();c.forEach(this._setDifference(d,b),a.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));c.forEach(this._setDifference(b,d),a.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){c.forEach(b,function(a){a.__exclude__=!0});a=c.filter(a,function(a){return!a.__exclude__});c.forEach(b,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],d=[];c.forEach(a,function(a){var c=a.getTreePath();d.push(a);b.push(c)},this);a=c.map(d,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",d);this.tree._set("selectedNode",d[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&d.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var c=e.getCopyKeyState(a),f=b.id;this.singular||a.shiftKey||!this.selection[f]?(this._doDeselect=!1,this.userSelect(b,c,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,e.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||h.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(c,l,h,a,e,f){return l("dijit.tree._dndContainer",null,{constructor:function(d,b){this.tree=d;this.node=d.domNode;a.mixin(this,b);this.containerState="";h.add(this.node,"dojoDndContainer");this.events=[e(this.node,f.enter,a.hitch(this,"onOverEvent")),e(this.node,f.leave,
a.hitch(this,"onOutEvent")),c.after(this.tree,"_onNodeMouseEnter",a.hitch(this,"onMouseOver"),!0),c.after(this.tree,"_onNodeMouseLeave",a.hitch(this,"onMouseOut"),!0),e(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(a,b){var c="dojoDnd"+a;a=a.toLowerCase()+"State";h.replace(this.node,c+
b,c+this[a]);this[a]=b},_addItemClass:function(a,b){h.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){h.remove(a,"dojoDndItem"+b)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"arcgisonline/pages/portal/PortalUser":function(){define("dojo/_base/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful dojo/topic dojo/cookie dojo/json arcgisonline/sharing/util arcgisonline/sharing/dijit/Role ../pageUtil ../../sharing/geow/Folder ../portal/PortalGroup dojo/i18n!../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v){return c([l.PortalUser,d],{postscript:function(){},constructor:function(b){b=this.portal||{};var c=this.setRole(),d=b.supportsHostedServices||!1,e=b.helperServices&&b.helperServices.rasterAnalytics&&h.isDefined(b.helperServices.rasterAnalytics.url);a.mixin(this,{thumbnailUrl:this.thumbnailUrl||m.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg"),defaultThumbnailUrl:m.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg")});
this.token=this.credential&&this.credential.token;this.id=this.username;this.orgUrl=b.urlKey&&b.customBaseUrl?b.urlKey+"."+b.customBaseUrl:b.portalUrl;this.isOrgUser=b.urlKey&&b.customBaseUrl||b.isPortal?!0:!1;this.isOrgAdmin=c.isAdmin();this.canShare=!this.isOrgUser||c.canShareItemToGroup()||c.canShareItemToOrg()||b.canSharePublic&&c.canShareItemToPublic();this.canShareOthers=c.canShareOthersItemsToGroup()||c.canShareOthersItemsToOrg()||b.canSharePublic&&c.canShareOthersItemsToPublic();this.canViewOthersOrgItems=
!c.isCustom()||c.isCustom()&&c.canViewOrgItems();this.canReassignOrgItems=this.isOrgAdmin||this.userRole.canReassignOrgItems();this.canUseGeocode=(this.canCreateItems=!this.isOrgUser||c.canCreateItem())&&c.canUseGeocode();this.canPublishTiles=c.canPublishTiles();this.canPublishFeatures=c.canPublishFeatures();this.canPublishScenes=c.canPublishScenes();this.canPublishVectorTiles=c.canPublishVectorTiles();this.canPublishImageCollection=e&&c.canPublishImageCollection()?!0:!1;this.canUserPublish=d&&this.canCreateItems&&
(this.canPublishTiles||this.canPublishFeatures||this.canPublishScenes||this.canPublishVectorTiles||this.canPublishImageCollection);this.canManageLicenses=this.isOrgAdmin||c.canManageLicenses()},setRole:function(){return this.userRole=new p({portalUser:this})},getTags:function(){var b=new f;this.tags&&this.tags.length?b.resolve(this.tags):this.inherited(arguments).then(a.hitch(this,function(a){this.set("tags",a);b.resolve(this.tags)}));return b.promise},getContentTags:function(){var b=new f;this.contentTags&&
this.contentTags.length?b.resolve(this.contentTags):m.loadUserTags(this.username).then(a.hitch(this,function(a){this.set("contentTags",a);b.resolve(this.contentTags)}),a.hitch(this,function(a){this.set("contentTags",[]);b.resolve([])}));return b.promise},getCurrentFolder:function(){if(!h.isDefined(this.currentFolder)){var a=m.getCookie("ESRI_Content"),b=a&&"/"!==a.folderId?a.folderId:this.username;this.set("currentFolder",{id:b,isAll:a&&a.isAll,isHome:"/"!==b&&b&&b!==this.username?!1:!0})}return this.currentFolder},
setCurrentFolder:function(b){var c=m.getCookie("ESRI_Content"),d=b&&b.id||b||this.username,e="all"===d;b={folderId:d===this.username||e?"/":d,isAll:e,isHome:b&&b.isHome||"/"===d||!d||d===this.username?!0:!1};c=a.mixin(c,b);g("ESRI_Content",k.stringify(c),{path:"/"});this.set("currentFolder",a.mixin(b,{id:d}))},getFolders:function(){var b=new f;m.request({url:this.userContentUrl,content:{num:1}}).then(a.hitch(this,this._toFolders)).then(a.hitch(this,function(a){this.set("folders",a);b.resolve(a.slice(0))}));
return b.promise},createFolder:function(c){var d=new f,e=this.userContentUrl+"/createFolder";c={folderName:c.replace(/ /g,"_"),title:c};m.request({url:e,content:c},{usePost:!0}).then(a.hitch(this,function(a){this.folders.push(a.folder);this.folders.shift();this.set("folders",this._toFolders({folders:this.folders}));b.publish("folders/refresh");d.resolve(a.folder)}),a.hitch(function(a){d.reject(a)}));return d.promise},updateFolder:function(c,d){var e=new f;m.request({url:this.userContentUrl+"/"+c+
"/updateFolder",content:{newTitle:d}},{usePost:!0}).then(a.hitch(this,function(){return this.getFolders()}),a.hitch(function(a){e.reject(a)})).then(a.hitch(this,function(a){e.resolve(a);b.publish("folders/refresh")}),a.hitch(function(a){e.reject(a)}));return e.promise},deleteFolder:function(b){var c=new f,d;m.request({url:this.userContentUrl+"/"+b+"/delete"},{usePost:!0}).then(a.hitch(this,function(a){d=a&&a.folder&&a.folder.id;this.folders=this.folders.filter(function(a){return a&&a.id!==d});this.folders.shift();
this.set("folders",this._toFolders({folders:this.folders}));c.resolve(a.folder)}),a.hitch(function(a){c.reject(a)}));return c.promise},deleteItems:function(b){var c=new f,d=this.userContentUrl+"/deleteItems";b=b.map(function(a){return a.id});m.request({url:d,content:{items:b}},{usePost:!0}).then(a.hitch(this,function(){c.resolve(!0)}),a.hitch(this,function(a){c.reject(a)}));return c.promise},_toFolders:function(b){b=b&&b.folders||[];b=b.sort(function(a,b){return a.title.localeCompare(b.title)});q.find(b,
a.hitch(this,function(a){return a.id===this.username}))||b.unshift({username:this.username,id:this.username,title:this.username,created:"now"});return b},getGroups:function(){var b=this.portal.url+"community/users/"+this.username,c=new f;this.userGroups?c.resolve(this.adminGroups||this.userGroups):m.request({url:b}).then(a.hitch(this,function(a){this.userGroups=a&&a.groups?this._toGroup(a.groups):[];c.resolve(this.userGroups)}),a.hitch(this,function(a){c.reject(a)}));return c},getSharedOwnershipGroups:function(){var b=
new f;this.ownershipGroups&&b.resolve(0<this.ownershipGroups.length?this.ownershipGroups:null);this.getGroups().then(a.hitch(this,function(a){b.resolve(0<this.ownershipGroups.length?this.ownershipGroups:null)}));return b},_toGroup:function(b){this.ownershipGroups=[];return(b||[]).map(a.hitch(this,function(b){var c=new r(a.mixin(b,{portal:this.portal}));this._isSharedOwnershipGroup(b)&&this.ownershipGroups.push(b);return a.mixin(b,{portalGroup:c})}))},_isSharedOwnershipGroup:function(a){var b=a.capabilities&&
a.capabilities.join(",")||"";return(a.owner===this.username||!a.isViewOnly||a.userMembership&&"admin"===a.userMembership.memberType)&&-1<b.toLowerCase().indexOf("updateitemcontrol")}})})},"arcgisonline/pages/portal/PortalGroup":function(){define("require esri/declare esri/arcgis/Portal dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful arcgisonline/sharing/util ../getThumbnail ../pageUtil ../utils/getLivingAtlasCategorySet ../utils/verified ./PortalItem".split(" "),function(c,l,h,a,e,f,
d,b,g,k,m,p,q){return l([h.PortalGroup,d],{constructor:function(){this.portalUser=this.portal&&this.portal.getPortalUser()||null;this.groupContentUrl=this.url.replace("/community/","/content/");this.searchContentUrl=this.portal.portalUrl+"search";this.canShowSocialMediaLinks=b.canShowSocialMediaLinks()&&(!this.portalUser||this.portalUser&&this.portalUser.userRole.canShareGroupToPublic());this.isOwner=this.userMembership&&"owner"===this.userMembership.memberType;this.isManager=this.userMembership&&
"admin"===this.userMembership.memberType;this.isMember=this.userMembership&&"member"===this.userMembership.memberType;this.isPublic="public"===this.access;this.belongsToGroup=this.userMembership&&k.includes(["owner","admin","member"],this.userMembership.memberType);this.isSharedOwnership=k.includes(this.capabilities,"updateitemcontrol");this.isOpenDataEnabled=this.portal&&!this.portal.isPortal&&!0===this.isOpenData;this.title=this.title||"";this.snippet=this.snippet||"";this.thumbnailUrl=this.thumbnail?
this.url+"/info/"+this.thumbnail+"?token\x3d"+b.getToken():"./images/group-no-image.png"},postscript:function(){},getOwnerProfile:function(b,c){var d=this.owner,g=new f;this.ownerProfile?g.resolve(this.ownerProfile):(this.isOwner?(d=new f,d.resolve(this.portalUser)):d=this.portal.getUserProfile(d),d.then(a.hitch(this,function(d){this.isAdmin=this.isOwner||this._isGroupAdmin(d);e({folders:this.isAdmin&&c?d.getFolders():null,tags:this.isAdmin&&b?d.getTags():null,contentTags:this.isAdmin&&b?d.getContentTags():
null}).then(a.hitch(this,function(){this.set("ownerProfile",d);g.resolve(d)}))})));return g},_isOpenDataSetter:function(a){this.isOpenData=a;this.isOpenDataEnabled=this.portal&&!this.portal.isPortal&&!0===this.isOpenData},leave:function(){var c=new f;b.request({url:this.url+"/leave"},{usePost:!0}).then(a.hitch(this,function(a){this.set("isMember",!1);c.resolve(a)}));return c},join:function(){var c=new f;b.request({url:this.url+"/join"},{usePost:!0}).then(a.hitch(this,function(a){this.autoJoin&&(this.set("belongsToGroup",
!0),this.set("isMember",!0));c.resolve(a)}),a.hitch(this,function(a){c.reject(a)}));return c},getApplications:function(){var c=new f;b.request({url:this.url+"/applications"}).then(a.hitch(this,function(a){this.set("applications",a.applications);c.resolve(a.applications)}),a.hitch(this,function(a){c.reject(a)}));return c},groupContent:function(c){var d=new f;c=c||{};c=[this.groupContentUrl,"?sortField\x3d"+(c.sortField||"modified"),"\x26sortOrder\x3d"+(c.sortOrder||"desc"),"\x26num\x3d"+(c.num||12),
"\x26start\x3d"+(c.start||1)].join("");b.request({url:c}).then(a.hitch(this,this.toPortalItems)).then(function(a){d.resolve(a)},function(a){d.reject(a)});return d.promise},search:function(c){var d=new f,e=this.portal.portalUrl+"search";c=a.mixin({q:"group:"+this.id,sortField:"modified",sortOrder:"desc",num:12,start:1},c||{});b.request({url:e,content:c}).then(a.hitch(this,this.toPortalItems)).then(function(a){d.resolve(a)},function(a){d.reject(a)});return d.promise},toPortalItems:function(b){var c=
new f;b.results&&(b.items=b.results,delete b.results);var d=b.items.map(a.hitch(this,function(b){return new q(a.mixin(b,{portal:this.portal}))})).map(p.setVerifiedInfo.bind(p));e(d).then(function(a){b.items=a;c.resolve(b)},function(a){});return c.promise},groupMembers:function(c){c=c||{};c=a.mixin({sortField:"joined",sortOrder:"desc",num:25,start:1},a.clone(c));var d=new f;b.request({url:this.url+"/userlist",content:c}).then(a.hitch(this,this.toMembers)).then(function(a){d.resolve(a)},function(a){d.reject(a)});
return d.promise},toMembers:function(b){var d=new f,e=c("arcgisonline/pages/portal/PortalUser");b.users=b.users.map(a.hitch(this,function(b){return b=new e(a.mixin(b,{portal:this.portal}))}));d.resolve(b);return d.promise},itemCount:function(){var a=new f;this.search({num:1}).then(function(b){a.resolve(b&&b.total||0)});return a},_isGroupAdmin:function(a){var b=a||this.portal.portalUser||{},c=this.groupOwner||{};a=k.includes(this.members&&this.members.admins||[],b.username);var d=b.orgId||c.orgId?
b.orgId===c.orgId:!1,c=b.isOrgAdmin&&d,b=b.userRole&&b.userRole.isCustom()&&d&&b.userRole.canUpdateOrgGroups();return a||c||b},_canRemoveContent:function(a){var b=a||this.portal.portalUser||{},c=this.groupOwner||{};a=this._isGroupAdmin(a);b=b.username===c;return a||b},_canChangeOwner:function(a){a=a||this.portal.portalUser||{};var b=this.groupOwner||{},c=a.orgId||b.orgId?a.orgId===b.orgId:!1,b=a.isOrgAdmin&&c;a=a.userRole&&a.userRole.isCustom()&&c&&a.userRole.canReassignOrgGroups();return!(!b&&!a)},
_canManageMembershipRequests:function(a){a=a||this.portal.portalUser||{};var b=this.groupOwner||{},c=a.orgId||b.orgId?a.orgId===b.orgId:!1,b=k.includes(this.members&&this.members.admins||[],a.username);a=a.isOrgAdmin&&c;return!!(this.isOwner||b||a)},_canInviteOthers:function(a){var b=a||this.portal.portalUser||{};a=b.username;var c=this.groupOwner||{},d=this.members&&this.members.admins||[],e=b.orgId||c.orgId?b.orgId===c.orgId:!1,c=b.isOrgAdmin&&e,b=b.userRole&&b.userRole.isCustom()&&e&&b.userRole.canAssignUsersToOrgGroups();
a=k.includes(d,a);return!!(this.isOwner||a||c||b)},_canJoinGroup:function(a){a=a||this.portal.portalUser||{};var b=this.groupOwner||{},b=a.orgId||b.orgId?a.orgId===b.orgId:!1,c=!this.isInvitationOnly,d=!this.belongsToGroup,e=a.userRole&&a.userRole.canJoinOrgGroup();a=!a.orgId||a.userRole&&a.userRole.canJoinNonOrgGroup();return d&&c?b?e:e||a:!1},_canDeleteGroup:function(a){var b=a||this.portal.portalUser||{},c=this.groupOwner||{};a=k.includes(this.members&&this.members.admins||[],b.username);b=(b.orgId||
c.orgId?b.orgId===c.orgId:!1)&&b.userRole&&b.userRole.canDeleteOrgGroups();return!!(this.isOwner||a||b)},getCategories:function(){var c=new f,d,e,g,k;b.request({url:this.url+"/categorySchema"}).then(function(b){d=b.categorySchema||[];this.categorySchema=[];d.forEach(function(a){this._isReferencingCategorySet(a)?(e=-1<a.source.indexOf("portal.regions"),g=-1<a.source.indexOf("contentCategorySetsGroupQuery.LivingAtlas")):this.categorySchema.push(a)}.bind(this));e||g?m(this.portal,"LivingAtlas",e).then(function(b){k=
b&&b.length?b.shift():{};this.categorySchema=a.mixin(k.categorySchema,{isLivingAtlas:!0});c.resolve(this.categorySchema)}.bind(this)):c.resolve(this.categorySchema)}.bind(this),function(a){c.reject(a)});return c.promise},_isReferencingCategorySet:function(a){return a.source&&(-1<a.source.indexOf("portal.regions")||-1<a.source.indexOf("contentCategorySetsGroupQuery.LivingAtlas"))}})})},"arcgisonline/pages/utils/getLivingAtlasCategorySet":function(){define("dojo/Deferred dojo/promise/all dojo/_base/lang dojo/_base/kernel ../portal/PortalItem arcgisonline/sharing/util dojo/i18n!../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d){function b(b){var d=new c;f.request({url:b.portalUrl+"portals/self",content:{culture:a.locale,"default":!0}}).then(function(a){d.resolve(a&&a.contentCategorySetsGroupQuery)});return d}function g(a,b){var d=new c,e=require("arcgisonline/pages/portal/PortalGroup"),f;b?a.queryGroups(b,!0).then(function(b){(f=b.total?b.results.shift():null)?d.resolve(new e(h.mixin(f,{portal:a}))):d.reject(!1)}.bind(this)):d.reject(!1);return d}function k(a,b,d,e){var f=new c;e?b?m(a,e,b).then(h.hitch(this,
p,a,d)).then(function(a){f.resolve(a)}):e.groupContent().then(function(a){f.resolve(a.items)}).then(h.hitch(this,p,a,d)).then(function(a){f.resolve(a)}):f.reject(!1);return f}function m(a,b,d){var f=new c,g;b.search({q:"group:"+b.id+' typekeywords:"'+d+'"',num:1}).then(function(b){g=b.total?b.items.shift():{};f.resolve(new e(h.mixin(g,{portal:a})))}.bind(this));return f}function p(a,b,d){var e=new c;d=h.isArray(d)?d:[d];b=b&&!a.isPortal;a=d.map(h.hitch(this,q,a,b));l(a).then(function(a){e.resolve(a)});
return e}function q(a,b,d){var e=new c,f=[r(d)];b&&f.push(n(a));l(f).then(function(a){d.set("categorySchema",a);e.resolve(d)});return e}function n(a){var b=new c,e=(a.portalUser||{}).region||a.region||a.ipCntryCode||"us",f={title:"Region",description:"Living Atlas Regions",displayName:d.common.regions};a.getRegions().then(function(a){a=(a||[]).map(function(a){e.toLowerCase();a.region.toLowerCase();return h.mixin(a,{displayName:a.localizedName,name:a.region})});f=h.mixin(f,{categories:a});b.resolve(f)});
return b}function r(a){var b=new c,e,f;a.getData().then(function(a){f=(e=a&&a.categorySchema)&&e.length?e.shift():{};b.resolve(h.mixin(f,{displayName:d.GroupWidget.categories}))});return b}return function(a,d,e){var f=new c;b(a).then(h.hitch(this,g,a)).then(h.hitch(this,k,a,d,e)).then(function(a){f.resolve(a)},function(a){f.resolve(null)});return f}})},"arcgisonline/pages/utils/verified":function(){define(["require","exports","tslib","../../sharing/util","dojo/Deferred"],function(c,l,h,a,e){a=h.__importDefault(a);
e=h.__importDefault(e);return function(){function c(){}c.getVerifiedInfo=function(c){var b=new e.default,d=this.orgHash,f=c.orgId||c.portal&&c.portal.id,m=c.portal&&c.portal.isPortal;c.contentStatus&&"public_authoritative"===c.contentStatus&&f&&!m?d[f]?b.resolve(this.orgHash[f]):a.default.request({url:location.protocol+"//"+c.portal.portalHostname+"/sharing/rest/portals/"+f}).then(function(a){var c=""+(a.allSSL?"https://":"http://")+(a.urlKey||"")+"."+a.customBaseUrl+"/";d[a.id]={name:a.name,url:c+
"home/",thumbnail:a.thumbnail?c+"sharing/rest/portals/self/resources/"+a.thumbnail:"./images/group-no-image.png"};b.resolve(d[a.id])}.bind(this),function(a){}):b.resolve(!1);return b};c.setVerifiedInfo=function(a){var b=new e.default;this.getVerifiedInfo(a).then(function(c){a.verified=c;b.resolve(a)});return b};c.orgHash={};return c}()})},"arcgisonline/sharing/dijit/dialog/MoveToFolderDlg":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/_base/event dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog ../../../pages/item/_Actions ../../../pages/pageUtil ../../../sharing/geow/Content ../../../sharing/geow/Folder dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin arcgisonline/sharing/util dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/MoveToFolderDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R){return l([O,K,H,h],{baseClass:"esriMoveToFolderDlg",templateString:R,postMixInProperties:function(){this.inherited(arguments);b.mixin(this,{isBatch:this.items&&1<this.items.length});this.i18n=b.mixin({},L)},startup:function(){this.inherited(arguments);return this._initUI()},_getSelectedFolderIdAttr:function(){var a=q(".js-folders .filter-dropdown-link.is-active",this.domNode).shift();return w.get(a,"data-folder-id")},_getSelectedFolderNameAttr:function(){var a=
q(".js-folders .filter-dropdown-link.is-active",this.domNode).shift();return w.get(a,"innerHTML")},showModal:function(a){var c=new x;this.dlg=new z({title:this.i18n.itemProperties.moveToFolder,buttonOkLabel:this.i18n.items.moveTo,buttonCancelLabel:this.i18n.common.cancel,busyMessage:this.i18n.itemProperties.movingItem,style:{width:"350px",height:"450px"}});this.dlg.setContent(this.domNode);this.dlg.show();this.own(n(this.dlg,"ok",b.hitch(this,function(){this.set("readOnly",!0);this.moveItems().then(b.hitch(this,
function(d){a?c.resolve(d):(this.set("readOnly",!1),this.dlg.hide().then(b.hitch(function(){c.resolve(d)})))}),b.hitch(this,function(a){this._showError(a.errors);c.reject(a)}))})));return c},hide:function(){this.dlg&&this.dlg.hide()},moveItems:function(a){var c=new x,d=this.portalUser.username,e=this.items,f,g,k=this.get("selectedFolderId");this._getMoveableItems(e).then(b.hitch(this,function(a){a&&a.length?E.moveItemsByUser(d,e,{folder:k},b.hitch(this,function(d){a=d&&d.results||[];f=a.filter(function(a){return!a.success}).map(function(a){return a.error});
g=a.filter(function(a){return a.success}).map(function(a){return b.mixin(a,{id:a.itemId})});f&&f.length?c.reject({errors:f[0],movedItems:g}):e=e.map(function(a){a.set("folderId",k);a.set("ownerFolder",k);return a});c.resolve(e)}),b.hitch(this,function(a){c.reject({errors:a})})):c.resolve(a)}));return c},_getMoveableItems:function(a){var c=new x,d=this.get("selectedFolderId");a=a.filter(b.hitch(function(a){return!a.folderId||a.folderId!==d}));c.resolve(a);return c},createFolder:function(){var a=new x,
c=q(".js-folderName").attr("value").shift();this.portalUser.createFolder(c).then(b.hitch(this,function(b){m.publish("folders/refresh");this.currentFolder=b.id;a.resolve(b)}),b.hitch(this,function(b){a.cancel(b)}));return a},_initUI:function(){var a=new x;this._showFolders().then(b.hitch(this,function(){this._initHandlers();a.resolve(!1)}));return a},_showFolders:function(){var a=new x,c,d,e,f=q(".js-folders",this.domNode).shift(),g=!1,m=!1,n;this.portalUser.getFolders().then(b.hitch(this,function(D){c=
(this.folders=D)||[];d=this.currentFolder;y.empty(f);1<c.length&&q(".js-folder-open",this.domNode).removeClass("hide");c.length&&(n=k.map(c,b.hitch(this,function(a){g="root"===a.id||a.id===this.portalUser.username||"/"===a.id?"folder-list-link--home":"";m=a.id===d;e=a.id&&a.id!==this.portalUser.username?a.id:"/";m&&q(".js-folder-title",this.domNode).attr("innerHTML",a.title);return p.substitute("\x3ca href\x3d'#' data-folder-id\x3d'${folderId}' data-folder\x3d'${folderNameFilter}' aria-checked\x3d'${isSelected}' role\x3d'radio' class\x3d'filter-dropdown-link filter-dropdown-link-no-x ${isActive} ${isHome}'\x3e${folderName}\x3c/a\x3e",
{folderId:e,folderName:a.title,folderNameFilter:a.title.toLowerCase(),isHome:g,isActive:m?"is-active":"",isSelected:m?"true":"false"})})),y.place(n.join(""),f,"first"));a.resolve(c)}));return a},_initHandlers:function(){this.own(q(".filter-dropdown-input",this.domNode).on("keyup, search",b.hitch(this,function(a){v.stop(a);(a=w.get(a.target,"value"))?(q(".js-folders .filter-dropdown-link").addClass("hide"),q(".js-folders [data-folder*\x3d'"+a.toLowerCase()+"']").removeClass("hide")):q(".js-folders .filter-dropdown-link").removeClass("hide")})),
q(".js-folders",this.domNode).on("click",b.hitch(this,function(a){v.stop(a);a=w.get(a.target,"data-folder-id");var b=q(".js-folders [data-folder-id\x3d'"+a+"']").shift();q(".js-folders .filter-dropdown-link",this.domNode).removeClass("is-active").attr("aria-checked","false");q(".js-folders [data-folder-id\x3d'"+a+"']").attr("aria-checked","true");A.activateNode(b)})),q(".js-createFolder-form",this.domNode).on("keypress",function(a){a.stopPropagation()}),q(".js-createFolder-form",this.domNode).on("submit",
b.hitch(this,function(a){v.stop(a);if(a=q(".js-folderName").attr("value").shift().trim()){if(-1<a.indexOf("\x3c")||-1<a.indexOf("\x3e"))return this._showError({message:this.i18n.folderDlg.invalid.invalidCharacters});a&&this.createFolder().then(b.hitch(this,function(){this._showFolders().then(function(){q(".js-createFolder-form",this.domNode).forEach("item.reset();");var a=q(".js-folders",this.domNode).shift(),b=q(".filter-dropdown-link.is-active",a).shift();a.scrollTop=b.offsetTop-120}.bind(this))}),
b.hitch(this,function(a){this._showError(a)}))}else return q(".js-folderName").attr("value",""),this._showError({message:this.i18n.folderDlg.invalid.provideName})})))},_setReadOnlyAttr:function(a){m.publish("/esri/disable",a,this.i18n.itemProperties.movingItem)},_showError:function(a){a=b.mixin(b.mixin({},L.publishWizard.errors.error),a);var c=q(".js-folderName").attr("value").shift();a&&a.message&&("Unable to create folder."===a.message?a.message=p.substitute(this.i18n.folderDlg.invalid.sameFolderName,
[c]):"Item already exists in target folder"===a.message&&(a.message=p.substitute(this.i18n.itemProperties.error[this.items&&1<this.items.length?"cantMoveItemsExists":"cantMoveItemExists"],[this.get("selectedFolderName")])));m.publish("alert/show",{type:"error",text:a.message});this.set("readOnly",!1);return!1}})})},"arcgisonline/sharing/dijit/dialog/ShareOwnershipDlg":function(){define("dojo/_base/declare dojo/on dojo/dom-attr dojo/query dojo/dom dojo/dom-style dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/string dojo/_base/window dojo/promise/all dojo/when dojo/Deferred dojo/_base/array dojo/cookie dojo/dom-class dojo/json dijit/registry dijit/form/Select dojox/form/TriStateCheckBox ./ConfirmDialog dijit/focus dojo/_base/event dojo/keys dgrid/OnDemandGrid dgrid/Selection dgrid/editor dojo/store/Memory dojo/store/Observable ./_CreateItemUtilMixin dojo/topic esri/Evented esri/arcgis/Portal ../../geow/Account ../../geow/Content ../../util dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T){return c("arcgisonline.sharing.dijit.dialog.ShareOwnershipDlg",[b,g,k,M],{baseClass:"esriSharedOwnershipDlg table-layout",templateString:'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\x3cp data-dojo-attach-point\x3d"_message"\x3e${i18n.sharingDlg.sharedOwnershipMsg}\x3c/p\x3e\x3cdiv class\x3d"main"\x3e\x3cdiv id\x3d"${id}-groups" data-dojo-attach-point\x3d"_groups" \x3e\x3c/div\x3e\x3c/div\x3e\x3cp data-dojo-attach-point\x3d"_footerMessage"\x3e${i18n.sharingDlg.settingsMsg}\x3c/p\x3e',
onDone:function(){},postMixInProperties:function(){this.inherited(arguments);this.i18n=d.mixin({},T)},postCreate:function(){this.inherited(arguments);U.getSelf(d.hitch(this,function(a){this._loadConnections();this._portal=new Q.Portal({url:esriGeowConfig.restBaseUrl,self:a});this._connect=this._portal.on("load",d.hitch(this,function(){this._connect.remove();this._portalUser=this._portal.getPortalUser();this.set("disabled",!0,this.i18n.sharingDlg.fetchingGroups);return this._loadData().then(d.hitch(this,
function(a){this._createGrid(a);this.set("disabled",!1);R.publish("shareOwnership/load")}),d.hitch(this,function(a){R.publish("shareOwnership/load")}))}))}))},startup:function(){this.inherited(arguments);var a=new v,b=R.subscribe("shareOwnership/load",function(){b.remove();a.resolve()});return a},destroy:function(){a(".dijit",this.contentNode).map(dijit.byNode).forEach(function(a){a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy();a=null});this._groups.destroy();this._groupsStore=this._groups=
null;this._errorDlg&&(this._errorDlg.destroyRecursive(),this._errorDlg=null);this.inherited(arguments);this._portalUser=this._portal=null},_createGrid:function(a){a=[K({field:"visible",autoSave:!0},B),{field:"title"}];this._groups=new (c([N,O]))({selectionMode:"none",store:this._groupsStore,showHeader:!1,showLoadingMessage:!1,columns:a,sort:[{attribute:"title",descending:!1}]},this._groups);this._groups.startup();this._groups.on(".dgrid-cell.field-visible:click",d.hitch(this,function(a){a=this._groups.cell(a).element.widget;
"mixed"===(a&&a.get("checked")||!1)&&a.set("checked",!0)}))},_loadConnections:function(){this.own(R.subscribe("dlg/onOk",d.hitch(this,function(){this._focusNode&&setTimeout(d.hitch(this,function(){F.focus(this._focusNode)}),250)})),R.subscribe("/esri/disable",d.hitch(this,function(a,b){this.set("disabled",a,b,!0)})))},_loadData:function(){var a=new v,b=u.map(this.items||[],d.hitch(this,function(a){return this._getGroupsItemSharedWith(a)}));this._sharedOwnershipGroups=this._getSharedOwnershipGroups(this.groups);
this._groupsStore=new J(new H({idProperty:"id",data:this._sharedOwnershipGroups}));n(b).then(d.hitch(this,function(b){a[this._sharedOwnershipGroups&&this._sharedOwnershipGroups.length?"resolve":"reject"](this._sharedOwnershipGroups)}));return a},_setValueAttr:function(a){this.items=a.items.map(function(a){return d.mixin({},a)});this.groups=a.groups.map(function(a){return d.mixin({},a)})},_getValueAttr:function(){return{selected:this._groupsStore.query({visible:"on"}).map(function(a){return a.id}),
unselected:this._groupsStore.query({visible:!1}).map(function(a){return a.id})}},_setFocusAttr:function(b){b=a(b,this.domNode);F.focus(b&&b.length?b[0]:this._title.domNode)},_setDisabledAttr:function(a,b,c){this.set("readOnly",a,b,c)},_setReadOnlyAttr:function(b,c,d){a(".dijit",this.domNode).map(dijit.byNode).forEach(function(a){a.set("disabled",b)});a("a",this.domNode)[b?"addClass":"removeClass"]("disabledLink");a("label, p, span",this.domNode)[b?"addClass":"removeClass"]("disabled");d||(b&&c&&R.publish("/dlg/busyMessage",
c),R.publish("/esri/disable",b,c))},shareWithSelectedGroup:function(){var a=new v,b=u.map(this.items||[],"return item.id;").join(","),c=this.items&&this.items.length?this.items[0].owner:null,e={owner:c,items:b,groups:this.get("value").selected.join(","),confirmItemControl:!0},b={owner:c,items:b,groups:this.get("value").unselected.join(",")};this.set("disabled",!0,this.i18n.sharingDlg.sharingItems);n([this._shareItems(e),this._unshareItems(b)]).then(d.hitch(this,function(){this.set("disabled",!1);
a.resolve()}),d.hitch(this,function(b){this.set("disabled",!1);a.reject(b)}));return a},_shareItems:function(a){var b=new v;a.groups&&a.groups.length?S.shareItems(a,d.hitch(this,function(a){this.set("disabled",!1);b.resolve(a)}),d.hitch(this,function(a){b.reject(a)})):b.resolve([]);return b},_unshareItems:function(a){var b=new v;a.groups&&a.groups.length?S.unshareItems(a,d.hitch(this,function(a){this.set("disabled",!1);b.resolve(a)}),d.hitch(this,function(a){b.reject(a)})):b.resolve([]);return b},
_getGroupsItemSharedWith:function(a){a=this._portal.portalUrl+"content/items/"+a.id+"/groups";var b=this.items&&this.items.length||0,c,e=new v;G.request({url:a}).then(d.hitch(this,function(a){a=this._getSharedOwnershipGroups(a.admin).concat(this._getSharedOwnershipGroups(a.member)).concat(this._getSharedOwnershipGroups(a.other));u.forEach(a||[],d.hitch(this,function(a){c=this._groupsStore.get(a.id);c.shareCount=c.shareCount?c.shareCount+1:1;c.visible=c.shareCount===b?"on":"mixed";this._groupsStore.put(c)}));
e.resolve(a)}));return e},_getSharedOwnershipGroups:function(a){var b,c=this._portalUser&&this._portalUser.username;return u.filter(a||[],d.hitch(this,function(a){b=a.capabilities&&a.capabilities.join(",")||"";return(a.owner===c||!a.isViewOnly||a.userMembership&&"admin"===a.userMembership.memberType)&&-1<b.toLowerCase().indexOf("updateitemcontrol")}))},validate:function(){var a=new v,b;this._focusNode=null;b=this._checkRequired();b=b.then(d.hitch(this,function(b){a.resolve(b)}),d.hitch(this,function(b){this._showError(b);
a.reject(b)}));return a},_checkRequired:function(){var a=new v;a.resolve(!0);return a},_showError:function(a){a=d.mixin(d.mixin({},T.publishWizard.errors.error),a);this._errorDlg=new z({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(a).then(d.hitch(this,function(){this.set("disabled",!1);this._errorDlg.hide();this._focusNode&&setTimeout(d.hitch(this,function(){F.focus(this._focusNode)}),250)}));return!1}})})},"dojox/form/TriStateCheckBox":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/event dojo/query dojo/dom-attr dojo/text!./resources/TriStateCheckBox.html dijit/form/Button dijit/form/_ToggleButtonMixin dojo/NodeList-dom".split(" "),
function(c,l,h,a,e,f,d,b,g,k){return l("dojox.form.TriStateCheckBox",[g,k],{templateString:b,baseClass:"dojoxTriStateCheckBox",type:"checkbox",states:"",_stateLabels:null,stateValue:null,_currentState:0,_stateType:"False",readOnly:!1,checked:"",_aria_attr:"aria-checked",constructor:function(){this.states=[!1,"mixed",!0];this.checked=!1;this._stateLabels={False:"\x26#9633;",True:"\x26#8730;",Mixed:"\x26#9632;"};this.stateValues={False:!1,True:"on",Mixed:"mixed"}},_fillContent:function(a){},postCreate:function(){d.set(this.stateLabelNode,
"innerHTML",this._stateLabels[this._stateType]);this.inherited(arguments)},startup:function(){this.set("checked",this.params.checked||this.states[this._currentState]);d.set(this.stateLabelNode,"innerHTML",this._stateLabels[this._stateType]);this.inherited(arguments)},_setIconClassAttr:null,_setCheckedAttr:function(a,b){var c=h.indexOf(this.states,a);0<=c&&(this._currentState=c,this._stateType=this._getStateType(a),d.set(this.focusNode,"value",this.stateValues[this._stateType]),d.set(this.stateLabelNode,
"innerHTML",this._stateLabels[this._stateType]),this.inherited(arguments))},setChecked:function(a){c.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)},_setStatesAttr:function(b){if(a.isArray(b))this._set("states",b);else if(a.isString(b)){var c={"true":!0,"false":!1,mixed:"mixed"};b=b.split(/\s*,\s*/);for(var d=0;d<b.length;d++)b[d]=void 0!==c[b[d]]?c[b[d]]:!1;this._set("states",b)}},_setReadOnlyAttr:function(a){this._set("readOnly",a);
d.set(this.focusNode,"readOnly",a)},_setValueAttr:function(a,b){"string"==typeof a&&0>h.indexOf(this.states,a)&&(""==a&&(a="on"),this.stateValues.True=a,a=!0);this._created&&(this._currentState=h.indexOf(this.states,a),this.set("checked",a,b),d.set(this.focusNode,"value",this.stateValues[this._stateType]))},_setValuesAttr:function(a){this.stateValues.True=a[0]?a[0]:this.stateValues.True;this.stateValues.Mixed=a[1]?a[1]:this.stateValues.Mixed},_getValueAttr:function(){return this.stateValues[this._stateType]},
reset:function(){this._hasBeenBlurred=!1;this.set("states",this.params.states||[!1,"mixed",!0]);this.stateValues=this.params.stateValues||{False:!1,True:"on",Mixed:"mixed"};this.set("values",this.params.values||[]);this.set("checked",this.params.checked||this.states[0])},_onFocus:function(){this.id&&f("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&f("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.mouseFocus=
!1;this.inherited(arguments)},_onClick:function(a){if(this.readOnly||this.disabled)return e.stop(a),!1;this.click();return this.onClick(a)},click:function(){this._currentState>=this.states.length-1?this._currentState=0:-1==this._currentState?this.fixState():this._currentState++;var a=this._currentState;this.set("checked",this.states[this._currentState]);this._currentState=a;d.set(this.stateLabelNode,"innerHTML",this._stateLabels[this._stateType])},fixState:function(){this._currentState=this.states.length-
1},_getStateType:function(a){return a?"mixed"==a?"Mixed":"True":"False"},_onMouseDown:function(){this.mouseFocus=!0}})})},"arcgisonline/sharing/dijit/dialog/RateLimiting":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-class dojo/dom-style dojo/dom-attr dojo/string dojo/on dojo/aspect dojo/dom dojo/dom-construct dojo/query dojo/parser dojo/ready dijit/registry dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/ValidationTextBox dojo/Deferred dijit/Dialog dijit/form/Button dojo/json arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/ConfirmDialog dojox/validate/regexp esri/Evented dojo/text!arcgisonline/sharing/dijit/dialog/templates/RateLimiting.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K){return c("arcgisonline.sharing.dijit.dialog.RateLimiting",[u],{templateString:O,baseClass:"esriRateLimiting",buildRendering:function(){this.inherited(arguments);var d=a.doc.createDocumentFragment();this._templateDijit=new (c([u,w,t],{templateString:b.substitute(this.templateString,{i18n:K},null,this)}));this._content=p.place(this._templateDijit.domNode,d,"first");this.inherited(arguments);this.domNode.appendChild(this._content)},
postMixInProperties:function(){this.inherited(arguments);this.i18n=l.mixin(l.mixin({},K.common),K.itemProperties);this.serviceProxyParams=this.serviceProxyParams&&(this.serviceProxyParams.hitsPerInterval||this.serviceProxyParams.referrers)?this.serviceProxyParams:this.item&&this.item.serviceProxyParams||null},postCreate:function(){this.inherited(arguments);this._enableLimits=this._templateDijit._enableLimits;this._hitRate=this._templateDijit._hitRate;this._hitCount=this._templateDijit._hitCount;this._interval=
this._templateDijit._interval;this._referrerUrl=this._templateDijit._referrerUrl;this._referrers=this._templateDijit._referrers;this._addBtn=this._templateDijit._addBtn;this._delBtn=this._templateDijit._delBtn;this._loadConnections();this.set("value",this.serviceProxyParams)},destroy:function(){this._templateDijit.destroyRecursive();this._templateDijit=null;this.inherited(arguments)},_loadConnections:function(){this.own(g(this._enableLimits,"change",l.hitch(this,function(a){this._hitRate.set("disabled",
!0!==a);this._hitCount.set("disabled",!0!==a);this._interval.set("disabled",!0!==a);q(".canDisable")[!0!==a?"addClass":"removeClass"]("disabled");e[!0!==a?"add":"remove"](this._interval.domNode,"dijitTextBoxDisabled")})),g(this._addBtn,"click",l.hitch(this,function(){this._referrerUrl.isValid()&&(this._addReferralUrl(this._referrerUrl.get("value").split(/[ ,]+/)),this._referrerUrl.set("value",""))})),g(this._delBtn,"click",l.hitch(this,function(){this._referrers.getSelected().orphan();this._delBtn.set("disabled",
!this._referrers.getSelected().length)})),g(this._referrers,"blur, click",l.hitch(this,function(){this._delBtn.set("disabled",!this._referrers.getSelected().length)})))},_setDisabledAttr:function(a){var b=v.findWidgets(this.domNode).concat(v.findWidgets(this._content));h.forEach(b,function(b){b.set("disabled",a)});e[a?"add":"remove"](this._interval.domNode,"dijitTextBoxDisabled")},_addReferralUrl:function(a){var b;h.forEach(a,l.hitch(this,function(a){a&&((b=q("option",this._referrers.containerNode).some(function(b){return b.value.toLowerCase()===
a.toLowerCase()}))||this._referrers.containerNode.appendChild(p.create("option",{value:a,innerHTML:a})))}))},isValid:function(){return this._enableLimits.get("checked")&&!this._hitRate.isValid()?K.rateLimiting.errors.invalidHitRate:!0},_setValueAttr:function(a){this.serviceProxyParams=a;this._enableLimits.set("value",null);a&&(a.hitsPerInterval&&(this._hitRate.set("value",a.hitsPerInterval),this._interval.set("value",a.intervalSeconds),this._enableLimits.set("value","true"),this._extractUnits(a.intervalSeconds)),
this._addReferralUrl(a.referrers))},_extractUnits:function(a){var b=this._interval.options,c=parseInt(a,10);a=1;(b=h.filter(b,function(a){return 0===c%parseInt(a.value,10)}))&&b.length&&(a=b[b.length-1].value,this._interval.set("value",a),this._hitCount.set("value",Math.floor(c/parseInt(a,10))))},_getValueAttr:function(){var a={},b=[];q("option",this._referrers.containerNode).forEach(function(a){b.push(a.value)});this._enableLimits.get("checked")&&(a.hitsPerInterval=parseInt(this._hitRate.get("value"),
10),a.intervalSeconds=parseInt(this._hitCount.get("value"),10)*parseInt(this._interval.get("value"),10));b&&b.length&&(a.referrers=b);return a},showModal:function(b){var c=new C,d=new x({}),e=this.item.folderId,f=a.doc.createDocumentFragment(),k=p.place(this.domNode,f),m=p.create("div",{"class":"esriFloatTrailing esriTimeSettingsButtons"},k),k=new B({"class":"calcite cancel right btn-two",label:this.i18n.cancel,type:"button"},p.create("button",{},m)),m=new B({"class":"calcite primary right",label:this.i18n.ok,
type:"button"},p.create("button",{},m));this.own(g(m,"click",l.hitch(this,function(){this.set("disabled",!0);var a=esriGeowConfig.restBaseUrl+"content/users/"+this.item.owner+"/"+(e?e+"/":"")+"items/"+this.item.id,b,c=this.isValid();if(!0!==c)this._showError(c),this.set("disabled",!1);else return b=this.get("value"),F.request({url:a+"/update",content:{serviceProxyParams:z.stringify(b)}},{usePost:!0}).then(l.hitch(this,function(){this.item.serviceProxyParams=b;d.hide()}),l.hitch(this,function(a){this._showError(a);
this.set("disabled",!1)}))})),g(k,"click",l.hitch(this,function(){d.hide()})),g(d,"hide",l.hitch(this,function(){d.destroyRecursive();c.resolve(this.item)})));d.set("title",b&&b.title||this.i18n.rateLimitingTitle);d.setContent(f);d.show();return c},_showError:function(a){a=a.error||a||this.i18n.errors.error;a.code=a.messageCode||a.code;a=this.i18n.errors[a.code]||a||this.i18n.errors.error;a.details=a.details&&l.isArray(a.details)&&a.details.length?h.filter(a.details,"return item !\x3d\x3d null"):
null;if(a.details&&a.details.length){var b="\x3cul\x3e";h.forEach(a.details,function(a){b+="\x3cli\x3e"+a+"\x3c/li\x3e"});b+="\x3c/ul\x3e\x3cbr/\x3e";a.message=a.message?"\x3cdiv\x3e"+a.message+"\x3c/div\x3e\x3cbr/\x3e"+b:b}if(a.message&&-1===a.message.indexOf("Request canceled")){a=l.mixin(l.mixin({hideCancel:!0},this.i18n.errors.error),a);var c=new A({});return c.show(a).then(l.hitch(this,function(){c.hide().then(dojo.hitch(this,function(){this.set("disabled",!1)}))}))}}})})},"arcgisonline/sharing/dijit/dialog/LayerTimeSettings":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-attr dojo/query dojo/on dojo/json dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Dialog dijit/form/CheckBox dijit/form/RadioButton dijit/form/Select dijit/form/Button dojo/Deferred arcgisonline/sharing/util ../../../pages/serviceUtil arcgisonline/sharing/dijit/dialog/ConfirmDialog esri/Evented dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A){return c("arcgisonline.sharing.dijit.dialog.LayerTimeSettings",[p,F],{baseClass:"esriLayerTimeSettings",postMixInProperties:function(){this.inherited(arguments);this.i18n=l.mixin({},A.common);this.i18n=l.mixin(this.i18n,A.layerTimeSettings);this.portal=this.item&&this.item.portal||{};this._isPortal=x.isPortal()},buildRendering:function(){var a=document.createDocumentFragment();e.create("p",{innerHTML:this.i18n.header},a);this._enableTimeChk=
new u({checked:!1,name:"enableTimeCheckbox"});a.appendChild(this._enableTimeChk.domNode);e.create("label",{"for":"enableTimeCheckbox","class":"esriLeadingMargin1 inline-block trailer-half",innerHTML:this.i18n.enableTimeLbl},a);e.create("br",{},a);e.create("p",{innerHTML:this.i18n.fieldsetLbl,"class":"trailer-half"},a);this._fieldSet=e.create("fieldset",{"class":"esriLeadingMargin2 padding-left-1 trailer-half fieldset-checkbox"},a);this._timeEventsRdio=new w({name:"times",checked:!0},e.create("input",
{},this._fieldSet));e.create("label",{"for":"timeEvents","class":"esriLeadingMargin1 inline-block",innerHTML:this.i18n.timeEventsLbl},this._fieldSet);e.create("br",{},this._fieldSet);this._timeEventsDiv=e.create("div",{"class":"esriLeadingMargin23"},this._fieldSet);e.create("label",{"for":"timeEventsSelect","class":"esriFloatLeading timeEvent",innerHTML:this.i18n.timeFieldLbl},this._timeEventsDiv);this._timeEventsSelect=new t({maxHeight:200,name:"timeEventsSelect"},e.create("select",{},this._timeEventsDiv));
e.create("br",{},this._fieldSet);this._timeRangesRdio=new w({name:"times","class":"timeRangeRdio"},e.create("input",{},this._fieldSet));e.create("label",{"for":"timeRanges","class":"esriLeadingMargin1 inline-block",innerHTML:this.i18n.timeRangesLbl},this._fieldSet);e.create("br",{},this._fieldSet);this._timeRangesDiv=e.create("div",{"class":"esriLeadingMargin23"},this._fieldSet);e.create("label",{"for":"startTimeSelect","class":"esriFloatLeading timeRange",innerHTML:this.i18n.startTimeLbl},this._timeRangesDiv);
this._startTimeSelect=new t({maxHeight:200,name:"startTimeSelect","class":"timeRange",disabled:!0},e.create("select",{},this._timeRangesDiv));e.create("br",{},this._timeRangesDiv);e.create("label",{"for":"endTimeSelect","class":"esriFloatLeading timeRange leader-half",innerHTML:this.i18n.endTimeLbl},this._timeRangesDiv);this._endTimeSelect=new t({maxHeight:200,name:"endTimeSelect","class":"timeRange",disabled:!0},e.create("select",{},this._timeRangesDiv));e.create("br",{},this._timeRangesDiv);this.inherited(arguments);
this.domNode.appendChild(a)},postCreate:function(){this.timeInfo=this.get("timeInfo");this.fields=this.get("dateFields");this._loadConnects();this._loadLayerFields();this._loadTimeInfo()},_loadConnects:function(){this.own(k(this._timeRangesRdio,"change",l.hitch(this,function(a){h.forEach(r.findWidgets(this._timeRangesDiv),function(b){b.set("disabled",!a)})})),k(this._timeEventsRdio,"change",l.hitch(this,function(a){this.options&&1<this.options.length&&h.forEach(r.findWidgets(this._timeEventsDiv),
function(b){b.set("disabled",!a)})})),k(this._enableTimeChk,"change",l.hitch(this,function(a){var b=this.options&&1<this.options.length;h.forEach(r.findWidgets(this._fieldSet),function(c){a=!b&&-1<c["class"].indexOf("timeRange")?!1:a;c.set("disabled",!a)});this[this._timeRangesRdio.get("checked")?"_timeEventsRdio":"_timeRangesRdio"].onChange(!1)})))},_getValueAttr:function(){return this._enableTimeChk.get("checked")?this._timeEventsRdio.get("checked")?{timeInfo:{startTimeField:this._timeEventsSelect.get("value")}}:
{timeInfo:{startTimeField:this._startTimeSelect.get("value"),endTimeField:this._endTimeSelect.get("value")}}:{timeInfo:this._isPortal?null:{}}},_setDisabledAttr:function(a){h.forEach(r.findWidgets(this.domNode),function(b){b.set("disabled",a)});dojo.query(".js-timeOptions-btn").map(dijit.byNode).forEach(function(b){b.set("disabled",a)});dojo.query(".js-timeOptions-msg")[a?"removeClass":"addClass"]("hide")},_getTimeInfoAttr:function(){var a=this.layer;return this.timeInfo||a.timeInfo||{}},_getDateFieldsAttr:function(){return B.getDateFields(this.layer)},
_loadLayerFields:function(){this.options=h.map(this.fields,l.hitch(this,function(a){return{label:a.alias||a.name,value:a.name}}));this._timeEventsSelect.set("options",this.options);this._timeEventsSelect.set("value",this.options[0].value);this.options&&1<this.options.length&&(this._startTimeSelect.set("options",l.clone(this.options)),this._startTimeSelect.set("value",this.options[0].value),this._endTimeSelect.set("options",l.clone(this.options)),this._endTimeSelect.set("value",this.options[1].value))},
_loadTimeInfo:function(){var a=this.timeInfo||{};this._enableTimeChk.set("checked",a.startTimeField);this._timeEventsSelect.set("value",a.startTimeField);this._startTimeSelect.set("value",a.startTimeField);this._endTimeSelect.set("value",a.endTimeField||this._endTimeSelect.get("value"));this._timeRangesRdio.set("checked",this.timeInfo.startTimeField&&this.timeInfo.endTimeField);this._timeEventsRdio.set("checked",!this.timeInfo.endTimeField)},showModal:function(b){var c=new C,d=new v({style:{width:"450px"}}),
f=a.doc.createDocumentFragment();e.place(this.domNode,f);var g=e.create("div",{"class":"esriFloatTrailing esriTimeSettingsButtons right"},f);e.create("span",{"class":"hide margin-right-half js-timeOptions-msg",innerHTML:A.timeSettingsDlg.statusMsg},g);var n=new y({"class":"calcite primary js-timeOptions-btn",label:this.i18n.ok,type:"button"},e.create("button",{},g)),g=new y({"class":"calcite cancel js-timeOptions-btn",label:this.i18n.cancel,type:"button"},e.create("button",{},g));this.own(k(g,"click",
l.hitch(this,function(){d.hide()})),k(d,"hide",l.hitch(this,function(){d.destroyRecursive();c.resolve(this.item)})),k(n,"click",l.hitch(this,function(){this.set("disabled",!0);var a=this.get("value"),b={updateDefinition:m.stringify(a)},e=(this.item.adminUrl||this.item.url.replace("/rest/","/rest/admin/"))+"/"+this.layer.id+"/updateDefinition";a.timeInfo&&a.timeInfo.startTimeField&&a.timeInfo.startTimeField===a.timeInfo.endTimeField?(this.set("disabled",!1),this._showError(A.itemProperties.error.sameTimeField)):
x.request({url:e,content:b},{usePost:!0}).then(l.hitch(this,function(b){this.item.set("maxAgeCheck",!0);this.layer=l.mixin(this.layer,a);d.hide();c.resolve(a)}),l.hitch(this,function(a){this.set("disabled",!1);return this._showError(a)}))})));d.set("title",b&&b.title||A.timeSettingsDlg.timeSettingsDlgTitle);d.setContent(f);d.show();return c},_showError:function(a){a=a&&a.error||a||this.i18n.errors.genericError;a.code=a.messageCode||a.code;a=this.i18n.errors[a.code]||a||this.i18n.errors.error;a.details=
a.details&&l.isArray(a.details)&&a.details.length?h.filter(a.details,"return item !\x3d\x3d null"):null;if(a.details&&a.details.length){var b="\x3cul\x3e";h.forEach(a.details,function(a){b+="\x3cli\x3e"+a+"\x3c/li\x3e"});b+="\x3c/ul\x3e\x3cbr/\x3e";a.message=a.message?"\x3cdiv\x3e"+a.message+"\x3c/div\x3e\x3cbr/\x3e"+b:b}if(a.message&&-1===a.message.indexOf("Request canceled")){a=l.mixin(l.mixin({hideCancel:!0},this.i18n.errors.error),a);var c=new z({});return c.show(a).then(l.hitch(this,function(){c.hide().then(dojo.hitch(this,
function(){this.set("disabled",!1)}))}))}}})})},"arcgisonline/sharing/dijit/dialog/AddItem":function(){define("require esri/declare esri/config dojo/on dojo/when dojo/json dojo/sniff dojo/query dojo/topic dojo/string dojo/number dojo/Deferred dojo/promise/all dojo/dom dojo/dom-attr dojo/dom-style dojo/dom-construct dojo/dom-form dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/store/Memory dojo/data/ObjectStore dijit/registry dijit/form/Form dijit/form/Select dijit/form/Button dijit/Dialog dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dojox/validate/regexp dojox/widget/Standby dojox/form/manager/_Mixin dojox/form/manager/_NodeMixin dojox/form/manager/_EnableMixin dojox/form/manager/_ValueMixin dojox/form/manager/_DisplayMixin dojox/form/manager/_ClassMixin dojox/grid/DataGrid esri/layers/wms esri/layers/KMLLayer esri/IdentityManager esri/dijit/Tags arcgisonline/esriGeowConfig arcgisonline/pages/pageUtil arcgisonline/pages/utils/categories arcgisonline/pages/dijit/CategoryPicker arcgisonline/sharing/util arcgisonline/sharing/dijit/dialog/_AddItemDlgMixin arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/sharing/dijit/dialog/ChoiceDlg arcgisonline/sharing/dijit/HelpManager arcgisonline/sharing/dijit/ServiceInfo arcgisonline/sharing/dijit/_TimezoneUtils arcgisonline/sharing/geow/Item arcgisonline/map/thumbnail/buildThumbnailURLFromKMLItem arcgisonline/map/thumbnail/buildThumbnailURLFromFSUrl arcgisonline/map/core/buildExportCall arcgisonline/map/core/projectExtent arcgisonline/map/core/sameSpatialReference dojo/text!arcgisonline/sharing/dijit/dialog/templates/AddItemDlg.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca,V,aa,ba,ea,Y,ha,Z,ga,W,ia,da,ma,ka,ja,pa,la,qa,na,fa){return l([A,K,R,M,Q,U,S,G,ha],{templateString:na,baseClass:"esriAGOAddItemForm",_requestParams:{f:"json"},postMixInProperties:function(){this.inherited(arguments);this.i18nCSV=t.mixin({},fa.CsvLocationDlg);this.i18n=t.mixin({},fa.common,fa.addItemFrm);this.i18n=t.mixin(this.i18n,{fileZipFormat:fa.attachCodeDlg.fileZipFormat});this.i18n=t.mixin(this.i18n,
{itemProperties:fa.itemProperties});this.i18n=t.mixin(this.i18n,{addLayerFromUrlDlg:fa.addLayerFromUrlDlg});this.countryCodes=t.mixin({},fa.countryCodes);this.timeZones=t.mixin({},fa.timeZones);this._publishTypes={tilepackage:1,csv:1,shapefile:1,servicedefinition:1,filegeodatabase:1,geojson:1,json:1,vectortilepackage:1,scenepackage:1,featurecollection:1,notebook:1};this._maxFileSize=1E9;this.item=t.mixin({},this.item)},startup:function(){this.inherited(arguments);this._loadConnections();this._errorDlg=
Z.prototype.statics.getInstance();this._choiceDlg=ga.prototype.statics.getInstance();this._timezoneUtils=da.TimezoneUtils;this._user=t.mixin(Y.getUser(),this.overrideUser||{});this._restBaseUrl=V.allSSL?V.restBaseUrl.replace("http:/","https:/"):V.restBaseUrl;this._restBaseUrl+=this._restBaseUrl.lastIndexOf("/")===this._restBaseUrl.length-1?"":"/";this._portalUrl=this._restBaseUrl+"portals";this._contentUri=this._restBaseUrl+"content";this._publishUri=this._contentUri+"/users/"+this._user.username;
this._userContentUri=this._publishUri+(this.folder&&"/"!==this.folder?"/"+this.folder:"");this._geocodeServiceUrl=this._agoGeocodeServiceUrl="arcgis.com/arcgis/rest/services/world/geocodeserver";this._geocodeServers=(this._helperServices=V.self&&V.self.helperServices)&&this._helperServices.geocode;this._rasterAnalyticsServer=this._helperServices&&this._helperServices.rasterAnalytics;this._isPortal=V.self.isPortal;this._isCustomRole=V.userRole&&V.userRole.isCustom();this._isAdmin=V.userRole&&V.userRole.isBasedOnAdmin();
this._roleCanPublishFeatures=(this._roleCanCreateItem=V.userRole&&V.userRole.canCreateItem())&&V.userRole.canPublishFeatures();this._roleCanPublishTiles=this._roleCanCreateItem&&V.userRole.canPublishTiles();this._roleCanUseGeocode=this._roleCanCreateItem&&V.userRole.canUseGeocode();this._roleCanPublishScenes=this._roleCanCreateItem&&V.userRole.canPublishScenes();this.changingGeocodeCountry=!1;if((this._geocodeServers=Y.filterBatchGeocoders(this._geocodeServers,!this._roleCanUseGeocode))&&this._geocodeServers.length)this._roleCanUseGeocode=
!0,this._setGeocoder(this._geocodeServers[0].url),this._setGeocoderOptions(),2>this._geocodeServers.length&&b(".multigeocode").style("display","none");else{var c=Y.filterNonWorldGeocoders(this._helperServices&&this._helperServices.geocode);this._geocodeServiceUrl=(c=c&&c.length?c[0]:null)&&c.url||(this._isPortal?null:this._geocodeServiceUrl)}this._isPortal&&this._rasterAnalyticsServer&&esri.isDefined(this._rasterAnalyticsServer.url)&&(this._publishTypes.imagecollection=1);this._isPortal&&(delete this.i18n.locationTypes.mgrs,
delete this.i18n.locationTypes.usng);h.defaults.io.proxyUrl=V.proxyServer;if(!this.item){var c=u.create("a",{className:"icon-ui-question margin-left-half font-size--1 help-icon",title:this.i18n.helpIconSupportedItems,href:V.self?V.self.helpBase+V.self.helpMap.m["120000456"]:"",target:"_blank"}),d=b(".dijitDialogTitle",this.dialog.domNode);u.place(c,d[0],"last")}this._requestParams.token=this._user.token;this._basicStandby=new L({target:this.dialog&&this.dialog.domNode||this.containerNode});C.body().appendChild(this._basicStandby.domNode);
this._basicStandby.startup();this._serviceInfoPane=new ia({},b(".credentials")[0]);this._serviceInfoPane.setProtocolErrorHandler(t.hitch(this,"_showReloadDlg"));this._credentialConnect=a(this._serviceInfoPane,"credentialChange",t.hitch(this,function(){clearTimeout(this._changeCredentialTimeout);this._changeCredentialTimeout=setTimeout(t.hitch(this,function(){var a=this._serviceInfoPane.get("userInfo");a&&a.username&&a.password&&(this.disable(!1,this.i18n.fetching),this._getServiceInfo(this.elementValue("url"),
this.elementValue("title"),this.item.type))}),250)}));this._fetchCountryCodes();this._fetchTimeZones();if(V.self.user&&V.self.user.orgId){var e=F.byId("archiveSelect");this.itemInfo=t.mixin(this.itemInfo,this.orgOnly);y.forEach(["Pages","Numbers","Keynote","ImageCollection"],t.hitch(this,function(a){e.addOption({value:a.toLowerCase(),label:this.i18n["item"+a]})}));b(".orgOnly").style("display","");this._isAdmin?b(".adminOnly").style("display",""):b(".adminOnly").style("display","none")}Y.loadUserTags(this._user.username).then(t.hitch(this,
function(a){this._tags.set("knownTags",a);this._updateUI();this.allowPublish&&this.item&&this._tags.set("tags",this.item.tags)}));this.message&&r.set(this._instructions,"innerHTML",this.message);if("file"===this.selected||"url"===this.selected||"app"===this.selected)esri.hide(this.itemType.domNode),esri.hide(this.addItemLbl),this.itemType.set("value",this.selected);this.allowPublish&&this.item&&this.startupForPublish();if(V.self.hasCategorySchema){var f=function(a){this._categories=new ea({categories:this.allowPublish&&
this.item&&this.item.categories?this.item.categories:[],schema:a},this._categoriesContainer);this._categories.startup();aa.showNodes(b(".categories-container",this.domNode))}.bind(this);this.item&&this.item.portal?this.item.portal.getCategories().then(f):this._util.request({url:V.restBaseUrl+"portals/self/categorySchema"}).then(function(a){f(a.categorySchema)}.bind(this))}},_setGeocoderOptions:function(){for(var a=[],b=0;b<this._geocodeServers.length;b++)a.push({label:this._geocodeServers[b].name,
value:this._geocodeServers[b].url});this._geocoderSelect.set("options",a);this._geocoderSelect.set("value",this._geocodeServers[0].name,!1)},_setGeocoder:function(a){var b=this._findGeocoder(a);this._geocodeServiceUrl=a;this._isAgoWorldGeocodeServer=Y.isEsriWorldGeocoderNoProxy(b);this._isServiceProxyAgoWorldGeocodeServer=Y.isEsriWorldGeocoderThroughProxy(b);this._isWorldGeocodeServer=this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer;a=!0;this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer||
(a=!!b.batch);this._allowGeocode=(!this._isCustomRole||this._roleCanUseGeocode)&&(!this._isPortal&&a||this._isPortal&&(!this._isAgoWorldGeocodeServer||this._isServiceProxyAgoWorldGeocodeServer)&&a)},_findGeocoder:function(a){var b=this._geocodeServers.filter(function(b){return b.url===a});return b&&b.length?b.shift():null},startupForPublish:function(){this._publishOnly=!0;this.itemInfo=t.mixin(this.itemInfo,this.orgOnly);this.elementValue("title",this.item.title);this._publishInstructions.innerHTML=
"notebook"===this.item.classification?this.i18n.publishNotebookInstructions:this.i18n.publishInstructions;this.formWidgets.addItem.widget.set("label",this.i18n.publishItem);this.item.type=this.item.type.replace(/\s+/g,"").toLowerCase();"microsoftexcel"===this.item.type&&(this.item.type="xlsx");this._updateUI("servicedefinition"===this.item.type?"title":null,this.item.type);this._updateUI("addNew","publishOld");this.removeClass("required",["file","url"]);"csv"===this.item.type&&this._analyze(this.item).then(t.hitch(this,
"_loadCSV"));"xlsx"===this.item.type?this._analyze(this.item).then(t.hitch(this,"_loadExcel")):this.item.publishParameters={}},enable:function(){this.inherited(arguments);b("a",this.containerNode).removeClass("disabledLink");esri.hide(this.spinnerNode);this._serviceInfoPane&&this._serviceInfoPane.set("disabled",!1)},disable:function(a,c){this.inherited(arguments);r.set(this.spinnerNode,"innerHTML",c||this.i18n.pleaseWait);v.set(this.spinnerNode,"display","inline-block");b("a",this.containerNode).addClass("disabledLink");
this._serviceInfoPane&&this._serviceInfoPane.set("disabled",!0)},isValid:function(a){var b=this.gatherFormValues(this.i18n.errors.required),c=this.gatherClassState("required",this.i18n.errors.required),d=this.item&&this.item.type||null,e=this.elementValue("url");if(!a)for(var f in b)if(c[f]&&this._isEmpty(this.elementValue(f)))return this._showError(this.i18n.errors.required[f]);b=this._tags.get("tags");if(!b||0===b.length)return this._showError(this.i18n.errors.required.tags);if(this.item&&this.item.error)return this._showError(this.item.error);
if(c.file||a&&"file"===a){if(window.FileReader&&n.byId("file").files[0].size>this._maxFileSize)return this._showError(this.i18n.errors.fileToLarge);e=this.item.name||this.item.url||this.item.title||this.item.item}if("desktopapplication"===this.item.type&&!this.item.isZip)return this._showError({message:this.i18n.fileZipFormat});if(this._itemExists({name:e,title:this.elementValue("title"),type:this.item.type}))return!1;if(!this.itemInfo[d.toLowerCase()])return this._showError({message:this.i18n.errors.unknownType.message});
d=d&&d.toLowerCase()||null;if("opdashboardaddin"===d&&this._user&&"account_admin"!==this._user.role&&"account_publisher"!==this._user.role)return this._showError(this.i18n.errors.insuffientPrivs);if("opext"!==d||this._validateOpExtension(this._opExtensionInfo))return this.allowPublish&&!1!==this.publish&&d in this._publishTypes?(a=this.value.title.split(" ").join("_"),(this._isPortal?/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(a):/[.@#%&*+=\-\\';,\/|\\":<>\?]/g.test(a))||120<a.length?this._showError(this.i18n.errors.invalidServiceTitle):
"servicedefinition"!==d?this._serviceNameAvailable(this.item).then(t.hitch(this,function(a){return a})):!0):this._reload?(this._showReloadDlg(),!1):!0},validate:function(a,b){return(new RegExp("^(?:"+b+")")).test(this.elementValue(a))?!0:this._showError(this.i18n.errors.invalid[a])},_validateOpExtension:function(a){var c={Widget:1,"Map Tool":1,"Feature Action":1},d=[];if(!a)return this._showError({message:this.i18n.errors.opExtensionNotJson});if(!a.type||!1===a.type in c)return this._showError({message:this.i18n.errors.opExtensionInvalidType});
if(!a.runtime||!a.runtime.path)return this._showError({message:this.i18n.errors.opExtensionNoPath});a&&(a.useDataFromView&&d.push(".useDataFromView"),a.usePortalServices&&d.push(".usePortalServices"),a.useExternalAGSServices&&d.push(".useExternalAGSServices"),d.length&&(d.push(".opextwarning"),b(d.join(","),this.domNode).style("display","block")));return!0},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},changeType:function(b){delete this._reload;this._updateUI("type",b);this._updateUI(null,
"title");this._updateUI(null,"all");this.removeClass("required",["file","url"]);"file"!==b?(this.unregisterNode("file"),this.fileDiv.innerHTML=this.fileDiv.innerHTML,this.registerNode(n.byId("file")),this._fileInputConnect&&this._fileInputConnect.remove(),this._fileInputConnect=a(n.byId("file"),"change",t.hitch(this,"_getFileAndType")),this.addClass("required",["url"])):"url"!==b&&this.addClass("required",["file"]);"app"===b&&(b=this.elementValue("app"),this.changeApiType(b));this.elementValue("title",
"");this.elementValue("url","")},changeServiceType:function(a){delete this._reload;this.item=this.item||{};this.item.type=a},changeApiType:function(a){this._opExtensionInfo=null;this.item=this.item||{};this.item.type=a;this._updateUI("desktopapplication",null);this._updateUI("apiapp"===a||"opext"===a?"api":null,"apiapp"!==a&&"opext"!==a?"api":null);"opext"!==a&&b(".subtable.opextwarning",this.domNode).style("display","none");this["apiapp"===a||"desktopapplication"===a?"removeClass":"addClass"]("required",
["url"]);this["desktopapplication"===a?"addClass":"removeClass"]("required",["file"]);r.set(n.byId("urlLbl"),"innerHTML","opext"===a?this.i18n.urlManifestLbl:this.i18n.itemURL);this._updateUI("apiType",a)},changeArchive:function(a){this.item=this.item||{};this.item.type=a;this._updateUI("publish");this._updateUI("codesample");this._updateUI("arcpadpackage");this._updateUI("shapefile",!this.allowPublish&&a in this._publishTypes?null:a);this.allowPublish&&a in this._publishTypes&&(this._updateUI(null,
"publish"),r.set(this._enablePublishingLabel,"innerHTML",this.i18n["tilepackage"!==a?"publishService":"publishNamedService"]))},changePlaceholder:function(a){this.elementValue("title","");this.elementValue("url","");if(V.isRightToLeft&&(9>d("ie")||5>d("trident")))this.formWidgets.url.widget.set("placeHolder","");else{a="url"===a?this._getRadioButtonValue("web"):a;var b=this.i18n.urlRules;"ags"===a?b=this.i18n.urlRulesSvc:"app"===a||"apimobile"===a||"apimap"===a?b=this.i18n.urlRulesApp:"opext"===a&&
(b=this.i18n.urlManifest);this.formWidgets.url.widget.set("placeHolder",b)}},changeStoreCredentials:function(a){},showUserTags:function(){TagsDlg.prototype.statics.getInstance().show(this._user||null)},onPublishCheck:function(a){"csv"===this.item.type?(this._updateUI(a?null:"csv",a?"csv":null),this._updateUI(a?null:"grid",a?"grid":null),a&&this._grid.setStore(this._oStore)):"servicedefinition"===this.item.type&&this._updateUI(a?"title":null,a?null:"title");this.publish=a},onCancel:function(){this.dialog&&
this.dialog.hide()},onSubmit:function(a){a.preventDefault();this._serviceInfoPane&&this._serviceInfoPane._editingCredential&&this._serviceInfoPane.domNode?F.byId("addItem-btn").focus():e(this.isValid(),t.hitch(this,function(a){if(!a)return!1;switch(this.elementValue("itemType")){case "url":this._addService();break;case "app":this._addApplication();break;default:this._addFile()}}))},onChangeGeocoder:function(a){this._setGeocoder(a);this._analyzed=!1;this.onChangeGeocode("addressTypes",!0)},onChangeGeocode:function(a,
c){void 0!==this.item.excelInfo?"none"===a?(this._grid.layout.setColumnVisibility(1,!1),this._grid.layout.setColumnVisibility(2,!1),r.set(this.geocodeReviewMsg,"innerHTML",this.i18n.reviewTableExcel)):(this._grid.layout.setColumnVisibility("addressTypes"===a?1:2,!0),this._grid.layout.setColumnVisibility("addressTypes"===a?2:1,!1),r.set(this.geocodeReviewMsg,"innerHTML",this.i18n.reviewExcel)):"none"===a?(this._grid.layout.setColumnVisibility(2,!1),this._grid.layout.setColumnVisibility(3,!1),r.set(this.geocodeReviewMsg,
"innerHTML",this.i18n.reviewTable)):(this._grid.layout.setColumnVisibility("addressTypes"===a?2:3,!0),this._grid.layout.setColumnVisibility("addressTypes"===a?3:2,!1),r.set(this.geocodeReviewMsg,"innerHTML",this.i18n.review));this._updateUI("geocode","addressTypes"===a&&(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)?"geocode":null);var d=!0;this.item.excelInfo&&(d=c?!0:!1);if("addressTypes"===a&&!this._analyzed&&d)this.onChangeCountry();else"addressTypes"===
a&&void 0!==this.item.excelInfo&&this._checkProxyFilter();"addressTypes"!==a?b(".multigeocode").style("display","none"):1<this._geocodeServers.length&&b(".multigeocode").style("display","")},onChangeCountry:function(){this.item&&(this._basicStandby.show(),this.deleteGrid(!0),this._analyze(this.item).then(this._checkProxyFilter.bind(this)).then(t.hitch(this,function(a){this._analyzed=!0;if("xlsx"===this.item.type){var b=""===this._allExcelSheets.value?0:this._allExcelSheets.value;a.publishParameters.layers[b].sourceCountry=
a.publishParameters.layers[b].sourceCountry||"world";a.publishParameters.layers[b].sourceCountryHint="";this.changingGeocodeCountry=!0;return this._loadExcel(a)}a.publishParameters.sourceCountry=a.publishParameters.sourceCountry||"world";a.publishParameters.sourceCountryHint="";return this._loadCSV(a)})))},_checkProxyFilter:function(a){var b=new p,c=this._findGeocoder(this._geocodeServiceUrl);c.itemId?this._request(this._contentUri+"/items/"+c.itemId).then(function(c){c.proxyFilter&&f.parse(c.proxyFilter).sourceCountry?
(c=f.parse(c.proxyFilter).sourceCountry.split(",").reduce(function(a,b){a[b.toLowerCase()]=!0;return a},{world:!0}),this._fetchCountryCodes(c)):this._fetchCountryCodes();b.resolve(a)}.bind(this),function(c){this._fetchCountryCodes();b.resolve(a)}):(this._fetchCountryCodes(),b.resolve(a));return b},onChangeTimeZone:function(){},_addFile:function(){if(this.item&&(this.item.publishParameters||this._analyzeError)){this.disable(null,this.i18n.updating);var a={},b=this._tags.get("tags")||"",c=this.item.tags?
t.isArray(this.item.tags)?this.item.tags:this.item.tags.split(","):[],b=this._unique(c.concat(b.split(","))).join(",");y.indexOf(this.item.typeKeywords||[],"Route Layer");var d=["showUnmatchedAddresses"],a=t.mixin(a,{tags:b});return this._update(this.item,a).then(t.hitch(this,"_publish",this.item)).then(t.hitch(this,function(a){if(a&&a.error)return this._showError(a.error);if(a&&this.item.csvInfo)return this._fetch(a).then(t.hitch(this,function(b){d=d.concat(b&&b.item&&b.item.typeKeywords||[]);d=
this.item.csvInfo.publishParameters&&"none"===this.item.csvInfo.publishParameters.locationType?d.concat("Table"):d;return this._update({id:a.id,type:a.type},{typeKeywords:d.join(","),title:this.elementValue("title")}).then(t.hitch(this,"_showItem",a))}));if(a&&this.item.excelInfo)return this._fetch(a).then(t.hitch(this,function(b){d=d.concat(b&&b.item&&b.item.typeKeywords||[]);d=this.item.excelInfo.publishParameters&&"none"===this.item.excelInfo.publishParameters.layers[0].locationType?d.concat("Table"):
d;return this._update({id:a.id,type:a.type},{typeKeywords:d.join(","),title:this.elementValue("title")}).then(t.hitch(this,"_showItem",a))}));if("featurecollection"===this.item.type)this._fetchItemData(this.item).then(t.hitch(this,function(b){var c={layers:[]};y.forEach(b.layers||[],t.hitch(this,function(a,b){b={id:b};a&&a.popupInfo&&(b.popupInfo=t.clone(a.popupInfo));a.layerDefinition&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo&&(b.showLabels=!0);c.layers.push(b)}));
return c.layers.length?this._update({id:a.id,type:a.type},{title:this.elementValue("title"),typeKeywords:d,text:f.stringify(c)}).then(t.hitch(this,"_showItem",a)):this._update({id:a.id,type:a.type},{title:this.elementValue("title")}).then(t.hitch(this,"_showItem",a))}));else return"servicedefinition"===this.item.type?this._showItem(a):this._update({id:a.id,type:a.type},{title:this.elementValue("title")}).then(t.hitch(this,"_showItem",a))}))}this._upload().then(t.hitch(this,function(a){if(!a||!a.id)return!1;
var b=new p;a=this.item=t.mixin(this.item||{},a);a=t.mixin(a,{tags:this._tags.get("tags")});this.item=t.mixin(a,this.gatherFormValues(["title"]));switch(a.type.toLowerCase()){case "servicedefinition":b.then(t.hitch(this,"_publish",a)).then(t.hitch(this,function(a){return this._showItem(a)}));break;case "filegeodatabase":case "tilepackage":case "vectortilepackage":case "scenepackage":case "geojson":case "json":case "shapefile":b.then(t.hitch(this,"_publish",a)).then(t.hitch(this,"_showItem"));break;
case "imagecollection":this._isPortal&&this.allowPublish&&this._publishTypes.imagecollection?b.then(t.hitch(this,"_publish",a)).then(t.hitch(this,"_showItem")):b.then(t.hitch(this,"_showItem",a));break;case "csv":this.allowPublish&&this._publishTypes.csv&&!this._analyzeError?b.then(t.hitch(this,"_analyze",a)).then(t.hitch(this,"_loadCSV")):b.then(t.hitch(this,"_showItem",a));break;case "kml":case "kmz":a.url=this._contentUri+"/items/"+a.id+"/data?token\x3d"+this._user.token;b.then(t.hitch(this,"_setKmlExtent",
a)).then(t.hitch(this,function(a){return this._update(a,{extent:a.extent,url:this._contentUri+"/items/"+a.id+"/data"},!0).then(t.hitch(this,"_showItem"))}));break;default:b.then(t.hitch(this,"_showItem",a))}this._checkStatus(a,function(a){b.resolve(a)},t.hitch(this,function(a){return this._showError(a)}))}))},_addService:function(){var a;this.disable();switch(this._getRadioButtonValue("web")){case "ags":a=this._addSecureAGSService().then(t.hitch(this,"_showItem"));break;case "kml":a=this._addKMLUrl();
break;case "ogc":a=this._addOGCUrl();break;default:a=this._addUrl()}return a},_addSecureAGSService:function(){var a=this.item.serviceInfo,b=this.item.type.toLowerCase(),b=this._checkThumbnailURL(this.itemInfo[b]),b=t.mixin(b,this.gatherFormValues(["url","title"])),b=t.mixin(b,{tags:this._tags.get("tags")});if(a&&a.isSecure&&!a.userInfo)throw this._showError(this.i18n.errors.invalidCredentials),Error();if(this.item.isSecured&&"store"===this._getRadioButtonValue("storeauth")){if(!this._isPortal||this._isPortal&&
this._checkProtocol())b.serviceUsername=this._serviceInfoPane.userInfo.username,b.servicePassword=this._serviceInfoPane.userInfo.password;else throw this._basicStandby.hide(),this.enable(),Error();if(401===this.item.isSecured.httpStatusCode)return this._add(b).then(t.hitch(this,"_fetch")).then(t.hitch(this,function(a){this.item.id=a.item&&a.item.id;this.item.url=a.item&&a.item.url;this.item.sourceUrl=a.item&&a.item.sourceUrl;return this._addAGSService(!0)}));if(a&&a.isSecure&&!a.userInfo)throw this._showError(this.i18n.errors.invalidCredentials),
Error();}return this._addAGSService(!1)},_addAGSService:function(a){var b=this.item.serviceInfo,c=this.item.type.toLowerCase(),d=this._checkThumbnailURL(this.itemInfo[c]),e=t.mixin(d,this.gatherFormValues(["url","title"])),f={streamserver:1,imageserver:1},e=t.mixin(e,{tags:this._tags.get("tags")});if(!b)throw this._showError({message:esri.substitute({name:e.title},this.i18n.errors.serviceNotExist.message)}),Error(this.i18n.errors.serviceNotExist.message);d=b.documentInfo||{};e=t.mixin(e,{description:b.serviceDescription||
b.description||d.Comments||"",snippet:d.Subject||"",accessInformation:b.copyrightText||d.Credits||"",spatialReference:this._getSpatialReference(this.item),url:this.item.url||this.elementValue("url").split("?")[0]});c&&"mapserver"===c.toLowerCase()&&(e.typeKeywords+=b.singleFusedMapCache?" ,Tiled":" ,Dynamic");b&&b.type&&"Table"===b.type&&(e.typeKeywords+=", Table, Singlelayer");c&&c.toLowerCase()in f?e.typeKeywords+=" ,Singlelayer":b&&(b.layers||b.tables)&&(b.layers&&b.layers.length||!b.tables||!b.tables.length?
(b=(b.layers||[]).concat(b.tables||[]),e.typeKeywords+=1<b.length?" ,Multilayer":" ,Singlelayer"):(-1===e.typeKeywords.indexOf("Table")&&(e.typeKeywords+=" ,Table"),e.typeKeywords+=1<b.tables.length?" ,Multilayer":" ,Singlelayer"));return this._projectExtent2WGS84(e).then(t.hitch(this,"_getThumbnail",this.item,e)).then(t.hitch(this,function(a){e.thumbnailURL=a;e.thumbnailURL&&this.item.thumbnailToken&&(e.thumbnailURL+=(-1<e.thumbnailURL.indexOf("?")?"\x26":"?")+"token\x3d"+this.item.thumbnailToken);
return e}),t.hitch(this,function(a){return e})).then(t.hitch(this,function(b){return a?this._update(this.item,t.mixin(b,{url:this.item.sourceUrl}),!0):this._add(b)}))},_addKMLUrl:function(){var a=this.item.type.toLowerCase(),a=this._checkThumbnailURL(this.itemInfo[a]),b=t.mixin(a,this.gatherFormValues(["url","title"])),a=new p,b=t.mixin(b,{tags:this._tags.get("tags")});a.then(t.hitch(this,"_setKmlExtent",b)).then(function(a){ka(a)}).then(t.hitch(this,function(a){b.thumbnailURL=a;return b}),t.hitch(this,
function(a){return b})).then(t.hitch(this,"_add",b)).then(t.hitch(this,"_showItem"));a.resolve();return a},_setKmlExtent:function(b){esri.config.defaults.kmlService=V.kmlService;var c=new p,d=new D(b.url),e=a(d,"load",t.hitch(this,function(){e.remove();b.extent=this._extent2String(this._getKmlExtent(d));c.resolve(b)})),f=a(d,"error",t.hitch(this,function(a){f.remove();this._showError({message:a.message});throw a;}));return c},_getKmlExtent:function(a){a=a.getLayers();var b;y.forEach(a,function(a){a.graphics&&
0<a.graphics.length&&(a=esri.graphicsExtent(a.graphics),b=b?b.union(a):a)});return b||null},_addOGCUrl:function(){if(this.item&&this.item.ogcInfo){var a=this.item.type.toLowerCase(),a=this._checkThumbnailURL(this.itemInfo[a]),b=t.mixin(a,this.gatherFormValues(["title"])),a=this.item.ogcInfo,c=new p,d=[],e,f,g=!1,b=t.mixin(b,{tags:this._tags.get("tags")});this._grid&&this._grid.edit&&this._grid.edit.apply();e=this._mStore&&this._mStore.query({visible:!0}).map(function(a){f=f?a.extent?f.union(a.extent):
f:a.extent;d.push(a.name);var b={name:a.name,title:a.title};a.legendURL&&(b.legendURL=a.legendURL);return b});a.setVisibleLayers(d);f=f||a.fullExtent;g=!y.some(a.spatialReferences,function(a){return a===f.spatialReference.wkid});b=t.mixin(b,{url:a.url,description:a.description||"",accessInformation:a.copyright||"",text:this._getWMSData(a,e),extent:f});g&&c.then(t.hitch(this,"_project",f,new esri.SpatialReference({wkid:a.spatialReferences[0]}))).then(t.hitch(this,function(a){b.extent=a;return b}));
c.then(t.hitch(this,"_getWMSImageUrl",b,a)).then(t.hitch(this,"_add")).then(t.hitch(this,"_showItem"));c.resolve();return c}this._showError({message:esri.substitute({name:""},this.i18n.errors.serviceNotExist.message)})},_getWMSImageUrl:function(a,b){var c=new p,d=t.hitch(this,function(b){a.thumbnailURL=b||a.thumbnailURL;a.extent=this._extent2String(a.extent);c.resolve(a)});b.getImageUrl(a.extent,800,532,d,d);return c},_getWMSData:function(a,b){return f.stringify({title:a.title||"",url:a.url,mapUrl:a.getMapURL,
version:a.version,layers:b,copyright:a.copyright||"",maxHeight:a.maxHeight,maxWidth:a.maxWidth,spatialReferences:a.spatialReferences,format:"png"!==a.getImageFormat()?a.getImageFormat():null})},_addUrl:function(){var a=this._getRadioButtonValue("web"),a=this._checkThumbnailURL(this.itemInfo[a]),a=t.mixin(a,this.gatherFormValues(["url","title"])),a=t.mixin(a,{tags:this._tags.get("tags")});this.disable(["addItem","cancel"]);return this._add(a).then(t.hitch(this,"_showItem"))},_addApplication:function(){var a=
this._getRadioButtonValue("app"),b=this._checkThumbnailURL(this.itemInfo[a]),c=this.elementValue("purpose"),d=this._opExtensionInfo,e;"apiapp"!==a&&("apimobile"===a?b.typeKeywords+=", "+this.elementValue("mobileapi"):"desktopapplication"===a?b.typeKeywords+=", "+this.elementValue("apidesktopapp"):"opext"!==a&&(b.typeKeywords+=", "+this.elementValue("desktopapi")),"opext"!==a&&(b.typeKeywords+=", "+c,"selfConfigured"===c&&(b.typeKeywords+=", Configurable")),b=t.mixin(b,this.gatherFormValues(["url"])));
c=this.elementValue("title")+"_"+(new Date).getTime();e=t.mixin(b,this.gatherFormValues(["title"]));e=t.mixin(e,{name:c});e=t.mixin(e,{tags:this._tags.get("tags")});"opext"===a&&d&&(e.thumbnailURL=d.thumbnailPath?e.url.substring(0,e.url.lastIndexOf("/")+1)+d.thumbnailPath:d.iconUrl||b.thumbnailUrl,e.accessInformation=d.credits||"",e.description=d.description||"",e.summary=e.description,e.typeKeywords+=", "+d.type,e.text=f.stringify(d));this.disable(["addItem","cancel"]);if("desktopapplication"!==
a)return b=this._add(e),"apiapp"===a?b.then(t.hitch(this,"_registerApp")):b.then(t.hitch(this,"_showItem"));a=u.create("div",null,this.formNode);e.itemType="file";for(c in e)u.place(u.create("input",{name:c,type:"text",value:b[c],style:{display:"none"}}),a);u.place(u.create("input",{type:"text",name:"overwrite",value:!1,style:{display:"none"}}),a);u.place(u.create("input",{type:"text",name:"async",value:!0,style:{display:"none"}}),a);return this._addItem(this.domNode,a).then(function(a){this._checkStatus(a,
function(a){return this._showItem(a)}.bind(this),function(a){this._showError(a)}.bind(this))}.bind(this))},_upload:function(){var a=this._checkThumbnailURL(this.itemInfo[this.item.type]);if("codesample"===this.item.type||"arcpadpackage"===this.item.type||"stylx"===this.item.type)a.typeKeywords+=", "+this.elementValue(this.item.type);var b=u.create("div",null,this.formNode),a=t.mixin(a,{tags:this._tags.get("tags")}),c;for(c in a)u.place(u.create("input",{name:c,type:"text",value:a[c],style:{display:"none"}}),
b);u.place(u.create("input",{type:"text",name:"overwrite",value:!1,style:{display:"none"}}),b);u.place(u.create("input",{type:"text",name:"async",value:!0,style:{display:"none"}}),b);this.disable(["addItem","cancel"]);return this._addItem(this.domNode,b)},_add:function(a){return this._request((this._userContentUri+"/addItem").replace("http:/",a.serviceUsername&&a.servicePassword?"https:/":"http:/"),a,{usePost:!0})},_update:function(a,b,c){var d=c||!1;if(!c)for(var e in b)a[e]&&b[e]===a[e]?delete b[e]:
d=!0;if(d)return this._request(this._userContentUri+"/items/"+a.id+"/update",b,{usePost:!0});b=new p;b.resolve(a);return b},_delete:function(a){if(!this._publishOnly)return this._request(this._userContentUri+"/items/"+a.id+"/delete",{},{usePost:!0},null,function(a){})},_fetch:function(a){return this._request(this._userContentUri+"/items/"+a.id,{},{})},_registerApp:function(a){return this._request(this._restBaseUrl+"oauth2/registerApp",{itemId:a.id,appType:"multiple",redirect_uris:'["urn:ietf:wg:oauth:2.0:oob"]'},
{usePost:!0}).then(t.hitch(this,function(a){return a}),t.hitch(this,function(a){throw Error(a);})).then(t.hitch(this,"_showItem",a))},_publish:function(a){if(!this.allowPublish||!1===this.publish||this._analyzeError){var b=new p;b.resolve(a);return b}var c=a.type.toLowerCase(),b=this._getDefaultPublishParameters(a),d;if("servicedefinition"!==c){if("csv"===c){d=this.item.csvInfo.publishParameters.standardizedFieldNames;this._grid.edit.apply();var e=this._getRadioButtonValue("geocode"),g;if("addressTypes"===
e){var k=0,m={};g=d;b.publishParameters.locationType="address";this._mStore.query(function(a){"unknown"!==a.locationType&&a.locationType in g&&(m[a.locationType]=a.name,k++)});if(1>k)return{error:this.i18n.errors.noAddressFields};b.publishParameters.addressFields=m}else if("locationTypes"===e){var n={locationType:"coordinates",latitudeFieldName:null,longitudeFieldName:null};g=t.mixin({},this.i18n[e]);this._mStore.query(function(a){"mgrs"===a.locationType?(n.coordinateFieldType="MGRS",n.coordinateFieldName=
a.name):"usng"===a.locationType?(n.coordinateFieldType="USNG",n.coordinateFieldName=a.name):"unknown"!==a.locationType&&a.locationType in g&&(n[a.locationType+"FieldName"]=a.name)});if(!(n.latitudeFieldName&&n.longitudeFieldName||n.coordinateFieldType&&n.coordinateFieldName))return{error:this.i18n.errors.noLocationFields};t.mixin(b.publishParameters,n)}else b.publishParameters.locationType="none"}if("xlsx"===c)if(d=this.value.allExcelSheets,b.filetype="excel",d=b.publishParameters.layers[d],b.publishParameters.layers.length=
1,b.publishParameters.layers[0]=d,d=this.item.excelInfo.publishParameters.layers[0].standardizedFieldNames,this._grid.edit.apply(),e=this._getRadioButtonValue("geocode"),"addressTypes"===e){k=0;m={};g=d;b.publishParameters.layers[0].locationType="address";this._mStore.query(function(a){"unknown"!==a.locationType&&a.locationType in g&&(m[a.locationType]=a.name,k++)});if(1>k)return{error:this.i18n.errors.noAddressFields};b.publishParameters.layers[0].addressFields=m}else if("locationTypes"===e){n={locationType:"coordinates",
latitudeFieldName:null,longitudeFieldName:null};g=t.mixin({},this.i18n[e]);this._mStore.query(function(a){"mgrs"===a.locationType?(n.coordinateFieldType="MGRS",n.coordinateFieldName=a.name):"usng"===a.locationType?(n.coordinateFieldType="USNG",n.coordinateFieldName=a.name):"unknown"!==a.locationType&&a.locationType in g&&(n[a.locationType+"FieldName"]=a.name)});if(!(n.latitudeFieldName&&n.longitudeFieldName||n.coordinateFieldType&&n.coordinateFieldName))return{error:this.i18n.errors.noLocationFields};
t.mixin(b.publishParameters.layers[0],n)}else b.publishParameters.layers[0].locationType="none";(d=this._timezoneUtils._winZones[this._timeZones.get("value")])&&"UTC"!==d.id&&("xlsx"===c?b.publishParameters.layers[0]=t.mixin(b.publishParameters.layers[0],{dateFieldsTimeReference:{timeZone:d.id}}):b.publishParameters=t.mixin(b.publishParameters,{dateFieldsTimeReference:{timeZone:d.id}}));b.publishParameters=f.stringify(b.publishParameters)}this.disable(null,this.i18n.publishing);this.item.publishParameters=
{};return this._request(this._publishUri+"/publish",b,{usePost:!0}).then(t.hitch(this,function(b){this.item.publishParameters=a.publishParameters||{};b=y.map(b.services,t.hitch(this,function(a){var b=t.mixin(a,{id:a.serviceItemId,type:a.type||this.i18n.service,name:"Image Service"!==a.type?this.elementValue("title"):a.name,error:a.error});esri._isDefined(a.success)&&!a.success&&(a.error?a.error.message&&-1<a.error.message.indexOf("already exist")&&(a.error.message=this.i18n.errors.serviceDefinitionExists.message):
b.error=this.i18n.errors.publishError);if("tilepackage"===c||"scenepackage"===c)b.buildCache=!0;return b}));return!b||1!==b.length||"Map Service"===b[0].type&&"tilepackage"!==c?b:b[0]}))},_analyze:function(a){var b=this._contentUri+"/features/analyze",c={analyzeParameters:{enableGlobalGeocoding:!0,sourceLocale:x.locale.split("-")[0]},filetype:this.itemInfo[this.item.type.toLowerCase()].type.toLowerCase(),itemid:a.id};this.disable(!1,this.i18n.analyzing);if("microsoft excel"==c.filetype){var d=a.excelInfo;
c.filetype="excel"}else d=a.csvInfo;if(this._isPortal&&this._geocodeServiceUrl||!this._isPortal){if(this._isPortal||!this._isPortal&&this._geocodeServers&&this._geocodeServers.length)c.analyzeParameters.geocodeServiceUrl=encodeURI(this._geocodeServiceUrl);a&&d&&(c.analyzeParameters.locationType="addressTypes"===this._getRadioButtonValue("geocode")?"address":"coordinates");if(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)c.analyzeParameters.sourceCountry=
d?this._countryCodes.get("value").toLowerCase():"",c.analyzeParameters.sourceCountryHint=d?"":this._sourceCountry;c.analyzeParameters=f.stringify(c.analyzeParameters)}else delete c.analyzeParameters;(a=Y.getToken())&&(b+="?token\x3d"+a);return this._request(b,c,{usePost:!0}).then(null,t.hitch(this,function(a){this._analyzeError||this.deleteGrid()}))},onChangeExcelSheet:function(a){a=this.item.excelInfo.publishParameters.layers;var b=this.get("value").allExcelSheets,c=a[b]&&a[b].fields;this.deleteGrid(!0);
this._createGrid(c,b);c="none";"address"===a[b].locationType&&(c="addressTypes");"coordinates"===a[b].locationType&&(c="locationTypes");this.elementValue("geocode",c);this.onChangeGeocode(c)},_createGrid:function(a,b){var c=this.item,d=c.type.toLowerCase(),e=this.gridInfo[d],f,g;c&&(c.csvInfo||c.excelInfo)&&(f="xlsx"==c.type?c.excelInfo.publishParameters.layers[b]:c.csvInfo.publishParameters,a=y.map(a,t.hitch(this,function(a){if(f.addressFields&&void 0==f.longitudeFieldName&&void 0==f.latitudeFieldName)for(var b in f.addressFields){if(f.addressFields[b]===
a.name)return t.mixin(a,{locationType:b})}else{if(a.name===f.longitudeFieldName)return t.mixin(a,{locationType:"longitude"});if(a.name===f.latitudeFieldName)return t.mixin(a,{locationType:"latitude"});if(f.coordinateFieldType&&"MGRS"===f.coordinateFieldType.toUpperCase()&&a.name===f.coordinateFieldName)return t.mixin(a,{locationType:"mgrs"});if(f.coordinateFieldType&&"USNG"===f.coordinateFieldType.toUpperCase()&&a.name===f.coordinateFieldName)return t.mixin(a,{locationType:"usng"})}return t.mixin(a,
{locationType:"unknown"})})));y.forEach(e,function(a){a.name=this.i18n[a.name]||a.name;a.select&&(g="csv"!==d&&"xlsx"!==d||"addressTypes"!==a.select?t.mixin({},this.i18n[a.select]):t.mixin({},t.mixin(t.clone(this.i18n.notUsed),f.standardizedFieldNames||this.i18n[a.select])),t.mixin(a,this._toSelectOptions(g,"unknown")))},this);this._mStore=new B({data:a,idProperty:"name"});this._oStore=new z({objectStore:this._mStore});this._updateUI(null,"hosted");!this._publishOnly||"csv"!==c.type&&"xlsx"!==c.type||
this._updateUI(null,"csv");this._grid=new T({id:"_grid",selectionMode:"none",singleClickEdit:!0},u.create("div",{},this.gridNode));this._grid.setStore(this._oStore);this._grid.set("structure",e);this._grid.startup();this._basicStandby.hide();this.enable();this._publishOnly||"csv"!==c.type&&"xlsx"!==c.type||this._updateUI(null,"publish");this._updateUI(null,d);"xlsx"==c.type&&1==c.excelInfo.publishParameters.layers.length&&this._updateUI("allExcelSheets",null)},deleteGrid:function(a){!a&&this.item&&
this.item.id&&(this._delete(this.item),this.item.id=null);this._grid&&(9>d("ie")&&v.set(this.dialog.domNode,"height","350px"),this._updateUI("csv"),this._updateUI("hosted"),delete this._mStore,delete this._oStore,this._grid.destroy(),delete this._grid,this._mStore=this._oStore=this._grid=null)},_getServiceInfo:function(a,b,c){var d=[499,498],e=this._tags.get("tags"),f,g=this._serviceInfoPane.get("userInfo"),k="FeatureServer"===c&&-1===a.indexOf(".arcgis.com")?a.replace("FeatureServer","MapServer"):
a;!this.item.isSecured||this.item.isSecured&&401!==this.item.isSecured.httpStatusCode&&g&&g.username&&g.password?this._serviceInfoPane.getServiceInfo(k,this.item.isSecured).then(t.hitch(this,function(b){"ImageServer"===this.item.type&&(b.tileInfo&&"LERC"===b.tileInfo.format||b.cacheType&&"elevation"===b.cacheType.toLowerCase())&&(this.item.type="ElevationServer");f=b.credential||esri.id.findCredential(a);g=this._serviceInfoPane.get("userInfo");this.item.thumbnailToken=f&&f.token||null;this.item.serviceInfo=
b;this.item.serviceInfo.isSecure=g?!0:!1;this.item.serviceInfo.userInfo=g;e=((b.documentInfo||{}).Keywords||"").split(",").concat((e||"").split(","));this._tags.set("tags",this._unique(e).join(","));this.item.extent=b.fullExtent||b.extent;this.enable()}),t.hitch(this,function(e){this._reload?this.enable():-1!==y.indexOf(d,e.code)?(this.enable(),this._updateUI("nosvcauth","svcauth"),this.item.checkUrlError?this._updateUI("storecredentials",null):this._updateUI(null,"storecredentials"),this.item.serviceInfo=
{isSecure:!0},this.item.isSecured=!0):e&&403===e.code?(this._showError(e),this.item.serviceInfo={isSecure:!0},this.item.isSecured=!0):"FeatureServer"!==c?this._showError({message:esri.substitute({name:b},this.i18n.errors.serviceNotExist.message)}):this._getServiceInfo(a.replace("MapServer","FeatureServer"),b,null)})):this.item.isSecured&&(this.item.isSecured.isFederatedWithWebTierAuth||401===this.item.isSecured.httpStatusCode)?this._request(this.item.url,{},{}).then(t.hitch(this,function(a){this.item.serviceInfo=
a;e=((a.documentInfo||{}).Keywords||"").split(",").concat((e||"").split(","));this._tags.set("tags",this._unique(e).join(","));this.item.extent=a.fullExtent||a.extent;this.enable()}),t.hitch(this,function(a){this._showError({message:esri.substitute({name:item.title},this.i18n.errors.serviceNotExist.message)});throw Error();})):this.enable()},_getOGCServiceInfo:function(b,c){var d=new esri.layers.WMSLayer(this._stripParameters(b,["version","service","request"])),e=new p,f=a(d,"load",t.hitch(this,function(){f.remove();
e.resolve(d)})),g=a(d,"error",t.hitch(this,function(){g.remove();this._showError({message:esri.substitute({name:c},this.i18n.errors.serviceNotExist.message)});e.cancel()}));return e},_loadOGC:function(b){this.item.ogcInfo=b;this.item.url=b.url;this.elementValue("url",b.url);this.elementValue("title",b.title);var c=[];y.forEach(b.layerInfos,t.hitch(this,"_getWMSLayers",c));y.some(c,function(a,b){a.visible=!0;return 9<b});this._createGrid(c);this._grid.canSort=t.hitch(this,function(a){return 1!==Math.abs(a)});
this._gridConnects.push(a(this._oStore,"set",t.hitch(this,function(a,b){"visible"===b&&(n.byId("_ogcCB").checked=this._mStore.query({visible:!0}).length===this._mStore.data.length)})));this._gridConnects.push(a(this._grid,"headerCellClick",t.hitch(this,function(a){if(!1!==esri.isDefined(a.target.checked)){var b=a.target.checked;this._mStore.query({visible:!b}).forEach(function(a){a.visible=b;this._mStore.put(a)},this);this._grid._fetch(0,!0)}})))},_loadCSV:function(c){if(c){var d=c.publishParameters||
{},e="coordinates"===d.locationType?"locationTypes":"addressTypes",f=d.layerInfo&&d.layerInfo.fields||[];this.item.csvInfo=c;this.item.publishParameters=d;if(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)this._isWorldGeocodeServer=esri._isDefined(c.publishParameters.sourceCountry),c=this._countryCodes.value||c.publishParameters.sourceCountry||"world",this._countryCodes.set("value","wo"===c?"world":c,!1);this._analyzed="addressTypes"===e;this._createGrid(f);
this._publishOnly&&this._updateUI(null,"csv");this._allowGeocode||"addressTypes"!==e||(e="none",b(".noGeocode").style("display","none"),b(".tableOnly").style("display",""));this.elementValue("geocode",e);this.onChangeGeocode(e);this._gridConnects.push(a(this._oStore,"set",t.hitch(this,function(a,b,c,d){"locationType"===b&&this._mStore.query({locationType:d}).forEach(function(b){b.name!==a.name&&(b=this._mStore.get(b.name),b.locationType="unknown",this._mStore.put(b),this._grid._fetch(0,!0))},this)})));
this._gridConnects.push(a(this._grid,"applyCellEdit",t.hitch(this,function(a,b,c){"locationType"!==c||a!==(d.standardizedFieldNames&&d.standardizedFieldNames.Postal)&&a!==this.i18n.addressTypes.Postal||(a=this._grid.getItem(b),a.__isTypeUpdatedByUser||(a.type="esriFieldTypeString",a.__isTypeUpdatedByUser=!0,this._mStore.put(a)))})))}else this._publishOnly&&this._showNoGeocodeDlg()},_loadExcel:function(c){if(c){var d=""===this._allExcelSheets.value?0:this._allExcelSheets.value,e=c.publishParameters||
{},f=e.layers[d]&&"coordinates"===e.layers[d].locationType&&!this.changingGeocodeCountry?"locationTypes":"addressTypes";this.changingGeocodeCountry=!1;var g=e.layers&&e.layers[d].fields||[];this.item.excelInfo=c;this.item.publishParameters=e;if(!this._isPortal&&this._isWorldGeocodeServer||this._isPortal&&this._isServiceProxyAgoWorldGeocodeServer)this._isWorldGeocodeServer=esri._isDefined(c.publishParameters.layers[d].sourceCountry),c=c.publishParameters.layers[d].sourceCountry||"world",this._countryCodes.set("value",
"wo"===c?"world":c,!1);this._analyzed="addressTypes"===f;this._fetchAllExcelLayers(e,d);this._createGrid(g,d);this._publishOnly&&this._updateUI(null,"csv");this._allowGeocode||"addressTypes"!==f||(f="none",b(".noGeocode").style("display","none"),b(".tableOnly").style("display",""));this.elementValue("geocode",f);this.onChangeGeocode(f);this._gridConnects.push(a(this._oStore,"set",t.hitch(this,function(a,b,c,d){"locationType"===b&&this._mStore.query({locationType:d}).forEach(function(b){b.name!==a.name&&
(b=this._mStore.get(b.name),b.locationType="unknown",this._mStore.put(b),this._grid._fetch(0,!0))},this)})));this._gridConnects.push(a(this._grid,"applyCellEdit",t.hitch(this,function(a,b,c){"locationType"!==c||a!==(e.standardizedFieldNames&&e.standardizedFieldNames.Postal)&&a!==this.i18n.addressTypes.Postal||(a=this._grid.getItem(b),a.__isTypeUpdatedByUser||(a.type="esriFieldTypeString",a.__isTypeUpdatedByUser=!0,this._mStore.put(a)))})))}else this._publishOnly&&this._showNoGeocodeDlg()},_getWMSLayers:function(a,
b){b.subLayers&&b.subLayers.length?y.forEach(b.subLayers,t.hitch(this,"_getWMSLayers",a)):a.push({name:b.name,visible:!1,title:b.title.replace(/ /g,String.fromCharCode(160)),extent:b.extent,legendURL:b.legendURL})},_getThumbnail:function(a,b){var c=new p;if(a.thumbnailURL)return c.resolve(a.thumbnailURL),c;if("MapServer"!==a.type&&"FeatureServer"!==a.type&&"ImageServer"!==a.type)return c.resolve(null),c;if("MapServer"===a.type||"ImageServer"===a.type||-1!==a.url.indexOf("MapServer")){var d=a.serviceInfo||
{},e=a.extent||{};b=a.url||b.url;a=this._extent2String(a.extent);c.resolve(e?pa(b,a,null,null,"800,532",null,"image",null,d):null);return c}c=b.extent.split(",");return ja(a.url,[[parseFloat(c[0]),parseFloat(c[1])],[parseFloat(c[2]),parseFloat(c[3])]])},_project:function(a,b){var c=new p,d=t.hitch(this,function(a){c.resolve(a&&a.length&&a[0]&&a[0].type&&"extent"===a[0].type?a[0]:null)});a=new esri.geometry.Extent(a);la(a,b).then(d,d);return c},_projectExtent2WGS84:function(a){var b=this.item.extent||
{},c=b.spatialReference&&(b.spatialReference.wkid||b.spatialReference.wkt),d=new esri.SpatialReference({wkid:4326}),e=new p;if(c&&!qa(d,b.spatialReference))return this._project(b,d).then(t.hitch(this,function(b){a.extent=this._extent2String(b);return a}));a.extent=this._extent2String(b);e.resolve(a);return e},_showItem:function(a){if(!a||a.error)return this._showError(a);var b=this.item.type.toLowerCase(),c=a.buildCache&&"scenepackage"!==b,d=[this.item.id],b=this._categories?this._categories.getCategories(!0):
null,e=a.jobId?"\x26jobid\x3d"+a.jobId:"";a.id?d.push(a.id):a&&a.length&&a.forEach(function(a){a.id&&d.push(a.id)});ba.setItemCategories(d,b).then(function(){esri.hide(this.dialog&&this.dialog.domNode);a.id?window.location="item.html?id\x3d"+a.id+e+(c?"#settings/buildCache":""):a&&a.length&&this._showServiceResultsDlg(a);this.item&&(this.item.id=null);this.dialog&&this.dialog.hide()}.bind(this))},_showServiceResultsDlg:function(b){var c=document.createDocumentFragment(),d=u.create("div",{"class":"esriAGOServicesDlg esriItemLinks"},
c,"first"),e=u.create("ul",null,d),f;y.forEach(b,t.hitch(this,function(a){esri.isDefined(a.error)?(a.type="Map Service"===a.type?"Tile Layer":"Image Service"===a.type?"Imagery Layer":"Feature Layer",a.error&&a.error.message&&-1<a.error.message.indexOf("already exist")&&(a.error.message=this.i18n.errors.serviceDefinitionExists.message),u.create("li",{innerHTML:esri.substitute(t.mixin(a,{error:a.error.message}),this.i18n.publishServicesError)},e)):(f="item.html?id\x3d"+a.id+(a.jobId?"\x26jobid\x3d"+
a.jobId:"")+("Map Service"===a.type?"#settings/manageTiles":""),a=t.mixin(a,{linkTitle:this.i18n["Map Service"!==a.type?"publishServiceView":"publishServiceBuild"],itemUrl:f}),a.type="Map Service"===a.type?"Tile Layer":"Feature Layer",u.create("li",{innerHTML:esri.substitute(a,this.i18n.publishServicesSuccess)},e))}));b=(new O).placeAt(C.body());b.set({title:this.i18n.publishServicesTitle,content:c});b.show();var k=a(b,"hide",this,function(){k.remove();g.publish("itemAdded",[])})},_fetchCountryCodes:function(a){var b=
[],c=V.self||{},c=(c=(c.user||{}).region||c.ipCntryCode||"")&&"wo"===c.toLowerCase()?"world":c,d;for(d in this.countryCodes)b.push({label:this.countryCodes[d],value:d.toLowerCase()});a&&(b=b.filter(function(b){return a[b.value]}));b=b.sort(function(a,b){return a.label<b.label?-1:a.label>b.label?1:0});this._countryCodes.set("options",b);if(!this._countryCodes.value||a&&!a[this._countryCodes.value])this.countryCodes[c]&&(a&&a[c]||!a)?this._countryCodes.set("value",c.toLowerCase(),!1):a&&2===Object.keys(a).length?
this._countryCodes.set("value",Object.keys(a).filter(function(a){return"world"!==a})[0],!1):this._countryCodes.set("value","world",!1);this._sourceCountry=c.toLowerCase()},_fetchAllExcelLayers:function(a,b){var c=[];this._updateUI(null,"allExcelSheets");for(var d=0;d<a.layers.length;d++)c.push({label:a.layers[d].name,value:d});this._allExcelSheets.set("options",c);this._allExcelSheets.set("value",b,!1)},_fetchTimeZones:function(){var a=[],b;for(b in this.timeZones)a.push({label:this.timeZones[b],
value:"UTC"!==b?parseFloat(b):b});this._timeZones.set("options",a);this._timeZones.set("value",1230);r.set(this._timezoneHelpIcon,"href",V.self?V.self.helpBase+V.self.helpMap.m["120001098"]:"#")},_fetchItemData:function(a){return this._request(this._contentUri+"/items/"+a.id+"/data")},_fetchOpExtension:function(a){var c=new p;this.disable(null,this.i18n.fetchOpExtension);b(".opextwarningmsg",this.domNode).style("display","none");esri.request({url:a,handleAs:"json"},{useProxy:!1}).then(t.hitch(this,
function(a){this.enable();c.resolve(a)}),t.hitch(this,function(a){a&&a.message&&-1<a.message.indexOf("Unexpected string")&&(a=this.i18n.errors.opExtensionInvalidJson);this._showError(a);this.enable();c.cancel()}));return c},_request:function(a,b,c,d,e){b=t.mixin(t.mixin({},this._requestParams),b||{});var f=Y.request({url:a,content:b},c);f.then(t.hitch(this,function(a){return a.error?this._showError(a.error):a}),t.hitch(this,function(a){if(this._isPortal&&a.message&&-1<a.message.indexOf("ERROR 001551"))throw this._analyzeError=
!0,this._basicStandby.hide(),this.enable(),a;e?e(a):this._showError(t.mixin(a,{code:"timeout"===a.dojoType?408:a.code,message:a.message,details:a.details}),f)}));return f},_uploadFile:function(a,b,c){var d=t.mixin({},this._requestParams),e=Y.request({url:b,content:d,form:a,timeout:0});e.then(t.hitch(this,function(a){c.remove();return a.error?this._showError(a.error):a}),t.hitch(this,function(a){c.remove();return this._showError(a,e)}));return e},_addItem:function(a,b){var c=this.itemAPI.addItem.call(this.itemAPI,
{folderId:"/"!==this.folder?this.folder:void 0},a,n.byId("file").files[0]);c.then(function(a){b.remove();return a.error?this._showError(a.error):a}.bind(this),function(a){b.remove();return this._showError(a,c)}.bind(this));return c},_checkStatus:function(a,b,c,d){a||c();this._request(this._userContentUri+"/items/"+a.id+"/status").then(t.hitch(this,function(e){e=e||{status:"failed"};if("completed"===e.status)return b(a);if("failed"===e.status||""===e.status)return e&&e.statusMessage&&0<e.statusMessage.indexOf("Invalid Shapefile")?
e.statusMessage=esri.substitute({name:a.item},this.i18n.errors.invalidShapefile.message):e&&e.statusMessage&&0<e.statusMessage.indexOf("Invalid File Geodatabase")&&(e.statusMessage=esri.substitute({name:a.item},this.i18n.errors.invalidFileGeodatabase.message)),c({message:e.statusMessage||this.i18n.errors.error});d=(d||500)+250;setTimeout(t.hitch(this,function(){this._checkStatus(a,b,c,d)}),d)}),c)},_getFileAndType:function(){if(window.FileReader&&n.byId("file").files[0].size>this._maxFileSize)return this._showError(this.i18n.errors.fileToLarge);
var a=/(?:\.([^.]+))?$/,b=n.byId("file").value.replace(/^.*(\\|\/|:)/,""),a=b?a.exec(b)[1].toLowerCase():"",c=b?b.substring(0,b.lastIndexOf(".")):"",c=c.replace(/\./g,"_");if(this.item&&this.item.type&&"desktopapplication"===this.item.type){this.item.type="desktopapplication";this.item.item=b;this.item.name=b;this.elementValue("title",c);this.item.isZip="zip"===a;if("zip"===a){this._itemExists({item:b,title:c,name:b,type:this.item.type});return}return this._showError({message:this.i18n.fileZipFormat})}this._isRasterFunctionTemplate(b)&&
(a="rft",c=this._getRasterFunctionTemplateName(b));if("tpk"===a&&-1<b.indexOf("-"))return this.item={error:this.i18n.errors.invalidFileTitle},this._showError({message:this.i18n.errors.invalidFileTitle.message});this.deleteGrid();this._updateUI("zip","title");this._updateUI("csv");this._updateUI("shapefile");this._updateUI("servicedefinition");this._updateUI("publish");this._updateUI("codesample");this._updateUI("arcpadpackage");this._updateUI("stylx");this.item={};a="sd"===a?"servicedefinition":a;
a="tpk"===a?"tilepackage":a;a="spk"===a||"slpk"===a?"scenepackage":a;a="vtpk"===a?"vectortilepackage":a;this.item.type=a;this.item.item=b;this.item.isFile=!0;this.item.fileExtension=a;this.elementValue("title",c);r.set(this._enablePublishingLabel,"innerHTML",this.i18n["tilepackage"!==a?"publishService":"publishNamedService"]);var d=!0,e=!0,f=!0,g=!0;if(this.allowPublish||this._allowPublishChanged)this._allowPublishChanged&&(this.allowPublish=!0,this._allowPublishChanged=!1),"shapefile"!==a&&"csv"!==
a&&"geojson"!==a&&"json"!==a&&("zip"!==a||"shapefile"!==this.elementValue("archiveSelect")&&"filegeodatabase"!==this.elementValue("archiveSelect"))||this._roleCanPublishFeatures||(this.allowPublish=e=d=!1,this._allowPublishChanged=!0),"tilepackage"!==a||this._roleCanPublishTiles||(this.allowPublish=g=d=!1,this._allowPublishChanged=!0),"scenepackage"!==a||this._roleCanPublishScenes||(this.allowPublish=f=d=!1,this._allowPublishChanged=!0),"vectortilepackage"!==a||this._roleCanPublishTiles||(this.allowPublish=
g=d=!1,this._allowPublishChanged=!0),"servicedefinition"===a&&(this._roleCanPublishFeatures||this._roleCanPublishTiles?(this._roleCanPublishFeatures||(e=!1),this._roleCanPublishTiles||(g=!1)):(this.allowPublish=g=e=d=!1,this._allowPublishChanged=!0));this._enablePublishing.set("value",d);if(this._itemExists({item:b,title:c,name:b,type:this.item.type}))return!1;if("zip"===a){a=this.elementValue("archiveSelect");this.item.type=a;if(this._itemExists({item:b,title:c,name:b,type:this.item.type,isFile:!0,
fileExtension:"ZIP"}))return;this._updateUI("app","zip");this._updateUI(null,this.allowPublish&&a in this._publishTypes&&e?a:null);this._updateUI(null,this.allowPublish&&a in this._publishTypes&&e?"publish":null)}else if("csv"===a&&this.allowPublish&&e&&this._publishTypes.csv)this._basicStandby.show(),this._addFile();else if("geojson"!==a&&"json"!==a||!this.allowPublish||!e&&!g)if("servicedefinition"!==a&&"geojson"!==a&&"json"!==a||!this.allowPublish||!e&&!g)if("tilepackage"===a)this.allowPublish&&
g&&(this._updateUI(null,"publish"),this._updateUI(null,a));else if("scenepackage"===a)this.allowPublish&&f&&(this._updateUI(null,"publish"),this._updateUI(null,a));else if("vectortilepackage"===a)this.allowPublish&&g&&(this._updateUI(null,"publish"),this._updateUI(null,a));else if("opcenteraddin"===a){if(this._user&&"account_admin"!==this._user.role&&"account_publisher"!==this._user.role)return this._showError(this.i18n.errors.insuffientPrivs)}else if("stylx"===a)this._updateUI(null,"stylx"),this._updateUI(null,
"file");else if(this.itemInfo[a])this._updateUI(null,"file");else return this._showError({message:this.i18n.errors.unknownType.message});else this._updateUI("title","publish"),this._updateUI(null,a);else this._updateUI(null,"publish"),this._updateUI(null,a);return{file:b,type:a}},_getUrlAndType:function(){var a=/http.+\/(arcgis\/rest\/services|\/.*\/rest\/services|arcgis\/services)\/?/ig,c=/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|VectorTileServer|StreamServer)).*/ig,
d=this.elementValue("url"),e=-1<d.indexOf("MapServer/dynamicLayer?")?d.replace(/(?:&f=html)|(?:&f=json)|(?:\?f=html)|(?:\?f=json)/,""):d.split("?")[0],f;"/"==e.substr(-1)&&(e=e.substr(0,e.length-1));"opext"===this._getRadioButtonValue("app")&&(b(".opextwarningmsg",this.domNode).style("display","none"),this.elementValue("title",""));this.deleteGrid();this._updateUI("svcauth","all");this._updateUI(null,"storecredentials");this.item&&this.item.serviceInfo&&(this.item.serviceInfo=null);if(e){/(http|https|ftp):\/\/?/.exec(e)||
this.elementValue("url",e="http://"+e);this.item=this.item||{};if("url"===this.elementValue("itemType"))if(f=e.replace(/^.*\//,"").replace(/.[^.]*$/,""),d=this._getRadioButtonValue("web"),this.item.type=d,"ags"===d){f=e.replace(c,"").replace(/^.*\//,"").replace(/\?.*$/,"");d=(a=e.replace(a,"").match(c))&&a.length?a[0].split("/")[1]:null;if(!d||"SceneServer"===d&&!V.sceneViewerEnabled)return d=esri.substitute({portalName:V.portalName||this.i18n.portalName},this.i18n.errors.unknownAGSType.message),
this._showError({message:d});a=a.length?a[0].split("/")[2]:null;"MapServer"!==d||isNaN(a)||(d="FeatureServer");this.item.type=d;!V.allSSL&&"https:"!==location.protocol||!Y.isHostedService(e)&&!Y.supportsHttps(e)||(e=e.replace("http:/","https:/"));this.disable(!1,this.i18n.fetching);this._serviceInfoPane.getIsSecured(e).then(t.hitch(this,function(a){if(a.secured)this._serviceInfoPane.isFederatedWithWebTierAuth(e,a).then(t.hitch(this,function(b){if(b||401===a.httpStatusCode)return-1===b?(this.item.isSecured=
!1,this.item.checkUrlError=!0,this._storeAuth.set("checked",!1)):this.item=t.mixin(this.item,{isSecured:{httpStatusCode:401,isFederatedWithWebTierAuth:b}}),this._getServiceInfo(e);this.item.isSecured=a;this._updateUI("nosvcauth","svcauth");this._updateUI(null,"storecredentials");a.isOverride&&this._storeAuth.set("checked",!0);this._serviceInfoPane.get("userInfo")&&this._getServiceInfo(e);this.enable()}));else return this._getServiceInfo(e)}),t.hitch(this,function(a){this.item.isSecured=!1;this.item.checkUrlError=
!0;this._storeAuth.set("checked",!1);return this._getServiceInfo(e)}))}else{if("ogc"===d)return this._basicStandby.show(),this.disable(!1,this.i18n.fetching),this._getOGCServiceInfo(this.elementValue("url"),f).then(t.hitch(this,"_loadOGC"))}else f=e.replace(/^.*\//,"").replace(/.[^.]*$/,""),this.item.type=this._getRadioButtonValue("app"),"opext"===this.item.type&&(-1===e.indexOf(".json",e.length-5)?this._showError({message:this.i18n.errors.opExtensionNotJson}):this._fetchOpExtension(e).then(t.hitch(this,
function(a){this._opExtensionInfo=a;this._validateOpExtension(a)&&(f=a&&(a.name||a.title||f),this.elementValue("title",decodeURI(f)))})));this.item.url=e;this.elementValue("title",decodeURI(f))}},_getDefaultPublishParameters:function(a){var b=a.type.toLowerCase(),c={itemId:a.id,filetype:b};"servicedefinition"===b?c.filetype="serviceDefinition":"tilepackage"===b?c.filetype="tilePackage":"scenepackage"===b?c.filetype="scenePackage":"json"===b?c.filetype="geojson":"imagecollection"===b?(c.filetype="imagecollection",
c.outputType="image service"):c.filetype=b;if("servicedefinition"!==b&&"tilepackage"!==b&&"scenepackage"!==b&&"vectortilepackage"!==b)c.publishParameters=t.mixin(a.csvInfo&&a.csvInfo.publishParameters||a.publishParameters||{},{hasStaticData:!0,name:this.elementValue("title").replace(/ /g,"_"),maxRecordCount:2E3}),c.publishParameters.layerInfo=t.mixin(c.publishParameters.layerInfo||{},{capabilities:"Query"}),"csv"===b&&(c.publishParameters.persistErrorRecordsForReview=!0);else{if("tilepackage"===b||
"scenepackage"===b||"vectortilepackage"===b)c.publishParameters=t.mixin(a.publishParameters||{},{name:this.elementValue("title").replace(/ /g,"_"),maxRecordCount:2E3}),"scenepackage"===b?c.outputType="sceneService":"vectortilepackage"===b&&(c.outputType="VectorTiles");c.buildInitialCache="tilepackage"===b||("vectortilepackage"===b||"scenepackage"===b)&&!this._isPortal}return c},_getSpatialReference:function(a){var b=a.serviceInfo||{};if(a="ImageServer"!==a.type?b.spatialReference:b.extent&&b.extent.spatialReference){if(a.wkid)return a.wkid;
if(a.wkt&&-1!==a.wkt.search(/^PROJCS/i))return/^PROJCS\["[A-Za-z0-9_]*/i.exec(a.wkt)[0].split("[")[1]}return null},_extent2String:function(a,b){b=b||4;var c="";if(a&&this._isValidNum(a.xmin)&&this._isValidNum(a.ymin)&&this._isValidNum(a.xmax)&&this._isValidNum(a.ymax)){var c=m.round(a.xmin,b),d=m.round(a.ymin,b),e=m.round(a.xmax,b);a=m.round(a.ymax,b);c=isNaN(c)||isNaN(d)||isNaN(e)||isNaN(a)?"":c+","+d+","+e+","+a}return c},_checkProtocol:function(){return-1===window.location.protocol.toLowerCase().indexOf("https")&&
(this._cookie=this._cookie||Y.getCookie("esri_auth"))&&this._cookie.auth_tier&&"web"===this._cookie.auth_tier.toLowerCase()?(this._showReloadDlg(),!1):!0},_isValidNum:function(a){return isNaN(a)||void 0===a||null===a?!1:!0},_isRasterFunctionTemplate:function(a){if(!esri.isDefined(a))return!1;var b=a.substring(a.length-9,a.length).toLowerCase();a=a.substring(a.length-8,a.length).toLowerCase();return".rft.json"==b||".rft.xml"==a},_getRasterFunctionTemplateName:function(a){var b=a&&a.substring(0,a.toLowerCase().lastIndexOf(".rft.json")),
c=a&&a.substring(0,a.toLowerCase().lastIndexOf(".rft.xml"));return a?b||c:""},_updateUI:function(a,c){a&&b("."+a).style("display","none");c&&(this._publishOnly||"csv"!==c?this._publishOnly||"json"!==c&&"geojson"!==c&&"shapefile"!==c&&"servicedefinition"!==c&&"filegeodatabase"!==c||(u.place(this._publishNode,this._publishServiceDiv,"first"),esri.show(this._publishServiceDiv),esri.hide(this._publishCSVDiv)):(u.place(this._publishNode,this._publishCSVDiv,"first"),esri.show(this._publishCSVDiv),esri.hide(this._publishServiceDiv)),
b("."+c).style("display",""),"csv"!==c||this._allowGeocode||(b(".portal").style("display","none"),b(".noGeocode").style("display","")));V.userRole&&!this._roleCanCreateItem&&dijit.byId("addItem-btn").set("disabled",!0);b(".esriAGOAddItemForm").style("height","auto");this.dialog.resize()},_itemExists:function(a){var b=this.existingItems||[],c=this.itemInfo[a.type.toLowerCase()]?this.itemInfo[a.type.toLowerCase()].type:a.type;return(b=y.filter(b,function(b){b.item=b.name||b.title;a.item=(a.name?a.name.replace(" ",
"_"):a.name)||a.title||a.url;return b.type===c&&(b.name===a.item||b.item===a.item||b.title===a.title)}))&&b.length?(b=this.item.isFile?esri.substitute({type:a.fileExtension,item:a.item,name:b[0].name,title:b[0].title},this.i18n.errors.itemExistsFile.message):esri.substitute({type:b[0].type,item:a.item,title:b[0].title},this.i18n.errors.itemExists.message),!this._showError({message:b})):!1},_serviceNameAvailable:function(a){a="tilepackage"===a.type?"Map Service":"scenepackage"===a.type?"Scene Service":
"vectortilepackage"===a.type?"Vector Tile Service":"Feature Service";a={name:this.elementValue("title").split(" ").join("_"),type:a};var b=V.self&&V.self.user&&(V.self.user.accountId||V.self.user.orgId);this.disable(["addItem","cancel"]);return this._request(this._portalUrl+"/"+b+"/isServiceNameAvailable",a).then(t.hitch(this,function(a){return a.available?!0:this._showError(this.i18n.errors.serviceNameExists)}))},_loadConnections:function(){V.isRightToLeft&&(9>d("ie")||5>d("trident"))&&this._tags._textTags.set("placeHolder",
"");this.own(g.subscribe("onSelectedTagsUpdate",t.hitch(this,function(a){var b=this._tags.get("tags");a=b?a.split(",").concat(b.split(",")):a.split(",");this._tags.set("tags",this._unique(a).join(","))})));9>d("ie")&&this.own(b(".radio").connect("onclick",t.hitch(this,function(a){(a.focusNode?r.get(a.focusNode,"checked"):1)&&y.forEach(this.formWidgets[(a.target||a.srcElement).name].widget,t.hitch(this,function(a){y.forEach(a.observer.split(/[ ,]+/),t.hitch(this,function(b){if(!1!==a.get("value"))this[b](a.get("value"))}))}))})));
this.own(a(this._tagsLbl,"click",t.hitch(this,function(a){this._tags._inputTextBox.focus();b(".select2-choices",this._tags.domNode).addClass("focus")})),a(this._tags.domNode,"focusout",t.hitch(this,function(a){b(".select2-choices",this._tags.domNode).removeClass("focus")})),a(this._tags.domNode,"focusin",t.hitch(this,function(a){b(".select2-choices",this._tags.domNode).addClass("focus")})));this._dlgConnect=a(this.dialog,"hide",t.hitch(this,function(){this.deleteGrid();var a=[this._fileInputConnect,
this._dlgConnect,this._credentialConnect].concat(this._gridConnects);y.forEach(a,function(a){a.remove()});this._basicStandby.destroy();this._errorDlg&&this._errorDlg._dialog&&(this._errorDlg._dialog.destroyRecursive(),this._errorDlg.destroyRecursive());this._choiceDlg&&this._choiceDlg._dialog&&(this._choiceDlg._dialog.destroyRecursive(),this._choiceDlg.destroyRecursive());this.destroy()}));this._dlgConnect=a(this._geocoderSelect,"change",t.hitch(this,this.onChangeGeocoder));var c=W.prototype.statics.getInstance(),
e=setInterval(t.hitch(this,function(){c.isLoaded()&&(clearInterval(e),this.learnMore.href=c.getHelpUrl("120000597"),c.destroyRecursive())}),200);this._fileInputConnect=a(n.byId("file"),"change",t.hitch(this,"_getFileAndType"));this._gridConnects=[];esri.id.setProtocolErrorHandler(t.hitch(this,"_showReloadDlg"))},_getRadioButtonValue:function(a){var b;return 9>=d("ie")?(y.some(this.formWidgets[a].widget||[],function(a){return a.get("checked")?(b=a,!0):!1}),b?b.get("value"):""):this.elementValue(a)},
_unique:function(a){var b={};return y.filter(a,function(a){return!a||b[a]?!1:b[a]=!0})},_stripParameters:function(a,b){a=esri.urlToObject(a);var c=[],d;for(d in a.query)-1===y.indexOf(b,d.toLowerCase())&&c.push(d+"\x3d"+a.query[d]);return a.path+(c.length?"?"+c.join("\x26"):"")},_checkThumbnailURL:function(a){a.thumbnailURL&&(a.thumbnailURL=Y.getStaticImagesUrl()+a.thumbnailURL);Y.isPortal()&&a.thumbnailURL&&0!==a.thumbnailURL.indexOf("http")&&(a.thumbnailURL=window.location.protocol+"//"+window.location.host+
a.thumbnailURL);return a},_toSelectOptions:function(a,b){var c=[],d=[],e;for(e in a)c.push(a[e]),d.push(e);return{formatter:function(c){return a[c]||a[b]},options:c,values:d}},_showReloadDlg:function(){this._reload=!0;if(window.location&&-1===window.location.protocol.indexOf("https:")){var a={title:this.i18n.reloadTitle,message:"\x3cp\x3e"+this.i18n.reloadMessage+"\x3c/p\x3e",choiceOneTitle:this.i18n.yesLabel,choiceTwoTitle:this.i18n.noLabel,choiceOneHandler:t.hitch(this,function(){window.location=
window.location.href.replace("http:","https:")}),choiceTwoHandler:t.hitch(this,function(){this._choiceDlg.hide()})};this._choiceDlg.show(a);return!1}},_showNoGeocodeDlg:function(){var b=a(this._errorDlg,"hide",t.hitch(this,function(){b.remove();this.onCancel()})),c=t.mixin({},this.i18n.errors.error,{message:this._roleCanUseGeocode?fa.common.errors.noBatchGeocoding:fa.common.errors.noGeocodingRole});this._errorDlg.show(c)},showModal:function(a){a=new p;this.dialog=new O({"class":"esriAddItemDlg"});
this.dialog.set({title:this.i18n.itemProperties.addItemDlgTitle,content:this.domNode});this.dialog.show();return a},_showError:function(a,b){b&&b.canceled||(a=a.error||a||{},a.code=a.code||0,a=this.i18n.errors[a.code]||a,a.details=a.details&&t.isArray(a.details)&&a.details.length?y.filter(a.details,"return item !\x3d\x3d null"):null,a.messageCode&&"GWM_0011"===a.messageCode&&(a=t.mixin(a,{message:fa.common.errors.spamContentItemCreate})),a.messageCode&&"CONT_0027"===a.messageCode&&(b=this.itemInfo[this.item.type.toLowerCase()]?
this.itemInfo[this.item.type.toLowerCase()].type:this.item.type,b=this.item.isFile?k.substitute(this.i18n.errors.fileNameExists.message,{type:b,name:this.item.name||this.item.item}):k.substitute(this.i18n.errors.itemExists.message,{type:b,title:this.item.item}),a=t.mixin(a,{message:b})),a.details&&a.details.length&&(a.details=a.details.join("\x3cbr /\x3e"),a.message=a.message?a.message+"\x3cbr /\x3e"+a.details:a.details),-1<a.message.indexOf("Duplicate field names are not allowed")&&(a=t.mixin(a,
{message:this.i18nCommon.errors.duplicateFields})),a=t.mixin(t.mixin({},this.i18n.errors.error),a),this._errorDlg.show(a));this._basicStandby.hide();this.enable();return!1}})})},"esri/layers/wms":function(){define(["./agscommon","./dynamic","./WMSLayer"],function(){return{}})},"esri/layers/dynamic":function(){define(["../geometry","./DynamicMapServiceLayer"],function(){return{}})},"arcgisonline/sharing/dijit/ServiceInfo":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_WidgetBase,dijit/registry,arcgisonline/sharing/util,esri/IdentityManagerBase"],
function(c,l,h){c.provide("arcgisonline.sharing.dijit.ServiceInfo");c.require("dijit._WidgetBase");c.require("dijit.registry");c.require("arcgisonline.sharing.util");c.require("esri.IdentityManagerBase");c.declare("arcgisonline.sharing.dijit.ServiceInfo",[l._WidgetBase,esri.IdentityManagerBase],{baseClass:"esriSvcAuth",onCredentialChange:function(){},postMixInProperties:function(){this.inherited(arguments);this._util=arcgisonline.sharing.util;this._isSecuredUrl=esriGeowConfig.restBaseUrl+"/portals/checkurl";
this.i18n=c.mixin({},c.i18n.getLocalization("arcgisonline","arcgisonline").common);this.i18n=c.mixin(this.i18n,{addItemFrm:c.i18n.getLocalization("arcgisonline","arcgisonline").addItemFrm});this._tokenAuthentication=[499,498];this._createDefaultOAuthInfo=!1;this._overrideUrls="geocode.arcgis.com geocodedev.arcgis.com geocodeqa.arcgis.com route.arcgis.com routedev.arcgis.com routeqa.arcgis.com".split(" ")},buildRendering:function(){var a=document.createDocumentFragment(),e=c.create("fieldset",{"class":"esriSvcAuth"},
a);new l.form.TextBox({name:"fakeusernameremembered",type:"text","class":"hide"},c.create("input",{autocomplete:"off"},e));new l.form.TextBox({name:"fakepasswordremembered",type:"password","class":"hide"},c.create("input",{autocomplete:"off"},e));c.create("label",{"for":"proxyUsername",innerHTML:this.i18n.userLabel,"class":"esriUsernameLbl trailer-0 leader-half"},e);this._username=new l.form.TextBox({name:"serviceUsername",trim:"true"},c.create("input",{autocomplete:"off"},e));c.create("br",{},e);
c.create("label",{"for":"proxyPassword",innerHTML:this.i18n.passwordLabel,"class":"esriPasswordLbl trailer-0 leader-half"},e);this._password=new l.form.TextBox({name:"servicePassword",trim:"true",type:"password"},c.create("input",{autocomplete:"off"},e));this.inherited(arguments);this.domNode.appendChild(a)},postCreate:function(){this.connect(this._password,"onChange",c.hitch(this,"_onCredential"));this.connect(this._username,"onChange",c.hitch(this,"_onCredential"))},_setDisabledAttr:function(a){c.forEach(l.registry.findWidgets(this.domNode,
this.containerNode),function(c){c.set("disabled",a)})},getIsSecured:function(a){a=a.split("?")[0];var e;(this.isOverrideUrl=c.some(this._overrideUrls,function(c){return-1!==a.indexOf(c)}))?(esri.show(this.domNode),e=new c.Deferred,e.resolve({secured:!0,isOverride:!0})):e=this._util.request({url:this._isSecuredUrl+"?url\x3d"+encodeURIComponent(a+"?f\x3djson")},{addToken:!1}).then(c.hitch(this,function(a){a.secured&&(403===a.httpStatusCode?a.secured=!1:401===a.httpStatusCode?esri.show(this.domNode):
0<=c.indexOf(this._tokenAuthentication,a.httpStatusCode)&&esri.show(this.domNode));return a}));return e},signIn:function(a,e,f){this._pendingDfd=new c.Deferred;this._serverInfo=e;this.userInfo&&this.userInfo.username&&this.userInfo.password&&this._generateToken();return this._pendingDfd},isFederatedWithWebTierAuth:function(a,e){var f=new c.Deferred,d,b=!1;e&&499===e.httpStatusCode?this._getTokenSvcUrl(a).then(c.hitch(this,function(a){(d=a&&a.authInfo&&a.authInfo.tokenServicesUrl)?this.getIsSecured(d).then(c.hitch(this,
function(a){b=a&&a.secured&&401===a.httpStatusCode;f.resolve(b)}),c.hitch(this,function(a){f.resolve(a&&a.message&&-1<a.message.indexOf("Http StatusCode: -1")?-1:!1)})):f.resolve(!1)})):f.resolve(!1);return f},getServiceInfo:function(a,e){var f=new c.Deferred,f=this.userInfo,d=this._util.isHostedService(a),b={useProxy:!1,timeout:!1===esriGeowConfig.isMultiTenant?6E4:5E3,addSSL:d,addToken:e&&d&&!1!==esriGeowConfig.isMultiTenant||!1};f&&f.username&&f.password?(this._prevIdMgr=esri.id,esri.id=this,this._svcUrl=
a.split("?")[0],f=this.isOverrideUrl?this._signIn(a,this.userInfo).then(c.hitch(this,function(c){return this._getServiceInfo(a,b)})):this._getServiceInfo(a,b).then(c.hitch(this,function(b){b.credential=esri.id.findCredential(a);esri.id=this._prevIdMgr;b.credential&&esri.id.registerToken({server:a,token:b.credential.token,userId:b.credential.userId,expires:b.credential.expires,ssl:b.credential.ssl});return b}))):(b.disableIdentityLookup=!0,f=this._getServiceInfo(a,b).then(c.hitch(this,function(a){return a}),
c.hitch(this,function(a){esri.show(this.domNode);throw a;})));return f},_generateToken:function(){return this.generateToken(this._serverInfo,{username:this.userInfo.username,password:this.userInfo.password}).then(c.hitch(this,function(a){if(a)this._pendingDfd.callback(new esri.Credential({userId:this.userInfo.username,server:this._serverInfo.server,token:a.token,expires:esri.isDefined(a.expires)?Number(a.expires):null,ssl:a.ssl,validity:this._serverInfo.shortLivedTokenValidity}));else return null}),
c.hitch(this,function(a){a.code=403;this._pendingDfd.errback(a)}))},getServiceInfoOverProxy:function(a,e){var f=this._util.isHostedService(a)||this._util.isAgolService(a),d={useProxy:!1,timeout:5E3,addSSL:f,addToken:f&&!1!==esriGeowConfig.isMultiTenant};this._svcUrl=a.split("?")[0];return!1===e?this._getServiceInfo(a):this._signIn(this._svcUrl,this.userInfo).then(c.hitch(this,function(b){c.mixin(d,{disableIdentityLookup:b?!1:!0,useProxy:!0});return this._getServiceInfo(a,d)}))},_getServiceInfo:function(a,
e){if(esriGeowConfig.allSSL||"https:"===window.location.protocol)if(this._util.isHostedService(a)||this._util.supportsHttps(a))a=a.replace("http:/","https:/");else if(-1<a.indexOf("http:/"))return a=new c.Deferred,a.reject(this.i18n.addItemFrm.errors.sslError),a;return this._util.request({url:a,content:{}},e).then(c.hitch(this,function(a){this._editingCredential=!1;return this.serviceInfo=a}),c.hitch(this,function(a){this._editingCredential=!1;a&&-1!==c.indexOf(this._tokenAuthentication,a.code)?esri.show(this.domNode):
a&&403===a.code?esri.show(this.domNode):esri.hide(this.domNode);throw a;}))},_onCredential:function(){this.credentials=[];this.userInfo={username:this._username.get("value"),password:this._password.get("value")};this._editingCredential=!0;this.onCredentialChange(this.userInfo)},_onChangeCredential:function(a){this._editingCredential=a},_findServerInfo:function(a){var e=esri.id.findServerInfo(a);e?(a=new c.Deferred,a.resolve(e)):(e=new esri.ServerInfo,e.server=esri.id._getOrigin(a),a=esri.id._getTokenSvcUrl(a).then(c.hitch(this,
function(a){e.tokenServiceUrl=c.getObject("authInfo.tokenServicesUrl",!1,a)||c.getObject("authInfo.tokenServiceUrl",!1,a)||c.getObject("tokenServiceUrl",!1,a);e.currentVersion=a.currentVersion;e.hasServer=!0;esri.id.registerServers([e]);return e})));return a},_signIn:function(a,e){var f;e&&e.username&&e.password?f=this._findServerInfo(a).then(c.hitch(this,function(d){if(esri.id._checkProtocol(a,d,function(a){}))return esri.id.generateToken(d,e).then(c.hitch(this,function(b){var f=esri.isDefined(b.expires)?
Number(b.expires):null;b=new esri.Credential({userId:e.username,server:d.server,token:b.token,expires:f,ssl:!!b.ssl,validity:d.shortLivedTokenValidity,resources:[a],scope:"server"});-1===c.indexOf(esri.id.credentials,b)&&esri.id.credentials.push(b);return e}),c.hitch(this,function(a){a.code=403;throw a;}))})):(f=new c.Deferred,f.resolve(null));return f}})})},"arcgisonline/sharing/dijit/_TimezoneUtils":function(){define(["dojo/_base/declare","dojo/_base/array"],function(c,l){return{TimezoneUtils:{_winter:new Date("January, 1, 2013"),
_summer:new Date("June, 1, 2013"),_winZones:{0:{offset:-720,id:"Dateline Standard Time",supportsDaylightSavingTime:!1,offsetText:"-12:00"},110:{offset:-660,id:"UTC-11",supportsDaylightSavingTime:!1,offsetText:"-11:00",msid:110},200:{offset:-600,id:"Hawaiian Standard Time",supportsDaylightSavingTime:!1,offsetText:"-10:00"},300:{offset:-540,id:"Alaskan Standard Time",supportsDaylightSavingTime:!0,offsetText:"-9:00"},400:{offset:-480,id:"Pacific Standard Time",supportsDaylightSavingTime:!0,offsetText:"-8:00"},
410:{offset:-480,id:"Pacific Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-8:00"},520:{offset:-420,id:"US Mountain Standard Time",supportsDaylightSavingTime:!1,offsetText:"-7:00"},510:{offset:-420,id:"Mountain Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-7:00"},500:{offset:-420,id:"Mountain Standard Time",supportsDaylightSavingTime:!0,offsetText:"-7:00"},610:{offset:-360,id:"Central America Standard Time",supportsDaylightSavingTime:!1,offsetText:"-6:00"},
620:{offset:-360,id:"Central Standard Time",supportsDaylightSavingTime:!0,offsetText:"-6:00"},630:{offset:-360,id:"Central Standard Time (Mexico)",supportsDaylightSavingTime:!0,offsetText:"-6:00"},600:{offset:-360,id:"Canada Central Standard Time",supportsDaylightSavingTime:!1,offsetText:"-6:00"},710:{offset:-300,id:"SA Pacific Standard Time",supportsDaylightSavingTime:!1,offsetText:"-5:00"},700:{offset:-300,id:"Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"-5:00"},720:{offset:-300,
id:"US Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"-5:00"},730:{offset:-270,id:"Venezuela Standard Time",supportsDaylightSavingTime:!1,offsetText:"-4:30"},850:{offset:-240,id:"Paraguay Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},800:{offset:-240,id:"Atlantic Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},810:{offset:-240,id:"Central Brazilian Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},830:{offset:-240,id:"SA Western Standard Time",
supportsDaylightSavingTime:!1,offsetText:"-4:00"},820:{offset:-240,id:"Pacific SA Standard Time",supportsDaylightSavingTime:!0,offsetText:"-4:00"},900:{offset:-210,id:"Newfoundland Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:-30"},910:{offset:-180,id:"E. South America Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},950:{offset:-180,id:"Argentina Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},940:{offset:-180,id:"SA Eastern Standard Time",supportsDaylightSavingTime:!1,
offsetText:"-3:00"},920:{offset:-180,id:"Greenland Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},930:{offset:-180,id:"Montevideo Standard Time",supportsDaylightSavingTime:!0,offsetText:"-3:00"},1010:{offset:-120,id:"UTC-02",supportsDaylightSavingTime:!1,offsetText:"-2:00"},1E3:{offset:-120,id:"Mid-Atlantic Standard Time",supportsDaylightSavingTime:!0,offsetText:"-2:00"},1100:{offset:-60,id:"Azores Standard Time",supportsDaylightSavingTime:!0,offsetText:"-1:00"},1110:{offset:-60,
id:"Cape Verde Standard Time",supportsDaylightSavingTime:!1,offsetText:"-1:00"},1220:{offset:0,id:"Morocco Standard Time",supportsDaylightSavingTime:!0,offsetText:"0:00"},1230:{offset:0,id:"UTC",supportsDaylightSavingTime:!1,offsetText:"0:00"},1200:{offset:0,id:"GMT Standard Time",supportsDaylightSavingTime:!0,offsetText:"0:00"},1210:{offset:0,id:"Greenwich Standard Time",supportsDaylightSavingTime:!1,offsetText:"0:00"},1340:{offset:60,id:"W. Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},
1300:{offset:60,id:"Central Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1320:{offset:60,id:"Romance Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1310:{offset:60,id:"Central European Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1330:{offset:60,id:"W. Central Africa Standard Time",supportsDaylightSavingTime:!1,offsetText:"1:00"},1350:{offset:60,id:"Namibia Standard Time",supportsDaylightSavingTime:!0,offsetText:"1:00"},1430:{offset:120,
id:"GTB Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1460:{offset:120,id:"Middle East Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1410:{offset:120,id:"Egypt Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1480:{offset:120,id:"Syria Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1400:{offset:120,id:"E. Europe Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1470:{offset:120,id:"South Africa Standard Time",supportsDaylightSavingTime:!1,
offsetText:"2:00"},1420:{offset:120,id:"FLE Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1490:{offset:120,id:"Turkey Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1440:{offset:120,id:"Israel Standard Time",supportsDaylightSavingTime:!0,offsetText:"2:00"},1450:{offset:180,id:"Jordan Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:00"},1510:{offset:180,id:"Arabic Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:00"},1530:{offset:180,id:"Kaliningrad Standard Time",
supportsDaylightSavingTime:!0,offsetText:"3:00"},1500:{offset:180,id:"Arab Standard Time",supportsDaylightSavingTime:!1,offsetText:"3:00"},1520:{offset:180,id:"E. Africa Standard Time",supportsDaylightSavingTime:!1,offsetText:"3:00"},1535:{offset:210,id:"Iran Standard Time",supportsDaylightSavingTime:!0,offsetText:"3:30"},1600:{offset:240,id:"Arabian Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:00"},1610:{offset:240,id:"Azerbaijan Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},
1540:{offset:240,id:"Russian Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1650:{offset:240,id:"Mauritius Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1640:{offset:240,id:"Georgian Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:00"},1620:{offset:240,id:"Caucasus Standard Time",supportsDaylightSavingTime:!0,offsetText:"4:00"},1660:{offset:270,id:"Afghanistan Standard Time",supportsDaylightSavingTime:!1,offsetText:"4:30"},1710:{offset:300,id:"West Asia Standard Time",
supportsDaylightSavingTime:!1,offsetText:"5:00"},1715:{offset:300,id:"Pakistan Standard Time",supportsDaylightSavingTime:!0,offsetText:"5:00"},1720:{offset:330,id:"India Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:30"},1730:{offset:330,id:"Sri Lanka Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:30"},1740:{offset:345,id:"Nepal Standard Time",supportsDaylightSavingTime:!1,offsetText:"5:45"},1800:{offset:360,id:"Central Asia Standard Time",supportsDaylightSavingTime:!1,offsetText:"6:00"},
1810:{offset:360,id:"Bangladesh Standard Time",supportsDaylightSavingTime:!0,offsetText:"6:00"},1755:{offset:360,id:"Ekaterinburg Standard Time",supportsDaylightSavingTime:!0,offsetText:"6:00"},1820:{offset:390,id:"Myanmar Standard Time",supportsDaylightSavingTime:!1,offsetText:"6:30"},1900:{offset:420,id:"SE Asia Standard Time",supportsDaylightSavingTime:!1,offsetText:"7:00"},1830:{offset:420,id:"N. Central Asia Standard Time",supportsDaylightSavingTime:!0,offsetText:"7:00"},2E3:{offset:480,id:"China Standard Time",
supportsDaylightSavingTime:!1,offsetText:"8:00"},1910:{offset:480,id:"North Asia Standard Time",supportsDaylightSavingTime:!0,offsetText:"8:00"},2020:{offset:480,id:"Singapore Standard Time",supportsDaylightSavingTime:!1,offsetText:"8:00"},2040:{offset:480,id:"W. Australia Standard Time",supportsDaylightSavingTime:!0,offsetText:"8:00"},2030:{offset:480,id:"Taipei Standard Time",supportsDaylightSavingTime:!1,offsetText:"8:00"},2050:{offset:480,id:"Ulaanbaatar Standard Time",supportsDaylightSavingTime:!1,
offsetText:"8:00"},2060:{offset:540,id:"North Asia East Standard Time",supportsDaylightSavingTime:!0,offsetText:"9:00"},2110:{offset:540,id:"Tokyo Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:00"},2100:{offset:540,id:"Korea Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:00"},2140:{offset:570,id:"Cen. Australia Standard Time",supportsDaylightSavingTime:!0,offsetText:"9:30"},2130:{offset:570,id:"AUS Central Standard Time",supportsDaylightSavingTime:!1,offsetText:"9:30"},2210:{offset:600,
id:"E. Australia Standard Time",supportsDaylightSavingTime:!1,offsetText:"10:00"},2200:{offset:600,id:"AUS Eastern Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2240:{offset:600,id:"West Pacific Standard Time",supportsDaylightSavingTime:!1,offsetText:"10:00"},2220:{offset:600,id:"Tasmania Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2150:{offset:600,id:"Yakutsk Standard Time",supportsDaylightSavingTime:!0,offsetText:"10:00"},2300:{offset:660,id:"Central Pacific Standard Time",
supportsDaylightSavingTime:!1,offsetText:"11:00"},2250:{offset:660,id:"Vladivostok Standard Time",supportsDaylightSavingTime:!0,offsetText:"11:00"},2410:{offset:720,id:"New Zealand Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},2430:{offset:720,id:"UTC+12",supportsDaylightSavingTime:!1,offsetText:"12:00"},2400:{offset:720,id:"Fiji Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},2310:{offset:720,id:"Magadan Standard Time",supportsDaylightSavingTime:!0,offsetText:"12:00"},
2500:{offset:780,id:"Tonga Standard Time",supportsDaylightSavingTime:!1,offsetText:"13:00"},120:{offset:780,id:"Samoa Standard Time",supportsDaylightSavingTime:!0,offsetText:"13:00"}},stdTimezoneOffset:function(){return Math.max(this._winter.getTimezoneOffset(),this._summer.getTimezoneOffset())},isInDaylightSavingTime:function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()},supportsDaylightSavingTime:function(){return this._winter.getTimezoneOffset()!==this._summer.getTimezoneOffset()},
winZone:function(){var c=-this._winter.getTimezoneOffset(),a=[],e;for(e in this._winZones)this._winZones[e].offset===c&&a.push(this._winZones[e]);if(a.length){var f=this.supportsDaylightSavingTime(),c=l.filter(a,function(a){return a.supportsDaylightSavingTime===f});return(c.length?c[0]:a[0]).id}return null}}}})},"arcgisonline/map/thumbnail/buildThumbnailURLFromFSUrl":function(){define(["arcgisonline/map/thumbnail/buildThumbnailURLFromFSItem"],function(c){return function(l,h){return c({url:l,extent:h})}})},
"arcgisonline/sharing/dijit/dialog/PublishTileServiceDlg":function(){define("dojo/_base/declare dojo/on dojo/dom-attr dojo/query dojo/dom dojo/dom-style dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/string dojo/_base/window dojo/promise/all dojo/when dojo/Deferred dojo/_base/array dojo/cookie dojo/dom-class dojo/json dijit/registry dijit/form/CheckBox dijit/form/TextBox dijit/form/RadioButton dijit/form/Select ./ConfirmDialog dijit/focus dojo/_base/event dojo/keys dojo/number ./_CreateItemUtilMixin ./ItemPropertiesDlg dojo/topic esri/lang esri/Evented esri/arcgis/Portal ../../geow/Account ./_PublishTileServiceDlgMixin ../../../esriGeowConfig ../../util ../../../pages/pageUtil ../../../pages/serviceUtil ../../../map/core/canUseForPublish esri/map esri/dijit/VisibleScaleRangeSlider ../../../pages/isGeographic dojo/i18n!arcgisonline/nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/PublishTilesDlg.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G,T,I,D,X,ca,V,aa,ba,ea){return c("arcgisonline.sharing.dijit.dialog.PublishTilesDlg2",[b,g,k,S,M],{baseClass:"esriPublishTilesDlg",showFolders:!1,_typeInfo:"mapserver",userFolders:"",templateString:ea,onDone:function(){},postMixInProperties:function(){this.inherited(arguments);this.i18n=d.mixin({},ba);this._portalUser=(this._portal=G.portal)&&this._portal.getPortalUser();this._typeInfo="tiles"===this.type?"mapserver":
"scenes"===this.type?"sceneserver":"features"===this.type?"featureserver":"vectorTiles"===this.type?"vectortileserver":this.type},postCreate:function(){this.inherited(arguments);U.getSelf(d.hitch(this,function(a){this._loadConnections();this._portal?this._init():(this._portal=new Q.Portal({url:G.restBaseUrl,self:a}),this._portal.on("load",d.hitch(this,function(){this._connect&&this._connect.remove();this._portalUser=this._portal.getPortalUser();this._init()})))}))},_init:function(){this._restBaseUrl=
G.allSSL?this._portal.portalUrl.replace("http:/","https:/"):this._portal.portalUrl;this._contentUrl=this._restBaseUrl+"content";this._publishUrl=this._contentUrl+"/users/"+this._portalUser.username;this.set("message",this.get("message"));this._portal&&!this._portal.isPortal&&(this.cacheStorageInfo.storageFormat="esriMapCacheStorageModeExploded");this._itemPropertiesDlg.on("load",d.hitch(this,function(){this._loadData().then(d.hitch(this,function(a){this._itemPropertiesDlg.set("focus","title");G.self.hasCategorySchema&&
(a=[],this.fsItem?a=this.fsItem.categories||a:this._selectedService&&(a=this._selectedService.categories||a),this._itemPropertiesDlg.set("categories",a))}))}))},destroy:function(){a(".dijit",this.contentNode).map(C.byNode).forEach(function(a){a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy();a=null});this._errorDlg&&(this._errorDlg.destroyRecursive(),this._errorDlg=null);this.inherited(arguments);this._tagsDijit=this._portalUser=this._portal=null},_loadConnections:function(){this.own(L.subscribe("dlg/onOk",
d.hitch(this,function(){this._focusNode&&setTimeout(d.hitch(this,function(){E.focus(this._focusNode)}),250)})),L.subscribe("/esri/disable",d.hitch(this,function(a,b){this.set("disabled",a,b,!0)})),l(this._agoBasemapRadio,"click",d.hitch(this,function(){this._isUserDefinedTileInfo=!1;this._customBasemapUrl.set("disabled",!0);this._updateLODs(this.lods)})),l(this._customBasemapRadio,"click",d.hitch(this,function(){a(".visibleScaleRange",this.domNode).addClass("hide");this._isUserDefinedTileInfo=!0;
this._customBasemapUrl.set("disabled",!1);this.userDefinedTileInfo&&this._updateLODs(this.userDefinedTileInfo.lods)})),l(this._customBasemapUrl,"keyup",d.hitch(this,function(a){a.keyCode===O.ENTER&&(N.stop(a),this._customBasemapUrl.onChange(this._customBasemapUrl.get("value")))})),l(this._customBasemapUrl,"change",d.hitch(this,function(b){b&&b.length?(this._customBasemapUrl.set("disabled",!0),this.set("disabled",!0,this.i18n.publishWizard.fetchingServiceInfo),this._fetchTileLayerInfo(b).then(d.hitch(this,
function(a){this.userDefinedTileInfoUrl=b;this.userDefinedTileInfo=a;this._updateLODs(a.lods);this._customBasemapUrl.set("disabled",!1);this.set("disabled",this._buildingVisibleRange)}),d.hitch(this,function(a){this.userDefinedTileInfo=null;this._showError(a)}))):(this.userDefinedTileInfo=null,a(".visibleScaleRange",this.domNode).addClass("hide"))})),l(this._tilesOnDemand,"click",d.hitch(this,"_visibleScaleRangeChange")))},_updateLODs:function(a){(a=a||this.lods)&&this.set("calculatedScales",this._calculateConstraints({layers:[{minScale:a[0].scale,
maxScale:a[a.length-1].scale}]}))},_adjustDefaultLODs:function(a){var b=a.maxScale||0,c=a.minScale||this.lods[0].scale;this.lods=u.filter(this.lods,function(a){return a.scale>=b&&a.scale<=c});return this._updateLODs(this.lods)},_getLayers:function(a){return a&&a.length?u.map(a,function(a){a.layerDefinition&&(a=d.mixin(a,a.layerDefinition),delete a.layerDefinition);return a}):null},_getLayerDefs:function(a){return a&&a.length?u.filter(a,function(a){return a.layerDefinition}).map(function(a){return{id:a.id,
layerDefinition:a.layerDefinition}}):null},_loadData:function(){var b=new v;"wfs"!==this._type&&this.fsItem?(this.set("disabled",!0,this.i18n.publishWizard.fetchingServiceInfo),this._selectedService=d.mixin({},this.fsItem),this._fetchFSInfo(this._selectedService).then(d.hitch(this,function(c){this._featureServiceJson=c.serviceInfo;this._selectedLayers=(this._selectedService.itemData=c.itemData)&&c.itemData.layers;this._spatialReference=this._featureServiceJson&&this._featureServiceJson.spatialReference||
{wkid:4326};"scenes"!==this._type||aa(this._spatialReference)||a(".sceneProperties .sceneDataDisplay",this.domNode).removeClass("hide");this._itemPropertiesDlg.set("summary",this._selectedService.snippet||"");this._itemPropertiesDlg.set("tags",this._selectedService.tags);this._itemPropertiesDlg.set("title",this._getSuggestedTitle(this.item,this._selectedService.title));this._userFolders&&this._itemPropertiesDlg.set("folders",this._userFolders);h.set(this._globalWkidRadioLabel,"innerHTML",p.substitute(this.i18n.publishTileServiceDlg.globalWkid,
{wkid:"4326"}));h.set(this._localWkidRadioLabel,"innerHTML",p.substitute(this.i18n.publishTileServiceDlg.localWkid,{wkid:""+this._spatialReference.wkid||4326}));this._selectedServiceLayers=c.layers&&c.layers.layers;this.set("calculatedScales",this._calculateConstraints(c.layers));this._checkTilesOnDemandSupport(c.layers);this.set("disabled",this._buildingVisibleRange);b.resolve(this._selectedService)}),d.hitch(this,function(a){this._showError(a);b.reject(a)}))):(this.fsItem&&(this._itemPropertiesDlg.set("summary",
this.fsItem.snippet||""),this._itemPropertiesDlg.set("tags",this.fsItem.tags),this._itemPropertiesDlg.set("title",this._getSuggestedTitle(this.item,this.fsItem.title)),this._userFolders&&this._itemPropertiesDlg.set("folders",this._userFolders)),b.resolve(this.fsItem));return b},_getSuggestedTitle:function(a,b){if("features"!==this._type)return b;a=a&&a.resultData||[];var c="Feature Service";switch(this._type.toLowerCase()){case "wfs":c="WFS";break;case "scenes":c="Scene Service";break;case "features":c=
"Feature Service";break;default:c="Feature Service"}a=u.filter(a,function(a){return a.type&&a.type===c});return b+(a.length?"_"+(a.length+1):"_1")},_setMessageAttr:{node:"_message",type:"innerHTML"},_getMessageAttr:function(){if(this.message)return this.message;var a=this._type.toLowerCase(),b=ba.publishTileServiceDlg;switch(a){case "wfs":return b.wfsServiceDetailsDesc;case "scenes":return b.sceneServiceDetailsDesc;case "features":return b.viewServiceDetailsDesc;default:return b.serviceDetailsDesc}},
_setTypeAttr:function(b){this._type=b;"tiles"===b?a(".tileProperties",this.domNode).removeClass("hide"):"scenes"===b&&a(".sceneProperties",this.domNode).removeClass("hide")},_checkTilesOnDemandSupport:function(a){var b=!1;G.tilesOnDemandEnabled&&a&&a.layers&&(b=!u.some(a.layers,function(a){return!1===X(a,!1)}));t[b?"remove":"add"](this._tilesOnDemandContainer,"hide");this._tilesOnDemand.set("checked",b)},_getBusyMessageAttr:function(){var a=this._type.toLowerCase(),b=ba.publishTileServiceDlg;switch(a){case "wfs":return b.publishingWfsService;
case "scenes":return b.publishingSceneService;case "features":return b.publishingViewService;default:return b.publishingTileService}},_setShowFoldersAttr:function(a){this._showFolders=a},_setItemAttr:function(a){if(!this.fsItem||this.fsItem&&a.url!==this.fsItem.url)this.fsItem=d.mixin({},a),this._created&&this._loadData().then(d.hitch(this,function(a){this._isUserDefinedTileInfo=!1;this._customBasemapUrl.set("disabled",!0);this._agoBasemapRadio.set("checked",!0);this._itemPropertiesDlg.set("focus",
"title");G.self.hasCategorySchema&&this._itemPropertiesDlg.set("categories",this.fsItem.categories)}))},_setFoldersAttr:function(a){var b=this._portalUser&&this._portalUser.username;this._userFolders=a.map(function(a){a&&a.id===b&&(a=d.mixin(a,{id:"/"}));return a})},_setFocusAttr:function(b){b=a(b,this.domNode);E.focus(b&&b.length?b[0]:this._title.domNode)},_setDisabledAttr:function(a,b,c){this.set("readOnly",a,b,c)},_setReadOnlyAttr:function(b,c,d){a(".dijit",this.domNode).map(C.byNode).forEach(function(a){a.set("disabled",
b)});a("a",this.domNode)[b?"addClass":"removeClass"]("disabledLink");a("label",this.domNode)[b?"addClass":"removeClass"]("disabled");this._itemPropertiesDlg.set("disabled",b);d||(b&&c&&L.publish("/dlg/busyMessage",c),L.publish("/esri/disable",b,c))},_setCalculatedScalesAttr:function(b){this._buildingVisibleRange=!0;var c={constraints:b,minScale:b.minScale,maxScale:b.maxScale||18055.954822},e=this.fsItem&&this.fsItem.url||this._selectedService&&this._selectedService.url,f=this.fsItem&&this.fsItem.layers||
this._selectedServiceLayers,g=d.clone(this.userDefinedTileInfo&&this.userDefinedTileInfo.lods?this.userDefinedTileInfo.lods:this.tileCacheInfo.lods);a(".visibleScaleRange",this.domNode).removeClass("hide");"tiles"===this.type?(this._visibleScaleRangeSlider&&(this._visibleScaleRangeSlider.destroyRecursive(),m.empty(this._visibleScaleRangeContainer)),this._visibleScaleRangeChangeHandler&&(this._visibleScaleRangeChangeHandler.remove(),this._visibleScaleRangeChangeHandler=void 0),e?(I.showNodes([this._visibleRangeLoader,
this._visibleRangeLoaderMsg]),I.activateNode(this._visibleRangeLoader),n(u.map(f,d.hitch(this,function(a){return D.getSuggestedScaleRange(e+"/"+a.id)}))).then(d.hitch(this,function(a){var e,f,k;a.forEach(d.hitch(this,function(a,c){a&&(e=R.isDefined(e)?a&&a.minScale>e?a.minScale:e:a?a.minScale:b.minScale,k=R.isDefined(k)?a&&a.maxScale&&a.maxScale<k?a.maxScale:k:a&&a.maxScale?a.maxScale:18055.954822,f=R.isDefined(f)?a&&a.minScale&&a.minScale<f?a.minScale:f:(a&&a.minScale?a.minScale:b.minScale)||this.SCALE_MIN)}));
this._maxSupportedMinScale=b.minScale||this.SCALE_MIN;this._calculatedMinScale=(this._cacheOnDemandMinScale=f||e)||b.minScale;c.minScale=this._calculatedMinScale;c.maxScale=k||c.maxScale;c.minScale>b.minScale&&0<b.minScale&&(c.minScale=b.minScale);c.maxScale>=c.minScale&&0<c.minScale&&(c.maxScale=this._normalizeMaxScale(c.minScale,c.maxScale,g));this._visibleScaleRangeSlider=new V(c,m.create("div",null,this._visibleScaleRangeContainer));this._visibleScaleRangeSlider.startup();this._visibleScaleRangeChangeHandler=
l(this._visibleScaleRangeSlider,"scale-range-change",d.hitch(this,"_visibleScaleRangeChange"));this.own(this._visibleScaleRangeChangeHandler);I.deactivateNode(this._visibleRangeLoader);I.hideNodes([this._visibleRangeLoader,this._visibleRangeLoaderMsg]);this._buildingVisibleRange=!1;this.set("disabled",this._buildingVisibleRange)}),d.hitch(this,function(){this._calculatedMinScale=b.minScale;this._visibleScaleRangeSlider=new V(c,m.create("div",null,this._visibleScaleRangeContainer));this._visibleScaleRangeSlider.startup();
this._visibleScaleRangeChangeHandler=l(this._visibleScaleRangeSlider,"scale-range-change",d.hitch(this,"_visibleScaleRangeChange"));this.own(this._visibleScaleRangeChangeHandler);I.deactivateNode(this._visibleRangeLoader);I.hideNodes([this._visibleRangeLoader,this._visibleRangeLoaderMsg]);this._buildingVisibleRange=!1;this.set("disabled",this._buildingVisibleRange)}))):(this._calculatedMinScale=void 0,this._visibleScaleRangeSlider=new V(c,m.create("div",null,this._visibleScaleRangeContainer)),this._visibleScaleRangeSlider.startup(),
this._visibleScaleRangeChangeHandler=l(this._visibleScaleRangeSlider,"scale-range-change",d.hitch(this,"_visibleScaleRangeChange")),this.own(this._visibleScaleRangeChangeHandler),I.deactivateNode(this._visibleRangeLoader),I.hideNodes([this._visibleRangeLoader,this._visibleRangeLoaderMsg]),this._buildingVisibleRange=!1,this.set("disabled",this._buildingVisibleRange))):this._buildingVisibleRange=!1},_visibleScaleRangeChange:function(){var a=this._tilesOnDemand.get("checked");if(this._calculatedMinScale&&
this._visibleScaleRangeSlider&&this._visibleScaleRangeSlider._started){var b=this._visibleScaleRangeSlider.get("minScale");(0===b&&0!==this._calculatedMinScale||b>this._calculatedMinScale)&&a?(I.showNode(this._increaseScaleWarning),this._increaseScaleWarning.scrollIntoView(!1)):I.hideNode(this._increaseScaleWarning)}else I.hideNode(this._increaseScaleWarning)},_getItemAttr:function(){return"wfs"===this._type?this.get("wfsItem"):"scenes"===this._type?this.get("sceneItem"):"features"===this._type?this.get("viewItem"):
"vectorTiles"===this._type?this.get("vectorTileItem"):this.get("tileItem")},_getWfsItemAttr:function(){var a=this._itemPropertiesDlg.get("item"),b;b=d.mixin({},{name:a.title.replace(/ /g,"_"),wfsProperties:{title:a.title,"abstract":a.snippet,keyword:a.tags}});return{item:a,publishContent:{itemid:this.fsItem.id,filetype:"featureService",publishParameters:b,outputType:"WFS"},publishParams:b}},_getSceneItemAttr:function(){var a=this._itemPropertiesDlg.get("item"),b=this._globalWkidRadio.get("checked"),
c=this._featureServiceJson,e;e=d.mixin({},{name:a.title.replace(/ /g,"_")});b||(e=d.mixin(e,{targetSR:c.spatialReference}));return{item:a,publishContent:{itemid:this.fsItem.id,filetype:"featureService",publishParameters:e,outputType:"sceneService",buildInitialCache:!1},publishParams:e}},_getTileItemAttr:function(){var a=this._visibleScaleRangeSlider.get("actualMaxScale"),b=this._visibleScaleRangeSlider.get("minScale")||this._maxSupportedMinScale||this.SCALE_MIN,c=this._isUserDefinedTileInfo?d.clone(this.userDefinedTileInfo):
d.clone(this.tileCacheInfo),e=d.clone(this.cacheStorageInfo),f={minScale:b,maxScale:a},a=this._tilesOnDemand.get("checked"),b=this._itemPropertiesDlg.get("item");c.dpi&&!c.preciseDpi&&(c.preciseDpi=c.dpi);for(var g=0;g<c.lods.length;g++)delete c.lods[g].label;c=d.mixin(f,{name:b.title.replace(/ /g,"_"),tilingSchema:{tileCacheInfo:c,tileImageInfo:this.tileImageInfo,cacheStorageInfo:e}});G.tilesOnDemandEnabled&&(c.cacheOnDemand=a)&&(c.cacheOnDemandMinScale=this._cacheOnDemandMinScale,c.capabilities=
"Map,ChangeTracking");return{item:b,publishContent:{itemid:this.fsItem.id,filetype:"featureService",publishParameters:c,outputType:"tiles",buildInitialCache:!1},publishParams:c}},_getVectorTileItemAttr:function(){var a=this._featureServiceJson,a=a.layers&&a.layers.length?a.layers[0]:{},b={minScale:a.minScale||0,maxScale:a.maxScale||0},a=this._itemPropertiesDlg.get("item"),b=d.mixin(b,{name:a.title.replace(/ /g,"_")},this.vectorTilePublishParams);return{item:a,publishContent:{itemid:this.fsItem.id,
filetype:"featureService",publishParameters:b,outputType:"vectorTiles",buildInitialCache:!1},publishParams:b}},_getViewItemAttr:function(){var a=this._itemPropertiesDlg.get("item"),b=this._featureServiceJson,c,b=d.mixin({},{name:a.title.replace(/ /g,"_"),isView:!0,sourceSchemaChangesAllowed:!0,isUpdatableView:!0,spatialReference:b.spatialReference,initialExtent:b.initialExtent,capabilities:"Query"});this._portal&&this._portal.isPortal&&(c=this._getDataSourceType(this.fsItem))&&c.dataSourceType&&(b=
d.mixin(b,{options:c}));return{item:a,createParams:b}},_validate:function(){var a=new v,b;this._focusNode=null;b=this._itemPropertiesDlg._validate();b=b.then(d.hitch(this,"_checkRequired"));b=b.then(d.hitch(this,function(b){a.resolve(b)}),d.hitch(this,function(b){this._showError(b);a.reject(b)}));return a},_checkRequired:function(){var b=new v,c;"tiles"===this._type&&(this._featureServiceJson||(c=this.i18n.publishWizard.errors.selectedServiceNotExist),this._isUserDefinedTileInfo&&!this.userDefinedTileInfo&&
(this._focusNode=a("input",this._customBasemapUrl.domNode)[0],c=this.i18n.publishWizard.errors.customTileBasemapNotSpecified));if(c)return b.reject(c),b;H.serviceNameAvailable(this._itemPropertiesDlg.get("item"),this._portal).then(d.hitch(this,function(c){c&&c.available?b.resolve(!0):(this._focusNode=a("input",this._itemPropertiesDlg._title.domNode)[0],b.reject(ba.addItemFrm.errors.serviceNameExists))}));return b},publishService:function(){var a=this.get("item"),b=a.publishContent,c=this._tilesOnDemand.get("checked"),
e,f="scenes"===this.type,g=new v,k=new v;H.publishItem(d.mixin(a,{owner:this.fsItem.owner}),b,this._portal).then(d.hitch(this,function(b){var m=b&&b.publishResult?b.publishResult[0]:null;m&&m.error?(m.serviceItemId&&H.deleteItem({id:m.serviceItemId,folderId:this.fsItem.ownerFolder},this._portal),this._showError(m.error||ba.addItemFrm.errors.error),g.reject()):(H.checkStatus({id:m.serviceItemId,jobId:m.jobId},k,500,this._portal),k.then(d.hitch(this,function(b){H.moveItem({id:b.id,folderId:this.fsItem.ownerFolder,
owner:this.fsItem.owner},a.item.folderId,this._portal).then(d.hitch(this,function(b){(e=d.mixin(a.item,b,!f&&this._selectedService&&this._selectedService.itemData?{text:y.stringify(this._selectedService.itemData)}:{}))&&delete e.typeKeywords;H.updateItem(e,this._portal).then(d.hitch(this,function(){this.set("disable",!1);g.resolve({id:m.serviceItemId,jobId:m.jobId,cacheOnDemand:c})}))}))}),d.hitch(this,function(a){H.deleteItem({id:m.serviceItemId,folderId:this.fsItem.ownerFolder},this._portal);this._showError(a)})))}),
d.hitch(this,function(a){this._showError(a)}));return g},createViewService:function(){var a=this.get("item"),b={createParameters:y.stringify(a.createParams),outputType:"featureService",isView:!0},c=this.fsItem&&this.fsItem.serviceInfo||{},e=this.fsItem.layers,f,g,k=new v,c=e.map(function(a){f=d.mixin({},a);delete f.fields;delete f.indexes;delete f.relationships;return f}).map(d.hitch(this,this._addAdminLayerInfo,c)),e=u.filter(c||[],d.hitch(this,function(a){return a&&"Table"===a.type})),c=u.filter(c||
[],d.hitch(this,function(a){return a&&"Feature Layer"===a.type}));H.createService(d.mixin(a,{owner:this.fsItem.owner}),b,y.stringify({layers:c,tables:e}),this._portal).then(d.hitch(this,function(b){return H.moveItem({id:b&&b.createResult&&b.createResult.itemId,owner:this.fsItem.owner},a.item.folderId,this._portal)}),d.hitch(this,function(a){this._showError(a);throw Error(a);})).then(d.hitch(this,function(b){g=d.mixin(a.item,b,this._selectedService&&this._selectedService.itemData?{text:y.stringify(this._selectedService.itemData)}:
{});g=d.mixin(g,{folderId:null});delete g.typeKeywords;delete g.type;delete g.wabType;return H.updateItem(g,this._portal)})).then(d.hitch(this,function(a){k.resolve(d.mixin({},g,a))}));return k},_addAdminLayerInfo:function(a,b){a=/(\/(MapServer|FeatureServer)).*/ig;var c=this.fsItem.url;a=c&&c.replace(a,"").replace(/^.*\//,"").replace(/\?.*$/,"");return d.mixin(b,{adminLayerInfo:{viewLayerDefinition:{sourceServiceName:a||b.name,sourceLayerId:b.id,sourceLayerFields:"*"}}})},_getDataSourceType:function(a){a=
a&&a.adminServiceInfo&&a.adminServiceInfo.adminServiceInfo||{};a=a.database&&a.database.datasource||{};return{dataSourceType:a.name&&(-1<a.name.indexOf("/nosqlDatabases")?"spatiotemporal":-1<a.name.indexOf("/enterpriseDatabases")?"relational":null)}},showModal:function(a){var b=new v,c,e=this._type,f=this.dialog=new A({title:"features"===e?this.i18n.itemProperties.publishViewLayer:this.i18n.publishTileServiceDlg.publishTileDialogTitle,style:{width:"650px",height:"auto"}});f.setContent(this.domNode);
f.show();this.own(l(f.okButton,"click",d.hitch(this,function(){L.publish("/esri/disable",!0,this.get("busyMessage"));this._validate().then(d.hitch(this,function(){c="features"!==e?this.publishService():this.createViewService();c.then(d.hitch(this,function(a){f.hide().then(d.hitch(this,function(){b.resolve(a)}))}))}))})),l(f,"hide",d.hitch(this,function(){f.destroyRecursive()})));return b},_showError:function(a){a=d.mixin(d.mixin({},ba.publishWizard.errors.error),a);var b=d.hitch(this,function(){this.set("disabled",
!1);this._errorDlg.hide();this._focusNode&&setTimeout(d.hitch(this,function(){E.focus(this._focusNode)}),250)});this._errorDlg=new A({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.own(l(this._errorDlg.closeButtonNode,"click",b));this._errorDlg.show(a).then(b);return!1}})})},"arcgisonline/sharing/dijit/dialog/_PublishTileServiceDlgMixin":function(){define(["dojo","dijit","dojox","dojo/require!dojo/promise/all,dojo/Deferred,esri/geometry/Extent,arcgisonline/sharing/util"],function(c,
l,h){c.provide("arcgisonline.sharing.dijit.dialog._PublishTileServiceDlgMixin");c.require("dojo.promise.all");c.require("dojo.Deferred");c.require("esri.geometry.Extent");c.require("arcgisonline.sharing.util");c.declare("arcgisonline.sharing.dijit.dialog._PublishTileServiceDlgMixin",null,{_util:arcgisonline.sharing.util,SCALE_MIN:5.91657527591555E8,SCALE_MAX:0,tileCacheInfo:{spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-2.0037508342787E7,y:2.0037508342787E7},rows:256,cols:256,dpi:96,preciseDpi:96,
lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,
resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},
{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147}]},tileImageInfo:{format:"PNG32",compressionQuality:0,antialiasing:!0},cacheStorageInfo:{storageFormat:"esriMapCacheStorageModeCompactV2",packetSize:128},vectorTilePublishParams:{tilingSchema:{tileCacheInfo:{spatialReference:{wkid:102100,
latestWkid:3857},origin:{x:-2.0037508342787E7,y:2.0037508342787E7},rows:512,cols:512,dpi:96,preciseDpi:96,lods:[{level:0,resolution:78271.51696399994,scale:2.95828763795777E8},{level:1,resolution:39135.75848200009,scale:1.47914381897889E8},{level:2,resolution:19567.87924099992,scale:7.3957190948944E7},{level:3,resolution:9783.93962049996,scale:3.6978595474472E7},{level:4,resolution:4891.96981024998,scale:1.8489297737236E7},{level:5,resolution:2445.98490512499,scale:9244648.868618},{level:6,resolution:1222.992452562495,
scale:4622324.434309},{level:7,resolution:611.4962262813797,scale:2311162.217155},{level:8,resolution:305.74811314055756,scale:1155581.108577},{level:9,resolution:152.87405657041106,scale:577790.554289},{level:10,resolution:76.43702828507324,scale:288895.277144},{level:11,resolution:38.21851414253662,scale:144447.638572},{level:12,resolution:19.10925707126831,scale:72223.819286},{level:13,resolution:9.554628535634155,scale:36111.909643},{level:14,resolution:4.77731426794937,scale:18055.954822},{level:15,
resolution:2.388657133974685,scale:9027.977411},{level:16,resolution:1.1943285668550503,scale:4513.988705},{level:17,resolution:.5971642835598172,scale:2256.994353},{level:18,resolution:.29858214164761665,scale:1128.497176},{level:19,resolution:.14929107082380833,scale:564.248588},{level:20,resolution:.07464553541190416,scale:282.124294},{level:21,resolution:.03732276770595208,scale:141.062147},{level:22,resolution:.01866138385297604,scale:70.5310735},{level:23,resolution:.009330691929342804,scale:35.265536760789715}]},
tileImageInfo:{format:"indexedVector",compressionQuality:0,antialiasing:!1},cacheStorageInfo:{storageFormat:"esriMapCacheStorageModeCompactV2",packetSize:128}}},lods:[{level:0,label:"1:591,657,528",scale:5.91657527591555E8},{level:1,label:"1:295,828,764",scale:2.95828763795777E8},{level:2,label:"1:147,914,382",scale:1.47914381897889E8},{level:3,label:"1:73,957,191",scale:7.3957190948944E7},{level:4,label:"1:36,978,595",scale:3.6978595474472E7},{level:5,label:"1:18,489,298",scale:1.8489297737236E7},
{level:6,label:"1:9,244,649",scale:9244648.868618},{level:7,label:"1:4,622,324",scale:4622324.434309},{level:8,label:"1:2,311,162",scale:2311162.217155},{level:9,label:"1:1,155,581",scale:1155581.108577},{level:10,label:"1:577,791",scale:577790.554289},{level:11,label:"1:288,895",scale:288895.277144},{level:12,label:"1:144,448",scale:144447.638572},{level:13,label:"1:72,224",scale:72223.819286},{level:14,label:"1:36,112",scale:36111.909643},{level:15,label:"1:18,056",scale:18055.954822},{level:16,
label:"1:9,028",scale:9027.977411},{level:17,label:"1:4,514",scale:4513.988705},{level:18,label:"1:2,257",scale:2256.994353},{level:19,label:"1:1,128",scale:1128.497176},{level:20,label:"1:564",scale:564.248588},{level:21,label:"1:282",scale:282.124294},{level:22,label:"1:141",scale:141.062147}],statusCheckIntervalTime:2500,_fetchFSInfo:function(a){var e=new c.Deferred,f=a&&a.url,d=a?esriGeowConfig.restBaseUrl+"content/items/"+a.id+"/data":null;f&&d?c.promise.all({serviceInfo:this._fetchServiceInfo(f),
layers:this._fetchServiceLayers(f),itemData:this._fetchItemData(d,a)}).then(c.hitch(this,function(a){e.resolve(c.mixin({},a))})):e.reject(this.i18n.publishWizard.errors.noItemUrl||{message:"Item does not specify a url."});return e},_fetchServiceInfo:function(a){return this._util.request({url:a})},_fetchServiceLayers:function(a){return this._util.request({url:a+"/layers"}).then(c.hitch(this,function(a){return{layers:a.layers}}))},_fetchItemData:function(a,e){return this._util.request({url:a}).then(c.hitch(this,
function(a){var d=[],b="features"===this._type,f;c.forEach(a&&a.layers||[],c.hitch(this,function(a,g){a&&(f=c.mixin({},b?{id:g}:{id:g,layerUrl:e.url+"/"+a.id,layerItemId:e.id,layerDefinition:a.layerDefinition}),a.popupInfo&&(f=c.mixin(f,{popupInfo:a.popupInfo})),!b&&esri.isDefined(a.showLegend)&&(f=c.mixin(f,{showLegend:a.showLegend})));d.push(f)}));return d&&d.length?c.mixin(a,{layers:d}):null}))},_computeScale:function(a,c){a={width:esri.config.defaults.map.width,extent:new esri.geometry.Extent(a),
spatialReference:a.spatialReference||c};return esri.geometry.getScale(a)},_fetchTileLayerInfo:function(a){var e=new c.Deferred,f=function(a){return-1<window.location.href.indexOf("https:")&&a&&-1<a.indexOf("http:")};-1<a.indexOf("/MapServer")?this._util.request({url:a,timeout:1E4},{useProxy:f(a),addToken:!1}).then(c.hitch(this,function(a){a&&a.singleFusedMapCache&&a.tileInfo?e.resolve(this._addScaleLabels(a.tileInfo)):e.reject({title:this.i18n.common.notice,message:this.i18n.publishTileServiceDlg.noTilingSchemeFound})}),
c.hitch(this,function(a){e.reject({title:this.i18n.common.notice,message:this.i18n.publishTileServiceDlg.mapServiceError})})):e.reject({title:this.i18n.common.notice,message:this.i18n.publishTileServiceDlg.badMapServiceUrl});return e},_addScaleLabels:function(a){if(a&&a.lods)return c.forEach(a&&a.lods||[],c.hitch(this,function(a){a.label="1:"+c.number.format(Math.round(a.scale),{pattern:"#,###,###,##0"})})),a},_calculateConstraints:function(a){var e={minScale:null,maxScale:null},f=function(a){if(!esri.isDefined(e.minScale))e.minScale=
a.minScale;else if(a.minScale>e.minScale||0===a.minScale)e.minScale=a.minScale;esri.isDefined(e.maxScale)?a.maxScale<e.maxScale&&(e.maxScale=a.maxScale):e.maxScale=a.maxScale};a?a.layers&&c.forEach(a.layers,f):(e.minScale=this.SCALE_MIN,e.maxScale=this.SCALE_MAX);return e},_normalizeMaxScale:function(a,c,f){if(a<=c&&f){var d;for(c=f.length-1;0<=c;c--)if(a<f[c].scale){d=c+2;break}d=d>f.length-1?f.length-1:d;return f[d].scale}return c}})})},"arcgisonline/pages/isGeographic":function(){define(["esri/WKIDUnitConversion"],
function(c){return function(l){l=l||{};return l.wkid?!c.hasOwnProperty(l.wkid):l.wkt?/^\s*GEOGCS/i.test(l.wkt):!1}})},"arcgisonline/sharing/dijit/dialog/CreateAppDlg":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when dojo/io-query dojox/widget/Wizard dojox/widget/WizardPane dijit/Dialog dijit/registry ./ConfirmDialog ./ItemPropertiesDlg ./BrowseItemsDlg ./ConfirmDialog ./_CreateItemUtilMixin ../../../esriGeowConfig ../../../pages/pageUtil ../../../map/utils/previewInTemplate ../../../map/utils/openMap dijit/_WidgetBase arcgisonline/sharing/util dojo/i18n!../../../nls/arcgisonline arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer arcgisonline/sharing/dijit/dialog/Plugin3DConfigurableAppsViewer".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G){return l([U,h],{showModal:function(a){var b=new C,c=this.item?d.mixin({},this.item,{tags:this.item.isHostedTemplate?[]:this.item.tags||[]}):{},e=a.isWab,f="Web Scene"===c.type,g=S.getHomeAppContext(),m=a.message,n,h=new N({title:a.title||G.itemProperties.createNewApp,buttonOk:G.common.ok,buttonCancel:G.common.cancel,busyMessage:G.addItemFrm.addingItem,style:{width:"550px",height:"auto"}}),p=new O({typeInfo:e?"wab":
"configapp",message:m||(e?G.items.createWABMessage:G.itemProperties.createAppTitle),showFolders:!0,showFile:!1,item:c});this.item&&(p.set("summary",this.item.isHostedTemplate?"":this.item.snippet),p.set("title",this.item.isHostedTemplate?"":this.item.title),p.set("tags",this.item.isHostedTemplate?[]:this.item.tags),L.self.hasCategorySchema&&p.set("categories",this.item.categories||[]));h.setContent(p.domNode);h.show();p.set("focus","title");this.own(q(h,"ok",d.hitch(this,function(){k.publish("/esri/disable",
!0,G.addItemFrm.addingItem);p._validate().then(d.hitch(this,function(){e?(c=d.mixin({},p.get("item")),h.hide().then(d.hitch(this,function(){this.redirectToAppBuilder(c)}))):(n=p.get("item"),this.item.isHostedTemplate||(n=d.mixin(n,{shareWithWebMap:!0},f?{webSceneId:this.item.id}:{webMapId:this.item.id})),S.isPortal()&&c.url&&0===c.url.indexOf("/")&&c.url&&-1===c.url.indexOf(g)&&(c.url=g+c.url),J.createTemplatedApplication(n,c,this.item.portal,this.item).then(function(a){n=a;h.hide()}))}),d.hitch(this,
function(a){k.publish("/esri/disable",!1);this._showError(a)}))})),q(h,"hide",function(){b.resolve(n)}));return b},showWizard:function(a){var b=new C,c=this.item?d.mixin({},this.item,{tags:this.item.isHostedTemplate?[]:this.item.tags||[]}):{},e=new A({title:G.items.newWebMappingAppTitle,"class":"esriCreateAppDlg"}),f=this.item&&this.item.portal||a.portal||{};a=this.item?R.includes(c.types,"is-map"):!0;var m="Web Scene"===c.type,n;a=a?this.item?"arcgisonline/sharing/dijit/dialog/PluginConfigurableAppsViewer":
"arcgisonline/sharing/dijit/dialog/PluginConfigurableApps":"arcgisonline/sharing/dijit/dialog/Plugin3DConfigurableAppsViewer";var h=[new K({messageLeft:G.browseItemsDlg.instructionsLeft,messageRight:G.browseItemsDlg.instructionsRight,item:this.item,"class":"esriBrowseItemsDlg"}),new O({message:G.itemProperties.createAppTitle,typeInfo:"configapp",showFolders:!0,showFile:!1,showUrl:!1,item:this.item})],l=d.hitch(this,function(a){k.publish("/esri/disable",a,G.addItemFrm.addingItem);p(".dojoxWizardButtons .dijitButton").map(E.byNode).forEach(function(b){b.set("disabled",
a)})}),v=d.hitch(this,function(a){return a._validate()}),u=k.subscribe("/esri/browseitems/close",d.hitch(this,function(a,b){if("create-app"===a)W.nextButton.onClick();else"on-view-item"===a?window.open("item.html?id\x3d"+b.id):"download-app"===a?S.downloadWebMappingApp(b):"preview-app"===a&&M(c,b)})),x=d.hitch(this,function(a){a._validate().then(d.hitch(this,function(a){l(!0);a=h[0].get("selection");var b=S.getHomeAppContext(),c=h[1].get("item");S.isPortal()&&a.url&&0===a.url.indexOf("/")&&a.url&&
-1===a.url.indexOf(b)&&(a.url=b+a.url);n=c;this.item&&!this.item.isHostedTemplate&&(n=d.mixin(n,{shareWithWebMap:!0},m?{webSceneId:this.item.id}:{webMapId:this.item.id}));J.createTemplatedApplication(c,a,f,this.item).then(d.hitch(this,function(a){e.hide().then(d.hitch(this,function(){window.location=a.configureUrl}))}),d.hitch(this,function(a){l(!1);this._showError(a)}))}),d.hitch(this,function(a){l(!1);this._showError(a)}))}),y=d.hitch(this,function(a){e.hide().then(d.hitch(this,function(){b.resolve(!1)}))}),
W=new z({nextButtonLabel:G.publishWizard.nextButtonLabel,previousButtonLabel:G.publishWizard.previousButtonLabel,doneButtonLabel:G.publishWizard.doneButtonLabel,cancelButtonLabel:G.publishWizard.cancelButtonLabel,"class":"esriCreateApp",hideDisabled:!0,doneFunction:x,cancelFunction:y}),B,T=h[1];h[0].addPlugin(a);B=q(e,"hide",d.hitch(this,function(a){B.remove();g.forEach(h,function(a){a.destroyRecursive();a=null});u.remove();W.destroyRecursive();e.destroyRecursive()}));g.forEach(h,function(a,b){(new F({content:a.domNode,
passFunction:d.partial(v,a),doneFunction:b===h.length-1?d.partial(x,a):null})).placeAt(W)});r.after(W,"_checkButtons",function(){W.selectedChildWidget.isFirstChild?W.nextButton.domNode.style.display="none":W.selectedChildWidget.isLastChild&&T.set("focus","title")});p(".dojoxWizardButtons",W.domNode).addClass("esriFloatTrailing");w.add(W.nextButton.domNode,["calcite","primary"]);w.add(W.cancelButton.domNode,["calcite","cancel"]);w.add(W.previousButton.domNode,["calcite","default btn-back icon-ui-left"]);
w.add(W.doneButton.domNode,["calcite","primary"]);this.item&&(T.set("summary",this.item.isHostedTemplate?"":this.item.snippet),T.set("title",this.item.isHostedTemplate?"":this.item.title),T.set("tags",this.item.isHostedTemplate?"":this.item.tags),L.self.hasCategorySchema&&T.set("categories",this.item.categories||[]));W.startup();t.create("span",{"class":"spinner hide",innerHTML:G.common.pleaseWait},p(".dojoxWizardButtons",W.domNode)[0],"first");e.setContent(W.domNode);e.show();return b},showCreateDefaultItem:function(a){var b=
new N({title:a.title||G.common.create,buttonOk:G.common.ok,buttonCancel:G.common.cancel,style:{width:"550px",height:"auto"}}),c=a.typeInfo,e=new O({typeInfo:c,item:a.item,message:a.message,showFolders:!0,showFile:!1,showUrl:a.showUrl}),f,g,k=null;"dashboard_map"===c&&a&&a.item&&(e.set("title",a.item.title),L.self.hasCategorySchema&&e.set("categories",a.item.categories||[]));b.setContent(e.domNode);b.show();f=q(b.okButton,"click",d.hitch(this,function(){a.isWAB?e._validate().then(d.hitch(this,function(a){k=
e.get("item");b.hide().then(d.hitch(this,function(){this.redirectToAppBuilder(k)}))}),d.hitch(this,function(a){this._showError(a)})):e.addItem().then(d.hitch(this,function(a){b.hide().then(d.hitch(this,function(){g.remove();f.remove();"webmap"===c?Q(a.id):"webscene"===c||"webscene_portal"===c?window.location="./webscene/viewer.html?webscene\x3d"+a.id:"dashboard"===c||"dashboard_map"===c?this.redirectToAppBuilder(a):window.location="ipynb"===c||"notebook"===c?"notebook.html?id\x3d"+a.id:"item.html?id\x3d"+
(a.serviceItemId||a.id)+(a.jobId?"\x26jobid\x3d"+a.jobId:"")}))}),d.hitch(this,function(a){this._showError(a)}))}));g=q.once(b.cancelButton,"click",d.hitch(this,function(){g.remove();f.remove()}))},redirectToAppBuilder:function(a){a.folderId&&"/"!==a.folderId&&(a.folder=a.folderId);var b={title:a.title,tags:a.tags,summary:a.snippet,folder:a.folder,appType:a.wabType},c="Dashboard"===a.type?"../apps/opsdashboard/index.html#/"+a.id+"?edit\x3dtrue":"../apps/webappbuilder/index.html?";L.self.hasCategorySchema&&
a.categories&&a.categories.length&&d.mixin(b,{categories:n.stringify(a.categories)});a.wabType&&(b=d.mixin(b,{appType:a.wabType,webmap:a.webmap}),c+=B.objectToQuery(b));window.location=c},_showError:function(a){a=d.mixin(d.mixin({},G.publishWizard.errors.error),a);this._errorDlg=new N({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(a).then(d.hitch(this,function(){this._errorDlg.hide()}));return!1}})})},"dojox/widget/Wizard":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/connect dijit/layout/StackContainer dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/i18n dojo/text!./Wizard/Wizard.html dojo/i18n!dijit/nls/common dojo/i18n!./nls/Wizard dijit/form/Button".split(" "),
function(c,l,h,a,e,f,d,b){return l("dojox.widget.Wizard",[a,e,f],{templateString:b,nextButtonLabel:"",previousButtonLabel:"",cancelButtonLabel:"",doneButtonLabel:"",cancelFunction:null,hideDisabled:!1,postMixInProperties:function(){this.inherited(arguments);var a=c.mixin({cancel:d.getLocalization("dijit","common",this.lang).buttonCancel},d.getLocalization("dojox.widget","Wizard",this.lang)),b;for(b in a)this[b+"ButtonLabel"]||(this[b+"ButtonLabel"]=a[b])},startup:function(){this._started||(this.inherited(arguments),
this.connect(this.nextButton,"onClick","_forward"),this.connect(this.previousButton,"onClick","back"),this.cancelFunction?(c.isString(this.cancelFunction)&&(this.cancelFunction=c.getObject(this.cancelFunction)),this.connect(this.cancelButton,"onClick",this.cancelFunction)):this.cancelButton.domNode.style.display="none",this.connect(this.doneButton,"onClick","done"),this._subscription=h.subscribe(this.id+"-selectChild",c.hitch(this,"_checkButtons")),this._started=!0)},resize:function(){this.inherited(arguments);
this._checkButtons()},_checkButtons:function(){var a=this.selectedChildWidget,b=a.isLastChild||this.nextButton.get("disabled");this.nextButton.set("disabled",b);this._setButtonClass(this.nextButton);a.doneFunction?(this.doneButton.domNode.style.display="",b&&(this.nextButton.domNode.style.display="none")):this.doneButton.domNode.style.display="none";this.previousButton.set("disabled",!this.selectedChildWidget.canGoBack);this._setButtonClass(this.previousButton)},_setButtonClass:function(a){a.domNode.style.display=
this.hideDisabled&&a.disabled?"none":""},_forward:function(){this.selectedChildWidget._checkPass()&&this.forward()},done:function(){this.selectedChildWidget.done()},destroy:function(){h.unsubscribe(this._subscription);this.inherited(arguments)}})})},"dojox/widget/WizardPane":function(){define(["dojo/_base/lang","dojo/_base/declare","dijit/layout/ContentPane"],function(c,l,h){return l("dojox.widget.WizardPane",h,{canGoBack:!0,passFunction:null,doneFunction:null,startup:function(){this.inherited(arguments);
this.isFirstChild&&(this.canGoBack=!1);c.isString(this.passFunction)&&(this.passFunction=c.getObject(this.passFunction));c.isString(this.doneFunction)&&this.doneFunction&&(this.doneFunction=c.getObject(this.doneFunction))},_onShow:function(){this.isFirstChild&&(this.canGoBack=!1);this.inherited(arguments)},_checkPass:function(){var a=!0;if(this.passFunction&&c.isFunction(this.passFunction)){var e=this.passFunction();switch(typeof e){case "boolean":a=e;break;case "string":alert(e),a=!1}}return a},
done:function(){this.doneFunction&&c.isFunction(this.doneFunction)&&this.doneFunction()}})})},"arcgisonline/map/utils/previewInTemplate":function(){define(["dojo/io-query","esri/lang","esri/request","arcgisonline/sharing/util"],function(c,l,h,a){return function(e,f){h({url:e.itemDataUrl,callbackParamName:"callback"}).promise.always(function(){var d=a.isPortal(),b=f.url,g=b.indexOf("?"),k=-1<g?b.substring(0,g):b,b=-1<g?c.queryToObject(b.substring(g+1)):{},g="Web Scene"===e.type?"webscene":"webmap";
if(d){var d=f.url,k=a.parseUrl(d),m="https:"===window.location.protocol;!1===/^(?:[a-z]+:)?\/\//i.test(d)&&(d=window.location.protocol+"//"+window.location.host+a.getHomeAppContext()+k.path);d=m?a.getSecureUrl(d):a.getHttpUrl(d)}else d=k;b[g]=e.id;window.open(d.replace("/hosted/","/apps/")+"?"+c.objectToQuery(b))})}})},"arcgisonline/map/utils/openMap":function(){define(["dojo/Deferred","dojo/io-query","dojo/_base/lang","./getMapCookie","arcgisonline/sharing/dijit/dialog/OpenMapDlg"],function(c,l,
h,a,e){return function(c,d,b){var f="./webmap/viewer.html?webmap\x3d"+c,k="signin.html?returnUrl\x3d"+encodeURIComponent(f);d="boolean"===typeof d?d:!1;a().then(h.hitch(this,function(a){a&&!0===a.c?e.prototype.statics.getInstance().show(d?k:f,a):document.location=d?k:f}))}})},"arcgisonline/sharing/dijit/dialog/Plugin3DConfigurableAppsViewer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/dom-class dojo/query ./_AppTemplateFiltersMixin ./PluginConfigurableAppsViewer dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g){var k=c("arcgisonline.sharing.dijit.dialog.Plugin3DConfigurableAppsViewer",[b],{constructor:function(a){this.inherited(arguments);this.filters=null},_fetchEsriConfigurableApps:function(){var b=(this._user&&this._user.culture||this._portal&&this._portal.culture||dojoConfig.locale||"en").split("-")[0].toLowerCase(),c={q:'title:"Web Application Templates" AND owner:"esri_'+({id:"ind"}[b]||b)+'"'};this.parent._currentFilter.persistentTypekeywords=['typekeywords:"3Dscene"'];
return a([this._fetchGroup("esriGallery_"+b,c)]).then(l.hitch(this,function(a){return a||[]}))},_fetchOrgConfigurableApps:function(){var b={q:this._portal.templatesGroupQuery||null};this.filters=null;this.rowsPerPage=8;this.extraClasses=["wide"];this.infoPanelTemplate=this.customGroupInfoPanelTemplate;this.parent._currentFilter.persistentTypekeywords=['typekeywords:"3Dscene"','-typekeywords:"Web AppBuilder"','typekeywords:"WAB3D"'];return a([this._fetchGroup("customGallery",b)]).then(l.hitch(this,
function(a){this.parent.sortDescending=a[0].sortOrder&&"desc"===a[0].sortOrder||!1;this.parent.sortAttribute=a[0].sortField||"asc";return a&&a.length?[a[0]]:[]}))}});l.mixin(k,{add:function(a,b){a.plugIn||(b=b||{},b.parent=a,a.plugIn=new k(b))},remove:function(a){a.plugIn&&(a.plugIn.destroy(),delete a.plugIn)}});return k})},"arcgisonline/sharing/dijit/dialog/AdvancedOfflineOptionsDlg":function(){define("dojo/_base/declare dojo/on dojo/dom-attr dojo/query dojo/dom dojo/dom-style dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/string dojo/_base/window dojo/promise/all dojo/when dojo/Deferred dojo/_base/array dojo/cookie dojo/dom-class dojo/json dijit/registry dijit/form/Select dijit/form/CheckBox ./ConfirmDialog dijit/focus dojo/_base/event dojo/keys ./_CreateItemUtilMixin dojo/topic esri/Evented esri/arcgis/Portal ../../geow/Account ../../geow/Content ../../util dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M){return c("arcgisonline.sharing.dijit.dialog.AdvancedOfflineOptionsDlg",[b,g,k,K],{baseClass:"esriAdvancedOfflineOptionsDlg",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"main"\x3e\x3ch2\x3e${i18n.advancedOfflineOptionsDlg.editableLayersTitle}\x3c/h2\x3e\x3cp class\x3d"" data-dojo-attach-point\x3d"_editMessage"\x3e${i18n.advancedOfflineOptionsDlg.editMessage}\x3c/p\x3e\x3cdiv class\x3d"edit"\x3e\x3clabel class\x3d"esriLeadingMargin1 trailer-0 editFeatures"\x3e\x3cinput class\x3d"" data-dojo-attach-point\x3d"editFeatures" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d\'checked:true\'/\x3e\x26nbsp;${i18n.advancedOfflineOptionsDlg.editFeatures}\x26nbsp;\x3c/label\x3e\x3cbr /\x3e\x3clabel class\x3d"esriLeadingMargin26 editAttachments padding-left-2"\x3e\x3cinput class\x3d"editAttachments" data-dojo-attach-point\x3d"editAttachments" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d\'checked:true, disabled:false\'/\x3e\x26nbsp;${i18n.advancedOfflineOptionsDlg.editAttachments}\x26nbsp;\x3c/label\x3e\x3c/div\x3e\x3ch2\x3e${i18n.advancedOfflineOptionsDlg.readOnlyLayersTitle}\x3c/h2\x3e\x3cp class\x3d"" data-dojo-attach-point\x3d"_readOnlyMessage"\x3e${i18n.advancedOfflineOptionsDlg.readOnlyMessage}\x3c/p\x3e\x3cdiv class\x3d"readonly"\x3e\x3clabel class\x3d"esriLeadingMargin1 "\x3e\x3cinput class\x3d"" data-dojo-attach-point\x3d"downloadAttachments" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d\'checked:true\'/\x3e\x26nbsp;${i18n.advancedOfflineOptionsDlg.editAttachments}\x26nbsp;\x3c/label\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
onDone:function(){},postMixInProperties:function(){this.inherited(arguments);this.i18n=d.mixin({},M);this._portalUser=(this._portal=esriGeowConfig.portal||esriGeowConfig.self)&&(this._portal.user||this._portal.getPortalUser())},postCreate:function(){this.inherited(arguments);J.getSelf(d.hitch(this,function(a){this._loadConnections();this.set("item",this.data)}))},destroy:function(){this._errorDlg&&(this._errorDlg.destroyRecursive(),this._errorDlg=null);this.inherited(arguments);this._portalUser=this._portal=
null},showModal:function(){var b=new v,c=new z({title:M.advancedOfflineOptionsDlg.title,buttonOk:M.common.ok,buttonCancel:M.common.cancel,style:{width:"475px",height:"auto"},className:"esriAdvancedOptions"}),e=a(".dijitDialogTitle",c.domNode).shift(),f,g=this._portal.helpMap.m["120000899"],g=m.create("a",{className:"esriHelpIcon",title:M.common.help,href:this._portal.helpBase+(g?g:""),target:"_blank"});m.place(g,e,"last");c.setContent(this.domNode);c.show().then(d.hitch(this,function(a){"onOk"===
a&&this._supportsAdvancedSyncOptions&&(this.set("disabled",!0,M.advancedOfflineOptionsDlg.pleaseWait),f=this.get("offlineProperties"),this._webMap=d.mixin(this._webMap,{applicationProperties:d.mixin(this._webMap.applicationProperties||{},f)}));c.hide().then(d.hitch(this,function(){b.resolve(this._webMap)}))}));return b},_loadConnections:function(){this.own(l(this.editFeatures,"click",d.hitch(this,function(){this.editFeatures.get("checked")?(a(".editAttachments").removeClass("disabled"),this.editAttachments.set("disabled",
!1)):(a(".editAttachments").addClass("disabled"),this.editAttachments.set("checked",!1),this.editAttachments.set("disabled",!0))})))},_setItemAttr:function(a){this._item=a.portal?a:new H.PortalItem(d.mixin({},a,{portal:this._portal}));a=this._item.itemData?d.clone(this._item.itemData):{};this._item.updatedOffline&&(a.applicationProperties||(a.applicationProperties={}),a.applicationProperties.offline=d.clone(this._item.updatedOffline));this.set("webmap",a)},_setWebmapAttr:function(b){this._webMap=
b||{};this._mapSupportsAdvancedSyncOptions(b).then(d.hitch(this,function(b){(this._supportsAdvancedSyncOptions=b)?this.set("offlineProperties",this._webMap.applicationProperties&&this._webMap.applicationProperties.offline||{}):(a(".dijitCheckBox",this.domNode).map(C.byNode).forEach(function(a){a.set("disabled",!0)}),a("label").addClass("disabled"))}))},_setOfflinePropertiesAttr:function(b){var c=b||{},d=c.editableLayers,e=c.readonlyLayers,c=!d||d.download&&("featuresAndAttachments"===d.download||
"features"===d.download),d=!d||d.sync&&"syncFeaturesAndAttachments"===d.sync,e=!e||e.downloadAttachments;this._offlineProperties=b||{};this.editFeatures.set("checked",c);this.editAttachments.set("disabled",!c);a(".editAttachments")[c?"removeClass":"addClass"]("disabled");this.editAttachments.set("checked",d);this.downloadAttachments.set("checked",e)},_getOfflinePropertiesAttr:function(){var a=this._offlineProperties||{},b=this.editFeatures.get("checked"),c=this.editAttachments.get("checked"),e=this.downloadAttachments.get("checked");
b||c?b&&c?a=d.mixin(a,{editableLayers:{download:"featuresAndAttachments",sync:"syncFeaturesAndAttachments"}}):b&&!c&&(a=d.mixin(a,{editableLayers:{download:"features",sync:"syncFeaturesUploadAttachments"}})):a=d.mixin(a,{editableLayers:{download:"none",sync:"uploadFeaturesAndAttachments"}});a=d.mixin(a,{readonlyLayers:{downloadAttachments:e}});return d.mixin({},{offline:a})},_setDisabledAttr:function(a,b){this.set("readOnly",a,b)},_setReadOnlyAttr:function(b,c,d){a(".dijit",this.domNode).map(C.byNode).forEach(function(a){a.set("disabled",
b)});a("a",this.domNode)[b?"addClass":"removeClass"]("disabledLink");a("label, p, span, h2, .hint",this.domNode)[b?"addClass":"removeClass"]("disabled");b&&c&&O.publish("/dlg/busyMessage",c);O.publish("/esri/disable",b,c)},_mapSupportsAdvancedSyncOptions:function(a){var b=new v,c=a.operationalLayers||[],d={},e=[];if(a&&a.applicationProperties&&a.applicationProperties.offline)b.resolve(!0);else{u.forEach(c,function(a){f=a.url&&a.url.replace(/(\/\d+)+$/g,"");d[f]=f});for(var f in d)d.hasOwnProperty(f)&&
d[f]&&e.push(R.request({url:d[f]},{addToken:!1}).then(function(a){return a&&a.syncCapabilities&&a.syncCapabilities.supportsAttachmentsSyncDirection},function(a){return!1}));n(e).then(function(a){b.resolve(u.every(a,"return item;"))})}return b},_showError:function(a){a=d.mixin(d.mixin({},M.publishWizard.errors.error),a);this._errorDlg=this._errorDlg||new z({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(a).then(d.hitch(this,function(){this.set("disabled",!1);this._errorDlg.hide()}));
return!1}})})},"arcgisonline/sharing/dijit/dialog/AttachCodeDlg":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/util,arcgisonline/sharing/dijit/dialog/GeneralDlg,dijit/form/Button,dijit/_Widget,dijit/_Templated"],function(c,l,h){c.provide("arcgisonline.sharing.dijit.dialog.AttachCodeDlg");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("dijit.form.Button");c.require("dijit._Widget");c.require("dijit._Templated");
c.declare("arcgisonline.sharing.dijit.dialog.AttachCodeDlg",[l._Widget,l._Templated],{util:arcgisonline.sharing.util,community:arcgisonline.sharing.geow.Community,content:arcgisonline.sharing.geow.Content,widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContainer"  dojoAttachPoint\x3d"containerNode"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" dojoAttachPoint\x3d"dialog" title\x3d"${titleLabel}" execute\x3d""\x3e\r\n    \x3ctable class\x3d"table-layout"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n\t\t\t      \x3cdiv id\x3d"code_upload_message" style\x3d"margin-bottom:10px;"\x3e\r\n\t\t\t        ${messageLabel}\r\n\t\t\t      \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n\t\t\t      \x3cform dojoAttachPoint\x3d"form" action\x3d"" enctype\x3d"multipart/form-data" method\x3d"post" onSubmit\x3d"return false;"\x3e\r\n\t\t\t        \x3cinput type\x3d"file" name\x3d"file" dojoAttachPoint\x3d"fileInput" size\x3d"50" /\x3e\r\n              \x3cinput type\x3d"hidden" name\x3d"title" value\x3d"" /\x3e\r\n\t\t\t        \x3cinput type\x3d"hidden" name\x3d"type" value\x3d"" /\x3e\r\n\t\t\t        \x3cinput type\x3d"hidden" name\x3d"typekeywords" value\x3d"" /\x3e\r\n\t\t\t        \x3cinput type\x3d"hidden" name\x3d"overwrite" value\x3d"false" /\x3e\r\n              \x3cinput type\x3d"hidden" name\x3d"relationshipType" value\x3d"" /\x3e\r\n              \x3cinput type\x3d"hidden" name\x3d"originItemId" value\x3d"" /\x3e\r\n              \x3cinput type\x3d"hidden" name\x3d"async" value\x3d"true" /\x3e\r\n\r\n\t\t\t        \x3c!-- this is complicated... need some way of automating this --\x3e\r\n\t\t\t        \x3c!--\x3cdiv id\x3d"add-item-callback" name\x3d"callback.html" dojotype\x3d"dijit.form.TextBox" type\x3d"hidden" value\x3d"textarea"\x3e\x3c/div\x3e --\x3e\r\n\t\t\t      \x3c/form\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"padding-top:2em;"\x3e\r\n  \t\t      \x3cbutton dojoAttachPoint\x3d"cancelButton" dojoType\x3d"dijit.form.Button" class\x3d"esriFloatTrailing cancel right" type\x3d"button" dojoAttachEvent\x3d"onClick:_cancelButtonClick"\x3e\r\n  \t\t        ${i18n.cancel}\r\n  \t        \x3c/button\x3e\r\n    \t\t    \x3cbutton dojoAttachPoint\x3d"uploadButton" dojoType\x3d"dijit.form.Button" class\x3d"esriFloatTrailing primary right"  type\x3d"button" dojoAttachEvent\x3d"onClick:_uploadButtonClick"\x3e\r\n    \t\t      ${i18n.uploadLabel}\r\n    \t\t    \x3c/button\x3e\r\n            \x3cspan id\x3d"code_upload-waiting" class\x3d"esriFloatTrailing" style\x3d"display:none;padding-top:8px;"\x3e\x3c/span\x3e\r\n\t\t        \x3cspan class\x3d"esriFloatLeading error" dojoAttachPoint\x3d"errorLabelNode" style\x3d"padding-top:8px;"\x3e\x3c/span\x3e\r\n\t        \x3c/td\x3e\r\n\t      \x3c/tr\x3e\r\n\t    \x3c/tbody\x3e\r\n\t  \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
dialog:null,fileInput:null,cancelButton:null,uploadButton:null,cancelButton:null,clearFormOnHide:!0,codeAttachment:null,titleLabel:"",messageLabelUpdate:"",messageLabel:"",messageErrorUpdate:"",errorLabelNode:null,type:"Code Attachment",typeKeywords:"Code",item:null,sharing:null,fileName:null,_lastUploaded:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n=c.i18n.getLocalization("arcgisonline","arcgisonline").common;c.mixin(this.i18n,c.i18n.getLocalization("arcgisonline",
"arcgisonline").attachCodeDlg);this.titleLabel=this.i18n.attachCode;this.messageLabelUpdate=this.i18n.messageLabelUpdateString;this.messageLabel=this.i18n.messageLabelString;this.messageErrorUpdate=this.i18n.messageErrorUpdateString},postCreate:function(){this.fileInput&&c.connect(this.fileInput,"onchange",this,function(){this.errorLabelNode.innerHTML=""})},statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.AttachCodeDlg);return this._instance}},
clear:function(){this.fileInput&&(this.fileInput.value="")},hide:function(){this.dialog&&(this.dialog.hide(),this.clearFormOnHide&&this.clear())},show:function(a){(this.codeAttachment=a)&&this.codeAttachment.name?(this.messageLabelUpdate=c.string.substitute(this.messageLabelUpdate,{fileName:this.codeAttachment.name}),c.byId("code_upload_message").innerHTML=this.messageLabelUpdate,this.dialog.set("title",this.i18n.updateCode)):(c.byId("code_upload_message").innerHTML=this.messageLabel,this.dialog.set("title",
this.i18n.attachCode));this.dialog&&this.dialog.show()},_cancelButtonClick:function(a){this.hide()},_uploadButtonClick:function(a){(a=this.fileInput.value)&&0<a.length&&this.util.endsWith(a,".zip")?(this.uploadButton.set("disabled",!0),this.cancelButton.set("disabled",!0),c.style(c.byId("code_upload-waiting"),"display","inline-block"),this.doUpload()):this.errorLabelNode.innerHTML=this.i18n.fileZipFormat},doUpload:function(){if(null==this.item||null===this.item.id)this.uploadButton.set("disabled",
!1),this.cancelButton.set("disabled",!1),c.style(c.byId("code_upload-waiting"),"display","none");else{var a=this.fileInput.value,e=a.lastIndexOf("\\");-1<e&&(a=a.substring(e+1,a.length));if(this.codeAttachment){var f=this.codeAttachment.name.lastIndexOf("."),e=a.lastIndexOf("."),f=[this.codeAttachment.name.substring(0,f),this.codeAttachment.name.substring(f).toLowerCase()],a=[a.substring(0,e),a.substring(e).toLowerCase()];f[0]!==a[0]||f[1]!==a[1]?(arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.updateCodeError,
message:c.string.substitute(this.messageErrorUpdate,{fileName:this.codeAttachment.name})}),this.uploadButton.set("disabled",!1),this.cancelButton.set("disabled",!1),c.style(c.byId("code_upload-waiting"),"display","none")):this._updateCodeItem()}else this._createCodeItem()}},_createCodeItem:function(){if(this.form){this.form.type.value=this.type;this.form.typekeywords.value=this.typeKeywords;this.form.relationshipType.value="WMA2Code";"Mobile Application"===this.item.type&&(this.form.relationshipType.value=
"MobileApp2Code");this.form.originItemId.value=this.item.id;var a=this.fileInput.value,e=a.lastIndexOf("\\");-1<e&&(a=a.substring(e+1,a.length));this.fileName=a;this.form.title.value=a;a=this.form.title.value.lastIndexOf("\\");-1<a&&(this.form.title.value=this.form.title.value.substring(a+1,this.form.title.value.length));a=this.form.title.value.lastIndexOf("/");-1<a&&(this.form.title.value=this.form.title.value.substring(a+1,this.form.title.value.length));this.content.addItem(null,this.form,c.hitch(this,
this._handle_addItem),c.hitch(this,this._handle_addItem))}},_updateCodeItem:function(){if(this.form){this.form.type.value=this.type;this.form.typekeywords.value=this.typeKeywords;this.form.overwrite.value="true";var a=this.fileInput.value,e=a.lastIndexOf("\\");-1<e&&(a=a.substring(e+1,a.length));this.fileName=a;this.form.title.value=a;this.content.updateItem(this.codeAttachment,this.form,c.hitch(this,this._handle_addItem),c.hitch(this,this._handle_addItem))}},_handle_addItem:function(a,e){var f=!1;
-1<e.url.indexOf("/status")&&(f=!0);!f&&a.success||f&&"completed"===a.status?(this._lastUploaded=c.clone(a),this._lastUploaded.title=this._lastUploaded.name=this.form.title.value,this.onUpload(this._lastUploaded)):(e=this.i18n.attachementFailedUpload,a&&a.error&&a.error.message?e=a.error.message:a&&a.statusMessage&&(e=a.statusMessage),a=this.i18n.cannotAddAttachment,-1<e.indexOf("already exists")?(e=this.i18n.sameZipFileName,a=this.i18n.duplicateFileName):-1<e.indexOf("The request size is greater than the max allowed of 1024MB")&&
(e=this.i18n.fileSizeExceeds),this.hide(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:a,message:e}));this.uploadButton.set("disabled",!1);this.cancelButton.set("disabled",!1);c.style(c.byId("code_upload-waiting"),"display","none")},_handle_updateItem:function(a,e){a.success?(this.uploadButton.set("disabled",!1),this.cancelButton.set("disabled",!1),c.style(c.byId("code_upload-waiting"),"display","none"),this.hide()):(e=this.i18n.attachementFailedUpload,
a&&a.error&&a.error.message&&(e=a.error.message),a=this.i18n.cannotAddAttachment,-1<e.indexOf("already exists")?(e=this.i18n.sameZipFileName,a=this.i18n.duplicateFileName):-1<e.indexOf("The request size is greater than the max allowed of 1024MB")&&(e=this.i18n.fileSizeExceeds),this.hide(),arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:a,message:e}),this.uploadButton.set("disabled",!1),this.cancelButton.set("disabled",!1),c.style(c.byId("code_upload-waiting"),
"display","none"))},onUpload:function(a){}})})},"arcgisonline/sharing/dijit/dialog/thumbnailDialogs/ItemThumbnailDlg":function(){define(["require","../ThumbnailDlg","./_saveFormData"],function(c,l,h){return function(a){var c=new l(a);(function(){this.suggestedSize=this.i18n.GroupWidget.thumbnailDlg.sizeSpecItem;this.aspectRatio=1.5;this.height=233;this.thumbnailSpecificationMsg=c.i18n.itemProperties.thumbnailSpecification;this._handleImageData=h.bind(this);this._handleImageUpload=function(){this.portalUser.getItem(this.item.id).then(function(a){a.thumbnailUrl&&
-1!==a.thumbnailUrl.indexOf("?token\x3d")?this.item.set("thumbnailUrl",a.thumbnailUrl+"\x26ts\x3d"+(new Date).getTime()):this.item.set("thumbnailUrl",a.thumbnailUrl+"?ts\x3d"+(new Date).getTime()||this.item.thumbnailUrl);this.set("readOnly",!1);document.body.style.cursor="default";this._dlg.hide()}.bind(this),function(a){document.body.style.cursor="default";this._showError(a)}.bind(this))};this._getUrl=function(){var a=this.item,c=this.portalUser,b=this.item.itemOwner;return"https://"+((b?b.userContentUrl:
c.userContentUrl)+(a.folderId&&"/"!==a.folderId?"/"+a.folderId:"")+"/items/"+a.id+"/update").split("://")[1]}}).call(c);return c}})},"arcgisonline/sharing/dijit/dialog/ThumbnailDlg":function(){function c(c){var h=atob(c.split(",")[1]);c=c.split(",")[0].split(":")[1].split(";")[0];for(var a=new ArrayBuffer(h.length),e=new Uint8Array(a),f=0;f<h.length;f++)e[f]=h.charCodeAt(f);return new Blob([a],{type:c})}define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog ./_CreateItemUtilMixin ../../../pages/pageUtil ../../../esriGeowConfig dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin arcgisonline/sharing/util dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/ThumbnailDlg.html".split(" "),
function(l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L){return h([N,O,K,a],{baseClass:"esriThumbnailDlg",templateString:L,imgFile:null,imgScale:1,imgDragging:!1,imgTop:0,imgLeft:0,prevTop:null,prevLeft:null,imageExtent:{left:0,right:1,top:0,bottom:1},transformOrigin:[50,50],height:233,aspectRatio:1,imageHasBeenManipulated:!1,imageFormat:"png",postMixInProperties:function(){this.inherited(arguments);this.item&&this.item.portal&&g.mixin(this,{portal:this.item.portal,portalUser:this.item.portal.getPortalUser()});
this.i18n=g.mixin({},J)},startup:function(){this.inherited(arguments);return this._initUI()},showModal:function(){var a=new x,b=new z({title:this.i18n.itemProperties.uploadThumbnail,buttonOk:this.i18n.common.ok,buttonCancel:this.i18n.common.cancel,busyMessage:this.i18n.addItemFrm.pleaseWait,style:{width:"475px",height:"auto"}});this._dlg=b;b.setContent(this.domNode);b.show();b.actionBarNode.setAttribute("style","padding: 6px !important;");t.add(this._dlg.okButton.domNode,"dlg-element-hide");this._difImageLink=
document.createElement("button");this._difImageLink.textContent=J.GroupWidget.thumbnailDlg.difImage;this._difImageLink.className="btn-link inline-block font-size--2 "+(E.isRightToLeft?"icon-ui-right":"icon-ui-left")+" leader-quarter dlg-element-hide";b.actionBarNode.appendChild(this._difImageLink);this.own(r(this._difImageLink,"click",this._hideImageScale.bind(this)),r(b,"ok",function(){this._getCanvasImage().then(this._handleImageData.bind(this),this._showError.bind(this))}.bind(this)),r(b,"hide",
function(){a.resolve(this.item)}));return a},_initUI:function(){var a=new x;this._setSuggestedSize();this._initHandlers();a.resolve(!1);return a},_setSuggestedSize:function(){this.suggestedSize&&(this._sizeSuggestion.textContent=this.suggestedSize)},_initHandlers:function(){this.own(r(this._fileInput,"change",this._handleFileInputChange.bind(this)),r(this._dragDropNode,"dragover",this._handleImageDragOver.bind(this)),r(this._dragDropNode,"drop",this._handleImageDrop.bind(this)),r(this._zoomSlider,
"input",this._handleZoomSliderChange.bind(this)),r(this._zoomSlider,"change",this._handleZoomSliderChange.bind(this)),r(this._thumbTranslucentContainer,"mousedown",this._handleImageMouseDown.bind(this)),r(this._thumbTranslucentContainer,"touchstart",this._handleImageMouseDown.bind(this)),r(this._thumbTranslucentContainer,"mouseup",this._handleImageMouseUp.bind(this)),r(this._thumbTranslucentContainer,"touchend",this._handleImageMouseUp.bind(this)),r(this._thumbTranslucentContainer,"mouseout",this._handleImageMouseOut.bind(this)),
r(this._thumbTranslucentContainer,"mousemove",this._handleImageMouseMove.bind(this)),r(this._thumbTranslucentContainer,"touchmove",this._handleImageMouseMove.bind(this)),r(this._cropNode,"wheel",this._handleImageWheel.bind(this)),r(this._previewImage,"load",this._handleInputImageSize.bind(this)))},_handleFileInputChange:function(a){this._validate(this._fileInput.files[0])},_handleImageDragOver:function(a){a.preventDefault()},_handleImageDrop:function(a){a.preventDefault();a.dataTransfer.files[0]&&
this._validate(a.dataTransfer.files[0])},_handleZoomSliderChange:function(a){this.imgScale=Math.pow(1.1,a.target.value-50);this._updatePreviewImage()},_handleImageMouseDown:function(a){a.preventDefault();this.imgDragging=!0},_handleImageMouseUp:function(a){this.imgDragging=!1;this.prevLeft=this.prevTop=null},_handleImageMouseOut:function(a){this.imgDragging=!1;this.prevLeft=this.prevTop=null},_handleImageMouseMove:function(a){if(this.imgDragging)if(this.prevTop&&this.prevLeft){var b=a.clientY-this.prevTop,
c=a.clientX-this.prevLeft;this.imgTop+=a.clientY-this.prevTop;this.imgLeft+=a.clientX-this.prevLeft;this._updatePreviewImage();this.prevTop+=b;this.prevLeft+=c}else this.prevTop=a.clientY,this.prevLeft=a.clientX},_handleImageWheel:function(a){this.imgScale=0<a.deltaY?1*this.imgScale/1.1:1.1*this.imgScale;this._updatePreviewImage();this._zoomSlider.value=50+Math.log(this.imgScale)/Math.log(1.1);this._getImageExtent();a.preventDefault()},_handleInputImageSize:function(){var a=this._previewImage.naturalWidth/
this._previewImage.naturalHeight,b=this.aspectRatio*this.height,c=this.height;a<this.aspectRatio?(this._previewImage.style.width=b+"px",this._previewImage.style.height=b/a+"px",this._previewImage.width=b,this._previewImage.height=b/a,this.imgTop=-(this._previewImage.height-c)/2,this._previewImage.style.top=this.imgTop+"px",this.imgLeft=0,this._previewImage.style.left="0px"):(this._previewImage.style.height=c+"px",this._previewImage.style.width=c*a+"px",this._previewImage.height=c,this._previewImage.width=
c*a,this.imgLeft=-(this._previewImage.width-b)/2,this._previewImage.style.left=this.imgLeft+"px",this.imgTop=0,this._previewImage.style.top="0px")},_validate:function(a){var b=a&&a.name;if(b)if(/\.(gif|jpg|jpeg|png)$/i.test(b))b=new FileReader,b.onload=function(a){this.imgFile=a.target.result;this._previewImage.setAttribute("src",this.imgFile)}.bind(this),b.readAsDataURL(a),this._displayImageScale();else return w.set(this._fileInput,"value","",!1),this._showError({title:this.i18n.itemProperties.error.error,
message:this.i18n.itemProperties.error.badImageType})},_setReadOnlyAttr:function(a){p.publish("/esri/disable",a);w.set(this._fileInput,"readOnly",a)},_showError:function(a){a=g.mixin(g.mixin({},J.publishWizard.errors.error),a);this._errorDlg=new z({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(a).then(g.hitch(this,function(){this.set("readOnly",!1);this._errorDlg.hide()}));return!1},_displayImageScale:function(){A.hideNode(this._dragDropNode);A.showNode(this._cropNode);t.remove(this._difImageLink,
"dlg-element-hide");t.remove(this._dlg.okButton.domNode,"dlg-element-hide");t.add(this._difImageLink,"dlg-element-show");t.add(this._dlg.okButton.domNode,"dlg-element-show");this._thumbTransparentContainer.style.height=this.height+"px";this._thumbTransparentContainer.style.width=this.height*this.aspectRatio+"px";this._thumbTranslucentContainer.style.height=this.height+60+"px";this._thumbTranslucentContainer.style.width=this.height*this.aspectRatio+60+"px";this._cropThumbContainer.style.height=this.height+
60+"px";this.imageHasBeenManipulated=!1;this.imageFormat="png"},_hideImageScale:function(){this._fileInput.value=null;A.showNode(this._dragDropNode);A.hideNode(this._cropNode);t.remove(this._difImageLink,"dlg-element-show");t.remove(this._dlg.okButton.domNode,"dlg-element-show");t.add(this._difImageLink,"dlg-element-hide");t.add(this._dlg.okButton.domNode,"dlg-element-hide")},_updatePreviewImage:function(){this._previewImage.setAttribute("style","transform: scale("+this.imgScale+"); top: "+this.imgTop+
"px; left: "+this.imgLeft+"px; transform-origin: "+this.transformOrigin[0]+"% "+this.transformOrigin[1]+"%;");this.imageHasBeenManipulated=!0},_getImageExtent:function(){var a=this._previewImage.getBoundingClientRect(),b=this._thumbTransparentContainer.getBoundingClientRect();return{left:(b.left-a.left)/a.width,top:(b.top-a.top)/a.height,right:(b.right-a.left)/a.width,bottom:(b.bottom-a.top)/a.height}},_getDrawDimensions:function(){var a=this._previewImage.getBoundingClientRect(),b=this._thumbTransparentContainer.getBoundingClientRect();
return{left:(0<a.left-b.left?a.left-b.left:0)/b.width,top:(0<a.top-b.top?a.top-b.top:0)/b.height,width:((a.right>b.right?b.right:a.right)-(a.left<b.left?b.left:a.left))/b.width,height:((a.bottom>b.bottom?b.bottom:a.bottom)-(a.top<b.top?b.top:a.top))/b.height}},_getCanvasImage:function(){var a=new x,b=new Image;b.onload=function(){this._properAspectRatio(b)&&this._withinSizeLimits(b)&&!this.imageHasBeenManipulated?(this.imageFormat=this.imgFile.split(";")[0].split("/")[1],a.resolve(this._getRawImageData())):
a.resolve(this._getScaledImageData(b))}.bind(this);b.src=this.imgFile;return a},_getRawImageData:function(){return{blob:c(this.imgFile),base64:this.imgFile,format:this.imageFormat}},_getScaledImageData:function(a){function b(b){var p=g.left*a.width,D=g.top*a.height,q=g.right*a.width-g.left*a.width,r=g.bottom*a.height-g.top*a.height,l=f.right*a.width-f.left*a.width,t=f.bottom*a.height-f.top*a.height;this._canvasNode.width=l<d?d:l*b;this._canvasNode.height=t<e?e:t*b;b=k.left*this._canvasNode.width;
var l=k.top*this._canvasNode.height,t=k.width*this._canvasNode.width,v=k.height*this._canvasNode.height;m.fillStyle="#efefef";m.fillRect(0,0,this._canvasNode.width,this._canvasNode.height);m.drawImage(a,p,D,q,r,b,l,t,v);n=this._canvasNode.toDataURL("image/png");h=c(n)}var d=this.height*this.aspectRatio,e=this.height,f=this._getImageExtent(),g={left:0>f.left?0:f.left,top:0>f.top?0:f.top,right:1<f.right?1:f.right,bottom:1<f.bottom?1:f.bottom},k=this._getDrawDimensions(),m=this._canvasNode.getContext("2d"),
n,h;try{if(b.bind(this)(1),1E7<h.size||0===h.size)m.clearRect(0,0,this._canvasNode.width,this._canvasNode.height),b.bind(this)(1600/a.width)}catch(ca){"NS_ERROR_FAILURE"===ca.name?(m.clearRect(0,0,this._canvasNode.width,this._canvasNode.height),b.bind(this)(1600/a.width)):this._showError(ca)}return{blob:h,base64:n,format:this.imageFormat}},_handleImageData:function(a){},_properAspectRatio:function(a){return.01>Math.abs(1-this.aspectRatio/(a.width/a.height))?!0:!1},_withinSizeLimits:function(a){return 1600>
a.width&&133<=a.height?!0:!1}})})},"arcgisonline/sharing/dijit/dialog/thumbnailDialogs/_saveFormData":function(){define(["require","dojo/topic","esri/request"],function(c,l,h){return function(a){var c=new FormData,f="thumbnail"+(new Date).getTime()+"."+a.format;c.append("thumbnail",a.blob,f);c.append("f","json");this.publishThumbnail&&l.publish("thumbnail/change",a);h({url:this._getUrl(),form:c},{usePost:!0}).then(function(a){this._handleImageUpload(a,f)}.bind(this),function(a){this._showError(a)}.bind(this));
document.body.style.cursor="wait";this._dlg.okButton.setAttribute("disabled",!0)}})},"arcgisonline/sharing/dijit/dialog/ManageSceneCache":function(){define("require esri/declare esri/Evented esri/lang esri/request dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/topic dijit/a11yclick dojo/number dojo/string dojo/promise/all dojo/json dojo/dom dojo/dom-attr dojo/dom-construct dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/Dialog dojo/store/Memory dojo/store/Observable ../../../sharing/dijit/dialog/ConfirmDialog ../../../sharing/dijit/dialog/GeneralDlg ../../../pages/pageUtil ../../../pages/serviceUtil ../../../pages/statusUtil ../../../sharing/util ../../../esriGeowConfig dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/ManageSceneCache.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L){return l([y,C],{declaredClass:"arcgisonline.sharing.dijit.dialog.ManageSceneCache",basePath:c.toUrl("arcgisonline/sharing/dijit/dialog"),baseClass:"esriManageSceneCache",templateString:L,widgetsInTemplate:!0,_serviceStartWait:5E3,postMixInProperties:function(){this.inherited(arguments);this.i18n=f.mixin({},J.common);f.mixin(this.i18n,J.manageSceneCache);f.mixin(this.i18n,{webScene:J.items.webScene,buildingCache:J.itemProperties.buildingCache})},
postCreate:function(){this.inherited(arguments);this._initHandlers()},startup:function(){this.inherited(arguments);var a=K.isPortal();!a&&this._hasSource()?this._rebuildFullRadioClick():(a&&(E.hideNode(this._optionsContainer),E.checkNode(this._rebuildLayersRadio,!0)),E.disableNode(this._rebuildFullRadio),this._rebuildLayersRadioClick())},_initHandlers:function(){this.own(m(this._rebuildFullRadio,this._rebuildFullRadioClick.bind(this)),m(this._rebuildLayersRadio,this._rebuildLayersRadioClick.bind(this)),
m(this._rebuildBtn,this._rebuildClick.bind(this)),m(this._cancelBtn,this._cancelClick.bind(this)))},_hasSource:function(){return a.isDefined(this._item.sourceData)},_dialogHidden:function(){this._dialog&&this._dialog.destroyRecursive();this.destroyRecursive()},_fetchSourceItemAdminServiceInfo:function(){return K.request({url:this._featureServiceAdminUrl})},_rebuildFullRadioClick:function(){E.hideNode(this._sceneLayerSelectContainer);E.disableNode(this._rebuildBtn,!1)},_rebuildLayersRadioClick:function(){E.showNode(this._sceneLayerSelectContainer);
this._checkBoxClick()},_displayCreditCost:function(a,b,c){var d=K.isPortal(),e=H.self&&H.self.subscriptionInfo||{},f=(H.self&&H.self.user||{}).availableCredits||e.availableCredits||0;n({adminServiceInfo:this._fetchSourceItemAdminServiceInfo()}).then(function(e){d?b():(this._sourceItem.set("adminServiceInfo",e.adminServiceInfo),N.fetchScenePublishingCredits(this._sourceItem,a).then(function(a){var d=this._fullRebuildInProgress?this.i18n.confirmFullProceed:this.i18n.confirmProceed;confirmMsg="\x3cp\x3e"+
[this._fullRebuildInProgress?this.i18n.confirmFullDesc:this.i18n.confirmDesc,q.substitute(this._fullRebuildInProgress?this.i18n.confirmFullCredits:this.i18n.confirmCredits,{credits:p.format(a),availableCredits:p.format(f)}),d].join("\x3c/p\x3e\x3cp\x3e")+"\x3c/p\x3e";confirmDlg=new F({buttonOkLabel:this.i18n.ok,buttonCancelLabel:this.i18n.cancel,"class":"confirmDlg-default"});f<a&&confirmDlg.okButton.set("disabled",!0);confirmDlg.show({title:this.i18n.confirmTitle,message:confirmMsg}).then(function(a){"onOk"===
a?b():c();confirmDlg.hide()}.bind(this))}.bind(this)))}.bind(this))},_rebuildClick:function(){E.isChecked(this._rebuildFullRadio)&&this._hasSource()?this._rebuildFullCache():this._rebuildLayers()},_rebuildFullCache:function(){K.isPortal();var a=this._item.owner,b=this._item.folderId,c=H.restBaseUrl+"content/users/"+a+"/"+(b&&b!==a?b+"/":"")+"publish";publishRequest={buildInitialCache:!1,itemid:this._item.sourceData.id,filetype:"featureService",publishParameters:r.stringify({name:this._item.name?this._item.name:
this._item.title.replace(/ /g,"_"),targetSR:this._item.serviceInfo.layers[0].spatialReference}),outputType:"sceneService",overwrite:!0};selectedLayers=[];rebuildFullFailure=function(a){E.createSpecifiedDialog(A).show({title:this.i18n.errorTitle,message:this.i18n.rebuildFullError});E.deactivateNode(this._caching);E.disableNode(this._rebuildBtn,!1);E.showNodes([this._optionsContainer,this._buttonBar])}.bind(this);this._fullRebuildInProgress=!0;E.disableNode(this._rebuildBtn,!0);d.map(g(".layer-checkbox",
this.domNode),function(a){E.checkNode(a,!0);selectedLayers.push({id:parseInt(a.getAttribute("data-layer-id"),10)})});this._displayCreditCost(selectedLayers,function(){E.hideNodes([this._optionsContainer,this._buttonBar]);E.activateNode(this._caching);K.request({url:c,content:publishRequest},{usePost:!0}).then(function(b){b&&b.services&&0<b.services.length?(b=b.services.shift(),O.checkAsyncJobStatus(H.restBaseUrl+"content/users/"+a+"/items/"+b.serviceItemId+"/status?jobId\x3d"+b.jobId,500).then(function(a){setTimeout(function(){this._rebuildLayers();
k.publish("manage-scene-cache/republish",a)}.bind(this),this._serviceStartWait)}.bind(this),rebuildFullFailure)):rebuildFullFailure(b)}.bind(this),rebuildFullFailure)}.bind(this),function(){this._fullRebuildInProgress=!1;E.disableNode(this._rebuildBtn,!1)}.bind(this))},_rebuildLayers:function(){var a=H.self&&H.self.subscriptionInfo||{},b=(H.self&&H.self.user||{}).availableCredits||a.availableCredits||0,c=[],e=K.isPortal(),f,m,h;d.map(g(".layer-checkbox",this.domNode),function(a){E.isChecked(a)&&c.push({id:parseInt(a.getAttribute("data-layer-id"),
10)})});0<c.length&&this._adminUrl&&(E.disableNode(this._rebuildBtn,!0),n({adminServiceInfo:this._fetchSourceItemAdminServiceInfo()}).then(function(a){e?this._submitPortalSceneCacheJob(c).then(function(a){var b=N.adjustHostedServerForProtocol(this._hostedServer.url)+"/rest/services/System/SceneCachingControllers/GPServer/Manage%20Scene%20Cache/jobs/"+a.jobId;a.jobUrl=b;k.publish("manage-scene-cache/rebuild",a);E.disableNode(this._rebuildBtn,!1);this.hide()}.bind(this),function(a){E.disableNode(this._rebuildBtn,
!1);E.createSpecifiedDialog(A).show({title:this.i18n.errorTitle,message:this.i18n.rebuildError})}.bind(this),function(a){E.disableNode(this._rebuildBtn,!1);E.createSpecifiedDialog(A).show({title:this.i18n.errorTitle,message:this.i18n.rebuildError})}.bind(this)):(this._sourceItem.set("adminServiceInfo",a.adminServiceInfo),this._fullRebuildInProgress?K.request({url:this._adminUrl+"/rebuildCache",content:{layers:c.map(function(a){return a.id},this).join(",")}},{usePost:!0}).then(function(a){k.publish("manage-scene-cache/rebuild",
a);E.disableNode(this._rebuildBtn,!1);this.hide()}.bind(this),function(a){E.disableNode(this._rebuildBtn,!1);E.deactivateNode(this._caching);E.showNodes([this._optionsContainer,this._buttonBar]);E.createSpecifiedDialog(A).show({title:this.i18n.errorTitle,message:this.i18n.rebuildError})}.bind(this)):N.fetchScenePublishingCredits(this._sourceItem,c).then(function(a){h=[this.i18n.confirmDesc,q.substitute(this.i18n.confirmCredits,{credits:p.format(a),availableCredits:p.format(b)}),this.i18n.confirmProceed];
m="\x3cp\x3e"+h.join("\x3c/p\x3e\x3cp\x3e")+"\x3c/p\x3e";f=new F({buttonOkLabel:this.i18n.ok,buttonCancelLabel:this.i18n.cancel,"class":"confirmDlg-default"});b<a&&f.okButton.set("disabled",!0);f.show({title:this.i18n.confirmTitle,message:m}).then(function(a){"onOk"===a?K.request({url:this._adminUrl+"/rebuildCache",content:{layers:c.map(function(a){return a.id},this).join(",")}},{usePost:!0}).then(function(a){k.publish("manage-scene-cache/rebuild",a);E.disableNode(this._rebuildBtn,!1);this.hide()}.bind(this),
function(a){E.disableNode(this._rebuildBtn,!1);E.createSpecifiedDialog(A).show({title:this.i18n.errorTitle,message:this.i18n.rebuildError})}.bind(this)):E.disableNode(this._rebuildBtn,!1);f.hide()}.bind(this))}.bind(this)))}.bind(this)))},_cancelClick:function(){this._dialog.hide()},_checkBoxClick:function(){var a=d.some(g(".layer-checkbox",this.domNode),function(a){return E.isChecked(a)});E.disableNode(this._rebuildBtn,!a)},_createLayerListDisplay:function(a,b){b=w.create("div",{display:"table"},
b);a&&0<a.length&&d.forEach(a,this._createLayerDisplay.bind(this,b))},_createLayerDisplay:function(a,b){var c=w.create("div",{display:"table-row"},a);a=w.create("div",{display:"table-cell"},w.create("div",{display:"table-column"},c));c=w.create("div",{display:"table-cell"},w.create("div",{display:"table-column"},c));a=w.create("input",{id:q.substitute("layer-${id}-checkbox",{id:b.id}),"for":q.substitute("layer-${id}-label",{id:b.id}),"class":"layer-checkbox",type:"checkbox","data-layer-id":b.id},
a);w.create("span",{innerHTML:b.name},c);this.own(m(a,this._checkBoxClick.bind(this)))},_submitPortalSceneCacheJob:function(a){var b=1<a.length?a.map(function(a){return{id:a.id}}):{};a=N.adjustHostedServerForProtocol(this._hostedServer.url)+"/rest/services/System/SceneCachingControllers/GPServer/Manage%20Scene%20Cache/submitJob";b={service_url:this._item.url,num_of_caching_service_instances:2,layer:r.stringify(b),update_mode:"RECREATE_ALL_NODES",update_extent:"DEFAULT",area_of_interest:r.stringify({displayFieldName:"",
geometryType:"esriGeometryPolygon",spatialReference:{wkid:54051,latestWkid:54051},fields:[{name:"OID",type:"esriFieldTypeOID",alias:"OID"},{name:"updateGeom_Length",type:"esriFieldTypeDouble",alias:"updateGeom_Length"},{name:"updateGeom_Area",type:"esriFieldTypeDouble",alias:"updateGeom_Area"}],features:[],exceededTransferLimit:!1}),f:"json",token:this._item.serverToken};return e({url:a,content:b},{usePost:!0})},show:function(a,c,d){var e=K.isPortal();this._sourceItem=a;this._item=c;this._featureServiceUrl=
a.url;this._featureServiceAdminUrl=e?c.url:a.url.replace("/rest/","/rest/admin/");this._adminUrl=c.adminUrl;this._adminServiceInfo=(e?c.serviceInfo:c.adminServiceInfo)||{};this._hostedServer=d;this._dialog=new x({title:this.i18n.title,"class":this.baseClass});this._createLayerListDisplay(this._adminServiceInfo.layers,this._sceneLayerContainer);this._dialog.setContent(this.domNode);this.own(b(this._dialog,"hide",function(){this._dialogHidden()}.bind(this)));this._dialog.show()},hide:function(){this._dialog.hide()}})})},
"arcgisonline/pages/statusUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/on dojo/json dojo/promise/all esri/lang esri/urlUtils ./pageUtil esri/arcgis/Portal esri/tasks/Geoprocessor ../sharing/dijit/dialog/_CreateItemUtilMixin ../sharing/util".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r){return{checkStatus:function(b){var c=new a,d=this._getJobUrl(b),e=this._getJobId(b);!m.includesSome(b.typeKeywords,["Elevation 3D Layer"])&&b.canUpdate&&
b.isHostedService&&("Feature Service"===b.type||"Image Service"===b.type||"Scene Service"===b.type||"Vector Tile Service"===b.type||r.isPortal()&&"Map Service"===b.type)?(b.set("status","processing"),d&&e?this._checkJobStatus(b,500,c):e?this._checkItemStatus(b,500,c):r.isPortal()?b.set("status","completed"):this._checkServiceStatus(b,500,c)):b.set("status","completed");c.resolve(b);return c},_getJobId:function(a){var b=k.urlToObject(document.URL),c=a.properties||{};a.jobId=a.jobId||c.jobId||b&&b.query&&
b.query.jobid||null;return a.jobId},_getJobUrl:function(a){var b=(a.properties&&a.properties.jobUrl||"").split("/jobs/");a.jobUrl=b.shift();a.jobId=a.jobUrl?b.shift():null;return a.jobUrl},_checkItemStatus:function(a,b,c){r.request({url:a.userItemUrl+"/status",content:{jobId:a.jobId}}).then(l.hitch(this,function(d){d=d||{status:"failed"};"completed"===d.status?a.set("status","completed"):"failed"===d.status||400<d.code||""===d.status?(a.set("statusError",this.getStatusError(d)),a.set("status","failed")):
(a.set("status","processing"),b=(b||500)+250,setTimeout(l.hitch(this,function(){this._checkItemStatus(a,b,c)}),b))}),function(b){a.set("statusError",this.getStatusError(b));a.set("status","failed")})},_checkServiceStatus:function(a,b,c){var d=a.adminUrl+"/status",e={};if("Scene Service"===a.type||"Vector Tile Service"===a.type)d=a.adminUrl;a.adminServerToken&&(e.token=a.adminServerToken);r.request({url:d,content:e}).then(l.hitch(this,function(d){d=d||{};d.status=d.realTimeState&&d.realTimeState.toLowerCase()||
d.status&&d.status.toLowerCase()||(d.currentVersion&&d.capabilities?"started":"failed");if("Scene Service"===a.type||"Vector Tile Service"===a.type)d.status=d.cacheExecutionStatus&&"PROCESSING"===d.cacheExecutionStatus||"SUBMITTED"===d.cacheExecutionStatus?"processing":"started";"started"===d.status?a.set("status","completed"):"failed"===d.status||400<d.code||""===d.status?(a.set("statusError",this.getStatusError(d)),a.set("status","failed")):(a.set("status","processing"),b=(b||500)+250,setTimeout(l.hitch(this,
function(){this._checkServiceStatus(a,b,c)}),b))}),l.hitch(this,function(b){a.set("statusError",this.getStatusError(b));a.set("status","failed")}))},_checkJobStatus:function(a,b,c){c=(a.portal.getPortalUser()||{}).token;var d=a.jobId,e=a.jobUrl,g=a.properties,k,m;g&&"processing"===g.jobStatus?(a.set("status","processing"),k=new q(e+(c?"?token\x3d"+c:"")),f(k,"status-update",l.hitch(this,function(b){"esriJobExecuting"!==b.jobInfo.jobStatus?(a.set("status","completed"),m&&clearInterval(m)):a.set("status",
"processing")})),f(k,"error",l.hitch(this,function(b){(b=b.error||b)&&b.message&&b.message.indexOf("not found.")?(a.set("status","completed"),g&&(g.jobId&&delete g.jobId,g.jobUrl&&delete g.jobUrl,g.jobStatus&&delete g.jobStatus,g.jobType&&delete g.jobType,a.set("properties",g))):(a.set("statusError",this.getStatusError(b)),a.set("status","failed"));m&&clearInterval(m)})),m=setInterval(function(){k.checkJobStatus(d)},b||3E3)):a.set("status","completed")},_checkSceneCachingJobStatus:function(a,b,c){var d=
r.isPortal(),e=a.cachingJobUrl||a.properties&&a.properties.cacheJobUrl,f=d?e:a.adminUrl+"/"+e,g=d?["esriJobSucceeded","esriJobFailed"]:["Completed","Failed"],k=d?"jobStatus":"status",n=d?"esriJobFailed":"Failed",h;e?h=setInterval(l.hitch(this,function(){r.request({url:f}).then(l.hitch(this,function(b){m.includes(g,b[k])?(b[k]===n&&(a.set("status","failed"),c.reject(b)),clearInterval(h),a.set("cachingJobUrl",void 0),a.set("status","completed"),c&&c.resolve(b)):a.set("status","processing")}),l.hitch(this,
function(b){b&&b.message&&b.message.indexOf("not found.")?(a.set("cachingJobUrl",void 0),a.set("status","completed"),c&&c.resolve()):(a.set("statusError",this.getStatusError(b)),a.set("status","failed"),c.reject(b))}))}),b||3E3):(a.set("cachingJobUrl",void 0),a.set("status","completed"),c&&c.resolve({}))},getStatusError:function(a){var b=a&&a.statusMessage;return b?m.isJson(b)?d.parse(b):b:a},checkAsyncJobStatus:function(b,c){var d=new a,e,f;f=setInterval(function(){r.request({url:b}).then(function(a){a=
a||{status:"Failed"};e=a.status||a.jobStatus;e=g.isDefined(e)?e.toLowerCase():e;if(m.includes(["esrijobsucceeded","completed"],e))clearInterval(f),d.resolve(a);else if(m.includes(["esrijobfailed","failed"],e)||400<a.code)clearInterval(f),d.reject(a)}.bind(this),function(a){clearInterval(f);d.reject(a)}.bind(this))}.bind(this),c||500);return d}}})},"arcgisonline/sharing/dijit/AppendData":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/topic dojo/query dojo/_base/lang dojo/string dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/json dojo/_base/event dojo/Deferred dojo/promise/all dijit/_TemplatedMixin dijit/_WidgetBase esri/lang arcgisonline/sharing/util ../../esriGeowConfig ../../sharing/dijit/dialog/_CreateItemUtilMixin ../../sharing/geow/Item ../../pages/pageUtil ../../sharing/util ./dialog/ConfirmDialog ./AppendData/FieldTableRow ./AppendData/_canMatchFields dojo/text!../../pages/dijit/View/templates/loader.html dojo/text!./AppendData/templates/_appendData.html dojo/text!./AppendData/templates/_table-row.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J){return l([w,u],{templateString:K,i18n:J,baseClass:"appendData",_dijits:[],_sortOptions:[{property:"field",active:!0,ascending:!0},{property:"matchField",ascending:!0}],_supportedItemTypes:[{value:"Shapefile",innerHTML:J.addItemFrm.typeShapefile,regex:"(.zip$)",fileType:"shapefile",extension:"zip",appendUploadFormat:"shapefile"},{value:"File Geodatabase",innerHTML:J.addItemFrm.itemFileGeodatabase,regex:"(.zip$)",fileType:"fileGeodatabase",
extension:"zip",appendUploadFormat:"filegdb"},{value:"CSV",regex:"(.csv$)",fileType:"csv",appendUploadFormat:"csv",extension:"csv"},{value:"Microsoft Excel",regex:"(.xls$|.xlsx$)",fileType:"excel",appendUploadFormat:"excel",extension:"xls"},{value:"Microsoft Excel",regex:"(.xls$|.xlsx$)",fileType:"excel",appendUploadFormat:"excel",extension:"xlsx"},{value:"GeoJson",regex:"(.geojson$)",fileType:"geojson",appendUploadFormat:"geojson",extension:"geojson"}],_supportedFilesRegEx:"(.zip$|.csv$|.xls$|.xlsx$|.geojson$)",
_noneField:{value:"__none",displayName:J.appendDataDlg.none,name:J.appendDataDlg.none,type:"none"},_longitudeField:{value:"longitude",displayName:J.addItemFrm.locationTypes.longitude,name:"longitude",type:"esriFieldTypeDouble",sqlType:"sqlTypeDouble",nullable:!0,editable:!0,locationType:"longitude"},_latitudeField:{value:"latitude",displayName:J.addItemFrm.locationTypes.latitude,name:"latitude",type:"esriFieldTypeDouble",sqlType:"sqlTypeDouble",nullable:!0,editable:!0,locationType:"latitude"},postMixInProperties:function(){this.inherited(arguments);
this.serviceUrl=this.item&&this.item.url;this.portal=this.portal||this.item&&this.item.portal||C&&C.self||{};this.user=this.user||this.portalUser||(this.portal.getPortalUser?this.portal.getPortalUser():this.portal.portalUser)||{};this._serviceLayers=this.layer?f.clone([this.layer||this.layerInfo]):f.clone(this.layers||[this.layer||this.layerInfo]);this._layerInfo=this.layer||this.layerInfo||this._serviceLayers&&this._serviceLayers.length?this._serviceLayers[0]:null;this._serviceInfo=this.item&&this.item.serviceInfo||
{};this._adminServiceInfo=this.item&&this.item.adminServiceInfo||{};this._capabilities=this.item&&this.item.isPortal&&!this.item.isSDS?z.stringToArray(this._serviceInfo.capabilities,",",!0):z.stringToArray(this._adminServiceInfo.capabilities||"",",",!0);this._changeTrackingEnabled=z.includes(this._capabilities,"ChangeTracking");this._syncEnabled=this._serviceInfo.syncEnabled||!1},postCreate:function(){this.inherited(arguments);e(".js-analyze-loader-wrap",this.domNode).shift().innerHTML=d.substitute(O,
{location:""})},startup:function(){this.inherited(arguments);this._render().then(f.hitch(this,this._addEventListeners)).then(f.hitch(this,function(){}))},destroy:function(){this.inherited(arguments);this._deleteItem().then(f.hitch(this,function(){this._dijits.forEach(function(a){a.destroy()});this._sortHandler&&this._sortHandler.remove();this._dijits=[]}))},show:function(){this.dlg=new A({title:J.appendDataDlg.title,buttonOkLabel:J.appendDataDlg.uploadBtn,buttonCancelLabel:J.common.cancel,helpLinkInfo:{title:J.appendDataDlg.helpLinkTitle,
url:this.portal.helpBase+(this.portal.helpMap&&this.portal.helpMap.m["120001300"]||"share-maps/manage-hosted-feature-layers.htm#ESRI_SECTION1_E2F5EF6240F246EBA5D238968B63BF97")}});this.dlg.setContent(this.domNode);this.dlg.show();this.okBtn=this.dlg&&this.dlg.okButton||{};this.okBtn.set("disabled",!0);this.own(h(this.dlg,"ok",f.hitch(this,this.processStep)));return this.dlg},hide:function(){this.dlg&&this.dlg.hide();h.emit(this,"hide",{bubbles:!0,cancelable:!0})},processStep:function(){var a=new r;
this._isStep1?this._uploadData().then(f.hitch(this,this._analyze)).then(f.hitch(this,this._addLayerInfo)).then(f.hitch(this,this._validateLayers),f.hitch(this,function(a){this._showError(a)})).then(f.hitch(this,this._showStep2),f.hitch(this,function(a){this._showError(a)})).then(f.hitch(this,function(b){a.resolve(b)}),f.hitch(this,function(a){this._showStep1()})):this._appendDataLayer().then(f.hitch(this,function(b){this._done();a.resolve(b)}),f.hitch(this,function(a){this._showStep2();this._showError(a)}));
return a},_setItemAttr:function(a){this.item=a},_setReadOnlyAttr:function(b,c){var d=b?"addClass":"removeClass";a.publish("/esri/disable",b," ");e(".append-data")[d]("disabled");b?this.showLoader(c||this.i18n.common.pleaseWait):this.hideLoader()},_setSelectedSourceType:function(){var a=g.get(this._suportedTypes.options[this._suportedTypes.selectedIndex],"data-fileType");this._selectedSourceType=this._findSupportedType(a)},_getFieldMappings:function(){var a=this._fromField.value,b=this._toField.value,
c=this._dijits.map(function(a){return a.field}).filter(function(a){return a.matchField&&"__none"!==a.matchField.value}).map(function(a){return{source:a.matchField&&a.matchField.name,name:a.name}});this._updateExistingFeatures.checked&&"__none"!==b&&(c=c.filter(f.hitch(this,function(a){return a.name!==this._fromField.value&&a.name!==this._toField.value})),c.push({source:b,name:a}));return c&&c.length?c:null},_getAppendFields:function(a){return(a&&a.length||this._getFieldMappings()||[]).filter(function(a){return a&&
a.name}).map(function(a){return a.name})},_getAppendParams:function(){var a=this._selectedSourceType.appendUploadFormat,b=this._updateExistingFeatures.checked,c=this._fromField.options[this._fromField.selectedIndex],c=this._findField({name:g.get(c,"data-value"),type:g.get(c,"data-type")},this._layerFields),d=this._getSelectedDataLayer(),e=this._getFieldMappings(),a={sourceTableName:d.name,fieldMappings:e&&e.length?q.stringify(e):null,upsert:b,skipUpdates:!1,useGlobalIds:b&&c&&"esriFieldTypeGlobalID"===
c.type,skipInserts:b?this._skipInserts.checked:!1,updateGeometry:b?this._updateGeometry.checked:!0,appendFields:q.stringify(this._getAppendFields()),appendItemId:this._uploadedItem.id,appendUploadFormat:a,rollbackOnFailure:!0};!this._selectedSourceType||"csv"!==this._selectedSourceType.fileType&&"excel"!==this._selectedSourceType.fileType||(a=f.mixin(a,{appendSourceInfo:q.stringify(this._getAnalyzeParameters())}));c&&c.isUniqueIndex&&(a.upsertMatchingField=c.name);return a},_getSelectedDataLayer:function(){var a=
parseInt(this._dataLayersSelect.value,10),b;return(b=(this._dataLayers||[]).filter(function(b){return b.excelSheetId===a||b.id===a}))&&b.length?b.shift():{}},_getSelectedServiceLayer:function(){var a=parseInt(this._serviceLayersSelect.value,10);return this._findLayer(a,this._serviceLayers||[])},_getFormData:function(){var a=this._fileInput.files[0],b=a&&a.name||"",c=this._selectedSourceType.value,d=b.substr(0,b.indexOf("."))+"_agotmp"+b.substr(b.indexOf(".")),e=new FormData;e.append("type",c);e.append("title",
d);e.append("file",a,d);this._origFilename=b;this._sourceTitle=d;return e},_getAnalyzeParameters:function(){var a=f.clone(this._analyzeResults),b=this._findLocationField("longitude"),c=this._findLocationField("latitude"),d=a.publishParameters.locationType,b=b&&"__none"!==b.value?b.name:a.publishParameters.longitudeFieldName,c=c&&"__none"!==c.value?c.name:a.publishParameters.latitudeFieldName;b&&c?(a.publishParameters.locationType="coordinates",a.publishParameters.latitudeFieldName=c,a.publishParameters.longitudeFieldName=
b):"coordinates"!==d&&(a.publishParameters.locationType="none");return a.publishParameters},_addEventListeners:function(){var a=new r;this.own(h(this._showFieldMatchingLink,"click",f.hitch(this,this._showFieldMatching)),h(this._updateExistingFeatures,"change",f.hitch(this,this._updateExistingFeaturesChange)),h(this._fileInput,"change",f.hitch(this,this._onFileChange)),h(this._fromField,"change",f.hitch(this,this._onFromFieldChange)),h(this._toField,"change",f.hitch(this,this._onToFieldChange)),h(this._serviceLayersSelect,
"change",f.hitch(this,this._onServiceLayerChange)),h(this._dataLayersSelect,"change",f.hitch(this,this._onDataLayerChange)),h(this._suportedTypes,"change",f.hitch(this,this._setSelectedSourceType)));a.resolve();return a},_sortHeader:function(a){var b=a.target.getAttribute("data-sort"),c=k.contains(a.target,"is-ascending")||k.contains(a.target,"is-descending");a=a.target.getAttribute("data-sort-order");c&&(a="asc"===a?"desc":"asc");this._sortUpdate({property:b,ascending:"asc"===a})},_sortUpdate:function(a){var b=
e(".js-table-rows",this.domNode).shift(),c=this._noneField,d=this._getUIDField(),g=this._updateExistingFeatures.checked,k=this._getSelectedDataLayer(),m=(k.fields||[this._noneField]).sort(function(a,b){return a.name.localeCompare(b.name)}),n=this._layerFields,h={esriFieldTypeOID:1,esriFieldTypeGlobalID:1},p={portal:this.portal,template:H,dataLayerFields:m,addressFields:k.addressFields};this._currentSort=a=a||this._currentSort;m&&m.length&&"__none"!==m[0].value&&m.unshift(c);c=a.ascending?"is-ascending":
"is-descending";e(".js-table-sort-header").removeClass("is-descending").removeClass("is-ascending").attr("aria-sort","none");k=e(".js-table-sort-header[data-sort\x3d'"+a.property+"']",this.domNode);0<k.length&&(k.addClass(c),k.attr("aria-sort",a.ascending?"ascending":"descending"),k.attr("data-sort-order",a.ascending?"asc":"desc"));this._sortTitle("matchField"===a.property?this._matchFields:this._layerFields,a);this._sortHandler&&this._sortHandler.remove();this._sortHandler=e(".js-table-sort-header",
this.domNode).on("click",f.hitch(this,this._sortHeader));this._dijits.forEach(function(a){a.destroy()});this._dijits=[];n.forEach(f.hitch(this,function(a){a.type in h||!a.editable||g&&a.name===d.name||(a=new E(f.mixin(p,{field:a})),a.startup(),a.placeAt(b),this._dijits.push(a))}))},_sortTitle:function(a,b){return a.sort(function(a,c){return b.ascending?a.name.localeCompare(c.name):c.name.localeCompare(a.name)})},_showStep1:function(){var a=new r,b=this.okBtn;this._fillSupportedTypes().then(f.hitch(this,
function(){z.hideNode(this._step2);z.showNode(this._step1);this._isStep1=!0;b&&g.set(b,"label",J.appendDataDlg.uploadBtn);this.set("readOnly",!1);a.resolve(!0)}));return a},_showStep2:function(){var a=new r,b,c;v({serviceLayers:this._fillServiceLayers(this._serviceLayers),dataLayers:this._fillDataLayers(this._dataLayers)}).then(f.hitch(this,function(){b=this._getSelectedDataLayer();c=this._getSelectedServiceLayer();this._updateFields(c,b).then(f.hitch(this,function(){a.resolve(!0)}))}));return a},
_updateFields:function(a,b){var c=new r,k=this.okBtn,m="fileGeodatabase"===(this._analyzeResults&&this._analyzeResults.publishParameters||{}).type,n=this._selectedFile||this._uploadedItem&&this._uploadedItem.title||this._sourceTitle||"",h=this._syncEnabled||this._changeTrackingEnabled,p=b&&b.geometryType,q=a&&a.geometryType,D=q?!0:!1,l,t,u;v({serviceLayerFields:this._fillServiceLayerFields(a,b),dataLayerFields:this._fillDataLayerFields(a,b),fieldMatching:this._fillFieldMatching(a,b)}).then(f.hitch(this,
function(){z.hideNode(this._step1);z.showNode(this._step2);if(h){if(q!==p&&q&&("esriGeometryPoint"!==q||m||p)){this._showError({message:J.appendDataDlg.noMatchingSelectedLayerType});return}l=!0}else q===p?l=t=u=!0:q&&("esriGeometryPoint"!==q||m||p)?u=!0:l=t=u=!0;e(".js-updateFeatures-container").addClass("hide");e(".js-updateGeometry").forEach(z[D?"showNode":"hideNode"]);g.set(this._updateExistingFeatures,"checked",t||u||!1);!t&&l?e(".js-updateFeatures, .js_attributesOnly").addClass("disabled"):(e(".js-updateFeatures").removeClass("disabled"),
e(".js-attributesOnly")[!t&&u?"addClass":"removeClass"]("disabled"));this._updateExistingFeaturesChange();g.set(this._updateGeometry,"checked",!1);g.set(this._skipInserts,"checked",!l&&(t||u)||!1);this._toField.value="__none";this._isStep1=!1;g.set(this._appendDataLabel,"innerHTML",d.substitute(J.appendDataDlg.chooseLayer,{fileName:n}));k&&g.set(k,"label",J.appendDataDlg.applyUpdatesBtn);this.set("readOnly",!1);c.resolve(!0)}));return c},_updateLayerDataUpdatedDate:function(){var a=this.item,b=this._layerInfo,
c=(new Date).getTime();b&&(b.editingInfo=b.editingInfo||{},b.editingInfo.lastEditDate=c,a.layers&&(a=a.layers[b.id],a.editingInfo=a.editingInfo||{},a.editingInfo.lastEditDate=c))},_done:function(){this._deleteItem().then(f.hitch(this,function(){this._updateLayerDataUpdatedDate();a.publish("append/done",{type:"success"});this.set("readOnly",!1);a.publish("alert/show",{type:"success",text:J.appendDataDlg.updateSuccess});this.hide()}))},_showFieldMatching:function(a){var b=(a="true"===g.get(this._showFieldMatchingLink,
"data-value"))?"hideNode":"showNode";g.set(this._showFieldMatchingLink,"data-value",a?"false":"true");g.set(this._showFieldMatchingLink,"innerHTML",a?J.appendDataDlg.showFieldMatching:J.appendDataDlg.hideFieldMatching);z[b](this._fieldMatching)},_updateExistingFeaturesChange:function(a){a=this._updateExistingFeatures.checked?"removeClass":"addClass";e(".js-updateFeatures-container")[a]("hide");this._sortUpdate()},_onFileChange:function(a){a=(a=this._fileInput.files[0])&&a.name||"";var b=a.split(".").pop(),
c=(new RegExp(this._supportedFilesRegEx,"i")).test(a),d=b&&"zip"===b.toLowerCase();this._selectedSourceType=this._findSupportedType(d?"shapefile":b);this._selectedFile=a;z[c&&d?"showNode":"hideNode"](this._zipSelect);this.okBtn.set("disabled",!c)},_onFromFieldChange:function(a){a=a&&a.target||{};var b=a.options[a.selectedIndex],c=this._getSelectedDataLayer(),d=this._getSelectedServiceLayer(),b={name:g.get(b,"data-value"),type:g.get(b,"data-type")},e=this._findField(b,this._layerFields),k=this._findField({name:a.prevValue,
type:a.prevType},this._layerFields);this._uidField=b;e.type!==k.type&&this._fillDataLayerFields(d,c);"__none"===e.value&&(this._toField.value="__none");f.mixin(a,{prevValue:a.value,prevType:b.type});this._sortUpdate()},_onToFieldChange:function(b){b=b&&b.target||{};b=b.options[b.selectedIndex];b={name:g.get(b,"data-value"),type:g.get(b,"data-type")};b=this._findField(b,this._layerFields);a.publish("appendData/fieldChanged",b)},_onServiceLayerChange:function(){this._showStep2(this._analyzeResults)},
_onDataLayerChange:function(){var a=this._getSelectedDataLayer(),b=this._getSelectedServiceLayer();this._updateFields(b,a)},_render:function(){var a=new r;v([this._showStep1()]).then(f.hitch(this,function(){a.resolve(!0)}));return a},showLoader:function(a){z.showNode(e(".analyze-loader-wrap").shift());z.activateNode(e(".analyze-loader-wrap .loader").shift());e(".loader-text",this.domNode).attr("innerHTML",a)},hideLoader:function(){z.hideNode(e(".analyze-loader-wrap").shift());z.deactivateNode(e(".analyze-loader-wrap .loader").shift())},
_clearSelect:function(a){if(a&&a.options)for(var b=a.options.length-1;0<=b;b--)a.remove(b)},_fillSupportedTypes:function(){var a=new r,b;this._supportedItemTypes.forEach(f.hitch(this,function(a){a.innerHTML&&(b=m.create("option",{"data-value":a.value,"data-validate":a.regex||"","data-fileType":a.fileType,"data-appendUploadFormat":a.appendUploadFormat,value:a.value,innerHTML:a.innerHTML}),this._suportedTypes.add(b))}));a.resolve(!0);return a},_fillServiceLayers:function(){var a=new r;if(this._serviceLayersSelect&&
this._serviceLayersSelect.options&&this._serviceLayersSelect.options.length)a.resolve(this._serviceLayers);else{var b=this._serviceLayers||[],c=this.layers&&1<this.layers.length?"showNode":"hideNode",d;this._clearSelect(this._serviceLayersSelect);b&&b.length&&b.forEach(f.hitch(this,function(a){d=m.create("option",{"data-value":a.id,value:a.id,innerHTML:a.name});this._serviceLayersSelect.add(d)}));z[c](this._serviceLayersContainer);a.resolve(b)}return a},_fillDataLayers:function(a){var b=new r;a=a||
this._dataLayers||[];var c=this._analyzeResultLayers&&1<this._analyzeResultLayers.length?"showNode":"hideNode",d,e;this._clearSelect(this._dataLayersSelect);a.forEach(f.hitch(this,function(a){e=t.isDefined(a.excelSheetId)?parseInt(a.excelSheetId,10):parseInt(a.id,10);d=m.create("option",{"data-value":e,value:e,innerHTML:a.name});this._dataLayersSelect.add(d)}));this._dataLayersSelect.options&&!this._dataLayersSelect.options.length&&(d=m.create("option",{"data-value":this._noneField.value,value:this._noneField.value,
innerHTML:this._noneField.name}),this._dataLayersSelect.add(d));z[c](this._dataLayersContainer);this._dataLayers=a;b.resolve(a);return b},_fillServiceLayerFields:function(a,b){b=new r;var c=this._noneField,d=f.clone(a.fields||[]),e=f.clone(a.indexes||[]),g=this._getUIDField(a),k={esriFieldTypeOID:1,esriFieldTypeGlobalID:1},n,h;this._clearSelect(this._fromField);e.filter(function(a){return a&&a.isUnique}).forEach(function(a){h=a.fields&&a.fields.split(",")||[];h.forEach(function(a){d.some(function(b){return b.name.toLowerCase()===
a.toLowerCase()?b.isUniqueIndex=!0:!1})}.bind(this))}.bind(this));"Table"===a.type||!this._selectedSourceType||"excel"!==this._selectedSourceType.fileType&&"csv"!==this._selectedSourceType.fileType||((a=this._findField(this._longitudeField,d))&&"__none"!==a.value||d.push(f.clone(this._longitudeField)),(a=this._findField(this._latitudeField,d))&&"__none"!==a.value||d.push(f.clone(this._latitudeField)));this._layerFields=f.clone(d||[]);d=d.filter(function(a){return a.type&&a.type in k||a.isUniqueIndex}).sort(function(a,
b){return a.name.localeCompare(b.name)});d.unshift(c);d.forEach(f.hitch(this,function(a){n=m.create("option",{"data-value":a.value||a.name||null,"data-type":a.type||null,value:a.value||a.name||null,innerHTML:a.displayName||a.name});this._fromField.add(n)}));this._fromField.value=g&&g.value||"__none";this._fromField.type=g&&g.value||"__none";this._fromField.prevValue=this._fromField.value;this._fromField.prevType=this._fromField.type;b.resolve(d);return b},_fillDataLayerFields:function(a,b){var c=
new r,d=this._noneField;b=b&&b.fields?f.clone(b.fields):[];a=this._getUIDField(a);b=this._filterAllowedFields(b,a).sort(function(a,b){return a.name.localeCompare(b.name)});a=this._findField(a,b);var e;this._clearSelect(this._toField);b&&b.length&&"__none"!==b[0].value?b.unshift(d):b=[d];b.forEach(f.hitch(this,function(a){e=m.create("option",{"data-value":a.value||a.name||null,"data-type":a.type||null,value:a.value||a.name||null,innerHTML:a.displayName||a.name});this._toField.add(e)}));this._toField.value=
a&&"__none"!==a.value?a.name||"__none":"__none";g.set(this._toField,"disabled","__none"===this._fromField.value||this._toField.options&&2>this._toField.options.length);c.resolve(b);return c},_filterAllowedFields:function(a,b){return(a=a.filter(function(a){return N(b,a)}))&&a.length?a:[]},_fillFieldMatching:function(){var a=new r;this._sortUpdate({property:"title",ascending:!0});a.resolve(!0);return a},_addLayerInfo:function(a){var b=new r,c=a&&a.publishParameters?f.clone(a.publishParameters):{},d;
a=(c.layers||[c.layerInfo]).map(function(a){d=a.locationType||c.locationType||null;a.geometryType=a.geometryType||("coordinates"===d?"esriGeometryPoint":null)||null;a.addressFields=a.addressFields||c.addressFields||("coordinates"===d?{longitudeFieldName:a.longitudeFieldName||c.longitudeFieldName,latitudeFieldName:a.latitudeFieldName||c.latitudeFieldName}:{});return a});b.resolve(a);return b},_validateLayers:function(a){var b=new r,c="fileGeodatabase"===(this._analyzeResults&&this._analyzeResults.publishParameters||
{}).type,d=this._syncEnabled||this._changeTrackingEnabled?this.layers.filter(function(b){return a.some(function(a){return a.geometryType===b.geometryType||!b.geometryType||"esriGeometryPoint"===b.geometryType&&!c&&!a.geometryType})}):this.layers;d&&d.length?(this._analyzeResultLayers=f.clone(a),this._dataLayers=f.clone(a),this._serviceLayers=f.clone(d),b.resolve(this._analyzeResults)):b.reject({message:J.appendDataDlg.noMatchingLayerType});return b},_getUIDField:function(a){var b=this._uidField||
null;if(!b)var c=a.globalIdField,b=this._uidField=(a=(a.fields||[]).filter(function(a){return a.name===c}))&&a.length?a.shift():this._noneField;return b},_findField:function(a,b){return(b=(b||[]).filter(function(b){return b.type===a.type&&b.name.toLowerCase()===a.name.toLowerCase()}))&&b.length?b.shift():this._noneField},_findLocationField:function(a){var b=this._dijits.map(function(a){return a.field}).filter(function(b){return b.name.toLowerCase()===a.toLowerCase()&&b.matchField});return b&&b.length?
b.shift().matchField:null},_findLayer:function(a,b){return z.findLayer(a,b||[])},_findSupportedType:function(a){var b=(this._supportedItemTypes||[]).filter(function(b){return b.fileType===a||b.extension.toLowerCase()===a.toLowerCase()});return b&&b.length?b.shift():null},_uploadData:function(a){a=a||new r;var b=this.item&&this.item.owner,c=this._getFormData(),d={owner:b,folderId:void 0,fileName:this._sourceTitle,fileType:this._selectedSourceType.value};this.set("readOnly",!0,J.appendDataDlg.uploadProgress);
B.addItem(d,c,this._fileInput.files[0]).then(function(b){b&&b.success?(this._uploadedItem=f.mixin(b,{title:d.fileName,type:d.fileType,folderId:""},{title:this._sourceTitle}),b.isMultipart?(b.statusUrl=B._getActionItemUrl(d,"status"),this._checkStatus(b).then(function(){a.resolve(b)})):a.resolve(b)):a.reject(b)}.bind(this),function(b){b&&409!==b.code?this._showError(b):this._deleteExistingTempItem(this._sourceTitle).then(function(){this._uploadData(a)}.bind(this),function(a){this._showError(b)}.bind(this))}.bind(this));
return a},_analyze:function(a){var b=new r;a=f.mixin({fileType:this._selectedSourceType.fileType},a);this.set("readOnly",!0,J.appendDataDlg.analyzeProgress);x.analyzeItem(a,{enableGlobalGeocoding:!1},this.portal).then(f.hitch(this,function(a){this._analyzeResults=a;b.resolve(a)}),f.hitch(this,function(a){b.reject(a)}));return b},_appendDataLayer:function(){var a=new r,b=this._getSelectedServiceLayer(),c=this._analyzeResults||{},d=c.publishParameters&&c.publishParameters.locationType||"none",e=this.serviceUrl+
"/"+b.id+"/append",g=this._getAppendParams(),k=this._findLocationField("longitude")||{},m=this._findLocationField("latitude")||{},n=this._updateExistingFeatures.checked;if(n&&("__none"===this._fromField.value||"__none"===this._toField.value))return a.reject({message:J.appendDataDlg.noUIDFieldMapping}),a;if(!(!c.publishParameters||"csv"!==c.publishParameters.type&&"excel"!==c.publishParameters.type||"esriGeometryPoint"!==b.geometryType||"none"!==d&&"address"!==d||n&&!g.updateGeometry||"__none"!==k.value&&
"__none"!==m.value))return a.reject({message:J.appendDataDlg.noLocationFields}),a;g.fieldMappings?(this.set("readOnly",!0,J.appendDataDlg.applyProgress),F.request({url:e,content:g},{usePost:!0}).then(f.hitch(this,this._checkStatus),f.hitch(this,function(b){a.reject(b)})).then(f.hitch(this,function(b){a.resolve(b)}))):a.reject({message:J.appendDataDlg.noMatchingFields});return a},_checkStatus:function(a,b,c){var d=a&&a.statusUrl,e=c||new r,g=b||500;F.request({url:d}).then(f.hitch(this,function(c){c=
c||{status:"completed"};c.status&&"completed"===c.status.toLowerCase()?e.resolve(!0):c.status&&"failed"===c.status.toLowerCase()||400<c.code||""===c.status?this._showError(c):(g=(g||500)+250,setTimeout(f.hitch(this,function(){this._checkStatus(a,g,e)}),b))}),f.hitch(this,function(a){this._showError(a)}));return e},_deleteItem:function(){var a=new r,b=this.item&&this.item.itemOwner;this._uploadedItem?b.deleteItems([this._uploadedItem]).then(f.hitch(this,function(b){this._uploadedItem=null;a.resolve(!0)}),
f.hitch(this,function(){this._uploadedItem=null;a.resolve(!0)})):a.resolve(!0);return a},_deleteExistingTempItem:function(a){var b=new r,c=this.item&&this.item.itemOwner;this.portal.queryItems("title:"+a).then(f.hitch(this,function(a){a&&a.items&&a.items.length?c.deleteItems([a.items.shift()]).then(f.hitch(this,function(){b.resolve(!0)}),f.hitch(this,function(){b.resolve(!0)})):b.resolve(!1)}));return b},_showError:function(a){var b=f.mixin(f.mixin({},J.publishWizard.errors.error),a);a=a&&(a.statusMessage||
a.message||"");-1<a.indexOf("Invalid Shapefile")?b.message=t.substitute({name:this._origFilename},this.i18n.addItemFrm.errors.invalidShapefile.message):-1<a.indexOf("Invalid File Geodatabase")?b.message=t.substitute({name:this._origFilename},this.i18n.addItemFrm.errors.invalidFileGeodatabase.message):-1<a.indexOf("Object reference not set to")?b.message=t.substitute({name:this._origFilename},this.i18n.appendDataDlg.error):-1<a.indexOf("Duplicate field names are not allowed")&&(b.message=this.i18n.common.errors.duplicateFields);
this._errorDlg=new A({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(b).then(f.hitch(this,function(){this.set("readOnly",!1);this._errorDlg.hide()}));return!1}})})},"arcgisonline/sharing/dijit/AppendData/FieldTableRow":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-attr dojo/on dojo/query dojo/string dojo/topic dojo/Deferred dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/sharing/util ../../../pages/pageUtil ../../../pages/utils/formatters ./_canMatchFields dojo/text!./templates/_table-row.html dojo/i18n!../../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t){return c([p,q],{i18n:t,_noneField:{value:"__none",name:t.appendDataDlg.none},postMixInProperties:function(){this.inherited(arguments);l.mixin(this,v);this.portal=this.portal||esriGeowConfig&&esriGeowConfig.self||{};this.portalUser=this.portalUser||this.user||this.portal.portalUser||{};this.templateString=this.template||w;this.displayName=this.field.displayName||this.field.name},postCreate:function(){this.inherited(arguments);this.cssClasses&&h.add(this.domNode,
this.cssClasses.join(" "))},startup:function(){this.inherited(arguments);this._render().then(l.hitch(this,this._addEventListeners)).then(l.hitch(this,function(){}))},destroy:function(){this.inherited(arguments)},_setValue:function(a){a=a&&a.matchField||a||{name:t.appendDataDlg.none,value:"__none"};this._matchFields.value=a.value;this.field.matchField=a;e.set(this._matchFieldValue,"innerHTML",a.displayName||a.name);e.set(this._matchFieldValue,"data-value",a.value||a.name);e.set(this._matchFieldValue,
"data-type",a.type)},_render:function(){var a=new k;m([this._createMatchFieldOptions()]).then(l.hitch(this,function(){var b=this.field&&this.field.matchField||this.field,b=b?this._findField(b,this.dataLayerFields):null;this._setValue(b);a.resolve(!0)}));return a},_addEventListeners:function(){var a=new k;this.own(f(this._matchFields,"blur",l.hitch(this,function(a){this.field.value=this._editEnd({evt:a})})),f(this._matchFieldsContainer,"click",l.hitch(this,function(a){this._editStart({evt:a})})),g.subscribe("appendData/fieldChanged",
l.hitch(this,function(a){"__none"!==a.value&&this.field&&this.field.matchField&&this.field.matchField.name===a.name&&this._setValue()})));a.resolve();return a},_editStart:function(a){a=a.evt;var b=a.target,c=d("select",a.target.parentElement).shift(),f=e.get(b,"data-value");f&&b&&"SPAN"===b.tagName&&(h.add(a.target,"hide"),h.remove(c,"hide"),c.value=f,c.focus())},_editEnd:function(a){a=a.evt.target;var b=d("span",a.parentElement).shift(),c=e.get(a.options[a.selectedIndex],"data-value"),f=e.get(a.options[a.selectedIndex],
"data-type"),f=this._findField({type:f,name:c},this.dataLayerFields);g.publish("appendData/fieldChanged",f);this._setValue(f);h.add(a,"hide");h.remove(b,"hide");return c},_findField:function(a,b){return(b=(b||[]).filter(l.hitch(this,function(b){return a.name.toLowerCase()===b.name.toLowerCase()&&(b.type===a.type||this._findAddressField(b.displayName||b.name))})))&&b.length?b.shift():this._noneField},_findAddressField:function(a){var b=this.addressFields||{},c=Object.keys(b).filter(function(c){return b[c]===
a});return c&&c.length?c.shift():null},_createMatchFieldOptions:function(){var b=new k,c;(this.dataLayerFields||[]).forEach(l.hitch(this,function(b){if("__none"===b.value||u(this.field,b))c=a.create("option",{"data-value":b.value||b.name,"data-type":b.type||null,value:b.value||b.name,innerHTML:b.displayName||b.name}),this._matchFields.add(c)}));b.resolve(!0);return b}})})},"arcgisonline/sharing/dijit/AppendData/_canMatchFields":function(){define([],function(){return function(c,l){c=c&&c.type||null;
l=l&&l.type||null;var h={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:"esriFieldTypeString esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeDate esriFieldTypeGUID".split(" "),
esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"]};return l&&(l===c||h[c]&&-1<h[c].indexOf(l))}})},"arcgisonline/pages/dijit/ReplaceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Deferred dojo/io-query dojo/on dojo/promise/all dojo/query dojo/string dojo/topic arcgisonline/sharing/dijit/ReplaceLayerItemBrowser esri/arcgis/Portal arcgisonline/pages/portal/PortalItem ../../sharing/util dijit/_TemplatedMixin dijit/_WidgetBase ./Overlay dojo/text!./ReplaceLayer/templates/ReplaceLayer.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x){return c([t,w,y],{title:x.itemLinks.replaceLayer,overlayContents:p.substitute(C,{i18n:x}),i18n:x,replacementItem:null,portal:null,success:!1,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.domNode.querySelector(".js-overlay-primary").textContent=x.replaceLayer.replace;this.loaderNode=this.domNode.querySelector(".js-replace-lyr-loader");this.failedNode=this.domNode.querySelector(".js-replace-lyr-failed");
this.errorNode=this.failedNode.querySelector("#replace-lyr-error-text");this.successNode=this.domNode.querySelector(".js-replace-lyr-success");this.actionBarNode=this.domNode.querySelector(".overlay-action-bar");this.wrapperNode=this.domNode.querySelector(".js-replace-lyr-wrapper");this.currentLayerNode=this.domNode.querySelector("#replace-lyr-current-container");this.currentIconNode=this.currentLayerNode.querySelector("#replace-lyr-current-icon");this.currentTypeNode=this.currentLayerNode.querySelector("#replace-lyr-current-type");
this.currentOwnerNode=this.currentLayerNode.querySelector("#replace-lyr-current-owner");this.currentTitleNode=this.currentLayerNode.querySelector("#replace-lyr-current-title");this.currentArchiveBtnNode=this.currentLayerNode.querySelector("#replace-lyr-current-arch-btn");this.currentArchiveNameNode=this.currentLayerNode.querySelector("#replace-lyr-current-arch-name");this.currentArchiveEditNode=this.currentLayerNode.querySelector("#replace-lyr-edit-name");this.archiveNameInputError=this.currentLayerNode.querySelector(".js-replace-name-input-error");
this.archiveNameAvailableError=this.currentLayerNode.querySelector(".js-replace-name-available-error");this.currentArchiveSaveNode=this.currentLayerNode.querySelector("#replace-lyr-edit-save");this.currentArchiveEditContainerNode=this.currentLayerNode.querySelector("#replace-lyr-edit-container");this.selectedLayerNode=this.domNode.querySelector("#replace-lyr-selected-lyr-container");this.selectedIconNode=this.selectedLayerNode.querySelector("#replace-lyr-selected-icon");this.selectedTypeNode=this.selectedLayerNode.querySelector("#replace-lyr-selected-type");
this.selectedOwnerNode=this.selectedLayerNode.querySelector("#replace-lyr-selected-owner");this.selectedTitleNode=this.selectedLayerNode.querySelector("#replace-lyr-selected-lyr-name");this.primaryBtnNode=this.domNode.querySelector(".js-overlay-primary");this.replaceItemInfoCheckbox=this.selectedLayerNode.querySelector("#replace-lyr-info-change");this.primaryBtnNode.disabled=!0;this.currentIconNode.src=this.item.iconUrl;this.currentTypeNode.textContent=this.item.typeInfo.displayName;this.currentOwnerNode.textContent=
this.item.owner;this.currentTitleNode.textContent=this.item.title;this.currentArchiveNameNode.textContent=this._generateArchiveName();this.currentArchiveEditNode.value=this._generateArchiveName();this._checkServiceNameAvailable(this.currentArchiveNameNode.textContent);this._createItemBrowser()},destroy:function(){this.inherited(arguments)},close:function(a){this.success&&q.publish("item/replaceLayerSuccess");this.inherited(arguments)},_addEventListeners:function(){this.inherited(arguments);this.domNode.querySelector(".js-replace-lyr-select-lyr").addEventListener("click",
this._showItemBrowser.bind(this));this.domNode.querySelector(".js-overlay-cancel").addEventListener("click",this.close.bind(this));this.domNode.querySelector(".js-replace-lyr-change-lyr").addEventListener("click",this._showItemBrowser.bind(this));this.domNode.querySelector(".js-overlay-primary").addEventListener("click",this._submit.bind(this));this.domNode.querySelector("#replace-lyr-failed-close-btn").addEventListener("click",this.close.bind(this));this.domNode.querySelector("#replace-lyr-success-close-btn").addEventListener("click",
this.close.bind(this));this.domNode.querySelector("#replace-lyr-edit-name").addEventListener("input",this._handleArchiveInput.bind(this));this.domNode.querySelector("#replace-lyr-edit-save").addEventListener("click",this._handleArchiveSave.bind(this));this.domNode.querySelector("#replace-lyr-current-arch-btn").addEventListener("click",this._handleArchiveEdit.bind(this))},_generateArchiveName:function(){function a(a){return 2>a.length?"0"+a:a}var b=new Date,c=b.getFullYear(),d=a((b.getMonth()+1).toString()),
b=a(b.getDate());return this._replaceSpacesWithUnderscore(this.item.title)+"_archive_"+c+d+b},_replaceSpacesWithUnderscore:function(a){return a.replace(/\s/g,"_")},_createItemBrowser:function(){var a=document.createElement("div");this.domNode.querySelector(".overlay-content").appendChild(a);a.className="replace-lyr-ib-container";this.portal=new r.Portal(esriGeowConfig.restBaseUrl);this.portal.signIn().then(function(){this.itemBrowser=new n({container:a,portal:this.portal,onSelect:this._handleLayerSelect.bind(this),
excludeId:this.item.id})}.bind(this))},_showItemBrowser:function(){this.itemBrowser&&this.itemBrowser.show()},_handleLayerSelect:function(a){this.primaryBtnNode.disabled=!1;this.replacementItem=new v(l.mixin(a,{portal:this.portal}));this._renderReplacementLayerView()},_renderReplacementLayerView:function(){this.selectedTitleNode.textContent=this.replacementItem.title;this.selectedIconNode.src=this.replacementItem.iconUrl;this.selectedTypeNode.textContent=this.replacementItem.typeInfo.displayName;
this.selectedOwnerNode.textContent=this.replacementItem.owner;m("#replace-lyr-selected-lyr-container",this.domNode).removeClass("hide");m("#replace-lyr-no-lyr-container",this.domNode).addClass("hide")},_handleArchiveEdit:function(){e.remove(this.currentArchiveEditContainerNode,"hide");e.add(this.currentArchiveBtnNode,"hide")},_handleArchiveInput:function(a){var b=/[.@#%&*+=\-\\';,\/|\\":<>\?]/g.test(a.target.value);0===a.target.value.length||b?this._handleArchiveNameValidationError(b?"invalid":void 0):
(e.remove(this.archiveNameInputError,"is-active"),e.remove(this.archiveNameAvailableError,"is-active"),this.currentArchiveSaveNode.disabled=!1)},_handleArchiveSave:function(a){var b=this._replaceSpacesWithUnderscore(this.currentArchiveEditNode.value);this.replacementItem&&this.replacementItem.title===b?this._saveArchiveName(b):this._checkServiceNameAvailable(b).then(function(a){a.available?this._saveArchiveName(b):this._handleArchiveNameValidationError("unavailable")}.bind(this),this._handleArchiveNameValidationError.bind(this))},
_saveArchiveName:function(a){this.currentArchiveNameNode.textContent=a;e.add(this.currentArchiveEditContainerNode,"hide");e.remove(this.currentArchiveBtnNode,"hide");this.replacementItem&&(this.primaryBtnNode.disabled=!1)},_handleArchiveNameValidationError:function(a){this.currentArchiveSaveNode.disabled=!0;this.primaryBtnNode.disabled=!0;switch(a){case "invalid":e.add(this.archiveNameInputError,"is-active");break;case "unavailable":e.add(this.archiveNameAvailableError,"is-active")}},_submit:function(){this.replacementItem&&
(this._showLoader(),this._replaceLayer().then(function(a){a.success?(this.success=!0,this._showSuccess()):this._showFailure(x.cannotReplace)}.bind(this),function(a){this._showFailure(a.message)}.bind(this)))},_replaceLayer:function(){return u.request({url:this.portal.portalUrl+"content/users/"+this.portal.user.username+"/replaceService",content:{toReplaceItemId:this.item.id,replacementItemId:this.replacementItem.id,replacedServiceName:this.currentArchiveNameNode.textContent,replaceMetadata:this.replaceItemInfoCheckbox.checked,
f:"json"}},{usePost:!0})},_showLoader:function(){e.add(this.wrapperNode,"hide");e.add(this.actionBarNode,"hide");e.remove(this.loaderNode,"hide")},_showSuccess:function(){e.add(this.loaderNode,"hide");e.remove(this.successNode,"hide")},_showFailure:function(a){this.errorNode.textContent=a;e.add(this.loaderNode,"hide");e.remove(this.failedNode,"hide")},_checkServiceNameAvailable:function(a){return u.request({url:esriGeowConfig.portal.portalUrl+"portals/"+(esriGeowConfig.self&&esriGeowConfig.self.user&&
(esriGeowConfig.self.user.accountId||esriGeowConfig.self.user.orgId))+"/isServiceNameAvailable",content:{name:a,type:"Vector Tile Service",f:"json"}})}})})},"arcgisonline/sharing/dijit/ReplaceLayerItemBrowser":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline dijit/_WidgetBase esri/request ../../tsutils/declareDecorator arcgis-components/wrappers/ItemBrowser".split(" "),function(c,l,h,a,e,f,d,b){a=h.__importDefault(a);e=h.__importDefault(e);f=h.__importDefault(f);d=h.__importDefault(d);
return function(){function c(a){this.options=a}c.prototype.postCreate=function(){var c=this,d=this.options.portal.user,d=!!d&&!!d.credential&&"org_admin"===d.role,e;e=d?"myOrganization":"myContent";var g;g=d?"relevance":"modified";this.browser=new b.ItemBrowserWrapper(this.options.container,{apiVersion:3,portal:this.options.portal,request:f.default,initialState:h.__assign({},b.initialState,{settings:h.__assign({},b.initialState.settings,{config:h.__assign({},b.initialState.settings.config,{baseSections:d?
["myOrganization","myContent"]:["myContent"],disableMainAction:!0,dialogTitle:a.default.replaceLayer.selectReplacementLayer,searchPlaceholderText:a.default.viewer.itemBrowser.searchLayers,detailsPaneType:"flyout",hideEllipses:!0,onBack:function(){c.hide()},layoutMode:"confined",showSubmitButton:!1,allowedItemTypes:["Vector Tile Service"],disableItemTypeFilters:!0,asynchronousItemSelect:!1,itemName:a.default.viewer.itemBrowser.layers,showCloseBtn:!0,showBackBtn:!1,enableMapAreaFilter:!1,replaceSectionDropdownWithTitle:!0,
customActions:[{name:a.default.replaceLayer.selectLayer,allowed:function(){return!0},asynchronous:!1,onAction:function(a){c.hide();if(c.options.onSelect)c.options.onSelect(a)},icon:'\x3csvg width\x3d"16" height\x3d"16" viewBox\x3d"0 0 32 32"\x3e\x3cpath d\x3d"M16 .4C7.385.4.4 7.382.4 16c0 8.615 6.984 15.6 15.6 15.6 8.617 0 15.6-6.984 15.6-15.6C31.6 7.383 24.618.4 16 .4zm0 28.799c-7.279 0-13.199-5.92-13.199-13.199S8.721 2.8 16 2.8 29.199 8.721 29.199 16 23.279 29.199 16 29.199zm10-13.197S20.891 21 17.979 24h-5.055l6.238-6H6v-4h13.162l-6.25-6h5.105c2.92 2.916 7.982 8.002 7.982 8.002z" /\x3e\x3c/svg\x3e'}],
addQueryParameters:function(){return'AND typekeywords:"Hosted Service"NOT id:'+c.options.excludeId}})}),parameters:h.__assign({},b.initialState.parameters,{section:e,sort:{field:g,order:"desc"}})})})};c.prototype.search=function(a){this.browser&&this.browser.dispatch(b.search(a))};c.prototype.hide=function(){var a=this;this.options.container.className="replace-lyr-ib-container replace-lyr-ib-container--out-left";this.options.container.setAttribute("style","display: auto; opacity: 0%;");setTimeout(function(){a.options.container.setAttribute("style",
"display: none; opacity: 0%;");a.visible=!1},250)};c.prototype.show=function(){this.options.container.className="replace-lyr-ib-container replace-lyr-ib-container--in-right";this.options.container.setAttribute("style","display: auto; opacity: 100%;")};return c=h.__decorate([d.default(e.default)],c)}()})},"arcgis-components/wrappers/ItemBrowser":function(){define(["../Component","../ItemBrowser/index"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,
exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,
"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=377)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});
e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(h,a){h.exports=c},377:function(c,a,e){e.r(a);e.d(a,"ItemBrowserWrapper",
function(){return m});var f=e(0),d=e(3),b=e(60),g=e.n(b),k=e(73);e.d(a,"changeSearchSection",function(){return b.changeSearchSection});e.d(a,"initialState",function(){return b.initialState});e.d(a,"search",function(){return b.search});e.d(a,"updateExtent",function(){return b.updateExtent});var m=function(){function a(a,c){this.options=c;this.projector=k.createProjector();this.renderContainer=document.createElement("div");this.renderContainer.style.width="100%";this.renderContainer.style.height="100%";
this.renderContainer.id="item-browser-wrapper";a.appendChild(this.renderContainer);a=c.initialState?c.initialState:b.initialState;this.initialState=f.a({},a,{settings:{config:a.settings.config,utils:{request:4===c.apiVersion?c.request:this.shimmedRequest.bind(this),portal:4===c.apiVersion?c.portal:f.a({},c.portal,{restUrl:c.portal.portalUrl.slice(0,-1),credential:c.portal.user&&c.portal.user.credential?c.portal.user.credential:void 0}),iconDir:4===c.apiVersion?window.require.toUrl("esri/images/portal"):
window.require.toUrl("esri/css/images/item_type_icons")}}});this.itemBrowser=new g.a(Object(d.newStore)({reducers:b.reducers,jsxFactory:k.h,initialState:this.initialState,renderTrigger:this.projector.scheduleRender,middlewares:c.listener?[d.middlewares.thunk,d.middlewares.addListener(c.listener)]:[d.middlewares.thunk]}),{key:"item-browser-wrapper"});this.projector.append(this.renderContainer,this.render.bind(this));this.itemBrowser.dispatch(Object(b.search)(!0))}return a.prototype.render=function(){return this.itemBrowser.render()},
a.prototype.shimmedRequest=function(a,b){var c=f.a({},b.query);return this.options.portal.user&&this.options.portal.user.credential&&-1<a.indexOf(this.options.portal.restUrl)&&(c.token=this.options.portal.user.credential.token),this.options.request({url:a,content:b.query},{usePost:"post"===b.method}).then(function(a){return{data:a}})},a.prototype.dispatch=function(a){this.itemBrowser&&this.itemBrowser.dispatch(a)},a.prototype.getState=function(){return this.itemBrowser?this.itemBrowser.stateTree:
this.initialState},a}()},60:function(c,a){c.exports=l},73:function(c,a,e){var f,d;e=[a];void 0===(d="function"==typeof(f=function(a){var b,c,d=[],e=function(a,b){var c={};return Object.keys(a).forEach(function(b){c[b]=a[b]}),b&&Object.keys(b).forEach(function(a){c[a]=b[a]}),c},f=function(a,b){return a.vnodeSelector===b.vnodeSelector&&(a.properties&&b.properties?a.properties.key===b.properties.key&&a.properties.bind===b.properties.bind:!a.properties&&!b.properties)},n=function(a){return{vnodeSelector:"",
properties:void 0,children:void 0,text:a.toString(),domNode:null}},h=function(a,b,c){for(var d=0,e=b.length;d<e;d++){var f=b[d];Array.isArray(f)?h(a,f,c):null!==f&&void 0!==f&&(f.hasOwnProperty("vnodeSelector")||(f=n(f)),c.push(f))}},l=function(){throw Error("Provide a transitions object to the projectionOptions to do animations");},u={namespace:void 0,eventHandlerInterceptor:void 0,styleApplyer:function(a,b,c){a.style[b]=c},transitions:{enter:l,exit:l}},w=function(a){if("string"!=typeof a)throw Error("Style values must be strings");
},t=function(a,b){var c=a.domNode;if(a.properties){var d=a.properties.exitAnimation;if(d){c.style.pointerEvents="none";var e=function(){c.parentNode&&c.parentNode.removeChild(c)};return"function"==typeof d?void d(c,e,a.properties):void b.exit(a.domNode,a.properties,d,e)}}c.parentNode&&c.parentNode.removeChild(c)},y=function(a,b,c,d){var e=a[b];if(""!==e.vnodeSelector){var g=e.properties;if(!(g&&(void 0===g.key?g.bind:g.key)))for(g=0;g<a.length;g++)if(g!==b&&f(a[g],e))throw"added"===d?Error(c.vnodeSelector+
" had a "+e.vnodeSelector+" child added, but there is now more than one. You must add unique key properties to make them distinguishable."):Error(c.vnodeSelector+" had a "+e.vnodeSelector+" child removed, but there were more than one. You must add unique key properties to make them distinguishable.");}},C=function(a,c,d){!function(a,c,d){if(c)for(var e=0;e<c.length;e++)b(c[e],a,void 0,d)}(a,c.children,d);c.text&&(a.textContent=c.text);(function(a,b,c){if(b)for(var d=c.eventHandlerInterceptor,e=Object.keys(b),
f=e.length,g=function(f){f=e[f];var g=b[f];if("className"===f)throw Error('Property "className" is not supported, use "class".');if("class"===f)g.split(/\s+/).forEach(function(b){return a.classList.add(b)});else if("classes"===f){var k=Object.keys(g),m=k.length;for(f=0;f<m;f++){var n=k[f];g[n]&&a.classList.add(n)}}else if("styles"===f)for(k=Object.keys(g),m=k.length,f=0;f<m;f++){var n=k[f],h=g[n];h&&(w(h),c.styleApplyer(a,n,h))}else"key"!==f&&null!==g&&void 0!==g&&(k=typeof g,"function"===k?0===f.lastIndexOf("on",
0)&&(d&&(g=d(f,g,a,b)),"oninput"===f&&function(){var a=g;g=function(b){a.apply(this,[b]);b.target["oninput-value"]=b.target.value}}(),a[f]=g):"string"===k&&"value"!==f&&"innerHTML"!==f?"http://www.w3.org/2000/svg"===c.namespace&&"href"===f?a.setAttributeNS("http://www.w3.org/1999/xlink",f,g):a.setAttribute(f,g):a[f]=g)},k=0;k<f;k++)g(k)})(a,c.properties,d);c.properties&&c.properties.afterCreate&&c.properties.afterCreate.apply(c.properties.bind||c.properties,[a,d,c.vnodeSelector,c.properties,c.children])};
b=function(a,b,c,d){var f,g,k,m,n,h=0,p=a.vnodeSelector,q=b.ownerDocument;if(""===p)f=a.domNode=q.createTextNode(a.text),void 0!==c?b.insertBefore(f,c):b.appendChild(f);else{for(g=0;g<=p.length;++g)k=p.charAt(g),g!==p.length&&"."!==k&&"#"!==k||(m=p.charAt(h-1),n=p.slice(h,g),"."===m?f.classList.add(n):"#"===m?f.id=n:("svg"===n&&(d=e(d,{namespace:"http://www.w3.org/2000/svg"})),void 0!==d.namespace?f=a.domNode=q.createElementNS(d.namespace,n):(f=a.domNode=a.domNode||q.createElement(n),"input"===n&&
a.properties&&void 0!==a.properties.type&&f.setAttribute("type",a.properties.type)),void 0!==c?b.insertBefore(f,c):f.parentNode!==b&&b.appendChild(f)),h=g+1);C(f,a,d)}};c=function(a,g,k){var m=a.domNode,n=!1;if(a===g)return!1;var h=!1;if(""===g.vnodeSelector){if(g.text!==a.text)return a=m.ownerDocument.createTextNode(g.text),m.parentNode.replaceChild(a,m),g.domNode=a,n=!0}else 0===g.vnodeSelector.lastIndexOf("svg",0)&&(k=e(k,{namespace:"http://www.w3.org/2000/svg"})),a.text!==g.text&&(h=!0,void 0===
g.text?m.removeChild(m.firstChild):m.textContent=g.text),h=function(a,e,g,k,m){if(g===k)return!1;g=g||d;k=k||d;for(var n,h=g.length,p=k.length,q=m.transitions,l=n=0,r=!1;l<p;){var v=n<h?g[n]:void 0,I=k[l];if(void 0!==v&&f(v,I))r=c(v,I,m)||r,n++;else{a:{var v=g,D=I;if(""!==D.vnodeSelector)for(var u=n+1;u<v.length;u++)if(f(v[u],D)){v=u;break a}v=-1}if(0<=v){for(;n<v;n++)t(g[n],q),y(g,n,a,"removed");r=c(g[v],I,m)||r;n=v+1}else b(I,e,n<h?g[n].domNode:void 0,m),v=q,I.properties&&(D=I.properties.enterAnimation)&&
("function"==typeof D?D(I.domNode,I.properties):v.enter(I.domNode,I.properties,D)),y(k,l,a,"added")}l++}if(h>n)for(;n<h;n++)t(g[n],q),y(g,n,a,"removed");return r}(g,m,a.children,g.children,k)||h,h=function(a,b,c,d){if(c){for(var e=!1,f=Object.keys(c),g=f.length,k=0;k<g;k++){var m=f[k],n=c[m],h=b[m];if("class"===m){if(h!==n)throw Error('"class" property may not be updated. Use the "classes" property for conditional css classes.');}else if("classes"===m)for(var p=a.classList,q=Object.keys(n),D=q.length,
m=0;m<D;m++){var l=q[m],r=!!n[l];r!==!!h[l]&&(e=!0,r?p.add(l):p.remove(l))}else if("styles"===m)for(p=Object.keys(n),q=p.length,m=0;m<q;m++)D=p[m],l=n[D],l!==h[D]&&(e=!0,l?(w(l),d.styleApplyer(a,D,l)):d.styleApplyer(a,D,""));else if(n||"string"!=typeof h||(n=""),"value"===m)p=a[m],p!==n&&(a["oninput-value"]?p===a["oninput-value"]:n!==h)&&(a[m]=n,a["oninput-value"]=void 0),n!==h&&(e=!0);else if(n!==h){e=typeof n;if("function"===e)throw Error("Functions may not be updated on subsequent renders (property: "+
m+"). Hint: declare event handler functions outside the render() function.");"string"===e&&"innerHTML"!==m?"http://www.w3.org/2000/svg"===d.namespace&&"href"===m?a.setAttributeNS("http://www.w3.org/1999/xlink",m,n):"role"===m&&""===n?a.removeAttribute(m):a.setAttribute(m,n):a[m]!==n&&(a[m]=n);e=!0}}return e}}(m,a.properties,g.properties,k)||h,g.properties&&g.properties.afterUpdate&&g.properties.afterUpdate.apply(g.properties.bind||g.properties,[m,k,g.vnodeSelector,g.properties,g.children]);return h&&
g.properties&&g.properties.updateAnimation&&g.properties.updateAnimation(m,g.properties,a.properties),g.domNode=a.domNode,n};var x=function(a,b){return{update:function(d){if(a.vnodeSelector!==d.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");c(a,d,b);a=d},domNode:a.domNode}};a.h=function(a){var b=arguments[1];if("string"!=typeof a)throw Error();var c,d,e=1;!b||b.hasOwnProperty("vnodeSelector")||
Array.isArray(b)||"object"!=typeof b?b=void 0:e=2;var f=arguments.length;if(f===e+1){var g=arguments[e];"string"==typeof g?c=g:void 0!==g&&null!==g&&1===g.length&&"string"==typeof g[0]&&(c=g[0])}if(void 0===c)for(d=[];e<f;e++)g=arguments[e],null===g||void 0===g||(Array.isArray(g)?h(a,g,d):g.hasOwnProperty("vnodeSelector")?d.push(g):d.push(n(g)));return{vnodeSelector:a,properties:b,children:d,text:""===c?void 0:c,domNode:null}};a.dom={create:function(a,c){return c=e(u,c),b(a,document.createElement("div"),
void 0,c),x(a,c)},append:function(a,c,d){return d=e(u,d),b(c,a,void 0,d),x(c,d)},insertBefore:function(a,c,d){return d=e(u,d),b(c,a.parentNode,a,d),x(c,d)},merge:function(a,b,c){return c=e(u,c),b.domNode=a,C(a,b,c),x(b,c)},replace:function(a,c,d){return d=e(u,d),b(c,a.parentNode,a,d),a.parentNode.removeChild(a),x(c,d)}};a.createCache=function(){var a,b;return{invalidate:function(){a=b=void 0},result:function(c,d){if(a)for(var e=0;e<c.length;e++)a[e]!==c[e]&&(b=void 0);return b||(b=d(),a=c),b}}};a.createMapping=
function(a,b,c){var d=[],e=[];return{results:e,map:function(f){for(var g=f.map(a),k=e.slice(),m=0,n=0;n<f.length;n++){var h=f[n],p=g[n];if(p===d[m])e[n]=k[m],c(h,k[m],n),m++;else{for(var q=!1,l=1;l<d.length+1;l++){var r=(m+l)%d.length;if(d[r]===p){e[n]=k[r];c(f[n],k[r],n);m=r+1;q=!0;break}}q||(e[n]=b(h,n))}}e.length=f.length;d=g}}};a.createProjector=function(b){var c,d=e(u,b);d.eventHandlerInterceptor=function(a,b,d,e){return function(){return c.scheduleRender(),b.apply(e.bind||this,arguments)}};
var f,g=!0,k=!1,m=[],n=[],h=function(){if(f=void 0,g){g=!1;for(var a=0;a<m.length;a++){var b=n[a]();m[a].update(b)}g=!0}};return c={renderNow:h,scheduleRender:function(){f||k||(f=requestAnimationFrame(h))},stop:function(){f&&(cancelAnimationFrame(f),f=void 0);k=!0},resume:function(){k=!1;g=!0;c.scheduleRender()},append:function(b,c){m.push(a.dom.append(b,c(),d));n.push(c)},insertBefore:function(b,c){m.push(a.dom.insertBefore(b,c(),d));n.push(c)},merge:function(b,c){m.push(a.dom.merge(b,c(),d));n.push(c)},
replace:function(b,c){m.push(a.dom.replace(b,c(),d));n.push(c)},detach:function(a){for(var b=0;b<n.length;b++)if(n[b]===a)return n.splice(b,1),m.splice(b,1)[0];throw Error("renderMaquetteFunction was not found");}}}})?f.apply(a,e):f)||(c.exports=d)}})})},"arcgis-components/Component":function(){define(function(){return function(c){function l(a){if(h[a])return h[a].exports;var e=h[a]={i:a,l:!1,exports:{}};return c[a].call(e.exports,e,e.exports,l),e.l=!0,e.exports}var h={};return l.m=c,l.c=h,l.d=function(a,
c,f){l.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:f})},l.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},l.t=function(a,c){if((1&c&&(a=l(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(l.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var d in a)l.d(e,d,function(b){return a[b]}.bind(null,
d));return e},l.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return l.d(c,"a",c),c},l.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},l.p="",l(l.s=328)}({0:function(c,l,h){function a(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}h.d(l,"b",function(){return a});h.d(l,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&
function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},328:function(c,l,h){function a(a){return a.middlewares?function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return function(c,e,f,g){var k=b(c,e,f,g),m=k.dispatch;
c=[];return c=a.map(function(a){return a({getState:k.getState,dispatch:function(a){return m(a)}})}),m=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}.apply(void 0,c)(k.dispatch),d.a({},k,{dispatch:m})}}}.apply(void 0,a.middlewares)(e)(a.reducers,a.renderTrigger,a.jsxFactory,a.initialState):e(a.reducers,a.renderTrigger,a.jsxFactory,a.initialState)}function e(a,b,c,e){var f=e,g=[];c={jsxFactory:c,renderTrigger:b,
dispatch:function(c){f=a(f,c);g.forEach(function(a){return a(f)});b()},receiveUpdateFromParent:function(a){f=d.a({},f,a);g.forEach(function(a){return a(f)})},subscribe:function(a){return g.push(a),function(){var b=g.indexOf(a);g.splice(b,1)}},getState:function(){return f}};return c.dispatch({type:"@@component/INIT"+Math.random().toString(36).substring(7)}),c}function f(a){var b=function(a,b){return Object.keys(a).reduce(function(c,d){return b(a[d])&&(c[d]=a[d]),c},{})}(a,function(a){return"function"==
typeof a});return function(a,c){return void 0===a&&(a={}),function(a,b){return Object.keys(a).reduce(function(c,d){return c[d]=b(a[d],d),c},{})}(b,function(b,d){return b(a[d],c)})}}h.r(l);h.d(l,"newStore",function(){return a});h.d(l,"combineReducers",function(){return f});h.d(l,"middlewares",function(){return b});var d=h(0);c=function(){function b(a,b){this.childComponents={};this.store=a;this.stateTree=a.getState();this.props=b;this.state={};this.tsx=this.tsx.bind(this);this.updateStateTree=this.updateStateTree.bind(this);
a.subscribe(this.updateStateTree)}return b.prototype.tsx=function(b,c,e){var f=Array.prototype.slice.call(arguments).slice(2);if("string"==typeof b)return this.store.jsxFactory.apply(this,[b,c,f]);if(b.prototype&&b.prototype.constructor.name){var f=d.a({},c,{children:f}),g=this.childComponents[f.key];return g?(c.store?g.store.receiveUpdateFromParent(f):(g.componentWillReceiveProps(f),g.props=f),g.render()):(f.store?this.childComponents[f.key]=new b(a({reducers:f.store.reducers,initialState:f.store.initialState,
middlewares:f.store.middlewares,renderTrigger:this.store.renderTrigger,jsxFactory:this.store.jsxFactory}),f):this.childComponents[f.key]=new b(this.store,f),this.childComponents[f.key].render())}return b(d.a({},c,{tsx:this.tsx,children:f}))},b.prototype.componentWillReceiveProps=function(a){},b.prototype.setState=function(a){this.state=d.a({},this.state,a);this.store.renderTrigger()},b.prototype.dispatch=function(a){this.store.dispatch(a)},b.prototype.updateStateTree=function(a){this.stateTree=a},
b}();l.default=c;var b={thunk:function(a){return function(b){return function(c){return"function"==typeof c?c(a.dispatch,a.getState):b(c)}}},debug:function(a){return function(a){return function(b){return a(b)}}},addListener:function(a){return function(b){return function(c){return function(d){var e=c(d);return a(d,b.getState()),e}}}}};void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var a=/function\s([^(]{1,})\(/.exec(this.toString());
return a&&1<a.length?a[1].trim():""},set:function(a){}})}})})},"arcgis-components/ItemBrowser/index":function(){define("../Component dojo/i18n!../ItemBrowser/nls/resources dojo/promise/all dojo/Deferred ../Buttons/SvgButton dojo/date/locale ../Loaders/LoaderBars ../Buttons/IconButton ../Filters/CategoriesFilter/index ../Buttons/Toggle ../Dropdowns/TextOptionDropdown ../Dropdowns/AccordionDropdown/index ../Badges/Authoritative ../Badges/Deprecated ../Badges/LivingAtlas ../Badges/Marketplace ../Badges/OpenData ../Badges/Premium ../Badges/Subscriber ../Filters/CreatedFilter/index ../Filters/FolderFilter/index ../Filters/GroupFilter/index ../Filters/ItemTypeFilter/index ../Filters/ModifiedFilter/index ../Filters/SharedFilter/index ../Filters/StatusFilter/index ../Filters/MapAreaFilter ../ItemCards/MiniCard/index ../ItemCards/MiniCardRow/index ../Navigation/Pager/index ../Dropdowns/SortDropdown/index dojo/_base/kernel dojo/debounce ../Dropdowns/FilterController/index ../Filters/TagsFilter/index ../Navigation/TabNav ../ItemCards/AnalysisCard/index ../Modals/MobileWrap ../Modals/Overlay".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q,U,S,G){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",
{value:!0})},b.t=function(a,c){if((1&c&&(a=b(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=366)}([function(a,
b,c){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}c.d(b,"b",function(){return d});c.d(b,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,
e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},function(a,b,c){var d=c(28);c.d(b,"d",function(){return d.a});c.d(b,"e",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});var e=c(10);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"g",function(){return e.c});var f=c(34);c.d(b,"c",function(){return f.a});c.d(b,"f",function(){return f.b});
c.d(b,"h",function(){return f.c});c.d(b,"i",function(){return f.d});c.d(b,"j",function(){return f.e})},function(a,b,c){c.d(b,"k",function(){return g});var d=c(191);c.d(b,"f",function(){return d.a});c.d(b,"g",function(){return d.b});c.d(b,"h",function(){return d.c});c.d(b,"i",function(){return d.d});c.d(b,"j",function(){return d.e});c.d(b,"U",function(){return d.f});c.d(b,"V",function(){return d.g});c.d(b,"W",function(){return d.h});c.d(b,"ab",function(){return d.i});c.d(b,"bb",function(){return d.j});
c.d(b,"eb",function(){return d.k});c.d(b,"fb",function(){return d.l});c.d(b,"gb",function(){return d.m});c.d(b,"hb",function(){return d.n});c.d(b,"kb",function(){return d.o});c.d(b,"lb",function(){return d.p});c.d(b,"mb",function(){return d.q});c.d(b,"nb",function(){return d.r});c.d(b,"ob",function(){return d.s});c.d(b,"sb",function(){return d.t});c.d(b,"tb",function(){return d.u});c.d(b,"ub",function(){return d.v});c.d(b,"vb",function(){return d.w});c.d(b,"Db",function(){return d.x});c.d(b,"Eb",
function(){return d.y});c.d(b,"Fb",function(){return d.z});c.d(b,"Gb",function(){return d.A});c.d(b,"Vb",function(){return d.B});c.d(b,"Wb",function(){return d.C});c.d(b,"Xb",function(){return d.D});c.d(b,"Yb",function(){return d.E});c.d(b,"Zb",function(){return d.F});c.d(b,"ac",function(){return d.G});c.d(b,"bc",function(){return d.H});c.d(b,"cc",function(){return d.I});c.d(b,"dc",function(){return d.J});c.d(b,"ec",function(){return d.K});c.d(b,"fc",function(){return d.L});c.d(b,"gc",function(){return d.M});
c.d(b,"hc",function(){return d.N});c.d(b,"ic",function(){return d.O});c.d(b,"jc",function(){return d.P});c.d(b,"kc",function(){return d.Q});c.d(b,"lc",function(){return d.R});var e=c(76);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"c",function(){return e.c});c.d(b,"o",function(){return e.d});c.d(b,"p",function(){return e.e});c.d(b,"q",function(){return e.f});c.d(b,"r",function(){return e.g});c.d(b,"s",function(){return e.h});c.d(b,"t",function(){return e.i});c.d(b,"u",
function(){return e.j});c.d(b,"v",function(){return e.k});c.d(b,"w",function(){return e.l});c.d(b,"x",function(){return e.m});c.d(b,"y",function(){return e.n});c.d(b,"z",function(){return e.o});c.d(b,"A",function(){return e.p});c.d(b,"B",function(){return e.q});c.d(b,"C",function(){return e.r});c.d(b,"D",function(){return e.s});c.d(b,"E",function(){return e.t});c.d(b,"H",function(){return e.u});c.d(b,"I",function(){return e.v});c.d(b,"J",function(){return e.w});c.d(b,"K",function(){return e.x});c.d(b,
"L",function(){return e.y});c.d(b,"M",function(){return e.z});c.d(b,"N",function(){return e.A});c.d(b,"O",function(){return e.B});c.d(b,"P",function(){return e.C});c.d(b,"R",function(){return e.D});c.d(b,"X",function(){return e.E});c.d(b,"Y",function(){return e.F});c.d(b,"Z",function(){return e.G});c.d(b,"cb",function(){return e.H});c.d(b,"db",function(){return e.I});c.d(b,"ib",function(){return e.J});c.d(b,"jb",function(){return e.K});c.d(b,"pb",function(){return e.L});c.d(b,"qb",function(){return e.M});
c.d(b,"rb",function(){return e.N});c.d(b,"wb",function(){return e.O});c.d(b,"xb",function(){return e.P});c.d(b,"yb",function(){return e.Q});c.d(b,"Cb",function(){return e.R});c.d(b,"Ib",function(){return e.S});c.d(b,"Jb",function(){return e.T});c.d(b,"Kb",function(){return e.U});c.d(b,"Lb",function(){return e.V});c.d(b,"Mb",function(){return e.W});c.d(b,"Nb",function(){return e.X});c.d(b,"Ob",function(){return e.Y});c.d(b,"Pb",function(){return e.Z});c.d(b,"Qb",function(){return e.ab});c.d(b,"Rb",
function(){return e.bb});c.d(b,"Sb",function(){return e.cb});c.d(b,"mc",function(){return e.db});var f=c(206);c.d(b,"d",function(){return f.a});c.d(b,"e",function(){return f.b});c.d(b,"l",function(){return f.c});c.d(b,"m",function(){return f.d});c.d(b,"n",function(){return f.e});c.d(b,"F",function(){return f.f});c.d(b,"G",function(){return f.g});c.d(b,"Q",function(){return f.h});c.d(b,"S",function(){return f.i});c.d(b,"T",function(){return f.j});c.d(b,"zb",function(){return f.k});c.d(b,"Ab",function(){return f.l});
c.d(b,"Bb",function(){return f.m});c.d(b,"Hb",function(){return f.n});c.d(b,"Tb",function(){return f.o});c.d(b,"Ub",function(){return f.p});c.d(b,"nc",function(){return f.q});c.d(b,"oc",function(){return f.r});c.d(b,"pc",function(){return f.s});var g="CLEAR_SELECTION_STATE"},function(a,b){a.exports=c},function(a,b,c){var d=c(1);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"w",function(){return d.c});c.d(b,"x",function(){return d.d});c.d(b,"y",function(){return d.e});c.d(b,
"A",function(){return d.f});c.d(b,"H",function(){return d.g});c.d(b,"I",function(){return d.h});c.d(b,"J",function(){return d.i});c.d(b,"N",function(){return d.k});c.d(b,"O",function(){return d.l});c.d(b,"P",function(){return d.m});c.d(b,"Q",function(){return d.n});c.d(b,"R",function(){return d.o});var e=c(37);c.d(b,"z",function(){return e.a});c.d(b,"B",function(){return e.b});c.d(b,"C",function(){return e.c});c.d(b,"D",function(){return e.d});c.d(b,"E",function(){return e.e});c.d(b,"F",function(){return e.f});
c.d(b,"G",function(){return e.g});c.d(b,"L",function(){return e.h});c.d(b,"M",function(){return e.i});var f=c(43);c.d(b,"a",function(){return f.a});c.d(b,"b",function(){return f.b});c.d(b,"c",function(){return f.c});c.d(b,"d",function(){return f.d});c.d(b,"e",function(){return f.e});c.d(b,"f",function(){return f.f});c.d(b,"g",function(){return f.g});c.d(b,"h",function(){return f.h});c.d(b,"k",function(){return f.i});c.d(b,"l",function(){return f.j});c.d(b,"m",function(){return f.k});c.d(b,"n",function(){return f.l});
c.d(b,"o",function(){return f.m});c.d(b,"p",function(){return f.n});c.d(b,"q",function(){return f.o});c.d(b,"r",function(){return f.p});c.d(b,"s",function(){return f.q});c.d(b,"t",function(){return f.r});c.d(b,"u",function(){return f.s});c.d(b,"v",function(){return f.t});c.d(b,"K",function(){return f.u})},function(a,b){a.exports=l},function(a,b,c){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,
{query:f.a({f:"json"},c)}).then(function(a){return a.data})}c.d(b,"i",function(){return k});c.d(b,"f",function(){return m});c.d(b,"c",function(){return n});c.d(b,"d",function(){return h});c.d(b,"g",function(){return p});c.d(b,"h",function(){return q});c.d(b,"a",function(){return l});c.d(b,"b",function(){return r});c.d(b,"j",function(){return D});c.d(b,"k",function(){return t});c.d(b,"l",function(){return v});c.d(b,"e",function(){return u});c.d(b,"m",function(){return e});var f=c(0),g=c(11),k=function(a,
b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},m=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},n=function(a,b,c){return e(a,b.restUrl+"/community/groups",{q:c})},h=function(a,b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},p=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},q=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},l=function(a,b,c){return a(b.restUrl+
"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>c.data.start+c.data.num?l(a,b,c.data.start+c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},r=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var k=f.data.provisionedListings.map(function(c){return e(a,
b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},function(a){})});return f.data.total>f.data.start+f.data.num?r(a,b,c,f.data.start+f.data.num).then(function(a){return g(k).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):g(k).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},
D=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},t=function(a,b,c){return e(a,b.restUrl+"/content/users/"+(c||b.user.username))},v=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},u=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"b",function(){return f});var d=c(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},
f=function(a){return d.a({},a,{baseUrl:e(a)})}},,,function(a,b,c){c(30);var d=c(31);c.d(b,"a",function(){return d.a});var e=c(32);c.d(b,"b",function(){return e.a});var f=c(33);c.d(b,"c",function(){return f.a})},function(a,b){a.exports=h},function(b,c){b.exports=a},,function(a,b,c){var d=c(120);c.d(b,"c",function(){return d.a});c.d(b,"d",function(){return d.b});c.d(b,"e",function(){return d.c});c.d(b,"f",function(){return d.d});c.d(b,"g",function(){return d.e});c.d(b,"h",function(){return d.f});var e=
c(121);c.d(b,"b",function(){return e.a});var f=c(198);c.d(b,"a",function(){return f.a})},function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{badges:function(a){var b=[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),
-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?
"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":
b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var m=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===
b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":f?"markup":g?"spatiotemporal":m?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?m||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":
-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===
b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===
b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===
b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===
b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===
b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},function(a,b,c){c.d(b,"a",function(){return e});
var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&
(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},
function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+
(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},,,,,function(a,b,c){var d=c(29);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});c.d(b,"c",function(){return d.c});c.d(b,"d",function(){return d.d});c.d(b,"e",function(){return d.e});c.d(b,"f",function(){return d.f});c.d(b,"g",function(){return d.g})},function(a,b,c){function d(a,b){return m("children","value",a,b)}function e(a,b){return function da(a,b,c,d){var e,f=c[a];return f&&0!==f.length?p.a({},c,(e={},e[a]=f.reduce(function(c,
e){return-1!==d.indexOf(e[b])&&c.push(da(a,b,e,d)),c},[]),e)):p.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?p.a({},b,((c={})[a]=function ja(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(p.a({},c,((d={})[a]=ja(c[a]),d))),b):(b.push(c),b)},[]):ja(b[0][a]):b}(d),c)):b}("children",a)}function g(a,b){return n("children",a,b)}function k(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,
e){return c||k(a,b,e,d)},void 0):void 0}function m(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:m(a,b,e,d.slice(1)):c},void 0)}function n(a,b,c){var d;return c(p.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return n(a,b,c)}):void 0,d)))}function h(a,b,c){return n(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],p.a({},c,{value:d,children:e})}return p.a({},c,{value:d})})}c.d(b,"d",function(){return d});c.d(b,"g",function(){return e});
c.d(b,"e",function(){return f});c.d(b,"f",function(){return g});c.d(b,"a",function(){return k});c.d(b,"b",function(){return m});c.d(b,"c",function(){return h});var p=c(0)},function(a,b,c){console.log},function(a,b,c){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}c.d(b,"a",function(){return d})},function(a,b,c){function d(a){return function aa(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];
return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return aa.call.apply(aa,[b].concat(c,a))}}}c.d(b,"a",function(){return d})},function(a,b,c){c.d(b,"a",function(){return d});var d=function(a){return function(b){13===b.keyCode&&a(b)}}},function(a,b,c){var d=c(35);c.d(b,"a",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});var e=c(36);c.d(b,"b",function(){return e.a});c.d(b,"e",function(){return e.b})},
function(a,b,c){function d(a){return a.filter(function(a){return 0<a.length})}c.d(b,"b",function(){return e});c.d(b,"c",function(){return f});c.d(b,"a",function(){return d});a=c(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},function(a,b,c){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}c.d(b,"a",function(){return d});c.d(b,"b",function(){return f});var e=c(0);a=c(10);
var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},function(a,b,c){var d=c(38);c.d(b,"b",function(){return d.a});c.d(b,"d",function(){return d.b});c.d(b,"i",function(){return d.c});var e=c(40);c.d(b,"a",function(){return e.a});c.d(b,"e",function(){return e.b});c.d(b,"f",function(){return e.c});var f=c(41);c.d(b,"g",function(){return f.a});var g=c(42);c.d(b,"c",function(){return g.a});c.d(b,"h",function(){return g.b})},function(a,b,c){c.d(b,"b",function(){return h});c.d(b,"c",function(){return p});
var d=c(1),e=c(15),f=c(16),g=c(17),k=c(18),m=c(19),n=c(39);c.d(b,"a",function(){return n.a});var h=function(a,b,c){return Object(d.a)(Object(m.a)(a),Object(k.a)(a),Object(g.a)(b),f.a,e.a)(c)},p=Object(d.a)(Object(d.j)("patchedDescription"),Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},function(a,b,c){c.d(b,"a",function(){return d});var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},function(a,b,c){c.d(b,"c",function(){return g});a=c(1);var d=c(7),e=c(20),f=c(21);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});var g=Object(a.a)(e.a,f.a,d.b)},function(a,b,c){c.d(b,"a",
function(){return f});var d=c(1),e=c(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},function(a,b,c){c.d(b,"a",function(){return f});c.d(b,"b",function(){return g});var d=c(1),e=c(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},g=Object(d.a)(Object(d.j)("thumbURI"))},function(a,b,c){var d=c(44);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});
c.d(b,"o",function(){return d.g});c.d(b,"p",function(){return d.h});c.d(b,"q",function(){return d.i});c.d(b,"r",function(){return d.j});c.d(b,"s",function(){return d.k});c.d(b,"t",function(){return d.l});c.d(b,"u",function(){return d.m});var e=c(46);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"c",function(){return e.c});c.d(b,"d",function(){return e.d});c.d(b,"e",function(){return e.e});c.d(b,"f",function(){return e.f});c.d(b,"g",function(){return e.g});c.d(b,"h",function(){return e.h})},
function(a,b,c){var d=c(6);c.d(b,"b",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});c.d(b,"e",function(){return d.d});c.d(b,"f",function(){return d.e});c.d(b,"g",function(){return d.g});c.d(b,"h",function(){return d.h});c.d(b,"i",function(){return d.i});c.d(b,"j",function(){return d.j});c.d(b,"k",function(){return d.k});c.d(b,"l",function(){return d.l});c.d(b,"m",function(){return d.m});var e=c(45);c.d(b,"a",function(){return e.a})},function(a,b,c){c.d(b,
"a",function(){return f});var d=c(12),e=c(6),f=function(a,b,c,f){function g(d){r=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(k,q);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(h,q)}function k(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+r}).then(m,q):q("The content category sets group could not be found.")}function m(c){1===c.results.length&&c.results[0]?Object(e.f)(a,b,c.results[0].id).then(n,
q):q("The item containing the living atlas categories could not be determined.")}function n(a){t=a.categorySchema[0];c.isPortal&&D?p([t]):D&&p([t,D])}function h(a){D={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&t?p([t]):t&&p([t,D])}function p(a){v.resolve({schema:a,id:l})}function q(a){v.reject(a)}
void 0===f&&(f="en");var l,r,t,D,v=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(l=c.results[0].id,Object(e.d)(a,b,l).then(g,q)):q("The living atlas group could not be found.")},q),v}},function(a,b,c){var d=c(47);c.d(b,"a",function(){return d.a});var e=c(48);c.d(b,"d",function(){return e.a});var f=c(49);c.d(b,"e",function(){return f.a});var g=c(50);c.d(b,"f",function(){return g.a});var k=c(51);c.d(b,"g",function(){return k.a});c.d(b,"h",function(){return k.b});
var m=c(52);c.d(b,"b",function(){return m.a});c.d(b,"c",function(){return m.b})},function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},function(a,b,c){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}c.d(b,"a",function(){return e});a=c(1);var e=Object(a.b)(function(a,b,c){var e=
b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},
function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);a=Object(a.b)(function(a,b,c){return b?c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),
e=a("uploaded")},function(a,b){a.exports=e},,,function(a,b){a.exports=f},,function(a,b,c){function d(a){return Object(k.Q)(a,function(a){return a.count&&delete a.count,a})}function e(a,b,c){if(b)return a.counts.filter(function(a){return a.fieldName===c})[0].fieldValues.forEach(function(a){var c=a.count;a=a.value.split("/").slice(1);(a=Object(k.O)(b,a))&&(a.count=c)}),b}function f(a){a=Object(k.N)("categories","title",{title:"root",categories:a});return Object(k.Q)(a,function(a){return g.a({},a,{value:a.value.toLowerCase(),
displayName:a.displayName?a.displayName:a.value,tooltip:a.description?a.description:void 0})}).children}c.d(b,"a",function(){return d});c.d(b,"c",function(){return e});c.d(b,"b",function(){return f});var g=c(0),k=c(4)},function(a,b){a.exports=d},,,,function(a,c){a.exports=b},function(a,b){a.exports=g},,function(a,b){a.exports=k},function(a,b,c){function d(a,b){a=["",{method:"get",query:b.settings.config.addRequestParameters?g.a({f:"json",q:Object(m.b)(b),num:a.num?a.num:b.settings.config.resultsPerQuery,
sortOrder:b.parameters.sort.order,start:a.start?a.start:1},b.settings.config.addRequestParameters()):{f:"json",q:Object(m.b)(b),num:a.num?a.num:b.settings.config.resultsPerQuery,sortOrder:b.parameters.sort.order,start:a.start?a.start:1}}];return Object(k.i)(p(b),q(b),l(b))(a)}function e(a,b){b=["",{method:"get",query:{f:"json",q:Object(m.a)(a),num:0,countFields:b.join(", "),countSize:200}}];return h(a)(b)}function f(a,b){b=["",{method:"get",query:{f:"json",q:Object(m.c)(a,b),num:0,countFields:"tags",
countSize:200}}];return h(a)(b)}c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});c.d(b,"c",function(){return f});var g=c(0),k=c(4),m=c(116),n=c(14),h=function(a){return Object(k.i)(l(a),r(a))},p=Object(k.j)(function(a,b){var c=b[0];b=b[1];a=a.parameters.sort.field;return"relevance"!==a?[c,g.a({},b,{query:g.a({},b.query,{sortField:a})})]:[c,b]}),q=Object(k.j)(function(a,b){var c=b[0];b=b[1];return a.parameters.filter.searchMapArea?(a=a.parameters.extent.area,[c,g.a({},b,{query:g.a({},
b.query,{bbox:a.minx+","+a.miny+","+a.maxx+","+a.maxy})})]):[c,b]}),l=Object(k.j)(function(a,b){b[0];b=b[1];var c=a.parameters,d=c.section,c=c.filter,e=Object(n.b)(a),f=e.restUrl+"/search";if("myGroups"===d&&c.group)f=e.restUrl+"/content/groups/"+c.group.id+"/search",c.groupCategories&&(f=f+"?categories\x3d"+encodeURIComponent(JSON.stringify([c.groupCategories.value])));else if("livingAtlas"===d&&a.results.livingAtlas.groupId)f=e.restUrl+"/content/groups/"+a.results.livingAtlas.groupId+"/search",
c.livingAtlasCategories?(f=f+"?categories\x3d"+encodeURIComponent(JSON.stringify([c.livingAtlasCategories.value])),c.livingAtlasRegion&&(f=f+"\x26categories\x3d"+encodeURIComponent(JSON.stringify([c.livingAtlasRegion.value])))):c.livingAtlasRegion&&(f=f+"?categories\x3d"+encodeURIComponent(JSON.stringify([c.livingAtlasRegion.value])));else if(!c.orgCategories||"myOrganization"!==d&&"myContent"!==d){if(a=Object(n.d)(a.settings.config.customSections,d))Object(n.f)(a)&&c.orgCategories&&(f=f+"?categories\x3d"+
encodeURIComponent(JSON.stringify([c.orgCategories.value]))),(a=Object(n.e)(a))&&(f=e.restUrl+"/content/groups/"+a.id+"/search",c.groupCategories&&(f=f+"?categories\x3d"+encodeURIComponent(JSON.stringify([c.groupCategories.value]))))}else f=f+"?categories\x3d"+encodeURIComponent(JSON.stringify([c.orgCategories.value]));return[f,b]}),r=Object(k.j)(function(a,b){var c=b[0];b=b[1];var d=a.parameters.section,e=Object(n.d)(a.settings.config.customSections,d);return"myGroups"===d&&a.parameters.filter.group||
"livingAtlas"===d&&a.results.livingAtlas.groupId||e&&Object(n.e)(e)?[c,g.a({},b,{query:g.a({},b.query,{countFields:b.query.countFields?b.query.countFields.replace("categories","groupcategories"):void 0})})]:[c,b]})},,,,function(a,b){a.exports=m},function(a,b,c){c.d(b,"b",function(){return g});c.d(b,"a",function(){return k});c.d(b,"c",function(){return m});c.d(b,"d",function(){return n});var d=c(67),e=c(4),f=c(114),g="CHANGE_PAGE_SUCCESS",k="CHANGE_PAGE_FAIL",m="CHANGING_PAGE",n=function(a){return function(b,
c){c=c();b({type:m,payload:a});var n=c.settings.utils,h=n.portal,p=n.iconDir,n=c.settings.utils.request,q=c.settings.config.resultsPerQuery,q=Object(d.b)({num:q,start:q*a-q},c);n(q[0],q[1]).then(Object(f.a)(c),function(a){return b({type:k,payload:{err:a}})}).then(function(c){b({type:g,payload:{organizations:c.data.organizations,displayItems:c.data.results.map(function(a){return Object(e.D)(h,p,a)}),page:a}})},function(a){return b({type:k,payload:{err:a}})})}}},,,,function(a,b,c){var d=c(197);c.d(b,
"d",function(){return d.a});c.d(b,"e",function(){return d.b});c.d(b,"x",function(){return d.c});c.d(b,"y",function(){return d.d});c.d(b,"z",function(){return d.e});c.d(b,"A",function(){return d.f});c.d(b,"B",function(){return d.g});c.d(b,"C",function(){return d.h});c.d(b,"T",function(){return d.i});c.d(b,"cb",function(){return d.j});var e=c(119);c.d(b,"h",function(){return e.a});c.d(b,"i",function(){return e.b});c.d(b,"j",function(){return e.c});c.d(b,"m",function(){return e.d});c.d(b,"n",function(){return e.e});
c.d(b,"o",function(){return e.f});c.d(b,"Z",function(){return e.g});c.d(b,"bb",function(){return e.h});var f=c(199);c.d(b,"l",function(){return f.a});c.d(b,"J",function(){return f.b});c.d(b,"K",function(){return f.c});c.d(b,"V",function(){return f.d});var g=c(200);c.d(b,"a",function(){return g.a});c.d(b,"b",function(){return g.b});c.d(b,"c",function(){return g.c});c.d(b,"t",function(){return g.d});c.d(b,"u",function(){return g.e});c.d(b,"v",function(){return g.f});c.d(b,"w",function(){return g.g});
c.d(b,"I",function(){return g.h});c.d(b,"P",function(){return g.i});c.d(b,"Q",function(){return g.j});c.d(b,"R",function(){return g.k});c.d(b,"X",function(){return g.l});c.d(b,"ab",function(){return g.m});var k=c(201);c.d(b,"p",function(){return k.a});c.d(b,"L",function(){return k.b});c.d(b,"M",function(){return k.c});c.d(b,"W",function(){return k.d});var m=c(202);c.d(b,"f",function(){return m.a});c.d(b,"D",function(){return m.b});c.d(b,"S",function(){return m.c});var n=c(122);c.d(b,"g",function(){return n.a});
c.d(b,"H",function(){return n.b});var h=c(203);c.d(b,"N",function(){return h.a});c.d(b,"Y",function(){return h.b});var p=c(204);c.d(b,"k",function(){return p.a});c.d(b,"E",function(){return p.b});c.d(b,"F",function(){return p.c});c.d(b,"G",function(){return p.d});c.d(b,"U",function(){return p.e});var q=c(205);c.d(b,"q",function(){return q.a});c.d(b,"r",function(){return q.b});c.d(b,"s",function(){return q.c});c.d(b,"O",function(){return q.d});c.d(b,"db",function(){return q.e})},function(a,b){a.exports=
p},function(a,b){a.exports=q},function(a,b){a.exports=n},function(a,b){a.exports=r},function(a,b){a.exports=v},function(a,b){a.exports=u},function(a,b){a.exports=w},function(a,b){a.exports=t},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(4),g=c(302),k=c(2),m=c(97),n=c.n(m),m=c(90),h=c.n(m),m=c(93),p=c.n(m),m=c(94),q=c.n(m),m=c(95),l=c.n(m),m=c(96),r=c.n(m),m=c(91),t=c.n(m),m=c(92),v=c.n(m),m=c(303),u=c.n(m),m=c(64),D=c.n(m),w=c(304);c=function(a){function b(b,c){b=a.call(this,b,c)||this;
return b.handleCustomFilterToggle=b.handleCustomFilterToggle.bind(b),b.handleMapAreaToggle=b.handleMapAreaToggle.bind(b),b.handleSearchOrgToggle=b.handleSearchOrgToggle.bind(b),b.handleCreatedFilterChange=b.handleCreatedFilterChange.bind(b),b.handleItemTypeFilterChange=b.handleItemTypeFilterChange.bind(b),b.handleModifiedFilterChange=b.handleModifiedFilterChange.bind(b),b.handleSharedFilterChange=b.handleSharedFilterChange.bind(b),b.handleStatusFilterChange=b.handleStatusFilterChange.bind(b),b.handleFolderFilterChange=
b.handleFolderFilterChange.bind(b),b.handleGroupFilterChange=b.handleGroupFilterChange.bind(b),b.handleOrgGroupFilterChange=b.handleOrgGroupFilterChange.bind(b),b.handleTagsFilterChange=b.handleTagsFilterChange.bind(b),b.handleOrgCategorySelect=b.handleOrgCategorySelect.bind(b),b.handleClearOrgCategories=b.handleClearOrgCategories.bind(b),b.handleGroupCategorySelect=b.handleGroupCategorySelect.bind(b),b.handleClearGroupCategories=b.handleClearGroupCategories.bind(b),b.handleLACategorySelect=b.handleLACategorySelect.bind(b),
b.handleClearLACategories=b.handleClearLACategories.bind(b),b.handleLARegionSelect=b.handleLARegionSelect.bind(b),b.handleClearLARegion=b.handleClearLARegion.bind(b),b.handleTagsFilterStringChange=b.handleTagsFilterStringChange.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=this.stateTree.settings.config,d=this.stateTree.parameters.filter,k=this.stateTree.settings.utils.portal.user,m=Object(g.a)(this.stateTree),x=c.enableMapAreaFilter?b(n.a,{handleMapAreaToggle:this.handleMapAreaToggle,
searchMapArea:this.stateTree.parameters.filter.searchMapArea,text:e.filterPane.mapArea}):null,m=m.map(function(g,m){switch(g){case "group":return b(v.a,{key:"group-filter",onGroupSelect:a.handleGroupFilterChange,availableGroups:a.stateTree.results.user.groups,groupFilter:a.stateTree.parameters.filter.group});case "folder":return g=a.stateTree.results.user.folders,m={title:a.stateTree.settings.utils.portal.user.username,id:"root"},b(t.a,{key:"folder-filter",onFolderSelect:a.handleFolderFilterChange,
availableFolders:g?[m].concat(g):[m],folderFilter:a.stateTree.parameters.filter.folder});case "itemType":return b(p.a,{key:"item-type-filter",onItemTypeSelect:a.handleItemTypeFilterChange,availableItemTypes:c.availableItemTypeFilters,itemTypeFilter:a.stateTree.parameters.filter.itemType});case "orgCategories":if((n=a.stateTree.results.organization.categorySchema)&&n.children&&n.children[0]&&n.children[0].children)return b(D.a,{key:"org-categories-filter",onCategorySelect:a.handleOrgCategorySelect,
onClearCategories:a.handleClearOrgCategories,availableCategories:n.children[0].children,categoriesFilter:a.stateTree.parameters.filter.orgCategories,title:e.filterPane.categories,prependValue:"/"+n.children[0].value+"/"});break;case "livingAtlasCategories":if((n=a.stateTree.results.livingAtlas.categorySchema)&&n.children&&n.children[0]&&n.children[0].children)return b(D.a,{key:"la-categories-filter",onCategorySelect:a.handleLACategorySelect,onClearCategories:a.handleClearLACategories,availableCategories:n.children[0].children,
categoriesFilter:a.stateTree.parameters.filter.livingAtlasCategories,title:n.children[0].displayName,prependValue:"/categories/",showTooltips:!0,startActive:!0});break;case "livingAtlasRegion":if((n=a.stateTree.results.livingAtlas.categorySchema)&&n.children&&n.children[1]&&n.children[1].children)return b(D.a,{key:"la-region-filter",onCategorySelect:a.handleLARegionSelect,onClearCategories:a.handleClearLARegion,availableCategories:n.children[1].children,categoriesFilter:a.stateTree.parameters.filter.livingAtlasRegion,
title:n.children[1].displayName,prependValue:"/region/",startActive:!0});break;case "groupCategories":if(d.group&&(n=a.stateTree.results.user.groupCategories[d.group.id])&&n.children&&n.children[0]&&n.children[0].children)return b(D.a,{key:"group-categories-filter",onCategorySelect:a.handleGroupCategorySelect,onClearCategories:a.handleClearGroupCategories,availableCategories:n.children[0].children,categoriesFilter:a.stateTree.parameters.filter.groupCategories,title:e.filterPane.groupCategories,prependValue:"/"+
n.children[0].value+"/"});break;case "orgGroups":break;case "modified":return b(q.a,{key:"modified-filters",onDateModifiedSelect:a.handleModifiedFilterChange,dateModifiedFilter:a.stateTree.parameters.filter.dateModified,dateModifiedSection:a.stateTree.ui.filters.modifiedSection});case "created":return b(h.a,{key:"created-filters",onDateCreatedSelect:a.handleCreatedFilterChange,dateCreatedFilter:a.stateTree.parameters.filter.dateCreated,dateCreatedSection:a.stateTree.ui.filters.createdSection});case "shared":return b(l.a,
{counts:a.stateTree.results.counts.access,key:"shared-filters",onSharedSelect:a.handleSharedFilterChange,sharedFilter:a.stateTree.parameters.filter.shared,hideOrgGroupFilters:!!k&&!k.orgId});case "status":return g=a.stateTree.results.counts.contentStatus,m=g.orgAuthoritative,n=g.publicAuthoritative,b(r.a,{counts:{authoritative:k&&k.orgId?m+n:n,deprecated:g.deprecated},key:"status-filters",onStatusSelect:a.handleStatusFilterChange,statusFilter:a.stateTree.parameters.filter.status});case "tags":return b(u.a,
{availableTags:a.stateTree.ui.tagsFilter.visibleTags,filterString:a.stateTree.ui.tagsFilter.filterString,key:"ib-tags-filter",onFilterStringChange:a.handleTagsFilterStringChange,onTagSelect:a.handleTagsFilterChange,tagsFilter:a.stateTree.parameters.filter.tags});default:if("object"==typeof g)if("group"===g.type){if((n=a.stateTree.results.customSections.groupSchemas[g.id])&&n.children&&n.children[0]&&n.children[0].children)return m=void 0,g.path&&(m=(x=Object(f.y)("children","value",n,g.path))?x.children:
void 0),b(D.a,{key:"custom-group-categories-filter",onCategorySelect:a.handleGroupCategorySelect,onClearCategories:a.handleClearGroupCategories,availableCategories:g.path&&m?m:n.children,categoriesFilter:a.stateTree.parameters.filter.groupCategories,title:g.name,prependValue:"/"+(g.path?g.path.join("/")+"/":"")})}else if("org"===g.type){var n;if((n=a.stateTree.results.customSections.orgSchemas[g.id])&&n.children&&n.children[0]&&n.children[0].children){var x;m=void 0;g.path&&(m=(x=Object(f.y)("children",
"value",n,g.path))?x.children:void 0);return b(D.a,{key:"custom-org-categories-filter",onCategorySelect:a.handleOrgCategorySelect,onClearCategories:a.handleClearOrgCategories,availableCategories:g.path&&m?m:n.children,categoriesFilter:a.stateTree.parameters.filter.orgCategories,title:g.name,prependValue:"/"+(g.path?g.path.join("/")+"/":"")})}}else if(g.children)return n=a.stateTree.parameters.filter.customFilter[m],b(w.a,{key:g.displayName+"-filter-accordion",filter:g,index:m,onClear:a.handleCustomFilterToggle,
onClick:a.handleCustomFilterToggle,selectedOption:n?n.value:void 0})}return null});return x?[x,b("div",{key:"filter-accordion",class:"ib-filter-pane__accordion"},m)]:b("div",{key:"filter-accordion",class:"ib-filter-pane__accordion"},m)},b.prototype.handleCustomFilterToggle=function(a,b,c){this.dispatch(Object(k.Wb)(a,b?{value:b,text:c}:void 0));this.dispatch(Object(k.Rb)())},b.prototype.handleMapAreaToggle=function(){this.dispatch(Object(k.ec)(!this.stateTree.parameters.filter.searchMapArea));this.dispatch(Object(k.Rb)())},
b.prototype.handleSearchOrgToggle=function(){this.dispatch(Object(k.ic)(!this.stateTree.parameters.filter.searchOrg));this.dispatch(Object(k.Rb)())},b.prototype.handleItemTypeFilterChange=function(a){this.dispatch(Object(k.bc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleModifiedFilterChange=function(a,b){this.dispatch(Object(k.fc)(a,b));this.dispatch(Object(k.Rb)())},b.prototype.handleCreatedFilterChange=function(a,b){this.dispatch(Object(k.Vb)(a,b));this.dispatch(Object(k.Rb)())},b.prototype.handleSharedFilterChange=
function(a){this.dispatch(Object(k.jc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleStatusFilterChange=function(a){this.dispatch(Object(k.kc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleFolderFilterChange=function(a){this.dispatch(Object(k.Yb)(a));this.dispatch(Object(k.Rb)(!0))},b.prototype.handleGroupFilterChange=function(a){this.dispatch(Object(k.ac)(a));this.dispatch(Object(k.Rb)(!0))},b.prototype.handleOrgGroupFilterChange=function(a){this.dispatch(Object(k.hc)(a));this.dispatch(Object(k.Rb)())},
b.prototype.handleTagsFilterChange=function(a){this.dispatch(Object(k.lc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleOrgCategorySelect=function(a){var b=this.stateTree.parameters.filter.orgCategories;b&&b.value===a.value?this.dispatch(Object(k.gc)()):this.dispatch(Object(k.gc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleClearOrgCategories=function(){this.dispatch(Object(k.gc)());this.dispatch(Object(k.Rb)())},b.prototype.handleLACategorySelect=function(a){var b=this.stateTree.parameters.filter.livingAtlasCategories;
b&&b.value===a.value?this.dispatch(Object(k.cc)()):this.dispatch(Object(k.cc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleClearLACategories=function(){this.dispatch(Object(k.cc)());this.dispatch(Object(k.Rb)())},b.prototype.handleLARegionSelect=function(a){var b=this.stateTree.parameters.filter.livingAtlasRegion;b&&b.value===a.value?this.dispatch(Object(k.dc)()):this.dispatch(Object(k.dc)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleClearLARegion=function(){this.dispatch(Object(k.dc)());
this.dispatch(Object(k.Rb)())},b.prototype.handleGroupCategorySelect=function(a){var b=this.stateTree.parameters.filter.groupCategories;b&&b.value===a.value?this.dispatch(Object(k.Zb)()):this.dispatch(Object(k.Zb)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleClearGroupCategories=function(){this.dispatch(Object(k.Zb)());this.dispatch(Object(k.Rb)())},b.prototype.handleTagsFilterStringChange=function(a){this.dispatch(Object(k.mc)(a))},b}(a.a);b.a=c},,,,,function(a,b){a.exports=y},function(a,
b){a.exports=C},function(a,b){a.exports=x},function(a,b){a.exports=B},function(a,b){a.exports=z},function(a,b){a.exports=F},function(a,b){a.exports=A},function(a,b){a.exports=E},function(a,b){a.exports=N},function(a,b){a.exports=O},,,,function(a,b){a.exports=K},function(a,b){a.exports=H},,,,,,,,,,function(a,b,c){c.d(b,"a",function(){return m});var d=c(0),e=c(12),f=c(11),g=c(4),k=c(121),m=Object(g.j)(function(a,b){var c=a.settings.utils.request,m=Object(k.a)(a),n=new e,h=b.data.results.filter(function(b){return!!b.orgId&&
!a.results.allOrganizations[b.orgId]}).map(function(a){return a.orgId}).filter(g.I).map(function(a){return Object(g.r)(c,m,a)});return f(h).then(function(a){n.resolve(d.a({},b,{data:d.a({},b.data,{organizations:a.reduce(function(a,b){var c;return d.a({},a,((c={})[b.id]=Object(g.F)(b),c))},{})})}))},function(a){n.reject(a)}),n})},,function(a,b,c){function d(a){return Object(g.i)(Object(g.i)(g.w,n(a),h(a),Object(g.d)(a.parameters.filter.orgGroup),Object(g.f)(a.parameters.filter.status,a.settings.utils.portal.user),
m(a)),Object(g.i)(Object(g.a)(a.parameters.filter.shared),Object(g.b)(a.parameters.filter.dateCreated),Object(g.c)(a.parameters.filter.dateModified),Object(g.e)(g.B,{allowedItemTypes:a.settings.config.allowedItemTypes,itemTypeFilter:a.parameters.filter.itemType,specialItemQ:a.settings.config.specialItemQ}),Object(g.h)(a.parameters.filter.tags)))([a.parameters.searchString.current]).join(" ")}function e(a){return Object(g.i)(g.w,n(a),m(a),Object(g.e)(g.B,{allowedItemTypes:a.settings.config.allowedItemTypes,
specialItemQ:a.settings.config.specialItemQ}))([a.parameters.searchString.current]).join(" ")}function f(a,b){return Object(g.i)(g.w,n(a),m(a),Object(g.e)(g.B,{allowedItemTypes:a.settings.config.allowedItemTypes,specialItemQ:a.settings.config.specialItemQ}),Object(g.g)(b))([a.parameters.searchString.current]).join(" ")}c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});c.d(b,"c",function(){return f});var g=c(4),k=c(14),m=Object(g.j)(function(a,b){a.parameters.section;var c=a.parameters.filter,
d=a.settings.config,e=Object(k.b)(a);switch(a.parameters.section){case "myContent":return e.user?e.user&&c.folder?b.concat(["(owner:"+e.user.username+") (ownerfolder:"+c.folder.id+")"]):b.concat(["(owner:"+e.user.username+")"]):b;case "myFavorites":return e.user?b.concat(["(group:"+e.user.favGroupId+")"]):b;case "myGroups":if(a.results.user.groups){if(a.parameters.filter.group)return b.concat(["(group:"+a.parameters.filter.group.id+")"]);c=a.results.user.groups.map(function(a){return a.id});return b.concat(["(group:"+
c.join(" OR group:")+")"])}return b;case "myOrganization":return b.concat(["(orgid:"+e.id+")"]);case "subscription":return b.concat(["("+a.results.user.provisionedContent.map(function(a){return"id:"+a}).join(" OR ")+")"]);case "all":return b;default:return(c=d.customSections.filter(function(b){return a.parameters.section===b.name})[0])?b.concat([c.baseQuery]):b}}),n=Object(g.j)(function(a,b){var c=a.settings.config.addQueryParameters;return c&&"function"==typeof c?b.concat([c(a)]):b}),h=Object(g.j)(function(a,
b){var c=Object(k.d)(a.settings.config.customSections,a.parameters.section);if(c&&!Object(g.A)(a.parameters.filter.customFilter)){var d=Object.keys(a.parameters.filter.customFilter).filter(function(b){return!!a.parameters.filter.customFilter[b]}).reduce(function(b,d){d=parseInt(d,10);var e=a.parameters.filter.customFilter[d].value;return c.filters&&c.filters[d]&&(d=Object(g.x)("children","value",c.filters[d],e))?b.concat(["("+d.q+")"]):b},[]).join(" AND ");return b.concat([""+d])}return b})},function(a,
b,c){c.d(b,"a",function(){return f});c.d(b,"b",function(){return g});c.d(b,"c",function(){return k});a=c(3);b=c(129);var d=c(151),e=c(158);c=c(173);var f=b.b.config,g={parameters:d.b,settings:b.b,results:e.b,ui:c.b},k=Object(a.combineReducers)({settings:b.a,parameters:d.a,results:e.a,ui:c.a})},,function(a,b,c){function d(a,b,c){var d,f,h=b.settings.utils.request,q=Object(g.b)({},b),q=h(q[0],q[1]).then(Object(k.a)(b),function(b){return a({type:r,payload:b})});if(c){d=Object(g.a)(b,["access","contentstatus",
"categories"]);d=h(d[0],d[1]);c=b.settings.config.customSections;var t=b.parameters.section;if(Object(p.a)(t)||Object(p.g)(c,t)&&Object(p.a)(Object(p.d)(c,t)))f=Object(g.c)(b,b.ui.tagsFilter.filterString),f=h(f[0],f[1])}h=[q,d,f].filter(function(a){return!!a});m(h).then(function(c){return a(function(a,b){var c=a.settings.utils.iconDir,d=Object(p.b)(a);return{type:l,payload:{search:e.a({},b[0].data,{results:b[0].data.results.map(function(a){return Object(n.D)(d,c,a)})}),aggregations:b[1]&&b[1].data&&
b[1].data.aggregations?{counts:b[1].data.aggregations.counts.slice().concat(b[2]&&b[2].data&&b[2].data.aggregations?b[2].data.aggregations.counts.slice():[]),countInfo:{section:a.parameters.section,group:a.parameters.filter.group,custom:a.settings.config.customSections.filter(function(b){return b.name===a.parameters.section})[0]}}:void 0}}}(b,c))},function(b){return a({type:r,payload:b})})}c.d(b,"a",function(){return q});c.d(b,"c",function(){return l});c.d(b,"b",function(){return r});c.d(b,"d",function(){return t});
c.d(b,"f",function(){return v});c.d(b,"e",function(){return u});c.d(b,"g",function(){return w});c.d(b,"h",function(){return D});var e=c(0),f=c(76),g=c(67),k=c(114),m=c(11),n=c(4),h=c(2),p=c(14),q="LOADING_CONTENT",l="LOADING_CONTENT_SUCCESS",r="LOADING_CONTENT_FAILED",t="LOADING_NEXT",v="LOADING_NEXT_SUCCESS",u="LOADING_NEXT_FAILED",w=function(a){return function(b,c){var d=c();c=d.settings.utils.request;var e=d.parameters.nextQuery.nextStart;b({type:t});e=Object(g.b)({num:a,start:e},d);c(e[0],e[1]).then(Object(k.a)(d),
function(a){return b({type:u,payload:a})}).then(function(a){return b(y(d,a))},function(a){return b({type:u,payload:a})})}},D=function(a){return function(b,c){c=c();b({type:q});c.settings.config.clearSelectionBetweenSearches&&b({type:f.d});b(x(a))}},x=function(a){return function(b,c){var e=c(),f=e.parameters.section,g=e.settings.utils.portal.user,k=!!g;b(Object(h.Ob)()).then(function(n){"livingAtlas"===f?b(Object(h.Lb)(n)).then(function(){return d(b,c(),a)},function(){return b({type:r,payload:"Couldn't load the living atlas info."})}):
"myContent"!==f&&"myGroups"!==f&&"myFavorites"!==f&&"subscription"!==f||!k?"myOrganization"===f&&k?b(Object(h.Mb)()).then(function(){return d(b,c(),a)},function(){return b({type:r,payload:"Couldn't load the organization info."})}):Object(p.g)(e.settings.config.customSections,f)?b(Object(h.Kb)()).then(function(){return d(b,c(),a)},function(){return b({type:r,payload:"Couldn't load the custom section info."})}):d(b,e,a):m([b(Object(h.Nb)())].concat(k&&g.orgId?[b(Object(h.Mb)())]:[])).then(function(){return d(b,
c(),a)},function(){return b({type:r,payload:"Couldn't load the user info."})})})}},y=function(a,b){var c=a.settings.utils.iconDir,d=Object(p.b)(a);return{type:v,payload:e.a({},b.data,{results:b.data.results.map(function(a){return Object(n.D)(d,c,a)})})}}},function(a,b,c){function d(a){return!!k(a)||!!m(a)}function e(a,b){return a.filter(function(a){return a.name===b})[0]}function f(a,b){return!!e(a,b)}c.d(b,"a",function(){return g});c.d(b,"c",function(){return k});c.d(b,"d",function(){return m});
c.d(b,"f",function(){return d});c.d(b,"b",function(){return e});c.d(b,"e",function(){return f});a=c(4);var g=function(a){return a.filters?a.filters.filter(function(a){return"object"==typeof a&&("group"===a.type||"org"===a.type)}):[]};a=Object(a.j)(function(a,b){if(b.filters)return b.filters.reduce(function(b,c){return"object"==typeof c&&c.type===a?c:b},void 0)});var k=a("group"),m=a("org")},function(a,b,c){function d(a){var b=Object(e.b)(a.settings.config.customSections,a.parameters.section);return b&&
b.portal?Object(f.E)(b.portal):a.settings.utils.portal}c.d(b,"a",function(){return d});var e=c(120),f=c(4)},function(a,b,c){c.d(b,"b",function(){return m});c.d(b,"a",function(){return n});c.d(b,"c",function(){return h});var d=c(0),e=c(11),f=c(12),g=c(4),k=c(14),m="UPDATE_FULL_ITEM_DETAILS",n="FETCH_FULL_ITEM_DETAILS_FAILED",h=function(a){return function(b,c){var h=c(),p=Object(k.b)(h),q=h.settings.utils.request;c=[];c.push(Object(g.t)(q,p,a.owner).then(function(a){return Object(g.G)(p,a)},function(a){throw a;
}));var l=p.restUrl+"/content/items/"+a.id;p.user&&a.owner===p.user.username&&(l=p.restUrl+"/content/users/"+p.user.username+"/items/"+a.id);c.push(Object(g.K)(q,l).then(function(a){if(a.item&&a.sharing){var b=new f;return Object(g.K)(q,p.restUrl+"/community/groups",{q:"id: "+a.sharing.groups.map(function(a){return'"'+a+'"'}).join(" OR ")}).then(function(c){return b.resolve(d.a({},Object(g.D)(p,h.settings.utils.iconDir,a.item),{sharing:a.sharing,sharedToGroups:c.results}))},function(a){return b.reject(a)}),
b}return Object(g.D)(p,h.settings.utils.iconDir,a)},function(b){throw a.id;}));e(c).then(function(a){b({type:m,payload:{item:a[1],owner:a[0]}})},function(a){b({type:n,payload:a})})}}},function(a,b){a.exports=J},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(296),k=c.n(g),m=c(14),n=c(4),h={itemType:Object(f.bc)(),modified:Object(f.fc)(),created:Object(f.Vb)(),shared:Object(f.jc)(),folder:Object(f.Yb)(),group:Object(f.ac)(),status:Object(f.kc)(),orgGroup:Object(f.hc)()};c=function(a){function b(b,
c){b=a.call(this,b,c)||this;return b.handleRemoveMapAreaFilter=b.handleRemoveMapAreaFilter.bind(b),b.handleRemoveSearchOrgFilter=b.handleRemoveSearchOrgFilter.bind(b),b.handleRemoveGeneralFilter=b.handleRemoveGeneralFilter.bind(b),b.handleRemoveOrgCategoriesFilter=b.handleRemoveOrgCategoriesFilter.bind(b),b.handleRemoveLACategoriesFilter=b.handleRemoveLACategoriesFilter.bind(b),b.handleRemoveLARegionFilter=b.handleRemoveLARegionFilter.bind(b),b.handleRemoveGroupCategoriesFilter=b.handleRemoveGroupCategoriesFilter.bind(b),
b.handleClearAll=b.handleClearAll.bind(b),b.handleRemoveTagsFilter=b.handleRemoveTagsFilter.bind(b),b.handleRemoveCustomFilter=b.handleRemoveCustomFilter.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=this.stateTree.parameters.filter,d=[];if(c.searchOrg&&"all"===this.stateTree.parameters.section&&this.stateTree.settings.utils.portal.user&&this.stateTree.settings.utils.portal.user.credential&&this.stateTree.settings.utils.portal.name&&d.push({filterId:"searchOrg",onRemove:this.handleRemoveSearchOrgFilter,
text:"Organization: "+this.stateTree.settings.utils.portal.name}),c.searchMapArea&&d.push({filterId:"searchMapArea",onRemove:this.handleRemoveMapAreaFilter,text:e.filterChips.mapArea}),c.itemType&&d.push({filterId:"itemType",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.type+": "+c.itemType.text}),c.dateModified&&d.push({filterId:"modified",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.dateModified+": "+c.dateModified.label}),c.dateCreated&&d.push({filterId:"created",onRemove:this.handleRemoveGeneralFilter,
text:e.filterChips.dateCreated+": "+c.dateCreated.label}),c.shared&&d.push({filterId:"shared",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.access+": "+c.shared.text}),c.group&&"myGroups"===this.stateTree.parameters.section?d.push({filterId:"group",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.group+": "+c.group.title}):c.orgGroup&&"myOrganization"===this.stateTree.parameters.section&&d.push({filterId:"orgGroup",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.group+
": "+c.orgGroup.title}),c.folder&&"myContent"===this.stateTree.parameters.section&&d.push({filterId:"folder",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.folder+": "+c.folder.title}),c.status&&d.push({filterId:"status",onRemove:this.handleRemoveGeneralFilter,text:e.filterChips.status+": "+c.status.text}),c.orgCategories){var f=c.orgCategories;d.push({filterId:f.value,onRemove:this.handleRemoveOrgCategoriesFilter,text:e.filterChips.category+": "+f.text})}c.livingAtlasCategories&&(f=c.livingAtlasCategories,
d.push({filterId:f.value,onRemove:this.handleRemoveLACategoriesFilter,text:e.filterChips.category+": "+f.text}));c.groupCategories&&(f=c.groupCategories,d.push({filterId:f.value,onRemove:this.handleRemoveGroupCategoriesFilter,text:e.filterChips.category+": "+f.text}));c.livingAtlasRegion&&(f=c.livingAtlasRegion,d.push({filterId:f.value,onRemove:this.handleRemoveLARegionFilter,text:e.filterChips.region+": "+f.text}));c.tags&&Object.keys(c.tags).forEach(function(b){d.push({filterId:b,onRemove:a.handleRemoveTagsFilter,
text:e.filterChips.tagged+": "+b})});var g=Object(m.d)(this.stateTree.settings.config.customSections,this.stateTree.parameters.section);return g&&!Object(n.A)(c.customFilter)&&Object.keys(c.customFilter).filter(function(a){return!!c.customFilter[a]}).forEach(function(b){var e=parseInt(b,10);g.filters&&g.filters[e]&&d.push({filterId:""+e,onRemove:a.handleRemoveCustomFilter,text:g.filters[e].displayName+": "+c.customFilter[b].text})}),0<d.length?b("div",{key:"active-filter-area",class:"ib__active-filters"},
b(k.a,{key:"item-browser-filter-controller",filters:d.sort(function(a,b){return a.text.localeCompare(b.text)}),onClear:this.handleClearAll,mode:"light"===this.props.theme?"full-width":"expanding",startOpen:"light"!==this.props.theme,theme:this.props.theme})):null},b.prototype.stub=function(){},b.prototype.handleRemoveCustomFilter=function(a){this.dispatch(Object(f.Wb)(parseInt(a.target.value,10)));this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveGeneralFilter=function(a){this.dispatch(h[a.target.value]);
this.dispatch(Object(f.Rb)("folder"===a.target.value))},b.prototype.handleRemoveMapAreaFilter=function(a){this.dispatch(Object(f.ec)(!1));this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveSearchOrgFilter=function(a){this.dispatch(Object(f.ic)(!1));this.dispatch(Object(f.Rb)())},b.prototype.handleClearAll=function(){var a=!!this.stateTree.parameters.filter.folder;this.dispatch({type:f.j});this.dispatch(Object(f.Rb)(a))},b.prototype.handleRemoveOrgCategoriesFilter=function(a){this.dispatch(Object(f.gc)());
this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveLACategoriesFilter=function(a){this.dispatch(Object(f.cc)());this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveGroupCategoriesFilter=function(a){this.dispatch(Object(f.Zb)());this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveLARegionFilter=function(a){this.dispatch(Object(f.dc)());this.dispatch(Object(f.Rb)())},b.prototype.handleRemoveTagsFilter=function(a){var b=this.stateTree.parameters.filter.tags;b&&b[a.target.value]&&(b=d.a({},
b),delete b[a.target.value],0<Object.keys(b).length?this.dispatch(Object(f.lc)(b)):this.dispatch(Object(f.lc)()),this.dispatch(Object(f.Rb)()))},b}(a.a);b.a=c},,,,,function(a,b,c){c.d(b,"b",function(){return e});a=c(3);var d=c(149);c=c(150);var e={config:d.b,utils:c.b};b.a=Object(a.combineReducers)({config:d.a,utils:c.a})},,,,,,,,,,,,,,,,,,,,function(a,b,c){c.d(b,"b",function(){return g});a=c(5);var d=c(2),e=c(4),f=c(14),g={asynchronousItemSelect:!1,dialogTitle:"Item Browser",disableMainAction:!1,
mainActionTitle:a.itemDetails.addToMap,mainInverseActionTitle:a.itemDetails.removeFromMap,onSelect:function(){},onDeselect:function(){},baseSections:"all myContent myFavorites myGroups myOrganization livingAtlas".split(" "),layoutMode:"adjustable",detailsPaneType:"flyout",singleItemSelect:!1,enableMapAreaFilter:!0,mapAreaThrottleTime:2500,enableSelectAllItemsFromQuery:!1,showSubmitButton:!0,submitButtonText:"Submit Selection",clearSelectionBetweenSearches:!1,resultsPerQuery:10,allowedItemTypes:"Web Map;CityEngine Web Scene;Web Scene;360 VR Experience;Pro Map;Feature Service;Map Service;Image Service;KML;KML Collection;WFS;WMTS;Feature Collection;Feature Collection Template;Vector Tile Service;Scene Service;Relational Database Connection;Web Mapping Application;Mobile Application;Code Attachment;Operations Dashboard Add In;Native Application;Native Application Template;Native Application Installer;Workforce Project;Form;Insights Workbook;Insights Model;Insights Page;Dashboard;Hub Initiative;Hub Site Application;Hub Page;AppBuilder Widget Package;Symbol Set;Color Set;Shapefile;File Geodatabase;CSV;CAD Drawing;Service Definition;Microsoft Word;Microsoft Powerpoint;Microsoft Excel;PDF;Image;Visio Document;iWork Keynote;iWork Pages;iWork Numbers;Report Template;Statistical Data Collection;Map Document;Map Package;Mobile Basemap Package;Mobile Map Package;Tile Package;Vector Tile Package;Project Package;Task File;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package;Pro Map;Layout;Project Template;Layer;Layer;Layer Package;Explorer Layer;Scene Package;Image Collection;Desktop Style;Geoprocessing Package;Geoprocessing Package (Pro version);Geoprocessing Sample;Locator Package;Rule Package;Raster function template;ArcGIS Pro Configuration;Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In;ArcGIS Pro Add In;Geometry Service;Geocoding Service;Network Analysis Service;Geoprocessing Service;Workflow Manager Service".split(";"),
availableItemTypeFilters:"maps webMaps mapFiles layers featureLayers tileLayers mapImageLayers imageryLayers sceneLayers tables layerFiles scenes apps webApps mobileApps desktopApps tools locators geodatabaseAccess geometricOperations geoprocessingTasks networkAnalysis files documents images pdfs notebooks".split(" "),disableItemTypeFilters:!1,customActions:[],customSections:[],showCloseBtn:!1,showBackBtn:!0,onBack:function(){},hideEllipses:!1,replaceSectionDropdownWithTitle:!1};b.a=function(a,b){switch(void 0===
a&&(a=g),b.type){case d.X:return Object(e.J)("id",a.customSections.filter(f.h).map(f.c).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return"object"==typeof a&&"group"===a.type})).forEach(function(a,c){a.id=b.payload.groups[c].id;delete a.fetchGroupIdByQuery}),a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return g});var d=c(0),e=c(2),f=c(4),g={iconDir:"",portal:{},request:function(a){return null}};b.a=function(a,b){switch(void 0===a&&(a=g),b.type){case e.rb:return d.a({},
a,{self:b.payload.self});default:return a.portal.portalHostname&&!a.portal.baseUrl&&(a.portal.baseUrl=Object(f.z)(a.portal)),a}}},function(a,b,c){c.d(b,"b",function(){return m});a=c(3);var d=c(152),e=c(153),f=c(154),g=c(155),k=c(156);c=c(157);var m={extent:d.b,filter:e.b,nextQuery:f.b,searchString:k.b,section:c.b,sort:g.b};b.a=Object(a.combineReducers)({extent:d.a,filter:e.a,nextQuery:f.a,searchString:k.a,section:c.a,sort:g.a})},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f=
{area:{minx:-180,miny:-90,maxx:180,maxy:90},throttling:!1};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.U:return d.a({},a,{throttling:!1});case e.ab:return{area:b.payload,throttling:!0};default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={customFilter:{},searchMapArea:!1};b.a=function(a,b){var c;switch(void 0===a&&(a=f),b.type){case e.j:return{customFilter:{},searchMapArea:!1};case e.ob:return d.a({},a,{orgGroup:b.payload});case e.kb:return d.a({},
a,{livingAtlasRegion:b.payload});case e.hb:return d.a({},a,{livingAtlasCategories:b.payload});case e.nb:return d.a({},a,{orgCategories:b.payload});case e.eb:return d.a({},a,{groupCategories:b.payload});case e.gb:return d.a({},a,{itemType:b.payload});case e.mb:return d.a({},a,{dateModified:b.payload.modified});case e.V:return d.a({},a,{dateCreated:b.payload.created});case e.tb:return d.a({},a,{shared:b.payload});case e.bb:return d.a({},a,{folder:b.payload});case e.fb:return d.a({},a,{groupCategories:void 0,
group:b.payload});case e.ub:return d.a({},a,{status:b.payload});case e.lb:return d.a({},a,{searchMapArea:b.payload});case e.sb:return d.a({},a,{searchOrg:b.payload,orgCategories:void 0});case e.vb:return d.a({},a,{tags:b.payload});case e.W:return d.a({},a,{customFilter:d.a({},a.customFilter,(c={},c[b.payload.index]=b.payload.filter,c))});case e.f:return{customFilter:{},searchMapArea:!1};default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={nextStart:-1,total:0};
b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.s:return d.a({},a,{total:0});case e.u:return{nextStart:b.payload.search.nextStart,total:b.payload.search.total};case e.z:return{nextStart:b.payload.nextStart,total:b.payload.total};default:return a}}},function(a,b,c){c.d(b,"b",function(){return k});var d=c(0),e=c(2),f=c(14),g=c(4),k={field:"relevance",order:"desc"},m={myContent:"modified",myFavorites:"relevance",myGroups:"relevance",myOrganization:"relevance",livingAtlas:"relevance",all:"relevance"},
n={relevance:"desc",title:"asc",created:"desc",owner:"asc",modified:"desc",numviews:"desc",avgrating:"desc"};b.a=function(a,b){switch(void 0===a&&(a=k),b.type){case e.i:return d.a({},a,{order:b.payload});case e.h:return b=b.payload,{field:b,order:n[b]?n[b]:a.order};case e.f:return(a=Object(f.d)(b.payload.customSections,b.payload.newSection))&&a.filters&&(a=a.filters.filter(function(a){return"object"==typeof a&&"group"===a.type})[0])&&a.id&&(a=b.payload.customSectionGroupSort[a.id])?a:{field:m[b.payload.newSection]||
"relevance",order:"desc"};case e.X:var c=b.payload,h=c.customSections;return(c=Object(f.d)(h,c.currentSection))&&c.filters&&(h=Object(g.J)("id",h.filter(f.h).map(f.c).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return"object"==typeof a&&"group"===a.type})),c=c.filters.filter(function(a){return"object"==typeof a&&"group"===a.type})[0],b=b.payload.groups[h.indexOf(c)])?{field:b.sortField?b.sortField:"relevance",order:b.sortOrder?b.sortOrder:"desc"}:a;default:return a}}},function(a,
b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={current:"",previous:""};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.s:return d.a({},a,{previous:a.current});case e.g:return d.a({},a,{current:b.payload});default:return a}}},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e="all";b.a=function(a,b){switch(void 0===a&&(a=e),b.type){case d.f:return b.payload.newSection;case d.rb:var c=b.payload.config.baseSections;b=b.payload.config.customSections.map(function(a){return a.name});
return-1<c.indexOf(a)||-1<b.indexOf(a)?a:0<c.length?c[0]:0<b.length?b[0]:"all";default:return a}}},function(a,b,c){c.d(b,"b",function(){return r});a=c(3);var d=c(159),e=c(162),f=c(163),g=c(164),k=c(165),m=c(166),n=c(167),h=c(168),p=c(169),q=c(170),l=c(171);c=c(172);var r={counts:d.b,displayItems:e.b,livingAtlas:f.b,loadingItems:g.b,selectedItems:k.b,failedItemDetails:n.b,fullItemDetails:m.b,organization:h.b,user:p.b,customSections:q.b,allOrganizations:l.b,users:c.b};b.a=Object(a.combineReducers)({counts:d.a,
displayItems:e.a,loadingItems:g.a,selectedItems:k.a,failedItemDetails:n.a,fullItemDetails:m.a,livingAtlas:f.a,organization:h.a,user:p.a,customSections:q.a,allOrganizations:l.a,users:c.a})},function(a,b,c){c.d(b,"b",function(){return e});a=c(3);var d=c(160);c=c(161);var e={access:d.b,contentStatus:c.b};b.a=Object(a.combineReducers)({access:d.a,contentStatus:c.a})},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e={org:void 0,private:void 0,public:void 0,shared:void 0};b.a=function(a,b){switch(void 0===
a&&(a=e),b.type){case d.u:if(b.payload.aggregations&&b.payload.aggregations.counts&&(b=b.payload.aggregations.counts.filter(function(a){return"access"===a.fieldName})[0])){a=b.fieldValues.filter(function(a){return"account"===a.value})[0];var c=b.fieldValues.filter(function(a){return"private"===a.value})[0],f=b.fieldValues.filter(function(a){return"public"===a.value})[0];b=b.fieldValues.filter(function(a){return"shared"===a.value})[0];return{org:a?a.count:void 0,private:c?c.count:void 0,public:f?f.count:
void 0,shared:b?b.count:void 0}}return a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e={publicAuthoritative:0,orgAuthoritative:0,deprecated:0};b.a=function(a,b){switch(void 0===a&&(a=e),b.type){case d.u:if(b.payload.aggregations&&b.payload.aggregations.counts&&(b=b.payload.aggregations.counts.filter(function(a){return"contentstatus"===a.fieldName})[0])){a=b.fieldValues.filter(function(a){return"org_authoritative"===a.value})[0];var c=b.fieldValues.filter(function(a){return"public_authoritative"===
a.value})[0];b=b.fieldValues.filter(function(a){return"deprecated"===a.value})[0];return{publicAuthoritative:c?c.count:0,orgAuthoritative:a?a.count:0,deprecated:b?b.count:0}}return a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e=[];b.a=function(a,b){switch(void 0===a&&(a=[]),b.type){case d.u:return b.payload.search.results;case d.z:return a.concat(b.payload.results);default:return a}}},function(a,b,c){c.d(b,"b",function(){return g});var d=c(0),e=c(2),f=c(58),g={categorySchema:void 0,
groupId:void 0,status:"initial"};b.a=function(a,b){switch(void 0===a&&(a=g),b.type){case e.w:return d.a({},a,{status:"loading"});case e.ib:return d.a({},a,{categorySchema:{displayName:b.payload.id,value:b.payload.id,children:Object(f.b)(b.payload.schema)},groupId:b.payload.id,status:"loaded"});case e.u:return a.categorySchema&&b.payload.aggregations&&b.payload.aggregations.countInfo&&"livingAtlas"===b.payload.aggregations.countInfo.section?d.a({},a,{categorySchema:Object(f.c)(b.payload.aggregations,
Object(f.a)(a.categorySchema),"groupCategories")}):a;case e.jb:return d.a({},a,{status:"failed"});default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){var c,f,g,k,m,n,h,p,q,l,r,t;switch(void 0===a&&(a={}),b.type){case e.N:return d.a({},a,((c={})[b.payload.id]=b.payload,c));case e.M:return d.a({},a,((f={})[b.payload.id]=void 0,f));case e.P:return d.a({},a,((g={})[b.payload.id]=void 0,g));case e.O:return d.a({},a,((k={})[b.payload.id]=void 0,k));
case e.R:return d.a({},a,((m={})[b.payload.id]=b.payload,m));case e.q:return d.a({},a,((n={})[b.payload.id]=void 0,n));case e.k:return{};case e.a:return d.a({},a,((h={})[b.payload.id]=b.payload,h));case e.c:return d.a({},a,((p={})[b.payload.id]=void 0,p));case e.b:return d.a({},a,((q={})[b.payload.id]=void 0,q));case e.H:return d.a({},a,((l={})[b.payload.id]=b.payload,l));case e.J:return d.a({},a,((r={})[b.payload.id]=void 0,r));case e.I:return d.a({},a,((t={})[b.payload.id]=void 0,t));default:return a}}},
function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){var c,f;switch(void 0===a&&(a={}),b.type){case e.o:return{};case e.K:return d.a({},a,b.payload.reduce(function(a,b){var c;return d.a({},a,((c={})[b.id]=b,c))},{}));case e.p:return a=d.a({},a),delete a[b.payload.id],a;case e.M:return d.a({},a,((c={})[b.payload.id]=b.payload,c));case e.P:return(f={})[b.payload.id]=b.payload,f;case e.L:return d.a({},a,b.payload);case e.k:return{};default:return a}}},function(a,b,
c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){var c;switch(void 0===a&&(a=f),b.type){case e.cb:return d.a({},a,((c={})[b.payload.item.id]=b.payload.item,c));case e.r:return a[b.payload]?(a=d.a({},a),delete a[b.payload],a):a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){var c;switch(void 0===a&&(a=f),b.type){case e.cb:return a[b.payload.item.id]?(delete (g=d.a({},a))[b.payload.item.id],g):a;case e.Ab:var g;
return a[b.payload.id]?(delete (g=d.a({},a))[b.payload.id],g):a;case e.r:return d.a({},a,((c={})[b.payload]=!0,c));default:return a}}},function(a,b,c){c.d(b,"b",function(){return g});var d=c(0),e=c(2),f=c(58),g={categorySchema:void 0,groups:void 0,status:"initial"};b.a=function(a,b){switch(void 0===a&&(a=g),b.type){case e.A:return d.a({},a,{status:"loading"});case e.pb:return d.a({},a,{groups:b.payload.groups,categorySchema:{displayName:"##orgCatRoot--1337!",value:"##orgCatRoot--1337!",children:Object(f.b)(b.payload.schema)},
status:"loaded"});case e.u:return a.categorySchema&&b.payload.aggregations&&b.payload.aggregations.countInfo&&("myOrganization"===b.payload.aggregations.countInfo.section||"myContent"===b.payload.aggregations.countInfo.section||"all"===b.payload.aggregations.countInfo.section)?d.a({},a,{categorySchema:Object(f.c)(b.payload.aggregations,Object(f.a)(a.categorySchema),"categories")}):a;case e.qb:return d.a({},a,{status:"failed"});default:return a}}},function(a,b,c){c.d(b,"b",function(){return g});var d=
c(0),e=c(2),f=c(58),g={favorites:void 0,folders:void 0,groups:void 0,groupCategories:{},provisionedContent:[],status:"initial"};b.a=function(a,b){var c,k,m,n,h;switch(void 0===a&&(a=g),b.type){case e.E:return d.a({},a,{status:"loading"});case e.xb:return d.a({},a,{favorites:b.payload.favorites,folders:b.payload.folders,groups:b.payload.groups,provisionedContent:b.payload.provisionedContent,status:"loaded"});case e.db:return d.a({},a,{groupCategories:d.a({},a.groupCategories,(c={},c[b.payload.id]=
{value:b.payload.id,children:Object(f.b)(b.payload.categorySchema)},c))});case e.u:return b.payload.aggregations&&b.payload.aggregations.countInfo&&"myGroups"===b.payload.aggregations.countInfo.section&&b.payload.aggregations.countInfo.group&&(c=b.payload.aggregations.countInfo.group.id,a.groupCategories[c])?d.a({},a,{groupCategories:d.a({},a.groupCategories,(k={},k[c]=Object(f.c)(b.payload.aggregations,Object(f.a)(a.groupCategories[c]),"groupCategories"),k))}):a;case e.yb:return d.a({},a,{status:"failed"});
case e.c:return d.a({},a,{favorites:a.favorites?d.a({},a.favorites,(m={},m[b.payload.id]=!0,m)):(n={},n[b.payload.id]=!0,n)});case e.J:return d.a({},a,{favorites:a.favorites?d.a({},a.favorites,(h={},h[b.payload.id]=!1,h)):{}});default:return a}}},function(a,b,c){function d(a,b){return b.filter(function(b){return b.type===a}).reduce(function(a,b){return a[b.id]={value:b.id,children:Object(g.b)(b.response.categorySchema)},a},{})}c.d(b,"b",function(){return k});var e=c(0),f=c(2),g=c(58),k={groupSchemas:{},
groupSort:{},orgSchemas:{},status:"initial"};b.a=function(a,b){switch(void 0===a&&(a=k),b.type){case f.v:return e.a({},a,{status:"loading"});case f.X:return e.a({},a,{groupSort:b.payload.groups.reduce(function(a,b){return a[b.id]={field:b.sortField,order:b.sortOrder},a},a.groupSort)});case f.Y:return e.a({},a,{orgSchemas:d("org",b.payload),groupSchemas:d("group",b.payload),status:"loaded"});case f.Z:return e.a({},a,{status:"failed"});case f.u:if(b.payload.aggregations){var c=b.payload.aggregations.countInfo;
if(c.custom&&c.custom.filters)return c.custom.filters.filter(function(a){return"object"==typeof a}).reduce(function(c,d){var f,k;return"group"===d.type?e.a({},a,{groupSchemas:e.a({},a.groupSchemas,(f={},f[d.id]=Object(g.c)(b.payload.aggregations,Object(g.a)(a.groupSchemas[d.id]),"groupCategories"),f))}):"org"===d.type?e.a({},a,{orgSchemas:e.a({},a.orgSchemas,(k={},k[d.id]=Object(g.c)(b.payload.aggregations,Object(g.a)(a.orgSchemas[d.id]),"categories"),k))}):c},a)}return a;default:return a}}},function(a,
b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.u:return d.a({},a,b.payload.search.organizations);case e.z:case e.d:return d.a({},a,b.payload.organizations);default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){var c;switch(void 0===a&&(a=f),b.type){case e.cb:return d.a({},a,((c={})[b.payload.owner.username]=b.payload.owner,c));default:return a}}},function(a,b,c){c.d(b,"b",
function(){return m});a=c(3);var d=c(174),e=c(175),f=c(178),g=c(179),k=c(180);c=c(181);var m={sidePanel:d.b,expanded:e.b,resultPanel:f.b,filters:g.b,tagsFilter:k.b,pagination:c.b};b.a=Object(a.combineReducers)({sidePanel:d.a,expanded:e.a,resultPanel:f.a,filters:g.a,tagsFilter:k.a,pagination:c.a})},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={closing:!1,type:"hidden"};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.n:return d.a({},a,{closing:!0});case e.l:return d.a({},
a,{closing:!1,type:"hidden",item:void 0});case e.Ab:return d.a({},a,{type:"item",item:b.payload});case e.zb:return d.a({},a,{type:"filter",item:void 0});case e.Bb:return d.a({},a,{type:"sort",item:void 0});case e.u:return"item"===a.type&&a.item&&!b.payload.search.results.filter(function(b){return a.item&&b.id===a.item.id})[0]?d.a({},a,{closing:!0}):a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return g});a=c(176);var d=c(177),e=c(3),f=c(2),g={filters:a.b,sort:d.b,maximized:!1,closing:!1};
b.a=Object(e.combineReducers)({filters:a.a,sort:d.a,maximized:function(a,b){switch(b.type){case f.F:return!0;case f.G:return!1;default:return a}},closing:function(a,b){switch(b.type){case f.m:return!0;default:return a}}})},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e=!1;b.a=function(a,b){switch(b.type){case d.S:return!a;default:return a}}},function(a,b,c){c.d(b,"b",function(){return e});var d=c(2),e=!1;b.a=function(a,b){switch(b.type){case d.T:case d.h:case d.i:return!a;default:return a}}},
function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={display:"list",status:"empty"};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.t:return d.a({},a,{status:"failed"});case e.u:return d.a({},a,{status:"success"});case e.y:return d.a({},a,{status:"failed"});case e.z:return d.a({},a,{status:"success"});case e.s:return d.a({},a,{status:"loading"});case e.x:return d.a({},a,{status:"loadingNext"});case e.e:return d.a({},a,{display:"table"===a.display?"list":"table"});case e.Q:return d.a({},
a,{status:"empty"});default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0),e=c(2),f={};b.a=function(a,b){switch(void 0===a&&(a=f),b.type){case e.j:return{};case e.mb:return d.a({},a,{modifiedSection:b.payload.section});case e.V:return d.a({},a,{createdSection:b.payload.section});case e.f:return{};default:return a}}},function(a,b,c){c.d(b,"b",function(){return f});var d=c(0);a=c(4);var e=c(2),f={allTags:[],filterString:"",visibleTags:[]};b.a=function(a,b){switch(void 0===a&&
(a=f),b.type){case e.f:return d.a({},a,{filterString:""});case e.wb:return d.a({},a,{filterString:b.payload,visibleTags:a.allTags.filter(function(a){return 0===b.payload.length||-1<a.value.indexOf(b.payload)})});case e.B:return a;case e.D:return b.payload.aggregations&&(c=b.payload.aggregations.counts.filter(function(a){return"tags"===a.fieldName})[0])?(c=g(a.allTags.concat(c.fieldValues)),d.a({},a,{allTags:c,visibleTags:c.filter(function(b){return 0===a.filterString.length||-1<b.value.indexOf(a.filterString)})})):
a;case e.C:return a;case e.u:var c;return b.payload.aggregations&&(c=b.payload.aggregations.counts.filter(function(a){return"tags"===a.fieldName})[0])?(c=g(c.fieldValues),d.a({},a,{allTags:c,visibleTags:c.filter(function(b){return 0===a.filterString.length||-1<b.value.indexOf(a.filterString)})})):a;default:return a}};b=Object(a.J)("value");var g=Object(a.i)(b,function(a){return a.map(function(a){var b=a.count;return{value:a.value.trim(),count:b}})},function(a){return a.sort(function(a,b){return b.count-
a.count})})},function(a,b,c){c.d(b,"b",function(){return g});var d=c(0),e=c(72),f=c(2),g={page:1,displayItems:[],status:"loading"};b.a=function(a,b){switch(b.type){case e.c:return d.a({},a,{status:"loading"});case e.b:return d.a({},a,{displayItems:b.payload.displayItems,page:b.payload.page,status:"success"});case e.a:return d.a({},a,{status:"failed"});case f.u:return d.a({},a,{displayItems:b.payload.search.results,status:"success",page:1});default:return a}}},,,,,,,,,,function(a,b,c){var d=c(192);
c.d(b,"e",function(){return d.a});c.d(b,"g",function(){return d.b});c.d(b,"h",function(){return d.c});c.d(b,"j",function(){return d.d});c.d(b,"k",function(){return d.e});c.d(b,"l",function(){return d.f});c.d(b,"m",function(){return d.g});c.d(b,"n",function(){return d.h});c.d(b,"o",function(){return d.i});c.d(b,"p",function(){return d.j});c.d(b,"q",function(){return d.k});c.d(b,"r",function(){return d.l});c.d(b,"s",function(){return d.m});c.d(b,"t",function(){return d.n});c.d(b,"u",function(){return d.o});
c.d(b,"v",function(){return d.p});c.d(b,"w",function(){return d.q});c.d(b,"B",function(){return d.r});c.d(b,"C",function(){return d.s});c.d(b,"E",function(){return d.t});c.d(b,"F",function(){return d.u});c.d(b,"G",function(){return d.v});c.d(b,"H",function(){return d.w});c.d(b,"I",function(){return d.x});c.d(b,"J",function(){return d.y});c.d(b,"K",function(){return d.z});c.d(b,"L",function(){return d.A});c.d(b,"M",function(){return d.B});c.d(b,"N",function(){return d.C});c.d(b,"O",function(){return d.D});
c.d(b,"P",function(){return d.E});c.d(b,"Q",function(){return d.F});c.d(b,"R",function(){return d.G});var e=c(193);c.d(b,"c",function(){return e.a});c.d(b,"d",function(){return e.b});c.d(b,"z",function(){return e.c});c.d(b,"A",function(){return e.d});var f=c(194);c.d(b,"b",function(){return f.a});c.d(b,"y",function(){return f.b});var g=c(195);c.d(b,"a",function(){return g.a});c.d(b,"x",function(){return g.b});var k=c(196);c.d(b,"f",function(){return k.a});c.d(b,"i",function(){return k.b});c.d(b,"D",
function(){return k.c})},function(a,b,c){c.d(b,"c",function(){return d});c.d(b,"m",function(){return e});c.d(b,"h",function(){return f});c.d(b,"i",function(){return g});c.d(b,"l",function(){return k});c.d(b,"e",function(){return m});c.d(b,"g",function(){return n});c.d(b,"k",function(){return h});c.d(b,"b",function(){return p});c.d(b,"o",function(){return q});c.d(b,"f",function(){return l});c.d(b,"d",function(){return r});c.d(b,"p",function(){return t});c.d(b,"j",function(){return v});c.d(b,"n",function(){return u});
c.d(b,"q",function(){return w});c.d(b,"a",function(){return x});c.d(b,"s",function(){return y});c.d(b,"C",function(){return C});c.d(b,"w",function(){return D});c.d(b,"B",function(){return F});c.d(b,"x",function(){return A});c.d(b,"y",function(){return B});c.d(b,"u",function(){return z});c.d(b,"A",function(){return E});c.d(b,"r",function(){return I});c.d(b,"E",function(){return N});c.d(b,"t",function(){return O});c.d(b,"v",function(){return T});c.d(b,"F",function(){return H});c.d(b,"z",function(){return J});
c.d(b,"D",function(){return K});c.d(b,"G",function(){return L});var d="UPDATE_CUSTOM_FILTER",e="UPDATE_ORG_GROUP_FILTER",f="UPDATE_LIVING_ATLAS_CATEGORIES_FILTER",g="UPDATE_LIVING_ATLAS_REGION_FILTER",k="UPDATE_ORG_CATEGORIES_FILTER",m="UPDATE_GROUP_CATEGORIES_FILTER",n="UPDATE_ITEM_TYPE_FILTER",h="UPDATE_MODIFIED_FILTER",p="UPDATE_CREATED_FILTER",q="UPDATE_SHARED_FILTER",l="UPDATE_GROUP_FILTER",r="UPDATE_FOLDER_FILTER",t="UPDATE_STATUS_FILTER",v="UPDATE_MAP_AREA_FILTER",u="UPDATE_SEARCH_ORG_FILTER",
w="UPDATE_TAGS_FILTER",x="CLEAR_ALL_FILTERS",y=function(a,b){return{type:d,payload:{index:a,filter:b}}},C=function(a){return{type:e,payload:a}},D=function(a){return{type:n,payload:a}},F=function(a){return{type:k,payload:a}},A=function(a){return{type:f,payload:a}},B=function(a){return{type:g,payload:a}},z=function(a){return{type:m,payload:a}},E=function(a,b){return{type:h,payload:{section:a,modified:b}}},I=function(a,b){return{type:p,payload:{section:a,created:b}}},N=function(a){return{type:q,payload:a}},
O=function(a){return{type:r,payload:a}},T=function(a){return{type:l,payload:a}},H=function(a){return{type:t,payload:a}},J=function(a){return{type:v,payload:a}},K=function(a){return{type:u,payload:a}},L=function(a){return{type:w,payload:a}}},function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});c.d(b,"d",function(){return f});c.d(b,"c",function(){return g});var d="CHANGE_SORT_ORDER",e="CHANGE_SORT_FIELD",f=function(a){return{type:d,payload:a}},g=function(a){return{type:e,
payload:a}}},function(a,b,c){c.d(b,"a",function(){return d});c.d(b,"b",function(){return e});var d="CHANGE_SEARCH_STRING",e=function(a){return{type:d,payload:a}}},function(a,b,c){c.d(b,"a",function(){return d});c.d(b,"b",function(){return e});var d="CHANGE_SEARCH_SECTION",e=function(a){return function(b,c){c=c();b({type:d,payload:{newSection:a,customSections:c.settings.config.customSections,customSectionGroupSort:c.results.customSections.groupSort}})}}},function(a,b,c){c.d(b,"b",function(){return e});
c.d(b,"a",function(){return f});c.d(b,"c",function(){return g});var d=c(76),e="UPDATE_EXTENT",f="UNTHROTTLE_EXTENT",g=function(a){return function(b,c){c=c();c.parameters.extent.throttling||(b({type:e,payload:a}),c.parameters.filter.searchMapArea&&b(Object(d.bb)()),setTimeout(function(){b({type:f})},c.settings.config.mapAreaThrottleTime))}}},function(a,b,c){c.d(b,"e",function(){return e});c.d(b,"h",function(){return f});c.d(b,"f",function(){return g});c.d(b,"g",function(){return k});c.d(b,"b",function(){return m});
c.d(b,"c",function(){return n});c.d(b,"a",function(){return h});c.d(b,"d",function(){return p});c.d(b,"j",function(){return q});c.d(b,"i",function(){return l});var d=c(4),e="SELECT_ITEM",f="SELECT_ITEM_SINGLE",g="SELECT_ITEM_ASYNC",k="SELECT_ITEM_ASYNC_FAILED",m="DESELECT_ITEM",n="SELECT_ALL",h="DESELECT_ALL",p="SELECT_ALL_FROM_QUERY_SUCCESS",q=function(a){return function(b,c){var m=c();m.settings.config.asynchronousItemSelect?(b({type:g,payload:a}),(c=m.settings.config.onSelect([Object(d.M)(a)]))&&
c.then&&c.then(function(){m.settings.config.singleItemSelect?b({type:f,payload:a}):b({type:e,payload:a})},function(){b({type:k,payload:a})})):m.settings.config.singleItemSelect?(b({type:f,payload:a}),m.settings.config.onSelect([Object(d.M)(a)])):(b({type:e,payload:a}),m.settings.config.onSelect([Object(d.M)(a)]))}},l=function(a){return function(b,c){c=c();b({type:m,payload:a});c.settings.config.onDeselect([Object(d.M)(a)])}}},function(a,b,c){function d(a){return"string"==typeof a?-1<["myContent",
"myFavorites","myGroups","myOrganization","livingAtlas"].indexOf(a):!!a.filters&&-1<a.filters.indexOf("tags")}c.d(b,"a",function(){return d})},function(a,b,c){c.d(b,"a",function(){return m});c.d(b,"b",function(){return n});c.d(b,"c",function(){return h});c.d(b,"d",function(){return p});var d=c(0),e=c(5),f=c(12),g=c(123),k=c(4),m="LOADING_LIVING_ATLAS_INFO",n="UPDATE_LIVING_ATLAS_INFO",h="FETCH_LIVING_ATLAS_INFO_FAILED",p=function(a){return function(b,c){c=c();if("loaded"===c.results.livingAtlas.status)return(new f).resolve();
if("failed"===c.results.livingAtlas.status)return(new f).reject();b({type:m});c=c.settings.utils;var p=c.portal;return Object(k.k)(c.request,p,a,p.user&&p.user.culture?p.user.culture:g.locale).then(function(a){b({type:n,payload:d.a({},a,{schema:a.schema.map(function(a){return"region"===a.title?d.a({},a,{displayName:e.regions}):a})})})},function(a){b({type:h})})}}},function(a,b,c){c.d(b,"a",function(){return k});c.d(b,"c",function(){return m});c.d(b,"b",function(){return n});c.d(b,"d",function(){return h});
c.d(b,"h",function(){return p});c.d(b,"i",function(){return q});c.d(b,"j",function(){return l});c.d(b,"e",function(){return r});c.d(b,"g",function(){return t});c.d(b,"f",function(){return v});c.d(b,"l",function(){return u});c.d(b,"k",function(){return x});c.d(b,"m",function(){return y});var d=c(11),e=c(12),f=c(4),g=c(119),k="ADD_TO_FAVORITES",m="ADD_TO_FAVORITES_SUCCESS",n="ADD_TO_FAVORITES_FAIL",h="LOADING_USER_INFO",p="UPDATE_GROUP_CATEGORIES",q="UPDATE_USER_INFO",l="UPDATE_USER_INFO_FAILED",r=
"REMOVE_FROM_FAVORITES",t="REMOVE_FROM_FAVORITES_SUCCESS",v="REMOVE_FROM_FAVORITES_FAIL",u=function(){return function(a,b){var c=b();b=c.parameters.filter.group;var g=c.results.user.groupCategories;if("loaded"===c.results.user.status)return b&&!g[b.id]?a(w(b.id)):(new e).resolve();if("failed"===c.results.user.status)return(new e).reject();a({type:h});g=c.settings.utils;c=g.request;g=g.portal;return d([Object(f.t)(c,g).then(function(a){return a.groups.map(function(a){return{id:a.id,title:a.title}})}),
Object(f.u)(c,g).then(function(a){return a.folders.map(function(a){return{id:a.id,title:a.title}})}),Object(f.v)(c,g,g.user.favGroupId).then(function(a){return a.items.reduce(function(a,b){return a[b.id]=!0,a},{})}),Object(f.m)(c,g,g.user.username).then(function(a){return a},function(a){return[]})].concat(b?[a(w(b.id))]:[])).then(function(b){a({type:q,payload:{groups:b[0],folders:b[1],favorites:b[2],provisionedContent:b[3]}})},function(b){a({type:l})})}},w=function(a){return function(b,c){c=c().settings.utils;
return Object(f.o)(c.request,c.portal,a).then(function(c){b({type:p,payload:{id:a,categorySchema:c.categorySchema}})})}},x=function(a){return function(b,c){c=c();var d=c.settings.utils.portal,e=d.restUrl+"/content/items/"+a.id+"/share",d={f:"json",everyone:a.access&&"public"===a.access||a.sharing&&a.sharing.access&&"public"===a.sharing.access,org:a.access&&"org"===a.access||a.sharing&&a.sharing.access&&"org"===a.sharing.access||!1,groups:[d.user.favGroupId],items:[a.id]};b({type:k,payload:a});c.settings.utils.request(e,
{method:"post",query:d}).then(function(c){b({type:m,payload:a})},function(c){b({type:n,payload:a})})}},y=function(a){return function(b,c){var d=c(),e=d.settings.utils.portal,f=e.user.favGroupId,k=e.restUrl+"/content/items/"+a.id+"/unshare",m={f:"json",everyone:!1,org:!1,groups:[f],items:[a.id]};b({type:r,payload:a});d.settings.utils.request(k,{method:"post",query:m}).then(function(k){function m(){b({type:t,payload:a})}"myFavorites"===(d=c()).parameters.section?function va(){d.settings.utils.request(e.restUrl+
"/search",{query:{f:"json",q:"(id:"+a.id+") (group:"+f+")"},method:"get"}).then(function(a){0<a.data.total?setTimeout(function(){va()},250):(m(),b(Object(g.h)()))},function(a){m()})}():m()},function(c){b({type:v,payload:a})})}}},function(a,b,c){c.d(b,"a",function(){return g});c.d(b,"b",function(){return k});c.d(b,"c",function(){return m});c.d(b,"d",function(){return n});var d=c(11),e=c(12),f=c(4),g="LOADING_ORG_INFO",k="UPDATE_ORG_INFO",m="UPDATE_ORG_INFO_FAILED",n=function(){return function(a,b){b=
b();if("loaded"===b.results.organization.status)return(new e).resolve();if("failed"===b.results.organization.status)return(new e).reject();a({type:g});var c=b.settings.utils;b=c.request;c=c.portal;return d([Object(f.q)(b,c).then(function(a){return a.categorySchema}),Object(f.l)(b,c).then(function(a){return a.data.results})]).then(function(b){a({type:k,payload:{schema:b[0],groups:b[1]}})},function(b){a({type:m})})}}},function(a,b,c){c.d(b,"b",function(){return e});c.d(b,"a",function(){return f});c.d(b,
"c",function(){return g});var d=c(4),e="START_CUSTOM_ACTION",f="END_CUSTOM_ACTION",g=function(a,b){return function(c,g){(g=g().settings.config.customActions.filter(function(b){return b.name===a})[0])&&(g.asynchronous?(c({type:e,payload:b}),g.onAction(Object(d.M)(b)).then(function(){c({type:f,payload:b})},function(){c({type:f,payload:b})})):g.onAction(Object(d.M)(b)))}}},function(a,b,c){c.d(b,"a",function(){return g});c.d(b,"b",function(){return k});var d=c(12),e=c(4),f=c(123),g="UPDATE_PORTAL_SELF",
k=function(){return function(a,b){var c=b(),k=c.settings.utils;b=k.portal;var k=k.request,m=b.user&&b.user.culture?b.user.culture:f.locale;return c.settings.utils.self?(new d).resolve(c.settings.utils.self):Object(e.s)(k,b,m).then(function(b){b=Object(e.F)(b);return a({type:g,payload:{self:b,config:c.settings.config}}),b})}}},function(a,b,c){c.d(b,"a",function(){return k});c.d(b,"c",function(){return m});c.d(b,"d",function(){return n});c.d(b,"b",function(){return h});c.d(b,"e",function(){return p});
var d=c(11),e=c(12),f=c(4),g=c(14),k="LOADING_CUSTOM_SECTION_INFO",m="UPDATE_CUSTOM_SECTION_SCHEMAS",n="UPDATE_CUSTOM_SECTION_INFO_FAILED",h="UPDATE_CUSTOM_SECTION_GROUPS",p=function(){return function(a,b){function c(b){a({type:n})}var h=b();if("loaded"===h.results.customSections.status)return(new e).resolve();if("failed"===h.results.customSections.status)return(new e).reject();a({type:k});var p=Object(f.J)("id",h.settings.config.customSections.filter(g.h).map(g.c).reduce(function(a,b){return a.concat(b)},
[]));return q(a,b,p).then(function(){return h=b(),d(p.map(function(a){return l(h,a).then(function(b){return{id:a.id,type:a.type,response:b}})}))},c).then(function(b){return a({type:m,payload:b})},c)}},q=function(a,b,c){var g=b(),k=new e;if(0<c.length){var g=g.settings.utils,m=g.request,n=g.portal;c=c.filter(function(a){return"group"===a.type}).map(function(a){var b=a.id;return Object(f.n)(m,n,a.fetchGroupIdByQuery||"id:"+b).then(function(a){return a.results[0]})});d(c).then(function(c){var d=b();
a({type:h,payload:{currentSection:d.parameters.section,customSections:d.settings.config.customSections,groups:c}});k.resolve()})}else k.resolve();return k},l=Object(f.j)(function(a,b){var c=a.settings.utils;a=c.request;c=c.portal;return b.staticSchema?(a=new e,a.resolve({categorySchema:b.staticSchema}),a.then(function(a){return a})):"group"===b.type?Object(f.o)(a,c,b.id):Object(f.q)(a,c,b.id)})},function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"c",function(){return f});c.d(b,"b",function(){return g});
c.d(b,"d",function(){return k});c.d(b,"e",function(){return m});a=c(292);var d=c(67),e="LOADING_TAGS",f="LOADING_TAGS_SUCCESS",g="LOADING_TAGS_FAILED",k="UPDATE_TAGS_FILTER_STRING",m=function(a){return function(b,c){b({type:k,payload:a});2<a.length&&n(b,c(),a)}},n=a(function(a,b,c){a({type:e});var k=b.settings.utils.request;b=Object(d.c)(b,c);k(b[0],b[1]).then(function(b){a({type:f,payload:b.data})},function(b){return a({type:g,payload:b})})},400)},function(a,b,c){var d=c(207);c.d(b,"c",function(){return d.a});
c.d(b,"e",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});c.d(b,"q",function(){return d.g});c.d(b,"r",function(){return d.h});c.d(b,"s",function(){return d.i});var e=c(212);c.d(b,"b",function(){return e.a});c.d(b,"h",function(){return e.b});var f=c(213);c.d(b,"d",function(){return f.a});c.d(b,"f",function(){return f.b});c.d(b,"g",function(){return f.c});c.d(b,"i",function(){return f.d});
c.d(b,"j",function(){return f.e});c.d(b,"o",function(){return f.f});c.d(b,"p",function(){return f.g});var g=c(72);c.d(b,"a",function(){return g.b})},function(a,b,c){var d=c(208);c.d(b,"d",function(){return d.a});c.d(b,"h",function(){return d.b});var e=c(209);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"f",function(){return e.c});var f=c(210);c.d(b,"c",function(){return f.a});c.d(b,"g",function(){return f.b});var g=c(211);c.d(b,"e",function(){return g.a});c.d(b,"i",function(){return g.b})},
function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"b",function(){return f});var d=c(122),e="VIEW_ITEM_DETAILS",f=function(a){return function(b){b({type:e,payload:a});b(Object(d.c)(a))}}},function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});c.d(b,"c",function(){return f});var d="CLOSING_DETAILS_PANE",e="CLOSE_DETAILS_PANE",f=function(){return{type:d}}},function(a,b,c){c.d(b,"a",function(){return d});c.d(b,"b",function(){return e});var d="VIEW_FILTERS",e=function(){return{type:d}}},
function(a,b,c){c.d(b,"a",function(){return d});c.d(b,"b",function(){return e});var d="VIEW_SORT",e=function(){return{type:d}}},function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});var d="SHOW_EMPTY_RESULTS",e="CHANGE_RESULT_DISPLAY"},function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"c",function(){return e});c.d(b,"d",function(){return f});c.d(b,"a",function(){return g});c.d(b,"e",function(){return k});c.d(b,"f",function(){return m});c.d(b,"g",function(){return n});
var d="MAXIMIZE_DLG",e="MINIMIZE_DLG",f="TOGGLE_EXPANDED_FILTERS",g="CLOSE_FULLSCREEN_BROWSER",k="TOGGLE_EXPANDED_SORT",m=function(){return{type:f}},n=function(){return{type:k}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b){a.exports=L},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(294),g=c(53),k=c.n(g);c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=
(this.stateTree.settings.config,this.stateTree.ui,this.stateTree.parameters,a("div",{class:"ib-header__spacer"}));this.stateTree.settings.config.showBackBtn&&(b=a(k.a,{handleClick:this.stateTree.settings.config.onBack,key:"main-back-btn",title:e.back,focusable:!0},a("svg",{width:"16",height:"16",viewBox:"0 0 16 16",style:"transform: translate(0, -1px);"},a("path",{d:"M8 1.288l-7.212 7.212 7.212 7.212v-1.414l-5.288-5.297h13.288v-0.99h-13.307l5.307-5.307z"}))));var c=a("div",{class:"ib-header__spacer"});
return this.stateTree.settings.config.showCloseBtn&&(c=a(k.a,{key:"main-close-btn",title:e.close,focusable:!0,handleClick:this.stateTree.settings.config.onBack},a("svg",{width:"16",height:"16",viewBox:"0 0 32 32"},a("path",{d:"M31.047 28h-5l-12-12 12-12h5l-12 12 12 12zm-26-12l12-12h-5l-12 12 12 12h5l-12-12z"})))),a("div",{classes:{ib__header:!0},key:"header"},a("div",{key:"section-title-container",class:"ib-header__search-section"},b,a(f.a,{key:"section-dropdown"}),c))},b}(a.a);b.a=c},function(a,
b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(71),k=c.n(g),g=c(53),m=c.n(g);c=function(a){function b(b,c){b=a.call(this,b,c)||this;c=b.stateTree.settings;var d=(c.utils.portal.user?c.config.baseSections:c.config.baseSections.filter(function(a){return"livingAtlas"===a||"all"===a})).map(function(a){return{value:a,text:e.header.sectionTitles[a]}});return c.config.customSections.forEach(function(a){var b={value:a.name,text:a.name};a.addToFront?d.splice(0,0,b):d.push(b)}),b.state={options:d},b.handleOptionSelect=
b.handleOptionSelect.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.parameters.section,c=e.header.sectionTitles[b];return 2>this.state.options.length||this.stateTree.settings.config.replaceSectionDropdownWithTitle?a("h3",{id:"ib-dialog-title",class:"ib-header__dialog-title"},this.stateTree.settings.config.dialogTitle):a(k.a,{key:"section-dropdown-base",options:this.state.options,onSelect:this.handleOptionSelect,selectedOptionValue:this.stateTree.parameters.section},
a("h3",{key:"search-"+b+"-dropdown",id:"section-dropdown-toggle",class:"ib-section-dropdown__toggle"},c||b,"\u00a0",a(m.a,{key:"section-dropdown-button"},a("svg",{width:"12",height:"12",viewBox:"0 0 16 16"},a("path",{d:"M1.5,4 L8,11 L14.5,4 C11.893,4 4.101,4 1.5,4 Z"})))))},b.prototype.handleOptionSelect=function(a){this.dispatch(Object(f.Db)(a));this.dispatch(Object(f.Rb)(!0))},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(63),g=c.n(f),k=c(124),m=c(2);c=function(a){function b(b,
c){b=a.call(this,b,c)||this;return b.handleSearchChange=b.handleSearchChange.bind(b),b.handleSearchKeyDown=b.handleSearchKeyDown.bind(b),b.handleListClick=b.handleListClick.bind(b),b.handleTableClick=b.handleTableClick.bind(b),b.handleSortClick=b.handleSortClick.bind(b),b.handleFilterClick=b.handleFilterClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.parameters,c=(this.stateTree.results,this.stateTree.ui),d=this.stateTree.settings.config,f=b.nextQuery.total.toLocaleString()+
" "+(d.itemName?d.itemName:e.resultCount),d=d.searchPlaceholderText?d.searchPlaceholderText:e.searchPlaceholders.generic;return a("div",null,a("div",{key:"search-input-area",class:"ib__input-area"},a("div",{key:"search-bar-container",class:"ib-input-area__search-bar"},a("input",{id:"item-browser-search-input",class:"ib-input-area__search-input",type:"search",oninput:this.handleSearchChange,onkeydown:this.handleSearchKeyDown,placeholder:d,"aria-label":d,value:b.searchString.current})),a("div",{class:"ib-input-area__result-bar-container"},
a("span",{class:"ib-input-area__result-count"},f),a("div",{class:"ib-input-area__icon-button-container"},a(g.a,{active:"table"===this.stateTree.ui.resultPanel.display,key:"table-button",handleClick:this.handleTableClick,title:e.compactView},a("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},a("g",{stroke:"none","stroke-width":"1"},a("g",null,a("path",{d:"M4 14h11v1H4v-1zm0-4h11v1H4v-1zm0-3h11V6H4v1zm0-4h11V2H4v1zM3 14H1v1h2v-1zm0-4H1v1h2v-1zm0-4H1v1h2V6zm0-4H1v1h2V2z"}))))),a(g.a,{active:"list"===
c.resultPanel.display,handleClick:this.handleListClick,key:"list-button",title:e.listView},a("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},a("g",{stroke:"none","stroke-width":"1"},a("g",null,a("path",{d:"M7 13h8v1H7zm-2-1H2v3h3zm2-8h8V3H7zm0 5h8V8H7zM5 2H2v3h3zm0 5H2v3h3z"}))))),a("div",{class:"ib-input-area__spacer"}),a(g.a,{active:"filter"===c.sidePanel.type,handleClick:this.handleFilterClick,key:"filter-button",title:"filter"===c.sidePanel.type?e.close:e.filterPane.filter},a("svg",{width:"16px",
height:"16px",viewBox:"0 0 16 16"},a("g",{stroke:"none","stroke-width":"1"},a("g",{id:"filter-sliders-1px-16"},a("path",{d:"M7,13 L0,13 L0,12 L7,12 L7,10 L8,10 L8,15 L7,15 L7,13 Z M12,8 L0,8 L0,7 L12,7 L12,5 L13,5 L13,10 L12,10 L12,8 Z M2,3 L0,3 L0,2 L2,2 L2,0 L3,0 L3,5 L2,5 L2,3 Z M4,2 L16,2 L16,3 L4,3 L4,2 Z M14,7 L16,7 L16,8 L14,8 L14,7 Z M9,12 L16,12 L16,13 L9,13 L9,12 Z"}))))),a(g.a,{active:"sort"===c.sidePanel.type,handleClick:this.handleSortClick,key:"sort-button",title:"sort"===c.sidePanel.type?
e.close:e.sortOptions.sort},a("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},a("g",{stroke:"none","stroke-width":"1"},a("g",{id:"sort-1px-16"},a("path",{d:"M1,1 L15,1 L15,2 L1,2 L1,1 Z M4,5 L15,5 L15,6 L4,6 L4,5 Z M7,9 L15,9 L15,10 L7,10 L7,9 Z M11,13 L15,13 L15,14 L11,14 L11,13 Z"})))))))),a(k.a,{key:"active-filters",theme:"light"}))},b.prototype.handleSearchChange=function(a){this.dispatch(Object(m.Eb)(a.target.value));""===a.target.value&&""!==this.stateTree.parameters.searchString.previous&&
this.dispatch(Object(m.Rb)(!0))},b.prototype.handleSearchKeyDown=function(a){"Enter"===a.key&&this.dispatch(Object(m.Rb)(!0))},b.prototype.handleTableEnter=function(a){13===a.keyCode&&this.handleTableClick(a)},b.prototype.handleTableClick=function(a){a.preventDefault();"list"===this.stateTree.ui.resultPanel.display&&this.dispatch({type:m.e})},b.prototype.handleListClick=function(a){a.preventDefault();"table"===this.stateTree.ui.resultPanel.display&&this.dispatch({type:m.e})},b.prototype.handleFilterClick=
function(a){a.preventDefault();"filter"===this.stateTree.ui.sidePanel.type?this.dispatch(Object(m.Hb)()):this.dispatch(Object(m.nc)())},b.prototype.handleSortClick=function(a){a.preventDefault();"sort"===this.stateTree.ui.sidePanel.type?this.dispatch(Object(m.Hb)()):this.dispatch(Object(m.pc)())},b}(a.a);b.a=c},function(a,b){a.exports=R},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(298),k=c(299),m=c(59),n=c.n(m);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleScroll=
b.handleScroll.bind(b),b.handleCreate=b.handleCreate.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.settings.config,c=this.stateTree.ui,d=c.resultPanel.status;return"success"===d||"loadingNext"===d?a(g.a,{key:"item-list-"+c.resultPanel.display,i18n:e,showSubmitButton:b.showSubmitButton,results:this.stateTree.results.displayItems,loadingNext:"loadingNext"===c.resultPanel.status,handleScroll:this.handleScroll,handleCreate:this.handleCreate},a(k.a,{key:"result-items"})):
"loading"===d?a("div",{key:"loading-items",class:"ib__results"},a(n.a,{key:"item-loader",text:e.results.loadingItems})):"empty"===d?a("div",{key:"empty-state",class:"ib__results"},a("div",{class:"ib-results__message-container"},a("span",{class:"ib-results__message"},e.results.empty))):a("div",{key:"request-error",class:"ib__results"},a("div",{class:"ib-results__message-container"},a("span",{class:"ib-results__message"},e.results.requestError)))},b.prototype.handleScroll=function(a){.99<=(a.target.scrollTop+
a.target.offsetHeight)/a.target.scrollHeight&&"loadingNext"!==this.stateTree.ui.resultPanel.status&&-1!==this.stateTree.parameters.nextQuery.nextStart&&this.dispatch(Object(f.Pb)())},b.prototype.handleCreate=function(a){var b=this;setTimeout(function(){a.scrollHeight<=a.clientHeight&&"loadingNext"!==b.stateTree.ui.resultPanel.status&&-1!==b.stateTree.parameters.nextQuery.nextStart&&b.dispatch(Object(f.Pb)(50))},10)},b}(a.a);b.a=c},function(a,b,c){a=c(59);var d=c.n(a);b.a=function(a){var b=a.tsx,c=
a.key,e=a.i18n,f=a.loadingNext,g=a.handleScroll,k=a.handleCreate,m=a.children;return 0<a.results.length?b("div",{key:c,class:"ib-results__item-list",onscroll:g,afterCreate:k},m,f?b("div",{class:"ib-results__load-container"},b(d.a,{key:"more-items-loader"})):null):b("div",{key:"no-items-found",class:"ib-results__item-list ib-results__item-list--none"},b("span",{style:"font-size: 0.9375rem;"},e.results.noItemsFound))}},function(a,b,c){var d=c(0);a=c(3);a=c.n(a);var e=c(14),f=c(2),g=c(98),k=c.n(g),g=
c(99),m=c.n(g);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleShowItemDetails=b.handleShowItemDetails.bind(b),b.handleSelectionClick=b.handleSelectionClick.bind(b),b.handleCustomActionClick=b.handleCustomActionClick.bind(b),b.startResizePoll=b.startResizePoll.bind(b),b.resizePoll=b.resizePoll.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.results;return 0<b.displayItems.length?a("div",{key:"item-wrapper",id:"resize-detector",afterCreate:this.startResizePoll},
this.mapItemsToChildren(b.displayItems)):null},b.prototype.mapItemsToChildren=function(a){var b=this,c=this.tsx;return a.map(function(a){var d=Object(e.b)(b.stateTree);return"list"===b.stateTree.ui.resultPanel.display?c(k.a,{constrained:b.state.constrained,key:a.id+"-card",item:a,loadingItems:b.stateTree.results.loadingItems,selectedItems:b.stateTree.results.selectedItems,activeItem:b.stateTree.ui.sidePanel.item,portal:d,onShowItemDetails:b.handleShowItemDetails,onSelectionClick:b.handleSelectionClick,
customActions:b.stateTree.settings.config.customActions,onCustomActionClick:b.handleCustomActionClick,disableMainAction:b.stateTree.settings.config.disableMainAction,sortField:b.stateTree.parameters.sort.field,hideEllipses:b.stateTree.settings.config.hideEllipses,organization:"public_authoritative"===a.contentStatus&&b.stateTree.results.allOrganizations[a.orgId]?b.stateTree.results.allOrganizations[a.orgId]:void 0}):c(m.a,{key:a.id+"-cardrow",item:a,loadingItems:b.stateTree.results.loadingItems,selectedItems:b.stateTree.results.selectedItems,
activeItem:b.stateTree.ui.sidePanel.item,portal:d,onShowItemDetails:b.handleShowItemDetails,onSelectionClick:b.handleSelectionClick,customActions:b.stateTree.settings.config.customActions,onCustomActionClick:b.handleCustomActionClick,disableMainAction:b.stateTree.settings.config.disableMainAction,sortField:b.stateTree.parameters.sort.field,hideEllipses:b.stateTree.settings.config.hideEllipses})})},b.prototype.handleShowItemDetails=function(a){var b=this.stateTree.ui.sidePanel;b.item&&b.item.id===
a.id?this.dispatch(Object(f.Hb)()):this.dispatch(Object(f.oc)(a))},b.prototype.handleSelectionClick=function(a){this.stateTree.settings.config;this.stateTree.results.selectedItems[a.id]?this.dispatch(Object(f.Jb)(a)):this.dispatch(Object(f.Sb)(a))},b.prototype.handleCustomActionClick=function(a,b){this.dispatch(Object(f.Ib)(a,b))},b.prototype.startResizePoll=function(a){this.resizePoll(a)},b.prototype.resizePoll=function(a){var b=this;a&&0<a.clientWidth&&(300>a.clientWidth&&!this.state.constrained?
this.setState({constrained:!0}):300<a.clientWidth&&this.state.constrained&&this.setState({constrained:!1}),setTimeout(function(){b.resizePoll(a)},250))},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(301),k=c(305),m=c(309),n=c(310);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleCloseDetailsPane=b.handleCloseDetailsPane.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a,b=this.tsx,c=this.stateTree.settings.config.detailsPaneType,d=
this.stateTree.ui.sidePanel.type,f=this.props.closing,h={"ib-side__container--fade-in":!f,"ib-side__container--fade-out":f,"ib-side__container--flyout":"flyout"===c,"ib-side__container--flyover":"flyover"===c},c={"ib-side__content--flyout":"flyout"===c,"ib-side__content--in-right":!f&&"flyout"===c,"ib-side__content--out-left":f&&"flyout"===c,"ib-side__content--flyover":"flyover"===c,"ib-side__content--in-left":!f&&"flyover"===c,"ib-side__content--out-right":f&&"flyover"===c};if("sort"===d)a=b(m.a,
{key:"sort-pane"});else if("filter"===d)a=b(g.a,{key:"filter-pane"});else if("item"===d&&this.stateTree.ui.sidePanel.item)a=b(k.a,{key:this.stateTree.ui.sidePanel.item.id,item:this.stateTree.ui.sidePanel.item});else if("hidden"===d)return null;return b(n.a,{key:"item"===d&&this.stateTree.ui.sidePanel.item?""+this.stateTree.ui.sidePanel.item.id:d,containerClasses:h,contentClasses:c,handleClose:this.handleCloseDetailsPane,i18n:e,type:d},a)},b.prototype.componentWillReceiveProps=function(a){var b=this;
!this.props.closing&&a.closing&&("item"===this.stateTree.ui.sidePanel.type&&this.stateTree.ui.sidePanel.item?(a=document.getElementById("item-"+this.stateTree.ui.sidePanel.item.id+"-card-title"))&&a.focus():"filter"===this.stateTree.ui.sidePanel.type?(a=document.getElementById("filter-button"))&&a.focus():"sort"===this.stateTree.ui.sidePanel.type&&(a=document.getElementById("sort-button"))&&a.focus(),setTimeout(function(){b.dispatch({type:f.l})},300))},b.prototype.handleCloseDetailsPane=function(){this.dispatch(Object(f.Hb)())},
b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(85);c=function(a){function b(b,c){return a.call(this,b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a("div",{id:"filter-pane-container",key:"filter-pane-container",class:"ib-filter-pane__container"},a("h4",{class:"ib-filter-pane__title"},e.filterPane.filter),a(f.a,{key:"filter-options"}))},b}(a.a);b.a=c},function(a,b,c){function d(a){var b=a.settings.utils.portal.user,c=!b,b=!c&&!b.orgId;if(c||
b)if(b)a=function(a){switch(a.parameters.section){case "myContent":return"folder itemType modified created tags shared".split(" ");case "myFavorites":return["itemType","modified","created","tags","status"];case "myGroups":return"groupCategories group itemType modified tags created".split(" ");case "livingAtlas":return["livingAtlasCategories","livingAtlasRegion","itemType","tags","status"];case "all":return["itemType","modified","status"];default:return e(a)}}(a);else a:switch(a.parameters.section){case "livingAtlas":a=
["livingAtlasCategories","livingAtlasRegion","itemType","tags","status"];break a;case "all":a=["itemType","modified","status"];break a;default:a=e(a)}else a=function(a){switch(a.parameters.section){case "myContent":return"folder orgCategories itemType modified created tags shared status".split(" ");case "myFavorites":return"itemType modified created tags shared status".split(" ");case "myGroups":return"groupCategories group itemType modified created tags shared status".split(" ");case "myOrganization":return"orgCategories itemType modified created tags shared status".split(" ");
case "livingAtlas":return["livingAtlasCategories","livingAtlasRegion","itemType","tags","status"];case "all":return["itemType","modified","shared","status"];default:return e(a)}}(a);return a}function e(a){return a.settings.config.customSections.reduce(function(b,c){return c.name===a.parameters.section&&c.filters?c.filters:b},["itemType","modified","shared"])}c.d(b,"a",function(){return d})},function(a,b){a.exports=M},function(a,b,c){var d=c(0);a=c(3);a=c.n(a);var e=c(66),f=c.n(e),e=c(77),g=c.n(e);
c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleClear=b.handleClear.bind(b),b.handleClick=b.handleClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=this.props.filter;return b(g.a,{key:c.displayName+"-filter-accordion",clearable:!1,onClear:this.handleClear,title:c.displayName},b("ul",{"aria-label":c.displayName,id:c.displayName+"-filter-accordion-tree",class:"ftr-custom__tree",role:"tree"},c.children?c.children.map(function(c){return b(f.a,
{key:c.value,value:c.value,name:c.displayName,onToggleClick:a.handleClick,selectedToggle:a.props.selectedOption,childOptions:c.children})}):null))},b.prototype.handleClear=function(){this.props.onClear(this.props.index)},b.prototype.handleClick=function(a,b){a===this.props.selectedOption?this.props.onClick(this.props.index,void 0):this.props.onClick(this.props.index,a,b)},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(14),k=c(59),m=c.n(k),n=c(306),k=c(78),h=c.n(k),
k=c(79),p=c.n(k),k=c(80),q=c.n(k),k=c(81),l=c.n(k),k=c(82),r=c.n(k),k=c(83),t=c.n(k),k=c(84),v=c.n(k),k=c(53),u=c.n(k),w=c(307),x=c(308),y=c(56);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleItemDetails=b.handleItemDetails.bind(b),b.handleFavorites=b.handleFavorites.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;if(!(this.stateTree.results.fullItemDetails[this.props.item.id]&&this.stateTree.results.users[this.props.item.owner]||this.stateTree.results.failedItemDetails[this.props.item.id]))return a(m.a,
{key:"loading-item-details"});if(this.stateTree.results.failedItemDetails[this.props.item.id])return a("div",{class:"ib-item-pane__message-container"},a("span",{class:"ib-results__message"},e.results.requestError));var b=this.stateTree.results.fullItemDetails[this.props.item.id],c=this.stateTree.results.users[b.owner],d=Object(g.b)(this.stateTree),f=(b&&this.stateTree.results.selectedItems[b.id],b&&this.stateTree.results.loadingItems[b.id]),k={"ib-item-pane__fader":!0,"ib-item-pane__fader--loading":f},
h=new Date(b.modified),p=new Date(b.created),q=this.stateTree.results.allOrganizations[b.orgId],l="public_authoritative"===b.contentStatus&&b.orgId&&!!q;return[a("div",{class:"ib-item-pane__thumb-container"},a("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",class:"ib-item-pane__thumbnail",style:"\n                            display: block;\n                            padding: none;\n                            margin: none;\n                            background-image: url("+
b.thumbURI+");\n                            width: 15rem;\n                            height: 10rem;\n                        ",alt:""}),a(w.a,{favorites:this.stateTree.results.user.favorites,item:b,onToggleFavorite:this.handleFavorites})),a("div",{id:"item-pane-container",class:"ib-item-pane__container",key:b.id+"-container"},a("div",{classes:k},a("div",{key:"item-details"},a("h4",{class:"ib-item-pane__title"},b.title,"\u00a0",a(u.a,{key:"view-full-item-details",title:e.itemDetails.viewDetails,
handleClick:this.handleItemDetails,focusable:!0},a("svg",{width:"16",height:"16",viewBox:"0 0 16 16",style:"transform: translate(0, -2px);"},a("path",{d:"M13 15h-12v-12h10v-1h-11v14h14v-6h-1z"}),a("path",{d:"M13 7.536l3-3-3-3v1.061l1.404 1.404h-1.404c-3.85 0-7 3.15-7 7v1h1v-1c0-3.309 2.691-6 6-6h1.475l-1.475 1.475v1.061z"})))),a("span",{key:"item-owner",class:"ib-item-pane__owner-text"},a("img",{src:b.iconURI,class:"ib-item-pane__type-icon",title:b.displayName}),b.displayName," ",e.itemDetails.by,
"\u00a0",a("a",{class:"ib-item-pane__owner-link",title:l?e.itemDetails.viewOrg:e.itemDetails.viewUser,target:"_blank",href:l?q.orgUrl:d.baseUrl+"/home/user.html?user\x3d"+b.owner},l?q.name:b.owner)),a("span",{key:"modified-date",class:"ib-item-pane__modified"},e.itemDetails.lastModified,": "+y.format(h,{selector:"date",formatLength:"long"})),a("div",{class:"ib-item-pane__badges"},this.renderBadges(b)),a("div",{class:"ib-item-pane__line",style:"width: 100%; border-bottom: 1px solid #ccc"}),a("span",
{key:"snippet",class:"ib-item-pane__snippet"},b.snippet?b.snippet:e.itemDetails.noSnippet),a("h5",{class:"ib-item-pane__details"},e.itemDetails.details),b.patchedDescription?a("span",{key:"item-description",innerHTML:b.patchedDescription,class:"ib-item-pane__description"}):a("span",{key:"item-no-description",class:"ib-item-pane__description"},e.itemDetails.noDescription),a("h5",{class:"ib-item-pane__terms-of-use"},e.itemDetails.termsOfUse),b.licenseInfo?a("span",{key:"item-terms-of-use",innerHTML:b.licenseInfo,
class:"ib-item-pane__license-info"}):a("span",{key:"item-no-terms-of-use",class:"ib-item-pane__license-info"},e.itemDetails.noTermsOfUse),a("h5",{class:"ib-item-pane__credits"},e.itemDetails.attribution),b.accessInformation?a("span",{key:"item-access-information",innerHTML:b.accessInformation,class:"ib-item-pane__attribution"}):a("span",{key:"item-no-access-information",class:"ib-item-pane__attribution"},e.itemDetails.noAttribution),l?a("p",null,a("h5",{class:"ib-item-pane__pa-owner"},e.sortOptions.owner),
a("div",{class:"ib-item-pane__pa-org"},a("img",{src:q.thumbURI,alt:q.name,class:"ib-item-pane__pa-org-thumb user-image-small-inline padding-right-half display-block js-owner-thumbnail"}),q.name),a("div",{class:"ib-item-pane__pa-managed"},a("span",{class:"ib-item-pane__pa-managed-label"},e.itemDetails.managedBy),a("div",{class:"ib-item-pane__pa-manager"},c.thumbURI?a("img",{src:c.thumbURI,class:"ib-item-pane__pa-managed-thumb"}):a(n.a,{class:"ib-item-pane__pa-managed-thumb"}),b.owner))):null,a("span",
{key:"num-views",class:"ib-item-pane__num-views"},a("strong",null,e.itemDetails.views),": "+b.numViews),a("span",{key:"created-date",class:"ib-item-pane__num-views"},a("strong",null,e.itemDetails.created),": "+y.format(p,{selector:"date",formatLength:"long"})),a(x.a,{baseUrl:d.baseUrl,item:b}))),f?a(m.a,{key:"item-pane-loading"}):null)]},b.prototype.renderBadges=function(a){var b=this,c=this.tsx,d=this.stateTree.settings.utils.portal.user;return a.badges.map(function(e){switch(e){case "authoritative":return c(h.a,
{altOrg:"public_authoritative"===a.contentStatus&&b.stateTree.results.allOrganizations[a.orgId]?b.stateTree.results.allOrganizations[a.orgId].name:void 0});case "deprecated":return c(p.a,null);case "livingAtlas":return c(q.a,null);case "marketplace":return c(l.a,null);case "openData":return c(r.a,null);case "premium":return c(t.a,{user:d});case "subscriber":return c(v.a,{user:d})}return null})},b.prototype.handleItemDetails=function(){var a=Object(g.b)(this.stateTree),b=this.stateTree.ui.sidePanel.item;
b&&window.open(a.baseUrl+"/home/item.html?id\x3d"+b.id,"_blank")},b.prototype.formatSize=function(a){var b=this.tsx;return a?1024>=a?["1 ",b("small",{key:"1kb-size"},"KB")]:1048576>a?[Math.round(a/1024).toLocaleString()+" ",b("small",{key:"1kb-size"},"KB")]:[Math.round(a/1048576).toLocaleString()+" ",b("small",{key:"1kb-size"},"MB")]:["0 ",b("small",{key:"0kb-size"},"KB")]},b.prototype.handleFavorites=function(){var a=this.stateTree.ui.sidePanel.item,b=this.stateTree.results.user.favorites;a&&b&&
b[a.id]?this.dispatch(Object(f.Qb)(a)):a&&b&&!b[a.id]&&this.dispatch(Object(f.Cb)(a))},b}(a.a);b.a=c},function(a,b,c){b.a=function(a){var b=a.tsx;return b("div",{class:a.class},b("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 150 150",height:"100%",width:"100%"},b("path",{id:"path3727",d:"m 52,148.35766 c -2.475,-0.18484 -10.8,-0.45343 -18.5,-0.59687 L 19.5,147.5 19.194994,142.1708 C 18.780069,134.92106 24.675201,110.99518 28,106.43495 c 2.119734,-2.90738 3.184268,-3.40501 11.820245,-5.52557 14.015326,-3.441464 12.799724,-4.197584 21.447495,13.34062 4.135724,8.3875 8.291761,16.93353 9.235637,18.99118 0.943876,2.05765 2.065683,3.52516 2.492905,3.26112 0.427221,-0.26404 4.718162,-8.47257 9.535425,-18.24118 4.817262,-9.76862 9.137298,-18.24997 9.600081,-18.847444 1.07417,-1.386813 10.747512,-0.129937 19.839562,2.577794 7.37115,2.19522 11.16896,5.44708 12.85677,11.00853 6.69283,22.05341 7.84944,32.33763 3.67188,32.64913 -1.1,0.082 -6.95,0.62022 -13,1.19598 -11.23048,1.06878 -55.365488,2.12006 -63.5,1.51255 z m 20,-17.37753 c 0,-0.56093 -1.107043,-2.77354 -2.460095,-4.91692 -1.353052,-2.14337 -2.772339,-5.17193 -3.153972,-6.73012 C 66.0043,117.77489 65.377929,116.275 64.993998,116 c -0.383932,-0.275 -2.303235,-3.7147 -4.265118,-7.64379 -2.997369,-6.00286 -3.476188,-7.83951 -2.998076,-11.499996 0.312942,-2.395918 0.973535,-4.62137 1.467986,-4.94545 0.494451,-0.32408 2.959173,0.453755 5.47716,1.728522 2.517988,1.274768 6.181951,2.618632 8.142141,2.986366 3.484798,0.653752 4.619546,0.375908 12.565461,-3.076659 3.34951,-1.455391 3.803432,-1.47865 3.300927,-0.169142 -0.398242,1.037802 -0.124039,1.342318 0.866449,0.962233 C 92.04719,93.384178 91.914975,93.739792 82.242203,114 79.747646,119.225 76.801902,125.4125 75.696105,127.75 73.817142,131.72187 72,133.30992 72,130.98013 Z M 70.29923,93.893977 C 68.538807,93.384871 66.824749,92.525456 66.490213,91.984165 66.155677,91.442874 65.211939,91 64.393017,91 c -1.502433,0 -6.302871,-4.784056 -6.361416,-6.339707 -0.01738,-0.461839 -0.887451,-1.586839 -1.933489,-2.5 C 50.802328,77.537229 48.879628,58.999483 52.441931,46.909154 54.720369,39.176219 55.37403,38.7615 68,37.038257 72.675,36.400195 79.341587,35.480846 82.814638,34.995261 86.28769,34.509675 89.663822,34.317502 90.317154,34.568209 91.693801,35.096478 97,43.197939 97,44.771524 c 0,0.583995 0.454771,1.2134 1.010602,1.398677 1.503878,0.501292 2.439668,18.675087 1.175539,22.829799 -2.185196,7.181885 -3.87855,11.047986 -5.800118,13.242269 -1.087422,1.241752 -2.586953,3.479873 -3.332291,4.973602 -0.745338,1.493728 -1.684447,2.51236 -2.086909,2.263625 -0.402462,-0.248735 -1.79714,0.347041 -3.099286,1.323947 -5.368623,4.027692 -8.806128,4.756927 -14.568307,3.090534 z M 47.015313,60.25 C 47.006891,59.5625 46.333573,59 45.519052,59 43.283015,59 42.644845,54.707151 43.38075,44.616059 44.166271,33.844619 44.896556,30 46.15707,30 c 1.316225,0 7.090208,-4.174219 8.645304,-6.25 0.721069,-0.9625 1.890773,-1.75 2.599342,-1.75 0.70857,0 2.102798,-0.9 3.098284,-2 1.625205,-1.795832 3.079967,-2 14.250617,-2 14.795202,0 15.235286,0.195009 24.330624,10.781341 1.078019,1.254737 2.667599,4.179737 3.532399,6.5 0.86481,2.320262 1.94546,5.118659 2.40144,6.218659 1.51768,3.661163 2.10273,13.653118 0.88532,15.120015 -2.35184,2.833785 -3.74627,1.464615 -4.45065,-4.370015 -0.68461,-5.670783 -5.785078,-16.623556 -8.973492,-19.269704 -1.58533,-1.315707 -2.444358,-1.239512 -24.630153,2.184678 -15.102822,2.330992 -14.275738,1.799234 -17.29574,11.119973 -0.852701,2.631721 -1.557256,6.456721 -1.565678,8.5 C 48.976265,56.828226 48.533156,59.175 48,60 c -0.64625,1 -0.974479,1.083333 -0.984687,0.25 z",
fill:"#fff"})))}},function(a,b,c){var d=c(5);b.a=function(a){var b=a.favorites,c=a.tsx;if(!b)return null;b=!!b[a.item.id];return c("button",{onclick:a.onToggleFavorite,classes:{"ib-item-pane__favorites-btn":!0,"ib-item-pane__favorites-btn--active":b}},c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},c("path",{d:"M16.043.367L19.813 12H32l-9.859 7.172 3.789 11.625-9.887-7.193-9.889 7.193 3.787-11.625L0 12h12.271z"})),b?d.itemDetails.removeFromFavorites:d.itemDetails.addToFavorites)}},
function(a,b,c){var d=c(5);b.a=function(a){var b=a.item,c=a.baseUrl,e=a.tsx;a=d.itemDetails.shared[b.access];if(b.sharedToGroups&&0<b.sharedToGroups.length){var f=b.sharedToGroups.map(function(a){return e("a",{class:"ib-item-pane__group-link",href:c+"/home/group.html?owner\x3d"+a.owner+"\x26title\x3d"+a.title,key:a.id,target:"_blank"},a.title)}).reduce(function(a,b,c){return a[c-1]&&a.push(", "),a.push(b),a},[]);a="public"===b.access||"org"===b.access?[a+", ",f]:f}else if("shared"===b.access&&(!b.sharedToGroups||
0===b.sharedToGroups.length))return null;return e("span",{key:"shared-with",class:"ib-item-pane__shared"},e("strong",null,d.itemDetails.sharedWith),": ",a)}},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(66),k=c.n(g),m="relevance title owner created modified numviews".split(" "),n={myContent:["modified","title"],myFavorites:["relevance","modified","title","numviews","owner"],myGroups:["relevance","modified","title","numviews","owner"],myOrganization:["relevance","modified","title",
"numviews","owner"],livingAtlas:["relevance","modified","title","numviews","owner"],all:["relevance","title","owner","modified","numviews"]};c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleChangeSortField=b.handleChangeSortField.bind(b),b.handleChangeSortAsc=b.handleChangeSortAsc.bind(b),b.handleChangeSortDesc=b.handleChangeSortDesc.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=this.stateTree.parameters.section,c=(n[c]?n[c].slice():m.slice()).map(function(c){return b(k.a,
{key:c,name:e.sortOptions[c],value:c,selectedToggle:a.stateTree.parameters.sort.field,onToggleClick:a.handleChangeSortField})}),d=this.stateTree.parameters.sort.field,f=this.stateTree.parameters.sort.order;return b("div",{id:"sort-pane-container",key:"sort-pane-container",class:"ib-sort-pane__container"},b("h4",{class:"ib-sort-pane__title"},e.sortOptions.sort),b("div",{class:"ib-sort-pane__body"},b("h5",{id:"sort-options-title",class:"ib-sort-pane__label"},e.sortOptions.sortBy),b("ul",{key:"sort-option-section",
class:"ib-sort-pane__option-section",role:"radiogroup","aria-labelledby":"sort-options-title","aria-activedescendent":this.stateTree.parameters.sort.field+"-option"},c),b("h5",{id:"sort-dir-title",class:"ib-sort-pane__label",style:"display: "+("relevance"===d?"none":"auto")},e.sortOptions.sortDir),b("ul",{key:"sort-direction-section",class:"ib-sort-pane__dir-section",role:"radiogroup","aria-labelledby":"sort-dir-title","aria-activedescendent":f+"-option",style:"display: "+("relevance"===d?"none":
"auto")},b(k.a,{key:"sort-asc-toggle",name:e.sortOptions.ascending[d],value:"asc",onToggleClick:this.handleChangeSortAsc,selectedToggle:f}),b(k.a,{key:"sort-desc-toggle",name:e.sortOptions.descending[d],value:"desc",onToggleClick:this.handleChangeSortDesc,selectedToggle:f}))))},b.prototype.handleChangeSortField=function(a){this.dispatch(Object(f.Fb)(a));this.dispatch(Object(f.Rb)())},b.prototype.handleChangeSortAsc=function(a){"desc"===this.stateTree.parameters.sort.order&&(this.dispatch(Object(f.Gb)("asc")),
this.dispatch(Object(f.Rb)()))},b.prototype.handleChangeSortDesc=function(a){"asc"===this.stateTree.parameters.sort.order&&(this.dispatch(Object(f.Gb)("desc")),this.dispatch(Object(f.Rb)()))},b}(a.a);b.a=c},function(a,b,c){function d(a){a.focus()}a=c(53);var e=c.n(a),f=c(311);b.a=function(a){var b=a.tsx,c=a.key,g=a.containerClasses,k=a.contentClasses,m=a.handleClose,n=a.i18n,h=a.children,p=null;return"item"===a.type&&(p=b(f.a,{key:"item-details-footer"})),b("div",{key:"details-pane",classes:g,"aria-expanded":"true"},
b("div",{key:"content-container",classes:k},b("header",{class:"ib-side-body__header"},b("div",{class:"ib-side-body__btn-container"},b(e.a,{afterCreate:d,focusable:!0,handleClick:m,key:"side-panel-close-btn",title:n.close},b("svg",{width:"16",height:"16",viewBox:"0 0 16 16",style:"transform: translate(0, -1px);"},b("path",{d:"M13.314 1.99l0.707 0.707-11.314 11.313-0.707-0.707 11.314-11.313z"}),b("path",{d:"M2 2.697l0.707-0.707 11.313 11.314-0.707 0.707-11.313-11.314z"}))))),b("section",{key:c,class:"ib-side-body__content"},
h),p))}},function(a,b,c){var d=c(0);a=c(3);a=c.n(a);var e=c(2);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleAddBtnClick=b.handleAddBtnClick.bind(b),b.handleCustomActionClick=b.handleCustomActionClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=this.stateTree.ui.sidePanel.item,e=c&&!!this.stateTree.results.selectedItems[c.id],f={"ib-item-pane__btn--disabled":c&&!!this.stateTree.results.loadingItems[c.id]},g=d.a({},f,{"ib-item-pane__btn--active":e}),
k=this.stateTree.settings.config.customActions.filter(function(a){return a.allowed(c||{})});return b("footer",{class:"ib-item-pane__footer"},this.stateTree.settings.config.disableMainAction?null:b("button",{key:"select-btn",class:"ib-item-pane__select-btn",classes:g,onclick:this.handleAddBtnClick},e?this.stateTree.settings.config.mainInverseActionTitle:this.stateTree.settings.config.mainActionTitle),k.map(function(c){return b("button",{key:"usage",class:"ib-item-pane__btn",classes:f,value:c.name,
onclick:a.handleCustomActionClick},c.name)}))},b.prototype.handleAddBtnClick=function(){var a=this.stateTree.ui.sidePanel.item;a&&(this.stateTree.results.selectedItems[a.id]?this.dispatch(Object(e.Jb)(a)):this.dispatch(Object(e.Sb)(a)))},b.prototype.handleCustomActionClick=function(a){var b=this.stateTree.ui.sidePanel.item;b&&this.dispatch(Object(e.Ib)(a.target.value,b))},b}(a.a);b.a=c},function(a,b,c){var d=c(0);a=c(3);a=c.n(a);var e=c(313),f=c(316),g=c(324),k=c.n(g);c=function(a){function b(b,c){return a.call(this,
b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a("div",{id:"item-browser-container",classes:this.props.containerClasses,key:"ib-expanded"},a(k.a,{closing:this.stateTree.ui.expanded.closing,key:"ib-big-overlay",scrollable:!this.stateTree.ui.expanded.filters&&!this.stateTree.ui.expanded.sort||!window.matchMedia("(max-width: 860px)").matches},a(e.a,{key:"big-browser-header"}),a(f.a,{key:"big-browser-body"})))},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=
c.n(a);var f=c(53),g=c.n(f),k=c(314);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleContract=b.handleContract.bind(b),b.handleClose=b.handleClose.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a("header",{class:"ib__big-header"},a("div",{class:"ib__big-header-title-section"},a("h4",{class:"ib__big-header-title"},this.stateTree.settings.config.dialogTitle),"adjustable"===this.stateTree.settings.config.layoutMode?a(g.a,{key:"contract-btn",focusable:!0,
handleClick:this.handleContract},a("svg",{width:"24",height:"24",viewBox:"0 0 32 32"},a("path",{d:"M20 20h12v3h-6.915L32 29.723v2.109l-.168.168h-2.117L23 25.09V32h-3V20zM0 23h6.915L0 29.723v2.109L.168 32h2.117L9 25.09V32h3V20H0v3zM9 6.91L2.285 0H.168L0 .168v2.109L6.915 9H0v3h12V0H9v6.91zM32 .168L31.832 0h-2.117L23 6.91V0h-3v12h12V9h-6.915L32 2.277V.168z"}))):a(g.a,{key:"main-close-btn",focusable:!0,handleClick:this.handleClose,title:e.close},a("svg",{width:"24",height:"24",viewBox:"0 0 32 32"},a("path",
{d:"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"})))),a(k.a,{key:"big-browser-section-tabs"}))},b.prototype.handleContract=function(){this.stateTree.settings.config.onBack&&this.stateTree.settings.config.onBack()},b.prototype.handleClose=function(){this.stateTree.settings.config.onBack&&this.stateTree.settings.config.onBack()},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(2),g=c(315),k=c.n(g);
c=function(a){function b(b,c){b=a.call(this,b,c)||this;c=b.stateTree.settings;return b.state={options:(c.utils.portal.user?c.config.baseSections:c.config.baseSections.filter(function(a){return"livingAtlas"===a||"all"===a})).map(function(a){return{value:a,text:e.header.sectionTitles[a]}}).concat(c.config.customSections.map(function(a){return{value:a.name,text:a.name}}))},b.handleTabSelect=b.handleTabSelect.bind(b),b}return d.b(b,a),b.prototype.render=function(){return(0,this.tsx)(k.a,{key:"ib-expanded-nav",
options:this.state.options,onSelect:this.handleTabSelect,selectedOptionValue:this.stateTree.parameters.section})},b.prototype.handleTabSelect=function(a){this.dispatch(Object(f.Db)(a));this.dispatch(Object(f.Rb)(!0))},b}(a.a);b.a=c},function(a,b){a.exports=Q},function(a,b,c){var d=c(0),e=c(5),f=c(317),g=c(318),k=c(319),m=c(322);a=c(103);var n=c.n(a);a=c(3);a=c.n(a);var h=c(72),p=c(59),q=c.n(p),p=c(323),l=c.n(p),r=c(85),t=c(2);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handlePageChange=
b.handlePageChange.bind(b),b.handleCloseMobileFilters=b.handleCloseMobileFilters.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.ui.expanded.filters,b={"ib__big-section":!0,"ib__big-filters":!0,"ib__big-filters--hidden":!b,"ib__big-filters--visible":b},c="loading"===this.stateTree.ui.resultPanel.status||"loading"===this.stateTree.ui.pagination.status,d={"ib__big-wrapper":!0,"ib__big-wrapper--faded":c,"ib__big-wrapper--transparent":c&&0===this.stateTree.ui.pagination.displayItems.length},
h=Math.ceil(1E4<this.stateTree.parameters.nextQuery.total?1E4/this.stateTree.settings.config.resultsPerQuery:this.stateTree.parameters.nextQuery.total/this.stateTree.settings.config.resultsPerQuery);return a("main",{class:"ib__big-body"},a(m.a,{key:"ib__big-search-area"}),a("div",{class:"ib__big-row"},a("section",{classes:b,key:"fullscreen-filters"},a(f.a,null)),a("div",{class:"ib__big-overlay-filters"},a(l.a,{key:"mobile-filter-wrap",maxHeight:!0,open:this.stateTree.ui.expanded.filters,onClose:this.handleCloseMobileFilters,
title:"Filter",footer:a("button",{class:"ib__big-filter-results-btn",onclick:this.handleCloseMobileFilters},e.viewResults)},a(r.a,{key:"mobile-filters"}))),a("section",{class:"ib__big-section ib__big-results",key:"results-section"},a("div",{classes:d},a(g.a,{key:"big-browser-input-area"}),a(k.a,{key:"big-browser-result-panel"}),1<h?a(n.a,{key:"big-browser-pager",onPageChange:this.handlePageChange,numPages:h,currentPage:this.stateTree.ui.pagination.page,paginationLimitReached:1E4<this.stateTree.parameters.nextQuery.total}):
null),c?a("div",{class:"ib-ex__load-container",key:"ib-ex__load-container"},a(q.a,{key:"item-ex-loading"})):null)))},b.prototype.handlePageChange=function(a){this.dispatch(Object(h.d)(a))},b.prototype.handleCloseMobileFilters=function(){this.dispatch(Object(t.Tb)())},b}(a.a);b.a=c},function(a,b,c){var d=c(85);b.a=function(a){return(0,a.tsx)(d.a,{key:"big-browser-filters"})}},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(124);c=function(a){function b(b,c){return a.call(this,b,c)||this}
return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.settings.config;return a("div",{class:"ib-ex-input__container",key:"ib-result-count-container"},a("span",{class:"ib-ex-input-area__result-count"},this.stateTree.parameters.nextQuery.total.toLocaleString()+" "+(b.itemName?b.itemName:e.resultCount)),a(f.a,{staticFilters:this.stateTree.settings.config.staticFilters,key:"ib-ex__active-filters",theme:"dark"}))},b}(a.a);b.a=c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);
var f=c(320);c=function(a){function b(b,c){return a.call(this,b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=(this.stateTree.settings.config,this.stateTree.ui),c=b.resultPanel.status,b=b.pagination.status;return"success"!==c&&"loading"!==c||"success"!==b&&"loading"!==b?a("div",{key:"request-error",class:"ib__results"},a("div",{class:"ib-results__message-container"},a("span",{class:"ib-results__message"},e.results.requestError))):a(f.a,{key:"ib-ex-item-list"})},b}(a.a);b.a=
c},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(321),g=c.n(f),k=c(14);c=function(a){function b(b,c){return a.call(this,b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=Object(k.b)(this.stateTree),d=this.stateTree.ui.pagination.displayItems.map(function(d){return b(g.a,{key:d.id,item:d,organization:"public_authoritative"===d.contentStatus&&a.stateTree.results.allOrganizations[d.orgId]?a.stateTree.results.allOrganizations[d.orgId]:void 0,portal:c,mainAction:a.stateTree.settings.config.onSelect,
mainActionTitle:a.stateTree.settings.config.mainActionTitle,customActions:a.stateTree.settings.config.customActions,sortField:a.stateTree.parameters.sort.field})});return 0<d.length?b("div",{key:this.props.key,class:"ib-ex-results__item-list"},d):b("div",{key:this.props.key,class:"ib-ex-results__item-list"},b("div",{class:"ib-ex-results__no-items-container"},b("div",{class:"ib-ex-results__no-items-centered"},b("svg",{viewBox:"0 0 256 256",width:"256"},b("path",{fill:"#ccc",d:"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"})),
b("p",{class:"ib-ex-results__no-items-text"},e.results.noItemsFound))))},b}(a.a);b.a=c},function(a,b){a.exports=U},function(a,b,c){var d=c(0),e=c(5);a=c(3);a=c.n(a);var f=c(63),g=c.n(f),k=c(2),f=c(104),m=c.n(f),n="relevance title owner created modified numviews".split(" "),h={myContent:["modified","title"],myFavorites:["relevance","modified","title","numviews","owner"],myGroups:["relevance","modified","title","numviews","owner"],myOrganization:["relevance","modified","title","numviews","owner"],livingAtlas:["relevance",
"modified","title","numviews","owner"],all:["relevance","title","owner","modified","numviews"]};c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleToggleFilters=b.handleToggleFilters.bind(b),b.handleSearchChange=b.handleSearchChange.bind(b),b.handleSearchKeyDown=b.handleSearchKeyDown.bind(b),b.handleSortFieldChange=b.handleSortFieldChange.bind(b),b.handleSortOrderChange=b.handleSortOrderChange.bind(b),b.handleSortClick=b.handleSortClick.bind(b),b}return d.b(b,a),b.prototype.render=
function(){var a=this.tsx,b=this.stateTree.settings.config,b=b.searchPlaceholderText?b.searchPlaceholderText:e.searchPlaceholders.generic,c=this.stateTree.parameters.section,c=h[c]?h[c].slice():n.slice();return a("div",{class:"ib-ex-search-area__container"},a("svg",{width:"20",height:"20",viewBox:"0 0 20 20"},a("path",{d:"M19.205 18.295l-7.036-7.035A6.874 6.874 0 0 0 6.875 0 6.874 6.874 0 0 0 0 6.875a6.874 6.874 0 0 0 11.286 5.27l7.035 7.034.884-.884zM1.25 6.875A5.632 5.632 0 0 1 6.875 1.25 5.632 5.632 0 0 1 12.5 6.875 5.632 5.632 0 0 1 6.875 12.5 5.632 5.632 0 0 1 1.25 6.875z",
fill:"#595959","fill-rule":"nonzero"})),a("input",{id:"ib-ex-search-area__input",class:"ib-ex-search-area__input",type:"search",oninput:this.handleSearchChange,onkeydown:this.handleSearchKeyDown,value:this.stateTree.parameters.searchString.current,placeholder:b,title:e.header.search,"aria-label":e.header.search}),a("div",{class:"ib-ex-search-area__btn-section"},a(m.a,{active:this.stateTree.ui.expanded.sort,key:"ib-ex-sort-dropdown",field:this.stateTree.parameters.sort.field,order:this.stateTree.parameters.sort.order,
availableFields:c,onFieldChange:this.handleSortFieldChange,onOrderChange:this.handleSortOrderChange,onClick:this.handleSortClick}),a(g.a,{key:"ib-ex-filter-btn",active:this.stateTree.ui.expanded.filters,handleClick:this.handleToggleFilters},a("div",{class:"drp-sort__btn-body"},a("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},a("g",{stroke:"none","stroke-width":"1"},a("g",{id:"filter-sliders-1px-16"},a("path",{d:"M7,13 L0,13 L0,12 L7,12 L7,10 L8,10 L8,15 L7,15 L7,13 Z M12,8 L0,8 L0,7 L12,7 L12,5 L13,5 L13,10 L12,10 L12,8 Z M2,3 L0,3 L0,2 L2,2 L2,0 L3,0 L3,5 L2,5 L2,3 Z M4,2 L16,2 L16,3 L4,3 L4,2 Z M14,7 L16,7 L16,8 L14,8 L14,7 Z M9,12 L16,12 L16,13 L9,13 L9,12 Z"})))),
a("span",{class:"drp-sort__btn-label"},e.filterPane.filter)))))},b.prototype.handleToggleFilters=function(){this.dispatch(Object(k.Tb)())},b.prototype.handleSearchChange=function(a){this.dispatch(Object(k.Eb)(a.target.value));""===a.target.value&&""!==this.stateTree.parameters.searchString.previous&&this.dispatch(Object(k.Rb)(!0))},b.prototype.handleSearchKeyDown=function(a){"Enter"===a.key&&this.dispatch(Object(k.Rb)(!0))},b.prototype.handleSortFieldChange=function(a){this.dispatch(Object(k.Fb)(a));
this.dispatch(Object(k.Rb)())},b.prototype.handleSortOrderChange=function(a){this.dispatch(Object(k.Gb)(a));this.dispatch(Object(k.Rb)())},b.prototype.handleSortClick=function(){this.dispatch(Object(k.Ub)())},b}(a.a);b.a=c},function(a,b){a.exports=S},function(a,b){a.exports=G},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){c.r(b);var d=c(0);a=c(3);a=c.n(a);var e=c(117);c.d(b,"defaultConfig",function(){return e.a});c.d(b,"reducers",function(){return e.c});c.d(b,"initialState",function(){return e.b});
var f=c(2);c.d(b,"SELECT_ITEM_SINGLE",function(){return f.P});c.d(b,"SELECT_ITEM",function(){return f.M});c.d(b,"DESELECT_ITEM",function(){return f.p});c.d(b,"SELECT_ITEM_ASYNC",function(){return f.N});c.d(b,"SELECT_ITEM_ASYNC_FAILED",function(){return f.O});c.d(b,"search",function(){return f.Rb});c.d(b,"updateExtent",function(){return f.Xb});c.d(b,"viewItemDetails",function(){return f.oc});c.d(b,"changeSearchSection",function(){return f.Db});var g=c(293),k=c(295),m=c(297),n=c(300),h=c(312);c=function(a){function b(b,
c){return a.call(this,b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.stateTree.settings.config.layoutMode,b={ib__container:!0,"ib__container--expanded":this.stateTree.ui.expanded&&"adjustable"===b||"fullscreen"===b};return"fullscreen"===this.stateTree.settings.config.layoutMode?a(h.a,{key:"big-browser",containerClasses:b}):a("div",{id:"item-browser-container",classes:b},a(n.a,{key:"side-panel",closing:this.stateTree.ui.sidePanel.closing}),a(g.a,{key:"header"}),a(k.a,
{key:"input-area"}),a(m.a,{key:"result-panel"}))},b}(a.a);b.default=c}])})},"arcgis-components/Buttons/SvgButton":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},h.p="",h(h.s=342)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},342:function(c,h,a){a.r(h);var e=a(0);c=a(3);a=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.handleClick=b.handleClick.bind(b),b}return e.b(c,a),c.prototype.render=function(){var a=this.tsx,c=this.props,d=c.afterCreate,e=(c.handleClick,c.label),f=c.labelDirection,h=c.key;return a("button",{afterCreate:d,key:h,id:h,classes:{"btn-svg__button":!0,"btn-svg__button--tooltip":!!e,
"btn-svg__button--tooltip-left":"left"===f,"btn-svg__button--tooltip-right":"right"===f,"btn-svg__button--tooltip-top":"top"===f},onmousedown:this.preventFocus,onclick:this.handleClick,"aria-label":e,tabindex:c.focusable?"0":"-1",title:c.title,value:c.value},this.props.children)},c.prototype.preventFocus=function(a){a.preventDefault()},c.prototype.handleClick=function(a){this.props.handleClick&&a.target&&(a.target.value=this.props.value,this.props.handleClick(a))},c}(a.n(c).a);h.default=a}})})},"arcgis-components/Loaders/LoaderBars":function(){define(function(){return function(c){function l(a){if(h[a])return h[a].exports;
var e=h[a]={i:a,l:!1,exports:{}};return c[a].call(e.exports,e,e.exports,l),e.l=!0,e.exports}var h={};return l.m=c,l.c=h,l.d=function(a,c,f){l.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:f})},l.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},l.t=function(a,c){if((1&c&&(a=l(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(l.r(e),
Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var d in a)l.d(e,d,function(b){return a[b]}.bind(null,d));return e},l.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return l.d(c,"a",c),c},l.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},l.p="",l(l.s=370)}({370:function(c,l,h){h.r(l);l.default=function(a){var c=a.tsx,f=a.text;return c("div",{class:"load-bars__container",key:a.key},c("div",{class:"load-bars__bars"}),
f?c("span",{class:"load-bars__text"},f):null)}}})})},"arcgis-components/Buttons/IconButton":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},h.p="",h(h.s=341)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},341:function(c,h,a){a.r(h);var e=a(0);c=a(3);a=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return e.b(c,a),c.prototype.render=function(){var a=this.tsx,c=this.props,d=c.active,e=c.label,f=c.labelDirection,h=c.key;return a("button",{id:h,key:h+"-container",classes:{"btn-icon__button":!0,"btn-icon__button--tooltip":!!e,"btn-icon__button--tooltip-left":"left"===
f,"btn-icon__button--tooltip-right":"right"===f,"btn-icon__button--tooltip-top":"top"===f,"btn-icon__button--active":d},"aria-label":e,onmousedown:this.preventFocus,onclick:this.props.handleClick,tabindex:this.props.tabindex?""+this.props.tabindex:"0","aria-checked":d,title:c.title},this.props.children)},c.prototype.preventFocus=function(a){a.preventDefault()},c}(a.n(c).a);h.default=a}})})},"arcgis-components/Filters/CategoriesFilter/index":function(){define(["../../Component","../../Dropdowns/AccordionDropdown/index",
"../../Buttons/Toggle"],function(c,l,h){return function(a){function c(d){if(f[d])return f[d].exports;var b=f[d]={i:d,l:!1,exports:{}};return a[d].call(b.exports,b,b.exports,c),b.l=!0,b.exports}var f={};return c.m=a,c.c=f,c.d=function(a,b,e){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if((1&b&&
(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=354)}({0:function(a,c,f){function d(a,c){function d(){this.constructor=
a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}f.d(c,"b",function(){return d});f.d(c,"a",function(){return e});var b=function(a,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},e=function(){return(e=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,
arguments)}},26:function(a,c){a.exports=l},354:function(a,c,f){f.r(c);var d=f(0);a=f(9);a=f.n(a);var b=f(26),e=f.n(b),b=f(55),k=f.n(b);f=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.mapCategoriesToToggles=b.mapCategoriesToToggles.bind(b),b.handleToggleClick=b.handleToggleClick.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a(e.a,{key:this.props.key,title:this.props.title,clearable:!!this.props.categoriesFilter,
onClear:this.handleClearFilter,startActive:this.props.startActive},a("ul",{"aria-label":this.props.title,id:this.props.key+"-tree",class:"ftr-categories__tree",role:"tree"},this.mapCategoriesToToggles()))},b.prototype.mapCategoriesToToggles=function(){var a=this,b=this.tsx;return this.props.availableCategories.map(function(c){return b(k.a,{count:c.count,key:c.value,name:c.displayName,value:c.value,selectedToggle:a.props.categoriesFilter?a.props.categoriesFilter.value:void 0,childOptions:c.children,
onToggleClick:a.handleToggleClick,useFullPathAsValue:!0,prependValue:a.props.prependValue,showTooltip:a.props.showTooltips,tooltip:c.tooltip})})},b.prototype.handleToggleClick=function(a,b){this.props.onCategorySelect({value:a,text:b})},b.prototype.handleClearFilter=function(){this.props.onClearCategories()},b}(a.a);c.default=f},55:function(a,c){a.exports=h},9:function(a,e){a.exports=c}})})},"arcgis-components/Dropdowns/AccordionDropdown/index":function(){define(["../../Component","dojo/promise/all",
"dojo/Deferred","dojo/i18n!../../Dropdowns/AccordionDropdown/nls/resources"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]={i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,
"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},c.p="",c(c.s=
348)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},1:function(a,c,d){var b=d(28);d.d(c,"d",function(){return b.a});d.d(c,"e",function(){return b.b});d.d(c,"k",function(){return b.c});d.d(c,"l",function(){return b.d});d.d(c,"m",function(){return b.e});d.d(c,"n",function(){return b.f});d.d(c,"o",function(){return b.g});var e=d(10);d.d(c,"a",function(){return e.a});d.d(c,"b",function(){return e.b});d.d(c,"g",function(){return e.c});var f=d(34);d.d(c,
"c",function(){return f.a});d.d(c,"f",function(){return f.b});d.d(c,"h",function(){return f.c});d.d(c,"i",function(){return f.d});d.d(c,"j",function(){return f.e})},10:function(a,c,d){d(30);var b=d(31);d.d(c,"a",function(){return b.a});var e=d(32);d.d(c,"b",function(){return e.a});var f=d(33);d.d(c,"c",function(){return f.a})},11:function(a,c){a.exports=l},12:function(a,c){a.exports=h},15:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0),e=function(a){return b.a({},a,{badges:function(a){var b=
[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},16:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0),e=function(a){return b.a({},
a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===
b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},17:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0);
a=d(1);var e=Object(a.b)(function(a,c){return b.a({},c,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var m=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":
f?"markup":g?"spatiotemporal":m?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?m||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===
b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===
b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===
b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===
b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===
b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":
"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,c.type,c.typeKeywords?c.typeKeywords:[])})})},18:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0);a=d(1);var e=Object(a.b)(function(a,c){return b.a({},c,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+
('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,c)})})},19:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0);a=d(1);var e=Object(a.b)(function(a,c){return b.a({},c,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,c)})})},20:function(a,c,d){d.d(c,"a",function(){return f});var b=d(0),e=d(7),f=function(a){return b.a({},
a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},21:function(a,c,d){d.d(c,"a",function(){return f});var b=d(0),e=d(7),f=function(a){return b.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0);a=d(1);var e=Object(a.b)(function(a,c){return b.a({},c,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+
b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,c)})})},23:function(a,c,d){d.d(c,"a",function(){return e});var b=d(0);a=d(1);var e=Object(a.b)(function(a,c){return b.a({},c,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,c)})})},28:function(a,c,d){var b=d(29);d.d(c,"a",function(){return b.a});d.d(c,"b",function(){return b.b});d.d(c,"c",function(){return b.c});
d.d(c,"d",function(){return b.d});d.d(c,"e",function(){return b.e});d.d(c,"f",function(){return b.f});d.d(c,"g",function(){return b.g})},280:function(c,f){c.exports=a},29:function(a,c,d){function b(a,b){return l("children","value",a,b)}function e(a,b){return function y(a,b,c,d){var e,f=c[a];return f&&0!==f.length?v.a({},c,(e={},e[a]=f.reduce(function(c,e){return-1!==d.indexOf(e[b])&&c.push(y(a,b,e,d)),c},[]),e)):v.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?
v.a({},b,((c={})[a]=function B(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(v.a({},c,((d={})[a]=B(c[a]),d))),b):(b.push(c),b)},[]):B(b[0][a]):b}(d),c)):b}("children",a)}function m(a,b){return n("children",a,b)}function h(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||h(a,b,e,d)},void 0):void 0}function l(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:l(a,b,e,d.slice(1)):c},
void 0)}function n(a,b,c){var d;return c(v.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return n(a,b,c)}):void 0,d)))}function r(a,b,c){return n(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],v.a({},c,{value:d,children:e})}return v.a({},c,{value:d})})}d.d(c,"d",function(){return b});d.d(c,"g",function(){return e});d.d(c,"e",function(){return f});d.d(c,"f",function(){return m});d.d(c,"a",function(){return h});d.d(c,"b",function(){return l});d.d(c,"c",function(){return r});
var v=d(0)},30:function(a,c,d){console.log},31:function(a,c,d){function b(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}d.d(c,"a",function(){return b})},32:function(a,c,d){function b(a){return function m(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return m.call.apply(m,
[b].concat(c,a))}}}d.d(c,"a",function(){return b})},33:function(a,c,d){d.d(c,"a",function(){return b});var b=function(a){return function(b){13===b.keyCode&&a(b)}}},34:function(a,c,d){var b=d(35);d.d(c,"a",function(){return b.a});d.d(c,"c",function(){return b.b});d.d(c,"d",function(){return b.c});var e=d(36);d.d(c,"b",function(){return e.a});d.d(c,"e",function(){return e.b})},348:function(a,c,d){d.r(c);var b=d(0),e=d(280);a=d(9);a=d.n(a);var f=d(4);d=function(a){function c(b,c){b=a.call(this,b,c)||
this;return b.handleDropdownKeyDown=Object(f.H)(b.handleDropdownClick.bind(b)),b.state={active:!!c.startActive&&c.startActive},b.handleDropdownClick=b.handleDropdownClick.bind(b),b.handleClear=b.handleClear.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=this.tsx,b={"drp-accordion__content":!0,"drp-accordion__content--no-padding":!1===this.props.padding},c={"drp-accordion__icon":!0,"drp-accordion__icon--active":this.state.active},d=null;return this.props.clearable&&(d=a("button",{class:"drp-accordion__clear-btn",
onclick:this.handleClear},e.clear)),a("div",{key:this.props.key,classes:{"drp-accordion__section":!0},role:"tablist"},a("h4",{id:this.props.key,class:"drp-accordion__title",value:"itemType",onclick:this.handleDropdownClick,onkeydown:this.handleDropdownKeyDown,role:"tab",tabindex:"0","aria-expanded":""+this.state.active,"aria-controls":this.props.key+"-tree"},a("span",{classes:c},a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 32 32"},a("path",{d:"M28 9v5L16 26 4 14V9l12 12L28 9z"}))),
a("span",null,this.props.title),d),this.state.active?a("div",{classes:b},this.props.children):null)},c.prototype.handleDropdownClick=function(){this.setState({active:!this.state.active})},c.prototype.handleClear=function(a){a.stopPropagation();this.props.onClear()},c}(a.a);c.default=d},35:function(a,c,d){function b(a){return a.filter(function(a){return 0<a.length})}d.d(c,"b",function(){return e});d.d(c,"c",function(){return f});d.d(c,"a",function(){return b});a=d(10);var e=function(a,b,c){return c.indexOf(a)===
b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},36:function(a,c,d){function b(a){return 0===Object.keys(a).length&&a.constructor===Object}d.d(c,"a",function(){return b});d.d(c,"b",function(){return f});var e=d(0);a=d(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},37:function(a,c,d){var b=d(38);d.d(c,"b",function(){return b.a});d.d(c,"d",function(){return b.b});d.d(c,"i",function(){return b.c});var e=d(40);d.d(c,"a",
function(){return e.a});d.d(c,"e",function(){return e.b});d.d(c,"f",function(){return e.c});var f=d(41);d.d(c,"g",function(){return f.a});var m=d(42);d.d(c,"c",function(){return m.a});d.d(c,"h",function(){return m.b})},38:function(a,c,d){d.d(c,"b",function(){return r});d.d(c,"c",function(){return v});var b=d(1),e=d(15),f=d(16),m=d(17),h=d(18),l=d(19),n=d(39);d.d(c,"a",function(){return n.a});var r=function(a,c,d){return Object(b.a)(Object(l.a)(a),Object(h.a)(a),Object(m.a)(c),f.a,e.a)(d)},v=Object(b.a)(Object(b.j)("patchedDescription"),
Object(b.j)("thumbURI"),Object(b.j)("iconURI"),Object(b.j)("displayName"),Object(b.j)("badges"))},39:function(a,c,d){d.d(c,"a",function(){return b});var b={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,c,d){var b=d(1);d.d(c,"i",function(){return b.a});d.d(c,"j",function(){return b.b});d.d(c,"w",function(){return b.c});d.d(c,"x",function(){return b.d});d.d(c,"y",function(){return b.e});d.d(c,"A",
function(){return b.f});d.d(c,"H",function(){return b.g});d.d(c,"I",function(){return b.h});d.d(c,"J",function(){return b.i});d.d(c,"N",function(){return b.k});d.d(c,"O",function(){return b.l});d.d(c,"P",function(){return b.m});d.d(c,"Q",function(){return b.n});d.d(c,"R",function(){return b.o});var e=d(37);d.d(c,"z",function(){return e.a});d.d(c,"B",function(){return e.b});d.d(c,"C",function(){return e.c});d.d(c,"D",function(){return e.d});d.d(c,"E",function(){return e.e});d.d(c,"F",function(){return e.f});
d.d(c,"G",function(){return e.g});d.d(c,"L",function(){return e.h});d.d(c,"M",function(){return e.i});var f=d(43);d.d(c,"a",function(){return f.a});d.d(c,"b",function(){return f.b});d.d(c,"c",function(){return f.c});d.d(c,"d",function(){return f.d});d.d(c,"e",function(){return f.e});d.d(c,"f",function(){return f.f});d.d(c,"g",function(){return f.g});d.d(c,"h",function(){return f.h});d.d(c,"k",function(){return f.i});d.d(c,"l",function(){return f.j});d.d(c,"m",function(){return f.k});d.d(c,"n",function(){return f.l});
d.d(c,"o",function(){return f.m});d.d(c,"p",function(){return f.n});d.d(c,"q",function(){return f.o});d.d(c,"r",function(){return f.p});d.d(c,"s",function(){return f.q});d.d(c,"t",function(){return f.r});d.d(c,"u",function(){return f.s});d.d(c,"v",function(){return f.t});d.d(c,"K",function(){return f.u})},40:function(a,c,d){d.d(c,"c",function(){return m});a=d(1);var b=d(7),e=d(20),f=d(21);d.d(c,"a",function(){return b.a});d.d(c,"b",function(){return b.b});var m=Object(a.a)(e.a,f.a,b.b)},41:function(a,
c,d){d.d(c,"a",function(){return f});var b=d(1),e=d(22),f=function(a,c){return Object(b.a)(Object(e.a)(a))(c)}},42:function(a,c,d){d.d(c,"a",function(){return f});d.d(c,"b",function(){return m});var b=d(1),e=d(23),f=function(a,c){return Object(b.a)(Object(e.a)(a))(c)},m=Object(b.a)(Object(b.j)("thumbURI"))},43:function(a,c,d){var b=d(44);d.d(c,"i",function(){return b.a});d.d(c,"j",function(){return b.b});d.d(c,"k",function(){return b.c});d.d(c,"l",function(){return b.d});d.d(c,"m",function(){return b.e});
d.d(c,"n",function(){return b.f});d.d(c,"o",function(){return b.g});d.d(c,"p",function(){return b.h});d.d(c,"q",function(){return b.i});d.d(c,"r",function(){return b.j});d.d(c,"s",function(){return b.k});d.d(c,"t",function(){return b.l});d.d(c,"u",function(){return b.m});var e=d(46);d.d(c,"a",function(){return e.a});d.d(c,"b",function(){return e.b});d.d(c,"c",function(){return e.c});d.d(c,"d",function(){return e.d});d.d(c,"e",function(){return e.e});d.d(c,"f",function(){return e.f});d.d(c,"g",function(){return e.g});
d.d(c,"h",function(){return e.h})},44:function(a,c,d){var b=d(6);d.d(c,"b",function(){return b.a});d.d(c,"c",function(){return b.b});d.d(c,"d",function(){return b.c});d.d(c,"e",function(){return b.d});d.d(c,"f",function(){return b.e});d.d(c,"g",function(){return b.g});d.d(c,"h",function(){return b.h});d.d(c,"i",function(){return b.i});d.d(c,"j",function(){return b.j});d.d(c,"k",function(){return b.k});d.d(c,"l",function(){return b.l});d.d(c,"m",function(){return b.m});var e=d(45);d.d(c,"a",function(){return e.a})},
45:function(a,c,d){d.d(c,"a",function(){return f});var b=d(12),e=d(6),f=function(a,c,d,f){function g(b){B=b.categorySchema[0].source.split(".")[1];Object(e.c)(a,c,d.contentCategorySetsGroupQuery).then(k,l);Object(e.m)(a,c.restUrl+"/portals/regions",{culture:f}).then(h,l)}function k(b){b.results[0]?Object(e.m)(a,c.restUrl+"/content/groups/"+b.results[0].id+"/search",{q:"typekeywords: "+B}).then(m,l):l("The content category sets group could not be found.")}function m(b){1===b.results.length&&b.results[0]?
Object(e.f)(a,c,b.results[0].id).then(n,l):l("The item containing the living atlas categories could not be determined.")}function n(a){z=a.categorySchema[0];d.isPortal&&F?p([z]):F&&p([z,F])}function h(a){F={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};d.isPortal&&z?p([z]):z&&p([z,F])}function p(a){A.resolve({schema:a,
id:q})}function l(a){A.reject(a)}void 0===f&&(f="en");var q,B,z,F,A=new b;return Object(e.c)(a,c,d.livingAtlasGroupQuery).then(function(b){b.results[0]&&b.results[0].id?(q=b.results[0].id,Object(e.d)(a,c,q).then(g,l)):l("The living atlas group could not be found.")},l),A}},46:function(a,c,d){var b=d(47);d.d(c,"a",function(){return b.a});var e=d(48);d.d(c,"d",function(){return e.a});var f=d(49);d.d(c,"e",function(){return f.a});var m=d(50);d.d(c,"f",function(){return m.a});var h=d(51);d.d(c,"g",function(){return h.a});
d.d(c,"h",function(){return h.b});var l=d(52);d.d(c,"b",function(){return l.a});d.d(c,"c",function(){return l.b})},47:function(a,c,d){d.d(c,"a",function(){return b});a=d(1);var b=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,c,d){d.d(c,"a",function(){return b});a=d(1);var b=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,c,d){function b(a){return'(type:"'+a.join('" OR type:"')+'")'}d.d(c,"a",function(){return e});a=d(1);
var e=Object(a.b)(function(a,c,d){var e=c.itemTypeFilter,f=c.allowedItemTypes;c=c.specialItemQ;return e?d.concat([a[e.value]+" AND ("+b(f)+(c?" OR ("+c+")":"")+")"]):c?d.concat(["("+b(f)+" OR ("+c+"))"]):d.concat([b(f)])})},50:function(a,c,d){d.d(c,"a",function(){return b});a=d(1);var b=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,c,d){d.d(c,"b",function(){return b});d.d(c,"a",function(){return e});a=d(1);var b=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,c,d){d.d(c,"b",function(){return b});d.d(c,"a",function(){return e});a=d(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var b=a("modified"),e=a("uploaded")},6:function(a,c,d){function b(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}d.d(c,"i",function(){return h});d.d(c,"f",function(){return l});d.d(c,"c",function(){return n});d.d(c,"d",function(){return r});d.d(c,"g",function(){return v});
d.d(c,"h",function(){return u});d.d(c,"a",function(){return w});d.d(c,"b",function(){return t});d.d(c,"j",function(){return y});d.d(c,"k",function(){return C});d.d(c,"l",function(){return x});d.d(c,"e",function(){return B});d.d(c,"m",function(){return e});var f=d(0),m=d(11),h=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},l=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},n=function(a,b,c){return e(a,b.restUrl+"/community/groups",{q:c})},r=function(a,
b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},v=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},u=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},w=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>c.data.start+c.data.num?w(a,b,c.data.start+
c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},t=function(a,c,d,f){return a(c.restUrl+"/community/users/"+d+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var g=f.data.provisionedListings.map(function(b){return e(a,c.restUrl+"/content/items/"+(b.id||b.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},function(a){})});return f.data.total>
f.data.start+f.data.num?t(a,c,d,f.data.start+f.data.num).then(function(a){return m(g).then(function(c){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(b(c)))})}):m(g).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(b(a))})})},y=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},C=function(a,b,c){return e(a,b.restUrl+
"/content/users/"+(c||b.user.username))},x=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},B=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},7:function(a,c,d){d.d(c,"a",function(){return e});d.d(c,"b",function(){return f});var b=d(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return b.a({},a,{baseUrl:e(a)})}},9:function(a,f){a.exports=c}})})},"arcgis-components/Buttons/Toggle":function(){define(["../Component"],
function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==
typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},h.p="",h(h.s=343)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=
null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,
arguments)}},3:function(l,h){l.exports=c},343:function(c,h,a){a.r(h);var e=a(0);c=a(3);a=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.handleToggleClick=b.handleToggleClick.bind(b),b}return e.b(c,a),c.prototype.render=function(){var a=this.tsx,c=this.props,d=c.name,e=c.childOptions,f=c.prependValue,f=f?""+f+this.props.value:this.props.value,c=!!(c.selectedToggle===f||e&&this.childSelectedRecursive(e,f)),h={"btn-toggle__item":!0,"btn-toggle__item--active":c},n={"btn-toggle__button":!0,
"btn-toggle__button--active":c},l=null;return e&&(l=a("ul",{class:"btn-toggle__sub-list",role:"group"},this.mapChildrenToToggles())),a("li",{id:f+"-option",key:f,classes:h,role:"treeitem","aria-selected":c?"true":void 0,"aria-expanded":e?c?"true":"false":void 0},a("button",{id:"toggle-"+f,key:f,classes:n,value:f,onmousedown:this.preventDefault,onclick:this.handleToggleClick,title:this.props.tooltip,tabindex:"0"},a("span",{class:"btn-toggle__text",key:"text"},d),this.props.count?a("span",{class:"btn-toggle__count",
key:"count"},"\u00a0","("+this.props.count+")"):null),c?l:null)},c.prototype.preventDefault=function(a){a.preventDefault()},c.prototype.mapChildrenToToggles=function(){var a=this,d=this.tsx,e=this.props,f=e.childOptions,h=e.selectedToggle,l=e.onToggleClick,n=e.useFullPathAsValue,r=(e=e.prependValue)?""+e+this.props.value:this.props.value;return f?f.map(function(b){return d(c,{count:b.count,key:b.value,name:b.displayName,value:n?r+"/"+b.value:b.value,showTooltip:a.props.showTooltip,tooltip:b.tooltip,
selectedToggle:h,childOptions:b.children,onToggleClick:l,useFullPathAsValue:n})}):null},c.prototype.childSelectedRecursive=function(a,c){var b=this,d=this.props,e=d.selectedToggle;return d.useFullPathAsValue?a.reduce(function(a,d){return!!(e===c+"/"+d.value||d.children&&b.childSelectedRecursive(d.children,c+"/"+d.value))||a},!1):a.reduce(function(a,c){return!!(e===c.value||c.children&&b.childSelectedRecursive(c.children,b.props.value))||a},!1)},c.prototype.handleToggleClick=function(a){a.preventDefault();
this.props.onToggleClick(this.props.prependValue?""+this.props.prependValue+this.props.value:this.props.value,this.props.name)},c}(a.n(c).a);h.default=a}})})},"arcgis-components/Dropdowns/TextOptionDropdown":function(){define(["../Component","../Dropdowns/BasicDropdown"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,
d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=
c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=353)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,
b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(h,a){h.exports=c},353:function(c,a,e){e.r(a);var f=e(0);c=e(3);c=e.n(c);var d=e(70),b=e.n(d);e=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.state={optionElements:[],numOptions:-1},b.handleOptionClick=b.handleOptionClick.bind(b),
b.mapOptionsToButtons=b.mapOptionsToButtons.bind(b),b.registerOptionElement=b.registerOptionElement.bind(b),b.handleOptionKeyDown=b.handleOptionKeyDown.bind(b),b.handleButtonKeyDown=b.handleButtonKeyDown.bind(b),b}return f.b(c,a),c.prototype.render=function(){var a=this.tsx;return a(b.a,{key:this.props.key+"-dropdown-base",handleButtonKeyDown:this.handleButtonKeyDown},this.props.children[0],a("nav",{id:this.props.key+"-option-dropdown",class:"drp-text-option__menu",classes:{"drp-text-option__menu--left":!this.props.justify||
"left"===this.props.justify,"drp-text-option__menu--right":"right"===this.props.justify},style:"\n                        background-color: white;\n                        z-index: 9999999;\n                        margin: 0px;\n                        display: block;\n                        pointer-events: all;\n                        box-shadow: 0 0 16px 0 rgba(0,0,0,0.2);\n                        border: 0;\n                    ",role:"listbox","aria-activedescendant":this.props.selectedOptionValue+
"-option"},this.mapOptionsToButtons()))},c.prototype.mapOptionsToButtons=function(){var a=this,b=this.tsx;return this.props.options.map(function(c,d){return b("button",{id:c.value+"-option",classes:{"drp-text-option__link":!0,"drp-text-option__link--active":c.value===a.props.selectedOptionValue},key:c.value,onclick:a.handleOptionClick,onkeydown:a.handleOptionKeyDown,value:c.value,dataIndex:d,afterCreate:a.registerOptionElement,role:"option","aria-selected":""+(c.value===a.props.selectedOptionValue)},
c.text)})},c.prototype.handleOptionClick=function(a){this.props.onSelect(a.target.value)},c.prototype.registerOptionElement=function(a){var b;this.setState({optionElements:f.a({},this.state.optionElements,(b={},b[a.dataIndex]=a,b)),numOptions:this.state.numOptions+1})},c.prototype.handleButtonKeyDown=function(a){a.keyCode&&40===a.keyCode&&this.state.optionElements[0]&&this.state.optionElements[0].focus()},c.prototype.handleOptionKeyDown=function(a){var b=a.target.dataIndex;switch(a.keyCode){case 40:this.state.optionElements[b+
1]?this.state.optionElements[b+1].focus():this.state.optionElements[0]&&this.state.optionElements[0].focus();break;case 38:this.state.optionElements[b-1]?this.state.optionElements[b-1].focus():this.state.optionElements[this.state.numOptions]&&this.state.optionElements[this.state.numOptions].focus()}},c}(c.a);a.default=e},70:function(c,a){c.exports=l}})})},"arcgis-components/Dropdowns/BasicDropdown":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;
var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),
Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},h.p="",h(h.s=350)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,
"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},350:function(c,h,a){a.r(h);
var e=a(0);c=a(3);a=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.state={active:!1},b.handleBtnClick=b.handleBtnClick.bind(b),b.handleDropdownClick=b.handleDropdownClick.bind(b),b.handleButtonKeyDown=b.handleButtonKeyDown.bind(b),b.registerCloseHandler=b.registerCloseHandler.bind(b),b.close=b.close.bind(b),b}return e.b(c,a),c.prototype.render=function(){var a=this.tsx,c=void 0===this.props.active?this.state.active:this.props.active,d=this.props.children[0],e=null;c&&(e=this.props.children[1]);
var f=null;return c&&(f=a("div",{key:"open-dropdown-hook",id:this.props.key+"-hook",afterCreate:this.registerCloseHandler,style:"display: none;"})),a("div",{class:"drp-basic__container",onclick:this.handleDropdownClick},f,a("span",{id:this.props.key,class:"drp-basic__button",onclick:this.handleBtnClick,onkeydown:this.handleButtonKeyDown,role:"button",tabindex:this.props.tabindex?this.props.tabindex:"0"},d),e)},c.prototype.componentWillReceiveProps=function(a){!0===this.props.active&&!1===a.active&&
document.body.removeEventListener("click",this.close)},c.prototype.close=function(){void 0===this.props.active?this.setState({active:!1}):this.props.onToggle&&this.props.onToggle();document.body.removeEventListener("click",this.close)},c.prototype.handleBtnClick=function(a){a.stopPropagation();void 0===this.props.active?this.setState({active:!this.state.active}):this.props.onToggle?this.props.onToggle():this.setState({active:!this.state.active})},c.prototype.handleDropdownClick=function(a){a.stopPropagation();
this.setState({active:!this.state.active})},c.prototype.handleButtonKeyDown=function(a){13===a.keyCode||32===a.keyCode?(a.preventDefault(),this.handleBtnClick(a)):this.props.handleButtonKeyDown&&this.props.handleButtonKeyDown(a)},c.prototype.registerCloseHandler=function(){document.body.addEventListener("click",this.close)},c}(a.n(c).a);h.default=a}})})},"arcgis-components/Badges/Authoritative":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;
var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),
Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=329)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},329:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=
a.tsx,c=a.altOrg;return b(d.a,{backgroundColor:"#DDEEDB",textColor:"#2B622B",key:"authoritative-badge",size:a.size,text:f.authoritative,title:c?f.tooltips.altAuthoritative+" "+c:f.tooltips.authoritative,tooltip:a.tooltip?f.tooltips.authoritative:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{fill:"none",d:"M0 0h16v16H0z"}),b("g",{fill:"#2B622B"},b("path",{d:"M8 0a8 8 0 1 0 8 8 8.01 8.01 0 0 0-8-8zm0 15a7 7 0 1 1 7-7 7.008 7.008 0 0 1-7 7z"}),
b("path",{d:"M11.834 5.146l-5.646 5.647-2.334-2.334a.5.5 0 0 0-.708.707l3.042 3.041 6.353-6.353a.5.5 0 1 0-.707-.707z"}))))}}})})},"arcgis-components/Badges/Badge":function(){define(function(){return function(c){function l(a){if(h[a])return h[a].exports;var e=h[a]={i:a,l:!1,exports:{}};return c[a].call(e.exports,e,e.exports,l),e.l=!0,e.exports}var h={};return l.m=c,l.c=h,l.d=function(a,c,f){l.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:f})},l.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},l.t=function(a,c){if((1&c&&(a=l(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(l.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var d in a)l.d(e,d,function(b){return a[b]}.bind(null,d));return e},l.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return l.d(c,"a",c),
c},l.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},l.p="",l(l.s=330)}({330:function(c,l,h){h.r(l);l.default=function(a){var c=a.tsx,f=a.key,d=a.size,b=a.text,g=a.title,k=a.tooltip,m=a.tooltipDirection,h=a.backgroundColor,l=a.textColor;a=a.children;m={"qual-badge__container":!0,"qual-badge__container--small":"small"===d,"qual-badge__container--tooltip":!!k,"qual-badge__container--tooltip-left":"left"===m,"qual-badge__container--tooltip-top":"top"===m,"qual-badge__container--tooltip-right":"right"===
m,"tooltip-bottom":!m||"bottom"===m,"tooltip-left":"left"===m,"tooltip-top":"top"===m,"tooltip-right":"right"===m};return"small"===d?c("span",{key:f+"-small",classes:m,class:"qual-badge__container--small","aria-label":k,style:"background-color: "+h+"; color: "+l+";",title:k?void 0:g},a):c("span",{key:f+"-regular",classes:m,class:"qual-badge__container--regular","aria-label":k,style:"background-color: "+h+"; color: "+l+";",title:g},c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",
viewBox:"0 0 16 16"},a),c("span",{class:"qual-badge__text"},b))}}})})},"arcgis-components/Badges/Deprecated":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&
Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};
return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=332)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},332:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx;return b(d.a,{backgroundColor:"#F3DED7",textColor:"#8C2907",key:"deprecated-badge",size:a.size,text:f.deprecated,title:f.tooltips.deprecated,tooltip:a.tooltip?f.tooltips.deprecated:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",
width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{fill:"none",d:"M0 0h16v16H0z"}),b("path",{fill:"#8C2907",d:"M8 0a8 8 0 1 0 8 8 8.01 8.01 0 0 0-8-8zM1 8a6.99 6.99 0 0 1 11.577-5.284l-9.861 9.861A6.964 6.964 0 0 1 1 8zm7 7a6.964 6.964 0 0 1-4.577-1.716l9.861-9.861A6.99 6.99 0 0 1 8 15z"})))}}})})},"arcgis-components/Badges/LivingAtlas":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]=
{i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,
"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=333)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},333:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx;return b(d.a,{backgroundColor:"#DBEDFA",
textColor:"#196FA6",key:"living-atlas-badge",size:a.size,text:f.livingAtlas,title:f.tooltips.livingAtlas,tooltip:a.tooltip?f.tooltips.livingAtlas:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},b("rect",{width:"16",height:"16",fill:"none"}),b("rect",{width:"16",height:"16",fill:"none"}),b("g",null,b("path",{d:"M14.75342,4.57031a.50021.50021,0,0,0-.84277-.53906,5.85956,5.85956,0,0,1-1.04541,1.12939A27.86114,27.86114,0,0,1,8.5,8.19922a27.48671,27.48671,0,0,1-4.81445,2.26172,5.9062,5.9062,0,0,1-1.50049.34033.5.5,0,0,0,.022.99951L2.23,11.80029a6.51338,6.51338,0,0,0,1.46027-.30341A5.97993,5.97993,0,0,0,7.5,13.30646V15H5a.5.5,0,0,0,0,1h6a.5.5,0,0,0,0-1H8.5V13.301a5.95318,5.95318,0,0,0,5.25336-7.601A6.38549,6.38549,0,0,0,14.75342,4.57031ZM10.5,11.66357A4.99888,4.99888,0,0,1,4.75793,11.129,30.77175,30.77175,0,0,0,9,9.06543a30.80143,30.80143,0,0,0,3.9082-2.642A5.00026,5.00026,0,0,1,10.5,11.66357Z",
fill:"#196fa6"}),b("path",{d:"M7.06836,2.41943a5.00709,5.00709,0,0,1,4.71045,1.63867.50023.50023,0,1,0,.75684-.6543A6.01019,6.01019,0,0,0,6.88184,1.437a.5.5,0,0,0,.18652.98242Z",fill:"#196fa6"}),b("path",{d:"M2.80176,9.63281a.50023.50023,0,0,0,.47217-.66406A4.98907,4.98907,0,0,1,5.08917,3.29163l.22772.39441a.50008.50008,0,0,0,.86621-.5l-1-1.73193a.50008.50008,0,0,0-.86621.5l.27222.47144A5.988,5.988,0,0,0,2.32959,9.29688.49991.49991,0,0,0,2.80176,9.63281Z",fill:"#196fa6"}))))}}})})},"arcgis-components/Badges/Marketplace":function(){define(["dojo/i18n!../Badges/nls/resources",
"../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),
8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=334)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=
l},334:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx;return b(d.a,{backgroundColor:"#DDEEDB",textColor:"#2B622B",key:"marketplace-badge",size:a.size,text:f.marketplace,title:f.tooltips.marketplace,tooltip:a.tooltip?f.tooltips.marketplace:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{fill:"#196FA6",d:"M15.939 13L12.832 3h-3.65L8.033 6.68 6.811 3H3.16L.054 13H4.13l.96-3.21L6.192 13h3.594l1.104-3.17.993 3.17h4.056zM3.386 12H1.41l2.486-8h1.881l-2.391 8zm2.196-3.856l.893-2.983 1.048 3.156-.895 2.871-1.046-3.044zM9.075 12H7.422l2.496-8h1.943l-2.786 8zm3.409-6.749L14.583 12h-1.966l-1.176-3.755 1.043-2.994z"})))}}})})},
"arcgis-components/Badges/OpenData":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});
Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},a.p="",a(a.s=335)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},335:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx;return b(d.a,{backgroundColor:"#DDEEDB",textColor:"#2B622B",key:"open-data-badge",size:a.size,text:f.openData,title:f.tooltips.openData,tooltip:a.tooltip?f.tooltips.openData:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{fill:"none",
d:"M0 0h16v16H0z"}),b("g",{fill:"#196fa6"},b("path",{d:"M8 1C4.58 1 2 2.29 2 4s2.58 3 6 3a8.628 8.628 0 0 0 5-1.297v5.334a.5.5 0 0 0 1 0V4c0-1.71-2.58-3-6-3zm0 5C5.138 6 3 4.944 3 4s2.138-2 5-2 5 1.056 5 2-2.138 2-5 2zM13.5 12.5a.5.5 0 0 0-.5.5v.064C13 13.96 10.816 15 8 15s-5-1.04-5-1.936V8.85a11.968 11.968 0 0 0 5 .984.5.5 0 0 0 0-1A10.146 10.146 0 0 1 2.815 7.62a.484.484 0 0 0-.799.3c-.002.013-.006.025-.007.037C2.007 7.972 2 7.985 2 8v5.064C2 14.902 5.05 16 8 16s6-1.098 6-2.936V13a.5.5 0 0 0-.5-.5z"}))))}}})})},
"arcgis-components/Badges/Premium":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});
Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},a.p="",a(a.s=336)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},336:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx,c=a.user,c=c?c.orgId?"Org":"Public":"Anon";return b(d.a,{backgroundColor:"#DBEDFA",textColor:"#196FA6",key:"premium-badge",size:a.size,text:f.premium,title:f.tooltips["premium"+c],tooltip:a.tooltip?f.tooltips["premium"+c]:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",
viewBox:"0 0 16 16"},b("path",{fill:"none",d:"M0 0h16v16H0z"}),b("path",{fill:"none",d:"M0 0h16v16H0z"}),b("path",{d:"M8.05 15.5a.497.497 0 0 1-.25-.067C.6 11.275 1.542 2.038 1.552 1.944a.5.5 0 0 1 .259-.382.507.507 0 0 1 .463-.009 5.15 5.15 0 0 0 5.459-.94.5.5 0 0 1 .64.006c1.817 1.54 3.601 1.844 5.457.932a.5.5 0 0 1 .718.394 16.944 16.944 0 0 1-.344 4.965.5.5 0 1 1-.978-.211 16.952 16.952 0 0 0 .367-3.962 5.57 5.57 0 0 1-5.55-1.098A6.178 6.178 0 0 1 2.51 2.706c-.057 2.086.231 8.651 5.79 11.86a.5.5 0 0 1-.25.934z",
fill:"#196fa6"}),b("path",{d:"M12 15.5a4 4 0 1 1 4-4 4.005 4.005 0 0 1-4 4zm0-7a3 3 0 1 0 3 3 3.003 3.003 0 0 0-3-3z",fill:"#196fa6"})))}}})})},"arcgis-components/Badges/Subscriber":function(){define(["dojo/i18n!../Badges/nls/resources","../Badges/Badge"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,
d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=
c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=337)}({24:function(h,a){h.exports=c},27:function(c,a){c.exports=l},337:function(c,a,e){e.r(a);var f=e(24);c=e(27);var d=e.n(c);a.default=function(a){var b=a.tsx,c=a.user,c=c?c.orgId?"Org":"Public":"Anon";return b(d.a,{backgroundColor:"#DBEDFA",textColor:"#196FA6",key:"subscriber-badge",size:a.size,text:f.subscriber,title:f.tooltips["subscriber"+
c],tooltip:a.tooltip?f.tooltips["subscriber"+c]:void 0,tooltipDirection:a.tooltipDirection},b("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},b("path",{d:"M8.05371,15.5H8.0498a.49939.49939,0,0,1-.25-.06689C.59961,11.27539,1.542,2.0376,1.55225,1.94434A.49966.49966,0,0,1,1.811,1.56152a.50721.50721,0,0,1,.46338-.0083A5.15007,5.15007,0,0,0,7.73291.61328a.51762.51762,0,0,1,.6377,0,5.14642,5.14642,0,0,0,5.4585.93994.50711.50711,0,0,1,.46338.0083.49966.49966,0,0,1,.25879.38281c.01025.09326.95264,9.33105-6.24756,13.48877A.49939.49939,0,0,1,8.05371,15.5Zm0-.5h0ZM2.50977,2.70557c-.05615,2.05469.22266,8.45508,5.542,11.71387,5.31934-3.25879,5.59814-9.65967,5.542-11.71387a6.17691,6.17691,0,0,1-5.542-1.07324A6.18289,6.18289,0,0,1,2.50977,2.70557Z",
fill:"#196fa6"})))}}})})},"arcgis-components/Filters/CreatedFilter/index":function(){define(["../../Component","../../Dropdowns/AccordionDropdown/index","../../DateSelection/DateRangeSelector/index","dojo/i18n!../../Filters/CreatedFilter/nls/resources"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]={i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,
d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=
a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},c.p="",c(c.s=355)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,
b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},102:function(a,c){a.exports=h},135:function(c,f){c.exports=a},26:function(a,c){a.exports=l},355:function(a,c,d){d.r(c);var b=d(0),e=d(135);a=d(9);a=d.n(a);var f=d(26),m=d.n(f),f=d(102),h=d.n(f);d=function(a){function c(b,c){b=a.call(this,
b,c)||this;return b.handleDateRangeSelect=b.handleDateRangeSelect.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=this.tsx;return a(m.a,{key:"created-filter-accordion",title:e.dateCreated,clearable:!!this.props.dateCreatedFilter,onClear:this.handleClearFilter},a("ul",{"aria-label":e.dateCreated,class:"ftr-created__tree",id:"created-filter-accordion-tree",role:"tree"},a(h.a,{key:"date-range-selector",selectedOption:this.props.dateCreatedSection,
range:this.props.dateCreatedFilter,onDateRangeSelect:this.handleDateRangeSelect})))},c.prototype.handleDateRangeSelect=function(a,b){this.props.onDateCreatedSelect(a,b)},c.prototype.handleClearFilter=function(){this.props.onDateCreatedSelect()},c}(a.a);c.default=d},9:function(a,f){a.exports=c}})})},"arcgis-components/DateSelection/DateRangeSelector/index":function(){define(["../../Component","../../Buttons/Toggle","dojo/date/locale","dojo/i18n!../../DateSelection/DateRangeSelector/nls/resources",
"../../DateSelection/DatePicker"],function(c,l,h,a,e){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var b={};return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,
b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=346)}({0:function(a,c,b){function d(a,b){function c(){this.constructor=
a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}b.d(c,"b",function(){return d});b.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,
arguments)}},126:function(a,c,b){var d=b(0),e=b(61),f=b(56);c.a=function(a,b){var c=new Date,g=c.getTime();c.setHours(0,0,0,0);c=c.getTime();switch(a){case "today":return{start:c,end:g,label:e.today};case "yesterday":return{start:c-864E5,end:c,label:e.yesterday};case "last7Days":return{start:g-6048E5,end:g,label:e.last7Days};case "last30Days":return{start:g-2592E6,end:g,label:e.last30Days};case "custom":if(b)return a=f.format(new Date(b.start),{selector:"date",formatLength:"short"}),g=f.format(new Date(b.end),
{selector:"date",formatLength:"short"}),d.a({},b,{label:a+"\u2014"+g})}}},132:function(a,c){a.exports=e},278:function(a,c,b){var d=b(0);a=b(9);a=b.n(a);var e=b(55),f=b.n(e);b=function(a){function b(b,c){return a.call(this,b,c)||this}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx;return this.props.options.map(function(c){return b(f.a,{key:c.value,name:c.displayName,value:c.value,selectedToggle:a.props.selectedOption,childOptions:c.childOptions,onToggleClick:a.props.handleOptionClick})})},
b}(a.a);c.a=b},346:function(a,c,b){b.r(c);var d=b(0),e=b(61);a=b(9);a=b.n(a);var f=b(132),h=b.n(f),l=b(278),n=b(126);b=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.state={uid:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5),customStart:"custom"===c.selectedOption&&c.range?new Date(c.range.start):void 0,customEnd:"custom"===c.selectedOption&&c.range?new Date(c.range.end):void 0,customRange:"custom"===c.selectedOption&&c.range?c.range:void 0,options:[{value:"today",displayName:e.today},
{value:"yesterday",displayName:e.yesterday},{value:"last7Days",displayName:e.last7Days},{value:"last30Days",displayName:e.last30Days},{value:"custom",displayName:e.custom}]},b.handleFromDateChange=b.handleFromDateChange.bind(b),b.handleToDateChange=b.handleToDateChange.bind(b),b.handleOptionClick=b.handleOptionClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx,b={hide:"custom"!==this.props.selectedOption,"margin-left-1":!0,"margin-right-0":!0,date__selector:!0,"date__selector--hide":"custom"!==
this.props.selectedOption};return a("div",null,a(l.a,{key:"date-range-static-toggles",options:this.state.options,selectedOption:this.props.selectedOption,customRange:this.state.customRange,handleOptionClick:this.handleOptionClick}),a("div",{classes:b},a("label",null,e.from,a("div",{class:"date-selector__pick-wrapper"},a(h.a,{key:"from-picker-"+this.state.uid,onDateChange:this.handleFromDateChange,value:this.state.customStart,constraints:this.state.customEnd?{max:this.state.customEnd}:void 0}))),a("label",
null,e.to,a("div",{class:"date-selector__pick-wrapper"},a(h.a,{key:"to-picker-"+this.state.uid,onDateChange:this.handleToDateChange,value:this.state.customEnd,constraints:this.state.customStart?{min:this.state.customStart}:void 0})))))},b.prototype.handleFromDateChange=function(a){this.state.customEnd?(this.setState({customStart:a,customRange:{start:a.getTime(),end:this.state.customEnd.getTime()}}),this.props.onDateRangeSelect("custom",Object(n.a)("custom",this.state.customRange))):this.setState({customStart:a})},
b.prototype.handleToDateChange=function(a){this.state.customStart?(this.setState({customEnd:a,customRange:{start:this.state.customStart.getTime(),end:a.getTime()}}),this.props.onDateRangeSelect("custom",Object(n.a)("custom",this.state.customRange))):this.setState({customEnd:a})},b.prototype.handleOptionClick=function(a){this.props.selectedOption===a?this.props.onDateRangeSelect():this.props.onDateRangeSelect(a,Object(n.a)(a,this.state.customRange))},b}(a.a);c.default=b},55:function(a,c){a.exports=
l},56:function(a,c){a.exports=h},61:function(c,d){c.exports=a},9:function(a,d){a.exports=c}})})},"arcgis-components/DateSelection/DatePicker":function(){define(["../Component","dijit/form/DateTextBox"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=
typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};
return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=347)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},
b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},279:function(c,a){c.exports=l},3:function(h,a){h.exports=c},347:function(c,a,e){e.r(a);var f=e(0);c=e(3);c=e.n(c);var d=e(279);e=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.processDijit=b.processDijit.bind(b),b.createDijit=b.createDijit.bind(b),b.handleDateChange=b.handleDateChange.bind(b),
b}return f.b(b,a),b.prototype.render=function(){return(0,this.tsx)("div",{key:this.props.key,id:this.props.key,class:"margin-right-1",afterCreate:this.processDijit})},b.prototype.componentWillReceiveProps=function(a){a.constraints!==this.props.constraints&&this.state.dijit&&this.state.dijit.textbox&&this.state.dijit.set("constraints",f.a({},a.constraints))},b.prototype.processDijit=function(a){this.state.dijit&&this.state.dijit.destroy();a=this.createDijit(a);a.on("change",this.handleDateChange);
this.setState({dijit:a})},b.prototype.createDijit=function(a){return new d({value:this.props.value,constraints:f.a({},this.props.constraints),region:"ignore"},a)},b.prototype.handleDateChange=function(a){this.props.onDateChange(a)},b}(c.a);a.default=e}})})},"arcgis-components/Filters/FolderFilter/index":function(){define(["../../Component","dojo/promise/all","dojo/Deferred","../../Dropdowns/AccordionDropdown/index","dojo/i18n!../../Filters/FolderFilter/nls/resources"],function(c,l,h,a,e){return function(a){function c(d){if(b[d])return b[d].exports;
var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var b={};return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),
Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=356)}({0:function(a,c,b){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}b.d(c,
"b",function(){return d});b.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},1:function(a,c,b){var d=b(28);b.d(c,"d",function(){return d.a});
b.d(c,"e",function(){return d.b});b.d(c,"k",function(){return d.c});b.d(c,"l",function(){return d.d});b.d(c,"m",function(){return d.e});b.d(c,"n",function(){return d.f});b.d(c,"o",function(){return d.g});var e=b(10);b.d(c,"a",function(){return e.a});b.d(c,"b",function(){return e.b});b.d(c,"g",function(){return e.c});var f=b(34);b.d(c,"c",function(){return f.a});b.d(c,"f",function(){return f.b});b.d(c,"h",function(){return f.c});b.d(c,"i",function(){return f.d});b.d(c,"j",function(){return f.e})},
10:function(a,c,b){b(30);var d=b(31);b.d(c,"a",function(){return d.a});var e=b(32);b.d(c,"b",function(){return e.a});var f=b(33);b.d(c,"c",function(){return f.a})},11:function(a,c){a.exports=l},12:function(a,c){a.exports=h},15:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0),e=function(a){return d.a({},a,{badges:function(a){var b=[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):
"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},16:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0),e=function(a){return d.a({},a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?
"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===
b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},17:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||
"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var m=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":f?"markup":g?"spatiotemporal":m?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?m||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":
"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===
b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===
b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===
b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||
-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":
"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":
"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},18:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},19:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,
b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},20:function(a,c,b){b.d(c,"a",function(){return f});var d=b(0),e=b(7),f=function(a){return d.a({},a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},
21:function(a,c,b){b.d(c,"a",function(){return f});var d=b(0),e=b(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},23:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=
Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},26:function(c,d){c.exports=a},28:function(a,c,b){var d=b(29);b.d(c,"a",function(){return d.a});b.d(c,"b",function(){return d.b});b.d(c,"c",function(){return d.c});b.d(c,"d",function(){return d.d});b.d(c,"e",function(){return d.e});b.d(c,"f",function(){return d.f});b.d(c,"g",function(){return d.g})},
29:function(a,c,b){function d(a,b){return n("children","value",a,b)}function e(a,b){return function C(a,b,c,d){var e,f=c[a];return f&&0!==f.length?u.a({},c,(e={},e[a]=f.reduce(function(c,e){return-1!==d.indexOf(e[b])&&c.push(C(a,b,e,d)),c},[]),e)):u.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?u.a({},b,((c={})[a]=function z(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(u.a({},c,((d={})[a]=z(c[a]),
d))),b):(b.push(c),b)},[]):z(b[0][a]):b}(d),c)):b}("children",a)}function h(a,b){return r("children",a,b)}function l(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||l(a,b,e,d)},void 0):void 0}function n(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:n(a,b,e,d.slice(1)):c},void 0)}function r(a,b,c){var d;return c(u.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return r(a,b,c)}):void 0,d)))}function v(a,b,c){return r(a,c,function(c){var d=c[b];
if(delete c[b],c[a]){var e=c[a];return delete c[a],u.a({},c,{value:d,children:e})}return u.a({},c,{value:d})})}b.d(c,"d",function(){return d});b.d(c,"g",function(){return e});b.d(c,"e",function(){return f});b.d(c,"f",function(){return h});b.d(c,"a",function(){return l});b.d(c,"b",function(){return n});b.d(c,"c",function(){return v});var u=b(0)},30:function(a,c,b){console.log},31:function(a,c,b){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,
b){return b(a)},b)}}b.d(c,"a",function(){return d})},32:function(a,c,b){function d(a){return function p(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return p.call.apply(p,[b].concat(c,a))}}}b.d(c,"a",function(){return d})},33:function(a,c,b){b.d(c,"a",function(){return d});var d=function(a){return function(b){13===b.keyCode&&a(b)}}},34:function(a,c,
b){var d=b(35);b.d(c,"a",function(){return d.a});b.d(c,"c",function(){return d.b});b.d(c,"d",function(){return d.c});var e=b(36);b.d(c,"b",function(){return e.a});b.d(c,"e",function(){return e.b})},35:function(a,c,b){function d(a){return a.filter(function(a){return 0<a.length})}b.d(c,"b",function(){return e});b.d(c,"c",function(){return f});b.d(c,"a",function(){return d});a=b(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&
(c[b[a]]=!0,!0)})})},356:function(a,c,b){b.r(c);var d=b(0),e=b(86);a=b(9);a=b.n(a);var f=b(26),h=b.n(f),l=b(4);b=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleToggleKeyDown=Object(l.H)(b.handleToggleFilter.bind(b)),b.state={filterString:""},b.handleFilterStringChange=b.handleFilterStringChange.bind(b),b.handleToggleFilter=b.handleToggleFilter.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b.mapFoldersToLinks=b.mapFoldersToLinks.bind(b),b}return d.b(b,a),b.prototype.render=
function(){var a=this.tsx;return a(h.a,{key:"folder-accordion",title:e.folders,clearable:!!this.props.folderFilter,onClear:this.handleClearFilter,padding:!1},a("div",{class:"ftr-folder__input-area"},a("input",{id:"filter-folder-filters",type:"search",placeholder:e.filterFolders,"aria-label":e.filterFolders,oninput:this.handleFilterStringChange,value:this.state.filterString})),a("ul",{id:"folder-accordion-tree",class:"ftr-folder__list"},this.mapFoldersToLinks()))},b.prototype.handleFilterStringChange=
function(a){this.setState({filterString:a.target.value})},b.prototype.handleToggleFilter=function(a){var b=a.target.dataset;a=b.id;b=b.title;this.props.folderFilter&&this.props.folderFilter.id===a||this.props.onFolderSelect({id:a,title:b})},b.prototype.handleClearFilter=function(){this.props.folderFilter&&this.props.onFolderSelect()},b.prototype.preventCloseDropdown=function(a){a.stopPropagation()},b.prototype.mapFoldersToLinks=function(){var a=this,b=this.tsx,c={"ftr-folder__link":!0,"ftr-folder__link--active":!this.props.folderFilter};
return this.props.availableFolders?[b("li",{class:"ftr-folder__item",key:"all-user-content"},b("a",{classes:c,"data-id":"all-folder-content","data-title":e.allFolders,onclick:this.handleClearFilter,onkeydown:this.handleToggleKeyDown,tabindex:"0"},e.allFolders))].concat(this.props.availableFolders.filter(function(b){return-1!==b.title.toLowerCase().indexOf(a.state.filterString.toLowerCase())}).map(function(e){var f=d.a({},c,{"ftr-folder__link--active":a.props.folderFilter&&a.props.folderFilter.id===
e.id,"ftr-folder__link--home":"root"===e.id});return b("li",{class:"ftr-folder__item",key:e.id},b("a",{classes:f,"data-id":e.id,"data-title":e.title,onclick:a.handleToggleFilter,onkeydown:a.handleToggleKeyDown,tabindex:"0"},e.title))})):null},b}(a.a);c.default=b},36:function(a,c,b){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}b.d(c,"a",function(){return d});b.d(c,"b",function(){return f});var e=b(0);a=b(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},
37:function(a,c,b){var d=b(38);b.d(c,"b",function(){return d.a});b.d(c,"d",function(){return d.b});b.d(c,"i",function(){return d.c});var e=b(40);b.d(c,"a",function(){return e.a});b.d(c,"e",function(){return e.b});b.d(c,"f",function(){return e.c});var f=b(41);b.d(c,"g",function(){return f.a});var h=b(42);b.d(c,"c",function(){return h.a});b.d(c,"h",function(){return h.b})},38:function(a,c,b){b.d(c,"b",function(){return v});b.d(c,"c",function(){return u});var d=b(1),e=b(15),f=b(16),h=b(17),l=b(18),n=
b(19),r=b(39);b.d(c,"a",function(){return r.a});var v=function(a,b,c){return Object(d.a)(Object(n.a)(a),Object(l.a)(a),Object(h.a)(b),f.a,e.a)(c)},u=Object(d.a)(Object(d.j)("patchedDescription"),Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},39:function(a,c,b){b.d(c,"a",function(){return d});var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,c,b){var d=b(1);b.d(c,"i",function(){return d.a});b.d(c,"j",function(){return d.b});b.d(c,"w",function(){return d.c});b.d(c,"x",function(){return d.d});b.d(c,"y",function(){return d.e});b.d(c,"A",
function(){return d.f});b.d(c,"H",function(){return d.g});b.d(c,"I",function(){return d.h});b.d(c,"J",function(){return d.i});b.d(c,"N",function(){return d.k});b.d(c,"O",function(){return d.l});b.d(c,"P",function(){return d.m});b.d(c,"Q",function(){return d.n});b.d(c,"R",function(){return d.o});var e=b(37);b.d(c,"z",function(){return e.a});b.d(c,"B",function(){return e.b});b.d(c,"C",function(){return e.c});b.d(c,"D",function(){return e.d});b.d(c,"E",function(){return e.e});b.d(c,"F",function(){return e.f});
b.d(c,"G",function(){return e.g});b.d(c,"L",function(){return e.h});b.d(c,"M",function(){return e.i});var f=b(43);b.d(c,"a",function(){return f.a});b.d(c,"b",function(){return f.b});b.d(c,"c",function(){return f.c});b.d(c,"d",function(){return f.d});b.d(c,"e",function(){return f.e});b.d(c,"f",function(){return f.f});b.d(c,"g",function(){return f.g});b.d(c,"h",function(){return f.h});b.d(c,"k",function(){return f.i});b.d(c,"l",function(){return f.j});b.d(c,"m",function(){return f.k});b.d(c,"n",function(){return f.l});
b.d(c,"o",function(){return f.m});b.d(c,"p",function(){return f.n});b.d(c,"q",function(){return f.o});b.d(c,"r",function(){return f.p});b.d(c,"s",function(){return f.q});b.d(c,"t",function(){return f.r});b.d(c,"u",function(){return f.s});b.d(c,"v",function(){return f.t});b.d(c,"K",function(){return f.u})},40:function(a,c,b){b.d(c,"c",function(){return h});a=b(1);var d=b(7),e=b(20),f=b(21);b.d(c,"a",function(){return d.a});b.d(c,"b",function(){return d.b});var h=Object(a.a)(e.a,f.a,d.b)},41:function(a,
c,b){b.d(c,"a",function(){return f});var d=b(1),e=b(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},42:function(a,c,b){b.d(c,"a",function(){return f});b.d(c,"b",function(){return h});var d=b(1),e=b(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},h=Object(d.a)(Object(d.j)("thumbURI"))},43:function(a,c,b){var d=b(44);b.d(c,"i",function(){return d.a});b.d(c,"j",function(){return d.b});b.d(c,"k",function(){return d.c});b.d(c,"l",function(){return d.d});b.d(c,"m",function(){return d.e});
b.d(c,"n",function(){return d.f});b.d(c,"o",function(){return d.g});b.d(c,"p",function(){return d.h});b.d(c,"q",function(){return d.i});b.d(c,"r",function(){return d.j});b.d(c,"s",function(){return d.k});b.d(c,"t",function(){return d.l});b.d(c,"u",function(){return d.m});var e=b(46);b.d(c,"a",function(){return e.a});b.d(c,"b",function(){return e.b});b.d(c,"c",function(){return e.c});b.d(c,"d",function(){return e.d});b.d(c,"e",function(){return e.e});b.d(c,"f",function(){return e.f});b.d(c,"g",function(){return e.g});
b.d(c,"h",function(){return e.h})},44:function(a,c,b){var d=b(6);b.d(c,"b",function(){return d.a});b.d(c,"c",function(){return d.b});b.d(c,"d",function(){return d.c});b.d(c,"e",function(){return d.d});b.d(c,"f",function(){return d.e});b.d(c,"g",function(){return d.g});b.d(c,"h",function(){return d.h});b.d(c,"i",function(){return d.i});b.d(c,"j",function(){return d.j});b.d(c,"k",function(){return d.k});b.d(c,"l",function(){return d.l});b.d(c,"m",function(){return d.m});var e=b(45);b.d(c,"a",function(){return e.a})},
45:function(a,c,b){b.d(c,"a",function(){return f});var d=b(12),e=b(6),f=function(a,b,c,f){function g(d){q=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(k,p);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(n,p)}function k(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+q}).then(m,p):p("The content category sets group could not be found.")}function m(c){1===c.results.length&&c.results[0]?
Object(e.f)(a,b,c.results[0].id).then(h,p):p("The item containing the living atlas categories could not be determined.")}function h(a){F=a.categorySchema[0];c.isPortal&&A?l([F]):A&&l([F,A])}function n(a){A={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&F?l([F]):F&&l([F,A])}function l(a){E.resolve({schema:a,
id:r})}function p(a){E.reject(a)}void 0===f&&(f="en");var r,q,F,A,E=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(r=c.results[0].id,Object(e.d)(a,b,r).then(g,p)):p("The living atlas group could not be found.")},p),E}},46:function(a,c,b){var d=b(47);b.d(c,"a",function(){return d.a});var e=b(48);b.d(c,"d",function(){return e.a});var f=b(49);b.d(c,"e",function(){return f.a});var h=b(50);b.d(c,"f",function(){return h.a});var l=b(51);b.d(c,"g",function(){return l.a});
b.d(c,"h",function(){return l.b});var n=b(52);b.d(c,"b",function(){return n.a});b.d(c,"c",function(){return n.b})},47:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,c,b){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}b.d(c,"a",function(){return e});a=b(1);
var e=Object(a.b)(function(a,b,c){var e=b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},50:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,c,b){b.d(c,"b",function(){return d});b.d(c,"a",function(){return e});a=b(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,c,b){b.d(c,"b",function(){return d});b.d(c,"a",function(){return e});a=b(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),e=a("uploaded")},6:function(a,c,b){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}b.d(c,"i",function(){return l});b.d(c,"f",function(){return n});b.d(c,"c",function(){return r});b.d(c,"d",function(){return v});b.d(c,"g",function(){return u});
b.d(c,"h",function(){return w});b.d(c,"a",function(){return t});b.d(c,"b",function(){return y});b.d(c,"j",function(){return C});b.d(c,"k",function(){return x});b.d(c,"l",function(){return B});b.d(c,"e",function(){return z});b.d(c,"m",function(){return e});var f=b(0),h=b(11),l=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},n=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},r=function(a,b,c){return e(a,b.restUrl+"/community/groups",{q:c})},v=function(a,
b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},u=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},w=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},t=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>c.data.start+c.data.num?t(a,b,c.data.start+
c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},y=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var g=f.data.provisionedListings.map(function(c){return e(a,b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},function(a){})});return f.data.total>
f.data.start+f.data.num?y(a,b,c,f.data.start+f.data.num).then(function(a){return h(g).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):h(g).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},C=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},x=function(a,b,c){return e(a,b.restUrl+
"/content/users/"+(c||b.user.username))},B=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},z=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},7:function(a,c,b){b.d(c,"a",function(){return e});b.d(c,"b",function(){return f});var d=b(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return d.a({},a,{baseUrl:e(a)})}},86:function(a,c){a.exports=e},9:function(a,d){a.exports=c}})})},"arcgis-components/Filters/GroupFilter/index":function(){define(["../../Component",
"dojo/promise/all","dojo/Deferred","../../Dropdowns/AccordionDropdown/index","dojo/i18n!../../Filters/GroupFilter/nls/resources"],function(c,l,h,a,e){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var b={};return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,
b)},c.p="",c(c.s=357)}({0:function(a,c,b){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}b.d(c,"b",function(){return d});b.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},1:function(a,c,b){var d=b(28);b.d(c,"d",function(){return d.a});b.d(c,"e",function(){return d.b});b.d(c,"k",function(){return d.c});b.d(c,"l",function(){return d.d});b.d(c,"m",function(){return d.e});b.d(c,"n",function(){return d.f});b.d(c,"o",function(){return d.g});var e=b(10);b.d(c,"a",function(){return e.a});b.d(c,"b",function(){return e.b});b.d(c,"g",function(){return e.c});var f=b(34);b.d(c,
"c",function(){return f.a});b.d(c,"f",function(){return f.b});b.d(c,"h",function(){return f.c});b.d(c,"i",function(){return f.d});b.d(c,"j",function(){return f.e})},10:function(a,c,b){b(30);var d=b(31);b.d(c,"a",function(){return d.a});var e=b(32);b.d(c,"b",function(){return e.a});var f=b(33);b.d(c,"c",function(){return f.a})},11:function(a,c){a.exports=l},12:function(a,c){a.exports=h},15:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0),e=function(a){return d.a({},a,{badges:function(a){var b=
[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},16:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0),e=function(a){return d.a({},
a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===
b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},17:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);
a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var m=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":
f?"markup":g?"spatiotemporal":m?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?m||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===
b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===
b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===
b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===
b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===
b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":
"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},18:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+
('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},19:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},20:function(a,c,b){b.d(c,"a",function(){return f});var d=b(0),e=b(7),f=function(a){return d.a({},
a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},21:function(a,c,b){b.d(c,"a",function(){return f});var d=b(0),e=b(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+
b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},23:function(a,c,b){b.d(c,"a",function(){return e});var d=b(0);a=b(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},26:function(c,d){c.exports=a},28:function(a,c,b){var d=b(29);b.d(c,"a",function(){return d.a});b.d(c,"b",function(){return d.b});
b.d(c,"c",function(){return d.c});b.d(c,"d",function(){return d.d});b.d(c,"e",function(){return d.e});b.d(c,"f",function(){return d.f});b.d(c,"g",function(){return d.g})},29:function(a,c,b){function d(a,b){return n("children","value",a,b)}function e(a,b){return function C(a,b,c,d){var e,f=c[a];return f&&0!==f.length?u.a({},c,(e={},e[a]=f.reduce(function(c,e){return-1!==d.indexOf(e[b])&&c.push(C(a,b,e,d)),c},[]),e)):u.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];
return d?u.a({},b,((c={})[a]=function z(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(u.a({},c,((d={})[a]=z(c[a]),d))),b):(b.push(c),b)},[]):z(b[0][a]):b}(d),c)):b}("children",a)}function h(a,b){return r("children",a,b)}function l(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||l(a,b,e,d)},void 0):void 0}function n(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:n(a,b,e,d.slice(1)):
c},void 0)}function r(a,b,c){var d;return c(u.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return r(a,b,c)}):void 0,d)))}function v(a,b,c){return r(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],u.a({},c,{value:d,children:e})}return u.a({},c,{value:d})})}b.d(c,"d",function(){return d});b.d(c,"g",function(){return e});b.d(c,"e",function(){return f});b.d(c,"f",function(){return h});b.d(c,"a",function(){return l});b.d(c,"b",function(){return n});b.d(c,"c",function(){return v});
var u=b(0)},30:function(a,c,b){console.log},31:function(a,c,b){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}b.d(c,"a",function(){return d})},32:function(a,c,b){function d(a){return function p(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return p.call.apply(p,
[b].concat(c,a))}}}b.d(c,"a",function(){return d})},33:function(a,c,b){b.d(c,"a",function(){return d});var d=function(a){return function(b){13===b.keyCode&&a(b)}}},34:function(a,c,b){var d=b(35);b.d(c,"a",function(){return d.a});b.d(c,"c",function(){return d.b});b.d(c,"d",function(){return d.c});var e=b(36);b.d(c,"b",function(){return e.a});b.d(c,"e",function(){return e.b})},35:function(a,c,b){function d(a){return a.filter(function(a){return 0<a.length})}b.d(c,"b",function(){return e});b.d(c,"c",
function(){return f});b.d(c,"a",function(){return d});a=b(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},357:function(a,c,b){b.r(c);var d=b(0),e=b(87);a=b(9);a=b.n(a);var f=b(26),h=b.n(f),l=b(4);b=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleToggleKeyDown=Object(l.H)(b.handleToggleFilter.bind(b)),b.state={filterString:""},b.handleFilterStringChange=b.handleFilterStringChange.bind(b),
b.handleToggleFilter=b.handleToggleFilter.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b.mapGroupsToLinks=b.mapGroupsToLinks.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a(h.a,{key:"group-accordion",title:this.props.title?this.props.title:e.groups,clearable:!!this.props.groupFilter,onClear:this.handleClearFilter,padding:!1},a("div",{class:"ftr-group__input-area"},a("input",{id:"filter-group-filters",type:"search",placeholder:e.filterGroups,"aria-label":e.filterGroups,
oninput:this.handleFilterStringChange,value:this.state.filterString})),a("ul",{id:"group-accordion-tree",class:"ftr-group__list"},this.mapGroupsToLinks()))},b.prototype.handleFilterStringChange=function(a){this.setState({filterString:a.target.value})},b.prototype.handleToggleFilter=function(a){var b=a.target.dataset;a=b.id;b=b.title;this.props.groupFilter&&this.props.groupFilter.id===a||this.props.onGroupSelect({id:a,title:b})},b.prototype.handleClearFilter=function(){this.props.groupFilter&&this.props.onGroupSelect()},
b.prototype.preventCloseDropdown=function(a){a.stopPropagation()},b.prototype.mapGroupsToLinks=function(){var a=this,b=this.tsx,c={"ftr-group__link":!0,"ftr-group__link--active":!this.props.groupFilter};return this.props.availableGroups?[b("li",{class:"ftr-group__item",key:"all-user-groups"},b("a",{classes:c,"data-id":"all-group-content","data-title":e.allGroups,onclick:this.handleClearFilter,onkeydown:this.handleToggleKeyDown,tabindex:"0"},e.allGroups))].concat(this.props.availableGroups.filter(function(b){return-1!==
b.title.toLowerCase().indexOf(a.state.filterString.toLowerCase())}).map(function(e){var f=d.a({},c,{"ftr-group__link--active":a.props.groupFilter&&a.props.groupFilter.id===e.id});return b("li",{class:"ftr-group__item",key:e.id},b("a",{classes:f,"data-id":e.id,"data-title":e.title,onclick:a.handleToggleFilter,onkeydown:a.handleToggleKeyDown,tabindex:"0"},e.title))})):null},b}(a.a);c.default=b},36:function(a,c,b){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}b.d(c,"a",function(){return d});
b.d(c,"b",function(){return f});var e=b(0);a=b(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},37:function(a,c,b){var d=b(38);b.d(c,"b",function(){return d.a});b.d(c,"d",function(){return d.b});b.d(c,"i",function(){return d.c});var e=b(40);b.d(c,"a",function(){return e.a});b.d(c,"e",function(){return e.b});b.d(c,"f",function(){return e.c});var f=b(41);b.d(c,"g",function(){return f.a});var h=b(42);b.d(c,"c",function(){return h.a});b.d(c,"h",function(){return h.b})},38:function(a,
c,b){b.d(c,"b",function(){return v});b.d(c,"c",function(){return u});var d=b(1),e=b(15),f=b(16),h=b(17),l=b(18),n=b(19),r=b(39);b.d(c,"a",function(){return r.a});var v=function(a,b,c){return Object(d.a)(Object(n.a)(a),Object(l.a)(a),Object(h.a)(b),f.a,e.a)(c)},u=Object(d.a)(Object(d.j)("patchedDescription"),Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},39:function(a,c,b){b.d(c,"a",function(){return d});var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,c,b){var d=b(1);b.d(c,"i",function(){return d.a});b.d(c,"j",function(){return d.b});b.d(c,"w",function(){return d.c});b.d(c,"x",function(){return d.d});b.d(c,"y",function(){return d.e});b.d(c,"A",
function(){return d.f});b.d(c,"H",function(){return d.g});b.d(c,"I",function(){return d.h});b.d(c,"J",function(){return d.i});b.d(c,"N",function(){return d.k});b.d(c,"O",function(){return d.l});b.d(c,"P",function(){return d.m});b.d(c,"Q",function(){return d.n});b.d(c,"R",function(){return d.o});var e=b(37);b.d(c,"z",function(){return e.a});b.d(c,"B",function(){return e.b});b.d(c,"C",function(){return e.c});b.d(c,"D",function(){return e.d});b.d(c,"E",function(){return e.e});b.d(c,"F",function(){return e.f});
b.d(c,"G",function(){return e.g});b.d(c,"L",function(){return e.h});b.d(c,"M",function(){return e.i});var f=b(43);b.d(c,"a",function(){return f.a});b.d(c,"b",function(){return f.b});b.d(c,"c",function(){return f.c});b.d(c,"d",function(){return f.d});b.d(c,"e",function(){return f.e});b.d(c,"f",function(){return f.f});b.d(c,"g",function(){return f.g});b.d(c,"h",function(){return f.h});b.d(c,"k",function(){return f.i});b.d(c,"l",function(){return f.j});b.d(c,"m",function(){return f.k});b.d(c,"n",function(){return f.l});
b.d(c,"o",function(){return f.m});b.d(c,"p",function(){return f.n});b.d(c,"q",function(){return f.o});b.d(c,"r",function(){return f.p});b.d(c,"s",function(){return f.q});b.d(c,"t",function(){return f.r});b.d(c,"u",function(){return f.s});b.d(c,"v",function(){return f.t});b.d(c,"K",function(){return f.u})},40:function(a,c,b){b.d(c,"c",function(){return h});a=b(1);var d=b(7),e=b(20),f=b(21);b.d(c,"a",function(){return d.a});b.d(c,"b",function(){return d.b});var h=Object(a.a)(e.a,f.a,d.b)},41:function(a,
c,b){b.d(c,"a",function(){return f});var d=b(1),e=b(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},42:function(a,c,b){b.d(c,"a",function(){return f});b.d(c,"b",function(){return h});var d=b(1),e=b(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},h=Object(d.a)(Object(d.j)("thumbURI"))},43:function(a,c,b){var d=b(44);b.d(c,"i",function(){return d.a});b.d(c,"j",function(){return d.b});b.d(c,"k",function(){return d.c});b.d(c,"l",function(){return d.d});b.d(c,"m",function(){return d.e});
b.d(c,"n",function(){return d.f});b.d(c,"o",function(){return d.g});b.d(c,"p",function(){return d.h});b.d(c,"q",function(){return d.i});b.d(c,"r",function(){return d.j});b.d(c,"s",function(){return d.k});b.d(c,"t",function(){return d.l});b.d(c,"u",function(){return d.m});var e=b(46);b.d(c,"a",function(){return e.a});b.d(c,"b",function(){return e.b});b.d(c,"c",function(){return e.c});b.d(c,"d",function(){return e.d});b.d(c,"e",function(){return e.e});b.d(c,"f",function(){return e.f});b.d(c,"g",function(){return e.g});
b.d(c,"h",function(){return e.h})},44:function(a,c,b){var d=b(6);b.d(c,"b",function(){return d.a});b.d(c,"c",function(){return d.b});b.d(c,"d",function(){return d.c});b.d(c,"e",function(){return d.d});b.d(c,"f",function(){return d.e});b.d(c,"g",function(){return d.g});b.d(c,"h",function(){return d.h});b.d(c,"i",function(){return d.i});b.d(c,"j",function(){return d.j});b.d(c,"k",function(){return d.k});b.d(c,"l",function(){return d.l});b.d(c,"m",function(){return d.m});var e=b(45);b.d(c,"a",function(){return e.a})},
45:function(a,c,b){b.d(c,"a",function(){return f});var d=b(12),e=b(6),f=function(a,b,c,f){function g(d){q=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(k,r);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(l,r)}function k(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+q}).then(m,r):r("The content category sets group could not be found.")}function m(c){1===c.results.length&&c.results[0]?
Object(e.f)(a,b,c.results[0].id).then(h,r):r("The item containing the living atlas categories could not be determined.")}function h(a){F=a.categorySchema[0];c.isPortal&&A?n([F]):A&&n([F,A])}function l(a){A={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&F?n([F]):F&&n([F,A])}function n(a){E.resolve({schema:a,
id:p})}function r(a){E.reject(a)}void 0===f&&(f="en");var p,q,F,A,E=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(p=c.results[0].id,Object(e.d)(a,b,p).then(g,r)):r("The living atlas group could not be found.")},r),E}},46:function(a,c,b){var d=b(47);b.d(c,"a",function(){return d.a});var e=b(48);b.d(c,"d",function(){return e.a});var f=b(49);b.d(c,"e",function(){return f.a});var h=b(50);b.d(c,"f",function(){return h.a});var l=b(51);b.d(c,"g",function(){return l.a});
b.d(c,"h",function(){return l.b});var n=b(52);b.d(c,"b",function(){return n.a});b.d(c,"c",function(){return n.b})},47:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,c,b){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}b.d(c,"a",function(){return e});a=b(1);
var e=Object(a.b)(function(a,b,c){var e=b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},50:function(a,c,b){b.d(c,"a",function(){return d});a=b(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,c,b){b.d(c,"b",function(){return d});b.d(c,"a",function(){return e});a=b(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,c,b){b.d(c,"b",function(){return d});b.d(c,"a",function(){return e});a=b(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),e=a("uploaded")},6:function(a,c,b){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}b.d(c,"i",function(){return l});b.d(c,"f",function(){return n});b.d(c,"c",function(){return r});b.d(c,"d",function(){return v});b.d(c,"g",function(){return u});
b.d(c,"h",function(){return w});b.d(c,"a",function(){return t});b.d(c,"b",function(){return y});b.d(c,"j",function(){return C});b.d(c,"k",function(){return x});b.d(c,"l",function(){return B});b.d(c,"e",function(){return z});b.d(c,"m",function(){return e});var f=b(0),h=b(11),l=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},n=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},r=function(a,b,c){return e(a,b.restUrl+"/community/groups",{q:c})},v=function(a,
b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},u=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},w=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},t=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>c.data.start+c.data.num?t(a,b,c.data.start+
c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},y=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var g=f.data.provisionedListings.map(function(c){return e(a,b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},function(a){})});return f.data.total>
f.data.start+f.data.num?y(a,b,c,f.data.start+f.data.num).then(function(a){return h(g).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):h(g).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},C=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},x=function(a,b,c){return e(a,b.restUrl+
"/content/users/"+(c||b.user.username))},B=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},z=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},7:function(a,c,b){b.d(c,"a",function(){return e});b.d(c,"b",function(){return f});var d=b(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return d.a({},a,{baseUrl:e(a)})}},87:function(a,c){a.exports=e},9:function(a,d){a.exports=c}})})},"arcgis-components/Filters/ItemTypeFilter/index":function(){define("../../Component dojo/promise/all dojo/Deferred dojo/i18n!../../Filters/ItemTypeFilter/nls/resources ../../Dropdowns/AccordionDropdown/index ../../Buttons/Toggle".split(" "),
function(c,l,h,a,e,f){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if((1&c&&(a=b(a)),8&c)||4&
c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=358)}({0:function(a,b,c){function d(a,b){function c(){this.constructor=
a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}c.d(b,"b",function(){return d});c.d(b,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,
arguments)}},1:function(a,b,c){var d=c(28);c.d(b,"d",function(){return d.a});c.d(b,"e",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});var e=c(10);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"g",function(){return e.c});var f=c(34);c.d(b,"c",function(){return f.a});c.d(b,"f",function(){return f.b});c.d(b,"h",function(){return f.c});
c.d(b,"i",function(){return f.d});c.d(b,"j",function(){return f.e})},10:function(a,b,c){c(30);var d=c(31);c.d(b,"a",function(){return d.a});var e=c(32);c.d(b,"b",function(){return e.a});var f=c(33);c.d(b,"c",function(){return f.a})},11:function(a,b){a.exports=l},12:function(a,b){a.exports=h},15:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{badges:function(a){var b=[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||
"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},16:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===
b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":
"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},17:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&
b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var m=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":f?"markup":g?"spatiotemporal":m?"featureshosted":"features"):d="map service"===b||"wms"===
b||"wmts"===b?m||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":
"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===
b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===
b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===
b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":
"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===
b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},18:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},19:function(a,b,c){c.d(b,"a",function(){return e});
var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},20:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+
a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},21:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},23:function(a,
b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},25:function(c,b){c.exports=a},26:function(a,b){a.exports=e},28:function(a,b,c){var d=c(29);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});c.d(b,"c",function(){return d.c});c.d(b,"d",function(){return d.d});
c.d(b,"e",function(){return d.e});c.d(b,"f",function(){return d.f});c.d(b,"g",function(){return d.g})},282:function(a,b,c){a=c(25);b.a=[{value:"maps",displayName:a.filters.maps,children:[{value:"webMaps",displayName:a.filters.webMaps},{value:"mapFiles",displayName:a.filters.mapFiles}]},{value:"layers",displayName:a.filters.layers,children:[{value:"featureLayers",displayName:a.filters.featureLayers},{value:"tileLayers",displayName:a.filters.tileLayers},{value:"mapImageLayers",displayName:a.filters.mapImageLayers},
{value:"imageryLayers",displayName:a.filters.imageryLayers},{value:"sceneLayers",displayName:a.filters.sceneLayers},{value:"tables",displayName:a.filters.tables}]},{value:"scenes",displayName:a.filters.scenes},{value:"apps",displayName:a.filters.apps,children:[{value:"webApps",displayName:a.filters.webApps},{value:"mobileApps",displayName:a.filters.mobileApps},{value:"desktopApps",displayName:a.filters.desktopApps}]},{value:"tools",displayName:a.filters.tools,children:[{value:"locators",displayName:a.filters.locators},
{value:"geodatabaseAccess",displayName:a.filters.geodatabaseAccess},{value:"geometricOperations",displayName:a.filters.geometricOperations},{value:"geoprocessingTasks",displayName:a.filters.geoprocessingTasks},{value:"networkAnalysis",displayName:a.filters.networkAnalysis},{value:"webTools",displayName:a.filters.webTools}]},{value:"files",displayName:a.filters.files,children:[{value:"documents",displayName:a.filters.documents},{value:"images",displayName:a.filters.images},{value:"pdfs",displayName:a.filters.pdfs}]},
{value:"notebooks",displayName:a.filters.notebooks}]},29:function(a,b,c){function d(a,b){return l("children","value",a,b)}function e(a,b){return function x(a,b,c,d){var e,f=c[a];return f&&0!==f.length?w.a({},c,(e={},e[a]=f.reduce(function(c,e){return-1!==d.indexOf(e[b])&&c.push(x(a,b,e,d)),c},[]),e)):w.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?w.a({},b,((c={})[a]=function F(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,
c){var d;return c[a]?(b.push(w.a({},c,((d={})[a]=F(c[a]),d))),b):(b.push(c),b)},[]):F(b[0][a]):b}(d),c)):b}("children",a)}function g(a,b){return v("children",a,b)}function h(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||h(a,b,e,d)},void 0):void 0}function l(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:l(a,b,e,d.slice(1)):c},void 0)}function v(a,b,c){var d;return c(w.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return v(a,b,c)}):void 0,
d)))}function u(a,b,c){return v(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],w.a({},c,{value:d,children:e})}return w.a({},c,{value:d})})}c.d(b,"d",function(){return d});c.d(b,"g",function(){return e});c.d(b,"e",function(){return f});c.d(b,"f",function(){return g});c.d(b,"a",function(){return h});c.d(b,"b",function(){return l});c.d(b,"c",function(){return u});var w=c(0)},30:function(a,b,c){console.log},31:function(a,b,c){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}c.d(b,"a",function(){return d})},32:function(a,b,c){function d(a){return function q(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return q.call.apply(q,[b].concat(c,a))}}}c.d(b,"a",function(){return d})},33:function(a,b,c){c.d(b,"a",function(){return d});var d=function(a){return function(b){13===
b.keyCode&&a(b)}}},34:function(a,b,c){var d=c(35);c.d(b,"a",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});var e=c(36);c.d(b,"b",function(){return e.a});c.d(b,"e",function(){return e.b})},35:function(a,b,c){function d(a){return a.filter(function(a){return 0<a.length})}c.d(b,"b",function(){return e});c.d(b,"c",function(){return f});c.d(b,"a",function(){return d});a=c(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};
return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},358:function(a,b,c){c.r(b);var d=c(0),e=c(25);a=c(9);a=c.n(a);var f=c(26),g=c.n(f),f=c(55),h=c.n(f),l=c(282),v=c(4);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.state={availableFilters:Object(v.P)(Object(v.R)({value:"##itemTypeOptionsRoot",children:l.a},c.availableItemTypes)).children},b.mapItemTypesToToggles=b.mapItemTypesToToggles.bind(b),b.handleToggleClick=b.handleToggleClick.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),
b}return d.b(b,a),b.prototype.render=function(){var a=this.tsx;return a(g.a,{key:"item-type-accordion",title:e.itemType,clearable:!!this.props.itemTypeFilter,onClear:this.handleClearFilter},a("ul",{"aria-label":e.itemType,id:"item-type-accordion-tree",class:"ftr-item-type__tree",role:"tree"},this.mapItemTypesToToggles()))},b.prototype.mapItemTypesToToggles=function(){var a=this,b=this.tsx;return this.state.availableFilters.map(function(c){return b(h.a,{key:c.value,name:c.displayName,value:c.value,
selectedToggle:a.props.itemTypeFilter?a.props.itemTypeFilter.value:void 0,childOptions:c.children,onToggleClick:a.handleToggleClick})})},b.prototype.handleToggleClick=function(a,b){var c=this.props.itemTypeFilter;c&&c.value===a?this.props.onItemTypeSelect():this.props.onItemTypeSelect({value:a,text:b})},b.prototype.handleClearFilter=function(){this.props.onItemTypeSelect()},b}(a.a);b.default=c},36:function(a,b,c){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}c.d(b,"a",function(){return d});
c.d(b,"b",function(){return f});var e=c(0);a=c(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},37:function(a,b,c){var d=c(38);c.d(b,"b",function(){return d.a});c.d(b,"d",function(){return d.b});c.d(b,"i",function(){return d.c});var e=c(40);c.d(b,"a",function(){return e.a});c.d(b,"e",function(){return e.b});c.d(b,"f",function(){return e.c});var f=c(41);c.d(b,"g",function(){return f.a});var g=c(42);c.d(b,"c",function(){return g.a});c.d(b,"h",function(){return g.b})},38:function(a,
b,c){c.d(b,"b",function(){return u});c.d(b,"c",function(){return w});var d=c(1),e=c(15),f=c(16),g=c(17),h=c(18),l=c(19),v=c(39);c.d(b,"a",function(){return v.a});var u=function(a,b,c){return Object(d.a)(Object(l.a)(a),Object(h.a)(a),Object(g.a)(b),f.a,e.a)(c)},w=Object(d.a)(Object(d.j)("patchedDescription"),Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},39:function(a,b,c){c.d(b,"a",function(){return d});var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,b,c){var d=c(1);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"w",function(){return d.c});c.d(b,"x",function(){return d.d});c.d(b,"y",function(){return d.e});c.d(b,"A",
function(){return d.f});c.d(b,"H",function(){return d.g});c.d(b,"I",function(){return d.h});c.d(b,"J",function(){return d.i});c.d(b,"N",function(){return d.k});c.d(b,"O",function(){return d.l});c.d(b,"P",function(){return d.m});c.d(b,"Q",function(){return d.n});c.d(b,"R",function(){return d.o});var e=c(37);c.d(b,"z",function(){return e.a});c.d(b,"B",function(){return e.b});c.d(b,"C",function(){return e.c});c.d(b,"D",function(){return e.d});c.d(b,"E",function(){return e.e});c.d(b,"F",function(){return e.f});
c.d(b,"G",function(){return e.g});c.d(b,"L",function(){return e.h});c.d(b,"M",function(){return e.i});var f=c(43);c.d(b,"a",function(){return f.a});c.d(b,"b",function(){return f.b});c.d(b,"c",function(){return f.c});c.d(b,"d",function(){return f.d});c.d(b,"e",function(){return f.e});c.d(b,"f",function(){return f.f});c.d(b,"g",function(){return f.g});c.d(b,"h",function(){return f.h});c.d(b,"k",function(){return f.i});c.d(b,"l",function(){return f.j});c.d(b,"m",function(){return f.k});c.d(b,"n",function(){return f.l});
c.d(b,"o",function(){return f.m});c.d(b,"p",function(){return f.n});c.d(b,"q",function(){return f.o});c.d(b,"r",function(){return f.p});c.d(b,"s",function(){return f.q});c.d(b,"t",function(){return f.r});c.d(b,"u",function(){return f.s});c.d(b,"v",function(){return f.t});c.d(b,"K",function(){return f.u})},40:function(a,b,c){c.d(b,"c",function(){return g});a=c(1);var d=c(7),e=c(20),f=c(21);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});var g=Object(a.a)(e.a,f.a,d.b)},41:function(a,
b,c){c.d(b,"a",function(){return f});var d=c(1),e=c(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},42:function(a,b,c){c.d(b,"a",function(){return f});c.d(b,"b",function(){return g});var d=c(1),e=c(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},g=Object(d.a)(Object(d.j)("thumbURI"))},43:function(a,b,c){var d=c(44);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});
c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});c.d(b,"p",function(){return d.h});c.d(b,"q",function(){return d.i});c.d(b,"r",function(){return d.j});c.d(b,"s",function(){return d.k});c.d(b,"t",function(){return d.l});c.d(b,"u",function(){return d.m});var e=c(46);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"c",function(){return e.c});c.d(b,"d",function(){return e.d});c.d(b,"e",function(){return e.e});c.d(b,"f",function(){return e.f});c.d(b,"g",function(){return e.g});
c.d(b,"h",function(){return e.h})},44:function(a,b,c){var d=c(6);c.d(b,"b",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});c.d(b,"e",function(){return d.d});c.d(b,"f",function(){return d.e});c.d(b,"g",function(){return d.g});c.d(b,"h",function(){return d.h});c.d(b,"i",function(){return d.i});c.d(b,"j",function(){return d.j});c.d(b,"k",function(){return d.k});c.d(b,"l",function(){return d.l});c.d(b,"m",function(){return d.m});var e=c(45);c.d(b,"a",function(){return e.a})},
45:function(a,b,c){c.d(b,"a",function(){return f});var d=c(12),e=c(6),f=function(a,b,c,f){function g(d){q=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(k,p);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(l,p)}function k(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+q}).then(h,p):p("The content category sets group could not be found.")}function h(c){1===c.results.length&&c.results[0]?
Object(e.f)(a,b,c.results[0].id).then(m,p):p("The item containing the living atlas categories could not be determined.")}function m(a){v=a.categorySchema[0];c.isPortal&&E?n([v]):E&&n([v,E])}function l(a){E={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&v?n([v]):v&&n([v,E])}function n(a){N.resolve({schema:a,
id:r})}function p(a){N.reject(a)}void 0===f&&(f="en");var r,q,v,E,N=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(r=c.results[0].id,Object(e.d)(a,b,r).then(g,p)):p("The living atlas group could not be found.")},p),N}},46:function(a,b,c){var d=c(47);c.d(b,"a",function(){return d.a});var e=c(48);c.d(b,"d",function(){return e.a});var f=c(49);c.d(b,"e",function(){return f.a});var g=c(50);c.d(b,"f",function(){return g.a});var h=c(51);c.d(b,"g",function(){return h.a});
c.d(b,"h",function(){return h.b});var l=c(52);c.d(b,"b",function(){return l.a});c.d(b,"c",function(){return l.b})},47:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,b,c){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}c.d(b,"a",function(){return e});a=c(1);
var e=Object(a.b)(function(a,b,c){var e=b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},50:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),e=a("uploaded")},55:function(a,b){a.exports=f},6:function(a,b,c){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}c.d(b,"i",function(){return h});c.d(b,"f",function(){return l});c.d(b,"c",function(){return v});c.d(b,"d",function(){return u});
c.d(b,"g",function(){return w});c.d(b,"h",function(){return t});c.d(b,"a",function(){return y});c.d(b,"b",function(){return C});c.d(b,"j",function(){return x});c.d(b,"k",function(){return B});c.d(b,"l",function(){return z});c.d(b,"e",function(){return F});c.d(b,"m",function(){return e});var f=c(0),g=c(11),h=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},l=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},v=function(a,b,c){return e(a,b.restUrl+"/community/groups",
{q:c})},u=function(a,b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},w=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},t=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},y=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>c.data.start+c.data.num?
y(a,b,c.data.start+c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},C=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var k=f.data.provisionedListings.map(function(c){return e(a,b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},function(a){})});
return f.data.total>f.data.start+f.data.num?C(a,b,c,f.data.start+f.data.num).then(function(a){return g(k).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):g(k).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},x=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},B=function(a,b,c){return e(a,
b.restUrl+"/content/users/"+(c||b.user.username))},z=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},F=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},7:function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"b",function(){return f});var d=c(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return d.a({},a,{baseUrl:e(a)})}},9:function(a,b){a.exports=c}})})},"arcgis-components/Filters/ModifiedFilter/index":function(){define(["../../Component",
"../../Dropdowns/AccordionDropdown/index","../../DateSelection/DateRangeSelector/index","dojo/i18n!../../Filters/ModifiedFilter/nls/resources"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]={i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},c.p="",c(c.s=359)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},102:function(a,c){a.exports=h},136:function(c,f){c.exports=a},26:function(a,c){a.exports=l},359:function(a,c,d){d.r(c);var b=d(0),e=d(136);a=d(9);a=d.n(a);var f=d(26),h=d.n(f),f=d(102),l=d.n(f);d=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.handleDateRangeSelect=b.handleDateRangeSelect.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=
this.tsx;return a(h.a,{key:"modified-filter-accordion",title:e.dateModified,clearable:!!this.props.dateModifiedFilter,onClear:this.handleClearFilter},a("ul",{"aria-label":e.dateModified,class:"ftr-modified__tree",id:"modified-filter-accordion-tree",role:"tree"},a(l.a,{key:"date-range-selector",selectedOption:this.props.dateModifiedSection,range:this.props.dateModifiedFilter,onDateRangeSelect:this.handleDateRangeSelect})))},c.prototype.handleDateRangeSelect=function(a,b){this.props.onDateModifiedSelect(a,
b)},c.prototype.handleClearFilter=function(){this.props.onDateModifiedSelect()},c}(a.a);c.default=d},9:function(a,f){a.exports=c}})})},"arcgis-components/Filters/SharedFilter/index":function(){define(["../../Component","../../Dropdowns/AccordionDropdown/index","../../Buttons/Toggle","dojo/i18n!../../Filters/SharedFilter/nls/resources"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]={i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}
var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,
e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},c.p="",c(c.s=360)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},26:function(a,c){a.exports=l},360:function(a,c,d){d.r(c);var b=d(0),e=d(75);a=d(9);a=d.n(a);var f=d(26),h=d.n(f),f=d(55),l=d.n(f);d=function(a){function c(b,c){b=
a.call(this,b,c)||this;return b.state={options:[{value:"public",displayName:e.options.public},{value:"org",displayName:e.options.org},{value:"shared",displayName:e.options.shared},{value:"private",displayName:e.options.private}]},b.mapOptionsToToggles=b.mapOptionsToToggles.bind(b),b.handleToggleClick=b.handleToggleClick.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=this.tsx;return a(h.a,{key:"shared-accordion",title:e.shared,clearable:!!this.props.sharedFilter,
onClear:this.handleClearFilter},a("ul",{id:"shared-accordion-tree",class:"ftr-shared__tree",role:"tree","aria-label":e.shared},this.mapOptionsToToggles()))},c.prototype.mapOptionsToToggles=function(){var a=this,b=this.tsx,c=this.state.options;return this.props.hideOrgGroupFilters&&(c=[this.state.options[0],this.state.options[3]]),c.map(function(c){return b(l.a,{count:a.props.counts[c.value],key:c.value,name:c.displayName,value:c.value,selectedToggle:a.props.sharedFilter?a.props.sharedFilter.value:
void 0,childOptions:c.childOptions,onToggleClick:a.handleToggleClick})})},c.prototype.handleToggleClick=function(a,b){var c=this.props.sharedFilter;c&&c.value===a?this.props.onSharedSelect():this.props.onSharedSelect({value:a,text:b})},c.prototype.handleClearFilter=function(){this.props.onSharedSelect()},c}(a.a);c.default=d},55:function(a,c){a.exports=h},75:function(c,f){c.exports=a},9:function(a,f){a.exports=c}})})},"arcgis-components/Filters/StatusFilter/index":function(){define(["../../Component",
"../../Dropdowns/AccordionDropdown/index","../../Buttons/Toggle","dojo/i18n!../../Filters/StatusFilter/nls/resources"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]={i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},c.p="",c(c.s=361)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},115:function(c,f){c.exports=a},26:function(a,c){a.exports=l},361:function(a,c,d){d.r(c);var b=d(0),e=d(115);a=d(9);a=d.n(a);var f=d(26),h=d.n(f),f=d(55),l=d.n(f);d=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.state={options:[{value:"authoritative",displayName:e.options.authoritative},{value:"deprecated",displayName:e.options.deprecated}]},b.mapOptionsToToggles=b.mapOptionsToToggles.bind(b),
b.handleToggleClick=b.handleToggleClick.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=this.tsx;return a(h.a,{key:"status-accordion",title:e.status,clearable:!!this.props.statusFilter,onClear:this.handleClearFilter},a("ul",{"aria-label":e.status,class:"ftr-status__tree",id:"status-accordion-tree",role:"tree"},this.mapOptionsToToggles()))},c.prototype.mapOptionsToToggles=function(){var a=this,b=this.tsx;return this.state.options.map(function(c){return b(l.a,
{count:a.props.counts[c.value],key:c.value,name:c.displayName,value:c.value,selectedToggle:a.props.statusFilter?a.props.statusFilter.value:void 0,childOptions:c.childOptions,onToggleClick:a.handleToggleClick})})},c.prototype.handleToggleClick=function(a,b){var c=this.props.statusFilter;c&&c.value===a?this.props.onStatusSelect():this.props.onStatusSelect({value:a,text:b})},c.prototype.handleClearFilter=function(){this.props.onStatusSelect()},c}(a.a);c.default=d},55:function(a,c){a.exports=h},9:function(a,
f){a.exports=c}})})},"arcgis-components/Filters/MapAreaFilter":function(){define(["../Buttons/ToggleSwitch"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});
Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,
c)},h.p="",h(h.s=363)}({100:function(l,h){l.exports=c},363:function(c,h,a){a.r(h);c=a(100);var e=a.n(c);h.default=function(a){var c=a.tsx;return c(e.a,{key:"map-area-filter",label:a.text,id:"map-area-filter-toggle",handleToggleClick:a.handleMapAreaToggle,value:a.searchMapArea})}}})})},"arcgis-components/Buttons/ToggleSwitch":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,
h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=
typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},h.p="",h(h.s=344)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,
c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},344:function(c,h,a){a.r(h);var e=a(0);c=a(3);a=function(a){function c(){return null!==a&&a.apply(this,
arguments)||this}return e.b(c,a),c.prototype.render=function(){var a=this.tsx,c=this.props,d=c.handleToggleClick,e=c.value,f=c.id;return a("label",{class:"btn-toggle-switch__toggle",key:f||"toggle-switch"},a("span",{class:"btn-toggle-switch__label"},c.label),a("input",{id:f+"-input",type:"checkbox",class:"btn-toggle-switch__input",onchange:d,checked:e}),a("span",{id:f+"-switch",class:"btn-toggle-switch__switch"}))},c}(a.n(c).a);h.default=a}})})},"arcgis-components/ItemCards/MiniCard/index":function(){define("../../Component dojo/promise/all dojo/Deferred dojo/i18n!../../ItemCards/nls/resources dojo/date/locale ../../Buttons/SvgButton ../../Badges/Authoritative ../../Badges/Deprecated ../../Badges/LivingAtlas ../../Badges/Marketplace ../../Badges/OpenData ../../Badges/Premium ../../Badges/Subscriber ../../Dropdowns/TextOptionDropdown ../../Loaders/LoaderIcon ../../Loaders/LoaderBars".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if((1&
c&&(a=b(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=368)}({0:function(a,b,c){function d(a,b){function c(){this.constructor=
a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}c.d(b,"b",function(){return d});c.d(b,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,
arguments)}},1:function(a,b,c){var d=c(28);c.d(b,"d",function(){return d.a});c.d(b,"e",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});var e=c(10);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"g",function(){return e.c});var f=c(34);c.d(b,"c",function(){return f.a});c.d(b,"f",function(){return f.b});c.d(b,"h",function(){return f.c});
c.d(b,"i",function(){return f.d});c.d(b,"j",function(){return f.e})},10:function(a,b,c){c(30);var d=c(31);c.d(b,"a",function(){return d.a});var e=c(32);c.d(b,"b",function(){return e.a});var f=c(33);c.d(b,"c",function(){return f.a})},105:function(a,b){a.exports=d},106:function(a,c){a.exports=b},107:function(a,b){a.exports=g},108:function(a,b){a.exports=k},109:function(a,b){a.exports=m},11:function(a,b){a.exports=l},110:function(a,b){a.exports=p},111:function(a,b){a.exports=q},112:function(a,b){a.exports=
n},113:function(a,b){a.exports=r},12:function(a,b){a.exports=h},15:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{badges:function(a){var b=[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?
b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),b}(a)})}},16:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":
"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?
c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&(c="Big Data File Share"),c}(a)})}},17:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,k=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var h=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?
(k=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),d=(g=-1!==c.indexOf("Spatiotemporal"))&&k?"spatiotemporaltable":k?"table":e?"routelayer":f?"markup":g?"spatiotemporal":h?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?h||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?
"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===
b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||
"explorer map"===b&&-1<c.indexOf("Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===
b||"map template"===b||"desktop application template"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===
b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":
"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},18:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,
b){return d.a({},b,{patchedDescription:function(a,b){return b.description?b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},19:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+
b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},20:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},21:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,b,c){c.d(b,
"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},23:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?
"?token\x3d"+a.credential.token:"")),c}(a,b)})})},28:function(a,b,c){var d=c(29);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});c.d(b,"c",function(){return d.c});c.d(b,"d",function(){return d.d});c.d(b,"e",function(){return d.e});c.d(b,"f",function(){return d.f});c.d(b,"g",function(){return d.g})},29:function(a,b,c){function d(a,b){return h("children","value",a,b)}function e(a,b){return function J(a,b,c,d){var e,f=c[a];return f&&0!==f.length?n.a({},c,(e={},e[a]=f.reduce(function(c,
e){return-1!==d.indexOf(e[b])&&c.push(J(a,b,e,d)),c},[]),e)):n.a({},c)}("children","value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?n.a({},b,((c={})[a]=function M(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(n.a({},c,((d={})[a]=M(c[a]),d))),b):(b.push(c),b)},[]):M(b[0][a]):b}(d),c)):b}("children",a)}function g(a,b){return m("children",a,b)}function k(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||
k(a,b,e,d)},void 0):void 0}function h(a,b,c,d){if(c=c[a])return c.reduce(function(c,e){return e[b]===d[0]?1===d.length?e:h(a,b,e,d.slice(1)):c},void 0)}function m(a,b,c){var d;return c(n.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return m(a,b,c)}):void 0,d)))}function l(a,b,c){return m(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],n.a({},c,{value:d,children:e})}return n.a({},c,{value:d})})}c.d(b,"d",function(){return d});c.d(b,"g",function(){return e});c.d(b,"e",function(){return f});
c.d(b,"f",function(){return g});c.d(b,"a",function(){return k});c.d(b,"b",function(){return h});c.d(b,"c",function(){return l});var n=c(0)},30:function(a,b,c){console.log},31:function(a,b,c){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}c.d(b,"a",function(){return d})},32:function(a,b,c){function d(a){return function B(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=
a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return B.call.apply(B,[b].concat(c,a))}}}c.d(b,"a",function(){return d})},325:function(a,b,c){function d(a){a.stopPropagation()}var e=c(0);a=c(9);a=c.n(a);var f=c(4),g=c(56);c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.handleTitleKeyDown=Object(f.H)(b.props.handleShowItemDetails.bind(b)),b}return e.b(b,a),b.prototype.render=function(){var a,b=this.tsx,
c=this.props,e=c.active,f=c.classes,k=(c.handleShowItemDetails,c.item),h=c.iconUrl,m=c.userUrl,l=(c.portal,c.sortField),c=c.i18n;return a="numviews"===l?c.viewCount+": "+k.numViews:"avgrating"===l?c.rating+": "+k.avgRating.toFixed(2):"created"===l?c.created+": "+g.format(new Date(k.created),{selector:"date",formatLength:"short"}):c.updated+": "+g.format(new Date(k.modified),{selector:"date",formatLength:"short"}),b("header",{classes:f},b("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
alt:"",class:"card-mc__thumbnail",style:"\n                        background-image: url("+this.props.thumbURI+");\n                    "}),b("div",{class:"card-mc__title-container"},b("button",{id:"item-"+k.id+"-card-title",class:"card-mc__title",title:e?c.hideItem:c.viewItem,tabindex:"0"},k.title),b("div",{class:"card-mc__author-row"},b("img",{src:h,class:"content-search-item-icon",title:k.displayName}),b("span",{class:"card-mc__author-text"},c.by,b("a",{class:"content-search-selectable card-mc__author-link",
title:this.props.organization?c.viewOrg:c.viewProfile,href:this.props.organization?this.props.organization.orgUrl:m,target:"_blank",onclick:d}," "+(this.props.organization?this.props.organization.name:k.owner)))),b("p",{class:"card-mc__info"},a)))},b}(a.a);b.a=c},326:function(a,b,c){a=c(112);var d=c.n(a);a=c(65);var e=c.n(a);a=c(113);var f=c.n(a);b.a=function(a){var b=a.tsx,c=a.selected,g=a.handleSelectionClick,k=a.handleIconActionClick,h=a.handleCustomActionClick,m=a.availableMiscActions,l=a.availableIconActions,
n=a.loading,p=a.children,t=a.id,r=a.hideEllipses,v=a.i18n,u=null;a.disableMainAction||(u=n?b(f.a,null):b(e.a,{focusable:!0,handleClick:g,key:t+"-selection-btn",title:c?v.remove:v.add},b("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},b("g",{id:"16px",stroke:"none","stroke-width":"1"},b("g",null,b("g",null,b("polygon",c?{points:"3 7 12 7 12 8 3 8"}:{points:"12 7 7.999 7 8 3 7.001 3 7 7 2.999 7 2.999 8 7 8 6.999 12 7.998 12 7.999 8 12 8"}),b("path",{d:"M7.501,0 C3.365,0 0,3.364 0,7.5 C0,11.636 3.365,15 7.501,15 C11.636,15 15,11.636 15,7.5 C15,3.364 11.636,0 7.501,0 Z M7.501,14 C3.916,14 1,11.084 1,7.5 C1,3.916 3.916,1 7.501,1 C11.085,1 14,3.916 14,7.5 C14,11.084 11.085,14 7.501,14 Z"})))))));
a=l.map(function(a){return b(e.a,{focusable:!0,handleClick:k,key:t+"-"+a.text,title:a.text,value:a.value},b("div",{class:"card-mc__custom-icon-container",innerHTML:a.icon}))});return b("div",{id:"item-"+t+"-action-row",class:"content-search-item-action-row card-mc__action-row"},p,b("div",{key:"action-container",class:"card-mc__action-container"},b(e.a,{key:t+"-spacer"},b("svg",{height:"16px",width:"0px"})),u,a,0<m.length&&!r?b(d.a,{key:t+"-actions",options:m,onSelect:h,selectedOptionValue:void 0,
justify:"right"},b(e.a,{focusable:!1,key:t+"-action-btn",title:v.actions},b("svg",{width:"16px",height:"16px",style:"transform: translate(0, -2px);"},b("g",{stroke:"none","stroke-width":"1"},b("g",null,b("path",{d:"M1,7 L3,7 L3,9 L1,9 L1,7 Z M7,7 L9,7 L9,9 L7,9 L7,7 Z M13,7 L15,7 L15,9 L13,9 L13,7 Z"})))))):null))}},327:function(a,b){a.exports=v},33:function(a,b,c){c.d(b,"a",function(){return d});var d=function(a){return function(b){13===b.keyCode&&a(b)}}},34:function(a,b,c){var d=c(35);c.d(b,"a",
function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});var e=c(36);c.d(b,"b",function(){return e.a});c.d(b,"e",function(){return e.b})},35:function(a,b,c){function d(a){return a.filter(function(a){return 0<a.length})}c.d(b,"b",function(){return e});c.d(b,"c",function(){return f});c.d(b,"a",function(){return d});a=c(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},
36:function(a,b,c){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}c.d(b,"a",function(){return d});c.d(b,"b",function(){return f});var e=c(0);a=c(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},368:function(a,b,c){c.r(b);var d=c(0),e=c(54);a=c(9);a=c.n(a);var f=c(325),g=c(326),k=c(327),h=c.n(k),k=c(105),m=c.n(k),k=c(106),l=c.n(k),k=c(107),n=c.n(k),k=c(108),p=c.n(k),k=c(109),r=c.n(k),k=c(110),t=c.n(k),k=c(111),v=c.n(k);c=function(a){function b(b,c){b=
a.call(this,b,c)||this;return b.handleShowItemDetails=b.handleShowItemDetails.bind(b),b.handleSelectionClick=b.handleSelectionClick.bind(b),b.handleCustomActionClick=b.handleCustomActionClick.bind(b),b.handleIconActionClick=b.handleIconActionClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=!!this.props.selectedItems[this.props.item.id],d=!!this.props.loadingItems[this.props.item.id],k=!(!this.props.activeItem||this.props.activeItem.id!==this.props.item.id),m=this.props.customActions.filter(function(b){return b.allowed(a.props.item)}).map(function(a){return{value:a.name,
text:a.name,icon:a.icon}}),l=m.filter(function(a){return!!a.icon}),m=m.filter(function(a){return!a.icon});return b("section",{key:this.props.item.id,classes:{"card-mc__container":!0,"card-mc__container--selected":c,"card-mc__container--active":k}},b("div",{classes:{"card-mc__fader":!0,"card-mc__fader--loading":d},onclick:this.handleShowItemDetails},b(f.a,{active:k,classes:{"card-mc__header":!0,"card-mc__header--constrained":!!this.props.constrained},handleShowItemDetails:this.handleShowItemDetails,
i18n:e,iconUrl:this.props.item.iconURI,item:this.props.item,key:"mini-card-header",portal:this.props.portal,sortField:this.props.sortField,thumbURI:this.props.item.thumbURI,userUrl:this.props.portal.baseUrl+"/home/user.html?user\x3d"+this.props.item.owner,organization:this.props.organization}),b(g.a,{selected:c,handleSelectionClick:this.handleSelectionClick,loading:d,id:this.props.item.id,i18n:e,availableMiscActions:m,availableIconActions:l,handleIconActionClick:this.handleIconActionClick,handleCustomActionClick:this.handleCustomActionClick,
disableMainAction:this.props.disableMainAction,hideEllipses:this.props.hideEllipses},b("div",{key:"badges"},this.renderBadges()))),d?b(h.a,{key:"item-card-loader-bars"}):null)},b.prototype.renderBadges=function(){var a=this,b=this.tsx;return this.props.item.badges.map(function(c){switch(c){case "authoritative":return b(m.a,{size:"small",altOrg:a.props.organization?a.props.organization.name:void 0});case "deprecated":return b(l.a,{size:"small"});case "livingAtlas":return b(n.a,{size:"small"});case "marketplace":return b(p.a,
{size:"small"});case "openData":return b(r.a,{size:"small"});case "premium":return b(t.a,{size:"small",user:a.props.portal.user});case "subscriber":return b(v.a,{size:"small",user:a.props.portal.user})}return null})},b.prototype.handleShowItemDetails=function(a){this.props.onShowItemDetails(this.props.item)},b.prototype.handleSelectionClick=function(a){a.stopPropagation();this.props.onSelectionClick(this.props.item)},b.prototype.handleIconActionClick=function(a){a.stopPropagation();a.target.value&&
this.props.onCustomActionClick(a.target.value,this.props.item)},b.prototype.handleCustomActionClick=function(a){this.props.onCustomActionClick(a,this.props.item)},b}(a.a);b.default=c},37:function(a,b,c){var d=c(38);c.d(b,"b",function(){return d.a});c.d(b,"d",function(){return d.b});c.d(b,"i",function(){return d.c});var e=c(40);c.d(b,"a",function(){return e.a});c.d(b,"e",function(){return e.b});c.d(b,"f",function(){return e.c});var f=c(41);c.d(b,"g",function(){return f.a});var g=c(42);c.d(b,"c",function(){return g.a});
c.d(b,"h",function(){return g.b})},38:function(a,b,c){c.d(b,"b",function(){return l});c.d(b,"c",function(){return n});var d=c(1),e=c(15),f=c(16),g=c(17),k=c(18),h=c(19),m=c(39);c.d(b,"a",function(){return m.a});var l=function(a,b,c){return Object(d.a)(Object(h.a)(a),Object(k.a)(a),Object(g.a)(b),f.a,e.a)(c)},n=Object(d.a)(Object(d.j)("patchedDescription"),Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},39:function(a,b,c){c.d(b,"a",function(){return d});
var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',
mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,b,c){var d=c(1);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"w",function(){return d.c});c.d(b,"x",function(){return d.d});c.d(b,"y",function(){return d.e});c.d(b,"A",
function(){return d.f});c.d(b,"H",function(){return d.g});c.d(b,"I",function(){return d.h});c.d(b,"J",function(){return d.i});c.d(b,"N",function(){return d.k});c.d(b,"O",function(){return d.l});c.d(b,"P",function(){return d.m});c.d(b,"Q",function(){return d.n});c.d(b,"R",function(){return d.o});var e=c(37);c.d(b,"z",function(){return e.a});c.d(b,"B",function(){return e.b});c.d(b,"C",function(){return e.c});c.d(b,"D",function(){return e.d});c.d(b,"E",function(){return e.e});c.d(b,"F",function(){return e.f});
c.d(b,"G",function(){return e.g});c.d(b,"L",function(){return e.h});c.d(b,"M",function(){return e.i});var f=c(43);c.d(b,"a",function(){return f.a});c.d(b,"b",function(){return f.b});c.d(b,"c",function(){return f.c});c.d(b,"d",function(){return f.d});c.d(b,"e",function(){return f.e});c.d(b,"f",function(){return f.f});c.d(b,"g",function(){return f.g});c.d(b,"h",function(){return f.h});c.d(b,"k",function(){return f.i});c.d(b,"l",function(){return f.j});c.d(b,"m",function(){return f.k});c.d(b,"n",function(){return f.l});
c.d(b,"o",function(){return f.m});c.d(b,"p",function(){return f.n});c.d(b,"q",function(){return f.o});c.d(b,"r",function(){return f.p});c.d(b,"s",function(){return f.q});c.d(b,"t",function(){return f.r});c.d(b,"u",function(){return f.s});c.d(b,"v",function(){return f.t});c.d(b,"K",function(){return f.u})},40:function(a,b,c){c.d(b,"c",function(){return g});a=c(1);var d=c(7),e=c(20),f=c(21);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});var g=Object(a.a)(e.a,f.a,d.b)},41:function(a,
b,c){c.d(b,"a",function(){return f});var d=c(1),e=c(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},42:function(a,b,c){c.d(b,"a",function(){return f});c.d(b,"b",function(){return g});var d=c(1),e=c(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},g=Object(d.a)(Object(d.j)("thumbURI"))},43:function(a,b,c){var d=c(44);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});
c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});c.d(b,"p",function(){return d.h});c.d(b,"q",function(){return d.i});c.d(b,"r",function(){return d.j});c.d(b,"s",function(){return d.k});c.d(b,"t",function(){return d.l});c.d(b,"u",function(){return d.m});var e=c(46);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"c",function(){return e.c});c.d(b,"d",function(){return e.d});c.d(b,"e",function(){return e.e});c.d(b,"f",function(){return e.f});c.d(b,"g",function(){return e.g});
c.d(b,"h",function(){return e.h})},44:function(a,b,c){var d=c(6);c.d(b,"b",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});c.d(b,"e",function(){return d.d});c.d(b,"f",function(){return d.e});c.d(b,"g",function(){return d.g});c.d(b,"h",function(){return d.h});c.d(b,"i",function(){return d.i});c.d(b,"j",function(){return d.j});c.d(b,"k",function(){return d.k});c.d(b,"l",function(){return d.l});c.d(b,"m",function(){return d.m});var e=c(45);c.d(b,"a",function(){return e.a})},
45:function(a,b,c){c.d(b,"a",function(){return f});var d=c(12),e=c(6),f=function(a,b,c,f){function g(d){v=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(k,p);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(l,p)}function k(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+v}).then(h,p):p("The content category sets group could not be found.")}function h(c){1===c.results.length&&c.results[0]?
Object(e.f)(a,b,c.results[0].id).then(m,p):p("The item containing the living atlas categories could not be determined.")}function m(a){u=a.categorySchema[0];c.isPortal&&t?n([u]):t&&n([u,t])}function l(a){t={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&u?n([u]):u&&n([u,t])}function n(a){q.resolve({schema:a,
id:r})}function p(a){q.reject(a)}void 0===f&&(f="en");var r,v,u,t,q=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(r=c.results[0].id,Object(e.d)(a,b,r).then(g,p)):p("The living atlas group could not be found.")},p),q}},46:function(a,b,c){var d=c(47);c.d(b,"a",function(){return d.a});var e=c(48);c.d(b,"d",function(){return e.a});var f=c(49);c.d(b,"e",function(){return f.a});var g=c(50);c.d(b,"f",function(){return g.a});var k=c(51);c.d(b,"g",function(){return k.a});
c.d(b,"h",function(){return k.b});var h=c(52);c.d(b,"b",function(){return h.a});c.d(b,"c",function(){return h.b})},47:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,b,c){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}c.d(b,"a",function(){return e});a=c(1);
var e=Object(a.b)(function(a,b,c){var e=b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},50:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),e=a("uploaded")},54:function(b,c){b.exports=a},56:function(a,b){a.exports=e},6:function(a,b,c){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}c.d(b,"i",function(){return k});c.d(b,"f",function(){return h});c.d(b,"c",function(){return m});
c.d(b,"d",function(){return l});c.d(b,"g",function(){return n});c.d(b,"h",function(){return p});c.d(b,"a",function(){return r});c.d(b,"b",function(){return v});c.d(b,"j",function(){return q});c.d(b,"k",function(){return u});c.d(b,"l",function(){return t});c.d(b,"e",function(){return w});c.d(b,"m",function(){return e});var f=c(0),g=c(11),k=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},h=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},m=function(a,
b,c){return e(a,b.restUrl+"/community/groups",{q:c})},l=function(a,b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},n=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},p=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},r=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>
c.data.start+c.data.num?r(a,b,c.data.start+c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},v=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var k=f.data.provisionedListings.map(function(c){return e(a,b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},
function(a){})});return f.data.total>f.data.start+f.data.num?v(a,b,c,f.data.start+f.data.num).then(function(a){return g(k).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):g(k).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},q=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},
u=function(a,b,c){return e(a,b.restUrl+"/content/users/"+(c||b.user.username))},t=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},w=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},65:function(a,b){a.exports=f},7:function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"b",function(){return f});var d=c(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return d.a({},a,{baseUrl:e(a)})}},9:function(a,
b){a.exports=c}})})},"arcgis-components/Loaders/LoaderIcon":function(){define(function(){return function(c){function l(a){if(h[a])return h[a].exports;var e=h[a]={i:a,l:!1,exports:{}};return c[a].call(e.exports,e,e.exports,l),e.l=!0,e.exports}var h={};return l.m=c,l.c=h,l.d=function(a,c,f){l.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:f})},l.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",
{value:!0})},l.t=function(a,c){if((1&c&&(a=l(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(l.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var d in a)l.d(e,d,function(b){return a[b]}.bind(null,d));return e},l.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return l.d(c,"a",c),c},l.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},l.p="",l(l.s=371)}({371:function(c,
l,h){h.r(l);l.default=function(a){var c=a.tsx;return c("div",{key:a.key||"loader-icon",class:"load-icon__icon"},c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",style:"\n                fill: currentColor;\n                pointer-events: none;\n                display: inline-block;\n                width: 1em;\n                height: 1em;\n                vertical-align: -0.15em;\n                padding-right: .15em;\n                color: #0079c1;\n                transition-property: transform;\n                transition-duration: 0.5s;\n                animation-name: rotate;\n                animation-duration: 1s;\n                animation-iteration-count: infinite;\n                animation-timing-function: linear;\n            "},
c("path",{d:"M27.518 8.338c.324.37.772.94 1.261 1.727a13.499 13.499 0 0 1 1.986 7.41c-.019 3.243-1.41 7.185-4.559 10.081-3.085 2.902-7.94 4.492-12.611 3.566-4.697-.832-8.864-4.161-10.853-8.38-2.043-4.23-1.863-9.035-.373-12.647 1.463-3.672 4.051-6.09 6.098-7.421C10.551 1.336 12.092.889 12.389.802c1.234-.356 2.457-.18 3.282.309.839.511 1.281 1.259 1.276 2.105-.079 1.717-1.406 3.039-2.86 3.478-.19.051-1.158.258-2.564.99a10.6 10.6 0 0 0-4.43 4.522c-1.216 2.318-1.698 5.672-.504 8.872 1.158 3.185 4.042 6.059 7.693 7.058 3.629 1.078 7.773.199 10.671-2.06 2.944-2.244 4.563-5.648 4.855-8.66.369-3.046-.465-5.615-1.261-7.222a13.163 13.163 0 0 0-1.084-1.812l-.45-.601.504.559z"})))}}})})},
"arcgis-components/ItemCards/MiniCardRow/index":function(){define(["../../Component","dojo/i18n!../../ItemCards/nls/resources","../../Buttons/SvgButton","../../Dropdowns/TextOptionDropdown","../../Loaders/LoaderIcon"],function(c,l,h,a,e){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var b={};return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=
function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:
function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=369)}({0:function(a,c,b){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}b.d(c,"b",function(){return d});b.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},112:function(c,d){c.exports=a},113:function(a,c){a.exports=e},369:function(a,c,b){b.r(c);var d=b(0),e=b(54);a=b(9);a=b.n(a);var f=b(112),h=b.n(f),f=b(65),l=b.n(f),f=b(113),n=b.n(f);b=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleShowItemDetails=b.handleShowItemDetails.bind(b),
b.handleSelectionClick=b.handleSelectionClick.bind(b),b.handleIconActionClick=b.handleIconActionClick.bind(b),b.handleCustomActionClick=b.handleCustomActionClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a,b=this,c=this.tsx,d=!!this.props.selectedItems[this.props.item.id],f=!!this.props.loadingItems[this.props.item.id],g=this.props.activeItem&&this.props.activeItem.id===this.props.item.id,k=this.props.customActions.filter(function(a){return a.allowed(b.props.item)}).map(function(a){return{value:a.name,
text:a.name,icon:a.icon}}),m=k.filter(function(a){return!!a.icon}),k=k.filter(function(a){return!a.icon});this.props.disableMainAction||(a=f?c(n.a,null):c(l.a,{focusable:!0,handleClick:this.handleSelectionClick,key:this.props.item.id+"-selection-btn",title:d?e.remove:e.add},c("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},c("g",{stroke:"none","stroke-width":"1"},d?c("g",{id:"minus-circled-1px-16"},c("g",null,c("polygon",{points:"3 7 12 7 12 8 3 8"}),c("path",{d:"M7.501,0 C3.365,0 0,3.364 0,7.5 C0,11.636 3.365,15 7.501,15 C11.636,15 15,11.636 15,7.5 C15,3.364 11.636,0 7.501,0 Z M7.501,14 C3.916,14 1,11.084 1,7.5 C1,3.916 3.916,1 7.501,1 C11.085,1 14,3.916 14,7.5 C14,11.084 11.085,14 7.501,14 Z"}))):
c("g",{id:"plus-circled-1px-16"},c("g",null,c("polygon",{points:"12 7 7.999 7 8 3 7.001 3 7 7 2.999 7 2.999 8 7 8 6.999 12 7.998 12 7.999 8 12 8"}),c("path",{d:"M7.501,0 C3.365,0 0,3.364 0,7.5 C0,11.636 3.365,15 7.501,15 C11.636,15 15,11.636 15,7.5 C15,3.364 11.636,0 7.501,0 Z M7.501,14 C3.916,14 1,11.084 1,7.5 C1,3.916 3.916,1 7.501,1 C11.085,1 14,3.916 14,7.5 C14,11.084 11.085,14 7.501,14 Z"})))))));f=m.map(function(a){return c(l.a,{focusable:!0,handleClick:b.handleIconActionClick,key:b.props.item.id+
"-"+a.text,title:a.text,value:a.value},c("div",{class:"card-mcr__custom-icon-container",innerHTML:a.icon}))});return c("div",{key:this.props.item.id,classes:{"card-mcr__container":!0,"card-mcr__container--selected":d,"card-mcr__container--active":g},onclick:this.handleShowItemDetails},c("img",{src:this.props.item.iconURI,class:"card-mcr__item-icon",title:this.props.item.displayName,alt:""}),c("button",{id:"item-"+this.props.item.id+"-card-title",class:"card-mcr__item-title",title:g?e.hideItem:e.viewItem,
tabindex:"0"},this.props.item.title),c("div",{class:"card-mcr__spacer"}),c("div",{class:"card-mcr__action-container"},a,f,0<k.length&&!this.props.hideEllipses?c(h.a,{key:this.props.item.id+"-actions",options:k,onSelect:this.handleCustomActionClick,selectedOptionValue:void 0,justify:"right"},c(l.a,{key:this.props.item.id+"-action-btn",focusable:!1,title:e.actions},c("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",style:"transform: translate(0, -2px);"},c("g",{stroke:"none","stroke-width":"1"},
c("g",{id:"ellipses-1px-16"},c("path",{d:"M1,7 L3,7 L3,9 L1,9 L1,7 Z M7,7 L9,7 L9,9 L7,9 L7,7 Z M13,7 L15,7 L15,9 L13,9 L13,7 Z"})))))):null))},b.prototype.handleShowItemDetails=function(a){this.props.onShowItemDetails(this.props.item)},b.prototype.handleSelectionClick=function(a){a.stopPropagation();this.props.onSelectionClick(this.props.item)},b.prototype.handleIconActionClick=function(a){a.stopPropagation();a.target.value&&this.props.onCustomActionClick(a.target.value,this.props.item)},b.prototype.handleCustomActionClick=
function(a){this.props.onCustomActionClick(a,this.props.item)},b}(a.a);c.default=b},54:function(a,c){a.exports=l},65:function(a,c){a.exports=h},9:function(a,d){a.exports=c}})})},"arcgis-components/Navigation/Pager/index":function(){define(["../../Component","dojo/i18n!../../Navigation/Pager/nls/resources"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=
e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,
e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=374)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&
function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},374:function(c,a,e){e.r(a);var f=e(0),d=e(89);c=e(9);e=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleNext=b.handleNext.bind(b),b.handlePrevious=b.handlePrevious.bind(b),b.handlePageBtn=
b.handlePageBtn.bind(b),b}return f.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=Array.apply(null,{length:this.props.numPages}).map(function(c,d){c=a.props.currentPage===d+1;return b("button",{classes:{"nav-pager__btn":!0,"nav-pager__page-btn--active":c,"nav-pager__page-btn--inactive":!c},id:"page-"+(d+1)+"-button",title:"page-"+(d+1),onclick:a.handlePageBtn,role:"link",tabindex:"0",key:"page-"+(d+1)+"-button"},d+1)}).reduce(function(c,d,e,f){return 0===e||e===a.props.numPages-1||e===
a.props.currentPage-1||e===a.props.currentPage-2||e===a.props.currentPage||1===e&&4===a.props.currentPage||e===a.props.numPages-2&&a.props.currentPage===a.props.numPages-3||4>=e&&5>a.props.currentPage?c.push(d):(e===a.props.currentPage-3||e===a.props.currentPage+1||5===e&&5>a.props.currentPage)&&c.push(b("span",{class:"nav-pager__dots",key:"dots-"+e},"...")),c},[]),e={"nav-pager__btn":!0,"nav-pager__btn--disabled":1>=this.props.currentPage},f={"nav-pager__btn":!0,"nav-pager__btn--disabled":this.props.currentPage>=
this.props.numPages};return b("nav",{class:"nav-pager__container",key:"pager"},this.props.currentPage===this.props.numPages&&this.props.paginationLimitReached?b("div",{class:"nav-pager__limit-container",key:"pagination-limit-container"},b("div",{class:"nav-pager__limit-inner"},b("p",{class:"nav-pager__limit-text"},d.paginationLimit))):null,b("button",{classes:e,id:"previous",title:d.previous,role:"link",key:"previous-btn",onclick:this.handlePrevious,tabindex:1>=this.props.currentPage?"-1":"0"},d.previous),
b("div",{class:"nav-pager__page-btn-container"},c),b("button",{classes:f,id:"next",title:d.next,role:"link",key:"next-btn",onclick:this.handleNext,tabindex:this.props.currentPage>=this.props.numPages?"-1":"0"},d.next))},b.prototype.handleNext=function(){this.props.onPageChange(this.props.currentPage+1)},b.prototype.handlePrevious=function(){this.props.onPageChange(this.props.currentPage-1)},b.prototype.handlePageBtn=function(a){this.props.onPageChange(parseInt(a.target.textContent,10))},b}(e.n(c).a);
a.default=e},89:function(c,a){c.exports=l},9:function(h,a){h.exports=c}})})},"arcgis-components/Dropdowns/SortDropdown/index":function(){define("../../Component ../../Buttons/Toggle dojo/i18n!../../Dropdowns/SortDropdown/nls/resources ../../Dropdowns/Ago2018Dropdown ../../Buttons/IconButton ../../Modals/MobileWrap".split(" "),function(c,l,h,a,e,f){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}
var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if((1&c&&(a=b(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,
e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=352)}({0:function(a,b,c){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}c.d(b,"b",function(){return d});c.d(b,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},101:function(c,b){c.exports=a},134:function(a,b){a.exports=e},281:function(a,b){a.exports=f},352:function(a,b,c){c.r(b);var d=c(0),e=c(69);a=c(9);a=c.n(a);var f=
c(134),g=c.n(f),f=c(55),h=c.n(f),f=c(101),l=c.n(f),f=c(281),v=c.n(f);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleSortClick=b.handleSortClick.bind(b),b.handleFieldChange=b.handleFieldChange.bind(b),b.handleOrderChange=b.handleOrderChange.bind(b),b.handleMobileWrapClose=b.handleMobileWrapClose.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx,c=[b("div",{class:"drp-sort__menu-section",role:"tree"},b("h3",{class:"drp-sort__menu-title"},e.sortBy),
this.props.availableFields.map(function(c){return b(h.a,{key:c,name:e[c],value:c,onToggleClick:a.handleFieldChange,selectedToggle:a.props.field})})),b("br",null),b("div",{class:"drp-sort__menu-section",role:"tree"},b("h3",{class:"drp-sort__menu-title"},e.sortDir),b(h.a,{key:"ascending-toggle",name:e.ascending[this.props.field],value:"asc",onToggleClick:this.handleOrderChange,selectedToggle:this.props.order}),b(h.a,{key:"descending-toggle",name:e.descending[this.props.field],value:"desc",onToggleClick:this.handleOrderChange,
selectedToggle:this.props.order}))];return window.matchMedia("(max-width: 860px)").matches?[b(g.a,{key:"gb-sort-btn-mobile",active:this.props.active,handleClick:this.handleSortClick},b("div",{class:"drp-sort__btn-body"},b("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},b("g",{stroke:"none","stroke-width":"1"},b("g",{id:"sort-1px-16"},b("path",{d:"M1,1 L15,1 L15,2 L1,2 L1,1 Z M4,5 L15,5 L15,6 L4,6 L4,5 Z M7,9 L15,9 L15,10 L7,10 L7,9 Z M11,13 L15,13 L15,14 L11,14 L11,13 Z"})))),b("span",{class:"drp-sort__btn-label"},
e[this.props.field]))),b(v.a,{key:"sort-mobile-wrap",title:e.sort,open:this.props.active,onClose:this.handleMobileWrapClose},c)]:b(l.a,{key:"sort-dropdown",active:this.props.active,onToggle:this.handleSortClick},b(g.a,{key:"gb-sort-btn",active:this.props.active,handleClick:this.stub,tabindex:-1},b("div",{class:"drp-sort__btn-body"},b("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},b("g",{stroke:"none","stroke-width":"1"},b("g",{id:"sort-1px-16"},b("path",{d:"M1,1 L15,1 L15,2 L1,2 L1,1 Z M4,5 L15,5 L15,6 L4,6 L4,5 Z M7,9 L15,9 L15,10 L7,10 L7,9 Z M11,13 L15,13 L15,14 L11,14 L11,13 Z"})))),
b("span",{class:"drp-sort__btn-label"},e[this.props.field]))),b("div",{class:"drp-sort__menu-container"},c))},b.prototype.stub=function(){},b.prototype.handleSortClick=function(){this.props.onClick&&this.props.onClick()},b.prototype.handleFieldChange=function(a){a!==this.props.field&&this.props.onFieldChange&&this.props.onFieldChange(a)},b.prototype.handleOrderChange=function(a){a!==this.props.order&&this.props.onOrderChange&&this.props.onOrderChange(a)},b.prototype.handleMobileWrapClose=function(){this.props.onClick&&
this.props.onClick()},b}(a.a);b.default=c},55:function(a,b){a.exports=l},69:function(a,b){a.exports=h},9:function(a,b){a.exports=c}})})},"arcgis-components/Dropdowns/Ago2018Dropdown":function(){define(["../Component","../Dropdowns/BasicDropdown"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,
get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?
function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=349)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])})(a,b)},b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(h,a){h.exports=c},349:function(c,a,e){e.r(a);var f=e(0);c=e(3);c=e.n(c);var d=e(70),b=e.n(d);e=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.state={active:!!b.props.active&&b.props.active,closing:!1},b.handleDrpClick=b.handleDrpClick.bind(b),b}return f.b(c,
a),c.prototype.render=function(){var a=this.tsx;return a(b.a,{key:this.props.key,active:this.state.active,onToggle:this.handleDrpClick,tabindex:this.props.tabindex},this.props.children[0],a("div",{classes:{"drp-ago2018__menu":!0,"drp-ago2018__menu--active":this.state.active&&!this.state.closing}},this.props.children[1]))},c.prototype.componentWillReceiveProps=function(a){!1===a.active&&!0===this.props.active&&this.close()},c.prototype.close=function(a){var b=this;this.setState({closing:!0});setTimeout(function(){b.setState({active:!1,
closing:!1});b.props.onToggle&&a&&b.props.onToggle()},200)},c.prototype.handleDrpClick=function(){this.state.active?this.close(!0):this.state.closing||(this.setState({active:!0}),this.props.onToggle&&this.props.onToggle())},c}(c.a);a.default=e},70:function(c,a){c.exports=l}})})},"arcgis-components/Modals/MobileWrap":function(){define(["../Component","../Buttons/SvgButton"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,
d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),
2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=372)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});
var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},b=function(){return(b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(h,a){h.exports=c},372:function(c,a,e){e.r(a);var f=e(0);c=e(3);c=e.n(c);var d=e(53),b=e.n(d);e=function(a){function c(b,
c){b=a.call(this,b,c)||this;return b.state={closing:!1,open:b.props.open},b.handleClose=b.handleClose.bind(b),b}return f.b(c,a),c.prototype.componentWillReceiveProps=function(a){var b=this;this.props.open===a.open||this.state.closing||(a.open?this.setState({open:a.open}):(this.setState({closing:!0}),setTimeout(function(){b.setState({open:!1,closing:!1})},200)))},c.prototype.render=function(){var a=this.tsx;return a("div",{classes:{"mod__mob-wrap-container":!0,"mod__mob-wrap-container--closed":!this.state.open,
"mod__mob-wrap-container--closing":this.state.closing},key:this.props.key},a("div",{classes:{"mod__mob-wrap-body":!0,"mod__mob-wrap-body--max-height":this.props.maxHeight,"mod__mob-wrap-body--closing":this.state.closing}},a("div",{class:"mod__mob-wrap-header"},a("span",{class:"mod__mob-wrap-title"},this.props.title),a(b.a,{key:"mobile-wrap-close",focusable:!0,handleClick:this.handleClose},a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},a("path",{fill:"currentColor",
d:"M13.207 12.5l7.778 7.778-.707.707-7.778-7.778-7.778 7.778-.707-.707 7.778-7.778-7.778-7.778.707-.707 7.778 7.778 7.778-7.778.707.707z"})))),a("div",{class:"mod__mob-wrap-content"},this.props.children),this.props.footer?a("div",{class:"mod__mob-wrap-footer"},this.props.footer):null))},c.prototype.handleClose=function(){this.props.onClose&&this.props.onClose()},c}(c.a);a.default=e},53:function(c,a){c.exports=l}})})},"arcgis-components/Dropdowns/FilterController/index":function(){define(["../../Component",
"../../Buttons/FilterChip/index","dojo/i18n!../../Dropdowns/FilterController/nls/resources"],function(c,l,h){return function(a){function c(d){if(f[d])return f[d].exports;var b=f[d]={i:d,l:!1,exports:{}};return a[d].call(b.exports,b,b.exports,c),b.l=!0,b.exports}var f={};return c.m=a,c.c=f,c.d=function(a,b,e){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,
"__esModule",{value:!0})},c.t=function(a,b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=
351)}({0:function(a,c,f){function d(a,c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}f.d(c,"b",function(){return d});f.d(c,"a",function(){return e});var b=function(a,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},e=function(){return(e=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=
arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},127:function(a,c){a.exports=l},133:function(a,c){a.exports=h},351:function(a,c,f){function d(a){a.preventDefault()}f.r(c);var b=f(0),e=f(133);a=f(9);a=f.n(a);var h=f(127),l=f.n(h);f=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.toggleFilterDisplay=b.toggleFilterDisplay.bind(b),b.state={open:!!b.props.startOpen},b}return b.b(c,a),c.prototype.render=function(){var a,b=this.tsx,c=this.props.filters.slice(),
f={"filter-controller__expand-btn":!0,"filter-controller__expand-btn--active":this.state.open,"filter-controller__expand-btn--dark":"light"===this.props.theme},g={"filter-controller__container":!0,"filter-controller__container--light":"light"===this.props.theme},h={"filter-controller__chip-container":!0,"filter-controller__chip-container--full-width":"full-width"===this.props.mode},k="light"===this.props.theme?"dark":"light";1<this.props.filters.length&&(a=b("button",{key:"filter-controller-toggle-btn",
classes:f,onclick:this.toggleFilterDisplay,onmousedown:d},"+ "+(this.props.filters.length-1),b("svg",{width:"12",height:"12",viewBox:"0 0 32 32"},b("path",{d:"M28 9v5L16 26 4 14V9l12 12L28 9z"}))));return(f=c.shift())?this.state.open?b("div",{classes:g},b("div",{classes:h},b(l.a,{filterId:f.filterId,handleRemoveFilter:f.onRemove,key:f.filterId,text:f.text,theme:k}),c.map(function(a){return b(l.a,{filterId:a.filterId,handleRemoveFilter:a.onRemove,key:a.filterId,text:a.text,theme:k})}),a),b("div",{class:"filter-controller__clear-container"},
b("button",{class:"filter-controller__clear-btn",onclick:this.props.onClear},e.clearAll))):b("div",{classes:g},b("div",{classes:h},b(l.a,{filterId:f.filterId,handleRemoveFilter:f.onRemove,key:f.filterId,text:f.text,theme:k}),a),b("div",{class:"filter-controller__clear-container"},b("button",{key:"filter-controller-clear-btn",class:"filter-controller__clear-btn",onclick:this.props.onClear},e.clearAll))):null},c.prototype.toggleFilterDisplay=function(){this.setState({open:!this.state.open})},c}(a.a);
c.default=f},9:function(a,e){a.exports=c}})})},"arcgis-components/Buttons/FilterChip/index":function(){define(["../../Component","dojo/i18n!../../Buttons/FilterChip/nls/resources"],function(c,l){return function(c){function a(f){if(e[f])return e[f].exports;var d=e[f]={i:f,l:!1,exports:{}};return c[f].call(d.exports,d,d.exports,a),d.l=!0,d.exports}var e={};return a.m=c,a.c=e,a.d=function(c,d,b){a.o(c,d)||Object.defineProperty(c,d,{enumerable:!0,get:b})},a.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},a.t=function(c,d){if((1&d&&(c=a(c)),8&d)||4&d&&"object"==typeof c&&c&&c.__esModule)return c;var b=Object.create(null);if(a.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:c}),2&d&&"string"!=typeof c)for(var e in c)a.d(b,e,function(a){return c[a]}.bind(null,e));return b},a.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return a.d(d,"a",d),
d},a.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},a.p="",a(a.s=340)}({0:function(c,a,e){function f(a,b){function c(){this.constructor=a}d(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}e.d(a,"b",function(){return f});e.d(a,"a",function(){return b});var d=function(a,b){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},b=function(){return(b=
Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},214:function(c,a){c.exports=l},340:function(c,a,e){e.r(a);var f=e(0),d=e(214);c=e(9);e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return f.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.props,c=b.filterId,e=b.handleRemoveFilter,b=b.text;return a("span",{id:"filter-chip-"+b,
classes:{"btn-ftr-chip__label":!0,"btn-ftr-chip__label--dark":"dark"===this.props.theme},key:b},b,this.props.static?null:a("button",{"aria-label":d.clear+": "+b,value:c,id:"filter-chip-x-"+b,class:"btn-ftr-chip__remove",onclick:e},a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32",style:"\n                                    fill: currentColor;\n                                    pointer-events: none;\n                                    display: inline-block;\n                                    width: 1em;\n                                    height: 1em;\n                                    vertical-align: -0.15em;\n                                    padding-right: .15em;\n                                "},
a("path",{d:"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"}))))},b}(e.n(c).a);a.default=e},9:function(h,a){h.exports=c}})})},"arcgis-components/Filters/TagsFilter/index":function(){define(["../../Component","../../Dropdowns/AccordionDropdown/index","dojo/i18n!../../Filters/TagsFilter/nls/resources","../../Buttons/CheckToggle"],function(c,l,h,a){return function(a){function c(b){if(d[b])return d[b].exports;var e=d[b]=
{i:b,l:!1,exports:{}};return a[b].call(e.exports,e,e.exports,c),e.l=!0,e.exports}var d={};return c.m=a,c.c=d,c.d=function(a,d,e){c.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,d){if((1&d&&(a=c(a)),8&d)||4&d&&"object"==typeof a&&a&&a.__esModule)return a;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,
"default",{enumerable:!0,value:a}),2&d&&"string"!=typeof a)for(var e in a)c.d(b,e,function(b){return a[b]}.bind(null,e));return b},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},c.p="",c(c.s=362)}({0:function(a,c,d){function b(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}d.d(c,"b",function(){return b});
d.d(c,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},26:function(a,c){a.exports=l},283:function(c,f){c.exports=a},362:function(a,c,
d){d.r(c);var b=d(0),e=d(88);a=d(9);a=d.n(a);var f=d(26),h=d.n(f),f=d(283),l=d.n(f);d=function(a){function c(b,c){b=a.call(this,b,c)||this;return b.handleFilterStringChange=b.handleFilterStringChange.bind(b),b.handleToggleClick=b.handleToggleClick.bind(b),b.handleClearFilter=b.handleClearFilter.bind(b),b}return b.b(c,a),c.prototype.render=function(){var a=this.tsx;return a(h.a,{key:this.props.key+"-accordion",title:this.props.title?this.props.title:e.tags,clearable:!!this.props.tagsFilter,onClear:this.handleClearFilter,
padding:!1},a("div",{class:"ftr-tags__input-area"},a("input",{id:"filter-tag-filters",type:"search",placeholder:e.filterTags,"aria-label":e.filterTags,oninput:this.handleFilterStringChange,value:this.props.filterString})),a("ul",{class:"ftr-tags__tree",id:this.props.key+"-accordion-tree",role:"tree","aria-label":e.tags},0<this.props.availableTags.length?this.mapTagsToToggles():a("p",{class:"ftr-tags__none"},e.noTags)))},c.prototype.mapTagsToToggles=function(){var a=this,b=this.tsx;return this.props.availableTags.map(function(c){return b(l.a,
{key:c.value,name:c.value,value:c.value,selectedToggles:a.props.tagsFilter?a.props.tagsFilter:void 0,onToggleClick:a.handleToggleClick})})},c.prototype.handleToggleClick=function(a,c){var d,e;(c=this.props.tagsFilter)&&c[a]?(d=b.a({},c),delete d[a],0<Object.keys(d).length?this.props.onTagSelect(d):this.props.onTagSelect()):c?this.props.onTagSelect(b.a({},c,((d={})[a]=!0,d))):this.props.onTagSelect(((e={})[a]=!0,e))},c.prototype.handleFilterStringChange=function(a){a.preventDefault();this.props.onFilterStringChange(a.target.value)},
c.prototype.handleClearFilter=function(){this.props.tagsFilter&&this.props.onTagSelect()},c}(a.a);c.default=d},88:function(a,c){a.exports=h},9:function(a,f){a.exports=c}})})},"arcgis-components/Buttons/CheckToggle":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,
get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?
function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},h.p="",h(h.s=339)}({0:function(c,h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},339:function(c,h,a){function e(a,c,e,f,h){return e?e.map(function(b){return a(d,{key:b.value,name:b.displayName,value:c+"/"+b.value,selectedToggles:h,childOptions:b.children,onToggleClick:f})}):null}a.r(h);var f=a(0);c=a(3);var d=function(a){function b(b,
c){b=a.call(this,b,c)||this;return b.handleToggleClick=b.handleToggleClick.bind(b),b}return f.b(b,a),b.prototype.render=function(){var a=this.tsx,b=this.props,c=b.name,d=b.value,f=b.selectedToggles,g=b.childOptions,b=b.onToggleClick,h=f&&!!f[d],l={"btn-check-toggle__item":!0,"btn-check-toggle__item--active":h},w={"btn-check-toggle__button":!0,"btn-check-toggle__button--active":h},t=null;return g&&(t=a("ul",{class:"btn-check-toggle__sub-list"},e(a,d,g,b,f))),a("li",{key:d,classes:l},a("button",{id:"toggle-"+
d,key:d,classes:w,value:d,onmousedown:this.preventDefault,onclick:this.handleToggleClick,tabindex:"0"},a("span",{class:"btn-check-toggle__text",key:"text"},c),this.props.count?a("span",{class:"btn-check-toggle__count",key:"count"},"\u00a0","("+this.props.count+")"):null),h?t:null)},b.prototype.preventDefault=function(a){a.preventDefault()},b.prototype.handleToggleClick=function(a){a.preventDefault();this.props.onToggleClick(this.props.value,this.props.name)},b}(a.n(c).a);h.default=d}})})},"arcgis-components/Navigation/TabNav":function(){define(["../Component",
"../Buttons/SvgButton","../Dropdowns/TextOptionDropdown"],function(c,l,h){return function(a){function c(d){if(f[d])return f[d].exports;var b=f[d]={i:d,l:!1,exports:{}};return a[d].call(b.exports,b,b.exports,c),b.l=!0,b.exports}var f={};return c.m=a,c.c=f,c.d=function(a,b,e){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:e})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},
c.t=function(a,b){if((1&b&&(a=c(a)),8&b)||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=375)}({0:function(a,c,f){function d(a,
c){function d(){this.constructor=a}b(a,c);a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}f.d(c,"b",function(){return d});f.d(c,"a",function(){return e});var b=function(a,c){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},e=function(){return(e=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,
e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(a,e){a.exports=c},375:function(a,c,f){f.r(c);var d=f(0);a=f(3);a=f.n(a);var b=f(71),e=f.n(b),b=f(53),h=f.n(b);f=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.handleBtnClick=b.handleBtnClick.bind(b),b.handleMobileClick=b.handleMobileClick.bind(b),b}return d.b(b,a),b.prototype.render=function(){var a=this,b=this.tsx;if(1>=this.props.options.length)return null;var c=this.props.options.map(function(c){return b("button",{key:c.value,
classes:{"nav-tabnav__btn":!0,"nav-tabnav__btn--active":a.props.selectedOptionValue===c.value},value:c.value,onclick:a.handleBtnClick},c.text)}),d=this.props.options.filter(function(b){return b.value===a.props.selectedOptionValue})[0].text;return b("nav",{class:"nav-tabnav__nav"},c,b("div",{class:"nav-tabnav__mobile-menu"},b(e.a,{key:"ib-ex__section-dropdown",options:this.props.options,onSelect:this.handleMobileClick,selectedOptionValue:this.props.selectedOptionValue,justify:"right"},b("h3",{key:"search-"+
d+"-dropdown",id:"section-dropdown-toggle",class:"nav-tabnav__section-dropdown-text"},d,"\u00a0",b(h.a,{key:"section-dropdown-button"},b("svg",{width:"12",height:"12",viewBox:"0 0 16 16"},b("path",{d:"M1.5,4 L8,11 L14.5,4 C11.893,4 4.101,4 1.5,4 Z"})))))))},b.prototype.handleBtnClick=function(a){a.target.value!==this.props.selectedOptionValue&&this.props.onSelect(a.target.value)},b.prototype.handleMobileClick=function(a){a!==this.props.selectedOptionValue&&this.props.onSelect(a)},b}(a.a);c.default=
f},53:function(a,c){a.exports=l},71:function(a,c){a.exports=h}})})},"arcgis-components/ItemCards/AnalysisCard/index":function(){define("../../Component dojo/promise/all dojo/Deferred dojo/i18n!../../ItemCards/nls/resources dojo/date/locale ../../Dropdowns/Ago2018Dropdown ../../Badges/Authoritative ../../Badges/Deprecated ../../Badges/LivingAtlas ../../Badges/Marketplace ../../Badges/OpenData ../../Badges/Premium ../../Badges/Subscriber".split(" "),function(c,l,h,a,e,f,d,b,g,k,m,p,q){return function(a){function b(d){if(c[d])return c[d].exports;
var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if((1&c&&(a=b(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),
Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=367)}({0:function(a,b,c){function d(a,b){function c(){this.constructor=a}e(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}c.d(b,
"b",function(){return d});c.d(b,"a",function(){return f});var e=function(a,b){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},1:function(a,b,c){var d=c(28);c.d(b,"d",function(){return d.a});
c.d(b,"e",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});var e=c(10);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"g",function(){return e.c});var f=c(34);c.d(b,"c",function(){return f.a});c.d(b,"f",function(){return f.b});c.d(b,"h",function(){return f.c});c.d(b,"i",function(){return f.d});c.d(b,"j",function(){return f.e})},
10:function(a,b,c){c(30);var d=c(31);c.d(b,"a",function(){return d.a});var e=c(32);c.d(b,"b",function(){return e.a});var f=c(33);c.d(b,"c",function(){return f.a})},101:function(a,b){a.exports=f},105:function(a,b){a.exports=d},106:function(a,c){a.exports=b},107:function(a,b){a.exports=g},108:function(a,b){a.exports=k},109:function(a,b){a.exports=m},11:function(a,b){a.exports=l},110:function(a,b){a.exports=p},111:function(a,b){a.exports=q},12:function(a,b){a.exports=h},15:function(a,b,c){c.d(b,"a",
function(){return e});var d=c(0),e=function(a){return d.a({},a,{badges:function(a){var b=[],c=a.typeKeywords?a.typeKeywords:[];return a.contentStatus&&("org_authoritative"===a.contentStatus||"public_authoritative"===a.contentStatus?b.push("authoritative"):"deprecated"===a.contentStatus&&b.push("deprecated")),a.groupDesignations&&-1<a.groupDesignations.indexOf("livingatlas")&&b.push("livingAtlas"),-1<c.indexOf("Requires Credits")?b.push("premium"):-1<c.indexOf("Requires Subscription")&&b.push("subscriber"),
b}(a)})}},16:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0),e=function(a){return d.a({},a,{displayName:function(a){var b=a.type;a=a.typeKeywords||[];var c=b;return"Feature Service"===b||"Feature Collection"===b?c=-1<a.indexOf("Table")?"Table":-1<a.indexOf("Route Layer")?"Route Layer":-1<a.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===b?c=-1<a.indexOf("Elevation 3D Layer")?"Elevation Layer":"Imagery Layer":"Scene Service"===b?c="Scene Layer":"Scene Package"===b?c="Scene Layer Package":
"Stream Service"===b?c="Feature Layer":"Geocoding Service"===b?c="Locator":"Microsoft Powerpoint"===b?c="Microsoft PowerPoint":"GeoJson"===b?c="GeoJSON":"Globe Service"===b?c="Globe Layer":"Vector Tile Service"===b?c="Tile Layer":"netCDF"===b?c="NetCDF":"Map Service"===b?c=-1===a.indexOf("Spatiotemporal")&&(-1<a.indexOf("Hosted Service")||-1<a.indexOf("Tiled"))?"Tile Layer":"Map Image Layer":b&&-1<b.toLowerCase().indexOf("add in")?c=b.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===b&&
(c="Big Data File Share"),c}(a)})}},17:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{iconURI:function(a,b,c){var d;b=b&&b.toLowerCase();var e=!1,f=!1,g=!1,h=!1;if(0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b){var k=-1<c.indexOf("Hosted Service");"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(h=-1<c.indexOf("Table"),e=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),
d=(g=-1!==c.indexOf("Spatiotemporal"))&&h?"spatiotemporaltable":h?"table":e?"routelayer":f?"markup":g?"spatiotemporal":k?"featureshosted":"features"):d="map service"===b||"wms"===b||"wmts"===b?k||-1<c.indexOf("Tiled")||"wmts"===b?"maptiles":"mapimages":"scene service"===b?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":
-1<c.indexOf("Polygon")?"sceneweblayerpolygon":"sceneweblayer":"image service"===b?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b&&-1<c.indexOf("Web Tool")?"tool":"layers"}else d="web map"===b||"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":
"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===b||"layer"===b&&-1<c.indexOf("ArcGIS Pro")||"explorer map"===b&&-1<c.indexOf("Explorer Document")?
"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===
b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"vector tile package"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===
b||"raster function template"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===
b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"maps";return a+"/"+d+"16.png"}(a,b.type,b.typeKeywords?b.typeKeywords:[])})})},18:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{patchedDescription:function(a,b){return b.description?
b.description.replace(/src=('|")js\/jsapi\/esri\//g,function(b){return"src\x3d"+('"'===b[4]?'"':"'")+a.baseUrl+"/home/js/jsapi/esri/"}):void 0}(a,b)})})},19:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c=a.baseUrl+"/home/js/arcgisonline/css/images/default_thumb.png";return b.thumbnail&&(c=a.restUrl+"/content/items/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},
20:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{thumbURI:function(a){var b=Object(e.a)(a);return a.thumbnail?b+"/sharing/rest/portals/"+a.id+"/resources/"+a.thumbnail:b+"/home/images/group-no-image.png"}(a)})}},21:function(a,b,c){c.d(b,"a",function(){return f});var d=c(0),e=c(7),f=function(a){return d.a({},a,{orgUrl:Object(e.a)(a)+"/home/index.html"})}},22:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,
b){return d.a({},b,{thumbURI:function(a,b){if(b.thumbnail)return a.restUrl+"/community/users/"+b.username+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")}(a,b)})})},23:function(a,b,c){c.d(b,"a",function(){return e});var d=c(0);a=c(1);var e=Object(a.b)(function(a,b){return d.a({},b,{thumbURI:function(a,b){var c;return b.thumbnail&&(c=a.restUrl+"/community/groups/"+b.id+"/info/"+b.thumbnail+(a.credential?"?token\x3d"+a.credential.token:"")),c}(a,b)})})},28:function(a,b,c){var d=
c(29);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});c.d(b,"c",function(){return d.c});c.d(b,"d",function(){return d.d});c.d(b,"e",function(){return d.e});c.d(b,"f",function(){return d.f});c.d(b,"g",function(){return d.g})},29:function(a,b,c){function d(a,b){return k("children","value",a,b)}function e(a,b){return function O(a,b,c,d){var e,f=c[a];return f&&0!==f.length?n.a({},c,(e={},e[a]=f.reduce(function(c,e){return-1!==d.indexOf(e[b])&&c.push(O(a,b,e,d)),c},[]),e)):n.a({},c)}("children",
"value",a,b)}function f(a){return function(a,b){var c,d=b[a];return d?n.a({},b,((c={})[a]=function J(b){return 0===b.length?[]:1!==b.length||b[0][a]?1<b.length?b.reduce(function(b,c){var d;return c[a]?(b.push(n.a({},c,((d={})[a]=J(c[a]),d))),b):(b.push(c),b)},[]):J(b[0][a]):b}(d),c)):b}("children",a)}function g(a,b){return l("children",a,b)}function h(a,b,c,d){var e=c[a];return c[b]===d?c:e?e.reduce(function(c,e){return c||h(a,b,e,d)},void 0):void 0}function k(a,b,c,d){if(c=c[a])return c.reduce(function(c,
e){return e[b]===d[0]?1===d.length?e:k(a,b,e,d.slice(1)):c},void 0)}function l(a,b,c){var d;return c(n.a({},b,((d={})[a]=b[a]?b[a].map(function(b){return l(a,b,c)}):void 0,d)))}function m(a,b,c){return l(a,c,function(c){var d=c[b];if(delete c[b],c[a]){var e=c[a];return delete c[a],n.a({},c,{value:d,children:e})}return n.a({},c,{value:d})})}c.d(b,"d",function(){return d});c.d(b,"g",function(){return e});c.d(b,"e",function(){return f});c.d(b,"f",function(){return g});c.d(b,"a",function(){return h});
c.d(b,"b",function(){return k});c.d(b,"c",function(){return m});var n=c(0)},30:function(a,b,c){console.log},31:function(a,b,c){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return function(b){return a.reduceRight(function(a,b){return b(a)},b)}}c.d(b,"a",function(){return d})},32:function(a,b,c){function d(a){return function y(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return c.length>=a.length?a.call.apply(a,[this].concat(c)):function(){for(var a=[],
d=0;d<arguments.length;d++)a[d]=arguments[d];return y.call.apply(y,[b].concat(c,a))}}}c.d(b,"a",function(){return d})},33:function(a,b,c){c.d(b,"a",function(){return d});var d=function(a){return function(b){13===b.keyCode&&a(b)}}},34:function(a,b,c){var d=c(35);c.d(b,"a",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});var e=c(36);c.d(b,"b",function(){return e.a});c.d(b,"e",function(){return e.b})},35:function(a,b,c){function d(a){return a.filter(function(a){return 0<
a.length})}c.d(b,"b",function(){return e});c.d(b,"c",function(){return f});c.d(b,"a",function(){return d});a=c(10);var e=function(a,b,c){return c.indexOf(a)===b},f=Object(a.b)(function(a,b){var c={};return b.filter(function(b){return!c[b[a]]&&(c[b[a]]=!0,!0)})})},36:function(a,b,c){function d(a){return 0===Object.keys(a).length&&a.constructor===Object}c.d(b,"a",function(){return d});c.d(b,"b",function(){return f});var e=c(0);a=c(10);var f=Object(a.b)(function(a,b){b=e.a({},b);return delete b[a],b})},
367:function(a,b,c){c.r(b);var d=c(0),e=c(54);a=c(9);a=c.n(a);var f=c(56),g=c(105),h=c.n(g),g=c(106),k=c.n(g),g=c(107),l=c.n(g),g=c(108),m=c.n(g),g=c(109),n=c.n(g),g=c(110),p=c.n(g),g=c(111),r=c.n(g),g=c(101),v=c.n(g),q=c(4);c=function(a){function b(b,c){b=a.call(this,b,c)||this;return b.state={customActionsOpen:!1},b.handleActionDropdownToggle=b.handleActionDropdownToggle.bind(b),b.handleCustomActionClick=b.handleCustomActionClick.bind(b),b.handleMainActionClick=b.handleMainActionClick.bind(b),b}
return d.b(b,a),b.prototype.render=function(){var a,b=this,c=this.tsx,d=this.props,g=d.item,d=d.sortField;return a="numviews"===d?e.viewCount+": "+g.numViews:"avgrating"===d?e.rating+": "+g.avgRating.toFixed(2):"created"===d?e.created+": "+f.format(new Date(g.created),{selector:"date",formatLength:"short"}):e.updated+": "+f.format(new Date(g.modified),{selector:"date",formatLength:"short"}),c("div",{class:"card-ac__container",key:this.props.key},c("div",{class:"card-ac__details-container"},c("div",
{class:"card-ac__thumb-container"},c("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",alt:"",class:"card-ac__thumbnail",style:"\n                                background-image: url("+g.thumbURI+");\n                            "})),c("div",{class:"card-ac__details"},c("h3",{class:"card-ac__title"},g.title),c("div",{class:"card-ac__info-row"},c("div",{class:"card-ac__icon-title-container"},c("img",{src:g.iconURI,class:"content-search-item-icon",title:g.displayName}),
c("span",{class:"card-ac__author-text"},g.displayName+" "+e.by,c("a",{class:"content-search-selectable card-mc__author-link",title:this.props.organization?e.viewOrg:e.viewProfile,href:this.props.organization?this.props.organization.orgUrl:this.props.portal.baseUrl+"/home/user.html?user\x3d"+g.owner,target:"_blank"}," "+(this.props.organization?this.props.organization.name:g.owner)))),c("span",{class:"card-ac__info-bullet"},"\u2022"),c("span",{class:"card-ac__info-string"},a)),c("p",{class:"card-ac__snippet"},
c("span",{class:"card-ac__snippet-text"},g.snippet," "),c("a",{class:"card-ac__side-action card-ac__no-wrap",href:this.props.portal.baseUrl+"/home/item.html?id\x3d"+g.id,target:"_blank"},e.viewItem,c("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},c("path",{d:"M10 1v1h3.293l-6.646 6.646 0.707 0.707 6.646-6.646v3.293h1v-5z"}),c("path",{d:"M14 8v6h-12v-12h6v-1h-7v14h14v-7z"})))))),c("div",{class:"card-ac__sub-container"},c("div",{class:"card-ac__badge-container card-ac__badge-container--regular card-ac__sub-group"},
this.renderBadges()),c("div",{class:"card-ac__badge-container card-ac__badge-container--small card-ac__sub-group"},this.renderBadges(!0)),c("div",{class:"card-ac__action-container card-ac__sub-group"},c("div",{class:"card-ac__no-wrap"},c("button",{class:"card-ac__primary-btn card-ac__btn",onclick:this.handleMainActionClick},this.props.mainActionTitle),this.props.customActions&&0<this.props.customActions.length?c(v.a,{key:g.id+"-action-dropdown",active:this.state.customActionsOpen,onToggle:this.handleActionDropdownToggle},
c("span",{class:"card-ac__custom-actions card-ac__btn",title:e.actions},c("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 32 32"},c("path",{d:"M28 9v5L16 26 4 14V9l12 12L28 9z"}))),c("div",null,this.props.customActions.map(function(a,d){return c("button",{key:a.name,class:"card-ac__custom-action-btn card-ac__btn",value:d,onclick:b.handleCustomActionClick},a.name)}))):null))))},b.prototype.renderBadges=function(a){var b=this,c=this.tsx,d=a?"small":"regular";return this.props.item.badges.map(function(a){switch(a){case "authoritative":return c(h.a,
{size:d,altOrg:b.props.organization?b.props.organization.name:void 0});case "deprecated":return c(k.a,{size:d});case "livingAtlas":return c(l.a,{size:d});case "marketplace":return c(m.a,{size:d});case "openData":return c(n.a,{size:d});case "premium":return c(p.a,{size:d,user:b.props.portal.user});case "subscriber":return c(r.a,{size:d,user:b.props.portal.user})}return null})},b.prototype.handleActionDropdownToggle=function(){this.setState({customActionsOpen:!this.state.customActionsOpen})},b.prototype.handleMainActionClick=
function(a){this.props.mainAction([Object(q.M)(this.props.item)])},b.prototype.handleCustomActionClick=function(a){this.setState({customActionsOpen:!this.state.customActionsOpen});this.props.customActions&&this.props.customActions[a.target.value]&&this.props.customActions[a.target.value].onAction(Object(q.M)(this.props.item))},b}(a.a);b.default=c},37:function(a,b,c){var d=c(38);c.d(b,"b",function(){return d.a});c.d(b,"d",function(){return d.b});c.d(b,"i",function(){return d.c});var e=c(40);c.d(b,
"a",function(){return e.a});c.d(b,"e",function(){return e.b});c.d(b,"f",function(){return e.c});var f=c(41);c.d(b,"g",function(){return f.a});var g=c(42);c.d(b,"c",function(){return g.a});c.d(b,"h",function(){return g.b})},38:function(a,b,c){c.d(b,"b",function(){return m});c.d(b,"c",function(){return n});var d=c(1),e=c(15),f=c(16),g=c(17),h=c(18),k=c(19),l=c(39);c.d(b,"a",function(){return l.a});var m=function(a,b,c){return Object(d.a)(Object(k.a)(a),Object(h.a)(a),Object(g.a)(b),f.a,e.a)(c)},n=Object(d.a)(Object(d.j)("patchedDescription"),
Object(d.j)("thumbURI"),Object(d.j)("iconURI"),Object(d.j)("displayName"),Object(d.j)("badges"))},39:function(a,b,c){c.d(b,"a",function(){return d});var d={maps:'(type:("Project Package" OR "Windows Mobile Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Web Map" OR "CityEngine Web Scene" OR "Map Document" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Template") -type:("Web Mapping Application" OR "Layer Package"))',
webMaps:'(type:("Web Map" OR "CityEngine Web Scene") -type:("Web Mapping Application"))',mapFiles:'(type:("Map Document" OR "Windows Mobile Package" OR "Globe Document" OR "Scene Document" OR "Published Map" OR "Explorer Map" OR "ArcPad Package" OR "Map Package" OR "Basemap Package" OR "Mobile Basemap Package" OR "Mobile Map Package" OR "Pro Map" OR "Project Package" OR "Map Template"))',layers:'(type:("Scene Service" OR "Feature Collection" OR "Route Layer" OR "Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "Feature Service" OR "Stream Service" OR "Map Service" OR "Vector Tile Service" OR "Image Service" OR "WMS" OR "WFS" OR "WMTS" OR "KML" OR typekeywords:"OGC" OR typekeywords:"Geodata Service" OR "Globe Service" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Relational Database Connection") -type:("Web Mapping Application" OR "Geodata Service"))',
featureLayers:'(type:("Feature Collection" OR "Feature Service" OR "Stream Service" OR "WFS") -typekeywords:"Table")',tileLayers:'(type:("WMTS" OR "Map Service" OR "Vector Tile Service") typekeywords:("Hosted" OR "Tiled"))',mapImageLayers:'(type:("Map Service" OR "WMS") -typekeywords:("Tiled") -type:("Web Map" OR "Web Mapping Application" OR "Shapefile"))',imageryLayers:'(type:"Image Service")',sceneLayers:'(type:"Scene Service")',tables:"(typekeywords:Table)",layerFiles:'(type:("Layer" OR "Explorer Layer" OR "Tile Package" OR "Vector Tile Package" OR "Scene Package" OR "Layer Package" OR "CSV" OR "Shapefile" OR "GeoJson" OR "Service Definition" OR "File Geodatabase" OR "CAD Drawing" OR "Microsoft Excel") -type:("Explorer Maps" OR "Map Documents"))',
scenes:'(-type:"CityEngine Web Scene" type:"Web Scene")',apps:'(type:("Code Sample" OR "Web Mapping Application" OR "Mobile Application" OR "Application" OR "Desktop Application Template" OR "Desktop Application" OR "Operation View" OR "Dashboard" OR "Operations Dashboard Extension" OR "Workforce Project" OR "Insights Workbook" OR "Insights Page" OR "Insights Model" OR "Hub Page" OR "Hub Initiative" OR "Hub Site Application"))',webApps:'(type:("Web Mapping Application" OR "Dashboard"))',mobileApps:'(type:"Mobile Application")',
desktopApps:'(type:"Desktop Application" -type:"Desktop Application Template")',tools:'((typekeywords:"tool" OR type:"Raster function template" OR type:"Geodata Service" OR type:"Workflow Manager Package" OR type:"Rule Package" OR type:"Operations Dashboard Add In" OR type:"Workflow Manager Service" OR type:"ArcGIS Pro Configuration") -type:"KML")',locators:'(type:("Geocoding Service" OR "Locator Package"))',geodatabaseAccess:'(type:"Geodata Service")',geometricOperations:'(type:"Geometry Service")',
geoprocessingTasks:'(type:("Geoprocessing Service" OR "Geoprocessing Package" OR "Geoprocessing Sample"))',networkAnalysis:'(type:"Network Analysis Service")',files:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF") -type:("Map Document" OR "Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document" OR "Microsoft Excel"))',
documents:'(typekeywords:"Document" -type:"PDF")',images:'(type:("Image" OR "360 VR Experience") -type:"Image Service")',pdfs:'(type:"PDF")',webTools:'(type:"Geoprocessing Service" AND typekeywords: "Web Tool")',notebooks:'type:("Notebook") OR typekeywords:("Notebook" OR "Jupyter Notebook")'}},4:function(a,b,c){var d=c(1);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"w",function(){return d.c});c.d(b,"x",function(){return d.d});c.d(b,"y",function(){return d.e});c.d(b,"A",
function(){return d.f});c.d(b,"H",function(){return d.g});c.d(b,"I",function(){return d.h});c.d(b,"J",function(){return d.i});c.d(b,"N",function(){return d.k});c.d(b,"O",function(){return d.l});c.d(b,"P",function(){return d.m});c.d(b,"Q",function(){return d.n});c.d(b,"R",function(){return d.o});var e=c(37);c.d(b,"z",function(){return e.a});c.d(b,"B",function(){return e.b});c.d(b,"C",function(){return e.c});c.d(b,"D",function(){return e.d});c.d(b,"E",function(){return e.e});c.d(b,"F",function(){return e.f});
c.d(b,"G",function(){return e.g});c.d(b,"L",function(){return e.h});c.d(b,"M",function(){return e.i});var f=c(43);c.d(b,"a",function(){return f.a});c.d(b,"b",function(){return f.b});c.d(b,"c",function(){return f.c});c.d(b,"d",function(){return f.d});c.d(b,"e",function(){return f.e});c.d(b,"f",function(){return f.f});c.d(b,"g",function(){return f.g});c.d(b,"h",function(){return f.h});c.d(b,"k",function(){return f.i});c.d(b,"l",function(){return f.j});c.d(b,"m",function(){return f.k});c.d(b,"n",function(){return f.l});
c.d(b,"o",function(){return f.m});c.d(b,"p",function(){return f.n});c.d(b,"q",function(){return f.o});c.d(b,"r",function(){return f.p});c.d(b,"s",function(){return f.q});c.d(b,"t",function(){return f.r});c.d(b,"u",function(){return f.s});c.d(b,"v",function(){return f.t});c.d(b,"K",function(){return f.u})},40:function(a,b,c){c.d(b,"c",function(){return g});a=c(1);var d=c(7),e=c(20),f=c(21);c.d(b,"a",function(){return d.a});c.d(b,"b",function(){return d.b});var g=Object(a.a)(e.a,f.a,d.b)},41:function(a,
b,c){c.d(b,"a",function(){return f});var d=c(1),e=c(22),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)}},42:function(a,b,c){c.d(b,"a",function(){return f});c.d(b,"b",function(){return g});var d=c(1),e=c(23),f=function(a,b){return Object(d.a)(Object(e.a)(a))(b)},g=Object(d.a)(Object(d.j)("thumbURI"))},43:function(a,b,c){var d=c(44);c.d(b,"i",function(){return d.a});c.d(b,"j",function(){return d.b});c.d(b,"k",function(){return d.c});c.d(b,"l",function(){return d.d});c.d(b,"m",function(){return d.e});
c.d(b,"n",function(){return d.f});c.d(b,"o",function(){return d.g});c.d(b,"p",function(){return d.h});c.d(b,"q",function(){return d.i});c.d(b,"r",function(){return d.j});c.d(b,"s",function(){return d.k});c.d(b,"t",function(){return d.l});c.d(b,"u",function(){return d.m});var e=c(46);c.d(b,"a",function(){return e.a});c.d(b,"b",function(){return e.b});c.d(b,"c",function(){return e.c});c.d(b,"d",function(){return e.d});c.d(b,"e",function(){return e.e});c.d(b,"f",function(){return e.f});c.d(b,"g",function(){return e.g});
c.d(b,"h",function(){return e.h})},44:function(a,b,c){var d=c(6);c.d(b,"b",function(){return d.a});c.d(b,"c",function(){return d.b});c.d(b,"d",function(){return d.c});c.d(b,"e",function(){return d.d});c.d(b,"f",function(){return d.e});c.d(b,"g",function(){return d.g});c.d(b,"h",function(){return d.h});c.d(b,"i",function(){return d.i});c.d(b,"j",function(){return d.j});c.d(b,"k",function(){return d.k});c.d(b,"l",function(){return d.l});c.d(b,"m",function(){return d.m});var e=c(45);c.d(b,"a",function(){return e.a})},
45:function(a,b,c){c.d(b,"a",function(){return f});var d=c(12),e=c(6),f=function(a,b,c,f){function g(d){r=d.categorySchema[0].source.split(".")[1];Object(e.c)(a,b,c.contentCategorySetsGroupQuery).then(h,p);Object(e.m)(a,b.restUrl+"/portals/regions",{culture:f}).then(m,p)}function h(c){c.results[0]?Object(e.m)(a,b.restUrl+"/content/groups/"+c.results[0].id+"/search",{q:"typekeywords: "+r}).then(k,p):p("The content category sets group could not be found.")}function k(c){1===c.results.length&&c.results[0]?
Object(e.f)(a,b,c.results[0].id).then(l,p):p("The item containing the living atlas categories could not be determined.")}function l(a){t=a.categorySchema[0];c.isPortal&&u?n([t]):u&&n([t,u])}function m(a){u={categories:a.map(function(a){return{displayName:a.localizedName,title:a.region}}).sort(function(a,b){return"wo"===a.title.toLowerCase()?-1:a.displayName.localeCompare(b.displayName)}),description:"2.0",displayName:"Regions",title:"region"};c.isPortal&&t?n([t]):t&&n([t,u])}function n(a){v.resolve({schema:a,
id:q})}function p(a){v.reject(a)}void 0===f&&(f="en");var q,r,t,u,v=new d;return Object(e.c)(a,b,c.livingAtlasGroupQuery).then(function(c){c.results[0]&&c.results[0].id?(q=c.results[0].id,Object(e.d)(a,b,q).then(g,p)):p("The living atlas group could not be found.")},p),v}},46:function(a,b,c){var d=c(47);c.d(b,"a",function(){return d.a});var e=c(48);c.d(b,"d",function(){return e.a});var f=c(49);c.d(b,"e",function(){return f.a});var g=c(50);c.d(b,"f",function(){return g.a});var h=c(51);c.d(b,"g",function(){return h.a});
c.d(b,"h",function(){return h.b});var k=c(52);c.d(b,"b",function(){return k.a});c.d(b,"c",function(){return k.b})},47:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(access:"+a.value+")"]):b})},48:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b){return a?b.concat(["(group:"+a.id+")"]):b})},49:function(a,b,c){function d(a){return'(type:"'+a.join('" OR type:"')+'")'}c.d(b,"a",function(){return e});a=c(1);
var e=Object(a.b)(function(a,b,c){var e=b.itemTypeFilter,f=b.allowedItemTypes;b=b.specialItemQ;return e?c.concat([a[e.value]+" AND ("+d(f)+(b?" OR ("+b+")":"")+")"]):b?c.concat(["("+d(f)+" OR ("+b+"))"]):c.concat([d(f)])})},50:function(a,b,c){c.d(b,"a",function(){return d});a=c(1);var d=Object(a.b)(function(a,b,c){if(a)switch(a.value){case "authoritative":return b&&b.orgId?c.concat(["((contentstatus:org_authoritative orgid:"+b.orgId+") OR contentstatus:public_authoritative)"]):c.concat(["(contentstatus:public_authoritative)"]);
case "deprecated":return c.concat(["(contentstatus:deprecated)"])}return c})},51:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);var d=Object(a.b)(function(a,b){return a&&(a=Object.keys(a),0<a.length)?b.concat(["tags:("+a.join(" AND ")+")"]):b}),e=Object(a.b)(function(a,b){return 2<a.length?b.concat(["tags:("+a+"* OR "+a+")"]):b})},52:function(a,b,c){c.d(b,"b",function(){return d});c.d(b,"a",function(){return e});a=c(1);a=Object(a.b)(function(a,b,c){return b?
c.concat(["("+a+":"+("[000000"+b.start+" TO 000000"+b.end+"]")+")"]):c});var d=a("modified"),e=a("uploaded")},54:function(b,c){b.exports=a},56:function(a,b){a.exports=e},6:function(a,b,c){function d(a){return a.reduce(function(a,b){return b&&b.relatedItems?a.concat(b.relatedItems.map(function(a){return a.id})):a},[])}function e(a,b,c){return a(b,{query:f.a({f:"json"},c)}).then(function(a){return a.data})}c.d(b,"i",function(){return h});c.d(b,"f",function(){return k});c.d(b,"c",function(){return l});
c.d(b,"d",function(){return m});c.d(b,"g",function(){return n});c.d(b,"h",function(){return p});c.d(b,"a",function(){return q});c.d(b,"b",function(){return r});c.d(b,"j",function(){return v});c.d(b,"k",function(){return K});c.d(b,"l",function(){return H});c.d(b,"e",function(){return J});c.d(b,"m",function(){return e});var f=c(0),g=c(11),h=function(a,b,c){return e(a,b.restUrl+"/portals/self",{culture:c,default:!0})},k=function(a,b,c){return e(a,b.restUrl+"/content/items/"+c+"/data")},l=function(a,
b,c){return e(a,b.restUrl+"/community/groups",{q:c})},m=function(a,b,c){return e(a,b.restUrl+"/community/groups/"+c+"/categorySchema")},n=function(a,b,c){return e(a,b.restUrl+"/portals/"+(c||b.id)+"/categorySchema")},p=function(a,b,c){return e(a,location.protocol+"//"+b.portalHostname+"/sharing/rest/portals/"+(c||b.id))},q=function(a,b,c){return a(b.restUrl+"/community/groups",{query:{f:"json",q:"orgid:"+b.id+" AND access:public",num:100,start:c||1,sortField:"title",sortOrder:"asc"}}).then(function(c){return c.data.total>
c.data.start+c.data.num?q(a,b,c.data.start+c.data.num).then(function(a){return f.a({},a,{data:f.a({},a.data,{results:c.data.results.concat(a.data.results)})})}):c})},r=function(a,b,c,f){return a(b.restUrl+"/community/users/"+c+"/provisionedListings",{query:{f:"json",num:100,start:f||1}}).then(function(f){var h=f.data.provisionedListings.map(function(c){return e(a,b.restUrl+"/content/items/"+(c.id||c.itemId)+"/relatedItems?relationshipType\x3dListed2ImplicitlyListed\x26direction\x3dforward").then(function(a){return a},
function(a){})});return f.data.total>f.data.start+f.data.num?r(a,b,c,f.data.start+f.data.num).then(function(a){return g(h).then(function(b){return a.concat(f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(b)))})}):g(h).then(function(a){return f.data.provisionedListings.filter(function(a){return!!a.itemId}).map(function(a){return a.itemId}).concat(d(a))})})},v=function(a,b,c){return e(a,b.restUrl+"/community/users/"+(c||b.user.username))},
K=function(a,b,c){return e(a,b.restUrl+"/content/users/"+(c||b.user.username))},H=function(a,b,c){return e(a,b.restUrl+"/content/groups/"+c)},J=function(a,b,c){return e(a,b.restUrl+"/community/groups",c)}},7:function(a,b,c){c.d(b,"a",function(){return e});c.d(b,"b",function(){return f});var d=c(0),e=function(a){return a.urlKey?location.protocol+"//"+a.urlKey+"."+a.customBaseUrl:location.protocol+"//"+a.portalHostname},f=function(a){return d.a({},a,{baseUrl:e(a)})}},9:function(a,b){a.exports=c}})})},
"arcgis-components/Modals/Overlay":function(){define(["../Component"],function(c){return function(c){function h(e){if(a[e])return a[e].exports;var f=a[e]={i:e,l:!1,exports:{}};return c[e].call(f.exports,f,f.exports,h),f.l=!0,f.exports}var a={};return h.m=c,h.c=a,h.d=function(a,c,d){h.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},h.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",
{value:!0})},h.t=function(a,c){if((1&c&&(a=h(a)),8&c)||4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(h.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var b in a)h.d(d,b,function(b){return a[b]}.bind(null,b));return d},h.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return h.d(c,"a",c),c},h.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},h.p="",h(h.s=373)}({0:function(c,
h,a){function e(a,c){function b(){this.constructor=a}f(a,c);a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}a.d(h,"b",function(){return e});a.d(h,"a",function(){return d});var f=function(a,c){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,c)},d=function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,
e)&&(a[e]=b[e]);return a}).apply(this,arguments)}},3:function(l,h){l.exports=c},373:function(c,h,a){a.r(h);var e=a(0);c=a(3);a=function(a){function c(b,c){return a.call(this,b,c)||this}return e.b(c,a),c.prototype.componentWillReceiveProps=function(a){!1!==this.props.scrollable&&!1===a.scrollable&&(a=document.getElementsByClassName("mod__overlay-container"),a[0]&&(a[0].scrollTop=0))},c.prototype.render=function(){return(0,this.tsx)("div",{classes:{"mod__overlay-container":!0,"mod__overlay-container--closing":this.props.closing,
"mod__overlay-container--no-scroll":!1===this.props.scrollable},key:this.props.key},this.props.children)},c}(a.n(c).a);h.default=a}})})},"arcgisonline/pages/dijit/Overlay":function(){define("dojo/_base/declare dojo/on dojo/topic dojo/query dojo/_base/lang dojo/string dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dijit/_TemplatedMixin dijit/_WidgetBase ../pageUtil ../utils/formatters dojo/text!./Overlay/templates/Overlay.html dojo/i18n!../../nls/arcgisonline".split(" "),function(c,l,h,a,
e,f,d,b,g,k,m,p,q,n,r,v){return c([p,m],{templateString:r,i18n:v,_showActionBar:!0,_shouldScroll:!0,_unsavedChanges:!1,hide:n.hide,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);k.place(this.overlayContents,this._overlayContentWrapper,"only");this._showActionBar||g.add(this._overlayContentWrapper,"overlay-content--no-actions");this._shouldScroll&&g.add(this._overlayContentWrapper,"overlay-content--scroll");this._addEventListeners()},_addEventListeners:function(){this.own(h.subscribe("overlay/open",
e.hitch(this,this.open)),l(this.closeBtn,"click",e.hitch(this,this.close)))},open:function(){g.add(document.documentElement,"overflow-hidden");window.getComputedStyle(this.domNode).opacity;a(this.domNode).addClass("is-active");this.render&&this.render();this._setFirstLastFocus();this.own(l(window,"keydown",this._checkFocusedElement.bind(this)));this._firstFocusableElement.focus()},close:function(){this._unsavedChanges&&this.unsavedChangesText?1==confirm(this.unsavedChangesText)&&this._closeAndDestroy():
this._closeAndDestroy();if(this.onClose&&"function"===typeof this.onClose)this.onClose()},setUnsaved:function(a){this._unsavedChanges=a},_setFirstLastFocus:function(){var a=Array.prototype.slice.call(this.domNode.querySelectorAll("button, [href], input, select, textarea, [tabindex]")).filter(function(a){return!a.disabled&&-1!==a.tabIndex&&0<a.offsetHeight});this._firstFocusableElement=a.shift();this._lastFocusableElement=a.pop()},_closeAndDestroy:function(){a(".js-overlay").removeClass("is-active");
g.remove(document.documentElement,"overflow-hidden");setTimeout(function(){this.destroy()}.bind(this),300)},_checkFocusedElement:function(a){"Tab"!==a.key&&9!==a.keyCode||this.domNode.contains(document.activeElement)||(this._setFirstLastFocus(),(a.shiftKey?this._lastFocusableElement:this._firstFocusableElement).focus(),a.preventDefault())}})})},"arcgisonline/sharing/dijit/dialog/OverwriteFromCloud":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/_base/event dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog ./_CreateItemUtilMixin dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog arcgisonline/pages/portal/cloudProvider/GoogleConnect arcgisonline/pages/portal/cloudProvider/DropBoxConnect arcgisonline/pages/portal/cloudProvider/BoxConnect arcgisonline/pages/portal/cloudProvider/OneDriveConnect arcgisonline/sharing/util dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/OverwriteFromCloud.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y,C,x,B,z,F,A,E,N,O,K,H,J,L,R,M,Q){return l([A,E,N,h],{baseClass:"overwriteFromCloud",templateString:Q,postMixInProperties:function(){this.inherited(arguments);b.mixin(this,{isBatch:this.items&&1<this.items.length});this.i18n=b.mixin({},M)},startup:function(a,b,c){this.inherited(arguments);this.portal=a;this.cloudProviderInfo=b;this.originalItemToOverwrite=c;this.addItem=null;this.currentCloudProvider="";this.cloudConnect={googleConnect:null,dropBoxConnect:null,
oneDriveConnect:null,boxConnect:null};this.cloudDriveText="";this.publishInfo=null;this.cloudProviderInfo&&"boxConnect"===this.cloudProviderInfo.cloudProvider?(this.currentCloudProvider="boxConnect",this.cloudConnect[this.currentCloudProvider]=new J,this.cloudDriveText="Box"):this.cloudProviderInfo&&"dropBoxConnect"===this.cloudProviderInfo.cloudProvider?(this.currentCloudProvider="dropBoxConnect",this.cloudConnect[this.currentCloudProvider]=new H,this.cloudDriveText="Dropbox"):this.cloudProviderInfo&&
"oneDriveConnect"===this.cloudProviderInfo.cloudProvider?(this.currentCloudProvider="oneDriveConnect",this.cloudConnect[this.currentCloudProvider]=new L,this.cloudDriveText="OneDrive"):(this.currentCloudProvider="googleConnect",this.cloudConnect[this.currentCloudProvider]=new K,this.cloudDriveText="Google Drive");return this._initUI()},showModal:function(a){a=new x;this.dlg=new z({title:M.overwriteFromCloudDlg.originalDialogTitle+this.cloudDriveText,style:{width:"500px",height:"auto"},buttonOkLabel:M.overwriteFromCloudDlg.overwriteCloudButton+
this.cloudDriveText});var c="";-1!==this.cloudProviderInfo.mimeType.indexOf("google-apps")||-1!==this.cloudProviderInfo.mimeType.indexOf("googlesheets")?(c=M.overwriteFromCloudDlg.cloudFileTypeGoogleSheets,this.cloudProviderInfo.mimeType="googlesheets"):c=-1!==this.cloudProviderInfo.mimeType.indexOf("csv")?M.overwriteFromCloudDlg.cloudFileTypeCsv:-1!==this.cloudProviderInfo.mimeType.indexOf("excel")||-1!==this.cloudProviderInfo.mimeType.indexOf("spreadsheetml")?M.overwriteFromCloudDlg.cloudFileTypeExcel:
-1!==this.cloudProviderInfo.mimeType.indexOf("shapeFile")?M.overwriteFromCloudDlg.cloudFileTypeShapefile:-1!==this.cloudProviderInfo.mimeType.indexOf("fgdb")?M.overwriteFromCloudDlg.cloudFileTypeFgdb:-1!==this.cloudProviderInfo.mimeType.indexOf("geojson")?M.overwriteFromCloudDlg.cloudFileTypeGeoJson:M.overwriteFromCloudDlg.cloudFileTypeExcel;c=e.substitute({title:this.originalItemToOverwrite.title,fileType:c,cloudDrive:this.cloudDriveText},M.overwriteFromCloudDlg.overwriteInfoText);q(".overwriteInfoText",
this.domNode).attr("innerHTML",c);this.dlg.setContent(this.domNode);this.dlg.show();this.own(n(this.dlg,"ok",b.hitch(this,function(){this.set("readOnly",!0);this._loaderHelper(!0,M.overwriteFromCloudDlg.defaultLoading);this.cloudConnect[this.currentCloudProvider].GetTokenViaOauth("https://"+this.portal.portalHostname).then(b.hitch(this,function(a){var c="",c="googleConnect"===this.cloudProviderInfo.cloudProvider?-1!==this.cloudProviderInfo.mimeType.indexOf("google-apps")||-1!==this.cloudProviderInfo.mimeType.indexOf("googlesheets")?
"https://www.googleapis.com/drive/v3/files/"+this.cloudProviderInfo.id+'/export?mimeType\x3dapplication/vnd.openxmlformats-officedocument.spreadsheetml.sheet\x26httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+a+'"}':"https://www.googleapis.com/drive/v3/files/"+this.cloudProviderInfo.id+'?alt\x3dmedia\x26httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+a+'"}':"dropBoxConnect"===this.cloudProviderInfo.cloudProvider?'https://content.dropboxapi.com/2/files/download?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+
a+'","Dropbox-API-Arg":"{\\"path\\":\\"'+this.cloudProviderInfo.id+'\\"}"}':"oneDriveConnect"===this.cloudProviderInfo.cloudProvider?"https://graph.microsoft.com/v1.0/me/drive/items/"+this.cloudProviderInfo.id+'/content?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+a+'"}':"https://api.box.com/2.0/files/"+this.cloudProviderInfo.id+'/content?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+a+'"}';this._loaderHelper(!0,M.overwriteFromCloudDlg.addingItem);this._addExternalItem(c,this.originalItemToOverwrite.title,
this.cloudProviderInfo.mimeType).then(b.hitch(this,function(a){this.publishInfo={itemId:this.addItem.id,filetype:this._getNameForMimeType(this.cloudProviderInfo.mimeType,"publish")};this._getPublishParametersForOverwrite().then(b.hitch(this,function(a){this.publishInfo.item=this.addItem;this.publishInfo.publishParameters=a;this.publishInfo.overwrite=!0;this.publishInfo.deleteSourceItemUponCompletion=!0;this._loaderHelper(!0,M.overwriteFromCloudDlg.overwriting);this._publishExternalItem().then(b.hitch(this,
function(a){this._updateTypeKeyword(a).then(b.hitch(this,function(){window.location="item.html?id\x3d"+a[0].serviceItemId+"\x26jobid\x3d"+a[0].jobId}))}))}))}),b.hitch(this,function(a){this._showError(M.overwriteFromCloudDlg.errors.addItemCheckStatusIssue,!0)}))}),b.hitch(this,function(a){"popupBlocked"===a?this._showError(M.overwriteFromCloudDlg.errors.popupIssue):"InvalidToken"===a||"windowClosed"===a?this._loaderHelper(!1,null):this._showError(a)}))})),n(this.dlg,"cancel",b.hitch(this,function(){this.set("readOnly",
!0);this.onCancel()})));return a},onCancel:function(){this.dlg&&this.dlg.destroyRecursive()},_initUI:function(){return new x},_addExternalItem:function(a,c,d){var e=new x;a={dataUrl:a,async:!0,type:this._getNameForMimeType(d,"addItemType"),typeKeywords:this._getNameForMimeType(d,"addItemKeywords"),Title:c,filename:c};var f=this.portal;F.addItem(a,this.originalItemToOverwrite.folderId,f).then(b.hitch(this,function(a){this.addItem=a;F.checkStatus(this.addItem,e,null,f,function(a){e.resolve(a)})}),b.hitch(this,
function(a){this._showError(a);e.reject(a)}));return e},_getPublishParametersForOverwrite:function(){var a=new x;F.getPublishParametersForOverwrite(this.originalItemToOverwrite,this._getNameForMimeType(this.cloudProviderInfo.mimeType,"addItem")).then(b.hitch(this,function(b){a.resolve(b)}),b.hitch(this,function(b){this._showError(b);a.reject(b)}));return a},_publishExternalItem:function(){var a=new x;F.publishItem(this.publishInfo.item,this.publishInfo,this.portal).then(b.hitch(this,function(b){a.resolve(b.publishResult)}),
b.hitch(this,function(b){this._showError(b);a.reject(b)}));return a},_getNameForMimeType:function(a,b){var c="";return c=-1!==b.indexOf("addItem")?-1!==a.indexOf("csv")?"CSV":-1!==a.indexOf("excel")?"Microsoft Excel":-1!==a.indexOf("shapeFile")?"Shapefile":-1!==a.indexOf("fgdb")?"File Geodatabase":-1!==a.indexOf("geojson")?"GeoJson":-1!==a.indexOf("sheets")?"Microsoft Excel":"CSV":-1!==a.indexOf("csv")?"csv":-1!==a.indexOf("excel")?"excel":-1!==a.indexOf("shapeFile")?"shapefile":-1!==a.indexOf("fgdb")?
"fileGeodatabase":-1!==a.indexOf("geojson")?"geojson":-1!==a.indexOf("sheets")?"excel":"csv"},_updateTypeKeyword:function(a){var c=new x,d=this.portal,e=this.originalItemToOverwrite.folderId,f="Cloud Drive",g=JSON.parse(this.publishInfo.publishParameters);if("address"===g.locationType||g.layers[0]&&"address"===g.layers[0].locationType)f+=",showUnmatchedAddresses,Involved Lookup";else if("none"===g.locationType||g.layers[0]&&"none"===g.layers[0].locationType)f+=",Table";F.updateItem({folderId:e,id:a[0].serviceItemId,
typeKeywords:f},d).then(b.hitch(this,function(){c.resolve()}),b.hitch(this,function(a){this._showError(a);c.reject(a)}));return c},_showError:function(a,c){a=b.mixin(b.mixin({},M.overwriteFromCloudDlg.errors.error),a);this._errorDlg=new z({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(a).then(b.hitch(this,function(){this.set("readOnly",!1);this._errorDlg.hide()}));c||null!=this.addItem&&F.deleteItem(this.addItem,this.portal);this._loaderHelper(!1,null);return!1},_loaderHelper:function(a,
b){b=b?b:"Loading...";!0===a?(this._showHideDiv(".loader",!0),q(".loader-text",this.domNode).attr("innerHTML",b),q(".overwriteDialog",this.domNode).style("opacity",.5),q(".overwriteDialog",this.domNode).style("pointer-events","none"),this.dlg.okButton.set("disabled",!0),this.dlg.cancelButton.set("disabled",!0)):(q(".loader-text",this.domNode).attr("innerHTML",b),this._showHideDiv(".loader",!1),q(".overwriteDialog",this.domNode).style("opacity",1),q(".overwriteDialog",this.domNode).style("pointer-events",
"auto"),this.dlg.okButton.set("disabled",!1),this.dlg.cancelButton.set("disabled",!1))},_showHideDiv:function(a,b){!0===b?q(a).removeClass("hide"):q(a).addClass("hide")}})})},"arcgisonline/pages/portal/cloudProvider/GoogleConnect":function(){define("esri/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful ./CommonCloudProvider".split(" "),function(c,l,h,a,e,f,d,b){return c([b,d],{constructor:function(a){this.googleToken="";this.allPages=[]},postscript:function(){},
GetTokenViaOauth:function(b){var c=new f,d="google"+Math.floor(Date.now()/1E3);this._oauthSignIn("https://accounts.google.com/o/oauth2/v2/auth?scope\x3dhttps://www.googleapis.com/auth/drive.readonly\x26redirect_uri\x3d"+(b+"/home/cloudDriveOauth-callback2.html")+"\x26response_type\x3dtoken\x26client_id\x3d"+esriGeowConfig.googleClientId+"\x26hl\x3d"+dojo.locale+"\x26state\x3d"+d,b).then(a.hitch(this,function(b){this._getTokenValue(b,"state").then(a.hitch(this,function(e){d!=e&&c.reject("invalidState");
this._getTokenValue(b,"access_token").then(a.hitch(this,function(a){this.googleToken=a;c.resolve(a)}),a.hitch(this,function(a){c.reject(a)}))}))}),a.hitch(this,function(a){c.reject(a)}));return c},GetAllFiles:function(b){var c=new f,d=b&&b.searchText?b.searchText:null,e=b&&b.dropdownFilter?b.dropdownFilter:null;b=b&&b.previousOrNext?b.previousOrNext:null;b||(this.allPages=[]);var g="",h="https://www.googleapis.com/drive/v3/files?access_token\x3d"+this.googleToken+"\x26pageSize\x3d10\x26q\x3d";d&&
(h+="name contains '"+d+"'and");"csv"===e?(h+='(mimeType\x3d"text/csv")',g="csv"):"excel"===e?(h+='(mimeType\x3d"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"ormimeType\x3d"application/vnd.ms-excel")',g="excel"):"shapeFile"===e?(h+='(mimeType\x3d"application/x-zip-compressed"ormimeType\x3d"application/zip")',g="shapeFile"):"fgdb"===e?(h+='(mimeType\x3d"application/x-zip-compressed"ormimeType\x3d"application/zip")',g="fgdb"):"geoJson"===e?(h+='(name contains "json" or name contains "geojson")and(mimeType\x3d"application/octet-stream"ormimeType\x3d"application/json")',
g="geojson"):"sheets"===e?(h+='(mimeType\x3d"application/vnd.google-apps.spreadsheet")',g="googlesheets"):(h+='(mimeType\x3d"text/csv")',g="csv");b&&"next"===b&&(h+="\x26pageToken\x3d"+this.allPages[this.allPages.length-1].NextToken);b&&"previous"===b&&2<=this.allPages.length&&(this.allPages.pop(),1<this.allPages.length&&(h+="\x26pageToken\x3d"+this.allPages[this.allPages.length-2].NextToken),this.allPages.pop());this._makeExternalRequests("GET",h,null,null,"application/json").then(a.hitch(this,function(a){var b=
{files:[]};b.next=a.nextPageToken?!0:!1;b.previous=1<=this.allPages.length?!0:!1;this.allPages.push({Next:b.next,Previous:b.previous,NextToken:a.nextPageToken?a.nextPageToken:null});for(i=0;i<a.files.length;i++){var d=a.files[i];b.files.push({id:d.id,name:d.name,mimeType:g,downloadUrl:-1!==d.mimeType.indexOf("google-apps")?"https://www.googleapis.com/drive/v3/files/"+d.id+'/export?mimeType\x3dapplication/vnd.openxmlformats-officedocument.spreadsheetml.sheet\x26httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+
this.googleToken+'"}':"https://www.googleapis.com/drive/v3/files/"+d.id+'?alt\x3dmedia\x26httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+this.googleToken+'"}'})}c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}));return c}})})},"arcgisonline/pages/portal/cloudProvider/CommonCloudProvider":function(){define("esri/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/Stateful dojo/promise/all dojo/Deferred".split(" "),function(c,l,h,a,e,f,d){return c([e],{constructor:function(a){},postscript:function(){},
_oauthSignIn:function(a,c){var b=new d;a=c+"/home/cloudDriveOauth-callback.html"+("?cloudUrl\x3d"+a+"\x26currentSourceUrl\x3d"+(window.location.protocol+"//"+window.location.hostname)+"\x26portalHostName\x3d"+c);var e=document.createElement("iframe");e.setAttribute("src",a);e.setAttribute("class","hide");document.body.appendChild(e);a=window.addEventListener?"addEventListener":"attachEvent";(0,window[a])("attachEvent"==a?"onmessage":"message",function(a){a.origin===c&&("popupBlocked"!==a.data&&"windowClosed"!==
a.data||b.reject(a.data),b.resolve(a.data))},!1);return b},_getTokenValue:function(a,c){var b=new d;c=c.replace(/[[]/,"[").replace(/[]]/,"]");a=(new RegExp("[?\x26#]"+c+"\x3d([^\x26#]*)")).exec(a);null==a?b.reject("InvalidToken"):b.resolve(a[1]);return b},_makeExternalRequests:function(a,c,e,f,h){var b=new d,g=new XMLHttpRequest;g.open(a,c,!1);f&&g.setRequestHeader("Authorization",f);h&&g.setRequestHeader("Content-type",h);e?g.send(e):g.send();a=JSON.parse(g.responseText);400<=g.status&&b.reject(JSON.parse(g.responseText));
b.resolve(a);return b}})})},"arcgisonline/pages/portal/cloudProvider/DropBoxConnect":function(){define("esri/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful ./CommonCloudProvider".split(" "),function(c,l,h,a,e,f,d,b){return c([b,d],{constructor:function(a){this.dropBoxToken="";this.allPages=[]},postscript:function(){},GetTokenViaOauth:function(b){var c=new f,d="dropbox"+Math.floor(Date.now()/1E3);this._oauthSignIn("https://www.dropbox.com/oauth2/authorize?redirect_uri\x3d"+
(b+"/home/cloudDriveOauth-callback2.html")+"\x26response_type\x3dtoken\x26client_id\x3d"+esriGeowConfig.dropboxClientId+"\x26locale\x3d"+dojo.locale+"\x26state\x3d"+d,b).then(a.hitch(this,function(b){this._getTokenValue(b,"state").then(a.hitch(this,function(e){d!=e&&c.reject("invalidState");this._getTokenValue(b,"access_token").then(a.hitch(this,function(a){this.dropBoxToken=a;c.resolve(a)}),a.hitch(this,function(a){c.reject(a)}))}))}),a.hitch(this,function(a){c.reject(a)}));return c},GetAllFiles:function(b){var c=
new f,d=b&&b.searchText?b.searchText:null,e=b&&b.dropdownFilter?b.dropdownFilter:null,g=b&&b.previousOrNext?b.previousOrNext:null;b="Bearer "+this.dropBoxToken;g||(this.allPages=[]);var h="",d=d?" "+d:"",l=0;g&&"next"===g&&(l=this.allPages[this.allPages.length-1].NextToken);g&&"previous"===g&&2<=this.allPages.length&&(this.allPages.pop(),1<this.allPages.length&&(l=this.allPages[this.allPages.length-2].NextToken),this.allPages.pop());g="";"csv"===e?(g='{"path":"","query":"'+d+' csv","mode": "filename_and_content","max_results":10,"start":'+
l+"}",h="csv"):"excel"===e?(g='{"path":"","query":"'+d+' xls","mode": "filename_and_content","max_results":10,"start":'+l+"}",h="excel"):"shapeFile"===e?(g='{"path":"","query":"'+d+' .zip","mode": "filename_and_content","max_results":10,"start":'+l+"}",h="shapeFile"):"fgdb"===e?(g='{"path":"","query":"'+d+' .zip","mode": "filename_and_content","max_results":10,"start":'+l+"}",h="fgdb"):"geoJson"===e?(g='{"path":"","query":"'+d+' .geojson","mode": "filename_and_content","max_results":10,"start":'+
l+"}",h="geojson"):(g='{"path":"","query":"'+d+' csv","mode": "filename_and_content","max_results":10,"start":'+l+"}",h="csv");this._makeExternalRequests("POST","https://api.dropboxapi.com/2/files/search",g,b,"application/json").then(a.hitch(this,function(a){var b={files:[]};b.next=a.more?!0:!1;b.previous=1<=this.allPages.length?!0:!1;this.allPages.push({Next:b.next,Previous:b.previous,NextToken:a.more?a.start:null});for(i=0;i<a.matches.length;i++){var d=a.matches[i];"file"===d.metadata[".tag"]&&
b.files.push({id:d.metadata.id,name:d.metadata.name,mimeType:h,downloadUrl:'https://content.dropboxapi.com/2/files/download?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+this.dropBoxToken+'","Dropbox-API-Arg":"{\\"path\\":\\"'+d.metadata.id+'\\"}"}'})}c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}));return c}})})},"arcgisonline/pages/portal/cloudProvider/BoxConnect":function(){define("esri/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful ./CommonCloudProvider".split(" "),
function(c,l,h,a,e,f,d,b){return c([b,d],{constructor:function(a){this.boxToken="";this.allPages=[]},postscript:function(){},GetTokenViaOauth:function(b){var c=new f,d=b+"/home/cloudDriveOauth-callback2.html";this._oauthSignIn("https://account.box.com/api/oauth2/authorize?redirect_uri\x3d"+d+"\x26response_type\x3dcode\x26client_id\x3d"+esriGeowConfig.boxClientId+"\x26locale\x3d"+dojo.locale,b).then(a.hitch(this,function(b){this._getTokenValue(b,"code").then(a.hitch(this,function(b){this._makeExternalRequests("POST",
"https://api.box.com/oauth2/token","grant_type\x3dauthorization_code\x26code\x3d"+b+"\x26client_id\x3d"+esriGeowConfig.boxClientId+"\x26client_secret\x3d"+esriGeowConfig.boxClientSecret+"\x26redirect_uri\x3d"+d).then(a.hitch(this,function(a){this.boxToken=a.access_token;c.resolve(a.access_token)}),a.hitch(this,function(a){c.reject(a)}))}))}),a.hitch(this,function(a){c.reject(a)}));return c},GetAllFiles:function(b){var c=new f,d=b&&b.searchText?b.searchText:null,e=b&&b.dropdownFilter?b.dropdownFilter:
null;b=b&&b.previousOrNext?b.previousOrNext:null;var g="Bearer "+this.boxToken;b||(this.allPages=[]);var h="https://api.box.com/2.0/search?fields\x3did,name\x26type\x3dfile\x26limit\x3d10",h=d?h+("\x26query\x3d"+d):h+"\x26query\x3dcsv xls",h="all"!==e&&e?"csv"===e?h+"\x26file_extensions\x3dcsv":"excel"===e?h+"\x26file_extensions\x3dxls,xlsx":h+"\x26file_extensions\x3dcsv,xls,xlsx":h+"\x26file_extensions\x3dcsv,xls,xlsx";b&&"next"===b&&(h+="\x26offset\x3d"+this.allPages[this.allPages.length-1].NextToken);
b&&"previous"===b&&2<=this.allPages.length&&(this.allPages.pop(),1<this.allPages.length&&(h+="\x26offset\x3d"+this.allPages[this.allPages.length-2].NextToken),this.allPages.pop());this._makeExternalRequests("GET",h,null,g,"application/json").then(a.hitch(this,function(a){var b={files:[]};b.next=a.total_count>a.limit+a.offset?!0:!1;b.previous=1<=this.allPages.length?!0:!1;this.allPages.push({Next:b.next,Previous:b.previous,NextToken:a.total_count>a.limit+a.offset?a.limit+a.offset:!1});for(i=0;i<a.entries.length;i++){var d=
a.entries[i];b.files.push({id:d.id,name:d.name,mimeType:-1!==d.name.indexOf("csv")?"csv":"excel",downloadUrl:"https://api.box.com/2.0/files/"+d.id+'/content?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+this.boxToken+'"}'})}c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}));return c}})})},"arcgisonline/pages/portal/cloudProvider/OneDriveConnect":function(){define("esri/declare esri/arcgis/Portal esri/lang dojo/_base/lang dojo/promise/all dojo/Deferred dojo/Stateful ./CommonCloudProvider".split(" "),
function(c,l,h,a,e,f,d,b){return c([b,d],{constructor:function(a){this.oneDriveToken="";this.allPages=[]},postscript:function(){},GetTokenViaOauth:function(b){var c=new f,d="onedrive"+Math.floor(Date.now()/1E3);this._oauthSignIn("https://login.microsoftonline.com/common/oauth2/v2.0/authorize?scope\x3dfiles.read\x26redirect_uri\x3d"+(b+"/home/cloudDriveOauth-callback2.html")+"\x26response_type\x3dtoken\x26client_id\x3d"+esriGeowConfig.oneDriveClientId+"\x26locale\x3d"+dojo.locale+"\x26state\x3d"+d,
b).then(a.hitch(this,function(b){this._getTokenValue(b,"state").then(a.hitch(this,function(e){d!=e&&c.reject("invalidState");this._getTokenValue(b,"access_token").then(a.hitch(this,function(a){this.oneDriveToken=a;c.resolve(a)}),a.hitch(this,function(a){c.reject(a)}))}))}),a.hitch(this,function(a){c.reject(a)}));return c},GetAllFiles:function(b){var c=new f,d=b&&b.searchText?b.searchText:null,e=b&&b.dropdownFilter?b.dropdownFilter:null;b=b&&b.previousOrNext?b.previousOrNext:null;var g="Bearer "+this.oneDriveToken;
b||(this.allPages=[]);var h="",l="https://graph.microsoft.com/v1.0/me/drive/root/search(q\x3d'";d&&(l+=d+" ");"csv"===e?(l+=".csv",h="csv"):"excel"===e?(l+=".xls",h="excel"):"shapeFile"===e?(l+=".zip",h="shapeFile"):"fgdb"===e?(l+=".zip",h="fgdb"):"geoJson"===e?(l+=".geojson .json",h="geojson"):(l+=".csv",h="csv");l+="')?select\x3dname,id,file\x26top\x3d10";b&&"next"===b&&(l+="\x26$skiptoken\x3d"+this.allPages[this.allPages.length-1].NextToken);b&&"previous"===b&&2<=this.allPages.length&&(this.allPages.pop(),
1<this.allPages.length&&(l+="\x26$skiptoken\x3d"+this.allPages[this.allPages.length-2].NextToken),this.allPages.pop());this._makeExternalRequests("GET",l,null,g,"application/json").then(a.hitch(this,function(a){var b={files:[]};b.next=a["@odata.nextLink"]?!0:!1;b.previous=1<=this.allPages.length?!0:!1;var d={Next:b.next,Previous:b.previous,NextToken:a["@odata.nextLink"]?this._getNextTokenFromUrl(a["@odata.nextLink"],"skiptoken"):null};this.allPages.push(d);for(i=0;i<a.value.length;i++)d=a.value[i],
d.file&&("fgdb"!=h&&"shapeFile"!=h||"application/zip"===d.file.mimeType)&&b.files.push({id:d.id,name:d.name,mimeType:h,downloadUrl:"https://graph.microsoft.com/v1.0/me/drive/items/"+d.id+'/content?httpHeaders\x3d{"Authorization":"Bearer\x26#32;'+this.oneDriveToken+'"}'});c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}));return c},_getNextTokenFromUrl:function(a,b){b=b.replace(/[[]/,"[").replace(/[]]/,"]");a=(new RegExp("[?\x26#$]"+b+"\x3d([^\x26#]*)")).exec(a);return null==a?"":a[1]}})})},"arcgisonline/pages/item/widgets/_metadata":function(){define("dojo/_base/lang dojo/_base/array dojo/on dojo/string dojo/Deferred esri/declare esri/lang esri/request ../../../esriGeowConfig ../../../sharing/util ../../pageUtil ../../statusUtil dojo/i18n!../../../nls/arcgisonline".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q){return{_isLoading:!1,_formats:{formatDefault:"default",formatArcGIS:"arcgis",formatFGDC:"fgdc",formatINSPIRE:"inspire",formatISO19139:"iso19139",formatISO1913932:"iso19139-3.2",formatISO19115:"iso19115"},_configureGeocoders:function(a,b){a=a?c.clone(a):[];for(var e,f=0;f<a.length;f++)if(e=a[f],k.isEsriWorldGeocoder(e)){e.suggest=!0;e.name=q.common.esriWorldGeocoder;e.singleLineFieldName="SingleLine";d.isDefined(e.placefinding)||(e.placefinding=!0);d.isDefined(e.batch)||
(e.batch=!0);break}a=l.filter(a,function(a){return a&&a.placefinding&&a.singleLineFieldName});0<a.length&&(b.arcgisGeocoder=!1,b.geocoders=a)},_retrieveArcGISXml:function(a){var c=new e,d=k.getUser();b({url:a,content:{f:"xml",token:d.token},handleAs:"text",preventCache:!0},{usePost:!0}).then(function(a){c.resolve(this._cleanXml(a))}.bind(this),function(a){c.resolve(null)}.bind(this));return c},_cleanXml:function(b){return"string"!==typeof b?null:null!==b?a.trim(b):b},openLayerEditor:function(a,b){var d=
new e,f=k.getToken(),h=g.self,l=h.metadataFormats&&0<h.metadataFormats.length?c.clone(h.metadataFormats):null,n=h.helperServices&&h.helperServices.geocode?c.clone(h.helperServices.geocode):[],r=m.find(a.layers||[],function(a){return a.id==b}.bind(this));r&&r.layerMetadataUrl?r.rawMetadataUrl=r.layerMetadataUrl.split("?")[0]:r&&r.url&&(r.rawMetadataUrl=r.url.split("?")[0]+"/metadata");this._isLoading?d.reject():(this._isLoading=!0,window.require(["arcgisonline/metadata"],c.hitch(this,function(){window.require(["esri/dijit/metadata/context/GxeContext",
"esri/dijit/metadata/context/GxeAdaptor","esri/dijit/metadata/editor/EditorDialog","esri/dijit/metadata/editor/Editor","dojo/domReady!"],c.hitch(this,function(a,b,c){var h=q.itemProperties.metadataISO1913932,m={allowSaveAndClose:!1,allowViewHtml:!0,allowedTypeKeys:["arcgis"],arcgisMode:!0},t={getAllowDeleteMetadata:function(){return!0},getAllowEditMetadata:function(){return!0},deleteMetadata:function(){var a=new e;k.request({url:r.rawMetadataUrl+"/update",content:{metadata:"",metadataUploadFormat:"xml"}},
{usePost:!0}).then(function(b){b&&b.statusUrl?p.checkAsyncJobStatus(b.statusUrl,300).then(function(){a.resolve()}.bind(this),function(){a.resolve()}):a.resolve()},function(b){a.resolve()});return a},saveXml:function(a,b){var c=new e;k.request({url:r.rawMetadataUrl+"/update",content:{metadata:b,metadataUploadFormat:"xml"}},{usePost:!0}).then(function(a){a&&a.statusUrl?p.checkAsyncJobStatus(a.statusUrl,300).then(function(){c.resolve()}.bind(this),function(){c.resolve()}):c.resolve()},function(a){c.resolve()});
return c},viewHtml:function(){var a=new e,b="?format\x3ddefault\x26f\x3dhtml"+(f?"\x26token\x3d"+f:"");r&&r.rawMetadataUrl?k.openPage(r.rawMetadataUrl+b,!1):k.openPage(r.url.split("?")[0]+"/metadata"+b,!1);a.resolve();return a}},u=function(){this._editor=new c({title:r.name,gxeAdaptor:this._gxeAdaptor,gxeContext:this._gxeContext});this._editor.show();this._isLoading=!1;d.resolve(this._editor)}.bind(this);l&&0<l.length&&(metadataFormat=l[0],metadataFormat===this._formats.formatFGDC?h=q.itemProperties.metadataFGDC:
metadataFormat===this._formats.formatINSPIRE?h=q.itemProperties.metadataINSPIRE:metadataFormat===this._formats.formatISO19139?h=q.itemProperties.metadataISO19139:metadataFormat===this._formats.formatISO19115&&(h=q.itemProperties.metadataISO19115));m.defaultArcGISStyle=h;g.extentService?m.basemapUrl=g.extentService:m.basemap="hybrid";this._configureGeocoders(n,m);this._gxeContext=new a(m);r&&r.hasMetadata?this._retrieveArcGISXml(r.rawMetadataUrl).then(function(a){t.getOriginalXml=function(){return a};
this._gxeAdaptor=new b(t);u()}.bind(this),function(a){t.getOriginalXml=function(){return null};this._gxeAdaptor=new b(t);u()}.bind(this)):(t.getOriginalXml=function(){return null},this._gxeAdaptor=new b(t),u())}),c.hitch(this,function(a){d.reject()}))}),c.hitch(this,function(a){d.reject()})));return d},openEditor:function(a){var b=new e,d=g.self,f=d.metadataFormats&&0<d.metadataFormats.length?c.clone(d.metadataFormats):null,h=d.helperServices&&d.helperServices.geocode?c.clone(d.helperServices.geocode):
[];this._isLoading?b.reject():(this._isLoading=!0,window.require(["arcgisonline/metadata"],c.hitch(this,function(){window.require("esri/dijit/metadata/context/GxeContext esri/dijit/metadata/arcgis/portal/PortalItemContext esri/dijit/metadata/arcgis/portal/PortalItemAdaptor esri/dijit/metadata/editor/EditorDialog esri/dijit/metadata/editor/Editor dojo/domReady!".split(" "),c.hitch(this,function(l,n,p,r){var t=q.itemProperties.metadataISO1913932,u,v={allowSaveAndClose:!1,allowViewHtml:!0,allowedTypeKeys:["arcgis"]};
f&&0<f.length&&(u=f[0],u===this._formats.formatFGDC?t=q.itemProperties.metadataFGDC:u===this._formats.formatINSPIRE?t=q.itemProperties.metadataINSPIRE:u===this._formats.formatISO19139?t=q.itemProperties.metadataISO19139:u===this._formats.formatISO19115&&(t=q.itemProperties.metadataISO19115));v.defaultArcGISStyle=t;g.extentService?v.basemapUrl=g.extentService:v.basemap="hybrid";this._configureGeocoders(h,v);this._gxeContext=new l(v);this._portalItemContext=new n({isForPortalItemPage:!0,allowEditMetadata:!0,
allowPushToItem:!0,autoPullItem:!0,portalItem:a,portal:d,restBaseUrl:g.restBaseUrl,token:k.getToken(),originalXml:null});this._portalItemAdaptor=new p({portalItemContext:this._portalItemContext,viewHtml:function(){var b=new e,c=a.itemUrl+"/info/metadata/metadata.xml",d=k.getUser();k.openPage(c+"?format\x3ddefault\x26output\x3dhtml"+(d&&d.token?"\x26token\x3d"+d.token:""),!1);b.resolve();return b}});m.includes(a.typeKeywords,"Metadata")?this._portalItemAdaptor.readXml("text").then(c.hitch(this,function(c){this._portalItemContext.originalXml=
this._cleanXml(c);this._editor=new r({title:a.title,gxeAdaptor:this._portalItemAdaptor,gxeContext:this._gxeContext});this._editor.show();this._isLoading=!1;b.resolve(this._editor)})):(this._editor=new r({title:a.title,gxeAdaptor:this._portalItemAdaptor,gxeContext:this._gxeContext}),this._editor.show(),this._isLoading=!1,b.resolve(this._editor))}),c.hitch(this,function(a){b.reject()}))}),c.hitch(this,function(a){b.reject()})));return b}}})},"arcgisonline/pages/item/widgets/typeOptions/mapOptions/httpsUpdate":function(){define("require esri/declare esri/lang dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/topic dojo/on dojo/string dijit/a11yclick dijit/_WidgetBase dijit/_TemplatedMixin ../../../../pageUtil ../../../../../map/core/urlUtils dojo/i18n!../../../../../nls/arcgisonline dojo/text!./httpsResultIssue.html dojo/text!./httpsResultUpdated.html dojo/text!./httpsResultUnchanged.html dojo/text!./httpsUpdate.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w,t,y){return l("",[p,q],{basePath:c.toUrl("arcgisonline/pages/item/widgets/typeOptions/mapOptions"),templateString:y,WEB_SCENE:"Web Scene",postMixInProperties:function(){this.inherited(arguments);this.i18n=v},startup:function(){this.inherited(arguments);this._initUI()},_initUI:function(){this.isWebScene=this.item.type===this.WEB_SCENE;e.set(this._updateHttpsDesc,"innerHTML",this.i18n.itemProperties[this.isWebScene?"updateSceneLayersToHTTPSDesc":"updateLayersToHTTPSDesc"]);
this.own(m(this._okBtn,this._okClick.bind(this)),m(this._doneBtn,this._doneClick.bind(this)),m(this._cancelBtn,this._cancelClick.bind(this)),m(this._toggleIssues,this._issuesToggled.bind(this)),m(this._toggleUpdated,this._updatedToggled.bind(this)),m(this._toggleUnchanged,this._unchangedToggled.bind(this)))},_filterForIssues:function(a){return a.filter(function(a){return"failure"===a.layerUrlChange||a.layerRenderingFailures||a.layerQueryUrlFailures||a.itemAccess&&("failure"===a.itemUrlChange||a.itemRenderingFailures||
a.itemQueryUrlFailures)})},_filterForUpdated:function(a){return a.filter(function(a){return("success"===a.layerUrlChange||a.layerRenderingChanged||a.layerQueryUrlChanged)&&!a.layerRenderingFailures&&!a.layerQueryUrlFailures||a.itemAccess&&("success"===a.itemUrlChange||a.itemRenderingChanged||a.itemQueryUrlChanged)&&!a.itemRenderingFailures&&!a.itemQueryUrlFailures})},_filterForUnchanged:function(a){return a.filter(function(a){return"none"===a.layerUrlChange&&!a.layerRenderingChanged&&!a.layerRenderingFailures&&
!a.layerQueryUrlChanged&&!a.layerQueryUrlFailures&&(!a.itemAccess||a.itemAccess&&"none"===a.itemUrlChange&&!a.itemRenderingChanged&&!a.itemRenderingFailures&&!a.itemQueryUrlChanged&&!a.itemQueryUrlFailures)})},_writeOutIssues:function(a){a.length?(e.set(this._issuesTitle,"innerHTML",k.substitute(this.i18n.itemProperties.layersWithIssues,{n:a.length})),d.empty(this._issues),a.forEach(function(a){a.message="";if("failure"===a.layerUrlChange||a.layerQueryUrlFailures||a.itemQueryUrlFailures)a.message=
this.i18n.itemProperties.layerMessages.httpsNotSupported;else if(a.layerRenderingFailures||a.itemAccess&&a.itemRenderingFailures)a.message=this.i18n.itemProperties.layerMessages[this.isWebScene?"sceneSymbolHttpsNotSupported":"symbolHttpsNotSupported"];d.place(k.substitute(u,a),this._issues,"last")}.bind(this)),n.showNode(this._layersWithIssues)):n.hideNode(this._layersWithIssues)},_writeOutUpdated:function(a){a.length?(e.set(this._updatedTitle,"innerHTML",k.substitute(this.i18n.itemProperties.layersUpdated,
{n:a.length})),d.empty(this._updated),a.forEach(function(a){a.message="";"success"===a.layerUrlChange||a.layerRenderingChanged||a.layerQueryUrlChanged?(a.message=this.i18n.itemProperties.layerMessages[this.isWebScene?"updatedInScene":"updatedInMap"],a.itemAccess&&("success"===a.itemUrlChange||a.itemRenderingChanged||a.itemQueryUrlChanged)&&(a.message=this.i18n.itemProperties.layerMessages[this.isWebScene?"updatedInSceneAndItem":"updatedInMapAndItem"])):a.itemAccess&&("success"===a.itemUrlChange||
a.itemRenderingChanged||a.itemQueryUrlChanged)?a.message=this.i18n.itemProperties.layerMessages[this.isWebScene?"updatedInSceneAndItem":"updatedInMapAndItem"]:a.layerRenderingChanged&&(a.message=this.i18n.itemProperties.layerMessages[this.isWebScene?"updatedInScene":"updatedInMap"]);d.place(k.substitute(w,a),this._updated,"last")}.bind(this)),n.showNode(this._layersUpdated)):n.hideNode(this._layersUpdated)},_writeOutUnchanged:function(a){a.length?(e.set(this._unchangedTitle,"innerHTML",k.substitute(this.i18n.itemProperties.layersUnchanged,
{n:a.length})),d.empty(this._unchanged),a.forEach(function(a){a.message="";d.place(k.substitute(t,a),this._unchanged,"last")}.bind(this)),n.showNode(this._layersUnchanged)):n.hideNode(this._layersUnchanged)},_okClick:function(){n.hideNode(this._updateHttpsDesc);n.showNode(this._updateHttpsLoading);n.disableNode(this._okBtn);r.switchToHTTPS(this.item.itemData,this.item).then(function(a){var c=this._filterForIssues(a.layers),d=this._filterForUpdated(a.layers),e=this._filterForUnchanged(a.layers);n.hideNode(this._updateHttpsLoading);
h.isDefined(a.configChange)&&"failure"===a.configChange?n.showNode(this._unexpectedError):(this._writeOutIssues(c),this._writeOutUpdated(d),this._writeOutUnchanged(e),c.length?this._issuesToggled():d.length?this._updatedToggled():e.length&&this._unchangedToggled(),c.length||d.length||!e.length?n.showNode(this._updateHttpsResults):n.showNode(this._noChangesMade));n.hideNode(this._okBtn);n.hideNode(this._cancelBtn);n.showNode(this._doneBtn);b.publish("item-data/change")}.bind(this),function(a){n.hideNode(this._updateHttpsLoading);
n.showNode(this._unexpectedError);n.hideNode(this._okBtn);n.hideNode(this._cancelBtn);n.showNode(this._doneBtn)}.bind(this))},_cancelClick:function(){b.publish("update-to-https/cancel")},_doneClick:function(){b.publish("update-to-https/done")},_toggleSection:function(a,b){n[f.contains(a,"icon-ui-right")?"showNode":"hideNode"](b);f.toggle(a,"icon-ui-right");f.toggle(a,"icon-ui-down")},_issuesToggled:function(){this._toggleSection(this._toggleIssues,this._issues)},_updatedToggled:function(){this._toggleSection(this._toggleUpdated,
this._updated)},_unchangedToggled:function(){this._toggleSection(this._toggleUnchanged,this._unchanged)}})})},"arcgisonline/map/core/urlUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/connect dojo/dom dojo/dom-construct dojo/json dojo/Deferred dojo/DeferredList esri/request esri/lang esri/layers/VectorTileLayer esri/layers/CSVLayer esri/layers/KMLLayer esri/layers/GeoRSSLayer esri/layers/WebTiledLayer esri/layers/WMSLayer esri/layers/WFSLayer esri/layers/WMTSLayer".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u,w){function t(a,b){var c=new d;a._ssl&&delete a._ssl;var e=esriGeowConfig.restBaseUrl+"content/users/"+b.owner,e=e+(b.ownerFolder?"/"+b.ownerFolder:""),e=e+("/items/"+b.id+"/update");a={text:f.stringify(a),f:"json"};b={usePost:!0};"http:"===window.location.protocol&&-1<e.indexOf("https://")&&(b.useProxy=!0);g({url:e,content:a,load:function(a){c.resolve()},error:function(a){c.reject(a)}},b);return c}function y(a){var b=a.configLayer,c=a.from,e=a.to,f=a.type,
g=a.checkRenderer,h=new d;switch(b.layerType||b.type){case "ArcGISFeatureLayer":case void 0:if(b.url)return C(a);if(g)return x(a);h.resolve({type:"notTested",msg:"No URL"});break;case "ArcGISImageServiceLayer":case "ArcGISImageServiceVectorLayer":case "ArcGISMapServiceLayer":case "ArcGISStreamLayer":case "ArcGISTiledImageServiceLayer":case "ArcGISTiledMapServiceLayer":case "ArcGISTiledElevationServiceLayer":case "ArcGISSceneServiceLayer":case "PointCloudLayer":case "IntegratedMeshLayer":return C(a);
case "VectorTileLayer":return B(a);case "CSV":return z(a);case "GeoRSS":return F(a);case "KML":return A(a);case "WebTiledLayer":return b.wmtsInfo?E(a):N(a);case "WFS":return O(a);case "WMS":return K(a);case "BingMapsAerial":case "BingMapsRoad":case "BingMapsHybrid":g={url:"",origUrl:"",msg:"Layer has no URL.",code:"layer_003",layerId:b.id,type:"layer"},b.portalUrl&&(c=b.portalUrl.replace(c,e),c!==b.portalUrl?(b.portalUrl=c,l.mixin(g,{msg:"Portal URL switched to "+e+".",code:"layer_001"})):l.mixin(g,
{msg:"Portal URL is already "+e+".",code:"layer_002"})),h.resolve(g);case "OpenStreetMap":g={url:"",origUrl:"",msg:"Layer has no URL.",code:"layer_003",layerId:b.id,type:"layer"},h.resolve(g);default:if("table"===f)return C(a);h.resolve({type:"notTested",msg:"Unknown type"})}return h}function C(a){var b=a.configLayer,c=a.from,e=a.to,f=a.checkRenderer,h=new d,k=b.url,m=b.url.replace(c,e),n={url:k,origUrl:k,layerId:b.id,type:"layer"};if(k===m)return l.mixin(n,{url:m,msg:"Layer URL is already "+e+".",
code:"layer_002"}),f?H(b,a,n).then(function(c){L(b,c).then(function(b){S(a,b).then(function(a){h.resolve(a)})})}):H(b,a,n).then(function(b){S(a,b).then(function(a){h.resolve(a)})}),h;if("http://"===c&&"https://"===e&&-1===k.indexOf("sampleserver")&&(-1<k.indexOf(".arcgis.com")||-1<k.indexOf(".arcgisonline.com")))return b.url=m,l.mixin(n,{url:m,msg:"Layer URL switched to "+e+".",code:"layer_001"}),f?H(b,a,n).then(function(c){L(b,c).then(function(b){S(a,b).then(function(a){h.resolve(a)})})}):H(b,a,
n).then(function(b){S(a,b).then(function(a){h.resolve(a)})}),h;var p=1,q=setInterval(function(){esri.id.isBusy()&&3>p?p++:(esri.id.isBusy()&&esri.id.dialog.destroy(),l.mixin(n,{msg:"Timeout",code:"layer_021"}),H(b,a,n).then(function(b){S(a,b).then(function(a){h.reject(a)})}),clearInterval(q),delete q)},2E4),c=m+(-1<m.indexOf("?")?"\x26f\x3djson":"?f\x3djson");g({url:c,callbackParamName:"callback",load:function(c,d){q&&(clearTimeout(q),b.url=m,l.mixin(n,{url:m,msg:"Layer URL switched to "+e+".",code:"layer_001"}),
f?H(b,a,n).then(function(c){L(b,c).then(function(b){S(a,b).then(function(a){h.resolve(a)})})}):H(b,a,n).then(function(b){S(a,b).then(function(a){h.resolve(a)})}))},error:function(c){q&&(clearTimeout(q),esri.id.isBusy()?c&&c.message&&-1<c.message.toLowerCase().indexOf("aborted")?(l.mixin(n,{msg:"Aborted the Sign-In process.",code:"layer_012"}),H(b,a,n).then(function(b){S(a,b).then(function(a){h.reject(a)})})):(l.mixin(n,{msg:c.message,code:"layer_010"}),H(b,a,n).then(function(b){S(a,b).then(function(a){h.reject(a)})})):
(l.mixin(n,{msg:c.message,code:"layer_010"}),H(b,a,n).then(function(b){S(a,b).then(function(a){h.reject(a)})})))}});return h}function x(a){var e=a.configLayer,f=new d,g={url:"",origUrl:"",layerId:e.id,msg:"Layer has no URL.",code:"layer_003",type:"layer",renderers:[],symbols:[]};if(e.featureCollection)if(e.featureCollection.layers){var h=[];c.forEach(e.featureCollection.layers,function(a,b){if(a.layerDefinition&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer){var f=new d;M(e,
a.layerDefinition.drawingInfo.renderer).then(l.hitch(this,function(a,b){e.featureCollection.layers[a].layerDefinition.drawingInfo.renderer=b.renderer;f.resolve(b)},b));h.push(f)}a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].symbol&&c.forEach(a.featureSet.features,function(a){var c=new d;Q(e,a.symbol).then(l.hitch(this,function(a,b){g.symbols=[b];c.resolve(g)},b));h.push(c)})});h.length?(new b(h)).addCallback(function(b){var d=[],e=[];c.forEach(b,function(a){"renderer"===
a[1].type?d.push(a[1]):"symbol"===a[1].type&&e.push(a[1])});l.mixin(g,{renderers:d.length?d:[],symbols:e.length?e:[]});S(a,g).then(function(a){f.resolve(a)})}):S(a,g).then(function(a){f.resolve(a)})}else S(a,g).then(function(a){f.resolve(a)});else S(a,g).then(function(a){f.resolve(a)});return f}function B(a){var b=a.configLayer,c=a.from,e=a.to,f=new d,g=b.styleUrl;if(!b.styleUrl&&b.itemId){var k=esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"/resources";if(!esriGeowConfig.self.isPortal)var n=
k.indexOf("://"),p=k.indexOf("/",n+3),k=k.substring(0,n+3)+esriGeowConfig.self.portalHostname+k.substring(p);b.styleUrl=k+"/styles/root.json"}var q=b.styleUrl.replace(c,e),c=new m(q);h.connect(c,"onLoad",l.hitch(this,function(){var c={url:q,origUrl:g,layerId:b.id,type:"layer"};b.styleUrl===q?l.mixin(c,{msg:"Layer URL is already "+e+".",code:"layer_002"}):(b.styleUrl=q,l.mixin(c,{msg:"Layer URL switched to "+e+".",code:"layer_001"}));S(a,c).then(function(a){f.resolve(a)})}));h.connect(c,"onError",
l.hitch(this,function(c){S(a,{url:b.styleUrl,origUrl:b.styleUrl,layerId:b.id,msg:c.message,code:"layer_010",type:"layer"}).then(function(a){f.reject(a)})}));return f}function z(a){var b=a.configLayer,c=a.from,e=a.to,f=a.checkRenderer,g=new d,k=b.url.replace(c,e),m=b.url;if(m===k)return a={url:k,origUrl:m,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",type:"layer"},f?L(b,a).then(function(a){g.resolve(a)}):g.resolve(a),g;a=new p(k,{columnDelimiter:b.columnDelimiter,latitudeFieldName:b.locationInfo.latitudeFieldName,
longitudeFieldName:b.locationInfo.longitudeFieldName});h.connect(a,"onLoad",l.hitch(this,function(){b.url=k;var a={url:k,origUrl:m,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"};f?L(b,a).then(function(a){g.resolve(a)}):g.resolve(a)}));h.connect(a,"onError",l.hitch(this,function(a){g.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:a.message,code:"layer_010",type:"layer"})}));return g}function F(a){var b=a.configLayer,c=a.from,e=a.to,f=a.checkRenderer,g=new d,k=b.url.replace(c,
e),m=b.url;if(m===k){var p={url:k,origUrl:m,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",type:"layer"};f&&b.pointSymbol?Q(b,b.pointSymbol).then(function(a){p.symbols=[a];g.resolve(p)}):g.resolve(p);return g}a=new n(k);h.connect(a,"onLoad",l.hitch(this,function(){b.url=k;var a={url:k,origUrl:m,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"};f&&b.pointSymbol?Q(b,b.pointSymbol).then(function(b){a.symbols=[b];g.resolve(a)}):g.resolve(a)}));h.connect(a,
"onError",l.hitch(this,function(a){g.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:a.message,code:"layer_010",type:"layer"})}));return g}function A(a){var b=a.configLayer,c=a.from,e=a.to,f=new d,g=b.url.replace(c,e),k=b.url;if(k===g)return f.resolve({url:g,origUrl:k,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",type:"layer"}),f;var c=g,e=arcgisonline.sharing.util.getUser(),m=esriGeowConfig.self.urlKey?esriGeowConfig.self.customBaseUrl:esriGeowConfig.self.portalHostname,n=c.indexOf(m);
e&&b.itemId&&-1<n&&(c="https://"+esriGeowConfig.self.portalHostname+c.substring(n+m.length));e&&(-1<c.indexOf(esriGeowConfig.self.portalHostname)||-1<c.indexOf(m))&&(e=arcgisonline.sharing.util.getToken())&&(c+="?token\x3d"+e);c=new q(c);h.connect(c,"onLoad",l.hitch(this,function(){b.url=g;var c={url:g,origUrl:k,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"};b.itemId?(a.checkRenderer=!1,S(a,c).then(function(a){f.resolve(a)})):f.resolve(c)}));h.connect(c,"onError",l.hitch(this,
function(a){f.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:a.message,code:"layer_010",type:"layer"})}));return f}function E(a){var b=a.configLayer,e=a.from;a=a.to;var f=new d,g={};b.wmtsInfo.customParameters&&(g.customParameters=b.wmtsInfo.customParameters);b.wmtsInfo.customLayerParameters&&(g.customLayerParameters=b.wmtsInfo.customLayerParameters);var k=b.wmtsInfo.url.replace(e,a),m=b.wmtsInfo.url;if(m===k)return f.resolve({url:k,origUrl:m,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",
type:"layer"}),f;var n=function(){var a=!1;c.forEach(layerObj.layers,function(d){d.identifier===b.wmtsInfo.layerIdentifier&&c.forEach(d.tileMatrixSetInfos,function(e){if(e.tileMatrixSet===b.wmtsInfo.tileMatrixSet){a=!0;layerObj.copyright&&"none"!==layerObj.copyright.toLowerCase()&&(b.copyright=layerObj.copyright,180<layerObj.copyright.length&&(b.copyright=layerObj.copyright.substring(0,180)+"..."));var g=-1<c.indexOf(d.formats,"image/png")?"image/png":d.formats[0];b.templateUrl=layerObj.getTileUrlTemplate({identifier:d.identifier,
tileMatrixSet:e.tileMatrixSet,format:g});-1<b.templateUrl.indexOf("http://")&&ea(k,b.templateUrl)&&(b.templateUrl=b.templateUrl.replace("http://","https://"));-1<b.templateUrl.indexOf("http://")?f.reject({url:b.wmtsInfo.url,origUrl:b.wmtsInfo.url,layerId:b.id,msg:"WTMS does not return https URLs.",code:"layer_013",type:"layer"}):(b.wmtsInfo.url=k,f.resolve({url:k,origUrl:m,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"}))}})});a||f.reject({url:b.wmtsInfo.url,origUrl:b.wmtsInfo.url,
layerId:b.id,msg:"WMTS is missing layer or tileMatrixSet.",code:"wmts_011",type:"layer"})};layerObj=new w(k,g);var p=h.connect(layerObj,"onError",function(a){h.disconnect(p);h.disconnect(q);g.serviceMode="KVP";layerObj=new w(k,g);h.connect(layerObj,"onError",function(a){f.reject({url:b.wmtsInfo.url,origUrl:b.wmtsInfo.url,layerId:b.id,msg:a.message,code:"layer_010",type:"layer"})});h.connect(layerObj,"onLoad",l.hitch(this,function(){n()}))}),q=h.connect(layerObj,"onLoad",l.hitch(this,function(){h.disconnect(p);
h.disconnect(q);n()}));return f}function N(a){var b=a.configLayer,c=a.from;a=a.to;var e=new d,f=b.templateUrl.replace(c,a),h=b.templateUrl;if(h===f)return e.resolve({url:f,origUrl:h,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",type:"layer"}),e;var k=setTimeout(l.hitch(this,function(){clearTimeout(k);k=null;e.reject({url:b.templateUrl,origUrl:b.templateUrl,layerId:b.id,msg:"WebTiledLayer timeout error.",code:"WTL_012",type:"layer"})}),1E4),c=f;b.subDomains&&b.subDomains.length&&
(c=c.replace("{subDomain}",b.subDomains[0]));c=c.replace("{level}",0).replace("{row}",0).replace("{col}",0);g({url:c,load:function(a,c){k&&(clearTimeout(k),b.templateUrl=f,e.resolve({url:f,origUrl:h,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"}))},error:function(a){k&&(clearTimeout(k),e.reject({url:b.templateUrl,origUrl:b.templateUrl,layerId:b.id,msg:"WebTiledLayer access error.",code:"WTL_011",type:"layer"}))}});return e}function O(a){var b=a.config.spatialReference,
e=a.configLayer,f=a.from,g=a.to,k=a.checkRenderer,m=new d,n=e.url.replace(f,g),p=e.url;if(p===n)return a={url:n,origUrl:p,layerId:e.id,msg:"Layer URL is already https.",code:"layer_002",type:"layer"},k?L(e,a).then(function(a){m.resolve(a)}):m.resolve(a),m;var q=new u;h.connect(q,"onError",l.hitch(this,function(a){m.reject({url:e.url,origUrl:e.url,layerId:e.id,msg:a.message,code:"layer_010",type:"layer"})}));var t={url:n,version:e.wfsInfo.version,customParameters:e.wfsInfo.customParameters};q.initialize(t,
function(a){for(var d,f=0;f<a.length;f++)if(a[f].name===e.wfsInfo.name){d=a[f];break}d?(t={layerName:e.wfsInfo.name,visible:e.defaultVisibility,maxFeatures:e.wfsInfo.maxFeatures?e.wfsInfo.maxFeatures:3E3,swapXY:e.wfsInfo.swapXY,geometryType:e.layerDefinition?e.layerDefinition.geometryType:null,wkid:e.layerDefinition?e.layerDefinition.spatialReference.wkid:e.wfsInfo.supportedSpatialReferences?e.wfsInfo.supportedSpatialReferences[0]:4326,mode:"snapshot"},q.selectLayer(t,function(a){e.wfsInfo.wfsNamespace=
q.layerNamespace;e.wfsInfo.featureUrl=q.getFeatureUrl;-1<e.wfsInfo.wfsNamespace.indexOf("http://")||-1<e.wfsInfo.featureUrl.indexOf("http://")?m.reject({url:e.url,origUrl:e.url,layerId:e.id,msg:"WFS does not return https URLs.",code:"WFS_012",type:"layer"}):(e.wfsInfo.supportedSpatialReferences=d.spatialReferences,-1===c.indexOf([3857,102100],b.wkid)&&4326!==b.wkid&&-1===c.indexOf(q.spatialReferences,b.wkid)?m.reject({url:e.url,origUrl:e.url,layerId:e.id,msg:"WFS does not contain map spatial reference.",
code:"WFS_013",type:"layer"}):(e.url=n,a={url:n,origUrl:p,layerId:e.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"},k?L(e,a).then(function(a){m.resolve(a)}):m.resolve(a)))})):m.reject({url:e.url,origUrl:e.url,layerId:e.id,msg:"WFS does not contain layer.",code:"WFS_011",type:"layer"})});return m}function K(a){var b=a.configLayer,e=a.from;a=a.to;var f=new d,g=b.url.replace(e,a),k=b.url;if(k===g)return f.resolve({url:g,origUrl:k,layerId:b.id,msg:"Layer URL is already https.",code:"layer_002",
type:"layer"}),f;var m=new v(g,{visibleLayers:b.visibleLayers,customLayerParameters:b.customLayerParameters,customParameters:b.customParameters});h.connect(m,"onLoad",l.hitch(this,function(){-1<m.getMapURL.indexOf("http://")&&ea(g,m.getMapURL)&&(m.getMapURL=m.getMapURL.replace("http://","https://"));-1<m.getFeatureInfoURL.indexOf("http://")&&ea(g,m.getFeatureInfoURL)&&(m.getFeatureInfoURL=m.getFeatureInfoURL.replace("http://","https://"));-1<m.copyright.indexOf("http://")&&ea(g,m.copyright)&&(m.copyright=
m.copyright.replace("http://","https://"));if(-1<m.getMapURL.indexOf("http://")||-1<m.getFeatureInfoURL.indexOf("http://"))f.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:"WMS does not return https URLs.",code:"WMS_011",type:"layer"});else if(-1<m.getMapURL.indexOf("https://localhost/")||-1<m.getFeatureInfoURL.indexOf("https://localhost/"))f.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:"WMS does not return valid https URLs.",code:"WMS_012",type:"layer"});else{for(var a=[],d=0;d<b.layers.length;d++){var e=
l.clone(b.layers[d]),h=function(a,b){c.forEach(a,function(a){a.subLayers&&0<a.subLayers.length?h(a.subLayers,b):b.push(a)},this)};if(m.layerInfos){var n=[];h(m.layerInfos,n);m.layerInfos=n}for(var n=!1,p=0;p<m.layerInfos.length;p++){var q=m.layerInfos[p];if(e.name===q.name)if(n=!0,e.legendURL&&q.legendURL){if(e.legendURL=q.legendURL,-1<e.legendURL.indexOf("http://")&&ea(g,e.legendURL)&&(e.legendURL=e.legendURL.replace("http://","https://")),-1<e.legendURL.indexOf("http://")){f.reject({url:b.url,origUrl:b.url,
layerId:b.id,msg:"WMS does not return https URLs.",code:"WMS_011",type:"layer"});return}}else e.legendURL=q.legendURL}if(!n){f.reject({url:b.url,origUrl:b.url,layerId:b.id,msg:"WMS layer is missing.",code:"WMS_013",type:"layer"});return}a.push(e)}b.url=g;b.mapUrl=m.getMapURL;b.featureInfoUrl=m.getFeatureInfoURL;b.copyright=m.copyright;b.layers=a;f.resolve({url:g,origUrl:k,layerId:b.id,msg:"Layer URL switched to https.",code:"layer_001",type:"layer"})}}));h.connect(m,"onError",l.hitch(this,function(a){f.reject({url:b.url,
origUrl:b.url,layerId:b.id,msg:a.message,code:"layer_010",type:"layer"})}));return f}function H(a,e,f){var g=new d,h=[];a.layers&&c.forEach(a.layers,function(b,c){if(b.layerUrl){var f=new d;C({configLayer:{url:b.layerUrl,id:a.id+"_"+c},from:e.from,to:e.to,checkRenderer:!1}).then(l.hitch(this,function(a,b){a.layerUrl=b.url;f.resolve(b)},b),function(a){f.resolve(a)});h.push(f)}});if(h.length){var k=[];(new b(h)).addCallback(function(a){c.forEach(a,function(a){k.push(a[1])});f.queryLayers=k;g.resolve(f)})}else g.resolve(f);
return g}function J(a,e,f,g){var h=new d,k=[];f.layers&&c.forEach(f.layers,function(b,c){if(b.layerUrl){var f=new d;C({configLayer:{url:b.layerUrl,id:a.id+"_item_"+c},from:e.from,to:e.to,checkRenderer:!1}).then(l.hitch(this,function(a){b.layerUrl=a.url;f.resolve(a)}),function(a){f.resolve(a)});k.push(f)}});if(k.length){var m=[];(new b(k)).addCallback(function(a){c.forEach(a,function(a){m.push(a[1])});g.item.queryLayers=m;h.resolve(g)})}else h.resolve(g);return h}function L(a,e){var f=new d,g=[];if(a.layerDefinition&&
a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer){var h=new d;M(a,a.layerDefinition.drawingInfo.renderer).then(l.hitch(this,function(a,b){a.layerDefinition.drawingInfo.renderer=b.renderer;h.resolve(b)},a),function(a){h.resolve(a)});g.push(h)}a.layers&&c.forEach(a.layers,function(b){if(b.layerDefinition&&b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer){var c=new d;M(a,b.layerDefinition.drawingInfo.renderer).then(l.hitch(this,function(a,b){a.layerDefinition.drawingInfo.renderer=
b.renderer;c.resolve(b)},b),function(a){c.resolve(a)});g.push(c)}});if(g.length){var k=[];(new b(g)).addCallback(function(a){c.forEach(a,function(a){k.push(a[1])});e.renderers=k;f.resolve(e)})}else f.resolve(e);return f}function R(a,e,f){var g=new d,h=[];e.layers&&c.forEach(e.layers,function(b){if(b.layerDefinition&&b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer){var c=new d;M(a,b.layerDefinition.drawingInfo.renderer).then(l.hitch(this,function(a){b.layerDefinition.drawingInfo.renderer=
a.renderer;c.resolve(a)}),function(a){c.resolve(a)});h.push(c)}});if(h.length){var k=[];(new b(h)).addCallback(function(a){c.forEach(a,function(a){k.push(a[1])});f.item.renderers=k;g.resolve(f)})}else g.resolve(f);return g}function M(a,e){for(var g=new d,h=[],k=f.stringify(e),l=k.indexOf("http://");-1<l;){var m=k.indexOf('"',l+1),m=k.substring(l,m);h.push(U(a,m));l=k.indexOf("http://",l+1)}h.length?(new b(h)).addCallback(function(b){var d=[];c.forEach(b,function(a){var b=a[1];d.push(b);!0===a[0]&&
(k=k.replace(b.origUrl,b.url))});g.resolve({renderer:f.parse(k),origRenderer:e,layerId:a.id,type:"renderer",symbols:d})}):g.resolve({renderer:e,origRenderer:e,layerId:a.id,type:"renderer",symbols:[]});return g}function Q(a,b){var c=new d;b?b.url?U(a,b.url).then(function(a){b.url=a.url;c.resolve(a)},function(a){c.resolve(a)}):c.resolve({url:"",origUrl:"",layerId:a.id,msg:"Symbol has no URL.",code:"sym_003",type:"symbol"}):c.resolve({url:"",origUrl:"",layerId:a.id,msg:"No symbol.",code:"sym_005",type:"symbol"});
return c}function U(b,c){var f=new d,g=c;if(c.startsWith("https://"))return f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL already https",code:"sym_002",type:"symbol"}),f;if(c.startsWith("http://")){if(c=c.replace("http://","https://"),-1<c.indexOf(esriGeowConfig.self.portalHostname))return f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL switched to https",code:"sym_001",type:"symbol"}),f}else return f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL is relative path",code:"sym_004",
type:"symbol"}),f;this.cachedImages=this.cachedImages||[];for(var k,m=0;m<this.cachedImages.length;m++)if(this.cachedImages[m].url===c){k=this.cachedImages[m];if("success"===k.status)f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL switched to https",code:"sym_001",type:"symbol"});else if("error"===k.status)f.reject({url:g,origUrl:g,layerId:b.id,msg:"symbol URL can't be switched to https",code:"sym_010",type:"symbol"});else if("inProgress"===k.status)var n=setInterval(l.hitch(this,function(a){"success"===
a.status?(clearInterval(n),f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL switched to https",code:"sym_001",type:"symbol"})):"error"===a.status&&(clearInterval(n),f.reject({url:g,origUrl:g,layerId:b.id,msg:"symbol URL can't be switched to https",code:"sym_010",type:"symbol"}))},k),1E3);return f}k||(k={url:c,status:"inProgress"},this.cachedImages.push(k));a.byId("imageTesterDiv")||e.create("div",{id:"imageTesterDiv",style:"position:absolute;top:-1000px;left:-1000px"},document.body);var p=
Math.random()+"_testImage";e.create("img",{id:p+"_testImage"},a.byId("imageTesterDiv"));var q=h.connect(a.byId(p+"_testImage"),"onload",l.hitch(this,function(){h.disconnect(q);clearTimeout(t);e.destroy(p+"_testImage");k.status="success";f.resolve({url:c,origUrl:g,layerId:b.id,msg:"symbol URL switched to https",code:"sym_001",type:"symbol"})})),t=setTimeout(l.hitch(this,function(){h.disconnect(q);e.destroy(p+"_testImage");clearTimeout(t);k.status="error";f.reject({url:g,origUrl:g,layerId:b.id,msg:"symbol URL can't be switched to https",
code:"sym_010",type:"symbol"})}),5E3);a.byId(p+"_testImage").src=c;return f}function S(a,b){var e=a.configLayer,f=a.from,g=a.to,h=a.checkedItemsList,k=new d;if(e.itemId&&!b.item)if(h[e.itemId])if("inProgress"===h[e.itemId].status)var m=setInterval(l.hitch(this,function(a,b){"inProgress"!==h[a.itemId].status&&(clearInterval(m),b.itemAccess=h[a.itemId].refObj.itemAccess,b.item=h[a.itemId].refObj.item,k.resolve(b))},e,b),1E3);else b.itemAccess=h[e.itemId].refObj.itemAccess,b.item=h[e.itemId].refObj.item,
k.resolve(b);else h[e.itemId]={status:"inProgress",refObj:b},T(e.itemId).then(function(d){b.itemAccess=!0;var m={};if(d&&d.url){b.item={url:d.url,origUrl:d.url,type:"layer"};if(Y(b.origUrl,d.url)&&!Y(b.origUrl,b.url))l.mixin(b.item,{url:b.url,msg:b.msg,code:b.code}),m.url=d.url.replace(f,g);else if(Y(b.origUrl,d.url)&&Y(b.origUrl,b.url))l.mixin(b.item,{msg:b.msg,code:b.code});else if(Y(b.url,d.url))l.mixin(b.item,{msg:"Layer URL is already "+g+".",code:"layer_002"});else if(!Y(b.origUrl,d.url)&&!Y(b.url,
d.url))if(-1<c.indexOf("CSV GeoRSS KML WebTiledLayer WFS WMS".split(" "),e.layerType||e.type))h[e.itemId].status="done",k.resolve(b);else{var n=l.clone(e);delete n.itemId;e.url?n.url=d.url:e.styleUrl&&(n.styleUrl=d.url);var p=l.clone(a);p.configLayer=n;y(p).then(function(c){m.url=c.url;b.item=c;G(a,d,b,m).then(function(a){h[e.itemId].status="done";k.resolve(a)})},function(c){b.item=c;G(a,d,b,m).then(function(a){h[e.itemId].status="done";k.resolve(a)})});return}G(a,d,b,m).then(function(a){h[e.itemId].status=
"done";k.resolve(a)})}else d?(b.item={url:"",origUrl:"",type:"layer"},G(a,d,b,m).then(function(a){h[e.itemId].status="done";k.resolve(a)})):(b.itemAccess=!1,h[e.itemId].status="done",k.resolve(b))},function(a){b.itemAccess=!1;h[e.itemId].status="done";k.resolve(b)});else k.resolve(b);return k}function G(a,b,e,g){var h=a.configLayer,k=a.checkRenderer,m=new d;I(b.id).then(function(d){if(d&&"Feature Collection"===b.type)if(k&&d.layers){var n=l.clone(h);delete n.itemId;n.featureCollection={layers:d.layers};
x({configLayer:n,from:"http://",to:"https://",checkRenderer:k,type:null}).then(function(a){l.mixin(e.item,a);g.text=f.stringify(d);D(b,g).then(function(a){m.resolve(e)},function(){l.mixin(e.item,{msg:"Item update failure.",code:"layer_020"});m.resolve(e)})},function(a){m.resolve(e)})}else m.resolve(e);else if(d&&d.layers){var p=!1;J(h,a,d,e).then(function(a){a.item.queryLayers&&c.forEach(a.item.queryLayers,function(a){a.url!==a.origUrl&&(p=!0)});k?R(h,d,a).then(function(a){a.item.renderers&&!p?c.forEach(a.item.renderers,
function(a){a.renderer!==a.origRenderer&&(p=!0)}):a.item.symbols&&!p&&c.forEach(a.item.symbols,function(a){a.url!==a.origUrl&&(p=!0)});p&&(g.text=f.stringify(d));D(b,g).then(function(b){m.resolve(a)},function(){l.mixin(a.item,{msg:"Item update failure.",code:"layer_020"});m.resolve(a)})}):(p&&(g.text=f.stringify(d)),D(b,g).then(function(b){m.resolve(a)},function(){l.mixin(a.item,{msg:"Item update failure.",code:"layer_020"});m.resolve(a)}))})}else D(b,g).then(function(a){m.resolve(e)},function(){l.mixin(e.item,
{msg:"Item update failure.",code:"layer_020"});m.resolve(e)})},function(){D(b,g).then(function(a){m.resolve(e)},function(){l.mixin(e.item,{msg:"Item update failure.",code:"layer_020"});m.resolve(e)})});return m}function T(a){var b=new d;g({url:esriGeowConfig.restBaseUrl+"content/items/"+a,content:{f:"json"},callbackParamName:"callback",load:function(a,c){"update"===a.itemControl||"admin"===a.itemControl?b.resolve(a):b.reject(Error("No write access"))},error:function(a){b.reject(a)}});return b}function I(a){var b=
new d;g({url:esriGeowConfig.restBaseUrl+"content/items/"+a+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a,c){a&&delete a._ssl;Z();b.resolve(a)},error:function(a){b.reject()}});return b}function D(a,b){var c=new d;if(arcgisonline.isEmpty(b))c.resolve({});else{Z();var e=esriGeowConfig.restBaseUrl+"content/users/"+a.owner,e=e+(a.ownerFolder?"/"+a.ownerFolder:""),e=e+("/items/"+a.id+"/update");"noSave"===Z()?c.resolve({}):(a={usePost:!0},"http:"===window.location.protocol&&-1<
e.indexOf("https://")&&(a.useProxy=!0),g({url:e,content:dojo.mixin(b,{f:"json"}),callbackParamName:"callback",load:function(a,b){c.resolve(a)},error:function(a){c.reject(a)}},a))}return c}function X(){var a=new d,b=[];esriGeowConfig.self.isPortal?g({url:esriGeowConfig.restBaseUrl+"portals/self/servers",content:{f:"json"},callbackParamName:"callback",load:function(c,d){c.servers&&dojo.forEach(c.servers,function(a){a.url&&b.push(a.url.substring(a.url.indexOf("//")))});a.resolve(b)},error:function(c){a.resolve(b)}}):
a.resolve(b);return a}function ca(a,b){var c,d;for(c=0;c<a.operationalLayers.length;c++){if(a.operationalLayers[c].id===b)return a.operationalLayers[c];if("GroupLayer"===a.operationalLayers[c].layerType){var e=a.operationalLayers[c].layers;for(d=0;d<e.length;d++)if(e[d].id===b)return e[d]}}if(a.baseMap.baseMapLayers)for(c=0;c<a.baseMap.baseMapLayers.length;c++){if(a.baseMap.baseMapLayers[c].id===b)return a.baseMap.baseMapLayers[c];if("GroupLayer"===a.baseMap.baseMapLayers[c].layerType)for(e=a.baseMap.baseMapLayers[c].layers,
d=0;d<e.length;d++)if(e[d].id===b)return e[d]}if(a.baseMap.elevationLayers)for(c=0;c<a.baseMap.elevationLayers.length;c++)if(a.baseMap.elevationLayers[c].id===b)return a.baseMap.elevationLayers[c];if(a.ground&&a.ground.layers)for(c=0;c<a.ground.layers.length;c++)if(a.ground.layers[c].id===b)return a.ground.layers[c];if(a.tables)for(c=0;c<a.tables.length;c++)if(a.tables[c].id===b)return a.tables[c];if(a.presentation&&a.presentation.slides)for(d=0;d<a.presentation.slides.length;d++){var f=a.presentation.slides[d];
if(f.baseMap&&f.baseMap.baseMapLayers)for(c=0;c<f.baseMap.baseMapLayers.length;c++){if(f.baseMap.baseMapLayers[c].id===b)return f.baseMap.baseMapLayers[c];if("GroupLayer"===f.baseMap.baseMapLayer[c].layerType)for(e=f.baseMap.baseMapLayer[c].layers,d=0;d<e.length;d++)if(e[d].id===b)return e[d]}}}function V(a,b){switch(a.layerType||a.type){case "ArcGISFeatureLayer":case "ArcGISImageServiceLayer":case "ArcGISImageServiceVectorLayer":case "ArcGISMapServiceLayer":case "ArcGISStreamLayer":case "ArcGISTiledImageServiceLayer":case "ArcGISTiledMapServiceLayer":case "ArcGISTiledElevationServiceLayer":case "ArcGISSceneServiceLayer":case "PointCloudLayer":case "IntegratedMeshLayer":case void 0:return!a.url||
-1<a.url.indexOf("://services")&&(-1<a.url.indexOf(".arcgis.com")||-1<a.url.indexOf(".arcgisonline.com"))||(-1<a.url.indexOf("://tiles")||-1<a.url.indexOf("://utility"))&&-1<a.url.indexOf(".arcgis.com")?null:ba(a.url);case "VectorTileLayer":return!a.styleUrl||-1<a.styleUrl.indexOf(esriGeowConfig.self.portalHostname)||-1<a.styleUrl.indexOf(esriGeowConfig.self.customBaseUrl)||-1<a.styleUrl.indexOf("/items/")||-1<a.styleUrl.indexOf("://tiles")&&-1<a.url.indexOf(".arcgis.com")?null:ba(a.styleUrl);case "CSV":case "GeoRSS":case "KML":case "WebTiledLayer":case "WFS":case "WMS":case "BingMapsAerial":case "BingMapsRoad":case "BingMapsHybrid":case "OpenStreetMap":return null;
default:return"table"===b?-1<a.url.indexOf(".arcgis.com")||-1<a.url.indexOf(".arcgisonline.com")?null:ba(a.url):null}}function aa(a){var b=[];c.forEach(a.operationalLayers,function(a){"GroupLayer"===a.layerType?c.forEach(a.layers,function(a){b.push({layer:a,type:"operationalLayers.groupLayer"})}):b.push({layer:a,type:"operationalLayers"})});c.forEach(a.baseMap.baseMapLayers,function(d){"GroupLayer"===d.layerType?c.forEach(d.layers,function(a){b.push({layer:a,type:"baseMapLayers.groupLayer"})}):(d.title=
d.title||a.baseMap.title,b.push({layer:d,type:"baseMapLayers"}))});c.forEach(a.baseMap.elevationLayers,function(c){c.title=c.title||a.baseMap.title;b.push({layer:c,type:"elevationLayers"})});a.ground&&c.forEach(a.ground.layers,function(c){c.title=c.title||a.baseMap.title;b.push({layer:c,type:"ground"})});c.forEach(a.tables,function(a){b.push({layer:a,type:"tables"})});a.presentation&&a.presentation.slides&&c.forEach(a.presentation.slides,function(a){a.baseMap&&a.baseMap.baseMapLayers&&c.forEach(a.baseMap.baseMapLayers,
function(d){"GroupLayer"===d.layerType?c.forEach(d.layers,function(a){b.push({layer:a,type:"slides.baseMapLayers.groupLayer"})}):(d.title=d.title||a.baseMap.title,b.push({layer:d,type:"slides.baseMapLayers"}))})});return b}function ba(a){a=ha(a);var b=a.protocol+"://"+a.domain;a.port&&(b+=":"+a.port);return b+="/"+a.instance}function ea(a,b){a=ha(a);b=ha(b);return a.domain===b.domain?!0:!1}function Y(a,b){if(a&&b){var c=a.toLowerCase().indexOf("/featureserver/");-1<c&&(a=a.substring(0,c+14));c=b.toLowerCase().indexOf("/featureserver/");
-1<c&&(b=b.substring(0,c+14));c=a.toLowerCase().indexOf("/mapserver/");-1<c&&(a=a.substring(0,c+10));c=b.toLowerCase().indexOf("/mapserver/");-1<c&&(b=b.substring(0,c+10));c=a.toLowerCase().indexOf("/sceneserver/");-1<c&&(a=a.substring(0,c+12));c=b.toLowerCase().indexOf("/sceneserver/");-1<c&&(b=b.substring(0,c+12));if(a===b)return!0}return!1}function ha(a){var b={};if(!a||!a.length)return b;var c=a.indexOf("://");b.protocol=a.substr(0,c);a=a.substr(c+3,a.length);c=a.indexOf("/");c=-1===c?a.length-
1:c;b.domain=a.substr(0,c);-1<b.domain.indexOf(":")&&(b.port=b.domain.substr(b.domain.indexOf(":")+1),b.domain=b.domain.substr(0,b.domain.indexOf(":")));b.path=-1===c||c+1===a.length?null:a.substr(c+1,a.length);b.instance=b.path.split("/")[0];a=b.domain.split(".");switch(a.length){case 2:b.subdomain=null;b.host=a[0];b.tld=a[1];break;case 3:b.subdomain=a[0];b.host=a[1];b.tld=a[2];break;case 4:b.subdomain=a[0],b.host=a[1],b.tld=a[2]+"."+a[3]}b.host&&b.tld&&(b.parentDomain=b.host+"."+b.tld);return b}
function Z(){var a=arcgisonline.sharing.util.urlToObject(document.URL);a.query=a.query||{};return a.query.debug}return{getUniqueDomains:function(a){var b,e,f=[],g=[],h=new d,k=function(a,d,f,g,h){if(!(a.url&&-1<a.url.indexOf(esriGeowConfig.self.portalHostname)||a.styleUrl&&-1<a.styleUrl.indexOf(esriGeowConfig.self.portalHostname))){var k=!1;c.forEach(g,function(b){if(a.url&&-1<a.url.indexOf(b)||a.styleUrl&&-1<a.styleUrl.indexOf(b))k=!0});!k&&(b=V(a,h))&&(-1<d.indexOf(b)?(e=d.indexOf(b),f[e].layers.push({id:a.id,
title:a.title})):(d.push(b),f.push({domain:b,layers:[{id:a.id,title:a.title}]})))}},l=function(a,b){return a.title.toLowerCase()<b.title.toLowerCase()?-1:1},m=function(a,b){a.layers=a.layers.sort(l);b.layers=b.layers.sort(l);return a.domain.toLowerCase()<b.domain.toLowerCase()?-1:1};X().then(function(b){var d=aa(a);c.forEach(d,function(a){k(a.layer,f,g,b,"tables"===a.type?"table":null)});g=g.sort(m);h.resolve(g)});return h},switchToHTTPS:function(a,e){Z();var g=new d,h=l.clone(a),k={from:"http://",
to:"https://",checkRenderer:!0,type:null,checkedItemsList:{}},m=[],n=[],p=aa(a);c.forEach(p,function(b){var c={config:a,configLayer:b.layer};"tables"===b.type&&(c.type="table");l.mixin(c,k);n.push(b.layer.id);m.push(y(c))});m.length?(new b(m)).addCallback(function(b){var d=[];c.forEach(b,function(b){Z();b=b[1];if("notTested"!==b.type){var e=ca(a,b.layerId),f={id:b.layerId,title:e.title};-1<c.indexOf(["layer_001"],b.code)?f.layerUrlChange="success":-1<c.indexOf(["layer_002","layer_003"],b.code)?f.layerUrlChange=
"none":f.layerUrlChange="failure";b.queryLayers&&(f.layerQueryUrlChanged=!1,f.layerQueryUrlFailures=!1,c.forEach(b.queryLayers,function(a){-1<c.indexOf(["layer_001"],a.code)?f.layerQueryUrlChanged=!0:-1<c.indexOf(["layer_002","layer_003"],a.code)||(f.layerQueryUrlFailures=!0)}));if(b.renderers||b.symbols)f.layerRenderingChanged=!1,f.layerRenderingFailures=!1,c.forEach(b.renderers,function(a){c.forEach(a.symbols,function(a){-1<c.indexOf(["sym_010"],a.code)&&(f.layerRenderingFailures=!0);-1<c.indexOf(["sym_001"],
a.code)&&(f.layerRenderingChanged=!0)})}),c.forEach(b.symbols,function(a){-1<c.indexOf(["sym_010"],a.code)&&(f.layerRenderingFailures=!0);-1<c.indexOf(["sym_001"],a.code)&&(f.layerRenderingChanged=!0)});e.itemId&&(f.itemAccess=b.itemAccess)&&(-1<c.indexOf(["layer_001"],b.item.code)?f.itemUrlChange="success":-1<c.indexOf(["layer_020"],b.item.code)?(f.itemUrlChange="success",f.itemAccess=!1):-1<c.indexOf(["layer_002","layer_003"],b.item.code)?f.itemUrlChange="none":f.itemUrlChange="failure",b.item.queryLayers&&
(f.itemQueryUrlChanged=!1,f.itemQueryUrlFailures=!1,c.forEach(b.item.queryLayers,function(a){-1<c.indexOf(["layer_001"],a.code)?f.itemQueryUrlChanged=!0:-1<c.indexOf(["layer_002","layer_003"],a.code)||(f.itemQueryUrlFailures=!0)})),b.item.renderers||b.item.symbols)&&(f.itemRenderingChanged=!1,f.itemRenderingFailures=!1,c.forEach(b.item.renderers,function(a){c.forEach(a.symbols,function(a){-1<c.indexOf(["sym_010"],a.code)&&(f.itemRenderingFailures=!0);-1<c.indexOf(["sym_001"],a.code)&&(f.itemRenderingChanged=
!0)})}),c.forEach(b.item.symbols,function(a){-1<c.indexOf(["sym_010"],a.code)&&(f.itemRenderingFailures=!0);-1<c.indexOf(["sym_001"],a.code)&&(f.itemRenderingChanged=!0)}));d.push(f)}});a.presentation&&a.presentation.slides&&c.forEach(a.presentation.slides,function(b){b.baseMap&&b.baseMap.baseMapLayers&&c.forEach(b.baseMap.baseMapLayers,function(d,e){-1<c.indexOf(n,d.id)&&(d=ca(a,d.id),b.baseMap.baseMapLayers[e]=d)})});Z();b=f.stringify(h)===f.stringify(a);Z();b||"noSave"===Z()?g.resolve({layers:d,
configChange:"none"}):t(a,e).then(function(){g.resolve({layers:d,configChange:"success"})},function(a){g.resolve({layers:d,configChange:"failure"})})}):g.resolve({layers:[]});return g},switchDomain:function(a,e,g,h){var k=new d,m=[];if(!(a&&e&&g&&h))return k.resolve({layers:[]}),k;var n=l.clone(a),p={from:g,to:h,type:null,checkedItemsList:{}};g=aa(a);c.forEach(g,function(a){var b={configLayer:a.layer};"tables"===a.type&&(b.type="table");l.mixin(b,p);V(b.configLayer,b.type)===b.from&&m.push(y(b))});
m.length?(new b(m)).addCallback(function(b){var d=[];c.forEach(b,function(b){Z();b=b[1];var e=ca(a,b.layerId),f={id:b.layerId,title:e.title};-1<c.indexOf(["layer_001"],b.code)?f.layerUrlChange="success":-1<c.indexOf(["layer_002","layer_003"],b.code)?f.layerUrlChange="none":f.layerUrlChange="failure";e.itemId&&(f.itemAccess=b.itemAccess)&&(-1<c.indexOf(["layer_001"],b.item.code)?f.itemUrlChange="success":-1<c.indexOf(["layer_020"],b.item.code)?(f.itemUrlChange="success",f.itemAccess=!1):-1<c.indexOf(["layer_002",
"layer_003"],b.item.code)?f.itemUrlChange="none":f.itemUrlChange="failure");d.push(f)});Z();b=f.stringify(n)===f.stringify(a);Z();b||"noSave"===Z()?k.resolve({layers:d,configChange:"none"}):t(a,e).then(function(){k.resolve({layers:d,configChange:"success"})},function(a){k.resolve({layers:d,configChange:"failure"})})}):k.resolve({layers:[]});return k}}})},"arcgisonline/pages/item/widgets/typeOptions/mapOptions/domainUpdate":function(){define("require esri/declare esri/lang dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/on dijit/a11yclick dojo/string dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin ../../../../pageUtil ../../../../../map/core/urlUtils dojo/i18n!../../../../../nls/arcgisonline dojo/text!./domainUpdate.html".split(" "),
function(c,l,h,a,e,f,d,b,g,k,m,p,q,n,r,v,u){return l([p,q],{basePath:c.toUrl("arcgisonline/pages/item/widgets/typeOptions/mapOptions"),templateString:u,postMixInProperties:function(){this.inherited(arguments);this.i18n=v},startup:function(){this.inherited(arguments);this._initUI()},_initUI:function(){this._initHandlers();this._initDomains()},_initHandlers:function(){this.own(g(this._doneBtn,this._doneClick.bind(this)),b(this._domainSelect,"change",this._selectedDomainChange.bind(this)),g(this._replaceDomainBtn,
this._replaceDomainClick.bind(this)),n.registerKeystrokeHandler(this._domainReplace,this._replaceDomainChange.bind(this)),m.subscribe("item-data/change-complete",this._itemDataChange.bind(this)))},_initDomains:function(){var a=!1,b=this._domainSelect.value;r.getUniqueDomains(this.item.itemData).then(function(c){d.empty(this._domainSelect);c.forEach(function(c){var e={value:c.domain,innerHTML:c.domain};!this._autoSelectReplacementValue||c.domain!==this._autoSelectReplacementValue&&c.domain!==b||(a=
e.selected=!0,this._autoSelectReplacementValue=void 0);d.create("option",e,this._domainSelect)}.bind(this));this._domainSelect.options&&this._domainSelect.options.length?(a||(n.selectOption(this._domainSelect.options[0]),this._lastSelectedDomain=this._domainSelect.options[0].value),this._selectedDomainChange()):(n.hideNodes([this._updateDomainDesc,this._updateDomainContainer,this._replaceDomainLoading,this._replaceDomainFailure,this._layerDetailsContainer]),d.empty(this._replaceDomainSuccess),e.set(this._replaceDomainSuccess,
"innerHTML",this.i18n.itemProperties.noLayersToUpdateDomain),n.showNode(this._replaceDomainSuccess))}.bind(this))},_filterForIssues:function(a){return a.filter(function(a){return"failure"===a.layerUrlChange||a.layerRenderingFailures||a.layerQueryUrlFailures||a.itemAccess&&("failure"===a.itemUrlChange||a.itemRenderingFailures||a.itemQueryUrlFailures)})},_filterForUpdated:function(a){return a.filter(function(a){return("success"===a.layerUrlChange||a.layerRenderingChanged||a.layerQueryUrlChanged)&&!a.layerRenderingFailures&&
!a.layerQueryUrlFailures||a.itemAccess&&("success"===a.itemUrlChange||a.itemRenderingChanged||a.itemQueryUrlChanged)&&!a.itemRenderingFailures&&!a.itemQueryUrlFailures})},_ensureProtocol:function(a){return!a||-1!==a.indexOf("://")||n.startsWith(a,"http://")||n.startsWith(a,"https://")?a:"http://"+a},_validateDomain:function(a){var b=!0,c=this._domainSelect.value,d=!!c,e=/\//g;a?(-1<a.indexOf("://")&&!n.startsWith(a,"http://")&&!n.startsWith(a,"https://")&&(b=!1),d&&(c.match(e)||[]).length!==(a.match(e)||
[]).length&&(b=!1)):b=!1;return b},_doneClick:function(){m.publish("update-domain/done")},_setInputError:function(a){f.add(this._domainReplace,"input-error");f.add(this._domainReplaceError,"is-active");f.remove(this._domainReplaceError,"hide")},_clearInputError:function(){f.remove(this._domainReplace,"input-error");f.remove(this._domainReplaceError,"is-active");f.add(this._domainReplaceError,"hide")},_selectedDomainChange:function(){var a=this._domainSelect.value,b=!!a,c="",d;r.getUniqueDomains(this.item.itemData).then(function(f){this._refreshingDomains?
this._refreshingDomains=void 0:a!==this._lastSelectedDomain&&(n.hideNode(this._replaceDomainFailure),n.hideNode(this._replaceDomainSuccess));if(b){if(d=f.filter(function(b){return b.domain===a}.bind(this)))d=d.shift(),this._lastSelectedDomain=this._domainReplace.value=d.domain,d.layers.forEach(function(a){c+=a.title+"\x3cbr\x3e"}.bind(this)),e.set(this._layerDetails,"innerHTML",c);this._clearInputError();n[d?"showNode":"hideNode"](this._layerDetailsContainer);this._domainReplace.focus()}else n.hideNode(this._layerDetailsContainer);
this._replaceDomainChange()}.bind(this))},_replaceDomainClick:function(){var a=this._domainSelect.value,b=this._ensureProtocol(k.trim(this._domainReplace.value));this._clearInputError();this._validateDomain(b)?(n.hideNodes([this._layerDetailsContainer,this._replaceDomainFailure,this._replaceDomainSuccess]),n.showNode(this._replaceDomainLoading),r.switchDomain(this.item.itemData,this.item,a,b).then(function(a){n.hideNode(this._replaceDomainLoading);var c=this._filterForIssues(a.layers),d=this._filterForUpdated(a.layers);
h.isDefined(a.configChange)&&"failure"===a.configChange?(e.set(this._replaceDomainFailureMessage,"innerHTML",this.i18n.itemProperties.errorUpdateHTTPS),n.showNode(this._replaceDomainFailure)):c.length?(e.set(this._replaceDomainFailureMessage,"innerHTML",k.substitute(this.i18n.itemProperties.someLayerDomainsFailed,{domainName:b,n:c.length})),n.showNode(this._replaceDomainFailure),d.length&&(e.set(this._replaceDomainSuccessMessage,"innerHTML",k.substitute(this.i18n.itemProperties.someLayerDomainsUpdated,
{domainName:b,n:d.length})),n.showNode(this._replaceDomainSuccess))):(e.set(this._replaceDomainSuccessMessage,"innerHTML",k.substitute(this.i18n.itemProperties.domainUpdateSuccess,{domainName:b})),n.showNode(this._replaceDomainSuccess));this._autoSelectReplacementValue=b;this._domainReplace.value="";this._refreshingDomains=!0;this._replaceDomainChange();m.publish("item-data/change")}.bind(this),function(a){this._setInputError(a)}.bind(this))):this._setInputError()},_replaceDomainChange:function(){var a=
k.trim(this._domainReplace.value),b=this._domainSelect.value,b=b&&a&&0<a.length&&a!==b;n.disableNode(this._replaceDomainBtn,!b||b&&!this._validateDomain(a));this._clearInputError()},_itemDataChange:function(a){"type-options/map"===a.source&&(this.item.itemData=a.itemData,this._initDomains())}})})},"arcgisonline/pages/utils/setItemUrls":function(){define("dojo/_base/lang dojo/io-query dojo/query esri/geometry/Extent ../pageUtil ../../esriGeowConfig ../../sharing/util".split(" "),function(c,l,h,a,e,
f,d){return{sceneViewer:function(a){var b="./webscene/viewer.html?";switch(a.classification){case "layer":b+="layers\x3d"+a.id;break;default:b+="webscene\x3d"+a.id}a.sceneViewerUrl=b},mapViewer:function(a){var b=f.baseUrl+"webmap/viewer.html?",d="map"===a.classification,m=a.sourceData||{},p=a.type,q={},n=a.portal,n=!(n&&n.getPortalUser())&&a.isPremiumContent&&!n.isPortal,r={};a.numViews||e.includes(a.typeKeywords,"Layer Template")||!a.isHostedService||"Feature Service"!==p&&"Feature Collection"!==
p||"Feature Service"===p&&("Feature Service"!==p||"Feature Collection"===m.type||"Service Definition"===m.type||e.includes(a.typeKeywords,"View Service"))||(q=c.mixin(r,{panel:"gallery",suggestField:!0}));!a.numViews&&a.isHostedService&&"Map Service"===p&&a.serviceInfo&&a.adminServiceInfo&&(q=c.mixin(r,this._getLevelCenter(a)));switch(a.classification){case "map":r.webmap=a.id;break;default:r.layers=a.id}a.mapViewerWithReviewUrl=b+l.objectToQuery(c.mixin({},r,d?{}:{review:!0}));a.mapViewerWithEditUrl=
b+l.objectToQuery(c.mixin({},r,d?{}:{isAdmin:!0}));a.mapViewerUrl=b+l.objectToQuery(c.mixin(d?{}:{useExisting:1},r,q));a.mapNewViewerUrl=b+l.objectToQuery(c.mixin({},r,q));n&&(a.mapViewerUrl="signin.html?returnUrl\x3d"+encodeURIComponent(a.mapViewerUrl),a.mapNewViewerUrl="signin.html?returnUrl\x3d"+encodeURIComponent(a.mapNewViewerUrl));h(".js-open-mapViewer.js-open-btn.js-action-newWebMapViewer").attr("data-href",a.mapViewerUrl);h(".add-to-new-viewer").attr("data-href",a.mapNewViewerUrl)},cityEngineViewer:function(a){a.cityEngineViewerUrl=
"../apps/CEWebViewer/viewer.html?3dWebScene\x3d"+a.id},appViewer:function(a){var b=e.includes(a.typeKeywords,"Web AppBuilder");a.appViewerUrl=a.url;b&&(b=a.url&&-1<a.url.indexOf("/webappviewer3d/"),a.wabEditUrl=a.url&&a.url.replace(b?"/webappviewer3d/":"/webappviewer/","/webappbuilder/"))},workforceViewer:function(a){var b=a.portal.isPortal;a.workforceViewerUrl=(b?"../":"//workforce.arcgis.com")+((b?"apps/workforce/#":"")+("/projects/"+a.id+"/dispatch/assignments"))},surveyViewer:function(a){a.surveyViewerUrl=
"https://survey123.arcgis.com/share/"+a.id;a.surveyAppUrl=a.surveyViewerUrl+"?open\x3dnative"},insightsViewer:function(a){var b=e.includes(a.types,"is-insightsModel");e.includes(a.types,"is-insightsTheme");e.includes(a.types,"is-insightsPage")?a.insightsViewerUrl="../apps/insights/#/view/"+a.id:a.insightsViewerUrl=b?"../apps/insights/#/?model\x3d"+a.id:"../apps/insights/#/"+a.id},orthoMaker:function(a){a.orthoMakerUrl="../apps/orthomaker/#/projects/"+a.id},notebookViewer:function(a){a.notebookViewerUrl=
f.baseUrl+"notebook.html?id\x3d"+a.id},createPresentation:function(a){a.createPresentationUrl="../apps/presentation/index.html?builder\x3dtrue\x26webmap\x3d"+a.id},openPresentation:function(a){a.openPresentationUrl="../apps/presentation/index.html?webmap\x3d"+a.id},operationsDashboard:function(a){var b=a.portal.isPortal,c=location.protocol+"//"+(b?f.self.portalHostname:location.host);e.includes(a.typeKeywords,"TabletLayout");e.includes(a.typeKeywords,"DesktopLayout");var h=d.couldHaveArcGISDesktop();
d._isOperationsViewSupportedBrowser();h&&(a.operationsDashboardUrl=c+(b?"/apps/dashboard-win/":"/opsdashboard/")+"OperationsDashboard.application?open\x3d"+a.id)},operationsDashboardWeb:function(a){var b=location.protocol+"//"+location.host+d.getHomeAppContext()+"/apps/dashboard/index.html#/"+a.id;d.couldHaveArcGISDesktop();var c=e.includes(a.typeKeywords,"TabletLayout");e.includes(a.typeKeywords,"DesktopLayout");var f=d._isOperationsViewSupportedBrowser();c&&f&&(a.operationsDashboardWebUrl=b)},operationsDashboardWebV2:function(a){var b=
a.portal;a.operationsDashboardWebV2Url="https://opsdashboard.esri.com/dashboard-beta/#/"+a.id+"?p\x3d"+(b.urlKey?b.urlKey+"."+b.customBaseUrl:b.portalHostname)},dashboard:function(a){var b="../apps/opsdashboard/index.html#/"+a.id,c="../apps/opsdashboard/index.html#/new?id\x3d"+a.id;a.dashboardUrl=b;a.dashboardEditUrl=b+"?edit\x3dtrue";a.dashboardCopyUrl=c},configureApp:function(a){var b=[],c="appid\x3d"+a.id,d=a.folderId&&"/"!==a.folderId?"folderid\x3d"+a.folderId:"",e="./webmap/configureApp.html";
if(-1<(a.typeKeywords||[]).indexOf("selfConfigured")||"Hub Initiative"===a.type){if(e=a.url)b.push("edit\x3dtrue"),-1===e.indexOf("appid\x3d")&&b.push(c),-1===e.indexOf("folderId")&&d&&b.push(d)}else d&&b.push(d),b.push(c);a.configureUrl=e?e+(-1<e.indexOf("?")?"\x26":"?")+b.join("\x26"):""},createListing:function(a){var b=f.marketplaceUrl+"/listing.html?itemId\x3d"+a.id;"private"===a.access&&(a.createListingUrl=b)},downloadAttachment:function(a){var b=a.portal.getPortalUser(),f=e.includes(a.typeKeywords,
"Web AppBuilder"),b="public"!==a.access&&b&&b.token||f&&a.isAdmin?"?token\x3d"+b.token:"",h=(f=a.codeAttachment)&&(f.url||this._getItemDataUrl(c.mixin(f,{portal:a.portal})));try{h=d.getAbsoluteUrl(h)||h}catch(p){}a.downloadAttachmentUrl=f&&f.url?h+b:h},viewStyle:function(a){var b=a.portal.getPortalUser(),b="public"!==a.access&&b&&b.token?"\x26token\x3d"+b.token:"",c=(a.hasResources?a.itemUrl:a.url)+"/resources/styles/root.json?f\x3dpjson";if((a.isAdmin||a.isOwner)&&a.hasResources||a.hasViewStyle)a.viewStyleUrl=
c+b},downloadStyle:function(a){var b=a.portal.getPortalUser(),b="public"!==a.access&&b&&b.token?"\x26token\x3d"+b.token:"",c=(a.hasResources?a.itemUrl:a.url)+"/resources/styles/root.json?f\x3dpjson";(a.isAdmin||a.isOwner)&&a.hasResources&&(a.downloadStyleUrl=c+"\x26download\x3dtrue"+b)},_getItemDataUrl:function(a){var b=a.portal&&a.portal.getPortalUser(),b="public"!==a.access&&b&&b.token?"?token\x3d"+b.token:"",c=f.restBaseUrl+"content/items/"+a.id+"/data";return"KML"!==a.type?a.itemDataUrl||c+b:
a.url!==a.itemDataUrl&&""===b?a.url:a.itemDataUrl||c+b},_getLevelCenter:function(b){var d=-1,e=b&&b.serviceInfo||{};b=b&&b.adminServiceInfo||{};var f;return e.tileInfo&&e.tileInfo.lods&&b.cacheOnDemand&&b.cacheOnDemandMinScale?(f=b.cacheOnDemandMinScale,e.tileInfo.lods.forEach(c.hitch(this,function(a,b){-1===d&&f>=a.scale&&(d=b)})),e=(new a(e.fullExtent)).getCenter(),{level:d,center:[e.x,e.y,e.spatialReference.wkid].join()}):{}}}})},"arcgisonline/sharing/dijit/dialog/getWFSConfig":function(){define(["dojo/_base/array",
"esri/renderers/SimpleRenderer","esri/symbols/jsonUtils","arcgisonline/map/popup/getDefaultPopupInfo"],function(c,l,h,a){function e(b){var d,e=b.fields,f=b.selectedLayer||{},g;e&&e.length&&(g=c.filter(e,function(a){return"esriFieldTypeGeometry"!==a.type}))&&g.length&&(d=a({name:f.title,fields:e},!1,b));return d}var f={type:"esriSMS",style:"esriSMSCircle",color:[34,114,162,128],size:6,outline:{color:[34,114,162,255],width:1}},d={type:"esriSLS",style:"esriSLSSolid",color:[77,77,77,255],width:2},b={type:"esriSFS",
style:"esriSFSSolid",color:[227,139,79,204],outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,255,255,255],width:.75}};return function(a){var c=a.geometryType,g=a.toJson(),p=g.url,q=g.mode,g={version:g.version,name:g.name,wfsNamespace:a.layerNamespace,featureUrl:a.getFeatureUrl,supportedSpatialReferences:a.spatialReferences},n;"esriGeometryPoint"===c?n=new l(h.fromJson(f)):"esriGeometryPolyline"===c?n=new l(h.fromJson(d)):"esriGeometryPolygon"===c&&(n=new l(h.fromJson(b)));n=n.toJson();return{url:p,
mode:q,wfsInfo:g,layerDefinition:{geometryType:c,drawingInfo:{renderer:n},spatialReference:{wkid:4326},fields:a.fields},popupInfo:e(a)}}})},"arcgisonline/map/popup/getDefaultPopupInfo":function(){define(["./isImageServiceLayer","dojo/_base/array","dojo/_base/lang"],function(c,l,h){return function(a,e,f){e=a.displayField;e=a.name+(e&&e.length?": {"+e+"}":"");var d=a.fields,b=!1,g=!1,k=!1;c(f)&&(d=f.getCustomRasterFields({rasterAttributeTableFieldPrefix:"Raster."}),k=0>l.indexOf(["F32","F64"],f.pixelType),
f&&f.capabilities&&(g=(b=f.capabilities&&-1<f.capabilities.toLowerCase().indexOf("catalog")||f.fields&&0<f.fields.length)&&("esriImageServiceDataTypeVector-UV"===f.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===f.serviceDataType)));var m={esriFieldTypeDouble:1,esriFieldTypeSingle:1},p={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},q={esriFieldTypeDate:1},n=",";a.editFieldsInfo&&(a.editFieldsInfo.creatorField&&(n+=a.editFieldsInfo.creatorField+","),a.editFieldsInfo.creationDateField&&
(n+=a.editFieldsInfo.creationDateField+","),a.editFieldsInfo.editorField&&(n+=a.editFieldsInfo.editorField+","),a.editFieldsInfo.editDateField&&(n+=a.editFieldsInfo.editDateField+","),n=n.toLowerCase());d=l.map(d,h.hitch(this,function(c,d){d="esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==c.type&&"esriFieldTypeGeometry"!==c.type;var e=null,l=c.editable&&"esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==c.type;if(d){var r=c.name.toLowerCase(),v=n+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,";
b&&(v+="raster.itempixelvalue,",g&&(v+="raster.magnitude,raster.direction,"));if(-1<v.indexOf(","+r+",")||-1<r.indexOf("shape")||-1<r.indexOf("perimeter")||-1<r.indexOf("objectid")||-1<r.indexOf("raster.servicepixelvalue.")||r.indexOf("_i")==r.length-2)d=!1;c.type in p?e={places:0,digitSeparator:!0}:c.type in m?e={places:k&&(-1<r.indexOf("raster.servicepixelvalue")||-1<r.indexOf("raster.itempixelvalue"))?0:2,digitSeparator:!0}:c.type in q&&(10<=a.currentVersion||f&&10<=f.version)&&(e={dateFormat:"longMonthDayYear"})}l=
l?-1===n.indexOf(","+c.name.toLowerCase()+","):l;return h.mixin({},{fieldName:c.name,label:c.alias,isEditable:l,tooltip:"",visible:d,format:e,stringFieldOption:"textbox"})}));e={title:e,fieldInfos:d,description:null,showAttachments:!0,mediaInfos:[]};c(f)&&(e.layerOptions={},e.layerOptions.showNoDataRecords=!0,e.layerOptions.returnTopmostRaster=!0);return e}})},"arcgisonline/map/popup/isImageServiceLayer":function(){define(["esri/layers/ArcGISImageServiceLayer","esri/layers/ArcGISImageServiceVectorLayer"],
function(c,l){return function(c){return c instanceof esri.layers.ArcGISImageServiceLayer||c instanceof esri.layers.ArcGISImageServiceVectorLayer}})},"arcgisonline/sharing/dijit/dialog/getWMTSConfig":function(){define("dojo/Deferred dojo/json dojo/_base/array dojo/_base/lang esri/renderers/SimpleRenderer esri/symbols/jsonUtils esri/SpatialReference esri/geometry/Extent arcgisonline/map/core/sameSpatialReference arcgisonline/map/core/projectExtent".split(" "),function(c,l,h,a,e,f,d,b,g,k){function m(a){var b=
new c;p(a.selectedLayer.gcsExtent,a.selectedTileInfo.fullExtent).then(function(a){b.resolve(a.toJson())});return b}function p(b,e){var f=new c;e=e.spatialReference||new d({wkid:4326});var g=a.hitch(this,function(a){f.resolve(a&&a.length&&a[0]&&a[0].type&&"extent"===a[0].type?a[0]:null)});k(b,e,g,g);return f}return function(b){var d=new c,e=b.selectedLayer||{},f=b.selectedTileInfo||{},g;m(b).then(a.hitch(this,function(a){var c;c=b.selectedLayer;var h=b.selectedTileInfo,k=-1<dojo.indexOf(c.formats,
"image/png")?"image/png":c.formats[0];b.resourceUrls=c.resourceUrls;c=b.getTileUrlTemplate({identifier:c.identifier,tileMatrixSet:h.tileMatrixSet,format:k});(h=b.copyright)&&"none"!==h.toLowerCase()?180<h.length&&(h=h.substring(0,180)+".."):h="";var k=b.selectedTileInfo.tileInfo||{},l;if(96!==k.dpi){for(var m=0;m<k.lods.length;m++)l=k.lods[m],l.scale=96*l.scale/k.dpi;k.dpi=96}k=k.toJson();g={templateUrl:c,copyright:h,fullExtent:a,tileInfo:k,wmtsInfo:{url:b.wmtsUrl,layerIdentifier:e.identifier,tileMatrixSet:f.tileMatrixSet}};
d.resolve(g)}));return d}})},"url:esri/dijit/editing/templates/Editor.html":'\x3cdiv class\x3d"esriEditor"\x3e\r\n    \x3cdiv class\x3d"esriTemplatePicker" dojoAttachPoint\x3d"templatePickerDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriDrawingToolbar" dojoAttachPoint\x3d"drawingToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"progressBar" dojoAttachPoint\x3d"progressBar" indeterminate\x3d"true" dojoType\x3d"dijit.ProgressBar" /\x3e\r\n\x3c/div\x3e',"url:esri/dijit/templates/InfoWindow.html":'\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\r\n  \x3e\x3cdiv style\x3d"position:relative;"\r\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\r\n      \x3e\x3cdiv class\x3d"top"\r\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\r\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\r\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\r\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\r\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\r\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\r\n    \t\t\t  \x3e\x3c/div\r\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\r\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\r\n    \t\t\t  \x3e\x3c/div\r\n    \t\t\t\x3e\x3c/div\r\n    \t\t\x3e\x3c/div\r\n        \x3e\x3cdiv class\x3d"bottom"\r\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n        \x3e\x3c/div\r\n      \x3e\x3c/div\r\n    \x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n  \x3e\x3c/div\r\n\x3e\x3c/div\x3e',
"url:esri/dijit/templates/OverviewMap.html":'\x3cdiv class\x3d"esriOverviewMap"\x3e\r\n  \x3cdiv class\x3d"ovwContainer" dojoattachpoint\x3d"_body" style\x3d"width: ${width}px; height: ${height}px;"\x3e\r\n    \x3cdiv id\x3d"${id}-map" style\x3d"width: 100%; height: 100%;"\x3e\r\n      \x3cdiv class\x3d"ovwHighlight" dojoattachpoint\x3d"_focusDiv" title\x3d"${NLS_drag}" style\x3d"border: 1px solid ${color}; background-color: ${color};"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwController" title\x3d"${NLS_show}" dojoattachpoint\x3d"_controllerDiv" dojoattachevent\x3d"onclick: _visibilityHandler"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"ovwButton ovwMaximizer" title\x3d"${NLS_maximize}" dojoattachpoint\x3d"_maximizerDiv" dojoattachevent\x3d"onclick: _maximizeHandler"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/TimeSlider.html":'   \x3cdiv class\x3d"esriTimeSlider"\x3e\r\n   \x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e\r\n   \x3ctr\x3e\r\n   \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPlayButton" dojoAttachEvent\x3d"onClick:_onPlay" dojoAttachPoint\x3d"playPauseBtn" type\x3d"button"\x3e${NLS_play}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"center" valign\x3d"middle" width\x3d"80%" class\x3d"tsTmp"\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle" width\x3d"30"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsPrevButton" dojoAttachEvent\x3d"onClick:_onPrev" dojoAttachPoint\x3d"previousBtn" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\x3c/td\x3e\r\n   \x3ctd align\x3d"left" valign\x3d"middle"\x3e\x3cbutton dojoType\x3d"dijit.form.Button" showLabel\x3d"false" iconClass\x3d"tsButton tsNextButton" dojoAttachEvent\x3d"onClick:_onNext" dojoAttachPoint\x3d"nextBtn" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\x3c/td\x3e\r\n   \x3c/tr\x3e    \r\n   \x3c/table\x3e\r\n   \x3c/div\x3e',
"url:esri/dijit/templates/MultidimensionalSlider_vertical.html":'\x3cdiv class\x3d"esriMdSliderVertical esriMdSliderPassive"\x3e\r\n  \x3ctable class\x3d"esriMdSliderTableVertical" data-dojo-attach-point\x3d"mdSliderTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3" class\x3d"esriMdSliderInfoCellVertical"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo" class\x3d"esriMdSliderInfo"\x3e\r\n          \x3cbr/\x3e\x3cbr/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd colspan\x3d"3" class\x3d"esriMdSliderCellVertical" data-dojo-attach-point\x3d"mdSliderCell"\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr  class\x3d"esriMdSliderPlayButtonRow"  data-dojo-attach-point\x3d"playPauseBtnRow"\x3e\r\n      \x3ctd class\x3d"esriMdSliderPrevButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPrevButton\'" data-dojo-attach-event\x3d"onClick:decrement" data-dojo-attach-point\x3d"prevBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_previous}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderPlayButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderNextButtonCell"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsNextButton\'" data-dojo-attach-event\x3d"onClick:increment" data-dojo-attach-point\x3d"nextBtn" type\x3d"button"\r\n                title\x3d"${_i18n.widgets.mdSlider.NLS_next}"\x3e\r\n        \x3c/button\x3e\x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/MultidimensionalSlider_horizontal.html":'\x3cdiv class\x3d"esriMdSliderHorizontal"\x3e\r\n  \x3ctable class\x3d"esriMdSliderTableHorizontal"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol class\x3d"esriMdSliderHorizontalCol1"\x3e\r\n      \x3ccol\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd class\x3d"esriMdSliderDimensionInfoCellHorizontal" colspan\x3d"2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dimensionInfo"\x3e\x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd align\x3d"right" valign\x3d"middle"\x3e\x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass: \'mdsButton mdsPlayButton\'" data-dojo-attach-event\x3d"onClick:_onPlay" \r\n                                               data-dojo-attach-point\x3d"playPauseBtn" type\x3d"button" title\x3d"${_i18n.widgets.mdSlider.NLS_play}"\x3e\x3c/button\x3e\x3c/td\x3e\r\n      \x3ctd class\x3d"esriMdSliderCellHorizontal" data-dojo-attach-point\x3d"mdSliderCell"\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/BasemapGallery.html":'\x3cdiv class\x3d"esriBasemapGallery"\x3e\r\n  \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:esri/dijit/templates/HomeButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.container}"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_homeNode" title\x3d"${_i18n.widgets.homeButton.home.title}" role\x3d"button" class\x3d"${_css.home}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.homeButton.home.button}\x3c/span\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/LocateButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.container}"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_locateNode" role\x3d"button" class\x3d"${_css.locate}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.locateButton.locate.button}\x3c/span\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:esri/dijit/templates/Geocoder.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv class\x3d"${_css.GeocoderContainerClass}" role\x3d"presentation"\x3e\r\n    \t\x3cdiv class\x3d"${_css.GeocoderClass}" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv title\x3d"${_i18n.widgets.Geocoder.main.searchButtonTitle}" tabindex\x3d"0" class\x3d"${_css.searchButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"submitNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv aria-haspopup\x3d"true" id\x3d"${id}_menu_button" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuButtonTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuArrowClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"geocoderMenuArrowNode" role\x3d"button" aria-expanded\x3d"false"\x3e\x3c/div\x3e\r\n    \t\t\x3cinput aria-haspopup\x3d"true" id\x3d"${id}_input" tabindex\x3d"0" placeholder\x3d"" value\x3d"${value}" autocomplete\x3d"off" type\x3d"text" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n    \t\t\x3cdiv tabindex\x3d"0" class\x3d"${_css.clearButtonClass} ${_css.GeocoderIconClass}" data-dojo-attach-point\x3d"clearNode" role\x3d"button"\x3e\x3c/div\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" data-dojo-attach-point\x3d"resultsNode" aria-labelledby\x3d"${id}_input" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.geocoderMenuClass}" data-dojo-attach-point\x3d"geocoderMenuNode" role\x3d"presentation"\x3e\r\n    \t\t\x3cdiv class\x3d"${_css.geocoderMenuHeaderClass}"\x3e\r\n    \t\t\t${_i18n.widgets.Geocoder.main.geocoderMenuHeader}\r\n    \t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"geocoderMenuCloseNode" title\x3d"${_i18n.widgets.Geocoder.main.geocoderMenuCloseTitle}" tabindex\x3d"0" class\x3d"${_css.geocoderMenuCloseClass}"\x3e\x3c/div\x3e\r\n    \t\t\t\x3cdiv class\x3d"${_css.GeocoderClearClass}" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\t\x3c/div\x3e\r\n    \t\t\x3cdiv data-dojo-attach-point\x3d"geocoderMenuInsertNode" aria-labelledby\x3d"${id}_menu_button" role\x3d"menu" aria-hidden\x3d"true"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/templates/Directions.html":'\x3cdiv class\x3d"${options.theme}" role\x3d"presentation"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_widgetContainer" class\x3d"${_css.widgetContainerClass}" role\x3d"presentation"\x3e\r\n        \x3cdiv class\x3d"${_css.stopsContainerClass}" role\x3d"presentation"\x3e\r\n            \x3cdiv id\x3d"search-source-container" class\x3d"${_css.searchSourceContainerClass}" data-dojo-attach-point\x3d"_searchSourceContainerNode"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_searchSourceSelectorContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsTableContainerClass}"\x3e\r\n                \x3ctable class\x3d"${_css.stopsClass}" data-dojo-attach-point\x3d"_dndNode"\x3e\x3c/table\x3e\r\n                \x3cdiv class\x3d"${_css.stopsTableCoverClass}" data-dojo-attach-point\x3d"_stopsTableCover"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsButtonContainerClass}"\x3e\r\n                \x3cdiv class\x3d"${_css.stopsAddDestinationClass}"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_activateButtonNode" title\x3d"${_i18n.widgets.directions.activate}" class\x3d"${_css.activateButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass} ${_css.stopsPressedButtonClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_lineBarrierButtonNode" title\x3d"${_i18n.widgets.directions.lineBarrier}" class\x3d"${_css.lineBarrierButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\r\n                    \x3cdiv role\x3d"button" tabindex\x3d"0" class\x3d"${_css.linkButtonClass} ${_css.stopsAddDestinationBtnClass}" data-dojo-attach-point\x3d"_addDestinationNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.addDestination}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.travelModesContainerClass}" data-dojo-attach-point\x3d"_travelModeContainerNode"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_travelModeSelectorContainer"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} startTimeMenuButton" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_startTimeButtonNodeContainer"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"_startTimeButtonNode"\x3e\r\n                        \x3cspan data-dojo-attach-point\x3d"_startTimeButtonLabel"\x3e${_i18n.widgets.directions.leaveNow}\x3c/span\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"_startTimeDDLArrow" class\x3d"esriDirectionsDDLArrow"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"startTimeMenu" data-dojo-attach-point\x3d"_startTimeMenu"\x3e\r\n                        \x3cul role\x3d"menu"\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuLeaveNow" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio" aria-checked\x3d"true"\x3e${_i18n.widgets.directions.leaveNow}\x3c/li\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuDepartAt" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.departAt}\x3c/li\x3e\r\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuNone" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.noStartTime}\x3c/li\x3e\r\n                        \x3c/ul\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsOptionsButtonClass}" data-dojo-attach-point\x3d"_optionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.showOptions}\x3c/div\x3e\r\n            \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"departAtContainer" data-dojo-attach-point\x3d"_departAtContainer"\x3e\r\n                    \x3cdiv id\x3d"${id}_directionsDepartAtTime" data-dojo-attach-point\x3d"_departAtTimeContainer"\x3e\x3c/div\x3e\r\n                    \x3cdiv id\x3d"${id}_directionsDepartAtDate" data-dojo-attach-point\x3d"_departAtDateContainer"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass}" data-dojo-attach-point\x3d"_optionsMenuNode"\x3e\r\n                \x3cdiv class\x3d"${_css.stopsOptionsCheckboxesClass}"\x3e\r\n                    \x3cul\x3e\r\n                        \x3cli class\x3d"${_css.stopsFindOptimalOrderClass}" data-dojo-attach-point\x3d"_findOptimalOrderItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_findOptimalOrderNode" type\x3d"checkbox" id\x3d"${id}_find_optimal_order" /\x3e\x3clabel for\x3d"${id}_find_optimal_order"\x3e${_i18n.widgets.directions.findOptimalOrder}\x3c/label\x3e\x3c/li\x3e\r\n                        \x3cli class\x3d"${_css.stopsReturnToStartClass}" data-dojo-attach-point\x3d"_returnToStartItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_returnToStartNode" type\x3d"checkbox" id\x3d"${id}_stopsReturnToStart" /\x3e\x3clabel for\x3d"${id}_stopsReturnToStart"\x3e${_i18n.widgets.directions.returnToStart}\x3c/label\x3e\x3c/li\x3e\r\n                        \x3cli class\x3d"${_css.stopsUseTrafficClass}" data-dojo-attach-point\x3d"_useTrafficItemNode" title\x3d"${_i18n.widgets.directions.trafficLabelLive}"\x3e\r\n                            \x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_useTrafficNode" type\x3d"checkbox" id\x3d"${id}_stopsUseTraffic" /\x3e\x3clabel for\x3d"${id}_stopsUseTraffic"\x3e${_i18n.widgets.directions.useTraffic}\x3c/label\x3e\r\n                            \x3ca data-dojo-attach-point\x3d"_trafficAvailabilityButton" style\x3d"display: none;" href\x3d"http://www.arcgis.com/home/item.html?id\x3db7a893e8e1e04311bd925ea25cb8d7c7" target\x3d"_blank"\x3e\x3cdiv class\x3d"esriTrafficAvailabilityButton" title\x3d"${_i18n.widgets.directions.seeTrafficAvailability}"\x3e\x3c/div\x3e\x3c/a\x3e\r\n                        \x3c/li\x3e\r\n                    \x3c/ul\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.stopsOptionsToggleContainerClass}"\x3e\r\n                    \x3cdiv class\x3d"${_css.stopsOptionsUnitsContainerClass}"  data-dojo-attach-point\x3d"_agolDistanceUnitsNode"\x3e\r\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsMiClass} ${_css.stopsButtonClass}" data-dojo-attach-point\x3d"_useMilesNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriMiles.abbr}\x3c/div\x3e\r\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsKmClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabLastClass} ${_css.stopsPressedButtonClass}" data-dojo-attach-point\x3d"_useKilometersNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriKilometers.abbr}\x3c/div\x3e\r\n                        \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"${_css.stopsGetDirectionsContainerClass}"\x3e\r\n                \x3cdiv class\x3d"getDirectionsBtnContainer"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} ${_css.stopsGetDirectionsClass} esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_getDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.getDirections}\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsClearDirectionsClass}" data-dojo-attach-point\x3d"_clearDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.clearDirections}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"savePrintBtnContainer" data-dojo-attach-point\x3d"_savePrintBtnContainer"\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsSaveClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_saveMenuButton" title\x3d"${_i18n.widgets.directions.saveTitle}" \x3e\x3c/div\x3e\r\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsPrintClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_printButton" title\x3d"${_i18n.widgets.directions.print}" \x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass} esriSaveContainer" data-dojo-attach-point\x3d"_saveMenuNode"\x3e\r\n                \x3cdiv class\x3d"esriLayerNameLabel"\x3e${_i18n.widgets.directions.layerName}\x3c/div\x3e\r\n                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_outputLayerContainer"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"_folderSelectorContainer"\x3e\x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} esriSaveButton esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_saveButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.save}\x3c/div\x3e\r\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"esriLinkButton esriSaveAsButton" data-dojo-attach-point\x3d"_saveAsButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.saveAs}\x3c/div\x3e\r\n            \x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\r\n    \t\x3cdiv data-dojo-attach-point\x3d"_msgNode" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" role\x3d"presentation"\x3e\r\n        \t\x3cdiv class\x3d"${_css.routesContainerClass}" data-dojo-attach-point\x3d"_resultsNode" role\x3d"presentation"\x3e\x3c/div\x3e\r\n    \t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/templates/GroupSelector.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"marginTop1" data-dojo-attach-point\x3d"_searchControls"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"_searchLabel"\x3e${i18n.searchByName}\x3c/label\x3e\x3cbr/\x3e\r\n    \x3cspan class\x3d"searchControls"\x3e\r\n      \x3cinput type\x3d"text" class\x3d"groupSearch"\r\n             data-dojo-attach-point\x3d"_searchBox"\r\n             data-dojo-type\x3d"dijit/form/TextBox"\x3e\r\n      \x3cbutton class\x3d"clearSearchBtn" data-dojo-attach-point\x3d"_clearSearchBtn"\r\n              style\x3d"display:none;"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3c/button\x3e\r\n      \x3cbutton class\x3d"searchBtn" data-dojo-attach-point\x3d"_searchBtn" title\x3d"${i18n.search}"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3c/button\x3e\r\n    \x3c/span\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"_restrictSearchControl" style\x3d"display:none;" class\x3d"trailer-0"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_restrictSearch"\r\n           data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"type:\'checkbox\', checked:true"\x3e\x3c/div\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_restrictSearchLabel"\x3e\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"marginTop1 leader-1"\x3e\r\n    \x3ctable class\x3d"marginTop1 group-selector-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"column270 font-size--2"\x3e\x3clabel data-dojo-attach-point\x3d"_groupsClickLabel"\x3e${i18n.clickToAdd}\x3c/label\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"column10"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"column270 font-size--2"\x3e\x3clabel data-dojo-attach-point\x3d"_selectedGroupsClickLabel"\x3e${i18n.clickToRemove}\x3c/label\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"column270"\x3e\r\n            \x3cdiv class\x3d"groupListLabel clearfix"\x3e\r\n              \x3cdiv class\x3d"left" data-dojo-attach-point\x3d"_groupListLabel"\x3e${i18n.groups}\x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatTrailing right actionLink" data-dojo-attach-point\x3d"_addAllContainer"\x3e\r\n                \x3cspan class\x3d"esriItemLinks"\x3e\x3ca data-dojo-attach-point\x3d"_addAll" class\x3d"pointer"\x3e${i18n.addAll}\x3c/a\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_groupsPane" class\x3d"group-list"\x3e\r\n                \x3c!-- group list is populated here --\x3e\r\n              \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"column10"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"column270"\x3e\r\n            \x3cdiv class\x3d"groupListLabel selectedGroupListLabel clearfix"\x3e\r\n              \x3cdiv class\x3d"left" data-dojo-attach-point\x3d"_selectedGroupListLabel"\x3e${i18n.selectedGroups}\x3c/div\x3e\r\n              \x3cdiv class\x3d"esriFloatTrailing right actionLink" data-dojo-attach-point\x3d"_clearAllContainer"\x3e\r\n                \x3cspan class\x3d"esriItemLinks"\x3e\x3ca data-dojo-attach-point\x3d"_clearAll" class\x3d"pointer"\x3e${i18n.clear}\x3c/a\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"_selectedGroupsPane" class\x3d"group-list"\x3e\r\n                \x3c!-- selected group list is populated here --\x3e\r\n              \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/AssignCreditsDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${baseClass} assign-credits-dialog" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"_currentCreditsLabel"\x3e\x3c/span\x3e\r\n    \x3cbr\x3e\x3cbr\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"_setAllocationLabel"\x3e\x3c/span\x3e\r\n    \x3cbr\x3e\x3cbr\x3e\r\n    \x3cspan class\x3d"esriLeadingPadding05 display-block padding-trailer-half"\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput type\x3d"radio" name\x3d"allocation" data-dojo-attach-point\x3d"_setAllocationRadioBtn"\r\n               data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n        ${i18n.allocateCreditsSet}\r\n      \x3c/label\x3e\r\n      \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_credits" class\x3d"creditEntry" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"trim:true"\x3e\r\n    \x3c/span\x3e\r\n    \x3cspan class\x3d"esriLeadingPadding05"\x3e\r\n      \x3clabel data-dojo-attach-point\x3d"_unlimitedCreditsLabel"\x3e\r\n        \x3cinput type\x3d"radio" name\x3d"allocation"\r\n               data-dojo-attach-point\x3d"_setUnlimitedRadioBtn" data-dojo-type\x3d"dijit/form/RadioButton"\x3e\r\n        \x3cspan id\x3d"${id}-noLimitTooltip-${baseClass}" class\x3d"hasTooltip"\x3e${i18n.allocateCreditsUnlimited}\x3c/span\x3e\r\n      \x3c/label\x3e\r\n    \x3c/span\x3e\r\n    \x3cbr\x3e\x3cbr\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing leader-1"\x3e\r\n      \x3cbutton type\x3d"button" class\x3d"calcite small primary" data-dojo-attach-point\x3d"_okBtn" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.assign}\x3c/button\x3e\r\n      \x3cbutton type\x3d"button" class\x3d"calcite cancel small" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/SelectEnterpriseGroupDlg.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"select-enterprise-group-dialog" class\x3d"${baseClass}" title\x3d"${i18n.selectGroup}"\x3e\r\n    \x3cp class\x3d"trailer-0"\x3e${i18n.useSearch}\x3c/p\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing esriTrailingMargin025"\x3e\r\n      \x3clabel for\x3d"searchInput" class\x3d"display-inline"\x3e${i18n.findGroup}\x3c/label\x3e\r\n      \x3cdiv id\x3d"searchInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${baseClass}" data-dojo-attach-point\x3d"_search" data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onKeyDown:onSearchKeyDown"\x3e\x3c/div\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_searchBtn" class\x3d"calcite light small leader-half" data-dojo-attach-event\x3d"onClick:onSearch"\x3e${i18n.search}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_gridContainer" style\x3d"margin-top:1em;"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-half clearfix"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading left" data-dojo-attach-point\x3d"_goToPageContainer"\x3e\r\n        \x3clabel for\x3d"goToInput" class\x3d"inline-block"\x3e${i18n.goToPage}\x3c/label\x3e\r\n        \x3cdiv id\x3d"goToInput" class\x3d"${baseClass}" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"_goTo" data-dojo-attach-event\x3d"onKeyDown:onGoToPageKeyDown" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_goBtn" class\x3d"calcite light small" data-dojo-attach-event\x3d"onClick:onGoToPage"\x3e${i18n.goTo}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing right"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_okBtn" class\x3d"calcite blue" data-dojo-attach-event\x3d"onClick:onOk"\x3e${i18n.selectGroup}\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_cancelBtn" class\x3d"calcite transparent cancel" data-dojo-attach-event\x3d"onClick:onCancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/SelectEnterpriseUserDlg.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"select-enterprise-user-dialog" class\x3d"${baseClass}" title\x3d"${i18n.selectUser}" execute\x3d""\x3e\r\n    \x3cp\x3e${i18n.useSearch}\x3c/p\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing esriTrailingMargin025"\x3e\r\n      \x3clabel for\x3d"searchInputUser"\x3e${i18n.findUser}\x3c/label\x3e\r\n      \x3cdiv id\x3d"searchInputUser" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${baseClass}" data-dojo-attach-point\x3d"_search" data-dojo-props\x3d"trim:true" data-dojo-attach-event\x3d"onKeyDown:onSearchKeyDown"\x3e\x3c/div\x3e\r\n      \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_searchBtn" class\x3d"calcite light small" data-dojo-attach-event\x3d"onClick:onSearch"\x3e${i18n.search}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_gridContainer" style\x3d"margin-top:1em;"\x3e\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top:1em;"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_goToPageContainer"\x3e\r\n        \x3clabel for\x3d"goToInputUser"\x3e${i18n.goToPage}\x3c/label\x3e\r\n        \x3cdiv id\x3d"goToInputUser" class\x3d"${baseClass}" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"_goTo" data-dojo-attach-event\x3d"onKeyDown:onGoToPageKeyDown" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_goBtn" class\x3d"calcite light small" data-dojo-attach-event\x3d"onClick:onGoToPage"\x3e${i18n.goTo}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing"\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_okBtn" class\x3d"calcite blue" data-dojo-attach-event\x3d"onClick:onOk"\x3e${i18n.selectUser}\x3c/button\x3e\r\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_cancelBtn" class\x3d"calcite transparent" data-dojo-attach-event\x3d"onClick:onCancel"\x3e${i18n.cancel}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear:both;"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/templates/OrganizationSetup.html":'\x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv  class\x3d"esriFloatLeading" style\x3d"width:780px; clear:both; padding-left:10px;"\x3e${i18n.thankYou}\x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"width:780px; clear:both; margin-top:2em; padding-left:10px;" class\x3d"esriFloatLeading"\x3e\r\n\r\n    \x3ctable\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.orgName}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_orgNameImg" src\x3d"" alt\x3d"${i18n.orgName}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${i18n.orgNameDesc}\r\n            \x3cbr\x3e\x3cbr\x3e\r\n            \x3clabel\x3e\r\n              \x3cinput class\x3d"orgTextBox" data-dojo-attach-point\x3d"_nameTextBox" data-dojo-type\x3d"dijit/form/TextBox" type\x3d"text" data-dojo-props\x3d"trim:true"\x3e\r\n            \x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.orgAbbr}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_orgAbbrImg" src\x3d"" alt\x3d"${i18n.orgAbbr}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${!i18n.orgAbbrDesc}\r\n            \x3cbr\x3e\x3cbr\x3e\r\n            \x3cinput class\x3d"orgTextBox" id\x3d"urlKeyTextBox" data-dojo-attach-point\x3d"_urlKeyTextBox" data-dojo-type\x3d"dijit/form/TextBox" type\x3d"text" data-dojo-props\x3d"trim:true"\x3e\r\n            \x3clabel for\x3d"urlKeyTextBox" data-dojo-attach-point\x3d"_urlKeyStatusLabel" style\x3d"vertical-align:middle; width:125px;"\x3e\x3c/label\x3e\r\n            \x3cbr\x3e\x3cbr\x3e\r\n            ${i18n.sampleOrgUrl}\r\n            \x3cbr\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"_sampleUrlTextBox"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.languageSetting}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_languageImg" src\x3d"" alt\x3d"${i18n.languageSetting}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${i18n.languageDesc} ${i18n.browserDefaultAGOL}\r\n            \x3cbr\x3e\x3cbr\x3e\r\n            \x3clabel\x3e${i18n.languageLabel} \x3cselect class\x3d"orgComboBox" data-dojo-attach-point\x3d"_languageSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/select\x3e\x3c/label\x3e\r\n\r\n            \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"_languageFormatContainer"\x3e\r\n              \x3cbr\x3e\r\n              \x3clabel\x3e\r\n                \x3cstrong\x3e${i18n.numDateFormat}\x3c/strong\x3e \x3cspan id\x3d"languageFormatTooltip"\x3e\x3ca data-dojo-attach-point\x3d"_languageFormatHelpLink" href\x3d"" target\x3d"_blank"\x3e\x3cimg class\x3d"help-icon" data-dojo-attach-point\x3d"_languageFormatImg" src\x3d"" alt\x3d"${i18n.learnNumDateFormat}"\x3e\x3c/a\x3e\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cselect class\x3d"orgComboBox leader-half" data-dojo-attach-point\x3d"_languageFormatSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\',required:false"\x3e\x3c/select\x3e\r\n              \x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.regionSetting}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_regionImg" src\x3d"" alt\x3d"${i18n.regionSetting}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            ${!i18n.regionDesc}\r\n            \x3cbr\x3e\x3cbr\x3e\r\n            \x3clabel for\x3d"regionSelect"\x3e${i18n.regionLabel}\x3c/label\x3e \x3cselect id\x3d"regionSelect" name\x3d"regionSelect" class\x3d"orgComboBox" data-dojo-attach-point\x3d"_regionSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr class\x3d"hide"\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.security}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"hide"\x3e\r\n          \x3ctd class\x3d"titleColumn"\x3e\r\n            \x3cimg data-dojo-attach-point\x3d"_securityImg" src\x3d"" alt\x3d"${i18n.security}"\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"valignTop"\x3e\r\n            \x3cinput id\x3d"sslCheckBox" name\x3d"sslCheckBox" data-dojo-attach-point\x3d"_sslCheckBox" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkBox"\x3e\r\n            \x3clabel for\x3d"sslCheckBox" data-dojo-attach-point\x3d"_sslCheckBoxLabel"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.link}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd class\x3d"titleColumn"\x3e\r\n                \x3cimg data-dojo-attach-point\x3d"_linkImg" src\x3d"" alt\x3d"${i18n.link}"\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd class\x3d"valignTop"\x3e\r\n              \x3clabel\x3e${i18n.linkDesc}\x3c/label\x3e\x3cbr\x3e\x3cbr\x3e\r\n              \x3ctable\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"valignTop" style\x3d"width:15em;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"_linkCheckBox" id\x3d"linkCheckBox" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"\x3e\r\n                      \x3clabel data-dojo-attach-point\x3d"_linkTooltip" id\x3d"linkTooltip" for\x3d"linkCheckBox"\x3e\x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd class\x3d"valignTop"\x3e\r\n                      \x3clabel\x3e\r\n                        \x3cinput class\x3d"orgTextBox" data-dojo-attach-point\x3d"_link" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true" type\x3d"text" style\x3d"width:25em;"\x3e\x3c/div\x3e\r\n                      \x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2" class\x3d"valignTop"\x3e\x3cstrong\x3e${i18n.usageTrackingSetting}\x3c/strong\x3e\x3cbr\x3e\x3cbr\x3e\x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n            \x3ctd class\x3d"titleColumn"\x3e\r\n                \x3cimg data-dojo-attach-point\x3d"_usageTrackingImg" src\x3d"" alt\x3d"${i18n.usageTrackingSetting}"\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd class\x3d"valignTop"\x3e\r\n              \x3clabel\x3e${i18n.usageTrackingDesc}\x3c/label\x3e\x3cbr\x3e\x3cbr\x3e\r\n              \x3ctable\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd class\x3d"valignTop white-space-no-wrap" style\x3d"width:15em;"\x3e\r\n                      \x3clabel\x3e\r\n                        \x3cinput data-dojo-attach-point\x3d"_usageTrackingCheckBox" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"\x3e\r\n                        ${i18n.allowArcgisOnlineToCollectInfo}\r\n                      \x3c/label\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\x3ctd colspan\x3d"2"\x3e\x3cdiv class\x3d"spacerRow"\x3e\x26nbsp;\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cdiv class\x3d"esriFloatLeading"\x3e\r\n              \x3cbutton data-dojo-attach-point\x3d"_saveBtn" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" class\x3d"calcite blue" data-dojo-props\x3d"iconClass:\'esriSaveIcon\'"\x3e${i18n.saveContinue}\x3c/button\x3e\r\n              \x3cbutton data-dojo-attach-point\x3d"_signOutBtn" data-dojo-type\x3d"dijit/form/Button" type\x3d"button" class\x3d"calcite transparent" data-dojo-props\x3d"iconClass:\'esriOpenIcon\'"\x3e${i18n.signOut}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/UserProfile.html":'\r\n\x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"containerNode" class\x3d"${baseClass}"\x3e\r\n  \x3cdiv id\x3d"editMenu" data-dojo-attach-point\x3d"editMenu" class\x3d"ownerOnly topButtonBar"\x3e\r\n    \x3cdiv id\x3d"profileEditButton" class\x3d"dijitInline calcite blue readOnly"\r\n         data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_startEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.editMyProfile}\x3c/div\x3e\r\n    \x3cdiv id\x3d"profileSaveButton" class\x3d"dijitInline calcite blue editOnlyBtn" style\x3d"display:none;"\r\n         data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_saveEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.save}\x3c/div\x3e\r\n    \x3cdiv id\x3d"profileCancelButton" class\x3d"dijitInline calcite transparent editOnlyBtn" style\x3d"display:none;"\r\n         data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_cancelEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"userDetails"\x3e\r\n    \x3cdiv class\x3d"profileTitle"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_profileTitle"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading userThumbnailInfo"\x3e\r\n      \x3cdiv class\x3d"profileThumbnailBox" data-dojo-attach-point\x3d"_thumbnailDiv"\x3e\r\n        \x3cimg data-dojo-attach-point\x3d"thumbnailImage" class\x3d"profileThumbnail" src\x3d"" alt\x3d""/\x3e\r\n        \x3cimg class\x3d"socialIcon" style\x3d"display:none;" src\x3d"" data-dojo-attach-point\x3d"_socialIcon"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"editOnly thumbnailClick"\x3e\r\n        ${i18n.clickThumbnail}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"readOnly relatedLinks"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"relatedLinks" class\x3d"esriItemLinks"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin3 userProfileColumn"\x3e\r\n      \x3cdiv id\x3d"firstNameProperty" class\x3d"property"\x3e\r\n        \x3clabel for\x3d"first_name"\x3e\x3cstrong\x3e${i18n.firstNameLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"_firstNameLabel"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_firstNameInput" class\x3d"editOnly"\x3e\x3cinput id\x3d"first_name" name\x3d"first_name" data-dojo-attach-point\x3d"firstName" data-dojo-props\x3d"trim:\'true\'" data-dojo-type\x3d"dijit/form/TextBox"/\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"lastNameProperty" class\x3d"property"\x3e\r\n        \x3clabel for\x3d"last_name"\x3e\x3cstrong\x3e${i18n.lastNameLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"_lastNameLabel"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_lastNameInput" class\x3d"editOnly"\x3e\x3cinput id\x3d"last_name" name\x3d"last_name" data-dojo-attach-point\x3d"lastName" data-dojo-props\x3d"trim:\'true\'" data-dojo-type\x3d"dijit/form/TextBox"/\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"user_email_edit" class\x3d"ownerOnly"\x3e\r\n        \x3cdiv class\x3d"property readOnly" data-dojo-attach-point\x3d"_emailDisplayContainer"\x3e\r\n          \x3clabel\x3e\x3cstrong\x3e${i18n.changeEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_displayEmail"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"editOnly" data-dojo-attach-point\x3d"_emailEditContainer"\x3e\r\n          \x3cdiv class\x3d"property"\x3e\r\n            \x3clabel for\x3d"newEmail"\x3e\x3cstrong\x3e${i18n.newEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n            \x3cdiv id\x3d"newEmail" data-dojo-attach-point\x3d"newEmail"\r\n                 data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"property"\x3e\r\n            \x3clabel for\x3d"verifyNewEmail"\x3e\x3cstrong\x3e${i18n.verifyNewEmailLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n            \x3cdiv id\x3d"verifyNewEmail" data-dojo-attach-point\x3d"verifyNewEmail"\r\n                 data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"user_profile_edit" class\x3d"property"\x3e\r\n        \x3cspan id\x3d"user_profile_edit_title"\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"label_username"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca style\x3d"display:none;" id\x3d"user_profile_edit_link" href\x3d"JavaScript:void(0);" data-dojo-attach-point\x3d"editUsernameLink" onclick\x3d"window.open(esriGeowConfig.account_edit);"\x3e${i18n.editLabel}\x3c/a\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"property bio-property"\x3e\r\n        \x3clabel for\x3d"profileBio"\x3e\x3cstrong\x3e${i18n.bioLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n        \x3cdiv class\x3d"esriItemLinks readOnly bioSpan" data-dojo-attach-point\x3d"label_description"\x3e\x3c/div\x3e\r\n        \x3ctextarea id\x3d"profileBio" class\x3d"editOnly bioBox" data-dojo-attach-point\x3d"descriptionTextArea" rows\x3d"" cols\x3d""\x3e\r\n        \x3c/textarea\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"preferences_div" class\x3d"readOnly property" style\x3d"display:none;"\x3e\r\n        \x3clabel\x3e\x3cstrong\x3e${i18n.preferencesLabel}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3ca class\x3d"linkNoHref" data-dojo-attach-event\x3d"onClick:_openEsriPreferences"\x3e${i18n.preferencesLink}\x3c/a\x3e ${i18n.preferencesLinkDesc} \x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_manageLinkedAccounts" class\x3d"property hide"\x3e\r\n        \x3clabel\x3e\x3cstrong\x3e${i18n.linkYourArcgisAccounts}\x3c/strong\x3e\x3c/label\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3ca class\x3d"linkNoHref" data-dojo-attach-event\x3d"onClick:_openManageAccounts"\x3e${i18n.manageLinkedAccounts}\x3c/a\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1 ownerOnly userProfileColumn"\x3e\r\n      \x3cdiv id\x3d"new_password_edit" style\x3d"display:none;"\x3e\r\n        \x3cdiv id\x3d"oAuthChangePwd" class\x3d"property"\x3e\r\n          \x3cspan\x3e\x3cstrong\x3e${i18n.newPwdLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n          \x3cdiv\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_changePwdBtn" data-dojo-type\x3d"dijit/form/Button"\r\n                    class\x3d"calcite tertiary small" data-dojo-attach-event\x3d"onClick:onChangePassword"\x3e\r\n              ${i18n.changePwd}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"nonOAuthChangePwd" class\x3d"property" style\x3d"display:none;"\x3e\r\n          \x3cspan\x3e\x3cstrong\x3e${i18n.changePwdLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin3 esriTrailingMargin3" id\x3d"newPassword" data-dojo-attach-point\x3d"newPassword"\r\n               data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true,type:\'password\'"\x3e\x3c/div\x3e\r\n          \x3cbr style\x3d"clear:both;"\x3e\r\n          \x3cdiv class\x3d"esriLeadingMargin3 esriTrailingMargin3" data-dojo-attach-point\x3d"verifyNewPassword"\r\n               data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true, type:\'password\'"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"mfa_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.multiFactorAuth}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"mfa_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnly"\x3e\r\n          \x3cbutton data-dojo-attach-point\x3d"_enableMFA" data-dojo-type\x3d"dijit/form/Button" class\x3d"calcite tertiary small"\r\n                  data-dojo-attach-event\x3d"onClick:onEnableMFA"\x3e${i18n.enable}\x3c/button\x3e\r\n          \x3cbutton data-dojo-attach-point\x3d"_disableMFA" data-dojo-type\x3d"dijit/form/Button" class\x3d"calcite caution small"\r\n                  data-dojo-attach-event\x3d"onClick:onDisableMFA"\x3e${i18n.disable}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"question_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e\x3clabel for\x3d"security-question"\x3e${i18n.questionLabel}\x3c/label\x3e\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv class\x3d"arrowSpaceMedium" style\x3d"width:300px;" id\x3d"security-question" data-dojo-attach-point\x3d"questionSelect"\r\n             data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n        \x3cspan class\x3d"red-asterisk hide" data-dojo-attach-point\x3d"_securityQuestionRequired"\x3e*\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"answer_edit" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e\x3clabel for\x3d"security-answer"\x3e${i18n.answerLabel}\x3c/label\x3e\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv id\x3d"security-answer" data-dojo-attach-point\x3d"questionAnswer"\r\n             data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"trim:true, type:\'text\'"\x3e\x3c/div\x3e\r\n        \x3cspan class\x3d"red-asterisk hide" data-dojo-attach-point\x3d"_securityAnswerRequired"\x3e*\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.whoSeeProfile}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly" data-dojo-attach-point\x3d"label_privacy"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editOnlyBtn" data-dojo-attach-point\x3d"edit_privacy" style\x3d"display:none;"\x3e\r\n          \x3cspan id\x3d"privacy_public_span"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" name\x3d"privacy" id\x3d"privacy_public"/\x3e\r\n            \x3clabel for\x3d"privacy_public"\x3e${i18n.everyone}\x3c/label\x3e\r\n            \x3cbr\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan id\x3d"privacy_organization_span"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" name\x3d"privacy" id\x3d"privacy_account"/\x3e\r\n            \x3clabel for\x3d"privacy_account"\x3e${i18n.organization}\x3c/label\x3e\r\n            \x3cbr\x3e\r\n          \x3c/span\x3e\r\n          \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" name\x3d"privacy" id\x3d"privacy_private"/\x3e\r\n          \x3clabel for\x3d"privacy_private"\x3e${i18n.privateLabel}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"language_edit" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e\x3clabel for\x3d"languageSelect"\x3e${i18n.languageLabel}\x3c/label\x3e\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"language_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv id\x3d"languageSelect" class\x3d"editOnly arrowSpaceMedium" data-dojo-attach-point\x3d"languageSelect"\r\n             data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\',required:false"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"languageFormatContainer" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\r\n          \x3cstrong\x3e\x3clabel for\x3d"languageFormatSelect"\x3e${i18n.numDateFormat}\x3c/label\x3e\x3c/strong\x3e\r\n          \x3cspan id\x3d"languageFormatTooltip"\x3e\x3ca id\x3d"languageFormatHelpLink" target\x3d"_blank"\x3e\x3cimg class\x3d"help-icon" data-dojo-attach-point\x3d"_languageFormatHelpImg" src\x3d"" alt\x3d"${i18n.learnNumDateFormat}"\x3e\x3c/a\x3e\x3c/span\x3e\r\n        \x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"language_format_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv id\x3d"languageFormatSelect" class\x3d"editOnly arrowSpaceMedium" data-dojo-attach-point\x3d"languageFormatSelect"\r\n             data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\',required:false"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"region_edit" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.regionLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks readOnly editOrgOnly" data-dojo-attach-point\x3d"region_setting"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"editNonOrgOnly" data-dojo-attach-point\x3d"regionSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"units_edit" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e\x3clabel for\x3d"unitsSelect"\x3e${i18n.unitsLabel}\x3c/label\x3e\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"readOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"units_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cdiv id\x3d"unitsSelect" class\x3d"editOnly arrowSpaceMedium" data-dojo-attach-point\x3d"unitsSelect"\r\n             data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"landing_page_edit" class\x3d"ownerOnly property"\x3e\r\n        \x3cspan class\x3d"readOrgOnly"\x3e\x3cstrong\x3e\x3clabel for\x3d"landingPageSelect"\x3e${i18n.landingPageLabel}\x3c/label\x3e\x3c/strong\x3e\x3cbr\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"readOrgOnly esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"landing_page_setting"\x3e\x3c/span\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"editOrgOnly"\x3e\x3cstrong\x3e\x3clabel for\x3d"landingPageSelect"\x3e${i18n.landingPageEditLabel}\x3c/label\x3e\x3c/strong\x3e\x3cbr\x3e\x3c/span\x3e\r\n        \x3cdiv id\x3d"landingPageSelect" class\x3d"editOrgOnly arrowSpaceMedium" data-dojo-attach-point\x3d"landingPageSelect"\r\n             data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"type:\'select\'"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_level_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.levelLabel}\x3c/strong\x3e\x3cbr\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"organization_level"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_role_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.roleLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_role"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_link_div" class\x3d"property"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.orgLabel}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_link"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"organization_url_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.orgHomeurl}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan class\x3d"esriItemLinks"\x3e\x3cspan data-dojo-attach-point\x3d"organization_url_link"\x3e\x3c/span\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"credits_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.availableCredits}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"available_credits"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"licensed_for_div" class\x3d"property" style\x3d"display:none;"\x3e\r\n        \x3cspan\x3e\x3cstrong\x3e${i18n.licensedProducts}\x3c/strong\x3e\x3c/span\x3e\x3cbr\x3e\r\n        \x3cdiv id\x3d"licensed_products_list"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\x26nbsp;\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"editOnlyBtn bottomButtonBar" style\x3d"display:none;"\x3e\r\n    \x3cdiv id\x3d"lowerProfileSaveButton" class\x3d"dijitInline calcite blue" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_saveEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.save}\x3c/div\x3e\r\n    \x3cdiv id\x3d"lowerProfileCancelButton" class\x3d"dijitInline calcite transparent" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-event\x3d"onClick:_cancelEdit"\r\n         data-dojo-props\x3d"type:\'button\'"\x3e${i18n.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"editForm" method\x3d"post" enctype\x3d"multipart/form-data" onSubmit\x3d"return false;"\x3e\r\n    \x3c!-- generating form fields dynamically --\x3e\r\n\r\n    \x3c!-- not generating thumbnail field dynamically, need to do it here in dialog --\x3e\r\n    \x3cdiv id\x3d"profile-thumbnail-dialog" class\x3d"thumbnailDialog dijitDialog"\x3e\r\n      \x3cdiv id\x3d"profile-thumbnail-header"\x3e\r\n        \x3cdiv class\x3d"dijitDialogTitle dijitDialogTitleBar"\x3e\r\n          ${i18n.uploadThumbnail}\r\n        \x3c/div\x3e\r\n        \x3cdiv id\x3d"profile-thumbnail-close" title\x3d"${i18n.close}" class\x3d"dijitDialogCloseIcon"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv id\x3d"profile-thumbnail-content"\x3e\r\n        \x3cp\x3e\r\n          \x3cspan\x3e\r\n            \x3clabel for\x3d"profile-thumbnail-file"\x3e\r\n              ${i18n.specifyImage}\r\n            \x3c/label\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"thumbnailInputContainer"\x3e\r\n          \x3cspan class\x3d"profile-thumbnail-file-label"\x3e\r\n            \x3clabel for\x3d"profile-thumbnail-file"\x3e\r\n              ${i18n.imageLabel}\r\n            \x3c/label\x3e\r\n          \x3c/span\x3e\r\n          \x3cinput type\x3d"hidden" name\x3d"MAX_FILE_SIZE" value\x3d"1024000"\x3e\x3cinput type\x3d"file" id\x3d"profile-thumbnail-file" name\x3d"thumbnail" size\x3d"44" data-dojo-attach-point\x3d"thumbnailPath"\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"leader-15"\x3e\r\n          \x3cspan\x3e${i18n.forBestResults}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"leader-15"\x3e\r\n          \x3cbutton id\x3d"profile-thumbnail-cancel" class\x3d"jevent esriFloatTrailing calcite transparent" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n            ${i18n.cancel}\r\n          \x3c/button\x3e\r\n          \x3cbutton id\x3d"profile-thumbnail-ok" class\x3d"jevent esriFloatTrailing calcite blue" data-dojo-type\x3d"dijit/form/Button"\x3e\r\n            ${i18n.ok}\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cbr style\x3d"clear: both;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/SaveItem.html":'\x3cdiv class\x3d"${baseClass}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n\r\n  \x3clabel class\x3d"calcite-web-label trailer-half calcite-web-label-textbox"\x3e\r\n    ${i18n.titleLabel}\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemTitle"\r\n         data-dojo-type\x3d"dijit/form/TextBox"\r\n         placeHolder\x3d"${i18n.defaultTextTitle}" trim\x3d"true"\x3e\x3c/div\x3e\r\n\r\n  \x3c/label\x3e\r\n  \x3clabel class\x3d"calcite-web-label trailer-half clearfix"\x3e\r\n    ${i18n.tagsLabel}\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemTags"\r\n         data-dojo-type\x3d"esri/dijit/Tags"\r\n         data-dojo-props\x3d"minWidth:\'100%\',maxWidth:\'100%\'"\x3e\x3c/div\x3e\r\n\r\n  \x3c/label\x3e\r\n  \x3cdiv class\x3d"categories-container"\x3e\r\n    \x3clabel class\x3d"calcite-web-label trailer-0 clearfix categories-container"\r\n      data-dojo-attach-point\x3d"saveItemCategoriesContainer"\r\n      for\x3d"saveItemCategoryPicker"\x3e\r\n      ${i18n.categoriesLabel}\r\n    \x3c/label\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemCategories" id\x3d"saveItemCategoryPicker"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3clabel class\x3d"calcite-web-label trailer-half calcite-web-label-textbox"\x3e\r\n    ${i18n.summaryLabel}\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemSummary"\r\n         data-dojo-type\x3d"dijit/form/TextBox"\r\n         placeHolder\x3d"${i18n.defaultTextSummary}" maxlength\x3d"250" trim\x3d"true"\x3e\x3c/div\x3e\r\n\r\n  \x3c/label\x3e\r\n  \x3clabel class\x3d"calcite-web-label trailer-half calcite-web-label-select" for\x3d"itemFolderComboBox"\x3e\r\n    ${i18n.saveInFolderLabel}\r\n    \x3cdiv data-dojo-attach-point\x3d"saveItemFolder"\r\n         data-dojo-type\x3d"arcgisonline.sharing.dijit.ComboBox"\r\n         data-dojo-attach-event\x3d"onChange:_onFolderChange"\r\n         id\x3d"itemFolderComboBox"\x3e\x3c/div\x3e\r\n  \x3c/label\x3e\r\n\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/InvitationsDlg.html":'\x3cdiv\x3e\r\n  \t\x3cdiv data-dojo-type\x3d"dijit/Dialog" class\x3d"${baseClass} invitations-dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.invitationsDlgTitle}"\x3e\r\n      \x3cdiv class\x3d"trailer-half"\x3e${i18n.invitationMsg}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${baseClass} invitations-container padding-leader-quarter"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_invitationsGridContainer"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"clearfix"\x3e\r\n        \x3cdiv class\x3d"esriFloatTrailing right" style\x3d"padding-top:1rem; padding-bottom:5px;"\x3e\r\n          \x3cbutton data-dojo-attach-point\x3d"_closeBtn" class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button" tabIndex\x3d"1"\x3e${i18n.close}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/InvitationsDlgGroup.html":'\x3cdiv class\x3d"avenir-regular"\x3e\r\n  \x3cdiv class\x3d"panel panel-white panel-no-padding padding-leader-half padding-trailer-quarter padding-left-1 padding-right-1 border-bottom-clear"\x3e\r\n    \x3cdiv class\x3d"left"\x3e\r\n      \x3cdiv class\x3d"inline-block  ${isPrivate:show}"\x3e\r\n        \x3ca href\x3d"group.html?id\x3d${id}" class\x3d"card-image-small display-block margin-right-1 margin-left-0 group-card-thumbnail" title\x3d"${i18n.GroupsWidget.viewGroupDetails}"\x3e\r\n          \x3cimg src\x3d"${thumbnailUrl}" alt\x3d"${title}" class\x3d"${thumbnail:hide}"\x3e\r\n          \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"65" height\x3d"65" viewBox\x3d"0 0 65 65" class\x3d"${thumbnail:show}"\x3e\r\n            \x3cpath fill\x3d"${fillColor}" d\x3d"M0 0h65v65H0z"/\x3e\r\n            \x3cpath fill\x3d"#ccc" d\x3d"M0 0h65v65H0z" fill-opacity\x3d"0.8"/\x3e\r\n            \x3cpath class\x3d"${useLetter:show}" fill\x3d"#FFF" d\x3d"M24.25 15.625a6.875 6.875 0 1 0-.008 13.75 6.875 6.875 0 0 0 .008-13.75zm0 11c-2.272 0-4.125-1.851-4.125-4.125s1.848-4.125 4.125-4.125c2.279 0 4.125 1.846 4.125 4.125s-1.846 4.125-4.125 4.125zm3.118 16.5H14.774c.596-4.641 4.647-8.25 9.473-8.25 2.855 0 5.426 1.283 7.188 3.316a15.168 15.168 0 0 1 2.311-1.518 12.22 12.22 0 0 0-9.496-4.549c-6.369 0-11.551 4.82-12.238 11l-.137 2.75h14.424a15.49 15.49 0 0 1 1.066-2.75h.003zm25.62 5.5c-.693-6.18-5.873-11-12.238-11s-11.545 4.82-12.238 11l-.137 2.75h24.75l-.137-2.75zm-21.711 0c.596-4.641 4.647-8.25 9.473-8.25a9.578 9.578 0 0 1 9.464 8.25H31.277zm9.473-27.5a6.875 6.875 0 1 0-.008 13.75c3.797.003 6.877-3.072 6.88-6.87s-3.072-6.877-6.869-6.88h-.003zm0 11c-2.271 0-4.125-1.851-4.125-4.125s1.848-4.125 4.125-4.125a4.125 4.125 0 0 1 0 8.25z"/\x3e\r\n            \x3ctext class\x3d"${useLetter:hide} font-size-4" x\x3d"50%" y\x3d"50%" fill\x3d"white" dominant-baseline\x3d"central" text-anchor\x3d"middle"\x3e\r\n              \x3ctspan class\x3d"group-thumbnail-default-text" dominant-baseline\x3d"central" text-anchor\x3d"middle"\x3e${title:firstChar}\x3c/tspan\x3e\r\n              \x3ctspan class\x3d"group-thumbnail-ie-text" y\x3d"70%" x\x3d"55%" dominant-baseline\x3d"central" text-anchor\x3d"middle"\x3e${title:firstChar}\x3c/tspan\x3e\r\n            \x3c/text\x3e\r\n          \x3c/svg\x3e\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"inline-block  ${isPrivate:hide}"\x3e\r\n        \x3cdiv class\x3d"card-image-small display-block margin-right-1 margin-left-0 group-card-thumbnail"\x3e\r\n          \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"65" height\x3d"65" viewBox\x3d"0 0 65 65" class\x3d"${thumbnail:show}"\x3e\r\n            \x3cpath fill\x3d"#AAA" d\x3d"M0 0h65v65H0z"/\x3e\r\n            \x3cpath fill\x3d"#ccc" d\x3d"M0 0h65v65H0z" fill-opacity\x3d"0.8"/\x3e\r\n            \x3cpath fill\x3d"#FFF" d\x3d"M42.5 30.5h-20c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2v-14c0-1.1-.9-2-2-2zm0 16h-20v-14h20v14zm-14-20c0-2.205 1.794-4 4-4s4 1.795 4 4v4h2v-4c0-3.309-2.691-6-6-6s-6 2.691-6 6v4h2v-4zm-4 0c0-4.4 3.6-8 8-8s8 3.6 8 8v4h2v-4c0-5.514-4.486-10-10-10s-10 4.486-10 10v4h2v-4zm10 12v-2h-2v-2h-2v10h2v-2h2v-2h-2v-2h2z"/\x3e\r\n          \x3c/svg\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"group-card-content border-box right"\x3e\r\n      \x3ch4 class\x3d"trailer-0 leader-quarter font-size-1 full-width text-ellipsis margin-right-1"\x3e\r\n        \x3ca href\x3d"group.html?id\x3d${id}" title\x3d"${title}" class\x3d"text-ellipsis ${isPrivate:show}"\x3e${title:stripHTML}\x3c/a\x3e\r\n        \x3cspan class\x3d"text-ellipsis ${isPrivate:hide}" title\x3d"${title}"\x3e${title:stripHTML}\x3c/span\x3e\r\n      \x3c/h4\x3e\r\n      \x3cp class\x3d"trailer-0"\x3e${notificationSummary}\x3c/p\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"panel panel-no-padding padding-leader-quarter padding-trailer-quarter padding-left-quarter padding-right-quarter clearfix"\x3e\r\n    \x3cdiv class\x3d"right"\x3e\r\n      \x3cbutton class\x3d"js-accept-invitation btn btn-link btn-link-off-black margin-right-1 margin-left-0 inline-block icon-esri-user-approve"\x3e${i18n.invitationsGrid.joinThisGroup}\x3c/button\x3e\r\n      \x3cbutton class\x3d"js-decline-invitation btn btn-link btn-link-off-black margin-right-1 margin-left-0 inline-block icon-esri-user-deny"\x3e${i18n.invitationsGrid.decline}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/InviteUsersDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_dialog" data-dojo-type\x3d"dijit/Dialog" id\x3d"invite-users-dialog" title\x3d"${i18n.inviteUsersTitle}" class\x3d"invite-user-dlg orgDlg"\x3e\r\n    \x3cdiv id\x3d"invite-users-search" data-dojo-attach-point\x3d"_userSelector"\r\n         data-dojo-type\x3d"arcgisonline/sharing/dijit/UserSelector"\r\n         data-dojo-props\x3d"restrictSearch: true, excludeCurrentUser: true, capResults: 1000"\x3e\x3c/div\x3e\r\n    \x3cfieldset class\x3d"admin" style\x3d"margin:1em 0 0 0;display:none;"\x3e\r\n      \x3clabel style\x3d"vertical-align:top;" for\x3d"addNow"\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_addNowChk" id\x3d"addNow" name\x3d"addNow"\r\n               type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n        ${i18n.addNow}\r\n      \x3c/label\x3e\r\n    \x3c/fieldset\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing right leader-1" style\x3d"padding-top:0; padding-bottom:5px;"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_submit" id\x3d"button_send-invite"\r\n              class\x3d"calcite blue small" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.sendInvitation}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancel" id\x3d"button_invite-users-close"\r\n              class\x3d"calcite transparent small btn-clear cancel" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr\x3e\x26nbsp;\x3cbr\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/JoinGroupDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"join_group-dialog" title\x3d"${i18n.joinGroupTitle}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_joinGroupContent"\x3e\r\n      ${i18n.yourRequestForReview}\r\n      \x3cbr\x3e\r\n      ${i18n.youCanCheckStatus}\r\n    \x3c/div\x3e\r\n    \x3cbr\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing right leader-1"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_okBtn" class\x3d"btn btn-blue"\x3e${i18n.submitRequest}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" class\x3d"btn btn-clear"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/ManageTilesDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${baseClass} manage-tiles-dialog js-tab-group" data-dojo-type\x3d"dijit/Dialog"\r\n       data-dojo-attach-point\x3d"dialog" title\x3d"${i18n.dialogTitle}"\x3e\r\n    \x3cnav class\x3d"tab-nav" data-dojo-attach-point\x3d"_tabNav"\x3e\r\n      \x3ca class\x3d"tab-title js-tab is-active" data-dojo-attach-point\x3d"_levelsTab"\x3e${i18n.levelsTab}\x3c/a\x3e\r\n      \x3ca class\x3d"tab-title js-tab" data-dojo-attach-point\x3d"_extentTab"\x3e${i18n.extentTab}\x3c/a\x3e\r\n    \x3c/nav\x3e\r\n\r\n    \x3csection class\x3d"tab-contents"\x3e\r\n      \x3carticle class\x3d"tab-section js-tab-section is-active" data-dojo-attach-point\x3d"_levelsSection"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_dialogDescription"\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cdiv class\x3d"selected-scales-container"\x3e\x3cspan data-dojo-attach-point\x3d"_scalesSelectedSpan"\x3e\x3c/span\x3e\x3cbr\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"scaleContainer" data-dojo-attach-point\x3d"_gridContainer"\x3e\x3c/div\x3e\r\n      \x3c/article\x3e\r\n      \x3carticle class\x3d"tab-section js-tab-section" data-dojo-attach-point\x3d"_extentSection"\x3e\r\n        \x3c!-- Add Extent UI here --\x3e\r\n        \x3cdiv class\x3d"extentContainer hide" data-dojo-attach-point\x3d"_extentContainer"\x3e\x3c/div\x3e\r\n      \x3c/article\x3e\r\n    \x3c/section\x3e\r\n\r\n    \x3cdiv class\x3d"controlDiv clearfix" data-dojo-attach-point\x3d"_controlDiv"\x3e\r\n      \x3cdiv class\x3d"left messageContainer"\x3e\r\n        \x3cdiv class\x3d"message" data-dojo-attach-point\x3d"_messageDiv"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right buildContainer"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_buildButton" class\x3d"calcite secondary btn btn-blue"\x3e${i18n.buildButton}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"calcite secondary btn btn-blue hide"\x3e${i18n.cancelButton}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"_closeButton" class\x3d"calcite transparent btn btn-clear"\x3e${i18n.close}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/MembershipRequestsDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" class\x3d"${baseClass} membership-requests-dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.membershipRequests}"\x3e\r\n    \x3cdiv class\x3d"membership-requests-label"\x3e${i18n.requestedMemberShip}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${baseClass} requests-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_requestsGridContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"\x3e\r\n    \x3cdiv class\x3d"esriFloatTrailing right" style\x3d"padding-top:1rem;padding-bottom:5px;"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_closeBtn" class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button"\x3e${i18n.close}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr/\x3e\x26nbsp;\x3cbr/\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/SelectAccountUserDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv class\x3d"${baseClass}" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" id\x3d"select-account-user-dialog" title\x3d"${i18n.selectUser}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_selectUserContent"\x3e\r\n      Select a user.\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-half"\x3e\r\n      \x3cselect id\x3d"userList" data-dojo-attach-point\x3d"_userList" data-dojo-type\x3d"dijit/form/ComboBox" value\x3d"${i18n.selectUserLabel}"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-1 right"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_selectUserBtn" class\x3d"btn btn-blue"\x3e${i18n.selectUser}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" class\x3d"btn btn-clear"\x3e${i18n.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr style\x3d"clear:both;"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/dialog/templates/MoveToFolderDlg.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\r\n  \x3cdiv class\x3d"js-folder-list move-folder-list"\x3e\r\n    \x3cinput class\x3d"filter-dropdown-input" type\x3d"search" placeholder\x3d"${i18n.itemProperties.filterFolders}" aria-controls\x3d"moveFolderList" aria-label\x3d"${i18n.itemProperties.filterFolders}"\x3e\r\n    \x3cdiv id\x3d"moveFolderList" class\x3d"filter-dropdown-inner-list js-folders" aria-live\x3d"polite" role\x3d"radiogroup" aria-label\x3d"${i18n.itemProperties.moveToFolder}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform class\x3d"js-createFolder-form padding-leader-half"\x3e\r\n    \x3clabel class\x3d"trailer-0"\x3e\r\n      ${i18n.itemProperties.createFolder}\r\n    \x3cdiv class\x3d"input-group"\x3e\r\n      \x3cinput name\x3d"folderName" maxlength\x3d"50" class\x3d"js-folderName input-group-input" placeholder\x3d"${i18n.itemProperties.folderName}" type\x3d"text" aria-label\x3d"${i18n.itemProperties.createFolder}" /\x3e\r\n      \x3cspan class\x3d"input-group-button"\x3e\r\n        \x3cbutton class\x3d"js-createFolder btn btn-clear"\x3e${i18n.items.create}\x3c/button\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3c/label\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/AccountMoveToDlg.html":'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/Dialog" id\x3d"account-move-to-dialog" data-dojo-attach-point\x3d"_dialog" title\x3d"${i18n.changeOwner}"\x3e\r\n    \x3cdiv class\x3d"leader-1"\x3e\r\n      \x3cspan\x3e${i18n.moveSelectedItems}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cselect class\x3d"user-list" data-dojo-attach-point\x3d"userList" data-dojo-type\x3d"dijit/form/ComboBox"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-1 hide"\x3e\r\n      \x3cspan class\x3d"userFound"\x3e${i18n.selectFolderToMove}\x3c/span\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" class\x3d"borderedContent userNotFound"\r\n           data-dojo-props\x3d"gutters:false,design:\'headline\'" data-dojo-attach-point\x3d"userNotFound"\x3e${i18n.userNotFound}\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" class\x3d"borderedContent dijitTreeBorderedContent userFound userFolderContainer"\r\n           data-dojo-props\x3d"gutters:false,design:\'headline\',preventcache:\'true\',usecache:\'false\',cachecontent:\'false\',splitter:false"\r\n           data-dojo-attach-point\x3d"userFolderContainer"\x3e\x3c/div\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_newFolderBtn" class\x3d"jevent userFound btn-icon-left btn-icon-folder"\r\n              data-dojo-type\x3d"dijit/form/Button" type\x3d"button" data-dojo-props\x3d"iconClass:\'esriNewFolderIcon\'"\x3e\r\n        ${i18n.newFolder}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"leader-1 userFound"\x3e${i18n.selectFolderToMove}\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_moveToFolderContainer"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"right leader-1 clearfix rtl-padding-left-1"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_okBtn" class\x3d"jevent primary" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e\r\n        ${i18n.changeOwner}\r\n      \x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelBtn" class\x3d"jevent cancel" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e\r\n        ${i18n.cancel}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/form/resources/TriStateCheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dojoxTriStateCheckBoxInner" dojoAttachPoint\x3d"stateLabelNode"\x3e\x3c/div\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" dojoAttachPoint\x3d"focusNode"\r\n\tclass\x3d"dijitReset dojoxTriStateCheckBoxInput" dojoAttachEvent\x3d"onclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/dialog/templates/RateLimiting.html":'\x3cdiv\x3e\r\n  \x3cdiv id\x3d"rateLimiting" class\x3d"rateLimiting"\x3e\r\n    \x3cp\x3e${i18n.rateLimiting.instructions}\x3c/p\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_enableLimits" type\x3d"checkbox" value\x3d"true" name\x3d"enableRateLimiting"/\x3e\r\n    \x3clabel class\x3d"esriLeadingMargin05 esriTrailingMargin1 inline-block trailer-half" for\x3d"referrerUri"\x3e${i18n.rateLimiting.hitRate}\x3c/label\x3e\r\n    \x3cdiv class\x3d"rateLimitingDiv esriLeadingMargin108 clearfix"\x3e\r\n      \x3cinput class\x3d"hitRate" value\x3d"1000"\r\n        data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n        data-dojo-attach-point\x3d"_hitRate"\r\n        data-dojo-props\x3d"disabled:true, rangeMessage:\'${i18n.rateLimiting.hitRateRangeMessage}\', invalidMessage:\'${i18n.rateLimiting.hitRateInvalidMessage}\',constraints:{min:1, max:1000000, places:0}" /\x3e\r\n      \x3clabel class\x3d"canDisable esriLeadingMargin1 esriTrailingMargin1 inline-block left leader-half trailer-0 padding-right-half" for\x3d"referrerUri"\x3e\r\n        ${i18n.rateLimiting.per}\r\n      \x3c/label\x3e\r\n      \x3cinput class\x3d"hitRate" value\x3d"1"\r\n        data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n        data-dojo-attach-point\x3d"_hitCount"\r\n        data-dojo-props\x3d"disabled:true, rangeMessage:\'${i18n.rateLimiting.hitRateRangeMessage}\', invalidMessage:\'${i18n.rateLimiting.hitRateInvalidMessage}\', constraints:{min:1, max:1000000, places:0}"/\x3e\r\n\r\n      \x3cselect class\x3d"esriUnits left inline-block" data-dojo-attach-point\x3d"_interval" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"disabled:true" style\x3d"width:8.75em;"\x3e\r\n        \x3coption value\x3d"1"\x3e${i18n.rateLimiting.second}\x3c/option\x3e\r\n        \x3coption value\x3d"60"\x3e${i18n.rateLimiting.minute}\x3c/option\x3e\r\n        \x3coption value\x3d"3600"\x3e${i18n.rateLimiting.hour}\x3c/option\x3e\r\n        \x3coption value\x3d"86400"\x3e${i18n.rateLimiting.day}\x3c/option\x3e\r\n        \x3coption value\x3d"604800"\x3e${i18n.rateLimiting.week}\x3c/option\x3e\r\n        \x3coption value\x3d"2628000"\x3e${i18n.rateLimiting.month}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cbr /\x3e\r\n    \x3clabel class\x3d"esriTrailingMargin05 trailer-half" for\x3d"referrerUri"\x3e${i18n.rateLimiting.referrerUri}\x3c/label\x3e\r\n    \x3cdiv class\x3d"clearfix"\x3e\r\n      \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"_referrerUrl" data-dojo-props\x3d"placeHolder:\'${i18n.registerApp.urlPlaceHolder}\'" type\x3d"text" class\x3d"left referrerUrl"/\x3e\r\n      \x3cbutton class\x3d"calcite small cancel" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_delBtn" data-dojo-props\x3d"disabled:true, label:\'${i18n.registerApp.del}\'"\x3e\x3c/button\x3e\r\n      \x3cbutton class\x3d"calcite small cancel" data-dojo-type\x3d"dijit/form/Button" data-dojo-attach-point\x3d"_addBtn" data-dojo-props\x3d"label:\'${i18n.registerApp.add}\'"\x3e\x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin93 trailer-half referralUris" data-dojo-type\x3d"dijit/form/MultiSelect" data-dojo-attach-point\x3d"_referrers" data-dojo-props\x3d"size:4, name:\'referral_uris\'"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/AddItemDlg.html":'\x3cform data-dojo-attach-point\x3d"containerNode" enctype\x3d"multipart/form-data" action\x3d"" method\x3d"POST" autocomplete\x3d"off"  data-dojo-attach-event\x3d"onsubmit:onSubmit"\x3e\r\n\x3cdiv data-dojo-attach-point\x3d"formNode" class\x3d"esriItemLinks dijitDialogPaneContentArea"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_instructions" class\x3d"addNew"\x3e${i18n.instructions}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_publishInstructions" class\x3d"publishOld trailer-half" style\x3d"display:none;"\x3e${i18n.publishInstructions}\x3c/div\x3e\r\n    \x3cbr /\x3e\r\n    \x3cfieldset class\x3d"addNew"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"addItemLbl" for\x3d"itemType"\x3e${i18n.itemType}\x3c/label\x3e\r\n        \x3cselect id\x3d"itemType" data-dojo-attach-point\x3d"itemType" class\x3d"wideselect"  data-dojo-type\x3d"dijit/form/Select" name\x3d\'itemType\' data-dojo-observer\x3d"changeType, changePlaceholder, deleteGrid"\x3e\r\n           \x3coption value\x3d"file" selected\x3e${i18n.itemTypeCpu}\x3c/option\x3e\r\n           \x3coption value\x3d"url"\x3e${i18n.itemTypeWeb}\x3c/option\x3e\r\n           \x3coption value\x3d"app"\x3e${i18n.itemTypeApp}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n        \x3cdiv class\x3d"type app" style\x3d"display:none;"\x3e\r\n            \x3clabel class\x3d"trailer-0 leader-half"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n            \x3cdiv class\x3d"indent"\x3e\r\n                \x3cinput id\x3d"apimap" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" name\x3d"app" value\x3d"apimap" checked data-dojo-observer\x3d"changeApiType, changePlaceholder" /\x3e\r\n                \x3clabel for\x3d"apimap" class\x3d"trailer-0 inline-block"\x3e${i18n.appMap}\x3c/label\x3e\r\n                \x3cinput id\x3d"apimobile" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio margin-left-1" name\x3d"app" value\x3d"apimobile" data-dojo-observer\x3d"changeApiType, changePlaceholder" /\x3e\r\n                \x3clabel for\x3d"apimobile" class\x3d"trailer-0 inline-block"\x3e${i18n.appMobile}\x3c/label\x3e\r\n                \x3cinput id\x3d"app" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly margin-left-1" name\x3d"app" value\x3d"desktopapplication" data-dojo-observer\x3d"changeApiType"/\x3e\r\n                \x3clabel for\x3d"app" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.desktop}\x3c/label\x3e\r\n                \x3cinput id\x3d"apiapp" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly margin-left-1" name\x3d"app" value\x3d"apiapp" data-dojo-observer\x3d"changeApiType" /\x3e\r\n                \x3clabel for\x3d"apiapp" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.appApplication}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"indent esriLeadingMargin73 orgOnly adminOnly" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"opext" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly adminOnly" name\x3d"app" value\x3d"opext" data-dojo-observer\x3d"changeApiType" /\x3e\r\n                \x3clabel for\x3d"opext" class\x3d"orgOnly adminOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.opExtension}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"indent esriLeadingMargin73 orgOnly adminOnly portalAppExtension" style\x3d"display:none;"\x3e\r\n                \x3cinput id\x3d"appbldrext" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" class\x3d"radio orgOnly adminOnly" name\x3d"app" value\x3d"appbldrext" data-dojo-observer\x3d"changeApiType" /\x3e\r\n                \x3clabel for\x3d"appbldrext" class\x3d"orgOnly adminOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.appBldrExtension}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cfieldset class\x3d"type app api leader-half" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 inline-block left margin-right-1"\x3e\r\n             \x3clabel for\x3d"purpose" class\x3d"trailer-0"\x3e${i18n.itemPurpose}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"purpose" data-dojo-type\x3d"dijit/form/Select" name\x3d"purpose"\x3e\r\n                  \x3coption value\x3d"Ready To Use" selected\x3e${i18n.itemReady}\x3c/option\x3e\r\n                  \x3coption value\x3d"Configurable"\x3e${i18n.itemConfigurable}\x3c/option\x3e\r\n                  \x3coption value\x3d"selfConfigured"\x3e${i18n.itemSelfConfigurable}\x3c/option\x3e\r\n                  \x3coption value\x3d"Code Sample"\x3e${i18n.itemCode}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin2 apiType apimap inline-block margin-right-1 left"\x3e\r\n             \x3clabel for\x3d"desktopapi" class\x3d"trailer-0"\x3e${i18n.itemAPI}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"desktopapi" data-dojo-type\x3d"dijit/form/Select" name\x3d"desktopapi"\x3e\r\n                  \x3coption value\x3d"JavaScript" selected\x3e${i18n.itemJS}\x3c/option\x3e\r\n                  \x3coption value\x3d"Flex"\x3e${i18n.itemFlex}\x3c/option\x3e\r\n                  \x3coption value\x3d"Silverlight"\x3e${i18n.itemSL}\x3c/option\x3e\r\n                  \x3coption value\x3d"Web ADF"\x3e${i18n.itemADF}\x3c/option\x3e\r\n                  \x3coption value\x3d"Other"\x3e${i18n.itemOther}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin2 apiType apimobile inline-block left margin-right-1" style\x3d"display:none;"\x3e\r\n             \x3clabel for\x3d"mobileapi" class\x3d"trailer-0"\x3e${i18n.itemSDK}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"mobileapi" data-dojo-type\x3d"dijit/form/Select" name\x3d"mobileapi"\x3e\r\n                  \x3coption value\x3d"ArcGIS for Android"\x3e${i18n.itemAndroid}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for iPhone"\x3e${i18n.itemIOS}\x3c/option\x3e\r\n                  \x3coption value\x3d"JavaScript" selected\x3e${i18n.itemJS}\x3c/option\x3e\r\n                  \x3coption value\x3d"Flex"\x3e${i18n.itemFlex}\x3c/option\x3e\r\n                  \x3coption value\x3d"Windows Mobile"\x3e${i18n.itemMobile}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Phone"\x3e${i18n.itemWindows}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Store"\x3e${i18n.itemWindowsStore}\x3c/option\x3e\r\n                  \x3coption value\x3d"ArcGIS for Windows Universal"\x3e${i18n.itemWindowsUniversal}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan class\x3d"indent esriLeadingMargin73 esriLeadingMargin05 apiType desktopapplication inline-block margin-right-1 left" style\x3d"display:none;"\x3e\r\n             \x3clabel for\x3d"apidesktopapp" class\x3d"trailer-0"\x3e${i18n.itemPlatform}${i18n.colon}\x3c/label\x3e\r\n              \x3cselect id\x3d"apidesktopapp" data-dojo-type\x3d"dijit/form/Select" name\x3d"apidesktopapp"\x3e\r\n                  \x3coption value\x3d"Java"\x3eJava\x3c/option\x3e\r\n                  \x3coption value\x3d".NET\u2013Windows Desktop"\x3e.NET\u2013Windows Desktop\x3c/option\x3e\r\n                  \x3coption value\x3d"OS X" selected\x3eOS X\x3c/option\x3e\r\n                  \x3coption value\x3d"Qt"\x3eQt\x3c/option\x3e\r\n                  \x3coption value\x3d"WPF"\x3eWPF\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/span\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cdiv class\x3d"type file desktopapplication"\x3e\r\n            \x3clabel for\x3d"file" class\x3d"trailer-quarter leader-half"\x3e${i18n.itemFile}${i18n.colon}\x3c/label\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"fileDiv"\x3e\r\n              \x3cinput id\x3d"file" class\x3d"required" size\x3d"41" type\x3d"file" name\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n            \x3c/span\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"type url trailer-half" style\x3d"display:none;"\x3e\r\n            \x3clabel class\x3d"trailer-quarter leader-half"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n            \x3cdiv class\x3d"webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"ags" data-dojo-type\x3d"dijit/form/RadioButton" checked value\x3d"ags" class\x3d"radio" name\x3d"web" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"ags" class\x3d"inline-block trailer-0"\x3e${i18n.webService}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"kml" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"kml" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"kml" class\x3d"inline-block trailer-0"\x3e${i18n.webKML}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin73 webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"ogc" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"ogc" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"ogc" class\x3d"inline-block trailer-0"\x3e${i18n.webOGC}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"webWFS" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"wfs" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"webWFS" class\x3d"inline-block trailer-0"\x3e${i18n.webWFS}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriLeadingMargin73 webTypes block-group block-group-2-up"\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"webWMTS" data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"wmts" name\x3d"web" class\x3d"radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"webWMTS" class\x3d"inline-block trailer-0"\x3e${i18n.webWMTS}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"block"\x3e\r\n                \x3cinput id\x3d"document" data-dojo-type\x3d"dijit/form/RadioButton" style\x3d"display:none;" value\x3d"document" name\x3d"web" class\x3d"orgOnly radio" data-dojo-observer\x3d"changeServiceType, changePlaceholder, deleteGrid" /\x3e\r\n                \x3clabel for\x3d"document" class\x3d"orgOnly inline-block trailer-0" style\x3d"display:none;"\x3e${i18n.webDocument}\x3c/label\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"type url app api opext appbldrext" style\x3d"display:none;"\x3e\r\n          \x3clabel id\x3d"urlLbl" for\x3d"itemUrl" class\x3d"trailer-0"\x3e${i18n.itemURL}\x3c/label\x3e\r\n          \x3cinput dir\x3d"ltr" id\x3d"itemUrl" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" name\x3d"url" data-dojo-observer\x3d"_getUrlAndType" placeHolder\x3d"${i18n.urlRules}"\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--\x3ca data-dojo-attach-point\x3d"supportedItems" class\x3d"indent esriLeadingMargin73 nosvcauth all" target\x3d"_blank" href\x3d""\x3e${i18n.itemSupportedItems}\x3c/a\x3e--\x3e\r\n        \x3c!--\x3cbr /\x3e--\x3e\r\n        \x3cfieldset class\x3d"type svcauth indent esriLeadingMargin73 trailer-0 leader-half" style\x3d"display:none;"\x3e\r\n          \x3cdiv\x3e${i18n.secureservice}\x3c/div\x3e\r\n          \x3cdiv class\x3d"credentials"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"storecredentials"\x3e\r\n            \x3cdiv\x3e\r\n              \x3cinput id\x3d"nostoreauth" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" checked value\x3d"nostore" name\x3d"storeauth" data-dojo-observer\x3d"changeStoreCredentials" /\x3e\r\n              \x3clabel for\x3d"nostoreauth" class\x3d"wide display-inline"\x3e${!i18n.nostoreauth}\x3c/label\x3e\r\n              \x3cbr /\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv\x3e\r\n              \x3cinput id\x3d"storeauth" data-dojo-attach-point\x3d"_storeAuth" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio" value\x3d"store" name\x3d"storeauth" data-dojo-observer\x3d"changeStoreCredentials"/\x3e\r\n              \x3clabel for\x3d"storeauth" class\x3d"wide display-inline"\x3e${!i18n.storeauth}\x3c/label\x3e\r\n              \x3cbr /\x3e\r\n              \x3ca data-dojo-attach-point\x3d"learnMore" target\x3d"_blank" href\x3d""\x3e${i18n.learnMore}\x3c/a\x3e\r\n              \x3cbr /\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cspan class\x3d"indent type zip esriLeadingMargin73 inline-block leader-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"archiveSelect" class\x3d"trailer-0"\x3e${i18n.itemContents}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" id\x3d"archiveSelect" name\x3d"archiveSelect" data-dojo-observer\x3d"changeArchive"\x3e\r\n            \x3coption value\x3d"shapefile" selected\x3e${i18n.typeShapefile}\x3c/option\x3e\r\n            \x3coption value\x3d"filegeodatabase"\x3e${i18n.itemFileGeodatabase}\x3c/option\x3e\r\n            \x3coption value\x3d"dtemp"\x3e${i18n.typeDesktopTemplate}\x3c/option\x3e\r\n            \x3coption value\x3d"mtemp"\x3e${i18n.typeMapTemplate}\x3c/option\x3e\r\n            \x3coption value\x3d"gpsample"\x3e${i18n.typeGPSample}\x3c/option\x3e\r\n            \x3coption value\x3d"codesample"\x3e${i18n.itemCode}\x3c/option\x3e\r\n            \x3coption value\x3d"arcpadpackage"\x3e${i18n.itemArcPadPackage}\x3c/option\x3e\r\n            \x3coption value\x3d"caddrawing"\x3e${i18n.itemCadDrawing}\x3c/option\x3e\r\n            \x3coption value\x3d"csvcollection"\x3e${i18n.itemCsvCollection}\x3c/option\x3e\r\n            \x3coption value\x3d"kmlcollection"\x3e${i18n.itemKmlCollection}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type codesample esriLeadingMargin73 inline-block leader-half margin-left-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"codesample" class\x3d"trailer-0"\x3e${i18n.itemLanguage}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" name\x3d"codesample" id\x3d"codesample" style\x3d"width:120px;"\x3e\r\n            \x3coption value\x3d"C"\x3eC\x3c/option\x3e\r\n            \x3coption value\x3d"C#"\x3eC#\x3c/option\x3e\r\n            \x3coption value\x3d"C++"\x3eC++\x3c/option\x3e\r\n            \x3coption value\x3d"Java" selected\x3eJava\x3c/option\x3e\r\n            \x3coption value\x3d"Perl"\x3ePerl\x3c/option\x3e\r\n            \x3coption value\x3d"PHP"\x3ePHP\x3c/option\x3e\r\n            \x3coption value\x3d"Python"\x3ePython\x3c/option\x3e\r\n            \x3coption value\x3d"Ruby"\x3eRuby\x3c/option\x3e\r\n            \x3coption value\x3d"SQL"\x3eSQL\x3c/option\x3e\r\n            \x3coption value\x3d"VB"\x3eVB\x3c/option\x3e\r\n            \x3coption value\x3d"VB"\x3eWPF\x3c/option\x3e\r\n            \x3coption value\x3d"Other"\x3eOther\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type arcpadpackage esriLeadingMargin73 inline-block leader-half margin-left-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"arcpadpackage" class\x3d"trailer-0"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" name\x3d"arcpadpackage" id\x3d"arcpadpackage"\x3e\r\n            \x3coption value\x3d"ArcPad Project"\x3e${i18n.itemArcPadProject}\x3c/option\x3e\r\n            \x3coption value\x3d"ArcPad Template"\x3e${i18n.itemArcPadTemplate}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"indent type stylx esriLeadingMargin73 inline-block leader-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"stylx" class\x3d"trailer-0"\x3e${i18n.type}${i18n.colon}\x3c/label\x3e\r\n          \x3cselect data-dojo-type\x3d"dijit/form/Select" id\x3d"stylx" name\x3d"stylx"\x3e\r\n            \x3coption value\x3d"2d"\x3e${i18n.2d}\x3c/option\x3e\r\n            \x3coption value\x3d"3d"\x3e${i18n.3d}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/span\x3e\r\n    \x3c/fieldset\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"_publishServiceDiv" class\x3d"indent publish type esriLeadingMargin73" style\x3d"display:none;"\x3e\r\n      \x3cfieldset data-dojo-attach-point\x3d"_publishNode" class\x3d"type publish trailer-half"\x3e\r\n        \x3cinput id\x3d"enablePublishing" data-dojo-attach-point\x3d"_enablePublishing" name\x3d"enablePublishing" data-dojo-type\x3d"dijit/form/CheckBox" checked data-dojo-observer\x3d"onPublishCheck"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_enablePublishingLabel" for\x3d"enablePublishing" class\x3d"display-inline"\x3e${i18n.publishService}\x3c/label\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n    \x3cfieldset class\x3d"fieldset-checkbox"\x3e\r\n      \x3cdiv class\x3d"title trailer-1"\x3e\r\n        \x3clabel for\x3d"title"\x3e${i18n.itemTitle}${i18n.colon}\x3c/label\x3e\r\n        \x3cinput id\x3d"title" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" class\x3d"required" name\x3d"title" placeHolder\x3d"${i18n.titleRules}"\x3e\r\n        \x3cbr /\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide categories-container"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_categoriesLbl" class\x3d"trailer-0" for\x3d"addItemCategoryPicker"\x3e\r\n          ${i18n.categories}${i18n.colon}\r\n        \x3c/label\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_categoriesContainer" id\x3d"addItemCategoryPicker"\x3e\x3c/div\x3e\r\n\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"_tagsLbl" class\x3d"tagLbl" for\x3d"tags"\x3e${i18n.itemTags}${i18n.colon}\x3c/label\x3e\r\n        \x3cinput id\x3d"tags" data-dojo-attach-point\x3d"_tags" data-dojo-type\x3d"esri/dijit/Tags" class\x3d"required" name\x3d"tags" data-dojo-props\x3d"minWidth:\'450px\',maxWidth:\'450px\'"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n    \x3cdiv class\x3d\'subtable opextwarning opextwarningmsg esriLeadingMargin73\' style\x3d"display:none;"\x3e\r\n      \x3cdiv\x3e${i18n.opExtensionMsg}\x3c/div\x3e\r\n      \x3cul\x3e\r\n        \x3cli class\x3d"useDataFromView opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.useDataFromView}\x3c/li\x3e\r\n        \x3cli class\x3d"usePortalServices opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.usePortalServices}\x3c/li\x3e\r\n        \x3cli class\x3d"useExternalAGSServices opextwarningmsg" style\x3d"display:none;"\x3e${i18n.manifestWarnings.useExternalAGSServices}\x3c/li\x3e\r\n      \x3c/ul\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d\'subtable hosted\' style\x3d"display:none;"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_publishCSVDiv" class\x3d"publish type" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"allExcelSheets xlsx trailer-half" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"allExcelSheets" class\x3d"trailer-0"\x3e\x3cspan class\x3d"padding-right-1"\x3e${i18n.allExcelSheets}${i18n.colon}\x3c/span\x3e\r\n            \x3cselect id\x3d"allExcelSheets" data-dojo-attach-point\x3d"_allExcelSheets" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:375px;" maxHeight\x3d"200" name\x3d"allExcelSheets" data-dojo-attach-event\x3d"onChange:onChangeExcelSheet"\x3e\x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d\'csv xlsx trailer-half\' style\x3d"display:none;"\x3e\r\n          \x3cdiv class\x3d"padding-right-1 trailer-0"\x3e${i18nCSV.locateUsing}\x3c/div\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper csv xlsx portal noGeocode padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"locationTypes" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal noGeocode" name\x3d"geocode" value\x3d"locationTypes" checked data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.latLong}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper csv xlsx portal padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"addressTypes" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal" name\x3d"geocode"     value\x3d"addressTypes" data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.address}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"geocode-input-wrapper noGeocode csv xlsx portal tableOnly padding-right-1 trailer-0"\x3e\r\n            \x3cinput id\x3d"tableOnly" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"radio csv xlsx portal noGeocode tableOnly" name\x3d"geocode"\r\n              value\x3d"none" data-dojo-observer\x3d"onChangeGeocode" /\x3e\r\n            ${i18n.table}\r\n          \x3c/label\x3e\r\n\r\n          \x3cdiv class\x3d"leader-half clearfix"\x3e\r\n            \x3cdiv class\x3d\'multigeocode left\'\x3e\r\n              \x3cspan\x3e\r\n                \x3clabel for\x3d"geocoderSelect" class\x3d"trailer-0 inline-block"\x3e${i18nCSV.selectGeocoder}\x3c/label\x3e\r\n                \x3cselect id\x3d"geocoderSelect" style\x3d"margin-top: 0px; max-width: 75%;" class\x3d"inline-block" data-dojo-attach-point\x3d"_geocoderSelect" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"geocodeAddress"\x3e\x3c/select\x3e\x3c!-- data-dojo-observer\x3d"onChangeGeocoder"--\x3e\r\n              \x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cspan class\x3d\'csv xlsx geocode\'\x3e\r\n              \x3clabel for\x3d"geocodeAddress" class\x3d"trailer-0 inline-block"\x3e${i18nCSV.inLabel}\x3c/label\x3e\r\n              \x3cselect id\x3d"geocodeAddress" style\x3d"margin-top: 0px; max-width: 75%;" class\x3d"inline-block" data-dojo-attach-point\x3d"_countryCodes" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"geocodeAddress" data-dojo-attach-event\x3d"onChange:onChangeCountry"\x3e\x3c/select\x3e\x3c!-- data-dojo-observer\x3d"onChangeCountry"--\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"geocodeReviewMsg" class\x3d\'csv xlsx font-size--1\' style\x3d"display:none;"\x3e${i18n.review}\x3c/span\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d\'gridNode\' class\x3d"grid leader-quarter add-item-geocode-table"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"timeZones csv xlsx leader-1" style\x3d"display:none;"\x3e\r\n        \x3clabel for\x3d"timeZones" class\x3d"trailer-0"\x3e\x3cspan class\x3d"padding-right-1"\x3e${i18n.timeZone}${i18n.colon}\x3c/span\x3e\r\n          \x3cselect id\x3d"timeZones" data-dojo-attach-point\x3d"_timeZones" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:375px;" maxHeight\x3d"200" name\x3d"timeZone"\x3e\x3c/select\x3e\r\n          \x3ca class\x3d"esriHelpIcon" data-dojo-attach-point\x3d"_timezoneHelpIcon" title\x3d"${i18n.timezoneHelpTip}" href\x3d"#" target\x3d"_blank"\x3e\x3c/a\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"wfsNode" class\x3d"wfs leader-1 trailer-1" style\x3d"display:none;"\x3e\r\n          \x3clabel for\x3d"wfsLayers"\x3e${i18n.addLayerFromUrlDlg.layerLabel}\x3c/label\x3e\r\n          \x3cselect id\x3d"wfsLayers" data-dojo-attach-point\x3d"_wfsLayers" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"wfsLayers"\x3e\x3c/select\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_wfsComplexOptions" class\x3d"complexOptions esriLeadingMargin7 trailer-1" style\x3d"display:none"\x3e\r\n              \x3cp data-dojo-attach-point\x3d"_wfsGeometryTypeMsg"\x3e${i18n.addLayerFromUrlDlg.wfsGeometryTypeMsg}\x3c/p\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"_wfsGeometryType" data-dojo-type\x3d"dijit/form/Select" maxHeight\x3d"200" name\x3d"wfsGeometryTypes" aria-label\x3d"${i18n.addLayerFromUrlDlg.wfsGeometryTypeMsg}"\x3e\r\n                  \x3coption value\x3d"none" selected\x3e${i18n.addLayerFromUrlDlg.chooseWFSGeometryType}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPoint"\x3e${i18n.addLayerFromUrlDlg.points}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPolyline"\x3e${i18n.addLayerFromUrlDlg.lines}\x3c/option\x3e\r\n                  \x3coption value\x3d"esriGeometryPolygon"\x3e${i18n.addLayerFromUrlDlg.polygons}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_tileMatrixSetInfoOptions" class\x3d"tileMatrixSetInfosOptions esriLeadingMargin7 leader-1" style\x3d"display:none"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"_tileMatrixSetInfos" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:442px;" maxHeight\x3d"200" name\x3d"tileMatrixInfos"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\x3cdiv class\x3d"submitButtons right leader-half"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"spinnerNode" style\x3d"display:none"\x3e${i18n.pleaseWait}\x3c/span\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/Button" class\x3d"primary" id\x3d"addItem-btn" name\x3d"addItem" type\x3d"submit" label\x3d"${i18n.addItem}"\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/Button" class\x3d"cancel" name\x3d"cancel" type\x3d"button" data-dojo-observer\x3d"onCancel" label\x3d"${i18n.cancel}"\x3e\r\n\x3c/div\x3e\r\n\x3c/form\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/PublishTilesDlg.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\r\n  \x3cp data-dojo-attach-point\x3d"_message"\x3e\x3c/p\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_itemPropertiesDlg"  data-dojo-type\x3d"arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg" data-dojo-props\x3d"typeInfo:\'${_typeInfo}\', showFile:false, showUrl:false, showFolders:${showFolders}"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"sceneProperties hide"\x3e\r\n      \x3cdiv class\x3d"sceneDataDisplay hide"\x3e\r\n          \x3cdiv\x3e${i18n.publishTileServiceDlg.displayInLbl}\x3c/div\x3e\r\n          \x3clabel\x3e\r\n              \x3cinput id\x3d"${id}-globalWkid" data-dojo-attach-point\x3d"_globalWkidRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:true" value\x3d"global"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"_globalWkidRadioLabel"\x3e\x3c/span\x3e\r\n          \x3c/label\x3e\r\n          \x3clabel\x3e\r\n              \x3cinput id\x3d"${id}-localWkid" data-dojo-attach-point\x3d"_localWkidRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:false" value\x3d"local"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"_localWkidRadioLabel"\x3e\x3c/span\x3e\r\n          \x3c/label\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"tileProperties hide"\x3e\r\n    \x3clabel\x3e${i18n.publishTileServiceDlg.tileSchemeLabel}\x3c/label\x3e\r\n    \x3cdiv class\x3d"tilePropertiesRadios"\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput id\x3d"${id}-agoBasemap" data-dojo-attach-point\x3d"_agoBasemapRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:true" value\x3d"ago"\x3e${i18n.publishTileServiceDlg.matchAGOLBasemaps}\r\n      \x3c/label\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput id\x3d"${id}-custom" data-dojo-attach-point\x3d"_customBasemapRadio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"checked:false" value\x3d"custom"\x3e${i18n.publishTileServiceDlg.matchOwnBasemap}\r\n      \x3c/label\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_customBasemapUrl" class\x3d"custom esriLeadingMargin2" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d"disabled:true,placeholder:\'${i18n.publishTileServiceDlg.tileSchemePlaceholder}\'"/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"tileProperties hide" data-dojo-attach-point\x3d"_tilesOnDemandContainer"\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput id\x3d"${id}-tilesOnDemand" data-dojo-attach-point\x3d"_tilesOnDemand" type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"\x3e ${i18n.publishTileServiceDlg.enableTilesOnDemand}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"visibleScaleRange hide"\x3e\r\n      \x3clabel class\x3d"tileRange"\x3e${i18n.publishTileServiceDlg.scaleRangeLabel}\x3c/label\x3e\r\n      \x3cdiv\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_visibleScaleRangeContainer"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"loader js-visible-range-loader overlay-white position-relative hide" data-dojo-attach-point\x3d"_visibleRangeLoader"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text hide" data-dojo-attach-point\x3d"_visibleRangeLoaderMsg"\x3e${!i18n.common.loading}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"_increaseScaleWarning"\x3e\r\n      ${i18n.publishTileServiceDlg.increaseScaleWarning}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/Wizard/Wizard.html":'\x3cdiv class\x3d"dojoxWizard" dojoAttachPoint\x3d"wizardNode"\x3e\r\n    \x3cdiv class\x3d"dojoxWizardContainer" dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"dojoxWizardButtons" dojoAttachPoint\x3d"wizardNav"\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachPoint\x3d"previousButton"\x3e${previousButtonLabel}\x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachPoint\x3d"nextButton"\x3e${nextButtonLabel}\x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachPoint\x3d"doneButton" style\x3d"display:none"\x3e${doneButtonLabel}\x3c/button\x3e\r\n        \x3cbutton dojoType\x3d"dijit.form.Button" type\x3d"button" dojoAttachPoint\x3d"cancelButton"\x3e${cancelButtonLabel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/ThumbnailDlg.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode" class\x3d"content-node"\x3e\r\n  \x3ccanvas data-dojo-attach-point\x3d"_canvasNode" hidden\x3e\x3c/canvas\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_dragDropNode" draggable\x3d"true"\x3e\r\n    \x3cdiv class\x3d"text-center panel panel-dashed"\x3e\r\n      \x3cimg src\x3d"js/arcgisonline/img/upload-graphic.svg" alt\x3d"Upload"\x3e\x3c/img\x3e\r\n      \x3cp data-dojo-attach-point\x3d"_message" class\x3d"trailer-0"\x3e\r\n        \x3cspan class\x3d"display-block font-size-1"\x3e${i18n.GroupWidget.thumbnailDlg.dragDrop}\x3c/span\x3e\r\n        \x3cspan class\x3d"display-block font-size--2" data-dojo-attach-point\x3d"_sizeSuggestion"\x3e${i18n.GroupWidget.thumbnailDlg.sizeSpec}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cp class\x3d"text-center leader-1 trailer-half"\x3e\r\n      \x3cb class\x3d"horizontal-lines"\x3e\x3cspan\x3e${i18n.GroupWidget.thumbnailDlg.or}\x3c/span\x3e\x3c/b\x3e\r\n    \x3c/p\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_thumbnailForm" enctype\x3d"multipart/form-data" class\x3d"text-left"\x3e\r\n      \x3clabel\x3e\r\n        ${i18n.GroupWidget.thumbnailDlg.browseFile}\r\n        \x3cinput name\x3d"browse-for-thumbnail" id\x3d"browse-for-thumbnail" type\x3d"file" data-dojo-attach-point\x3d"_fileInput"/\x3e\r\n      \x3c/label\x3e\r\n    \x3c/form\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_cropNode" class\x3d"edit-thumb-display hide"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_cropThumbContainer" class\x3d"crop-thumb-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_thumbTranslucentContainer" class\x3d"crop-thumb-translucent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_thumbTransparentContainer" class\x3d"crop-thumb-clear"\x3e\r\n          \x3cimg data-dojo-attach-point\x3d"_previewImage" class\x3d"preview-image"\x3e\x3c/img\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3clabel class\x3d"trailer-half leader-half"\x3e\r\n      ${i18n.GroupWidget.thumbnailDlg.zoom}\r\n      \x3cinput type\x3d"range" data-dojo-attach-point\x3d"_zoomSlider"\x3e\x3c/input\x3e\r\n      \x3cspan class\x3d"icon-ui-media icon-ui-flush font-size--2 left"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"icon-ui-media icon-ui-flush font-size-2 right"\x3e\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/ManageSceneCache.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_optionsContainer"\x3e\r\n    ${i18n.description}\r\n    \x3cfieldset class\x3d"trailer-0 fieldset-checkbox leader-half padding-trailer-1"\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput type\x3d"radio" name\x3d"rebuildOption" data-dojo-attach-point\x3d"_rebuildFullRadio" checked\x3e ${i18n.rebuildFull}\r\n      \x3c/label\x3e\r\n      \x3clabel\x3e\r\n        \x3cinput type\x3d"radio" name\x3d"rebuildOption" data-dojo-attach-point\x3d"_rebuildLayersRadio"\x3e ${i18n.rebuildLayers}\r\n      \x3c/label\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"loader js-caching-loader overlay-white position-relative leader-1 padding-trailer-1" data-dojo-attach-point\x3d"_caching"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e${!i18n.republishing}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"_sceneLayerSelectContainer"\x3e\r\n    \x3clabel class\x3d"trailer-0" data-dojo-attach-point\x3d"_sceneLayerSelectLabel"\x3e${i18n.selectLayers}\x3c/label\x3e\r\n    \x3cdiv class\x3d"scene-layer-list trailer-1" data-dojo-attach-point\x3d"_sceneLayerContainer"\x3e\r\n      \x3c!-- create scene layers here--\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"right inline-block padding-right-1" data-dojo-attach-point\x3d"_buttonBar"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-blue" disabled\x3d"true" data-dojo-attach-point\x3d"_rebuildBtn"\x3e${i18n.rebuildLabel}\x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-clear" data-dojo-attach-point\x3d"_cancelBtn"\x3e${i18n.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/AppendData/templates/_table-row.html":'\x3cdiv class\x3d"table-select-row"\x3e\r\n    \x3c!-- Field Name --\x3e\r\n  \x3cspan class\x3d"table-select-cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-field text-ellipsis"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width display-block"\x3e${displayName}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n    \x3c!-- Match Field --\x3e\r\n  \x3cspan class\x3d"table-select-cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-matchField text-ellipsis" data-dojo-attach-point\x3d"_matchFieldsContainer"\x3e\r\n        \x3cspan class\x3d"margin-left-quarter text-ellipsis full-width" data-dojo-attach-point\x3d"_matchFieldValue" data-value\x3d"__none"\x3e${!i18n.appendDataDlg.none}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"_matchFields" class\x3d"leader-0 hide"\x3e\x3c/select\x3e\r\n      \x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/View/templates/loader.html":'\x3cdiv class\x3d"loader padding-leader-5 padding-trailer-5 is-active"\x3e\r\n  \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"loader-text"\x3e${location}\x3c/div\x3e\r\n\x3c/div\x3e',"url:arcgisonline/sharing/dijit/AppendData/templates/_appendData.html":'\x3cdiv\x3e\r\n    \x3csection class\x3d"padding-leader-half content-node append-data"\x3e\r\n\r\n            \x3c!--Step 1--\x3e\r\n            \x3cdiv class\x3d"step-1 hide" data-dojo-attach-point\x3d"_step1"\x3e\r\n                \x3cp class\x3d"trailer-half"\x3e${i18n.appendDataDlg.messageStep1}\x3c/p\x3e\r\n                \x3clabel class\x3d"trailer-half"\x3e${i18n.appendDataDlg.messageStep1Title}\x3c/label\x3e\r\n                \x3cul class\x3d"trailer-half"\x3e\r\n                    \x3cli\x3e${i18n.appendDataDlg.messageStep1Bullet1}\x3c/li\x3e\r\n                    \x3cli\x3e${i18n.appendDataDlg.messageStep1Bullet2}\x3c/li\x3e\r\n                    \x3cli\x3e${i18n.appendDataDlg.messageStep1Bullet3}\x3c/li\x3e\r\n                    \x3cli\x3e${i18n.appendDataDlg.messageStep1Bullet4}\x3c/li\x3e\r\n                \x3c/ul\x3e\r\n                \x3cform data-dojo-attach-point\x3d"_fileForm" enctype\x3d"multipart/form-data" class\x3d"text-left"\x3e\r\n                    \x3clabel\x3e\r\n                        ${i18n.appendDataDlg.fileName}\r\n                        \x3cinput name\x3d"file" type\x3d"file" accept\x3d".zip, .csv, .xls, .xlsx, .geojson" data-dojo-attach-point\x3d"_fileInput"/\x3e\r\n                    \x3c/label\x3e\r\n                    \x3clabel class\x3d"hide" data-dojo-attach-point\x3d"_zipSelect"\x3e\r\n                        ${i18n.appendDataDlg.contents}\r\n                        \x3cselect name\x3d"type" data-dojo-attach-point\x3d"_suportedTypes" class\x3d"text-left"\x3e\x3c/select\x3e\r\n                    \x3c/label\x3e\r\n                \x3c/form\x3e\r\n                \x3cp class\x3d"trailer-quarter"\x3e${i18n.appendDataDlg.note}\x3c/p\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!--Step 2--\x3e\r\n            \x3cdiv class\x3d"step-2 padding-right-half hide" data-dojo-attach-point\x3d"_step2"\x3e\r\n                \x3cp class\x3d"trailer-half"\x3e${!i18n.appendDataDlg.messageStep2}\x3c/p\x3e\r\n                \x3clabel class\x3d"trailer-half" data-dojo-attach-point\x3d"_serviceLayersContainer"\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_appendDataLabel"\x3e${i18n.appendDataDlg.chooseServiceLayer}\x3c/span\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"_serviceLayersSelect" class\x3d"leader-0 select-full"\x3e\x3c/select\x3e\r\n                \x3c/label\x3e\r\n\r\n                \x3clabel class\x3d"trailer-half" data-dojo-attach-point\x3d"_dataLayersContainer"\x3e\r\n                    \x3cspan data-dojo-attach-point\x3d"_appendDataLabel"\x3e${i18n.appendDataDlg.chooseLayer}\x3c/span\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"_dataLayersSelect" class\x3d"leader-0 select-full"\x3e\x3c/select\x3e\r\n                \x3c/label\x3e\r\n\r\n                \x3c!-- Update Existing Features--\x3e\r\n                \x3cdiv class\x3d"trailer-half updateFeatures"\x3e${i18n.appendDataDlg.updateExistingFeaturesLbl}\x3c/div\x3e\r\n                \x3cp class\x3d"trailer-half updateFeatures"\x3e${i18n.appendDataDlg.updateExistingFeaturesMsg}\x3c/p\x3e\r\n                \x3clabel class\x3d"inline-block margin-right-half trailer-half align-middle updateFeatures js-updateFeatures js-attributesOnly"\x3e\r\n                    \x3cinput name\x3d"updateExistingFeatures" type\x3d"checkbox" data-dojo-attach-point\x3d"_updateExistingFeatures"/\x3e\r\n                    ${i18n.appendDataDlg.updateExistingFeatures}\r\n                \x3c/label\x3e\r\n                \x3cdiv class\x3d"margin-left-1 updateFeatures js-updateFeatures-container js-updateFeatures"\x3e\r\n                    \x3c!-- UID field matching --\x3e\r\n                    \x3cp class\x3d"trailer-half"\x3e${i18n.appendDataDlg.selectFields}\x3c/p\x3e\r\n                    \x3cdiv class\x3d"trailer-half"\x3e\r\n                        \x3cselect data-dojo-attach-point\x3d"_fromField" class\x3d"margin-right-half inline-block"\x3e\x3c/select\x3e\r\n                        \x3cspan class\x3d"margin-right-half"\x3e${i18n.appendDataDlg.matchesTo}\x3c/span\x3e\r\n                        \x3cselect data-dojo-attach-point\x3d"_toField" class\x3d"inline-block"\x3e\x3c/select\x3e\r\n                    \x3c/div\x3e\r\n                    \x3clabel class\x3d"inline-block margin-right-half trailer-half js-attributesOnly"\x3e\r\n                        ${i18n.appendDataDlg.skipInserts}\r\n                        \x3cinput name\x3d"skipInserts" type\x3d"checkbox" data-dojo-attach-point\x3d"_skipInserts"/\x3e\r\n                    \x3c/label\x3e\r\n                    \x3clabel class\x3d"inline-block margin-right-half trailer-half js-updateGeometry js-attributesOnly"\x3e\r\n                        ${i18n.appendDataDlg.updateGeometryOnly}\r\n                        \x3cinput name\x3d"updateGeometry" type\x3d"checkbox" data-dojo-attach-point\x3d"_updateGeometry"/\x3e\r\n                    \x3c/label\x3e\r\n                \x3c/div\x3e\r\n\r\n                \x3c!-- Table View --\x3e\r\n                \x3cbutton class\x3d"btn-link trailer-half btn-fill" data-value\x3d"false" data-dojo-attach-point\x3d"_showFieldMatchingLink"\x3e${i18n.appendDataDlg.showFieldMatching}\x3c/button\x3e\r\n                \x3cdiv class\x3d"js-table-wrap table-select trailer-half js-view hide" data-dojo-attach-point\x3d"_fieldMatching"\x3e\r\n                    \x3cdiv class\x3d"table-select-head js-table-header"\x3e\r\n                        \x3cdiv class\x3d"table-select-row table-select-row-header"\x3e\r\n                            \x3cspan class\x3d"table-select-cell table-select-cell-th"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header is-ascending" aria-sort\x3d"ascending" data-sort\x3d"title" data-sort-order\x3d"asc"\x3e${i18n.appendDataDlg.fields}\x3c/button\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"table-select-cell table-select-cell-th"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"matchField" data-sort-order\x3d"asc"\x3e${i18n.appendDataDlg.matchField}\x3c/button\x3e\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"table-select-rows js-table-rows js-view"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3c!-- Loader --\x3e\r\n            \x3cdiv class\x3d"hide analyze-loader-wrap js-analyze-loader-wrap"\x3e\x3c/div\x3e\r\n\r\n    \x3c/section\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/Overlay/templates/Overlay.html":'\x3cdiv class\x3d"overlay js-overlay" role\x3d"dialog" aria-labelledby\x3d"overlay-title"\x3e\r\n  \x3cdiv class\x3d"overlay-title-bar clearfix"\x3e\r\n    \x3ch3 id\x3d"overlay-title" class\x3d"overlay-title"\x3e${title}\x3c/h3\x3e\r\n    \x3cbutton class\x3d"btn-link btn-link-off-black font-size-2 leader-quarter right" data-dojo-attach-point\x3d"closeBtn" aria-label\x3d"close"\x3e\r\n      \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" viewBox\x3d"0 0 32 32" class\x3d"svg-icon"\x3e\r\n        \x3cpath d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\r\n      \x3c/svg\x3e\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"overlay-content" data-dojo-attach-point\x3d"_overlayContentWrapper"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"overlay-action-bar ${_showActionBar:hide}" data-dojo-attach-point\x3d"_overlayActionBar"\x3e\r\n    \x3cnav class\x3d"right"\x3e\r\n      \x3cbutton class\x3d"btn btn-clear calcite-web-btn-clear js-overlay-cancel"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n      \x3cbutton class\x3d"btn js-overlay-primary"\x3e${i18n.common.save}\x3c/button\x3e\r\n    \x3c/nav\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/ReplaceLayer/templates/ReplaceLayer.html":'\x3cdiv class\x3d"grid-container" style\x3d"position: relative;"\x3e\r\n    \x3cdiv class\x3d"loader padding-leader-5 padding-trailer-5 js-replace-lyr-loader is-active hide"\x3e\r\n        \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"replace-lyr-status-container js-replace-lyr-failed padding-leader-5 padding-trailer-5 hide"\x3e\r\n        \x3cp class\x3d"trailer-half"\x3e\r\n            \x3csvg\r\n                width\x3d"80" height\x3d"80" viewBox\x3d"0 0 32 32" class\x3d"replace-lyr-fail-icon"\x3e\r\n                \x3cpath d\x3d"M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z"/\x3e\r\n            \x3c/svg\x3e\r\n        \x3c/p\x3e\r\n        \x3ch5 class\x3d"trailer-half"\x3e\r\n            ${i18n.replaceLayer.failedReplace}\r\n        \x3c/h5\x3e\r\n        \x3cp class\x3d"font-size--2" id\x3d"replace-lyr-error-text"\x3e\x3c/p\x3e\r\n        \x3cbutton class\x3d"btn btn-clear" id\x3d"replace-lyr-failed-close-btn"\x3e\r\n            ${i18n.replaceLayer.close}\r\n        \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"replace-lyr-status-container js-replace-lyr-success padding-leader-5 padding-trailer-5 hide"\x3e\r\n        \x3cp class\x3d"trailer-half"\x3e\r\n                \x3csvg\r\n                    width\x3d"80" height\x3d"80" viewBox\x3d"0 0 32 32" class\x3d"replace-lyr-success-icon"\x3e\r\n                    \x3cpath fill\x3d"#5a9359" d\x3d"M11.927 22l-6.882-6.883-3 3L11.927 28 31.204 8.728l-3.001-3.001z"/\x3e\r\n                \x3c/svg\x3e\r\n            \x3c/p\x3e\r\n            \x3ch4 class\x3d"avenir-bold trailer-half"\x3e\r\n                ${i18n.replaceLayer.success}\r\n            \x3c/h4\x3e\r\n            \x3ch5 class\x3d"trailer-half"\x3e\r\n                ${i18n.replaceLayer.successReplace}\r\n            \x3c/h5\x3e\r\n        \x3cp class\x3d"font-size--2"\x3e${i18n.replaceLayer.verifyDependencies}\x3c/p\x3e\r\n        \x3cbutton class\x3d"btn btn-clear" id\x3d"replace-lyr-success-close-btn"\x3e\r\n            ${i18n.replaceLayer.close}\r\n        \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-replace-lyr-wrapper"\x3e\r\n        \x3cdiv\r\n            id\x3d"replace-lyr-no-lyr-container"\r\n            class\x3d"column-12 leader-1 padding-leader-half padding-left-4 padding-right-4"\r\n        \x3e\r\n            \x3cdiv class\x3d"trailer-2"\x3e\r\n                \x3ch4 class\x3d"font-size--1 trailer-half"\x3e${i18n.replaceLayer.replacementLayer}\x3c/h4\x3e\r\n                \x3ch3 class\x3d"text-light-gray"\x3e${i18n.replaceLayer.noLayerSelected}\x3c/h3\x3e\r\n                \x3cbutton class\x3d"btn btn-clear js-replace-lyr-select-lyr"\x3e${i18n.replaceLayer.selectLayer}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3ch5 class\x3d"trailer-quarter font-size-0 avenir-demi"\x3e${i18n.replaceLayer.whatItDo}\x3c/h5\x3e\r\n            \x3chr class\x3d"leader-0 trailer-quarter"\x3e\r\n            \x3cul class\x3d"margin-left-0"\x3e\r\n                \x3cli\x3e${i18n.replaceLayer.willReplaceLayer}\x3c/li\x3e\r\n                \x3cli\x3e${i18n.replaceLayer.infoRetained}\x3c/li\x3e\r\n                \x3cli\x3e${i18n.replaceLayer.newContent}\x3c/li\x3e\r\n            \x3c/ul\x3e\r\n            \x3ch5 class\x3d"trailer-quarter font-size-0 avenir-demi"\x3e${i18n.replaceLayer.checklist}\x3c/h5\x3e\r\n            \x3chr class\x3d"leader-0 trailer-quarter"\x3e\r\n            \x3cul class\x3d"margin-left-0"\x3e\r\n                \x3cli\x3e${i18n.replaceLayer.infoSame}\x3c/li\x3e\r\n                \x3cli\x3e${i18n.replaceLayer.testReplacement}\x3c/li\x3e\r\n            \x3c/ul\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv\r\n            id\x3d"replace-lyr-selected-lyr-container"\r\n            class\x3d"column-12 leader-1 padding-leader-half padding-left-4 padding-right-4 hide"\r\n        \x3e\r\n            \x3cdiv class\x3d"trailer-2"\x3e\r\n                \x3ch4 class\x3d"font-size--1 trailer-half"\x3e${i18n.replaceLayer.replacementLayer}\x3c/h4\x3e\r\n                \x3cdiv class\x3d"replace-lyr-selected-card-container"\x3e\r\n                    \x3ch3 id\x3d"replace-lyr-selected-lyr-name" class\x3d"trailer-quarter"\x3e\x3c/h3\x3e\r\n                    \x3ch5 class\x3d"trailer-half font-size--2"\x3e\r\n                        \x3cimg id\x3d"replace-lyr-selected-icon" class\x3d"replace-lyr-item-type-icon"\x3e\x3c/img\x3e\r\n                        \x3cspan id\x3d"replace-lyr-selected-type"\x3e\x3c/span\x3e ${i18n.replaceLayer.by} \x3ca id\x3d"replace-lyr-selected-owner"\x3e\x3c/a\x3e\r\n                    \x3c/h5\x3e\r\n                    \x3cdiv class\x3d"replace-lyr-change-lyr-container"\x3e\r\n                        \x3cbutton\r\n                            class\x3d"font-size--3 btn-link replace-lyr-change-lyr-btn js-replace-lyr-change-lyr"\r\n                        \x3e\r\n                            ${i18n.replaceLayer.changeLayer}\r\n                        \x3c/button\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv\x3e\r\n                \x3ch5 class\x3d"trailer-quarter font-size-0 avenir-demi"\x3e${i18n.replaceLayer.replacementOptions}\x3c/h5\x3e\r\n                \x3chr class\x3d"leader-0 trailer-half"\x3e\r\n                \x3cfieldset class\x3d"fieldset-checkbox"\x3e\r\n                    \x3clabel class\x3d"padding-trailer-quarter"\x3e\r\n                        \x3cinput type\x3d"checkbox" id\x3d"replace-lyr-info-change"\x3e${i18n.replaceLayer.replaceItemInfo}\r\n                        \x3cdiv class\x3d"leader-half margin-left-1 margin-right-1 font-size--3"\x3e\r\n                            ${i18n.replaceLayer.replaceInfoTip}\r\n                            \x3cul\x3e\r\n                                \x3cli class\x3d"font-size--3"\x3e${i18n.replaceLayer.thumbnail}\x3c/li\x3e\r\n                                \x3cli class\x3d"font-size--3"\x3e${i18n.replaceLayer.summary}\x3c/li\x3e\r\n                                \x3cli class\x3d"font-size--3"\x3e${i18n.replaceLayer.description}\x3c/li\x3e\r\n                                \x3cli class\x3d"font-size--3"\x3e${i18n.replaceLayer.tags}\x3c/li\x3e\r\n                            \x3c/ul\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/label\x3e\r\n                    \x3c!-- \x3clabel class\x3d"replace-lyr-input-disabled" id\x3d"replace-lyr-meta-label"\x3e\r\n                        \x3cinput type\x3d"checkbox" id\x3d"replace-lyr-meta-change" disabled\x3e${i18n.replaceLayer.replaceMetaData}\r\n                    \x3c/label\x3e --\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"column-12 leader-1 padding-leader-half padding-left-4 padding-right-4" id\x3d"replace-lyr-current-container"\x3e\r\n            \x3ch4 class\x3d"font-size--1 trailer-half"\x3e${i18n.replaceLayer.currentLayer}\x3c/h4\x3e\r\n            \x3ch3 class\x3d"trailer-quarter" id\x3d"replace-lyr-current-title"\x3e\x3c/h3\x3e\r\n            \x3ch5 class\x3d"trailer-quarter font-size--2"\x3e\r\n                \x3cimg id\x3d"replace-lyr-current-icon" class\x3d"replace-lyr-item-type-icon"\x3e\x3c/img\x3e\r\n                \x3cspan id\x3d"replace-lyr-current-type"\x3e\x3c/span\x3e ${i18n.replaceLayer.by} \x3ca id\x3d"replace-lyr-current-owner"\x3e\x3c/a\x3e\r\n            \x3c/h5\x3e\r\n            \x3cfieldset class\x3d"fieldset-checkbox leader-2"\x3e\r\n                \x3clabel\x3e\x3cinput class\x3d"hide" type\x3d"checkbox" checked disabled\x3e${i18n.replaceLayer.archiveLayerAs}\x3c/label\x3e\r\n                \x3cdiv id\x3d"replace-lyr-edit-container" class\x3d"input-group hide"\x3e\r\n                    \x3cinput id\x3d"replace-lyr-edit-name" class\x3d"input-group-input" type\x3d"text" placeholder\x3d"Layer name" maxlength\x3d"120"\x3e\r\n                    \x3cdiv class\x3d"js-replace-name-input-error input-error-message"\x3e\r\n                        ${i18n.addItemFrm.errors.invalidServiceTitle.message}\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"js-replace-name-available-error input-error-message"\x3e\r\n                        ${i18n.addItemFrm.errors.serviceNameExists.message}\r\n                    \x3c/div\x3e\r\n                    \x3cspan class\x3d"input-group-button"\x3e\r\n                        \x3cbutton id\x3d"replace-lyr-edit-save" class\x3d"btn"\x3e${i18n.replaceLayer.save}\x3c/button\x3e\r\n                    \x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cbutton id\x3d"replace-lyr-current-arch-btn" class\x3d"btn-link"\x3e\r\n                    \x3cspan id \x3d"replace-lyr-current-arch-name"\x3e\x3c/span\x3e\r\n                    \x3csvg\r\n                        width\x3d"32"\r\n                        height\x3d"32"\r\n                        viewBox\x3d"0 0 32 32"\r\n                        class\x3d"svg-icon"\r\n                    \x3e\r\n                        \x3cpath d\x3d"M27.443 9.439l-4.955-4.953 1.652-1.65a2.337 2.337 0 0 1 3.301 0l1.648 1.65a2.33 2.33 0 0 1 .004 3.299l-1.65 1.654zM4.924 22.195l-2.373 7.254 7.328-2.301-4.955-4.953zM20.455 6.713L7.379 19.555l4.951 4.949 13.074-12.842-4.949-4.949z"/\x3e\r\n                    \x3c/svg\x3e\r\n                \x3c/button\x3e\r\n            \x3c/fieldset\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/sharing/dijit/dialog/templates/OverwriteFromCloud.html":'\x3cdiv class\x3d"${baseClass}"\x3e\r\n   \x3cdiv class\x3d"overwriteDialog"\x3e\r\n       \x3cp class\x3d"overwriteInfoText"\x3e${i18n.overwriteFromCloudDlg.overwriteInfoText}\x3c/p\x3e\r\n       \x3cp class\x3d"overwriteInfoNote"\x3e${i18n.overwriteFromCloudDlg.overwriteInfoNote}\x3c/p\x3e\r\n   \x3c/div\x3e \r\n   \x3c!-- Loader --\x3e\r\n   \x3cdiv class\x3d"loader loader-connectDataset is-active hide padding-leader-3 padding-trailer-3"\x3e\r\n     \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n     \x3cdiv class\x3d"loader-text"\x3e${i18n.overwriteFromCloudDlg.defaultLoading}\x3c/div\x3e\r\n   \x3c/div\x3e \r\n \x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/typeOptions/mapOptions/httpsResultIssue.html":'\x3cdiv class\x3d"margin-left-1 leader-half"\x3e\r\n  ${title}\x3cbr\x3e\r\n  \x3cspan class\x3d"font-size--3"\x3e${message}\x3c/span\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/item/widgets/typeOptions/mapOptions/httpsResultUpdated.html":'\x3cdiv class\x3d"margin-left-1 leader-half"\x3e\r\n  ${title}\x3cbr\x3e\r\n  \x3cspan class\x3d"font-size--3"\x3e${message}\x3c/span\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/item/widgets/typeOptions/mapOptions/httpsResultUnchanged.html":'\x3cdiv class\x3d"margin-left-1 leader-half"\x3e\r\n  ${title}\x3cbr\x3e\r\n  \x3cspan class\x3d"font-size--3"\x3e${message}\x3c/span\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/typeOptions/mapOptions/httpsUpdate.html":'\x3cdiv class\x3d"clearfix"\x3e\r\n  \x3cdiv class\x3d"leader-half font-size--1" data-dojo-attach-point\x3d"_updateHttpsDesc"\x3e${i18n.itemProperties.updateLayersToHTTPSDesc}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_updateHttpsLoading"\x3e\r\n    \x3cspan class\x3d"icon-ui-loading-indicator icon-ui-flush icon-ui-spinning" aria-label\x3d"${i18n.itemProperties.updatingLayersToHTTPS}"\x3e\x3c/span\x3e\r\n    ${i18n.itemProperties.updatingLayersToHTTPS}\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide update-https-results" data-dojo-attach-point\x3d"_updateHttpsResults"\x3e\r\n    \x3cdiv class\x3d"leader-half" data-dojo-attach-point\x3d"_layersWithIssues"\x3e\r\n      \x3cdiv class\x3d"update-layer-section inline-block"\x3e\r\n        \x3cspan class\x3d"icon-ui-right update-section-toggle" data-dojo-attach-point\x3d"_toggleIssues"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"icon-ui-error has-issues"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"has-issues" data-dojo-attach-point\x3d"_issuesTitle"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide leader-half margin-left-1" data-dojo-attach-point\x3d"_issues"\x3e\x3c!-- write out issues here --\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-half" data-dojo-attach-point\x3d"_layersUpdated"\x3e\r\n      \x3cdiv class\x3d"update-layer-section inline-block"\x3e\r\n        \x3cspan class\x3d"icon-ui-right update-section-toggle" data-dojo-attach-point\x3d"_toggleUpdated"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"icon-ui-check-mark highlight-green"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_updatedTitle"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide leader-half margin-left-1" data-dojo-attach-point\x3d"_updated"\x3e\x3c!-- write out updated here --\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"leader-half" data-dojo-attach-point\x3d"_layersUnchanged"\x3e\r\n      \x3cdiv class\x3d"update-layer-section inline-block"\x3e\r\n        \x3cspan class\x3d"icon-ui-right update-section-toggle" data-dojo-attach-point\x3d"_toggleUnchanged"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"icon-ui-check-mark highlight-green"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"_unchangedTitle"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide leader-half margin-left-1" data-dojo-attach-point\x3d"_unchanged"\x3e\x3c!-- write out unchanged here --\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_noChangesMade"\x3e\r\n    \x3cspan class\x3d"icon-ui-check-mark highlight-green"\x3e\x3c/span\x3e\r\n    ${i18n.itemProperties.noLayersToUpdateHTTPS}\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_unexpectedError"\x3e${i18n.itemProperties.errorUpdateHTTPS}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"leader-1 inline-block esriFloatTrailing right"\x3e\r\n    \x3cbutton class\x3d"btn btn-blue" data-dojo-attach-point\x3d"_okBtn"\x3e${i18n.itemProperties.updateLayers}\x3c/button\x3e\r\n    \x3cbutton class\x3d"hide btn btn-blue" data-dojo-attach-point\x3d"_doneBtn"\x3e${i18n.common.done}\x3c/button\x3e\r\n    \x3cbutton class\x3d"btn btn-clear" data-dojo-attach-point\x3d"_cancelBtn"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/typeOptions/mapOptions/domainUpdate.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"font-size--1" data-dojo-attach-point\x3d"_updateDomainDesc"\x3e${i18n.itemProperties.updateDomainDesc}\x3c/div\x3e\r\n  \x3cdiv class\x3d"leader-half" data-dojo-attach-point\x3d"_updateDomainContainer"\x3e\r\n    \x3cdiv class\x3d"align-top"\x3e\r\n      \x3clabel\x3e\r\n        ${i18n.common.find}\x3cbr\x3e\r\n        \x3cselect class\x3d"select-full" data-dojo-attach-point\x3d"_domainSelect"\x3e\x3c/select\x3e\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"align-top"\x3e\r\n      \x3clabel\x3e\r\n        ${i18n.common.replace}\x3cbr\x3e\r\n        \x3cinput id\x3d"domain-replace-input" data-dojo-attach-point\x3d"_domainReplace"\x3e\r\n        \x3cdiv class\x3d"hide input-error-message" data-dojo-attach-point\x3d"_domainReplaceError"\x3e\r\n          ${i18n.itemProperties.siteReferenceInvalid}\r\n        \x3c/div\x3e\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"inline-block align-top"\x3e\r\n      \x3cbutton class\x3d"btn btn-clear btn-small" data-dojo-attach-point\x3d"_replaceDomainBtn" disabled\x3e${i18n.common.replace}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_replaceDomainLoading"\x3e\r\n    \x3cspan class\x3d"icon-ui-loading-indicator icon-ui-flush icon-ui-spinning" aria-label\x3d"${i18n.itemProperties.updatingDomains}"\x3e\x3c/span\x3e\r\n    ${i18n.itemProperties.updatingDomains}\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_replaceDomainFailure"\x3e\r\n    \x3cspan class\x3d"icon-ui-error has-issues"\x3e\x3c/span\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"_replaceDomainFailureMessage"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_replaceDomainSuccess"\x3e\r\n    \x3cspan class\x3d"icon-ui-check-mark highlight-green"\x3e\x3c/span\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"_replaceDomainSuccessMessage"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide leader-half" data-dojo-attach-point\x3d"_layerDetailsContainer"\x3e\r\n    ${i18n.itemProperties.layersWithDomain}\r\n    \x3cdiv class\x3d"font-size--2" data-dojo-attach-point\x3d"_layerDetails"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"clearfix leader-1 esriFloatTrailing right"\x3e\r\n    \x3cbutton class\x3d"btn btn-blue" data-dojo-attach-point\x3d"_doneBtn"\x3e${i18n.common.done}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"*now":function(c){c(['dojo/i18n!*preload*arcgisonline/nls/arcgisonline*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("arcgisonline/arcgisonline",["dojo","dijit","dojox","dojo/require!esri/main,dijit/_base,dijit/form/DropDownButton,dijit/form/ComboButton,dijit/form/ToggleButton,dijit/form/HorizontalSlider,dijit/form/VerticalSlider,dijit/form/HorizontalRule,dijit/form/VerticalRule,dijit/form/HorizontalRuleLabels,dijit/form/VerticalRuleLabels,esri/map,esri/dijit/editing/Editor,esri/dijit/editing/TemplatePicker,esri/dijit/InfoWindow,esri/dijit/OverviewMap,esri/dijit/Attribution,esri/dijit/Scalebar,esri/dijit/Legend,esri/dijit/TimeSlider,esri/dijit/MultidimensionalSlider,esri/dijit/BasemapGallery,esri/dijit/HomeButton,esri/dijit/LocateButton,esri/dijit/Popup,esri/layers/graphics,esri/layers/agstiled,esri/layers/agsdynamic,esri/layers/agsimageservice,esri/layers/CSVLayer,esri/layers/StreamLayer,esri/layers/KMLLayer,esri/layers/FeatureLayer,esri/layers/VectorTileLayer,esri/layers/osm,esri/SnappingManager,esri/tasks/geometry,esri/tasks/identify,esri/tasks/locator,esri/toolbars/draw,esri/virtualearth/VETiledLayer,esri/virtualearth/VEGeocoder,esri/dijit/Geocoder,dojo/dnd/Moveable,dojo/parser,arcgisonline/coachmarks/tours,arcgisonline/map/classBreaks,arcgisonline/map/dynLayer,arcgisonline/map/edit,arcgisonline/map/featColl,arcgisonline/map/fileImport,arcgisonline/map/geocode,arcgisonline/map/geocodeReview,arcgisonline/map/geoRSS,arcgisonline/map/itemData,arcgisonline/map/layer,arcgisonline/map/kml,arcgisonline/map/mapNotes,arcgisonline/map/mapUtil,arcgisonline/map/role,arcgisonline/map/print,arcgisonline/map/popup,arcgisonline/map/save_open,arcgisonline/map/symbol,arcgisonline/map/table,arcgisonline/map/thumbnail,arcgisonline/map/time,arcgisonline/map/multiDimensions,arcgisonline/map/vectorTile,arcgisonline/map/webTile,arcgisonline/map/wms,arcgisonline/map/dijit/About,arcgisonline/map/dijit/AddContent,arcgisonline/map/dijit/Directions,arcgisonline/map/dijit/Edit,arcgisonline/map/dijit/Geocode,arcgisonline/map/dijit/LeftPanel,arcgisonline/map/dijit/Legend,arcgisonline/map/dijit/ManageTemplates,arcgisonline/map/dijit/MosaicRule,arcgisonline/map/dijit/PopupBuilder,arcgisonline/map/dijit/RendererLabels,arcgisonline/map/dijit/DefineAOI,arcgisonline/map/dijit/RenderingRule,arcgisonline/map/dijit/StructuredPopupWidget,arcgisonline/map/dijit/TOC,arcgisonline/map/dijit/MultidimensionalFilter,arcgisonline/map/dijit/renderer/AttributeTransparency,arcgisonline/map/dijit/renderer/AttributeTransparencyDlg,arcgisonline/map/dijit/renderer/Color,arcgisonline/map/dijit/renderer/ColorGrid,arcgisonline/map/dijit/renderer/Gallery,arcgisonline/map/dijit/renderer/HeatMap,arcgisonline/map/dijit/renderer/MultiAttributes,arcgisonline/map/dijit/renderer/Simple,arcgisonline/map/dijit/renderer/Size,arcgisonline/map/dijit/renderer/SizeGrid,arcgisonline/map/dijit/renderer/SymbolStylerDlg,arcgisonline/map/dijit/renderer/UniqueValues,arcgisonline/map/dijit/renderer/UniqueValuesGrid,esri/tasks/RelationshipQuery,esri/tasks/StatisticDefinition,esri/tasks/PrintParameters,esri/tasks/LegendLayer,esri/tasks/GenerateRendererParameters,esri/tasks/ClassificationDefinition,esri/tasks/ClassBreaksDefinition,esri/tasks/UniqueValueDefinition,esri/tasks/ColorRamp,esri/tasks/AlgorithmicColorRamp,esri/tasks/MultipartColorRamp,esri/tasks/RouteTask,esri/tasks/RouteParameters,esri/tasks/RouteResult,esri/tasks/NAMessage,esri/tasks/NATypes,esri/tasks/DirectionsFeatureSet,esri/layers/wmts,esri/layers/WMTSLayer,esri/layers/WMTSLayerInfo,esri/dijit/Directions,dijit/layout/AccordionPane,dojox/data/QueryReadStore,arcgisonline/sharing/util,arcgisonline/sharing/utilShare,arcgisonline/sharing/geow/Account,arcgisonline/sharing/geow/Community,arcgisonline/sharing/geow/Geow,arcgisonline/sharing/geow/MemberReadStore,arcgisonline/sharing/geow/QueryReadStore,arcgisonline/sharing/geow/TooltipQueryReadStore,dijit/Dialog,dijit/form/ComboBox,dijit/layout/TabContainer,arcgisonline/sharing/dijit/ArcGISOnlineServicesGrid,arcgisonline/sharing/dijit/ArcGISServerServicesGrid,arcgisonline/sharing/dijit/BasemapGallery,arcgisonline/sharing/dijit/BasemapGalleryGrid,arcgisonline/sharing/dijit/Button,arcgisonline/sharing/dijit/ComboBox,arcgisonline/sharing/dijit/DataGrid,arcgisonline/sharing/dijit/DropDownButton,arcgisonline/sharing/dijit/Error,arcgisonline/sharing/dijit/FeaturedItemsGrid,arcgisonline/sharing/dijit/FeatureLayerQueryResult,arcgisonline/sharing/dijit/FeatureLayerQueryStore,arcgisonline/sharing/dijit/GoogleServicesGrid,arcgisonline/sharing/dijit/GroupMembershipRequestsGrid,arcgisonline/sharing/dijit/HelpManager,arcgisonline/sharing/dijit/InvitationsGrid,arcgisonline/sharing/dijit/NotificationsList,arcgisonline/sharing/dijit/OrganizationInvite,arcgisonline/sharing/dijit/OrganizationSetup,arcgisonline/sharing/dijit/OrganizationStatus,arcgisonline/sharing/dijit/Troubleshoot,arcgisonline/sharing/dijit/NewUser,arcgisonline/sharing/dijit/SearchFilters,arcgisonline/sharing/dijit/SearchResultsSimple,arcgisonline/sharing/dijit/SingleFilter,arcgisonline/sharing/dijit/SingleInteractiveFilter,arcgisonline/sharing/dijit/UserProfile,arcgisonline/sharing/dijit/dialog/AddLayerFromFileDlg,arcgisonline/sharing/dijit/dialog/AddLayerFromUrlDlg,arcgisonline/sharing/dijit/dialog/BrowseLayersDlg,arcgisonline/sharing/dijit/dialog/CsvLocationDlg,arcgisonline/sharing/dijit/dialog/DeleteWarningDlg,arcgisonline/sharing/dijit/dialog/ExportDlg,arcgisonline/sharing/dijit/dialog/ExtentDlg,arcgisonline/sharing/dijit/dialog/FeatureTemplateDlg,arcgisonline/sharing/dijit/dialog/FieldsDlg,arcgisonline/sharing/dijit/dialog/FilterDlg,arcgisonline/sharing/dijit/dialog/FeatureTypeDlg,arcgisonline/sharing/dijit/dialog/FolderDlg,arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/sharing/dijit/dialog/InvitationsDlg,arcgisonline/sharing/dijit/dialog/InviteAccountUsersDlg,arcgisonline/sharing/dijit/dialog/InviteUsersDlg,arcgisonline/sharing/dijit/dialog/JoinGroupDlg,arcgisonline/sharing/dijit/dialog/ManageSubscriptionDlg,arcgisonline/sharing/dijit/dialog/ManageTilesDlg,arcgisonline/sharing/dijit/dialog/MapSettingsDlg,arcgisonline/sharing/dijit/dialog/MapNotesDlg,arcgisonline/sharing/dijit/dialog/MembershipRequestsDlg,arcgisonline/sharing/dijit/dialog/MdSliderSettingsDlg,arcgisonline/sharing/dijit/dialog/NotificationsDlg,arcgisonline/sharing/dijit/dialog/OpenMapDlg,arcgisonline/sharing/dijit/dialog/OpenPresentationDlg,arcgisonline/sharing/dijit/dialog/QueryLayerDlg,arcgisonline/sharing/dijit/dialog/RenameDlg,arcgisonline/sharing/dijit/dialog/RendererDlg,arcgisonline/sharing/dijit/dialog/SaveWebMapDlg,arcgisonline/sharing/dijit/dialog/SelectAccountUserDlg,arcgisonline/sharing/dijit/dialog/SetIdentityProviderDlg,arcgisonline/sharing/dijit/dialog/ShareCheckDlg,arcgisonline/sharing/dijit/dialog/SharingDlg,arcgisonline/sharing/dijit/dialog/ShareMapDlg,arcgisonline/sharing/dijit/dialog/SubscriptionStatusDlg,arcgisonline/sharing/dijit/dialog/SymbolDlg,arcgisonline/sharing/dijit/dialog/TagsDlg,arcgisonline/sharing/dijit/dialog/TermsOfUseDlg,arcgisonline/sharing/dijit/dialog/TimeSettingsDlg,arcgisonline/sharing/dijit/dialog/UpdateItemDlg,arcgisonline/sharing/dijit/dialog/WaitingDlg,arcgisonline/sharing/dijit/_GalleryFiltersMixin,arcgisonline/sharing/dijit/Grid,arcgisonline/sharing/dijit/ItemGallery,arcgisonline/sharing/dijit/dialog/ItemPropertiesDlg,arcgisonline/sharing/dijit/dialog/BrowseItemsDlg,arcgisonline/sharing/dijit/dialog/_CreateItemUtilMixin,arcgisonline/sharing/dijit/dialog/ConfirmDialog,arcgisonline/sharing/dijit/dialog/AdvancedOfflineOptionsDlg,arcgisonline/sharing/dijit/dialog/getWFSConfig,arcgisonline/sharing/dijit/dialog/getWMTSConfig"],function(c,
l,h){c.provide("arcgisonline.main");c.require("esri.main");c.require("dijit._base");c.require("dijit.form.DropDownButton");c.require("dijit.form.ComboButton");c.require("dijit.form.ToggleButton");c.require("dijit.form.HorizontalSlider");c.require("dijit.form.VerticalSlider");c.require("dijit.form.HorizontalRule");c.require("dijit.form.VerticalRule");c.require("dijit.form.HorizontalRuleLabels");c.require("dijit.form.VerticalRuleLabels");c.require("esri.map");c.require("esri.dijit.editing.Editor");
c.require("esri.dijit.editing.TemplatePicker");c.require("esri.dijit.InfoWindow");c.require("esri.dijit.OverviewMap");c.require("esri.dijit.Attribution");c.require("esri.dijit.Scalebar");c.require("esri.dijit.Legend");c.require("esri.dijit.TimeSlider");c.require("esri.dijit.MultidimensionalSlider");c.require("esri.dijit.BasemapGallery");c.require("esri.dijit.HomeButton");c.require("esri.dijit.LocateButton");c.require("esri.dijit.Popup");c.require("esri.layers.graphics");c.require("esri.layers.agstiled");
c.require("esri.layers.agsdynamic");c.require("esri.layers.agsimageservice");c.require("esri.layers.CSVLayer");c.require("esri.layers.StreamLayer");c.require("esri.layers.KMLLayer");c.require("esri.layers.FeatureLayer");c.require("esri.layers.VectorTileLayer");c.require("esri.layers.osm");c.require("esri.SnappingManager");c.require("esri.tasks.geometry");c.require("esri.tasks.identify");c.require("esri.tasks.locator");c.require("esri.toolbars.draw");c.require("esri.virtualearth.VETiledLayer");c.require("esri.virtualearth.VEGeocoder");
c.require("esri.dijit.Geocoder");c.require("dojo.dnd.Moveable");c.require("dojo.parser");c.require("arcgisonline.coachmarks.tours");c.require("arcgisonline.map.classBreaks");c.require("arcgisonline.map.dynLayer");c.require("arcgisonline.map.edit");c.require("arcgisonline.map.featColl");c.require("arcgisonline.map.fileImport");c.require("arcgisonline.map.geocode");c.require("arcgisonline.map.geocodeReview");c.require("arcgisonline.map.geoRSS");c.require("arcgisonline.map.itemData");c.require("arcgisonline.map.layer");
c.require("arcgisonline.map.kml");c.require("arcgisonline.map.mapNotes");c.require("arcgisonline.map.mapUtil");c.require("arcgisonline.map.role");c.require("arcgisonline.map.print");c.require("arcgisonline.map.popup");c.require("arcgisonline.map.save_open");c.require("arcgisonline.map.symbol");c.require("arcgisonline.map.table");c.require("arcgisonline.map.thumbnail");c.require("arcgisonline.map.time");c.require("arcgisonline.map.multiDimensions");c.require("arcgisonline.map.vectorTile");c.require("arcgisonline.map.webTile");
c.require("arcgisonline.map.wms");c.require("arcgisonline.map.dijit.About");c.require("arcgisonline.map.dijit.AddContent");c.require("arcgisonline.map.dijit.Directions");c.require("arcgisonline.map.dijit.Edit");c.require("arcgisonline.map.dijit.Geocode");c.require("arcgisonline.map.dijit.LeftPanel");c.require("arcgisonline.map.dijit.Legend");c.require("arcgisonline.map.dijit.ManageTemplates");c.require("arcgisonline.map.dijit.MosaicRule");c.require("arcgisonline.map.dijit.PopupBuilder");c.require("arcgisonline.map.dijit.RendererLabels");
c.require("arcgisonline.map.dijit.DefineAOI");c.require("arcgisonline.map.dijit.RenderingRule");c.require("arcgisonline.map.dijit.StructuredPopupWidget");c.require("arcgisonline.map.dijit.TOC");c.require("arcgisonline.map.dijit.MultidimensionalFilter");c.require("arcgisonline.map.dijit.renderer.AttributeTransparency");c.require("arcgisonline.map.dijit.renderer.AttributeTransparencyDlg");c.require("arcgisonline.map.dijit.renderer.Color");c.require("arcgisonline.map.dijit.renderer.ColorGrid");c.require("arcgisonline.map.dijit.renderer.Gallery");
c.require("arcgisonline.map.dijit.renderer.HeatMap");c.require("arcgisonline.map.dijit.renderer.MultiAttributes");c.require("arcgisonline.map.dijit.renderer.Simple");c.require("arcgisonline.map.dijit.renderer.Size");c.require("arcgisonline.map.dijit.renderer.SizeGrid");c.require("arcgisonline.map.dijit.renderer.SymbolStylerDlg");c.require("arcgisonline.map.dijit.renderer.UniqueValues");c.require("arcgisonline.map.dijit.renderer.UniqueValuesGrid");c.require("esri.tasks.RelationshipQuery");c.require("esri.tasks.StatisticDefinition");
c.require("esri.tasks.PrintParameters");c.require("esri.tasks.LegendLayer");c.require("esri.tasks.GenerateRendererParameters");c.require("esri.tasks.ClassificationDefinition");c.require("esri.tasks.ClassBreaksDefinition");c.require("esri.tasks.UniqueValueDefinition");c.require("esri.tasks.ColorRamp");c.require("esri.tasks.AlgorithmicColorRamp");c.require("esri.tasks.MultipartColorRamp");c.require("esri.tasks.RouteTask");c.require("esri.tasks.RouteParameters");c.require("esri.tasks.RouteResult");c.require("esri.tasks.NAMessage");
c.require("esri.tasks.NATypes");c.require("esri.tasks.DirectionsFeatureSet");c.require("esri.layers.wmts");c.require("esri.layers.WMTSLayer");c.require("esri.layers.WMTSLayerInfo");c.require("esri.dijit.Directions");c.require("dijit.layout.AccordionPane");c.require("dojox.data.QueryReadStore");c.require("arcgisonline.sharing.util");c.require("arcgisonline.sharing.utilShare");c.require("arcgisonline.sharing.geow.Account");c.require("arcgisonline.sharing.geow.Community");c.require("arcgisonline.sharing.geow.Geow");
c.require("arcgisonline.sharing.geow.MemberReadStore");c.require("arcgisonline.sharing.geow.QueryReadStore");c.require("arcgisonline.sharing.geow.TooltipQueryReadStore");c.require("dijit.Dialog");c.require("dijit.form.ComboBox");c.require("dijit.layout.TabContainer");c.require("arcgisonline.sharing.dijit.ArcGISOnlineServicesGrid");c.require("arcgisonline.sharing.dijit.ArcGISServerServicesGrid");c.require("arcgisonline.sharing.dijit.BasemapGallery");c.require("arcgisonline.sharing.dijit.BasemapGalleryGrid");
c.require("arcgisonline.sharing.dijit.Button");c.require("arcgisonline.sharing.dijit.ComboBox");c.require("arcgisonline.sharing.dijit.DataGrid");c.require("arcgisonline.sharing.dijit.DropDownButton");c.require("arcgisonline.sharing.dijit.Error");c.require("arcgisonline.sharing.dijit.FeaturedItemsGrid");c.require("arcgisonline.sharing.dijit.FeatureLayerQueryResult");c.require("arcgisonline.sharing.dijit.FeatureLayerQueryStore");c.require("arcgisonline.sharing.dijit.GoogleServicesGrid");c.require("arcgisonline.sharing.dijit.GroupMembershipRequestsGrid");
c.require("arcgisonline.sharing.dijit.HelpManager");c.require("arcgisonline.sharing.dijit.InvitationsGrid");c.require("arcgisonline.sharing.dijit.NotificationsList");c.require("arcgisonline.sharing.dijit.OrganizationInvite");c.require("arcgisonline.sharing.dijit.OrganizationSetup");c.require("arcgisonline.sharing.dijit.OrganizationStatus");c.require("arcgisonline.sharing.dijit.Troubleshoot");c.require("arcgisonline.sharing.dijit.NewUser");c.require("arcgisonline.sharing.dijit.SearchFilters");c.require("arcgisonline.sharing.dijit.SearchResultsSimple");
c.require("arcgisonline.sharing.dijit.SingleFilter");c.require("arcgisonline.sharing.dijit.SingleInteractiveFilter");c.require("arcgisonline.sharing.dijit.UserProfile");c.require("arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg");c.require("arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg");c.require("arcgisonline.sharing.dijit.dialog.BrowseLayersDlg");c.require("arcgisonline.sharing.dijit.dialog.CsvLocationDlg");c.require("arcgisonline.sharing.dijit.dialog.DeleteWarningDlg");c.require("arcgisonline.sharing.dijit.dialog.ExportDlg");
c.require("arcgisonline.sharing.dijit.dialog.ExtentDlg");c.require("arcgisonline.sharing.dijit.dialog.FeatureTemplateDlg");c.require("arcgisonline.sharing.dijit.dialog.FieldsDlg");c.require("arcgisonline.sharing.dijit.dialog.FilterDlg");c.require("arcgisonline.sharing.dijit.dialog.FeatureTypeDlg");c.require("arcgisonline.sharing.dijit.dialog.FolderDlg");c.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");c.require("arcgisonline.sharing.dijit.dialog.InvitationsDlg");c.require("arcgisonline.sharing.dijit.dialog.InviteAccountUsersDlg");
c.require("arcgisonline.sharing.dijit.dialog.InviteUsersDlg");c.require("arcgisonline.sharing.dijit.dialog.JoinGroupDlg");c.require("arcgisonline.sharing.dijit.dialog.ManageSubscriptionDlg");c.require("arcgisonline.sharing.dijit.dialog.ManageTilesDlg");c.require("arcgisonline.sharing.dijit.dialog.MapSettingsDlg");c.require("arcgisonline.sharing.dijit.dialog.MapNotesDlg");c.require("arcgisonline.sharing.dijit.dialog.MembershipRequestsDlg");c.require("arcgisonline.sharing.dijit.dialog.MdSliderSettingsDlg");
c.require("arcgisonline.sharing.dijit.dialog.NotificationsDlg");c.require("arcgisonline.sharing.dijit.dialog.OpenMapDlg");c.require("arcgisonline.sharing.dijit.dialog.OpenPresentationDlg");c.require("arcgisonline.sharing.dijit.dialog.QueryLayerDlg");c.require("arcgisonline.sharing.dijit.dialog.RenameDlg");c.require("arcgisonline.sharing.dijit.dialog.RendererDlg");c.require("arcgisonline.sharing.dijit.dialog.SaveWebMapDlg");c.require("arcgisonline.sharing.dijit.dialog.SelectAccountUserDlg");c.require("arcgisonline.sharing.dijit.dialog.SetIdentityProviderDlg");
c.require("arcgisonline.sharing.dijit.dialog.ShareCheckDlg");c.require("arcgisonline.sharing.dijit.dialog.SharingDlg");c.require("arcgisonline.sharing.dijit.dialog.ShareMapDlg");c.require("arcgisonline.sharing.dijit.dialog.SubscriptionStatusDlg");c.require("arcgisonline.sharing.dijit.dialog.SymbolDlg");c.require("arcgisonline.sharing.dijit.dialog.TagsDlg");c.require("arcgisonline.sharing.dijit.dialog.TermsOfUseDlg");c.require("arcgisonline.sharing.dijit.dialog.TimeSettingsDlg");c.require("arcgisonline.sharing.dijit.dialog.UpdateItemDlg");
c.require("arcgisonline.sharing.dijit.dialog.WaitingDlg");c.require("arcgisonline.sharing.dijit._GalleryFiltersMixin");c.require("arcgisonline.sharing.dijit.Grid");c.require("arcgisonline.sharing.dijit.ItemGallery");c.require("arcgisonline.sharing.dijit.dialog.ItemPropertiesDlg");c.require("arcgisonline.sharing.dijit.dialog.BrowseItemsDlg");c.require("arcgisonline.sharing.dijit.dialog._CreateItemUtilMixin");c.require("arcgisonline.sharing.dijit.dialog.ConfirmDialog");c.require("arcgisonline.sharing.dijit.dialog.AdvancedOfflineOptionsDlg");
c.require("arcgisonline.sharing.dijit.dialog.getWFSConfig");c.require("arcgisonline.sharing.dijit.dialog.getWMTSConfig")});